!(function(){var i8=Object.defineProperty,a8=Object.defineProperties;var o8=Object.getOwnPropertyDescriptors;var jf=Object.getOwnPropertySymbols,s8=Object.getPrototypeOf,Gw=Object.prototype.hasOwnProperty,zw=Object.prototype.propertyIsEnumerable,l8=Reflect.get;var pi=Math.pow,om=(Ot,ft,D)=>ft in Ot?i8(Ot,ft,{enumerable:!0,configurable:!0,writable:!0,value:D}):Ot[ft]=D,at=(Ot,ft)=>{for(var D in ft||(ft={}))Gw.call(ft,D)&&om(Ot,D,ft[D]);if(jf)for(var D of jf(ft))zw.call(ft,D)&&om(Ot,D,ft[D]);return Ot},_e=(Ot,ft)=>a8(Ot,o8(ft));var Ce=(Ot,ft)=>{var D={};for(var G in Ot)Gw.call(Ot,G)&&ft.indexOf(G)<0&&(D[G]=Ot[G]);if(Ot!=null&&jf)for(var G of jf(Ot))ft.indexOf(G)<0&&zw.call(Ot,G)&&(D[G]=Ot[G]);return D};var k=(Ot,ft,D)=>(om(Ot,typeof ft!="symbol"?ft+"":ft,D),D);var $f=(Ot,ft,D)=>l8(s8(Ot),D,ft);var Ct=(Ot,ft,D)=>new Promise((G,lt)=>{var Z=V=>{try{N(D.next(V))}catch(W){lt(W)}},B=V=>{try{N(D.throw(V))}catch(W){lt(W)}},N=V=>V.done?G(V.value):Promise.resolve(V.value).then(Z,B);N((D=D.apply(Ot,ft)).next())});(self.webpackChunkpanan=self.webpackChunkpanan||[]).push([[9696],{89739:function(Ot,ft,D){"use strict";D.d(ft,{Z:function(){return X}});var G=D(87462),lt=D(67294),Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"},B=Z,N=D(84089),V=function(H,U){return lt.createElement(N.Z,(0,G.Z)({},H,{ref:U,icon:B}))},W=lt.forwardRef(V),X=W},4340:function(Ot,ft,D){"use strict";D.d(ft,{Z:function(){return X}});var G=D(87462),lt=D(67294),Z={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"},B=Z,N=D(84089),V=function(H,U){return lt.createElement(N.Z,(0,G.Z)({},H,{ref:U,icon:B}))},W=lt.forwardRef(V),X=W},21640:function(Ot,ft,D){"use strict";D.d(ft,{Z:function(){return X}});var G=D(87462),lt=D(67294),Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},B=Z,N=D(84089),V=function(H,U){return lt.createElement(N.Z,(0,G.Z)({},H,{ref:U,icon:B}))},W=lt.forwardRef(V),X=W},78860:function(Ot,ft,D){"use strict";D.d(ft,{Z:function(){return X}});var G=D(87462),lt=D(67294),Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"},B=Z,N=D(84089),V=function(H,U){return lt.createElement(N.Z,(0,G.Z)({},H,{ref:U,icon:B}))},W=lt.forwardRef(V),X=W},19796:function(Ot,ft,D){"use strict";D.d(ft,{Ll:function(){return Wo},MD:function(){return Ts},kJ:function(){return Uf},x1:function(){return jl},z2:function(){return yw}});var G={};D.r(G),D.d(G,{add:function(){return Hw},adjoint:function(){return wn},clone:function(){return Bt},copy:function(){return kt},create:function(){return Q},determinant:function(){return Pe},equals:function(){return $w},exactEquals:function(){return jw},frob:function(){return Vw},fromQuat:function(){return La},fromQuat2:function(){return gi},fromRotation:function(){return Tr},fromRotationTranslation:function(){return ha},fromRotationTranslationScale:function(){return zi},fromRotationTranslationScaleOrigin:function(){return fr},fromScaling:function(){return Oe},fromTranslation:function(){return ue},fromValues:function(){return Qt},fromXRotation:function(){return ie},fromYRotation:function(){return Xe},fromZRotation:function(){return qr},frustum:function(){return Kf},getRotation:function(){return _n},getScaling:function(){return He},getTranslation:function(){return Qn},identity:function(){return Xt},invert:function(){return Wt},lookAt:function(){return Fc},mul:function(){return Gc},multiply:function(){return Ut},multiplyScalar:function(){return Yw},multiplyScalarAndAdd:function(){return Xw},ortho:function(){return Dc},orthoNO:function(){return Ic},orthoZO:function(){return Bc},perspective:function(){return dr},perspectiveFromFieldOfView:function(){return Lc},perspectiveNO:function(){return kc},perspectiveZO:function(){return mi},rotate:function(){return Sn},rotateX:function(){return _r},rotateY:function(){return ur},rotateZ:function(){return hr},scale:function(){return vi},set:function(){return re},str:function(){return Uw},sub:function(){return Kw},subtract:function(){return sm},targetTo:function(){return Ww},translate:function(){return Ee},transpose:function(){return Te}});var lt={};D.r(lt),D.d(lt,{circle:function(){return WA},diamond:function(){return UA},rect:function(){return HA},simple:function(){return XA},triangle:function(){return $1},triangleRect:function(){return YA},vee:function(){return VA}});var Z=function(n,e){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},Z(n,e)};function B(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Z(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var N=function(){return N=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},N.apply(this,arguments)};function V(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function W(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(o=n[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function X(n,e){return function(t,r){e(t,r,n)}}function F(n,e,t,r,i,a){function o(m){if(m!==void 0&&typeof m!="function")throw new TypeError("Function expected");return m}for(var s=r.kind,l=s==="getter"?"get":s==="setter"?"set":"value",c=!e&&n?r.static?n:n.prototype:null,u=e||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),h,f=!1,d=t.length-1;d>=0;d--){var p={};for(var v in r)p[v]=v==="access"?{}:r[v];for(var v in r.access)p.access[v]=r.access[v];p.addInitializer=function(m){if(f)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(m||null))};var g=(0,t[d])(s==="accessor"?{get:u.get,set:u.set}:u[l],p);if(s==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(h=o(g.get))&&(u.get=h),(h=o(g.set))&&(u.set=h),(h=o(g.init))&&i.unshift(h)}else(h=o(g))&&(s==="field"?i.unshift(h):u[l]=h)}c&&Object.defineProperty(c,r.name,u),f=!0}function H(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0}function U(n){return typeof n=="symbol"?n:"".concat(n)}function $(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function dt(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function j(n,e,t,r){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):i(u.value).then(s,l)}c((r=r.apply(n,e||[])).next())})}function mt(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(r=1,i&&(a=c[0]&2?i.return:c[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,c[1])).done)return a;switch(i=0,a&&(c=[c[0]&2,a.value]),c[0]){case 0:case 1:a=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){t.label=c[1];break}if(c[0]===6&&t.label<a[1]){t.label=a[1],a=c;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(c);break}a[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],i=0}finally{r=a=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var Pt=Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]};function tt(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Pt(e,n,t)}function vt(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function P(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function Jt(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(P(arguments[e]));return n}function ne(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function K(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function ve(n){return this instanceof ve?(this.v=n,this):new ve(n)}function ce(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,a=[];return i={},s("next"),s("throw"),s("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(d){return function(p){return Promise.resolve(p).then(d,h)}}function s(d,p){r[d]&&(i[d]=function(v){return new Promise(function(g,m){a.push([d,v,g,m])>1||l(d,v)})},p&&(i[d]=p(i[d])))}function l(d,p){try{c(r[d](p))}catch(v){f(a[0][3],v)}}function c(d){d.value instanceof ve?Promise.resolve(d.value.v).then(u,h):f(a[0][2],d)}function u(d){l("next",d)}function h(d){l("throw",d)}function f(d,p){d(p),a.shift(),a.length&&l(a[0][0],a[0][1])}}function ot(n){var e,t;return e={},r("next"),r("throw",function(i){throw i}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(i,a){e[i]=n[i]?function(o){return(t=!t)?{value:ve(n[i](o)),done:!1}:a?a(o):o}:a}}function Gt(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof vt=="function"?vt(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(s,l){o=n[a](o),i(s,l,o.done,o.value)})}}function i(a,o,s,l){Promise.resolve(l).then(function(c){a({value:c,done:s})},o)}}function zt(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var Nt=Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e};function ye(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&Pt(e,n,t);return Nt(e,n),e}function le(n){return n&&n.__esModule?n:{default:n}}function In(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function gt(n,e,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t}function de(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function be(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var Yt=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function ae(n){function e(r){n.error=n.hasError?new Yt(r,n.error,"An error was suppressed during disposal."):r,n.hasError=!0}function t(){for(;n.stack.length;){var r=n.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(t,function(a){return e(a),t()})}catch(a){e(a)}}if(n.hasError)throw n.error}return t()}var It={__extends:B,__assign:N,__rest:V,__decorate:W,__param:X,__metadata:dt,__awaiter:j,__generator:mt,__createBinding:Pt,__exportStar:tt,__values:vt,__read:P,__spread:Jt,__spreadArrays:ne,__spreadArray:K,__await:ve,__asyncGenerator:ce,__asyncDelegator:ot,__asyncValues:Gt,__makeTemplateObject:zt,__importStar:ye,__importDefault:le,__classPrivateFieldGet:In,__classPrivateFieldSet:gt,__classPrivateFieldIn:de,__addDisposableResource:be,__disposeResources:ae},Dt=D(26729),et=Dt,_=D(77160),ut=D(49685);function Q(){var n=new ut.WT(16);return ut.WT!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n}function Bt(n){var e=new ut.WT(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}function kt(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function Qt(n,e,t,r,i,a,o,s,l,c,u,h,f,d,p,v){var g=new ut.WT(16);return g[0]=n,g[1]=e,g[2]=t,g[3]=r,g[4]=i,g[5]=a,g[6]=o,g[7]=s,g[8]=l,g[9]=c,g[10]=u,g[11]=h,g[12]=f,g[13]=d,g[14]=p,g[15]=v,g}function re(n,e,t,r,i,a,o,s,l,c,u,h,f,d,p,v,g){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n[4]=a,n[5]=o,n[6]=s,n[7]=l,n[8]=c,n[9]=u,n[10]=h,n[11]=f,n[12]=d,n[13]=p,n[14]=v,n[15]=g,n}function Xt(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Te(n,e){if(n===e){var t=e[1],r=e[2],i=e[3],a=e[6],o=e[7],s=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=r,n[9]=a,n[11]=e[14],n[12]=i,n[13]=o,n[14]=s}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15];return n}function Wt(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],d=e[11],p=e[12],v=e[13],g=e[14],m=e[15],x=t*s-r*o,S=t*l-i*o,T=t*c-a*o,b=r*l-i*s,y=r*c-a*s,E=i*c-a*l,w=u*v-h*p,C=u*g-f*p,M=u*m-d*p,O=h*g-f*v,A=h*m-d*v,R=f*m-d*g,L=x*R-S*A+T*O+b*M-y*C+E*w;return L?(L=1/L,n[0]=(s*R-l*A+c*O)*L,n[1]=(i*A-r*R-a*O)*L,n[2]=(v*E-g*y+m*b)*L,n[3]=(f*y-h*E-d*b)*L,n[4]=(l*M-o*R-c*C)*L,n[5]=(t*R-i*M+a*C)*L,n[6]=(g*T-p*E-m*S)*L,n[7]=(u*E-f*T+d*S)*L,n[8]=(o*A-s*M+c*w)*L,n[9]=(r*M-t*A-a*w)*L,n[10]=(p*y-v*T+m*x)*L,n[11]=(h*T-u*y-d*x)*L,n[12]=(s*C-o*O-l*w)*L,n[13]=(t*O-r*C+i*w)*L,n[14]=(v*S-p*b-g*x)*L,n[15]=(u*b-h*S+f*x)*L,n):null}function wn(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],d=e[11],p=e[12],v=e[13],g=e[14],m=e[15];return n[0]=s*(f*m-d*g)-h*(l*m-c*g)+v*(l*d-c*f),n[1]=-(r*(f*m-d*g)-h*(i*m-a*g)+v*(i*d-a*f)),n[2]=r*(l*m-c*g)-s*(i*m-a*g)+v*(i*c-a*l),n[3]=-(r*(l*d-c*f)-s*(i*d-a*f)+h*(i*c-a*l)),n[4]=-(o*(f*m-d*g)-u*(l*m-c*g)+p*(l*d-c*f)),n[5]=t*(f*m-d*g)-u*(i*m-a*g)+p*(i*d-a*f),n[6]=-(t*(l*m-c*g)-o*(i*m-a*g)+p*(i*c-a*l)),n[7]=t*(l*d-c*f)-o*(i*d-a*f)+u*(i*c-a*l),n[8]=o*(h*m-d*v)-u*(s*m-c*v)+p*(s*d-c*h),n[9]=-(t*(h*m-d*v)-u*(r*m-a*v)+p*(r*d-a*h)),n[10]=t*(s*m-c*v)-o*(r*m-a*v)+p*(r*c-a*s),n[11]=-(t*(s*d-c*h)-o*(r*d-a*h)+u*(r*c-a*s)),n[12]=-(o*(h*g-f*v)-u*(s*g-l*v)+p*(s*f-l*h)),n[13]=t*(h*g-f*v)-u*(r*g-i*v)+p*(r*f-i*h),n[14]=-(t*(s*g-l*v)-o*(r*g-i*v)+p*(r*l-i*s)),n[15]=t*(s*f-l*h)-o*(r*f-i*h)+u*(r*l-i*s),n}function Pe(n){var e=n[0],t=n[1],r=n[2],i=n[3],a=n[4],o=n[5],s=n[6],l=n[7],c=n[8],u=n[9],h=n[10],f=n[11],d=n[12],p=n[13],v=n[14],g=n[15],m=e*o-t*a,x=e*s-r*a,S=e*l-i*a,T=t*s-r*o,b=t*l-i*o,y=r*l-i*s,E=c*p-u*d,w=c*v-h*d,C=c*g-f*d,M=u*v-h*p,O=u*g-f*p,A=h*g-f*v;return m*A-x*O+S*M+T*C-b*w+y*E}function Ut(n,e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],d=e[10],p=e[11],v=e[12],g=e[13],m=e[14],x=e[15],S=t[0],T=t[1],b=t[2],y=t[3];return n[0]=S*r+T*s+b*h+y*v,n[1]=S*i+T*l+b*f+y*g,n[2]=S*a+T*c+b*d+y*m,n[3]=S*o+T*u+b*p+y*x,S=t[4],T=t[5],b=t[6],y=t[7],n[4]=S*r+T*s+b*h+y*v,n[5]=S*i+T*l+b*f+y*g,n[6]=S*a+T*c+b*d+y*m,n[7]=S*o+T*u+b*p+y*x,S=t[8],T=t[9],b=t[10],y=t[11],n[8]=S*r+T*s+b*h+y*v,n[9]=S*i+T*l+b*f+y*g,n[10]=S*a+T*c+b*d+y*m,n[11]=S*o+T*u+b*p+y*x,S=t[12],T=t[13],b=t[14],y=t[15],n[12]=S*r+T*s+b*h+y*v,n[13]=S*i+T*l+b*f+y*g,n[14]=S*a+T*c+b*d+y*m,n[15]=S*o+T*u+b*p+y*x,n}function Ee(n,e,t){var r=t[0],i=t[1],a=t[2],o,s,l,c,u,h,f,d,p,v,g,m;return e===n?(n[12]=e[0]*r+e[4]*i+e[8]*a+e[12],n[13]=e[1]*r+e[5]*i+e[9]*a+e[13],n[14]=e[2]*r+e[6]*i+e[10]*a+e[14],n[15]=e[3]*r+e[7]*i+e[11]*a+e[15]):(o=e[0],s=e[1],l=e[2],c=e[3],u=e[4],h=e[5],f=e[6],d=e[7],p=e[8],v=e[9],g=e[10],m=e[11],n[0]=o,n[1]=s,n[2]=l,n[3]=c,n[4]=u,n[5]=h,n[6]=f,n[7]=d,n[8]=p,n[9]=v,n[10]=g,n[11]=m,n[12]=o*r+u*i+p*a+e[12],n[13]=s*r+h*i+v*a+e[13],n[14]=l*r+f*i+g*a+e[14],n[15]=c*r+d*i+m*a+e[15]),n}function vi(n,e,t){var r=t[0],i=t[1],a=t[2];return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7]*i,n[8]=e[8]*a,n[9]=e[9]*a,n[10]=e[10]*a,n[11]=e[11]*a,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function Sn(n,e,t,r){var i=r[0],a=r[1],o=r[2],s=Math.hypot(i,a,o),l,c,u,h,f,d,p,v,g,m,x,S,T,b,y,E,w,C,M,O,A,R,L,z;return s<ut.Ib?null:(s=1/s,i*=s,a*=s,o*=s,l=Math.sin(t),c=Math.cos(t),u=1-c,h=e[0],f=e[1],d=e[2],p=e[3],v=e[4],g=e[5],m=e[6],x=e[7],S=e[8],T=e[9],b=e[10],y=e[11],E=i*i*u+c,w=a*i*u+o*l,C=o*i*u-a*l,M=i*a*u-o*l,O=a*a*u+c,A=o*a*u+i*l,R=i*o*u+a*l,L=a*o*u-i*l,z=o*o*u+c,n[0]=h*E+v*w+S*C,n[1]=f*E+g*w+T*C,n[2]=d*E+m*w+b*C,n[3]=p*E+x*w+y*C,n[4]=h*M+v*O+S*A,n[5]=f*M+g*O+T*A,n[6]=d*M+m*O+b*A,n[7]=p*M+x*O+y*A,n[8]=h*R+v*L+S*z,n[9]=f*R+g*L+T*z,n[10]=d*R+m*L+b*z,n[11]=p*R+x*L+y*z,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n)}function _r(n,e,t){var r=Math.sin(t),i=Math.cos(t),a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],f=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=a*i+c*r,n[5]=o*i+u*r,n[6]=s*i+h*r,n[7]=l*i+f*r,n[8]=c*i-a*r,n[9]=u*i-o*r,n[10]=h*i-s*r,n[11]=f*i-l*r,n}function ur(n,e,t){var r=Math.sin(t),i=Math.cos(t),a=e[0],o=e[1],s=e[2],l=e[3],c=e[8],u=e[9],h=e[10],f=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=a*i-c*r,n[1]=o*i-u*r,n[2]=s*i-h*r,n[3]=l*i-f*r,n[8]=a*r+c*i,n[9]=o*r+u*i,n[10]=s*r+h*i,n[11]=l*r+f*i,n}function hr(n,e,t){var r=Math.sin(t),i=Math.cos(t),a=e[0],o=e[1],s=e[2],l=e[3],c=e[4],u=e[5],h=e[6],f=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=a*i+c*r,n[1]=o*i+u*r,n[2]=s*i+h*r,n[3]=l*i+f*r,n[4]=c*i-a*r,n[5]=u*i-o*r,n[6]=h*i-s*r,n[7]=f*i-l*r,n}function ue(n,e){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n}function Oe(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Tr(n,e,t){var r=t[0],i=t[1],a=t[2],o=Math.hypot(r,i,a),s,l,c;return o<ut.Ib?null:(o=1/o,r*=o,i*=o,a*=o,s=Math.sin(e),l=Math.cos(e),c=1-l,n[0]=r*r*c+l,n[1]=i*r*c+a*s,n[2]=a*r*c-i*s,n[3]=0,n[4]=r*i*c-a*s,n[5]=i*i*c+l,n[6]=a*i*c+r*s,n[7]=0,n[8]=r*a*c+i*s,n[9]=i*a*c-r*s,n[10]=a*a*c+l,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}function ie(n,e){var t=Math.sin(e),r=Math.cos(e);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=r,n[6]=t,n[7]=0,n[8]=0,n[9]=-t,n[10]=r,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Xe(n,e){var t=Math.sin(e),r=Math.cos(e);return n[0]=r,n[1]=0,n[2]=-t,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=t,n[9]=0,n[10]=r,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function qr(n,e){var t=Math.sin(e),r=Math.cos(e);return n[0]=r,n[1]=t,n[2]=0,n[3]=0,n[4]=-t,n[5]=r,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function ha(n,e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=r+r,l=i+i,c=a+a,u=r*s,h=r*l,f=r*c,d=i*l,p=i*c,v=a*c,g=o*s,m=o*l,x=o*c;return n[0]=1-(d+v),n[1]=h+x,n[2]=f-m,n[3]=0,n[4]=h-x,n[5]=1-(u+v),n[6]=p+g,n[7]=0,n[8]=f+m,n[9]=p-g,n[10]=1-(u+d),n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n}function gi(n,e){var t=new ut.WT(3),r=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=r*r+i*i+a*a+o*o;return h>0?(t[0]=(s*o+u*r+l*a-c*i)*2/h,t[1]=(l*o+u*i+c*r-s*a)*2/h,t[2]=(c*o+u*a+s*i-l*r)*2/h):(t[0]=(s*o+u*r+l*a-c*i)*2,t[1]=(l*o+u*i+c*r-s*a)*2,t[2]=(c*o+u*a+s*i-l*r)*2),ha(n,e,t),n}function Qn(n,e){return n[0]=e[12],n[1]=e[13],n[2]=e[14],n}function He(n,e){var t=e[0],r=e[1],i=e[2],a=e[4],o=e[5],s=e[6],l=e[8],c=e[9],u=e[10];return n[0]=Math.hypot(t,r,i),n[1]=Math.hypot(a,o,s),n[2]=Math.hypot(l,c,u),n}function _n(n,e){var t=new ut.WT(3);He(t,e);var r=1/t[0],i=1/t[1],a=1/t[2],o=e[0]*r,s=e[1]*i,l=e[2]*a,c=e[4]*r,u=e[5]*i,h=e[6]*a,f=e[8]*r,d=e[9]*i,p=e[10]*a,v=o+u+p,g=0;return v>0?(g=Math.sqrt(v+1)*2,n[3]=.25*g,n[0]=(h-d)/g,n[1]=(f-l)/g,n[2]=(s-c)/g):o>u&&o>p?(g=Math.sqrt(1+o-u-p)*2,n[3]=(h-d)/g,n[0]=.25*g,n[1]=(s+c)/g,n[2]=(f+l)/g):u>p?(g=Math.sqrt(1+u-o-p)*2,n[3]=(f-l)/g,n[0]=(s+c)/g,n[1]=.25*g,n[2]=(h+d)/g):(g=Math.sqrt(1+p-o-u)*2,n[3]=(s-c)/g,n[0]=(f+l)/g,n[1]=(h+d)/g,n[2]=.25*g),n}function zi(n,e,t,r){var i=e[0],a=e[1],o=e[2],s=e[3],l=i+i,c=a+a,u=o+o,h=i*l,f=i*c,d=i*u,p=a*c,v=a*u,g=o*u,m=s*l,x=s*c,S=s*u,T=r[0],b=r[1],y=r[2];return n[0]=(1-(p+g))*T,n[1]=(f+S)*T,n[2]=(d-x)*T,n[3]=0,n[4]=(f-S)*b,n[5]=(1-(h+g))*b,n[6]=(v+m)*b,n[7]=0,n[8]=(d+x)*y,n[9]=(v-m)*y,n[10]=(1-(h+p))*y,n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n}function fr(n,e,t,r,i){var a=e[0],o=e[1],s=e[2],l=e[3],c=a+a,u=o+o,h=s+s,f=a*c,d=a*u,p=a*h,v=o*u,g=o*h,m=s*h,x=l*c,S=l*u,T=l*h,b=r[0],y=r[1],E=r[2],w=i[0],C=i[1],M=i[2],O=(1-(v+m))*b,A=(d+T)*b,R=(p-S)*b,L=(d-T)*y,z=(1-(f+m))*y,Y=(g+x)*y,I=(p+S)*E,q=(g-x)*E,J=(1-(f+v))*E;return n[0]=O,n[1]=A,n[2]=R,n[3]=0,n[4]=L,n[5]=z,n[6]=Y,n[7]=0,n[8]=I,n[9]=q,n[10]=J,n[11]=0,n[12]=t[0]+w-(O*w+L*C+I*M),n[13]=t[1]+C-(A*w+z*C+q*M),n[14]=t[2]+M-(R*w+Y*C+J*M),n[15]=1,n}function La(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=t+t,s=r+r,l=i+i,c=t*o,u=r*o,h=r*s,f=i*o,d=i*s,p=i*l,v=a*o,g=a*s,m=a*l;return n[0]=1-h-p,n[1]=u+m,n[2]=f-g,n[3]=0,n[4]=u-m,n[5]=1-c-p,n[6]=d+v,n[7]=0,n[8]=f+g,n[9]=d-v,n[10]=1-c-h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Kf(n,e,t,r,i,a,o){var s=1/(t-e),l=1/(i-r),c=1/(a-o);return n[0]=a*2*s,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a*2*l,n[6]=0,n[7]=0,n[8]=(t+e)*s,n[9]=(i+r)*l,n[10]=(o+a)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*a*2*c,n[15]=0,n}function kc(n,e,t,r,i){var a=1/Math.tan(e/2),o;return n[0]=a/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,i!=null&&i!==1/0?(o=1/(r-i),n[10]=(i+r)*o,n[14]=2*i*r*o):(n[10]=-1,n[14]=-2*r),n}var dr=kc;function mi(n,e,t,r,i){var a=1/Math.tan(e/2),o;return n[0]=a/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,i!=null&&i!==1/0?(o=1/(r-i),n[10]=i*o,n[14]=i*r*o):(n[10]=-1,n[14]=-r),n}function Lc(n,e,t,r){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+s),c=2/(i+a);return n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=-((o-s)*l*.5),n[9]=(i-a)*c*.5,n[10]=r/(t-r),n[11]=-1,n[12]=0,n[13]=0,n[14]=r*t/(t-r),n[15]=0,n}function Ic(n,e,t,r,i,a,o){var s=1/(e-t),l=1/(r-i),c=1/(a-o);return n[0]=-2*s,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*s,n[13]=(i+r)*l,n[14]=(o+a)*c,n[15]=1,n}var Dc=Ic;function Bc(n,e,t,r,i,a,o){var s=1/(e-t),l=1/(r-i),c=1/(a-o);return n[0]=-2*s,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=c,n[11]=0,n[12]=(e+t)*s,n[13]=(i+r)*l,n[14]=a*c,n[15]=1,n}function Fc(n,e,t,r){var i,a,o,s,l,c,u,h,f,d,p=e[0],v=e[1],g=e[2],m=r[0],x=r[1],S=r[2],T=t[0],b=t[1],y=t[2];return Math.abs(p-T)<ut.Ib&&Math.abs(v-b)<ut.Ib&&Math.abs(g-y)<ut.Ib?Xt(n):(u=p-T,h=v-b,f=g-y,d=1/Math.hypot(u,h,f),u*=d,h*=d,f*=d,i=x*f-S*h,a=S*u-m*f,o=m*h-x*u,d=Math.hypot(i,a,o),d?(d=1/d,i*=d,a*=d,o*=d):(i=0,a=0,o=0),s=h*o-f*a,l=f*i-u*o,c=u*a-h*i,d=Math.hypot(s,l,c),d?(d=1/d,s*=d,l*=d,c*=d):(s=0,l=0,c=0),n[0]=i,n[1]=s,n[2]=u,n[3]=0,n[4]=a,n[5]=l,n[6]=h,n[7]=0,n[8]=o,n[9]=c,n[10]=f,n[11]=0,n[12]=-(i*p+a*v+o*g),n[13]=-(s*p+l*v+c*g),n[14]=-(u*p+h*v+f*g),n[15]=1,n)}function Ww(n,e,t,r){var i=e[0],a=e[1],o=e[2],s=r[0],l=r[1],c=r[2],u=i-t[0],h=a-t[1],f=o-t[2],d=u*u+h*h+f*f;d>0&&(d=1/Math.sqrt(d),u*=d,h*=d,f*=d);var p=l*f-c*h,v=c*u-s*f,g=s*h-l*u;return d=p*p+v*v+g*g,d>0&&(d=1/Math.sqrt(d),p*=d,v*=d,g*=d),n[0]=p,n[1]=v,n[2]=g,n[3]=0,n[4]=h*g-f*v,n[5]=f*p-u*g,n[6]=u*v-h*p,n[7]=0,n[8]=u,n[9]=h,n[10]=f,n[11]=0,n[12]=i,n[13]=a,n[14]=o,n[15]=1,n}function Uw(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"}function Vw(n){return Math.hypot(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])}function Hw(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n}function sm(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n}function Yw(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n}function Xw(n,e,t,r){return n[0]=e[0]+t[0]*r,n[1]=e[1]+t[1]*r,n[2]=e[2]+t[2]*r,n[3]=e[3]+t[3]*r,n[4]=e[4]+t[4]*r,n[5]=e[5]+t[5]*r,n[6]=e[6]+t[6]*r,n[7]=e[7]+t[7]*r,n[8]=e[8]+t[8]*r,n[9]=e[9]+t[9]*r,n[10]=e[10]+t[10]*r,n[11]=e[11]+t[11]*r,n[12]=e[12]+t[12]*r,n[13]=e[13]+t[13]*r,n[14]=e[14]+t[14]*r,n[15]=e[15]+t[15]*r,n}function jw(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]&&n[4]===e[4]&&n[5]===e[5]&&n[6]===e[6]&&n[7]===e[7]&&n[8]===e[8]&&n[9]===e[9]&&n[10]===e[10]&&n[11]===e[11]&&n[12]===e[12]&&n[13]===e[13]&&n[14]===e[14]&&n[15]===e[15]}function $w(n,e){var t=n[0],r=n[1],i=n[2],a=n[3],o=n[4],s=n[5],l=n[6],c=n[7],u=n[8],h=n[9],f=n[10],d=n[11],p=n[12],v=n[13],g=n[14],m=n[15],x=e[0],S=e[1],T=e[2],b=e[3],y=e[4],E=e[5],w=e[6],C=e[7],M=e[8],O=e[9],A=e[10],R=e[11],L=e[12],z=e[13],Y=e[14],I=e[15];return Math.abs(t-x)<=ut.Ib*Math.max(1,Math.abs(t),Math.abs(x))&&Math.abs(r-S)<=ut.Ib*Math.max(1,Math.abs(r),Math.abs(S))&&Math.abs(i-T)<=ut.Ib*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(a-b)<=ut.Ib*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-y)<=ut.Ib*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(s-E)<=ut.Ib*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(l-w)<=ut.Ib*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(c-C)<=ut.Ib*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(u-M)<=ut.Ib*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(h-O)<=ut.Ib*Math.max(1,Math.abs(h),Math.abs(O))&&Math.abs(f-A)<=ut.Ib*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(d-R)<=ut.Ib*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(p-L)<=ut.Ib*Math.max(1,Math.abs(p),Math.abs(L))&&Math.abs(v-z)<=ut.Ib*Math.max(1,Math.abs(v),Math.abs(z))&&Math.abs(g-Y)<=ut.Ib*Math.max(1,Math.abs(g),Math.abs(Y))&&Math.abs(m-I)<=ut.Ib*Math.max(1,Math.abs(m),Math.abs(I))}var Gc=Ut,Kw=sm,qi=D(35600);function an(){var n=new ut.WT(4);return ut.WT!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function Zw(n){var e=new ut.WT(4);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}function fa(n,e,t,r){var i=new ut.WT(4);return i[0]=n,i[1]=e,i[2]=t,i[3]=r,i}function qw(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}function Jw(n,e,t,r,i){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function Qw(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n}function c8(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n}function u8(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n[3]=e[3]*t[3],n}function h8(n,e,t){return n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n[3]=e[3]/t[3],n}function f8(n,e){return n[0]=Math.ceil(e[0]),n[1]=Math.ceil(e[1]),n[2]=Math.ceil(e[2]),n[3]=Math.ceil(e[3]),n}function d8(n,e){return n[0]=Math.floor(e[0]),n[1]=Math.floor(e[1]),n[2]=Math.floor(e[2]),n[3]=Math.floor(e[3]),n}function p8(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n[3]=Math.min(e[3],t[3]),n}function v8(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n[3]=Math.max(e[3],t[3]),n}function g8(n,e){return n[0]=Math.round(e[0]),n[1]=Math.round(e[1]),n[2]=Math.round(e[2]),n[3]=Math.round(e[3]),n}function tS(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function m8(n,e,t,r){return n[0]=e[0]+t[0]*r,n[1]=e[1]+t[1]*r,n[2]=e[2]+t[2]*r,n[3]=e[3]+t[3]*r,n}function y8(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=e[2]-n[2],a=e[3]-n[3];return Math.hypot(t,r,i,a)}function x8(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=e[2]-n[2],a=e[3]-n[3];return t*t+r*r+i*i+a*a}function eS(n){var e=n[0],t=n[1],r=n[2],i=n[3];return Math.hypot(e,t,r,i)}function nS(n){var e=n[0],t=n[1],r=n[2],i=n[3];return e*e+t*t+r*r+i*i}function b8(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=-e[3],n}function E8(n,e){return n[0]=1/e[0],n[1]=1/e[1],n[2]=1/e[2],n[3]=1/e[3],n}function rS(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=t*t+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=r*o,n[2]=i*o,n[3]=a*o,n}function iS(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]}function w8(n,e,t,r){var i=t[0]*r[1]-t[1]*r[0],a=t[0]*r[2]-t[2]*r[0],o=t[0]*r[3]-t[3]*r[0],s=t[1]*r[2]-t[2]*r[1],l=t[1]*r[3]-t[3]*r[1],c=t[2]*r[3]-t[3]*r[2],u=e[0],h=e[1],f=e[2],d=e[3];return n[0]=h*c-f*l+d*s,n[1]=-(u*c)+f*o-d*a,n[2]=u*l-h*o+d*i,n[3]=-(u*s)+h*a-f*i,n}function aS(n,e,t,r){var i=e[0],a=e[1],o=e[2],s=e[3];return n[0]=i+r*(t[0]-i),n[1]=a+r*(t[1]-a),n[2]=o+r*(t[2]-o),n[3]=s+r*(t[3]-s),n}function S8(n,e){e=e||1;var t,r,i,a,o,s;do t=glMatrix.RANDOM()*2-1,r=glMatrix.RANDOM()*2-1,o=t*t+r*r;while(o>=1);do i=glMatrix.RANDOM()*2-1,a=glMatrix.RANDOM()*2-1,s=i*i+a*a;while(s>=1);var l=Math.sqrt((1-o)/s);return n[0]=e*t,n[1]=e*r,n[2]=e*i*l,n[3]=e*a*l,n}function ln(n,e,t){var r=e[0],i=e[1],a=e[2],o=e[3];return n[0]=t[0]*r+t[4]*i+t[8]*a+t[12]*o,n[1]=t[1]*r+t[5]*i+t[9]*a+t[13]*o,n[2]=t[2]*r+t[6]*i+t[10]*a+t[14]*o,n[3]=t[3]*r+t[7]*i+t[11]*a+t[15]*o,n}function _8(n,e,t){var r=e[0],i=e[1],a=e[2],o=t[0],s=t[1],l=t[2],c=t[3],u=c*r+s*a-l*i,h=c*i+l*r-o*a,f=c*a+o*i-s*r,d=-o*r-s*i-l*a;return n[0]=u*c+d*-o+h*-l-f*-s,n[1]=h*c+d*-s+f*-o-u*-l,n[2]=f*c+d*-l+u*-s-h*-o,n[3]=e[3],n}function T8(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n}function P8(n){return"vec4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"}function oS(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]}function sS(n,e){var t=n[0],r=n[1],i=n[2],a=n[3],o=e[0],s=e[1],l=e[2],c=e[3];return Math.abs(t-o)<=ut.Ib*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(r-s)<=ut.Ib*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-l)<=ut.Ib*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-c)<=ut.Ib*Math.max(1,Math.abs(a),Math.abs(c))}var M8=null,C8=null,O8=null,A8=null,N8=null,R8=null,k8=null,L8=function(){var n=an();return function(e,t,r,i,a,o){var s,l;for(t||(t=4),r||(r=0),i?l=Math.min(i*t+r,e.length):l=e.length,s=r;s<l;s+=t)n[0]=e[s],n[1]=e[s+1],n[2]=e[s+2],n[3]=e[s+3],a(n,n,o),e[s]=n[0],e[s+1]=n[1],e[s+2]=n[2],e[s+3]=n[3];return e}}();function Vt(){var n=new ut.WT(4);return ut.WT!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function I8(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function kn(n,e,t){t=t*.5;var r=Math.sin(t);return n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=Math.cos(t),n}function D8(n,e){var t=Math.acos(e[3])*2,r=Math.sin(t/2);return r>glMatrix.EPSILON?(n[0]=e[0]/r,n[1]=e[1]/r,n[2]=e[2]/r):(n[0]=1,n[1]=0,n[2]=0),t}function B8(n,e){var t=fS(n,e);return Math.acos(2*t*t-1)}function An(n,e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=t[0],l=t[1],c=t[2],u=t[3];return n[0]=r*u+o*s+i*c-a*l,n[1]=i*u+o*l+a*s-r*c,n[2]=a*u+o*c+r*l-i*s,n[3]=o*u-r*s-i*l-a*c,n}function F8(n,e,t){t*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(t),l=Math.cos(t);return n[0]=r*l+o*s,n[1]=i*l+a*s,n[2]=a*l-i*s,n[3]=o*l-r*s,n}function G8(n,e,t){t*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(t),l=Math.cos(t);return n[0]=r*l-a*s,n[1]=i*l+o*s,n[2]=a*l+r*s,n[3]=o*l-i*s,n}function z8(n,e,t){t*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(t),l=Math.cos(t);return n[0]=r*l+i*s,n[1]=i*l-r*s,n[2]=a*l+o*s,n[3]=o*l-a*s,n}function W8(n,e){var t=e[0],r=e[1],i=e[2];return n[0]=t,n[1]=r,n[2]=i,n[3]=Math.sqrt(Math.abs(1-t*t-r*r-i*i)),n}function lS(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=Math.sqrt(t*t+r*r+i*i),s=Math.exp(a),l=o>0?s*Math.sin(o)/o:0;return n[0]=t*l,n[1]=r*l,n[2]=i*l,n[3]=s*Math.cos(o),n}function cS(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=Math.sqrt(t*t+r*r+i*i),s=o>0?Math.atan2(o,a)/o:0;return n[0]=t*s,n[1]=r*s,n[2]=i*s,n[3]=.5*Math.log(t*t+r*r+i*i+a*a),n}function U8(n,e,t){return cS(n,e),hS(n,n,t),lS(n,n),n}function Zf(n,e,t,r){var i=e[0],a=e[1],o=e[2],s=e[3],l=t[0],c=t[1],u=t[2],h=t[3],f,d,p,v,g;return d=i*l+a*c+o*u+s*h,d<0&&(d=-d,l=-l,c=-c,u=-u,h=-h),1-d>ut.Ib?(f=Math.acos(d),p=Math.sin(f),v=Math.sin((1-r)*f)/p,g=Math.sin(r*f)/p):(v=1-r,g=r),n[0]=v*i+g*l,n[1]=v*a+g*c,n[2]=v*o+g*u,n[3]=v*s+g*h,n}function V8(n){var e=glMatrix.RANDOM(),t=glMatrix.RANDOM(),r=glMatrix.RANDOM(),i=Math.sqrt(1-e),a=Math.sqrt(e);return n[0]=i*Math.sin(2*Math.PI*t),n[1]=i*Math.cos(2*Math.PI*t),n[2]=a*Math.sin(2*Math.PI*r),n[3]=a*Math.cos(2*Math.PI*r),n}function da(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=t*t+r*r+i*i+a*a,s=o?1/o:0;return n[0]=-t*s,n[1]=-r*s,n[2]=-i*s,n[3]=a*s,n}function H8(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n}function uS(n,e){var t=e[0]+e[4]+e[8],r;if(t>0)r=Math.sqrt(t+1),n[3]=.5*r,r=.5/r,n[0]=(e[5]-e[7])*r,n[1]=(e[6]-e[2])*r,n[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[a*3+a]-e[o*3+o]+1),n[i]=.5*r,r=.5/r,n[3]=(e[a*3+o]-e[o*3+a])*r,n[a]=(e[a*3+i]+e[i*3+a])*r,n[o]=(e[o*3+i]+e[i*3+o])*r}return n}function yi(n,e,t,r){var i=.5*Math.PI/180;e*=i,t*=i,r*=i;var a=Math.sin(e),o=Math.cos(e),s=Math.sin(t),l=Math.cos(t),c=Math.sin(r),u=Math.cos(r);return n[0]=a*l*u-o*s*c,n[1]=o*s*u+a*l*c,n[2]=o*l*c-a*s*u,n[3]=o*l*u+a*s*c,n}function Y8(n){return"quat("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"}var X8=Zw,pa=fa,xi=qw,j8=Jw,$8=Qw,ss=An,hS=tS,fS=iS,K8=aS,Z8=eS,q8=null,J8=nS,Q8=null,Ia=rS,tz=oS,ez=sS,nz=function(){var n=_.Ue(),e=_.al(1,0,0),t=_.al(0,1,0);return function(r,i,a){var o=_.AK(i,a);return o<-.999999?(_.kC(n,e,i),_.Zh(n)<1e-6&&_.kC(n,t,i),_.Fv(n,n),kn(r,n,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(_.kC(n,i,a),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=1+o,Ia(r,r))}}(),rz=function(){var n=Vt(),e=Vt();return function(t,r,i,a,o,s){return Zf(n,r,o,s),Zf(e,i,a,s),Zf(t,n,e,2*s*(1-s)),t}}(),iz=function(){var n=qi.Ue();return function(e,t,r,i){return n[0]=r[0],n[3]=r[1],n[6]=r[2],n[1]=i[0],n[4]=i[1],n[7]=i[2],n[2]=-t[0],n[5]=-t[1],n[8]=-t[2],Ia(e,uS(e,n))}}(),va=D(31437),dS={}.toString,pS=function(n,e){return dS.call(n)==="[object "+e+"]"},ls=pS,vS=function(n){return ls(n,"Number")},te=vS;function Pr(n,e){return Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1]))}var gS=function(n){return n==null},pt=gS,qt=function(n){return ls(n,"String")},mS=function(n,e,t){return n<e?e:n>t?t:n},he=mS,qf=function(n,e){return qf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},qf(n,e)};function yS(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");qf(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ga=function(){return ga=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},ga.apply(this,arguments)};function xS(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function bS(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(o=n[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function ES(n,e){return function(t,r){e(t,r,n)}}function az(n,e,t,r,i,a){function o(m){if(m!==void 0&&typeof m!="function")throw new TypeError("Function expected");return m}for(var s=r.kind,l=s==="getter"?"get":s==="setter"?"set":"value",c=!e&&n?r.static?n:n.prototype:null,u=e||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),h,f=!1,d=t.length-1;d>=0;d--){var p={};for(var v in r)p[v]=v==="access"?{}:r[v];for(var v in r.access)p.access[v]=r.access[v];p.addInitializer=function(m){if(f)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(m||null))};var g=(0,t[d])(s==="accessor"?{get:u.get,set:u.set}:u[l],p);if(s==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(h=o(g.get))&&(u.get=h),(h=o(g.set))&&(u.set=h),(h=o(g.init))&&i.unshift(h)}else(h=o(g))&&(s==="field"?i.unshift(h):u[l]=h)}c&&Object.defineProperty(c,r.name,u),f=!0}function oz(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0}function sz(n){return typeof n=="symbol"?n:"".concat(n)}function lz(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function wS(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function SS(n,e,t,r){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):i(u.value).then(s,l)}c((r=r.apply(n,e||[])).next())})}function _S(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(r=1,i&&(a=c[0]&2?i.return:c[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,c[1])).done)return a;switch(i=0,a&&(c=[c[0]&2,a.value]),c[0]){case 0:case 1:a=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){t.label=c[1];break}if(c[0]===6&&t.label<a[1]){t.label=a[1],a=c;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(c);break}a[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],i=0}finally{r=a=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var Jf=Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]};function TS(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Jf(e,n,t)}function Qf(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function lm(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function PS(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(lm(arguments[e]));return n}function MS(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function td(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function ml(n){return this instanceof ml?(this.v=n,this):new ml(n)}function CS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,a=[];return i={},s("next"),s("throw"),s("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(d){return function(p){return Promise.resolve(p).then(d,h)}}function s(d,p){r[d]&&(i[d]=function(v){return new Promise(function(g,m){a.push([d,v,g,m])>1||l(d,v)})},p&&(i[d]=p(i[d])))}function l(d,p){try{c(r[d](p))}catch(v){f(a[0][3],v)}}function c(d){d.value instanceof ml?Promise.resolve(d.value.v).then(u,h):f(a[0][2],d)}function u(d){l("next",d)}function h(d){l("throw",d)}function f(d,p){d(p),a.shift(),a.length&&l(a[0][0],a[0][1])}}function OS(n){var e,t;return e={},r("next"),r("throw",function(i){throw i}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(i,a){e[i]=n[i]?function(o){return(t=!t)?{value:ml(n[i](o)),done:!1}:a?a(o):o}:a}}function AS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Qf=="function"?Qf(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(s,l){o=n[a](o),i(s,l,o.done,o.value)})}}function i(a,o,s,l){Promise.resolve(l).then(function(c){a({value:c,done:s})},o)}}function NS(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var RS=Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e};function kS(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&Jf(e,n,t);return RS(e,n),e}function LS(n){return n&&n.__esModule?n:{default:n}}function IS(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function DS(n,e,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t}function BS(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function FS(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var GS=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function zS(n){function e(r){n.error=n.hasError?new GS(r,n.error,"An error was suppressed during disposal."):r,n.hasError=!0}function t(){for(;n.stack.length;){var r=n.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(t,function(a){return e(a),t()})}catch(a){e(a)}}if(n.hasError)throw n.error}return t()}var cz={__extends:yS,__assign:ga,__rest:xS,__decorate:bS,__param:ES,__metadata:wS,__awaiter:SS,__generator:_S,__createBinding:Jf,__exportStar:TS,__values:Qf,__read:lm,__spread:PS,__spreadArrays:MS,__spreadArray:td,__await:ml,__asyncGenerator:CS,__asyncDelegator:OS,__asyncValues:AS,__makeTemplateObject:NS,__importStar:kS,__importDefault:LS,__classPrivateFieldGet:IS,__classPrivateFieldSet:DS,__classPrivateFieldIn:BS,__addDisposableResource:FS,__disposeResources:zS},yl={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function cm(n){return Array.isArray(n)&&n.every(function(e){var t=e[0].toLowerCase();return yl[t]===e.length-1&&"achlmqstvz".includes(t)})}function um(n){return cm(n)&&n.every(function(e){var t=e[0];return t===t.toUpperCase()})}function hm(n){return um(n)&&n.every(function(e){var t=e[0];return"ACLMQZ".includes(t)})}var fm={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function dm(n){for(var e=n.pathValue[n.segmentStart],t=e.toLowerCase(),r=n.data;r.length>=yl[t]&&(t==="m"&&r.length>2?(n.segments.push([e].concat(r.splice(0,2))),t="l",e=e==="m"?"l":"L"):n.segments.push([e].concat(r.splice(0,yl[t]))),!!yl[t]););}function WS(n){var e=n.index,t=n.pathValue,r=t.charCodeAt(e);if(r===48){n.param=0,n.index+=1;return}if(r===49){n.param=1,n.index+=1;return}n.err='[path-util]: invalid Arc flag "'+t[e]+'", expecting 0 or 1 at index '+e}function US(n){return n>=48&&n<=57||n===43||n===45||n===46}function cs(n){return n>=48&&n<=57}function VS(n){var e=n.max,t=n.pathValue,r=n.index,i=r,a=!1,o=!1,s=!1,l=!1,c;if(i>=e){n.err="[path-util]: Invalid path value at index "+i+', "pathValue" is missing param';return}if(c=t.charCodeAt(i),(c===43||c===45)&&(i+=1,c=t.charCodeAt(i)),!cs(c)&&c!==46){n.err="[path-util]: Invalid path value at index "+i+', "'+t[i]+'" is not a number';return}if(c!==46){if(a=c===48,i+=1,c=t.charCodeAt(i),a&&i<e&&c&&cs(c)){n.err="[path-util]: Invalid path value at index "+r+', "'+t[r]+'" illegal number';return}for(;i<e&&cs(t.charCodeAt(i));)i+=1,o=!0;c=t.charCodeAt(i)}if(c===46){for(l=!0,i+=1;cs(t.charCodeAt(i));)i+=1,s=!0;c=t.charCodeAt(i)}if(c===101||c===69){if(l&&!o&&!s){n.err="[path-util]: Invalid path value at index "+i+', "'+t[i]+'" invalid float exponent';return}if(i+=1,c=t.charCodeAt(i),(c===43||c===45)&&(i+=1),i<e&&cs(t.charCodeAt(i)))for(;i<e&&cs(t.charCodeAt(i));)i+=1;else{n.err="[path-util]: Invalid path value at index "+i+', "'+t[i]+'" invalid integer exponent';return}}n.index=i,n.param=+n.pathValue.slice(r,i)}function HS(n){var e=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return n===10||n===13||n===8232||n===8233||n===32||n===9||n===11||n===12||n===160||n>=5760&&e.includes(n)}function zc(n){for(var e=n.pathValue,t=n.max;n.index<t&&HS(e.charCodeAt(n.index));)n.index+=1}function YS(n){switch(n|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function XS(n){return(n|32)===97}function jS(n){var e=n.max,t=n.pathValue,r=n.index,i=t.charCodeAt(r),a=yl[t[r].toLowerCase()];if(n.segmentStart=r,!YS(i)){n.err='[path-util]: Invalid path value "'+t[r]+'" is not a path command';return}if(n.index+=1,zc(n),n.data=[],!a){dm(n);return}for(;;){for(var o=a;o>0;o-=1){if(XS(i)&&(o===3||o===4)?WS(n):VS(n),n.err.length)return;n.data.push(n.param),zc(n),n.index<e&&t.charCodeAt(n.index)===44&&(n.index+=1,zc(n))}if(n.index>=n.max||!US(t.charCodeAt(n.index)))break}dm(n)}var $S=function(){function n(e){this.pathValue=e,this.segments=[],this.max=e.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return n}();function KS(n){if(cm(n))return[].concat(n);var e=new $S(n);for(zc(e);e.index<e.max&&!e.err.length;)jS(e);return e.err?e.err:e.segments}function ZS(n){if(um(n))return[].concat(n);var e=KS(n),t=0,r=0,i=0,a=0;return e.map(function(o){var s=o.slice(1).map(Number),l=o[0],c=l.toUpperCase();if(l==="M")return t=s[0],r=s[1],i=t,a=r,["M",t,r];var u;if(l!==c)switch(c){case"A":u=[c,s[0],s[1],s[2],s[3],s[4],s[5]+t,s[6]+r];break;case"V":u=[c,s[0]+r];break;case"H":u=[c,s[0]+t];break;default:{var h=s.map(function(d,p){return d+(p%2?r:t)});u=[c].concat(h)}}else u=[c].concat(s);var f=u.length;switch(c){case"Z":t=i,r=a;break;case"H":t=u[1];break;case"V":r=u[1];break;default:t=u[f-2],r=u[f-1],c==="M"&&(i=t,a=r)}return u})}function qS(n,e){var t=n[0],r=e.x1,i=e.y1,a=e.x2,o=e.y2,s=n.slice(1).map(Number),l=n;if("TQ".includes(t)||(e.qx=null,e.qy=null),t==="H")l=["L",n[1],i];else if(t==="V")l=["L",r,n[1]];else if(t==="S"){var c=r*2-a,u=i*2-o;e.x1=c,e.y1=u,l=["C",c,u].concat(s)}else if(t==="T"){var h=r*2-e.qx,f=i*2-e.qy;e.qx=h,e.qy=f,l=["Q",h,f].concat(s)}else if(t==="Q"){var d=s[0],p=s[1];e.qx=d,e.qy=p}return l}function Da(n){if(hm(n))return[].concat(n);for(var e=ZS(n),t=ga({},fm),r=0;r<e.length;r+=1){e[r]=qS(e[r],t);var i=e[r],a=i.length;t.x1=+i[a-2],t.y1=+i[a-1],t.x2=+i[a-4]||t.x1,t.y2=+i[a-3]||t.y1}return e}function Ba(n,e,t){var r=n[0],i=n[1],a=e[0],o=e[1];return[r+(a-r)*t,i+(o-i)*t]}function ed(n,e,t,r,i){var a=Pr([n,e],[t,r]),o={x:0,y:0};if(typeof i=="number")if(i<=0)o={x:n,y:e};else if(i>=a)o={x:t,y:r};else{var s=Ba([n,e],[t,r],i/a),l=s[0],c=s[1];o={x:l,y:c}}return{length:a,point:o,min:{x:Math.min(n,t),y:Math.min(e,r)},max:{x:Math.max(n,t),y:Math.max(e,r)}}}function pm(n,e){var t=n.x,r=n.y,i=e.x,a=e.y,o=t*i+r*a,s=Math.sqrt((Math.pow(t,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(a,2))),l=t*a-r*i<0?-1:1,c=l*Math.acos(o/s);return c}function JS(n,e,t,r,i,a,o,s,l,c){var u=Math.abs,h=Math.sin,f=Math.cos,d=Math.sqrt,p=Math.PI,v=u(t),g=u(r),m=(i%360+360)%360,x=m*(p/180);if(n===s&&e===l)return{x:n,y:e};if(v===0||g===0)return ed(n,e,s,l,c).point;var S=(n-s)/2,T=(e-l)/2,b={x:f(x)*S+h(x)*T,y:-h(x)*S+f(x)*T},y=Math.pow(b.x,2)/Math.pow(v,2)+Math.pow(b.y,2)/Math.pow(g,2);y>1&&(v*=d(y),g*=d(y));var E=Math.pow(v,2)*Math.pow(g,2)-Math.pow(v,2)*Math.pow(b.y,2)-Math.pow(g,2)*Math.pow(b.x,2),w=Math.pow(v,2)*Math.pow(b.y,2)+Math.pow(g,2)*Math.pow(b.x,2),C=E/w;C=C<0?0:C;var M=(a!==o?1:-1)*d(C),O={x:M*(v*b.y/g),y:M*(-(g*b.x)/v)},A={x:f(x)*O.x-h(x)*O.y+(n+s)/2,y:h(x)*O.x+f(x)*O.y+(e+l)/2},R={x:(b.x-O.x)/v,y:(b.y-O.y)/g},L=pm({x:1,y:0},R),z={x:(-b.x-O.x)/v,y:(-b.y-O.y)/g},Y=pm(R,z);!o&&Y>0?Y-=2*p:o&&Y<0&&(Y+=2*p),Y%=2*p;var I=L+Y*c,q=v*f(I),J=g*h(I),wt={x:f(x)*q-h(x)*J+A.x,y:h(x)*q+f(x)*J+A.y};return wt}function QS(n,e,t,r,i,a,o,s,l,c,u){var h,f=u.bbox,d=f===void 0?!0:f,p=u.length,v=p===void 0?!0:p,g=u.sampleSize,m=g===void 0?30:g,x=typeof c=="number",S=n,T=e,b=0,y=[S,T,b],E=[S,T],w=0,C={x:0,y:0},M=[{x:S,y:T}];x&&c<=0&&(C={x:S,y:T});for(var O=0;O<=m;O+=1){if(w=O/m,h=JS(n,e,t,r,i,a,o,s,l,w),S=h.x,T=h.y,d&&M.push({x:S,y:T}),v&&(b+=Pr(E,[S,T])),E=[S,T],x&&b>=c&&c>y[2]){var A=(b-c)/(b-y[2]);C={x:E[0]*(1-A)+y[0]*A,y:E[1]*(1-A)+y[1]*A}}y=[S,T,b]}return x&&c>=b&&(C={x:s,y:l}),{length:b,point:C,min:{x:Math.min.apply(null,M.map(function(R){return R.x})),y:Math.min.apply(null,M.map(function(R){return R.y}))},max:{x:Math.max.apply(null,M.map(function(R){return R.x})),y:Math.max.apply(null,M.map(function(R){return R.y}))}}}function t_(n,e,t,r,i,a,o,s,l){var c=1-l;return{x:Math.pow(c,3)*n+3*Math.pow(c,2)*l*t+3*c*Math.pow(l,2)*i+Math.pow(l,3)*o,y:Math.pow(c,3)*e+3*Math.pow(c,2)*l*r+3*c*Math.pow(l,2)*a+Math.pow(l,3)*s}}function vm(n,e,t,r,i,a,o,s,l,c){var u,h=c.bbox,f=h===void 0?!0:h,d=c.length,p=d===void 0?!0:d,v=c.sampleSize,g=v===void 0?10:v,m=typeof l=="number",x=n,S=e,T=0,b=[x,S,T],y=[x,S],E=0,w={x:0,y:0},C=[{x,y:S}];m&&l<=0&&(w={x,y:S});for(var M=0;M<=g;M+=1){if(E=M/g,u=t_(n,e,t,r,i,a,o,s,E),x=u.x,S=u.y,f&&C.push({x,y:S}),p&&(T+=Pr(y,[x,S])),y=[x,S],m&&T>=l&&l>b[2]){var O=(T-l)/(T-b[2]);w={x:y[0]*(1-O)+b[0]*O,y:y[1]*(1-O)+b[1]*O}}b=[x,S,T]}return m&&l>=T&&(w={x:o,y:s}),{length:T,point:w,min:{x:Math.min.apply(null,C.map(function(A){return A.x})),y:Math.min.apply(null,C.map(function(A){return A.y}))},max:{x:Math.max.apply(null,C.map(function(A){return A.x})),y:Math.max.apply(null,C.map(function(A){return A.y}))}}}function e_(n,e,t,r,i,a,o){var s=1-o;return{x:Math.pow(s,2)*n+2*s*o*t+Math.pow(o,2)*i,y:Math.pow(s,2)*e+2*s*o*r+Math.pow(o,2)*a}}function n_(n,e,t,r,i,a,o,s){var l,c=s.bbox,u=c===void 0?!0:c,h=s.length,f=h===void 0?!0:h,d=s.sampleSize,p=d===void 0?10:d,v=typeof o=="number",g=n,m=e,x=0,S=[g,m,x],T=[g,m],b=0,y={x:0,y:0},E=[{x:g,y:m}];v&&o<=0&&(y={x:g,y:m});for(var w=0;w<=p;w+=1){if(b=w/p,l=e_(n,e,t,r,i,a,b),g=l.x,m=l.y,u&&E.push({x:g,y:m}),f&&(x+=Pr(T,[g,m])),T=[g,m],v&&x>=o&&o>S[2]){var C=(x-o)/(x-S[2]);y={x:T[0]*(1-C)+S[0]*C,y:T[1]*(1-C)+S[1]*C}}S=[g,m,x]}return v&&o>=x&&(y={x:i,y:a}),{length:x,point:y,min:{x:Math.min.apply(null,E.map(function(M){return M.x})),y:Math.min.apply(null,E.map(function(M){return M.y}))},max:{x:Math.max.apply(null,E.map(function(M){return M.x})),y:Math.max.apply(null,E.map(function(M){return M.y}))}}}function gm(n,e,t){for(var r,i,a,o,s,l,c=Da(n),u=typeof e=="number",h,f=[],d,p=0,v=0,g=0,m=0,x,S=[],T=[],b=0,y={x:0,y:0},E=y,w=y,C=y,M=0,O=0,A=c.length;O<A;O+=1)x=c[O],d=x[0],h=d==="M",f=h?f:[p,v].concat(x.slice(1)),h?(g=x[1],m=x[2],y={x:g,y:m},E=y,b=0,u&&e<.001&&(C=y)):d==="L"?(r=ed(f[0],f[1],f[2],f[3],(e||0)-M),b=r.length,y=r.min,E=r.max,w=r.point):d==="A"?(i=QS(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],(e||0)-M,t||{}),b=i.length,y=i.min,E=i.max,w=i.point):d==="C"?(a=vm(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],(e||0)-M,t||{}),b=a.length,y=a.min,E=a.max,w=a.point):d==="Q"?(o=n_(f[0],f[1],f[2],f[3],f[4],f[5],(e||0)-M,t||{}),b=o.length,y=o.min,E=o.max,w=o.point):d==="Z"&&(f=[p,v,g,m],s=ed(f[0],f[1],f[2],f[3],(e||0)-M),b=s.length,y=s.min,E=s.max,w=s.point),u&&M<e&&M+b>=e&&(C=w),T.push(E),S.push(y),M+=b,l=d!=="Z"?x.slice(-2):[g,m],p=l[0],v=l[1];return u&&e>=M&&(C={x:p,y:v}),{length:M,point:C,min:{x:Math.min.apply(null,S.map(function(R){return R.x})),y:Math.min.apply(null,S.map(function(R){return R.y}))},max:{x:Math.max.apply(null,T.map(function(R){return R.x})),y:Math.max.apply(null,T.map(function(R){return R.y}))}}}function nd(n,e){return gm(n,void 0,ga(ga({},e),{bbox:!1,length:!0})).length}var tr=function(n){return Array.isArray?Array.isArray(n):ls(n,"Array")},Fa=function(n){if(tr(n))return n.reduce(function(e,t){return Math.min(e,t)},n[0])},Ga=function(n){if(tr(n))return n.reduce(function(e,t){return Math.max(e,t)},n[0])},r_=1e-5;function Co(n,e,t){return t===void 0&&(t=r_),Math.abs(n-e)<t}var i_=function(n,e){return(n%e+e)%e},us=i_;function a_(n,e,t){if(n[t].length>7){n[t].shift();for(var r=n[t],i=t;r.length;)e[t]="A",n.splice(i+=1,0,["C"].concat(r.splice(0,6)));n.splice(t,1)}}function o_(n){return hm(n)&&n.every(function(e){var t=e[0];return"MC".includes(t)})}function Wc(n,e,t){var r=n*Math.cos(t)-e*Math.sin(t),i=n*Math.sin(t)+e*Math.cos(t);return{x:r,y:i}}function rd(n,e,t,r,i,a,o,s,l,c){var u=n,h=e,f=t,d=r,p=s,v=l,g=Math.PI*120/180,m=Math.PI/180*(+i||0),x=[],S,T,b,y,E;if(c)T=c[0],b=c[1],y=c[2],E=c[3];else{S=Wc(u,h,-m),u=S.x,h=S.y,S=Wc(p,v,-m),p=S.x,v=S.y;var w=(u-p)/2,C=(h-v)/2,M=w*w/(f*f)+C*C/(d*d);M>1&&(M=Math.sqrt(M),f*=M,d*=M);var O=f*f,A=d*d,R=(a===o?-1:1)*Math.sqrt(Math.abs((O*A-O*C*C-A*w*w)/(O*C*C+A*w*w)));y=R*f*C/d+(u+p)/2,E=R*-d*w/f+(h+v)/2,T=Math.asin(((h-E)/d*Math.pow(10,9)>>0)/Math.pow(10,9)),b=Math.asin(((v-E)/d*Math.pow(10,9)>>0)/Math.pow(10,9)),T=u<y?Math.PI-T:T,b=p<y?Math.PI-b:b,T<0&&(T=Math.PI*2+T),b<0&&(b=Math.PI*2+b),o&&T>b&&(T-=Math.PI*2),!o&&b>T&&(b-=Math.PI*2)}var L=b-T;if(Math.abs(L)>g){var z=b,Y=p,I=v;b=T+g*(o&&b>T?1:-1),p=y+f*Math.cos(b),v=E+d*Math.sin(b),x=rd(p,v,f,d,i,0,o,Y,I,[b,z,y,E])}L=b-T;var q=Math.cos(T),J=Math.sin(T),wt=Math.cos(b),Ft=Math.sin(b),fe=Math.tan(L/4),xe=4/3*f*fe,Sr=4/3*d*fe,jr=[u,h],zn=[u+xe*J,h-Sr*q],rn=[p+xe*Ft,v-Sr*wt],On=[p,v];if(zn[0]=2*jr[0]-zn[0],zn[1]=2*jr[1]-zn[1],c)return zn.concat(rn,On,x);x=zn.concat(rn,On,x);for(var di=[],cr=0,$r=x.length;cr<$r;cr+=1)di[cr]=cr%2?Wc(x[cr-1],x[cr],m).y:Wc(x[cr],x[cr+1],m).x;return di}function s_(n,e,t,r,i,a){var o=.3333333333333333,s=2/3;return[o*n+s*t,o*e+s*r,o*i+s*t,o*a+s*r,i,a]}var mm=function(n,e,t,r){var i=.5,a=Ba([n,e],[t,r],i);return td(td([],a,!0),[t,r,t,r],!1)};function l_(n,e){var t=n[0],r=n.slice(1).map(Number),i=r[0],a=r[1],o,s=e.x1,l=e.y1,c=e.x,u=e.y;switch("TQ".includes(t)||(e.qx=null,e.qy=null),t){case"M":return e.x=i,e.y=a,n;case"A":return o=[s,l].concat(r),["C"].concat(rd(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9]));case"Q":return e.qx=i,e.qy=a,o=[s,l].concat(r),["C"].concat(s_(o[0],o[1],o[2],o[3],o[4],o[5]));case"L":return["C"].concat(mm(s,l,i,a));case"Z":return s===c&&l===u?["C",s,l,c,u,c,u]:["C"].concat(mm(s,l,c,u));default:}return n}function Oo(n,e){if(e===void 0&&(e=!1),o_(n)){var t=[].concat(n);return e?[t,[]]:t}for(var r=Da(n),i=ga({},fm),a=[],o="",s=r.length,l,c,u=[],h=0;h<s;h+=1){r[h]&&(o=r[h][0]),a[h]=o;var f=l_(r[h],i);r[h]=f,a_(r,a,h),s=r.length,o==="Z"&&u.push(h),l=r[h],c=l.length,i.x1=+l[c-2],i.y1=+l[c-1],i.x2=+l[c-4]||i.x1,i.y2=+l[c-3]||i.y1}return e?[r,u]:r}function c_(n,e){e===void 0&&(e=.5);var t=n.slice(0,2),r=n.slice(2,4),i=n.slice(4,6),a=n.slice(6,8),o=Ba(t,r,e),s=Ba(r,i,e),l=Ba(i,a,e),c=Ba(o,s,e),u=Ba(s,l,e),h=Ba(c,u,e);return[["C"].concat(o,c,h),["C"].concat(u,l,a)]}function ym(n){return n.map(function(e,t,r){var i=t&&r[t-1].slice(-2).concat(e.slice(1)),a=t?vm(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0,o;return t?o=a?c_(i):[e,e]:o=[e],{s:e,ss:o,l:a}})}function Uc(n,e,t){var r=ym(n),i=ym(e),a=r.length,o=i.length,s=r.filter(function(g){return g.l}).length,l=i.filter(function(g){return g.l}).length,c=r.filter(function(g){return g.l}).reduce(function(g,m){var x=m.l;return g+x},0)/s||0,u=i.filter(function(g){return g.l}).reduce(function(g,m){var x=m.l;return g+x},0)/l||0,h=t||Math.max(a,o),f=[c,u],d=[h-a,h-o],p=0,v=[r,i].map(function(g,m){return g.l===h?g.map(function(x){return x.s}):g.map(function(x,S){return p=S&&d[m]&&x.l>=f[m],d[m]-=p?1:0,p?x.ss:[x.s]}).flat()});return v[0].length===v[1].length?v:Uc(v[0],v[1],h)}function u_(n,e,t,r,i,a,o,s){return 3*((s-e)*(t+i)-(o-n)*(r+a)+r*(n-i)-t*(e-a)+s*(i+n/3)-o*(a+e/3))/20}function h_(n){var e=0,t=0,r=0;return Oo(n).map(function(i){var a;switch(i[0]){case"M":return e=i[1],t=i[2],0;default:var o=i.slice(1),s=o[0],l=o[1],c=o[2],u=o[3],h=o[4],f=o[5];return r=u_(e,t,s,l,c,u,h,f),a=i.slice(-2),e=a[0],t=a[1],r}}).reduce(function(i,a){return i+a},0)}function hs(n){return h_(n)>=0}function id(n){var e=n.slice(1).map(function(t,r,i){return r?i[r-1].slice(-2).concat(t.slice(1)):n[0].slice(1).concat(t.slice(1))}).map(function(t){return t.map(function(r,i){return t[t.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(e[0].slice(0,2))].concat(e.map(function(t){return["C"].concat(t.slice(2))}))}function ad(n){return n.map(function(e){return Array.isArray(e)?[].concat(e):e})}function f_(n){var e=n.length,t=e-1;return n.map(function(r,i){return n.map(function(a,o){var s=i+o,l;return o===0||n[s]&&n[s][0]==="M"?(l=n[s],["M"].concat(l.slice(-2))):(s>=e&&(s-=t),n[s])})})}function od(n,e){var t=n.length-1,r=[],i=0,a=0,o=f_(n);return o.forEach(function(s,l){n.slice(1).forEach(function(c,u){a+=Pr(n[(l+u)%t].slice(-2),e[u%t].slice(-2))}),r[l]=a,a=0}),i=r.indexOf(Math.min.apply(null,r)),o[i]}var d_=function(n){return n===void 0},yt=d_,p_=function(n){return ls(n,"Boolean")},za=p_,Ye=function(n){var e=typeof n;return n!==null&&e==="object"||e==="function"};function sd(n,e,t){return gm(n,e,ga(ga({},t),{bbox:!1,length:!0})).point}var ld=D(93951),cd=function(n,e){return cd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},cd(n,e)};function v_(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");cd(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ud=function(){return ud=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},ud.apply(this,arguments)};function g_(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function m_(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(o=n[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function y_(n,e){return function(t,r){e(t,r,n)}}function uz(n,e,t,r,i,a){function o(m){if(m!==void 0&&typeof m!="function")throw new TypeError("Function expected");return m}for(var s=r.kind,l=s==="getter"?"get":s==="setter"?"set":"value",c=!e&&n?r.static?n:n.prototype:null,u=e||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),h,f=!1,d=t.length-1;d>=0;d--){var p={};for(var v in r)p[v]=v==="access"?{}:r[v];for(var v in r.access)p.access[v]=r.access[v];p.addInitializer=function(m){if(f)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(m||null))};var g=(0,t[d])(s==="accessor"?{get:u.get,set:u.set}:u[l],p);if(s==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(h=o(g.get))&&(u.get=h),(h=o(g.set))&&(u.set=h),(h=o(g.init))&&i.unshift(h)}else(h=o(g))&&(s==="field"?i.unshift(h):u[l]=h)}c&&Object.defineProperty(c,r.name,u),f=!0}function hz(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0}function fz(n){return typeof n=="symbol"?n:"".concat(n)}function dz(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function x_(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function b_(n,e,t,r){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):i(u.value).then(s,l)}c((r=r.apply(n,e||[])).next())})}function E_(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(r=1,i&&(a=c[0]&2?i.return:c[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,c[1])).done)return a;switch(i=0,a&&(c=[c[0]&2,a.value]),c[0]){case 0:case 1:a=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){t.label=c[1];break}if(c[0]===6&&t.label<a[1]){t.label=a[1],a=c;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(c);break}a[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],i=0}finally{r=a=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var hd=Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]};function w_(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&hd(e,n,t)}function fd(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Mr(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function S_(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Mr(arguments[e]));return n}function __(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function Jr(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function xl(n){return this instanceof xl?(this.v=n,this):new xl(n)}function T_(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,a=[];return i={},s("next"),s("throw"),s("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(d){return function(p){return Promise.resolve(p).then(d,h)}}function s(d,p){r[d]&&(i[d]=function(v){return new Promise(function(g,m){a.push([d,v,g,m])>1||l(d,v)})},p&&(i[d]=p(i[d])))}function l(d,p){try{c(r[d](p))}catch(v){f(a[0][3],v)}}function c(d){d.value instanceof xl?Promise.resolve(d.value.v).then(u,h):f(a[0][2],d)}function u(d){l("next",d)}function h(d){l("throw",d)}function f(d,p){d(p),a.shift(),a.length&&l(a[0][0],a[0][1])}}function P_(n){var e,t;return e={},r("next"),r("throw",function(i){throw i}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(i,a){e[i]=n[i]?function(o){return(t=!t)?{value:xl(n[i](o)),done:!1}:a?a(o):o}:a}}function M_(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof fd=="function"?fd(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(s,l){o=n[a](o),i(s,l,o.done,o.value)})}}function i(a,o,s,l){Promise.resolve(l).then(function(c){a({value:c,done:s})},o)}}function C_(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var O_=Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e};function A_(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&hd(e,n,t);return O_(e,n),e}function N_(n){return n&&n.__esModule?n:{default:n}}function R_(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function k_(n,e,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t}function L_(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function I_(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var D_=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function B_(n){function e(r){n.error=n.hasError?new D_(r,n.error,"An error was suppressed during disposal."):r,n.hasError=!0}function t(){for(;n.stack.length;){var r=n.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(t,function(a){return e(a),t()})}catch(a){e(a)}}if(n.hasError)throw n.error}return t()}var pz={__extends:v_,__assign:ud,__rest:g_,__decorate:m_,__param:y_,__metadata:x_,__awaiter:b_,__generator:E_,__createBinding:hd,__exportStar:w_,__values:fd,__read:Mr,__spread:S_,__spreadArrays:__,__spreadArray:Jr,__await:xl,__asyncGenerator:T_,__asyncDelegator:P_,__asyncValues:M_,__makeTemplateObject:C_,__importStar:A_,__importDefault:N_,__classPrivateFieldGet:R_,__classPrivateFieldSet:k_,__classPrivateFieldIn:L_,__addDisposableResource:I_,__disposeResources:B_};function er(n,e,t,r){var i=n-t,a=e-r;return Math.sqrt(i*i+a*a)}function Vc(n,e){var t=Math.min.apply(Math,Jr([],Mr(n),!1)),r=Math.min.apply(Math,Jr([],Mr(e),!1)),i=Math.max.apply(Math,Jr([],Mr(n),!1)),a=Math.max.apply(Math,Jr([],Mr(e),!1));return{x:t,y:r,width:i-t,height:a-r}}function xm(n){return(n+Math.PI*2)%(Math.PI*2)}function bm(n,e){var t=Math.abs(n);return e>0?t:t*-1}function F_(n,e,t,r,i,a){var o=t,s=r;if(o===0||s===0)return{x:n,y:e};for(var l=i-n,c=a-e,u=Math.abs(l),h=Math.abs(c),f=o*o,d=s*s,p=Math.PI/4,v=0,g=0,m=0;m<4;m++){v=o*Math.cos(p),g=s*Math.sin(p);var x=(f-d)*Math.pow(Math.cos(p),3)/o,S=(d-f)*Math.pow(Math.sin(p),3)/s,T=v-x,b=g-S,y=u-x,E=h-S,w=Math.hypot(b,T),C=Math.hypot(E,y),M=w*Math.asin((T*E-b*y)/(w*C)),O=M/Math.sqrt(f+d-v*v-g*g);p+=O,p=Math.min(Math.PI/2,Math.max(0,p))}return{x:n+bm(v,l),y:e+bm(g,c)}}function G_(n,e,t,r,i,a,o,s){return-1*t*Math.cos(i)*Math.sin(s)-r*Math.sin(i)*Math.cos(s)}function z_(n,e,t,r,i,a,o,s){return-1*t*Math.sin(i)*Math.sin(s)+r*Math.cos(i)*Math.cos(s)}function W_(n,e,t){return Math.atan(-e/n*Math.tan(t))}function U_(n,e,t){return Math.atan(e/(n*Math.tan(t)))}function V_(n,e,t,r,i,a){return t*Math.cos(i)*Math.cos(a)-r*Math.sin(i)*Math.sin(a)+n}function H_(n,e,t,r,i,a){return t*Math.sin(i)*Math.cos(a)+r*Math.cos(i)*Math.sin(a)+e}function Y_(n,e,t,r){var i=Math.atan2(r*n,t*e);return(i+Math.PI*2)%(Math.PI*2)}function Em(n,e,t){return{x:n*Math.cos(t),y:e*Math.sin(t)}}function wm(n,e,t){var r=Math.cos(t),i=Math.sin(t);return[n*r-e*i,n*i+e*r]}function dd(n,e,t,r,i,a,o){for(var s=W_(t,r,i),l=1/0,c=-1/0,u=[a,o],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var f=s+h;a<o?a<f&&f<o&&u.push(f):o<f&&f<a&&u.push(f)}for(var h=0;h<u.length;h++){var d=V_(n,e,t,r,i,u[h]);d<l&&(l=d),d>c&&(c=d)}for(var p=U_(t,r,i),v=1/0,g=-1/0,m=[a,o],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var x=p+h;a<o?a<x&&x<o&&m.push(x):o<x&&x<a&&m.push(x)}for(var h=0;h<m.length;h++){var S=H_(n,e,t,r,i,m[h]);S<v&&(v=S),S>g&&(g=S)}return{x:l,y:v,width:c-l,height:g-v}}function vz(n,e,t,r,i,a,o,s,l){var c=wm(s-n,l-e,-i),u=__read(c,2),h=u[0],f=u[1],d=F_(0,0,t,r,h,f),p=Y_(t,r,d.x,d.y);p<a?d=Em(t,r,a):p>o&&(d=Em(t,r,o));var v=wm(d.x,d.y,i);return{x:v[0]+n,y:v[1]+e}}function gz(n,e,t,r,i,a,o,s){var l=(o-a)*s+a,c=G_(n,e,t,r,i,a,o,l),u=z_(n,e,t,r,i,a,o,l);return xm(Math.atan2(u,c))}var X_=1e-4;function Sm(n,e,t,r,i,a){var o=-1,s=1/0,l=[t,r],c=20;a&&a>200&&(c=a/10);for(var u=1/c,h=u/10,f=0;f<=c;f++){var d=f*u,p=[i.apply(void 0,Jr([],Mr(n.concat([d])),!1)),i.apply(void 0,Jr([],Mr(e.concat([d])),!1))],v=er(l[0],l[1],p[0],p[1]);v<s&&(o=d,s=v)}if(o===0)return{x:n[0],y:e[0]};if(o===1){var g=n.length;return{x:n[g-1],y:e[g-1]}}s=1/0;for(var f=0;f<32&&!(h<X_);f++){var m=o-h,x=o+h,p=[i.apply(void 0,Jr([],Mr(n.concat([m])),!1)),i.apply(void 0,Jr([],Mr(e.concat([m])),!1))],v=er(l[0],l[1],p[0],p[1]);if(m>=0&&v<s)o=m,s=v;else{var S=[i.apply(void 0,Jr([],Mr(n.concat([x])),!1)),i.apply(void 0,Jr([],Mr(e.concat([x])),!1))],T=er(l[0],l[1],S[0],S[1]);x<=1&&T<s?(o=x,s=T):h*=.5}}return{x:i.apply(void 0,Jr([],Mr(n.concat([o])),!1)),y:i.apply(void 0,Jr([],Mr(e.concat([o])),!1))}}function j_(n,e){for(var t=0,r=n.length,i=0;i<r;i++){var a=n[i],o=e[i],s=n[(i+1)%r],l=e[(i+1)%r];t+=er(a,o,s,l)}return t/2}function mz(n,e,t,r){return Vc([n,t],[e,r])}function fs(n,e,t,r){return er(n,e,t,r)}function Cr(n,e,t,r,i){return{x:(1-i)*n+i*t,y:(1-i)*e+i*r}}function $_(n,e,t,r,i,a){var o=(t-n)*(i-n)+(r-e)*(a-e);if(o<0)return er(n,e,i,a);var s=(t-n)*(t-n)+(r-e)*(r-e);return o>s?er(t,r,i,a):_m(n,e,t,r,i,a)}function _m(n,e,t,r,i,a){var o=[t-n,r-e];if(va.I6(o,[0,0]))return Math.sqrt((i-n)*(i-n)+(a-e)*(a-e));var s=[-o[1],o[0]];va.Fv(s,s);var l=[i-n,a-e];return Math.abs(va.AK(l,s))}function yz(n,e,t,r){return Math.atan2(r-e,t-n)}function Ao(n,e,t,r,i){var a=1-i;return a*a*a*n+3*e*i*a*a+3*t*i*i*a+r*i*i*i}function Tm(n,e,t,r,i){var a=1-i;return 3*(a*a*(e-n)+2*a*i*(t-e)+i*i*(r-t))}function Pm(n,e,t,r){var i=-3*n+9*e-9*t+3*r,a=6*n-12*e+6*t,o=3*e-3*n,s=[],l,c,u;if(Co(i,0))Co(a,0)||(l=-o/a,l>=0&&l<=1&&s.push(l));else{var h=a*a-4*i*o;Co(h,0)?s.push(-a/(2*i)):h>0&&(u=Math.sqrt(h),l=(-a+u)/(2*i),c=(-a-u)/(2*i),l>=0&&l<=1&&s.push(l),c>=0&&c<=1&&s.push(c))}return s}function K_(n,e,t,r,i,a,o,s,l){var c=Ao(n,t,i,o,l),u=Ao(e,r,a,s,l),h=Cr(n,e,t,r,l),f=Cr(t,r,i,a,l),d=Cr(i,a,o,s,l),p=Cr(h.x,h.y,f.x,f.y,l),v=Cr(f.x,f.y,d.x,d.y,l);return[[n,e,h.x,h.y,p.x,p.y,c,u],[c,u,v.x,v.y,d.x,d.y,o,s]]}function pd(n,e,t,r,i,a,o,s,l){if(l===0)return j_([n,t,i,o],[e,r,a,s]);var c=K_(n,e,t,r,i,a,o,s,.5),u=__spreadArray(__spreadArray([],__read(c[0]),!1),[l-1],!1),h=__spreadArray(__spreadArray([],__read(c[1]),!1),[l-1],!1);return pd.apply(void 0,__spreadArray([],__read(u),!1))+pd.apply(void 0,__spreadArray([],__read(h),!1))}function vd(n,e,t,r,i,a,o,s){for(var l=[n,o],c=[e,s],u=Pm(n,t,i,o),h=Pm(e,r,a,s),f=0;f<u.length;f++)l.push(Ao(n,t,i,o,u[f]));for(var f=0;f<h.length;f++)c.push(Ao(e,r,a,s,h[f]));return Vc(l,c)}function xz(n,e,t,r,i,a,o,s){return pd(n,e,t,r,i,a,o,s,3)}function Z_(n,e,t,r,i,a,o,s,l,c,u){return Sm([n,t,i,o],[e,r,a,s],l,c,Ao,u)}function Mm(n,e,t,r,i,a,o,s,l,c,u){var h=Z_(n,e,t,r,i,a,o,s,l,c,u);return er(h.x,h.y,l,c)}function bz(n,e,t,r,i,a,o,s,l){return{x:Ao(n,t,i,o,l),y:Ao(e,r,a,s,l)}}function Ez(n,e,t,r,i,a,o,s,l){var c=Tm(n,t,i,o,l),u=Tm(e,r,a,s,l);return xm(Math.atan2(u,c))}function Cm(n){for(var e=0,t=[],r=0;r<n.length-1;r++){var i=n[r],a=n[r+1],o=er(i[0],i[1],a[0],a[1]),s={from:i,to:a,length:o};t.push(s),e+=o}return{segments:t,totalLength:e}}function Om(n){if(n.length<2)return 0;for(var e=0,t=0;t<n.length-1;t++){var r=n[t],i=n[t+1];e+=er(r[0],r[1],i[0],i[1])}return e}function Am(n,e){if(e>1||e<0||n.length<2)return null;var t=Cm(n),r=t.segments,i=t.totalLength;if(i===0)return{x:n[0][0],y:n[0][1]};for(var a=0,o=null,s=0;s<r.length;s++){var l=r[s],c=l.from,u=l.to,h=l.length/i;if(e>=a&&e<=a+h){var f=(e-a)/h;o=Cr(c[0],c[1],u[0],u[1],f);break}a+=h}return o}function Nm(n,e){if(e>1||e<0||n.length<2)return 0;for(var t=Cm(n),r=t.segments,i=t.totalLength,a=0,o=0,s=0;s<r.length;s++){var l=r[s],c=l.from,u=l.to,h=l.length/i;if(e>=a&&e<=a+h){o=Math.atan2(u[1]-c[1],u[0]-c[0]);break}a+=h}return o}function Rm(n,e,t){for(var r=1/0,i=0;i<n.length-1;i++){var a=n[i],o=n[i+1],s=$_(a[0],a[1],o[0],o[1],e,t);s<r&&(r=s)}return r}function q_(n){for(var e=[],t=[],r=0;r<n.length;r++){var i=n[r];e.push(i[0]),t.push(i[1])}return Vc(e,t)}function gd(n){return Om(n)}function wz(n,e){return Am(n,e)}function Sz(n,e,t){return Rm(n,e,t)}function _z(n,e){return Nm(n,e)}function Hc(n){var e=n.slice(0);return n.length&&e.push(n[0]),e}function Tz(n){return q_(n)}function Pz(n){return Om(Hc(n))}function Mz(n,e){return Am(Hc(n),e)}function Cz(n,e,t){return Rm(Hc(n),e,t)}function Oz(n,e){return Nm(Hc(n),e)}function bl(n,e,t,r){var i=1-r;return i*i*n+2*r*i*e+r*r*t}function km(n,e,t){var r=n+t-2*e;if(Co(r,0))return[.5];var i=(n-e)/r;return i<=1&&i>=0?[i]:[]}function J_(n,e,t,r,i,a,o){var s=bl(n,t,i,o),l=bl(e,r,a,o),c=Cr(n,e,t,r,o),u=Cr(t,r,i,a,o);return[[n,e,c.x,c.y,s,l],[s,l,u.x,u.y,i,a]]}function md(n,e,t,r,i,a,o){if(o===0)return(er(n,e,t,r)+er(t,r,i,a)+er(n,e,i,a))/2;var s=J_(n,e,t,r,i,a,.5),l=s[0],c=s[1];return l.push(o-1),c.push(o-1),md.apply(void 0,__spreadArray([],__read(l),!1))+md.apply(void 0,__spreadArray([],__read(c),!1))}function yd(n,e,t,r,i,a){var o=km(n,t,i)[0],s=km(e,r,a)[0],l=[n,i],c=[e,a];return o!==void 0&&l.push(bl(n,t,i,o)),s!==void 0&&c.push(bl(e,r,a,s)),Vc(l,c)}function Az(n,e,t,r,i,a){return md(n,e,t,r,i,a,3)}function Q_(n,e,t,r,i,a,o,s){return Sm([n,t,i],[e,r,a],o,s,bl)}function tT(n,e,t,r,i,a,o,s){var l=Q_(n,e,t,r,i,a,o,s);return er(l.x,l.y,o,s)}var eT=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:typeof self!="undefined"?self:{},Lm={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(eT,function(){function t(b,y,E,w,C){r(b,y,E||0,w||b.length-1,C||a)}function r(b,y,E,w,C){for(;w>E;){if(w-E>600){var M=w-E+1,O=y-E+1,A=Math.log(M),R=.5*Math.exp(2*A/3),L=.5*Math.sqrt(A*R*(M-R)/M)*(O-M/2<0?-1:1),z=Math.max(E,Math.floor(y-O*R/M+L)),Y=Math.min(w,Math.floor(y+(M-O)*R/M+L));r(b,y,z,Y,C)}var I=b[y],q=E,J=w;for(i(b,E,y),C(b[w],I)>0&&i(b,E,w);q<J;){for(i(b,q,J),q++,J--;C(b[q],I)<0;)q++;for(;C(b[J],I)>0;)J--}C(b[E],I)===0?i(b,E,J):(J++,i(b,J,w)),J<=y&&(E=J+1),y<=J&&(w=J-1)}}function i(b,y,E){var w=b[y];b[y]=b[E],b[E]=w}function a(b,y){return b<y?-1:b>y?1:0}var o=function(y){y===void 0&&(y=9),this._maxEntries=Math.max(4,y),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(y){var E=this.data,w=[];if(!x(y,E))return w;for(var C=this.toBBox,M=[];E;){for(var O=0;O<E.children.length;O++){var A=E.children[O],R=E.leaf?C(A):A;x(y,R)&&(E.leaf?w.push(A):m(y,R)?this._all(A,w):M.push(A))}E=M.pop()}return w},o.prototype.collides=function(y){var E=this.data;if(!x(y,E))return!1;for(var w=[];E;){for(var C=0;C<E.children.length;C++){var M=E.children[C],O=E.leaf?this.toBBox(M):M;if(x(y,O)){if(E.leaf||m(y,O))return!0;w.push(M)}}E=w.pop()}return!1},o.prototype.load=function(y){if(!(y&&y.length))return this;if(y.length<this._minEntries){for(var E=0;E<y.length;E++)this.insert(y[E]);return this}var w=this._build(y.slice(),0,y.length-1,0);if(!this.data.children.length)this.data=w;else if(this.data.height===w.height)this._splitRoot(this.data,w);else{if(this.data.height<w.height){var C=this.data;this.data=w,w=C}this._insert(w,this.data.height-w.height-1,!0)}return this},o.prototype.insert=function(y){return y&&this._insert(y,this.data.height-1),this},o.prototype.clear=function(){return this.data=S([]),this},o.prototype.remove=function(y,E){if(!y)return this;for(var w=this.data,C=this.toBBox(y),M=[],O=[],A,R,L;w||M.length;){if(w||(w=M.pop(),R=M[M.length-1],A=O.pop(),L=!0),w.leaf){var z=s(y,w.children,E);if(z!==-1)return w.children.splice(z,1),M.push(w),this._condense(M),this}!L&&!w.leaf&&m(w,C)?(M.push(w),O.push(A),A=0,R=w,w=w.children[0]):R?(A++,w=R.children[A],L=!1):w=null}return this},o.prototype.toBBox=function(y){return y},o.prototype.compareMinX=function(y,E){return y.minX-E.minX},o.prototype.compareMinY=function(y,E){return y.minY-E.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(y){return this.data=y,this},o.prototype._all=function(y,E){for(var w=[];y;)y.leaf?E.push.apply(E,y.children):w.push.apply(w,y.children),y=w.pop();return E},o.prototype._build=function(y,E,w,C){var M=w-E+1,O=this._maxEntries,A;if(M<=O)return A=S(y.slice(E,w+1)),l(A,this.toBBox),A;C||(C=Math.ceil(Math.log(M)/Math.log(O)),O=Math.ceil(M/Math.pow(O,C-1))),A=S([]),A.leaf=!1,A.height=C;var R=Math.ceil(M/O),L=R*Math.ceil(Math.sqrt(O));T(y,E,w,L,this.compareMinX);for(var z=E;z<=w;z+=L){var Y=Math.min(z+L-1,w);T(y,z,Y,R,this.compareMinY);for(var I=z;I<=Y;I+=R){var q=Math.min(I+R-1,Y);A.children.push(this._build(y,I,q,C-1))}}return l(A,this.toBBox),A},o.prototype._chooseSubtree=function(y,E,w,C){for(;C.push(E),!(E.leaf||C.length-1===w);){for(var M=1/0,O=1/0,A=void 0,R=0;R<E.children.length;R++){var L=E.children[R],z=d(L),Y=v(y,L)-z;Y<O?(O=Y,M=z<M?z:M,A=L):Y===O&&z<M&&(M=z,A=L)}E=A||E.children[0]}return E},o.prototype._insert=function(y,E,w){var C=w?y:this.toBBox(y),M=[],O=this._chooseSubtree(C,this.data,E,M);for(O.children.push(y),u(O,C);E>=0&&M[E].children.length>this._maxEntries;)this._split(M,E),E--;this._adjustParentBBoxes(C,M,E)},o.prototype._split=function(y,E){var w=y[E],C=w.children.length,M=this._minEntries;this._chooseSplitAxis(w,M,C);var O=this._chooseSplitIndex(w,M,C),A=S(w.children.splice(O,w.children.length-O));A.height=w.height,A.leaf=w.leaf,l(w,this.toBBox),l(A,this.toBBox),E?y[E-1].children.push(A):this._splitRoot(w,A)},o.prototype._splitRoot=function(y,E){this.data=S([y,E]),this.data.height=y.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(y,E,w){for(var C,M=1/0,O=1/0,A=E;A<=w-E;A++){var R=c(y,0,A,this.toBBox),L=c(y,A,w,this.toBBox),z=g(R,L),Y=d(R)+d(L);z<M?(M=z,C=A,O=Y<O?Y:O):z===M&&Y<O&&(O=Y,C=A)}return C||w-E},o.prototype._chooseSplitAxis=function(y,E,w){var C=y.leaf?this.compareMinX:h,M=y.leaf?this.compareMinY:f,O=this._allDistMargin(y,E,w,C),A=this._allDistMargin(y,E,w,M);O<A&&y.children.sort(C)},o.prototype._allDistMargin=function(y,E,w,C){y.children.sort(C);for(var M=this.toBBox,O=c(y,0,E,M),A=c(y,w-E,w,M),R=p(O)+p(A),L=E;L<w-E;L++){var z=y.children[L];u(O,y.leaf?M(z):z),R+=p(O)}for(var Y=w-E-1;Y>=E;Y--){var I=y.children[Y];u(A,y.leaf?M(I):I),R+=p(A)}return R},o.prototype._adjustParentBBoxes=function(y,E,w){for(var C=w;C>=0;C--)u(E[C],y)},o.prototype._condense=function(y){for(var E=y.length-1,w=void 0;E>=0;E--)y[E].children.length===0?E>0?(w=y[E-1].children,w.splice(w.indexOf(y[E]),1)):this.clear():l(y[E],this.toBBox)};function s(b,y,E){if(!E)return y.indexOf(b);for(var w=0;w<y.length;w++)if(E(b,y[w]))return w;return-1}function l(b,y){c(b,0,b.children.length,y,b)}function c(b,y,E,w,C){C||(C=S(null)),C.minX=1/0,C.minY=1/0,C.maxX=-1/0,C.maxY=-1/0;for(var M=y;M<E;M++){var O=b.children[M];u(C,b.leaf?w(O):O)}return C}function u(b,y){return b.minX=Math.min(b.minX,y.minX),b.minY=Math.min(b.minY,y.minY),b.maxX=Math.max(b.maxX,y.maxX),b.maxY=Math.max(b.maxY,y.maxY),b}function h(b,y){return b.minX-y.minX}function f(b,y){return b.minY-y.minY}function d(b){return(b.maxX-b.minX)*(b.maxY-b.minY)}function p(b){return b.maxX-b.minX+(b.maxY-b.minY)}function v(b,y){return(Math.max(y.maxX,b.maxX)-Math.min(y.minX,b.minX))*(Math.max(y.maxY,b.maxY)-Math.min(y.minY,b.minY))}function g(b,y){var E=Math.max(b.minX,y.minX),w=Math.max(b.minY,y.minY),C=Math.min(b.maxX,y.maxX),M=Math.min(b.maxY,y.maxY);return Math.max(0,C-E)*Math.max(0,M-w)}function m(b,y){return b.minX<=y.minX&&b.minY<=y.minY&&y.maxX<=b.maxX&&y.maxY<=b.maxY}function x(b,y){return y.minX<=b.maxX&&y.minY<=b.maxY&&y.maxX>=b.minX&&y.maxY>=b.minY}function S(b){return{children:b,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function T(b,y,E,w,C){for(var M=[y,E];M.length;)if(E=M.pop(),y=M.pop(),!(E-y<=w)){var O=y+Math.ceil((E-y)/w/2)*w;t(b,O,y,E,C),M.push(y,O,O,E)}}return o})})(Lm);var nT=Lm.exports,ct;(function(n){n.GROUP="g",n.CIRCLE="circle",n.ELLIPSE="ellipse",n.IMAGE="image",n.RECT="rect",n.LINE="line",n.POLYLINE="polyline",n.POLYGON="polygon",n.TEXT="text",n.PATH="path",n.HTML="html",n.MESH="mesh"})(ct||(ct={}));var ds;(function(n){n[n.ZERO=0]="ZERO",n[n.NEGATIVE_ONE=1]="NEGATIVE_ONE"})(ds||(ds={}));var No=function(){function n(){this.plugins=[]}return n.prototype.addRenderingPlugin=function(e){this.plugins.push(e),this.context.renderingPlugins.push(e)},n.prototype.removeAllRenderingPlugins=function(){var e=this;this.plugins.forEach(function(t){var r=e.context.renderingPlugins.indexOf(t);r>=0&&e.context.renderingPlugins.splice(r,1)})},n}(),rT=function(){function n(e){this.clipSpaceNearZ=ds.NEGATIVE_ONE,this.plugins=[],this.config=N({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0},e)}return n.prototype.registerPlugin=function(e){var t=this.plugins.findIndex(function(r){return r===e});t===-1&&this.plugins.push(e)},n.prototype.unregisterPlugin=function(e){var t=this.plugins.findIndex(function(r){return r===e});t>-1&&this.plugins.splice(t,1)},n.prototype.getPlugins=function(){return this.plugins},n.prototype.getPlugin=function(e){return this.plugins.find(function(t){return t.name===e})},n.prototype.getConfig=function(){return this.config},n.prototype.setConfig=function(e){Object.assign(this.config,e)},n}();function ps(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function xd(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function Yc(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function Im(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function iT(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n}function aT(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n}function vs(n){return n===void 0?0:n>360||n<-360?n%360:n}function pr(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=0),Array.isArray(n)&&n.length===3?_.d9(n):te(n)?_.al(n,e,t):_.al(n[0],n[1]||e,n[2]||t)}function Ae(n){return n*(Math.PI/180)}function bi(n){return n*(180/Math.PI)}function Nz(n){return n=n%400,n<0&&(n+=400),n/400*360}function Rz(n){return n/360}function oT(n){return 360*n}function sT(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=t*t,s=r*r,l=i*i,c=a*a,u=o+s+l+c,h=t*a-r*i;return h>.499995*u?(n[0]=Math.PI/2,n[1]=2*Math.atan2(r,t),n[2]=0):h<-.499995*u?(n[0]=-Math.PI/2,n[1]=2*Math.atan2(r,t),n[2]=0):(n[0]=Math.asin(2*(t*i-a*r)),n[1]=Math.atan2(2*(t*a+r*i),1-2*(l+c)),n[2]=Math.atan2(2*(t*r+i*a),1-2*(s+l))),n}function lT(n,e){var t,r,i=Math.PI*.5,a=P(He(_.Ue(),e),3),o=a[0],s=a[1],l=a[2],c=Math.asin(-e[2]/o);return c<i?c>-i?(t=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,t=-Math.atan2(e[4]/s,e[5]/s)):(r=0,t=Math.atan2(e[4]/s,e[5]/s)),n[0]=t,n[1]=c,n[2]=r,n}function bd(n,e){return e.length===16?lT(n,e):sT(n,e)}function cT(n,e,t,r,i){var a=Math.cos(n),o=Math.sin(n);return qi.al(r*a,i*o,0,-r*o,i*a,0,e,t,1)}function uT(n,e,t,r,i,a,o,s){s===void 0&&(s=!1);var l=2*a/(t-e),c=2*a/(r-i),u=(t+e)/(t-e),h=(r+i)/(r-i),f,d;return s?(f=-o/(o-a),d=-o*a/(o-a)):(f=-(o+a)/(o-a),d=-2*o*a/(o-a)),n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=u,n[9]=h,n[10]=f,n[11]=-1,n[12]=0,n[13]=0,n[14]=d,n[15]=0,n}function Dm(n){var e=n[0],t=n[1],r=n[3],i=n[4],a=Math.sqrt(e*e+t*t),o=Math.sqrt(r*r+i*i),s=e*i-t*r;s<0&&(e<i?a=-a:o=-o),a&&(e*=1/a,t*=1/a),o&&(r*=1/o,i*=1/o);var l=Math.atan2(t,e),c=bi(l);return[n[6],n[7],a,o,c]}var Ji=Q(),Wi=Q(),El=an(),$t=[_.Ue(),_.Ue(),_.Ue()],Bm=_.Ue();function hT(n,e,t,r,i,a){if(!fT(Ji,n)||(kt(Wi,Ji),Wi[3]=0,Wi[7]=0,Wi[11]=0,Wi[15]=1,Math.abs(Pe(Wi))<1e-8))return!1;var o=Ji[3],s=Ji[7],l=Ji[11],c=Ji[12],u=Ji[13],h=Ji[14],f=Ji[15];if(o!==0||s!==0||l!==0){El[0]=o,El[1]=s,El[2]=l,El[3]=f;var d=Wt(Wi,Wi);if(!d)return!1;Te(Wi,Wi),ln(i,El,Wi)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=c,e[1]=u,e[2]=h,dT($t,Ji),t[0]=_.kE($t[0]),_.Fv($t[0],$t[0]),r[0]=_.AK($t[0],$t[1]),Ed($t[1],$t[1],$t[0],1,-r[0]),t[1]=_.kE($t[1]),_.Fv($t[1],$t[1]),r[0]/=t[1],r[1]=_.AK($t[0],$t[2]),Ed($t[2],$t[2],$t[0],1,-r[1]),r[2]=_.AK($t[1],$t[2]),Ed($t[2],$t[2],$t[1],1,-r[2]),t[2]=_.kE($t[2]),_.Fv($t[2],$t[2]),r[1]/=t[2],r[2]/=t[2],_.kC(Bm,$t[1],$t[2]),_.AK($t[0],Bm)<0)for(var p=0;p<3;p++)t[p]*=-1,$t[p][0]*=-1,$t[p][1]*=-1,$t[p][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+$t[0][0]-$t[1][1]-$t[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-$t[0][0]+$t[1][1]-$t[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-$t[0][0]-$t[1][1]+$t[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+$t[0][0]+$t[1][1]+$t[2][2],0)),$t[2][1]>$t[1][2]&&(a[0]=-a[0]),$t[0][2]>$t[2][0]&&(a[1]=-a[1]),$t[1][0]>$t[0][1]&&(a[2]=-a[2]),!0}function fT(n,e){var t=e[15];if(t===0)return!1;for(var r=1/t,i=0;i<16;i++)n[i]=e[i]*r;return!0}function dT(n,e){n[0][0]=e[0],n[0][1]=e[1],n[0][2]=e[2],n[1][0]=e[4],n[1][1]=e[5],n[1][2]=e[6],n[2][0]=e[8],n[2][1]=e[9],n[2][2]=e[10]}function Ed(n,e,t,r,i){n[0]=e[0]*r+t[0]*i,n[1]=e[1]*r+t[1]*i,n[2]=e[2]*r+t[2]*i}var Fe=function(){function n(){this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return n.isEmpty=function(e){return!e||e.halfExtents[0]===0&&e.halfExtents[1]===0&&e.halfExtents[2]===0},n.prototype.update=function(e,t){ps(this.center,e),ps(this.halfExtents,t),xd(this.min,this.center,this.halfExtents),Yc(this.max,this.center,this.halfExtents)},n.prototype.setMinMax=function(e,t){Yc(this.center,t,e),Im(this.center,this.center,.5),xd(this.halfExtents,t,e),Im(this.halfExtents,this.halfExtents,.5),ps(this.min,e),ps(this.max,t)},n.prototype.getMin=function(){return this.min},n.prototype.getMax=function(){return this.max},n.prototype.add=function(e){if(!n.isEmpty(e)){if(n.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return}var t=this.center,r=t[0],i=t[1],a=t[2],o=this.halfExtents,s=o[0],l=o[1],c=o[2],u=r-s,h=r+s,f=i-l,d=i+l,p=a-c,v=a+c,g=e.center,m=g[0],x=g[1],S=g[2],T=e.halfExtents,b=T[0],y=T[1],E=T[2],w=m-b,C=m+b,M=x-y,O=x+y,A=S-E,R=S+E;w<u&&(u=w),C>h&&(h=C),M<f&&(f=M),O>d&&(d=O),A<p&&(p=A),R>v&&(v=R),t[0]=(u+h)*.5,t[1]=(f+d)*.5,t[2]=(p+v)*.5,o[0]=(h-u)*.5,o[1]=(d-f)*.5,o[2]=(v-p)*.5,this.min[0]=u,this.min[1]=f,this.min[2]=p,this.max[0]=h,this.max[1]=d,this.max[2]=v}},n.prototype.setFromTransformedAABB=function(e,t){var r=this.center,i=this.halfExtents,a=e.center,o=e.halfExtents,s=t[0],l=t[4],c=t[8],u=t[1],h=t[5],f=t[9],d=t[2],p=t[6],v=t[10],g=Math.abs(s),m=Math.abs(l),x=Math.abs(c),S=Math.abs(u),T=Math.abs(h),b=Math.abs(f),y=Math.abs(d),E=Math.abs(p),w=Math.abs(v);r[0]=t[12]+s*a[0]+l*a[1]+c*a[2],r[1]=t[13]+u*a[0]+h*a[1]+f*a[2],r[2]=t[14]+d*a[0]+p*a[1]+v*a[2],i[0]=g*o[0]+m*o[1]+x*o[2],i[1]=S*o[0]+T*o[1]+b*o[2],i[2]=y*o[0]+E*o[1]+w*o[2],xd(this.min,r,i),Yc(this.max,r,i)},n.prototype.intersects=function(e){var t=this.getMax(),r=this.getMin(),i=e.getMax(),a=e.getMin();return r[0]<=i[0]&&t[0]>=a[0]&&r[1]<=i[1]&&t[1]>=a[1]&&r[2]<=i[2]&&t[2]>=a[2]},n.prototype.intersection=function(e){if(!this.intersects(e))return null;var t=new n,r=iT([0,0,0],this.getMin(),e.getMin()),i=aT([0,0,0],this.getMax(),e.getMax());return t.setMinMax(r,i),t},n.prototype.getNegativeFarPoint=function(e){return e.pnVertexFlag===273?ps([0,0,0],this.min):e.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:e.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]},n.prototype.getPositiveFarPoint=function(e){return e.pnVertexFlag===273?ps([0,0,0],this.max):e.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:e.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]},n}(),pT=function(){function n(e,t){this.distance=e||0,this.normal=t||_.al(0,1,0),this.updatePNVertexFlag()}return n.prototype.updatePNVertexFlag=function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)},n.prototype.distanceToPoint=function(e){return _.AK(e,this.normal)-this.distance},n.prototype.normalize=function(){var e=1/_.Zh(this.normal);_.bA(this.normal,this.normal,e),this.distance*=e},n.prototype.intersectsLine=function(e,t,r){var i=this.distanceToPoint(e),a=this.distanceToPoint(t),o=i/(i-a),s=o>=0&&o<=1;return s&&r&&_.t7(r,e,t,o),s},n}(),Wa;(function(n){n[n.OUTSIDE=4294967295]="OUTSIDE",n[n.INSIDE=0]="INSIDE",n[n.INDETERMINATE=2147483647]="INDETERMINATE"})(Wa||(Wa={}));var vT=function(){function n(e){if(this.planes=[],e)this.planes=e;else for(var t=0;t<6;t++)this.planes.push(new pT)}return n.prototype.extractFromVPMatrix=function(e){var t=P(e,16),r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],f=t[9],d=t[10],p=t[11],v=t[12],g=t[13],m=t[14],x=t[15];_.t8(this.planes[0].normal,o-r,u-s,p-h),this.planes[0].distance=x-v,_.t8(this.planes[1].normal,o+r,u+s,p+h),this.planes[1].distance=x+v,_.t8(this.planes[2].normal,o+i,u+l,p+f),this.planes[2].distance=x+g,_.t8(this.planes[3].normal,o-i,u-l,p-f),this.planes[3].distance=x-g,_.t8(this.planes[4].normal,o-a,u-c,p-d),this.planes[4].distance=x-m,_.t8(this.planes[5].normal,o+a,u+c,p+d),this.planes[5].distance=x+m,this.planes.forEach(function(S){S.normalize(),S.updatePNVertexFlag()})},n}(),Wn=function(){function n(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.copyFrom=function(e){this.x=e.x,this.y=e.y},n}(),Ua=function(){function n(e,t,r,i){this.x=e,this.y=t,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=t,this.bottom=t+i}return n.fromRect=function(e){return new n(e.x,e.y,e.width,e.height)},n.applyTransform=function(e,t){var r=fa(e.x,e.y,0,1),i=fa(e.x+e.width,e.y,0,1),a=fa(e.x,e.y+e.height,0,1),o=fa(e.x+e.width,e.y+e.height,0,1),s=an(),l=an(),c=an(),u=an();ln(s,r,t),ln(l,i,t),ln(c,a,t),ln(u,o,t);var h=Math.min(s[0],l[0],c[0],u[0]),f=Math.min(s[1],l[1],c[1],u[1]),d=Math.max(s[0],l[0],c[0],u[0]),p=Math.max(s[1],l[1],c[1],u[1]);return n.fromRect({x:h,y:f,width:d-h,height:p-f})},n.prototype.toJSON=function(){},n}(),Ne="Method not implemented.",gs="Use document.documentElement instead.",gT="Cannot append a destroyed element.",we;(function(n){n[n.ORBITING=0]="ORBITING",n[n.EXPLORING=1]="EXPLORING",n[n.TRACKING=2]="TRACKING"})(we||(we={}));var wl;(function(n){n[n.DEFAULT=0]="DEFAULT",n[n.ROTATIONAL=1]="ROTATIONAL",n[n.TRANSLATIONAL=2]="TRANSLATIONAL",n[n.CINEMATIC=3]="CINEMATIC"})(wl||(wl={}));var Or;(function(n){n[n.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",n[n.PERSPECTIVE=1]="PERSPECTIVE"})(Or||(Or={}));var Fm={UPDATED:"updated"},Gm=2e-4,zm=function(){function n(){this.clipSpaceNearZ=ds.NEGATIVE_ONE,this.eventEmitter=new et,this.matrix=Q(),this.right=_.al(1,0,0),this.up=_.al(0,1,0),this.forward=_.al(0,0,1),this.position=_.al(0,0,1),this.focalPoint=_.al(0,0,0),this.distanceVector=_.al(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=Q(),this.projectionMatrixInverse=Q(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=we.EXPLORING,this.trackingMode=wl.DEFAULT,this.projectionMode=Or.PERSPECTIVE,this.frustum=new vT,this.orthoMatrix=Q()}return n.prototype.isOrtho=function(){return this.projectionMode===Or.ORTHOGRAPHIC},n.prototype.getProjectionMode=function(){return this.projectionMode},n.prototype.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},n.prototype.getPerspectiveInverse=function(){return this.projectionMatrixInverse},n.prototype.getFrustum=function(){return this.frustum},n.prototype.getPosition=function(){return this.position},n.prototype.getFocalPoint=function(){return this.focalPoint},n.prototype.getDollyingStep=function(){return this.dollyingStep},n.prototype.getNear=function(){return this.near},n.prototype.getFar=function(){return this.far},n.prototype.getZoom=function(){return this.zoom},n.prototype.getOrthoMatrix=function(){return this.orthoMatrix},n.prototype.getView=function(){return this.view},n.prototype.setEnableUpdate=function(e){this.enableUpdate=e},n.prototype.setType=function(e,t){return this.type=e,this.type===we.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===we.TRACKING&&t!==void 0&&this.setTrackingMode(t),this},n.prototype.setProjectionMode=function(e){return this.projectionMode=e,this},n.prototype.setTrackingMode=function(e){if(this.type!==we.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this},n.prototype.setWorldRotation=function(e){return this.rotateWorld=e,this._getAngles(),this},n.prototype.getViewTransform=function(){return Wt(Q(),this.matrix)},n.prototype.getWorldTransform=function(){return this.matrix},n.prototype.jitterProjectionMatrix=function(e,t){var r=ue(Q(),[e,t,0]);this.jitteredProjectionMatrix=Ut(Q(),r,this.projectionMatrix)},n.prototype.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},n.prototype.setMatrix=function(e){return this.matrix=e,this._update(),this},n.prototype.setProjectionMatrix=function(e){this.projectionMatrix=e},n.prototype.setFov=function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this},n.prototype.setAspect=function(e){return this.setPerspective(this.near,this.far,this.fov,e),this},n.prototype.setNear=function(e){return this.projectionMode===Or.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this},n.prototype.setFar=function(e){return this.projectionMode===Or.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this},n.prototype.setViewOffset=function(e,t,r,i,a,o){return this.aspect=e/t,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.projectionMode===Or.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},n.prototype.clearViewOffset=function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Or.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},n.prototype.setZoom=function(e){return this.zoom=e,this.projectionMode===Or.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Or.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},n.prototype.setZoomByViewportPoint=function(e,t){var r=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),i=r.x,a=r.y,o=this.roll;this.rotate(0,0,-o),this.setPosition(i,a),this.setFocalPoint(i,a),this.setZoom(e),this.rotate(0,0,o);var s=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),l=s.x,c=s.y,u=_.al(l-i,c-a,0),h=_.AK(u,this.right)/_.kE(this.right),f=_.AK(u,this.up)/_.kE(this.up),d=P(this.getPosition(),2),p=d[0],v=d[1],g=P(this.getFocalPoint(),2),m=g[0],x=g[1];return this.setPosition(p-h,v-f),this.setFocalPoint(m-h,x-f),this},n.prototype.setPerspective=function(e,t,r,i){var a;this.projectionMode=Or.PERSPECTIVE,this.fov=r,this.near=e,this.far=t,this.aspect=i;var o=this.near*Math.tan(Ae(.5*this.fov))/this.zoom,s=2*o,l=this.aspect*s,c=-.5*l;if(!((a=this.view)===null||a===void 0)&&a.enabled){var u=this.view.fullWidth,h=this.view.fullHeight;c+=this.view.offsetX*l/u,o-=this.view.offsetY*s/h,l*=this.view.width/u,s*=this.view.height/h}return uT(this.projectionMatrix,c,c+l,o-s,o,e,this.far,this.clipSpaceNearZ===ds.ZERO),Wt(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},n.prototype.setOrthographic=function(e,t,r,i,a,o){var s;this.projectionMode=Or.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=r,this.bottom=i,this.near=a,this.far=o;var l=(this.rright-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,f=u-l,d=u+l,p=h+c,v=h-c;if(!((s=this.view)===null||s===void 0)&&s.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;f+=g*this.view.offsetX,d=f+g*this.view.width,p-=m*this.view.offsetY,v=p-m*this.view.height}return this.clipSpaceNearZ===ds.NEGATIVE_ONE?Dc(this.projectionMatrix,f,d,p,v,a,o):Bc(this.projectionMatrix,f,d,p,v,a,o),Wt(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},n.prototype.setPosition=function(e,t,r){t===void 0&&(t=this.position[1]),r===void 0&&(r=this.position[2]);var i=pr(e,t,r);return this._setPosition(i),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},n.prototype.setFocalPoint=function(e,t,r){t===void 0&&(t=this.focalPoint[1]),r===void 0&&(r=this.focalPoint[2]);var i=_.al(0,1,0);if(this.focalPoint=pr(e,t,r),this.trackingMode===wl.CINEMATIC){var a=_.$X(_.Ue(),this.focalPoint,this.position);e=a[0],t=a[1],r=a[2];var o=_.kE(a),s=bi(Math.asin(t/o)),l=90+bi(Math.atan2(r,e)),c=Q();ur(c,c,Ae(l)),_r(c,c,Ae(s)),i=_.fF(_.Ue(),[0,1,0],c)}return Wt(this.matrix,Fc(Q(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},n.prototype.getDistance=function(){return this.distance},n.prototype.getDistanceVector=function(){return this.distanceVector},n.prototype.setDistance=function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<Gm&&(this.distance=Gm),this.dollyingStep=this.distance/100;var t=_.Ue();e=this.distance;var r=this.forward,i=this.focalPoint;return t[0]=e*r[0]+i[0],t[1]=e*r[1]+i[1],t[2]=e*r[2]+i[2],this._setPosition(t),this.triggerUpdate(),this},n.prototype.setMaxDistance=function(e){return this.maxDistance=e,this},n.prototype.setMinDistance=function(e){return this.minDistance=e,this},n.prototype.setAzimuth=function(e){return this.azimuth=vs(e),this.computeMatrix(),this._getAxes(),this.type===we.ORBITING||this.type===we.EXPLORING?this._getPosition():this.type===we.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getAzimuth=function(){return this.azimuth},n.prototype.setElevation=function(e){return this.elevation=vs(e),this.computeMatrix(),this._getAxes(),this.type===we.ORBITING||this.type===we.EXPLORING?this._getPosition():this.type===we.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getElevation=function(){return this.elevation},n.prototype.setRoll=function(e){return this.roll=vs(e),this.computeMatrix(),this._getAxes(),this.type===we.ORBITING||this.type===we.EXPLORING?this._getPosition():this.type===we.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getRoll=function(){return this.roll},n.prototype._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},n.prototype.computeMatrix=function(){var e=kn(Vt(),[0,0,1],Ae(this.roll));Xt(this.matrix);var t=kn(Vt(),[1,0,0],Ae((this.rotateWorld&&this.type!==we.TRACKING||this.type===we.TRACKING?1:-1)*this.elevation)),r=kn(Vt(),[0,1,0],Ae((this.rotateWorld&&this.type!==we.TRACKING||this.type===we.TRACKING?1:-1)*this.azimuth)),i=An(Vt(),r,t);i=An(Vt(),i,e);var a=La(Q(),i);this.type===we.ORBITING||this.type===we.EXPLORING?(Ee(this.matrix,this.matrix,this.focalPoint),Ut(this.matrix,this.matrix,a),Ee(this.matrix,this.matrix,[0,0,this.distance])):this.type===we.TRACKING&&(Ee(this.matrix,this.matrix,this.position),Ut(this.matrix,this.matrix,a))},n.prototype._setPosition=function(e,t,r){this.position=pr(e,t,r);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()},n.prototype._getAxes=function(){_.JG(this.right,pr(ln(an(),[1,0,0,0],this.matrix))),_.JG(this.up,pr(ln(an(),[0,1,0,0],this.matrix))),_.JG(this.forward,pr(ln(an(),[0,0,1,0],this.matrix))),_.Fv(this.right,this.right),_.Fv(this.up,this.up),_.Fv(this.forward,this.forward)},n.prototype._getAngles=function(){var e=this.distanceVector[0],t=this.distanceVector[1],r=this.distanceVector[2],i=_.kE(this.distanceVector);if(i===0){this.elevation=0,this.azimuth=0;return}this.type===we.TRACKING?(this.elevation=bi(Math.asin(t/i)),this.azimuth=bi(Math.atan2(-e,-r))):this.rotateWorld?(this.elevation=bi(Math.asin(t/i)),this.azimuth=bi(Math.atan2(-e,-r))):(this.elevation=-bi(Math.asin(t/i)),this.azimuth=-bi(Math.atan2(-e,-r)))},n.prototype._getPosition=function(){_.JG(this.position,pr(ln(an(),[0,0,0,1],this.matrix))),this._getDistance()},n.prototype._getFocalPoint=function(){_.kK(this.distanceVector,[0,0,-this.distance],qi.xO(qi.Ue(),this.matrix)),_.IH(this.focalPoint,this.position,this.distanceVector),this._getDistance()},n.prototype._getDistance=function(){this.distanceVector=_.$X(_.Ue(),this.focalPoint,this.position),this.distance=_.kE(this.distanceVector),this.dollyingStep=this.distance/100},n.prototype._getOrthoMatrix=function(){if(this.projectionMode===Or.ORTHOGRAPHIC){var e=this.position,t=kn(Vt(),[0,0,1],-this.roll*Math.PI/180);fr(this.orthoMatrix,t,_.al((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),_.al(this.zoom,this.zoom,1),e)}},n.prototype.triggerUpdate=function(){if(this.enableUpdate){var e=this.getViewTransform(),t=Ut(Q(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(t),this.eventEmitter.emit(Fm.UPDATED)}},n.prototype.rotate=function(e,t,r){throw new Error(Ne)},n.prototype.pan=function(e,t){throw new Error(Ne)},n.prototype.dolly=function(e){throw new Error(Ne)},n.prototype.createLandmark=function(e,t){throw new Error(Ne)},n.prototype.gotoLandmark=function(e,t){throw new Error(Ne)},n.prototype.cancelLandmarkAnimation=function(){throw new Error(Ne)},n}();function Un(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var t=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=e?e.apply(this,r):r[0],o=t.cache;if(o.has(a))return o.get(a);var s=n.apply(this,r);return t.cache=o.set(a,s)||o,s};return t.cache=new(Un.Cache||Map),t}Un.Cache=Map;var xt;(function(n){n[n.kUnknown=0]="kUnknown",n[n.kNumber=1]="kNumber",n[n.kPercentage=2]="kPercentage",n[n.kEms=3]="kEms",n[n.kPixels=4]="kPixels",n[n.kRems=5]="kRems",n[n.kDegrees=6]="kDegrees",n[n.kRadians=7]="kRadians",n[n.kGradians=8]="kGradians",n[n.kTurns=9]="kTurns",n[n.kMilliseconds=10]="kMilliseconds",n[n.kSeconds=11]="kSeconds",n[n.kInteger=12]="kInteger"})(xt||(xt={}));var Qr;(function(n){n[n.kUNumber=0]="kUNumber",n[n.kUPercent=1]="kUPercent",n[n.kULength=2]="kULength",n[n.kUAngle=3]="kUAngle",n[n.kUTime=4]="kUTime",n[n.kUOther=5]="kUOther"})(Qr||(Qr={}));var Wm;(function(n){n[n.kAll=0]="kAll",n[n.kNonNegative=1]="kNonNegative",n[n.kInteger=2]="kInteger",n[n.kNonNegativeInteger=3]="kNonNegativeInteger",n[n.kPositiveInteger=4]="kPositiveInteger"})(Wm||(Wm={}));var wd;(function(n){n[n.kYes=0]="kYes",n[n.kNo=1]="kNo"})(wd||(wd={}));var Sd;(function(n){n[n.kYes=0]="kYes",n[n.kNo=1]="kNo"})(Sd||(Sd={}));var mT=[{name:"em",unit_type:xt.kEms},{name:"px",unit_type:xt.kPixels},{name:"deg",unit_type:xt.kDegrees},{name:"rad",unit_type:xt.kRadians},{name:"grad",unit_type:xt.kGradians},{name:"ms",unit_type:xt.kMilliseconds},{name:"s",unit_type:xt.kSeconds},{name:"rem",unit_type:xt.kRems},{name:"turn",unit_type:xt.kTurns}],Va;(function(n){n[n.kUnknownType=0]="kUnknownType",n[n.kUnparsedType=1]="kUnparsedType",n[n.kKeywordType=2]="kKeywordType",n[n.kUnitType=3]="kUnitType",n[n.kSumType=4]="kSumType",n[n.kProductType=5]="kProductType",n[n.kNegateType=6]="kNegateType",n[n.kInvertType=7]="kInvertType",n[n.kMinType=8]="kMinType",n[n.kMaxType=9]="kMaxType",n[n.kClampType=10]="kClampType",n[n.kTransformType=11]="kTransformType",n[n.kPositionType=12]="kPositionType",n[n.kURLImageType=13]="kURLImageType",n[n.kColorType=14]="kColorType",n[n.kUnsupportedColorType=15]="kUnsupportedColorType"})(Va||(Va={}));var yT=function(n){return mT.find(function(e){return e.name===n}).unit_type},xT=function(n){return n?n==="number"?xt.kNumber:n==="percent"||n==="%"?xt.kPercentage:yT(n):xt.kUnknown},bT=function(n){switch(n){case xt.kNumber:case xt.kInteger:return Qr.kUNumber;case xt.kPercentage:return Qr.kUPercent;case xt.kPixels:return Qr.kULength;case xt.kMilliseconds:case xt.kSeconds:return Qr.kUTime;case xt.kDegrees:case xt.kRadians:case xt.kGradians:case xt.kTurns:return Qr.kUAngle;default:return Qr.kUOther}},ET=function(n){switch(n){case Qr.kUNumber:return xt.kNumber;case Qr.kULength:return xt.kPixels;case Qr.kUPercent:return xt.kPercentage;case Qr.kUTime:return xt.kSeconds;case Qr.kUAngle:return xt.kDegrees;default:return xt.kUnknown}},Um=function(n){var e=1;switch(n){case xt.kPixels:case xt.kDegrees:case xt.kSeconds:break;case xt.kMilliseconds:e=.001;break;case xt.kRadians:e=180/Math.PI;break;case xt.kGradians:e=.9;break;case xt.kTurns:e=360;break}return e},_d=function(n){switch(n){case xt.kNumber:case xt.kInteger:return"";case xt.kPercentage:return"%";case xt.kEms:return"em";case xt.kRems:return"rem";case xt.kPixels:return"px";case xt.kDegrees:return"deg";case xt.kRadians:return"rad";case xt.kGradians:return"grad";case xt.kMilliseconds:return"ms";case xt.kSeconds:return"s";case xt.kTurns:return"turn"}return""},Xc=function(){function n(){}return n.isAngle=function(e){return e===xt.kDegrees||e===xt.kRadians||e===xt.kGradians||e===xt.kTurns},n.isLength=function(e){return e>=xt.kEms&&e<xt.kDegrees},n.isRelativeUnit=function(e){return e===xt.kPercentage||e===xt.kEms||e===xt.kRems},n.isTime=function(e){return e===xt.kSeconds||e===xt.kMilliseconds},n.prototype.toString=function(){return this.buildCSSText(wd.kNo,Sd.kNo,"")},n.prototype.isNumericValue=function(){return this.getType()>=Va.kUnitType&&this.getType()<=Va.kClampType},n}(),wT=function(n){B(e,n);function e(t){var r=n.call(this)||this;return r.colorSpace=t,r}return e.prototype.getType=function(){return Va.kColorType},e.prototype.to=function(t){return this},e}(Xc),Qi;(function(n){n[n.Constant=0]="Constant",n[n.LinearGradient=1]="LinearGradient",n[n.RadialGradient=2]="RadialGradient"})(Qi||(Qi={}));var jc=function(n){B(e,n);function e(t,r){var i=n.call(this)||this;return i.type=t,i.value=r,i}return e.prototype.clone=function(){return new e(this.type,this.value)},e.prototype.buildCSSText=function(t,r,i){return i},e.prototype.getType=function(){return Va.kColorType},e}(Xc),Ar=function(n){B(e,n);function e(t){var r=n.call(this)||this;return r.value=t,r}return e.prototype.clone=function(){return new e(this.value)},e.prototype.getType=function(){return Va.kKeywordType},e.prototype.buildCSSText=function(t,r,i){return i+this.value},e}(Xc),ST=Un(function(n){return n===void 0&&(n=""),n.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})}),Vm=function(n){return n.split("").map(function(e,t){return e.toUpperCase()===e?"".concat(t!==0?"-":"").concat(e.toLowerCase()):e}).join("")};function _T(n){if(!n)throw new Error}function ms(n){return typeof n=="function"}function TT(n){return typeof n=="symbol"}var kz=function(n){return Object.fromEntries(Object.entries(n).filter(function(e){var t=__read(e,2),r=t[1];return r!==void 0}))},PT={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign"},src:{alias:"img"}},Td=Un(function(n){var e=ST(n),t=PT[e];return e=(t==null?void 0:t.alias)||e,e}),MT=function(n,e){e===void 0&&(e="");var t="";return Number.isFinite(n)?(_T(Number.isNaN(n)),t="NaN"):n>0?t="infinity":t="-infinity",t+=e},Pd=function(n){return ET(bT(n))},Re=function(n){B(e,n);function e(t,r){r===void 0&&(r=xt.kNumber);var i=n.call(this)||this,a;return typeof r=="string"?a=xT(r):a=r,i.unit=a,i.value=t,i}return e.prototype.clone=function(){return new e(this.value,this.unit)},e.prototype.equals=function(t){var r=t;return this.value===r.value&&this.unit===r.unit},e.prototype.getType=function(){return Va.kUnitType},e.prototype.convertTo=function(t){if(this.unit===t)return new e(this.value,this.unit);var r=Pd(this.unit);if(r!==Pd(t)||r===xt.kUnknown)return null;var i=Um(this.unit)/Um(t);return new e(this.value*i,t)},e.prototype.buildCSSText=function(t,r,i){var a;switch(this.unit){case xt.kUnknown:break;case xt.kInteger:a=Number(this.value).toFixed(0);break;case xt.kNumber:case xt.kPercentage:case xt.kEms:case xt.kRems:case xt.kPixels:case xt.kDegrees:case xt.kRadians:case xt.kGradians:case xt.kMilliseconds:case xt.kSeconds:case xt.kTurns:{var o=-999999,s=999999,l=this.value,c=_d(this.unit);if(l<o||l>s){var u=_d(this.unit);!Number.isFinite(l)||Number.isNaN(l)?a=MT(l,u):a=l+(u||"")}else a="".concat(l).concat(c)}}return i+=a,i},e}(Xc),gn=new Re(0,"px");new Re(1,"px");var Ei=new Re(0,"deg"),Md=function(n){B(e,n);function e(t,r,i,a,o){a===void 0&&(a=1),o===void 0&&(o=!1);var s=n.call(this,"rgb")||this;return s.r=t,s.g=r,s.b=i,s.alpha=a,s.isNone=o,s}return e.prototype.clone=function(){return new e(this.r,this.g,this.b,this.alpha)},e.prototype.buildCSSText=function(t,r,i){return i+"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")},e}(wT),je=new Ar("unset"),CT=new Ar("initial"),OT=new Ar("inherit"),Cd={"":je,unset:je,initial:CT,inherit:OT},Od=function(n){return Cd[n]||(Cd[n]=new Ar(n)),Cd[n]},$c=new Md(0,0,0,0,!0),Hm=new Md(0,0,0,0),AT=Un(function(n,e,t,r){return new Md(n,e,t,r)},function(n,e,t,r){return"rgba(".concat(n,",").concat(e,",").concat(t,",").concat(r,")")}),Ge=function(n,e){return e===void 0&&(e=xt.kNumber),new Re(n,e)};new Re(50,"%");var Ad;(function(n){n[n.Standard=0]="Standard"})(Ad||(Ad={}));var ys;(function(n){n[n.ADDED=0]="ADDED",n[n.REMOVED=1]="REMOVED",n[n.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED"})(ys||(ys={}));var Ym={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Ua(0,0,0,0)},St;(function(n){n.COORDINATE="<coordinate>",n.COLOR="<color>",n.PAINT="<paint>",n.NUMBER="<number>",n.ANGLE="<angle>",n.OPACITY_VALUE="<opacity-value>",n.SHADOW_BLUR="<shadow-blur>",n.LENGTH="<length>",n.PERCENTAGE="<percentage>",n.LENGTH_PERCENTAGE="<length> | <percentage>",n.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",n.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",n.LIST_OF_POINTS="<list-of-points>",n.PATH="<path>",n.FILTER="<filter>",n.Z_INDEX="<z-index>",n.OFFSET_DISTANCE="<offset-distance>",n.DEFINED_PATH="<defined-path>",n.MARKER="<marker>",n.TRANSFORM="<transform>",n.TRANSFORM_ORIGIN="<transform-origin>",n.TEXT="<text>",n.TEXT_TRANSFORM="<text-transform>"})(St||(St={}));function NT(n){var e=n.type,t=n.value;return e==="hex"?"#".concat(t):e==="literal"?t:e==="rgb"?"rgb(".concat(t.join(","),")"):"rgba(".concat(t.join(","),")")}var RT=function(){var n={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function t(I){throw new Error(e+": "+I)}function r(){var I=i();return e.length>0&&t("Invalid input not EOF"),I}function i(){return S(a)}function a(){return o("linear-gradient",n.linearGradient,l)||o("repeating-linear-gradient",n.repeatingLinearGradient,l)||o("radial-gradient",n.radialGradient,h)||o("repeating-radial-gradient",n.repeatingRadialGradient,h)||o("conic-gradient",n.conicGradient,h)}function o(I,q,J){return s(q,function(wt){var Ft=J();return Ft&&(z(n.comma)||t("Missing comma before color stops")),{type:I,orientation:Ft,colorStops:S(T)}})}function s(I,q){var J=z(I);if(J){z(n.startCall)||t("Missing (");var wt=q(J);return z(n.endCall)||t("Missing )"),wt}}function l(){return c()||u()}function c(){return L("directional",n.sideOrCorner,1)}function u(){return L("angular",n.angleValue,1)}function h(){var I,q=f(),J;return q&&(I=[],I.push(q),J=e,z(n.comma)&&(q=f(),q?I.push(q):e=J)),I}function f(){var I=d()||p();if(I)I.at=g();else{var q=v();if(q){I=q;var J=g();J&&(I.at=J)}else{var wt=m();wt&&(I={type:"default-radial",at:wt})}}return I}function d(){var I=L("shape",/^(circle)/i,0);return I&&(I.style=R()||v()),I}function p(){var I=L("shape",/^(ellipse)/i,0);return I&&(I.style=O()||v()),I}function v(){return L("extent-keyword",n.extentKeywords,1)}function g(){if(L("position",/^at/,0)){var I=m();return I||t("Missing positioning value"),I}}function m(){var I=x();if(I.x||I.y)return{type:"position",value:I}}function x(){return{x:O(),y:O()}}function S(I){var q=I(),J=[];if(q)for(J.push(q);z(n.comma);)q=I(),q?J.push(q):t("One extra comma");return J}function T(){var I=b();return I||t("Expected color definition"),I.length=O(),I}function b(){return E()||C()||w()||y()}function y(){return L("literal",n.literalColor,0)}function E(){return L("hex",n.hexColor,1)}function w(){return s(n.rgbColor,function(){return{type:"rgb",value:S(M)}})}function C(){return s(n.rgbaColor,function(){return{type:"rgba",value:S(M)}})}function M(){return z(n.number)[1]}function O(){return L("%",n.percentageValue,1)||A()||R()}function A(){return L("position-keyword",n.positionKeywords,1)}function R(){return L("px",n.pixelValue,1)||L("em",n.emValue,1)}function L(I,q,J){var wt=z(q);if(wt)return{type:I,value:wt[J]}}function z(I){var q=/^[\n\r\t\s]+/.exec(e);q&&Y(q[0].length);var J=I.exec(e);return J&&Y(J[0].length),J}function Y(I){e=e.substring(I)}return function(I){return e=I,r()}}();function kT(n,e,t,r){var i=Ae(r.value),a=0,o=0,s=a+e/2,l=o+t/2,c=Math.abs(e*Math.cos(i))+Math.abs(t*Math.sin(i)),u=n[0]+s-Math.cos(i)*c/2,h=n[1]+l-Math.sin(i)*c/2,f=n[0]+s+Math.cos(i)*c/2,d=n[1]+l+Math.sin(i)*c/2;return{x1:u,y1:h,x2:f,y2:d}}function LT(n,e,t,r,i,a){var o=r.value,s=i.value;r.unit===xt.kPercentage&&(o=r.value/100*e),i.unit===xt.kPercentage&&(s=i.value/100*t);var l=Math.max(Pr([0,0],[o,s]),Pr([0,t],[o,s]),Pr([e,t],[o,s]),Pr([e,0],[o,s]));return a&&(a instanceof Re?l=a.value:a instanceof Ar&&(a.value==="closest-side"?l=Math.min(o,e-o,s,t-s):a.value==="farthest-side"?l=Math.max(o,e-o,s,t-s):a.value==="closest-corner"&&(l=Math.min(Pr([0,0],[o,s]),Pr([0,t],[o,s]),Pr([e,t],[o,s]),Pr([e,0],[o,s]))))),{x:o+n[0],y:s+n[1],r:l}}var IT=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,DT=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,BT=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,Xm=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function FT(n){var e,t,r,i=n.length;n[i-1].length=(e=n[i-1].length)!==null&&e!==void 0?e:{type:"%",value:"100"},i>1&&(n[0].length=(t=n[0].length)!==null&&t!==void 0?t:{type:"%",value:"0"});for(var a=0,o=Number(n[0].length.value),s=1;s<i;s++){var l=(r=n[s].length)===null||r===void 0?void 0:r.value;if(!pt(l)&&!pt(o)){for(var c=1;c<s-a;c++)n[a+c].length={type:"%",value:"".concat(o+(Number(l)-o)*c/(s-a))};a=s,o=Number(l)}}}var GT={left:270-90,top:0-90,bottom:180-90,right:90-90,"left top":315-90,"top left":315-90,"left bottom":225-90,"bottom left":225-90,"right top":45-90,"top right":45-90,"right bottom":135-90,"bottom right":135-90},zT=Un(function(n){var e;return n.type==="angular"?e=Number(n.value):e=GT[n.value]||0,Ge(e,"deg")}),WT=Un(function(n){var e=50,t=50,r="%",i="%";if((n==null?void 0:n.type)==="position"){var a=n.value,o=a.x,s=a.y;(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?e=0:o.value==="center"?e=50:o.value==="right"?e=100:o.value==="top"?t=0:o.value==="bottom"&&(t=100)),(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?e=0:s.value==="center"?t=50:s.value==="right"?e=100:s.value==="top"?t=0:s.value==="bottom"&&(t=100)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(r=o==null?void 0:o.type,e=Number(o.value)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(i=s==null?void 0:s.type,t=Number(s.value))}return{cx:Ge(e,r),cy:Ge(t,i)}}),UT=Un(function(n){var e;if(n.indexOf("linear")>-1||n.indexOf("radial")>-1){var t=RT(n);return t.map(function(s){var l=s.type,c=s.orientation,u=s.colorStops;FT(u);var h=u.map(function(S){return{offset:Ge(Number(S.length.value),"%"),color:NT(S)}});if(l==="linear-gradient")return new jc(Qi.LinearGradient,{angle:c?zT(c):Ei,steps:h});if(l==="radial-gradient"&&(c||(c=[{type:"shape",value:"circle"}]),c[0].type==="shape"&&c[0].value==="circle")){var f=WT(c[0].at),d=f.cx,p=f.cy,v=void 0;if(c[0].style){var g=c[0].style,m=g.type,x=g.value;m==="extent-keyword"?v=Od(x):v=Ge(x,m)}return new jc(Qi.RadialGradient,{cx:d,cy:p,size:v,steps:h})}})}var r=n[0];if(n[1]==="("||n[2]==="("){if(r==="l"){var i=IT.exec(n);if(i){var a=((e=i[2].match(Xm))===null||e===void 0?void 0:e.map(function(s){return s.split(":")}))||[];return[new jc(Qi.LinearGradient,{angle:Ge(parseFloat(i[1]),"deg"),steps:a.map(function(s){var l=P(s,2),c=l[0],u=l[1];return{offset:Ge(Number(c)*100,"%"),color:u}})})]}}else if(r==="r"){var o=VT(n);if(o)if(qt(o))n=o;else return[new jc(Qi.RadialGradient,o)]}else if(r==="p")return HT(n)}});function VT(n){var e,t=DT.exec(n);if(t){var r=((e=t[4].match(Xm))===null||e===void 0?void 0:e.map(function(i){return i.split(":")}))||[];return{cx:Ge(50,"%"),cy:Ge(50,"%"),steps:r.map(function(i){var a=P(i,2),o=a[0],s=a[1];return{offset:Ge(Number(o)*100,"%"),color:s}})}}return null}function HT(n){var e=BT.exec(n);if(e){var t=e[1],r=e[2];switch(t){case"a":t="repeat";break;case"x":t="repeat-x";break;case"y":t="repeat-y";break;case"n":t="no-repeat";break;default:t="no-repeat"}return{image:r,repetition:t}}return null}function Lz(n){return!!n.type&&!!n.value}function Nd(n){return n&&!!n.image}function jm(n){return n&&!pt(n.r)&&!pt(n.g)&&!pt(n.b)}var xs=Un(function(n){if(Nd(n))return N({repetition:"repeat"},n);if(pt(n)&&(n=""),n==="transparent")return Hm;if(n==="currentColor")n="black";else if(n==="none")return $c;var e=UT(n);if(e)return e;var t=ld.ZP(n),r=[0,0,0,0];return t!==null&&(r[0]=t.r||0,r[1]=t.g||0,r[2]=t.b||0,r[3]=t.opacity),AT.apply(void 0,K([],P(r),!1))});function YT(n,e){if(!(!jm(n)||!jm(e)))return[[Number(n.r),Number(n.g),Number(n.b),Number(n.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var r=t.slice();if(r[3])for(var i=0;i<3;i++)r[i]=Math.round(he(r[i],0,255));return r[3]=he(r[3],0,1),"rgba(".concat(r.join(","),")")}]}function Sl(n,e){if(pt(e))return Ge(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(n)>=0)return Ge(Number(e),"px");if("deg".search(n)>=0)return Ge(Number(e),"deg")}var t=[];e=e.replace(n,function(i){return t.push(i),"U"+i});var r="U("+n.source+")";return t.map(function(i){return Ge(Number(e.replace(new RegExp("U"+i,"g"),"").replace(new RegExp(r,"g"),"*0")),i)})[0]}var $m=function(n){return Sl(new RegExp("px","g"),n)},XT=Un($m),jT=function(n){return Sl(new RegExp("%","g"),n)};Un(jT);var _l=function(n){return te(n)||isFinite(Number(n))?Ge(Number(n)||0,"px"):Sl(new RegExp("px|%|em|rem","g"),n)},bs=Un(_l),Rd=function(n){return Sl(new RegExp("deg|rad|grad|turn","g"),n)},Km=Un(Rd);function $T(n,e,t,r,i){i===void 0&&(i=0);var a="",o=n.value||0,s=e.value||0,l=Pd(n.unit),c=n.convertTo(l),u=e.convertTo(l);return c&&u?(o=c.value,s=u.value,a=_d(n.unit)):(Re.isLength(n.unit)||Re.isLength(e.unit))&&(o=ti(n,i,t),s=ti(e,i,t),a="px"),[o,s,function(h){return r&&(h=Math.max(h,0)),h+a}]}function Nr(n){var e=0;return n.unit===xt.kDegrees?e=n.value:n.unit===xt.kRadians?e=bi(Number(n.value)):n.unit===xt.kTurns&&(e=oT(Number(n.value))),e}function Zm(n,e){var t;return Array.isArray(n)?t=n.map(function(r){return Number(r)}):qt(n)?t=n.split(" ").map(function(r){return Number(r)}):te(n)&&(t=[n]),e===2?t.length===1?[t[0],t[0]]:[t[0],t[1]]:t.length===1?[t[0],t[0],t[0],t[0]]:t.length===2?[t[0],t[1],t[0],t[1]]:t.length===3?[t[0],t[1],t[2],t[1]]:[t[0],t[1],t[2],t[3]]}function qm(n){return qt(n)?n.split(" ").map(function(e){return bs(e)}):n.map(function(e){return bs(e.toString())})}function ti(n,e,t,r){if(r===void 0&&(r=!1),n.unit===xt.kPixels)return Number(n.value);if(n.unit===xt.kPercentage&&t){var i=t.nodeName===ct.GROUP?t.getLocalBounds():t.getGeometryBounds();return(r?i.min[e]:0)+n.value/100*i.halfExtents[e]*2}return 0}var KT=function(n){return Sl(/deg|rad|grad|turn|px|%/g,n)},ZT=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function Jm(n){if(n===void 0&&(n=""),n=n.toLowerCase().trim(),n==="none")return[];for(var e=/\s*([\w-]+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];if(i=r.index+r[0].length,ZT.indexOf(r[1])>-1&&t.push({name:r[1],params:r[2].split(" ").map(function(a){return KT(a)||xs(a)})}),e.lastIndex===n.length)return t}return[]}function Qm(n){return n.toString()}var Es=function(n){return typeof n=="number"?Ge(n):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(n)?Ge(Number(n)):Ge(0)},Ro=Un(Es);Un(function(n){return qt(n)?n.split(" ").map(Ro):n.map(Ro)});function kd(n,e){return[n,e,Qm]}function Ld(n,e){return function(t,r){return[t,r,function(i){return Qm(he(i,n,e))}]}}function ty(n,e){if(n.length===e.length)return[n,e,function(t){return t}]}function Id(n){return n.parsedStyle.d.totalLength===0&&(n.parsedStyle.d.totalLength=nd(n.parsedStyle.d.absolutePath)),n.parsedStyle.d.totalLength}function qT(n){return n.parsedStyle.points.totalLength===0&&(n.parsedStyle.points.totalLength=gd(n.parsedStyle.points.points)),n.parsedStyle.points.totalLength}function JT(n){for(var e=0;e<n.length;e++){var t=n[e-1],r=n[e],i=r[0];if(i==="M"&&t){var a=t[0],o=[r[1],r[2]],s=void 0;a==="L"||a==="M"?s=[t[1],t[2]]:(a==="C"||a==="A"||a==="Q")&&(s=[t[t.length-2],t[t.length-1]]),s&&Kc(o,s)&&(n.splice(e,1),e--)}}}function QT(n){for(var e=!1,t=n.length,r=0;r<t;r++){var i=n[r],a=i[0];if(a==="C"||a==="A"||a==="Q"){e=!0;break}}return e}function tP(n){for(var e=[],t=[],r=[],i=0;i<n.length;i++){var a=n[i],o=a[0];o==="M"?(r.length&&(t.push(r),r=[]),r.push([a[1],a[2]])):o==="Z"?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]])}return r.length>0&&t.push(r),{polygons:e,polylines:t}}function Kc(n,e){return n[0]===e[0]&&n[1]===e[1]}function eP(n,e){for(var t=[],r=[],i=[],a=0;a<n.length;a++){var o=n[a],s=o.currentPoint,l=o.params,c=o.prePoint,u=void 0;switch(o.command){case"Q":u=yd(c[0],c[1],l[1],l[2],l[3],l[4]);break;case"C":u=vd(c[0],c[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;u=dd(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:t.push(s[0]),r.push(s[1]);break}u&&(o.box=u,t.push(u.x,u.x+u.width),r.push(u.y,u.y+u.height)),e&&(o.command==="L"||o.command==="M")&&o.prePoint&&o.nextPoint&&i.push(o)}t=t.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0}),r=r.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0});var f=Fa(t),d=Fa(r),p=Ga(t),v=Ga(r);if(i.length===0)return{x:f,y:d,width:p-f,height:v-d};for(var a=0;a<i.length;a++){var o=i[a],s=o.currentPoint,g=void 0;s[0]===f?(g=Zc(o,e),f=f-g.xExtra):s[0]===p&&(g=Zc(o,e),p=p+g.xExtra),s[1]===d?(g=Zc(o,e),d=d-g.yExtra):s[1]===v&&(g=Zc(o,e),v=v+g.yExtra)}return{x:f,y:d,width:p-f,height:v-d}}function Zc(n,e){var t=n.prePoint,r=n.currentPoint,i=n.nextPoint,a=Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2),l=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!l||Math.sin(l)===0||Co(l,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));c=c>Math.PI/2?Math.PI-c:c,u=u>Math.PI/2?Math.PI-u:u;var h={xExtra:Math.cos(l/2-c)*(e/2*(1/Math.sin(l/2)))-e/2||0,yExtra:Math.cos(u-l/2)*(e/2*(1/Math.sin(l/2)))-e/2||0};return h}function ey(n,e){return[e[0]+(e[0]-n[0]),e[1]+(e[1]-n[1])]}var ny=function(n,e){var t=n.x*e.x+n.y*e.y,r=Math.sqrt((Math.pow(n.x,2)+Math.pow(n.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2))),i=n.x*e.y-n.y*e.x<0?-1:1,a=i*Math.acos(t/r);return a},ry=function(n,e,t,r,i,a,o,s){e=Math.abs(e),t=Math.abs(t),r=us(r,360);var l=Ae(r);if(n.x===o.x&&n.y===o.y)return{x:n.x,y:n.y,ellipticalArcAngle:0};if(e===0||t===0)return{x:0,y:0,ellipticalArcAngle:0};var c=(n.x-o.x)/2,u=(n.y-o.y)/2,h={x:Math.cos(l)*c+Math.sin(l)*u,y:-Math.sin(l)*c+Math.cos(l)*u},f=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(t,2);f>1&&(e=Math.sqrt(f)*e,t=Math.sqrt(f)*t);var d=Math.pow(e,2)*Math.pow(t,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(t,2)*Math.pow(h.x,2),p=Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(t,2)*Math.pow(h.x,2),v=d/p;v=v<0?0:v;var g=(i!==a?1:-1)*Math.sqrt(v),m={x:g*(e*h.y/t),y:g*(-(t*h.x)/e)},x={x:Math.cos(l)*m.x-Math.sin(l)*m.y+(n.x+o.x)/2,y:Math.sin(l)*m.x+Math.cos(l)*m.y+(n.y+o.y)/2},S={x:(h.x-m.x)/e,y:(h.y-m.y)/t},T=ny({x:1,y:0},S),b={x:(-h.x-m.x)/e,y:(-h.y-m.y)/t},y=ny(S,b);!a&&y>0?y-=2*Math.PI:a&&y<0&&(y+=2*Math.PI),y%=2*Math.PI;var E=T+y*s,w=e*Math.cos(E),C=t*Math.sin(E),M={x:Math.cos(l)*w-Math.sin(l)*C+x.x,y:Math.sin(l)*w+Math.cos(l)*C+x.y,ellipticalArcStartAngle:T,ellipticalArcEndAngle:T+y,ellipticalArcAngle:E,ellipticalArcCenter:x,resultantRx:e,resultantRy:t};return M};function nP(n){for(var e=[],t=null,r=null,i=null,a=0,o=n.length,s=0;s<o;s++){var l=n[s];r=n[s+1];var c=l[0],u={command:c,prePoint:t,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(c){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=rP(t,l);u.arcParams=h;break}if(c==="Z")t=i,r=n[a+1];else{var f=l.length;t=[l[f-2],l[f-1]]}r&&r[0]==="Z"&&(r=n[a],e[a]&&(e[a].prePoint=t)),u.currentPoint=t,e[a]&&Kc(t,e[a].currentPoint)&&(e[a].prePoint=u.prePoint);var d=r?[r[r.length-2],r[r.length-1]]:null;u.nextPoint=d;var p=u.prePoint;if(["L","H","V"].includes(c))u.startTangent=[p[0]-t[0],p[1]-t[1]],u.endTangent=[t[0]-p[0],t[1]-p[1]];else if(c==="Q"){var v=[l[1],l[2]];u.startTangent=[p[0]-v[0],p[1]-v[1]],u.endTangent=[t[0]-v[0],t[1]-v[1]]}else if(c==="T"){var g=e[s-1],v=ey(g.currentPoint,p);g.command==="Q"?(u.command="Q",u.startTangent=[p[0]-v[0],p[1]-v[1]],u.endTangent=[t[0]-v[0],t[1]-v[1]]):(u.command="TL",u.startTangent=[p[0]-t[0],p[1]-t[1]],u.endTangent=[t[0]-p[0],t[1]-p[1]])}else if(c==="C"){var m=[l[1],l[2]],x=[l[3],l[4]];u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]],u.startTangent[0]===0&&u.startTangent[1]===0&&(u.startTangent=[m[0]-x[0],m[1]-x[1]]),u.endTangent[0]===0&&u.endTangent[1]===0&&(u.endTangent=[x[0]-m[0],x[1]-m[1]])}else if(c==="S"){var g=e[s-1],m=ey(g.currentPoint,p),x=[l[1],l[2]];g.command==="C"?(u.command="C",u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]]):(u.command="SQ",u.startTangent=[p[0]-x[0],p[1]-x[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]])}else if(c==="A"){var S=iy(u,0),T=S.x,b=S.y,y=iy(u,1,!1),E=y.x,w=y.y;u.startTangent=[T,b],u.endTangent=[E,w]}e.push(u)}return e}function iy(n,e,t){t===void 0&&(t=!0);var r=n.arcParams,i=r.rx,a=i===void 0?0:i,o=r.ry,s=o===void 0?0:o,l=r.xRotation,c=r.arcFlag,u=r.sweepFlag,h=ry({x:n.prePoint[0],y:n.prePoint[1]},a,s,l,!!c,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},e),f=ry({x:n.prePoint[0],y:n.prePoint[1]},a,s,l,!!c,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},t?e+.005:e-.005),d=f.x-h.x,p=f.y-h.y,v=Math.sqrt(d*d+p*p);return{x:-d/v,y:-p/v}}function qc(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Dd(n,e){return qc(n)*qc(e)?(n[0]*e[0]+n[1]*e[1])/(qc(n)*qc(e)):1}function ay(n,e){return(n[0]*e[1]<n[1]*e[0]?-1:1)*Math.acos(Dd(n,e))}function rP(n,e){var t=e[1],r=e[2],i=us(Ae(e[3]),Math.PI*2),a=e[4],o=e[5],s=n[0],l=n[1],c=e[6],u=e[7],h=Math.cos(i)*(s-c)/2+Math.sin(i)*(l-u)/2,f=-1*Math.sin(i)*(s-c)/2+Math.cos(i)*(l-u)/2,d=h*h/(t*t)+f*f/(r*r);d>1&&(t*=Math.sqrt(d),r*=Math.sqrt(d));var p=t*t*(f*f)+r*r*(h*h),v=p?Math.sqrt((t*t*(r*r)-p)/p):1;a===o&&(v*=-1),isNaN(v)&&(v=0);var g=r?v*t*f/r:0,m=t?v*-r*h/t:0,x=(s+c)/2+Math.cos(i)*g-Math.sin(i)*m,S=(l+u)/2+Math.sin(i)*g+Math.cos(i)*m,T=[(h-g)/t,(f-m)/r],b=[(-1*h-g)/t,(-1*f-m)/r],y=ay([1,0],T),E=ay(T,b);return Dd(T,b)<=-1&&(E=Math.PI),Dd(T,b)>=1&&(E=0),o===0&&E>0&&(E=E-2*Math.PI),o===1&&E<0&&(E=E+2*Math.PI),{cx:x,cy:S,rx:Kc(n,[c,u])?0:t,ry:Kc(n,[c,u])?0:r,startAngle:y,endAngle:y+E,xRotation:i,arcFlag:a,sweepFlag:o}}function iP(n,e,t){return n.reduce(function(r,i){var a="";if(i[0]==="M"||i[0]==="L"){var o=vec3.fromValues(i[1],i[2],0);t&&vec3.transformMat4(o,o,t),a="".concat(i[0]).concat(o[0],",").concat(o[1])}else if(i[0]==="Z")a=i[0];else if(i[0]==="C"){var s=vec3.fromValues(i[1],i[2],0),l=vec3.fromValues(i[3],i[4],0),c=vec3.fromValues(i[5],i[6],0);t&&(vec3.transformMat4(s,s,t),vec3.transformMat4(l,l,t),vec3.transformMat4(c,c,t)),a="".concat(i[0]).concat(s[0],",").concat(s[1],",").concat(l[0],",").concat(l[1],",").concat(c[0],",").concat(c[1])}else if(i[0]==="A"){var u=vec3.fromValues(i[6],i[7],0);t&&vec3.transformMat4(u,u,t),a="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],",").concat(i[5],",").concat(u[0],",").concat(u[1])}else if(i[0]==="Q"){var s=vec3.fromValues(i[1],i[2],0),l=vec3.fromValues(i[3],i[4],0);t&&(vec3.transformMat4(s,s,t),vec3.transformMat4(l,l,t)),a="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],"}")}return r+=a},"")}function aP(n,e,t,r){return[["M",n,e],["L",t,r]]}function oy(n,e,t,r){var i=(-1+Math.sqrt(2))/3*4,a=n*i,o=e*i,s=t-n,l=t+n,c=r-e,u=r+e;return[["M",s,r],["C",s,r-o,t-a,c,t,c],["C",t+a,c,l,r-o,l,r],["C",l,r+o,t+a,u,t,u],["C",t-a,u,s,r+o,s,r],["Z"]]}function oP(n,e){var t=n.map(function(r,i){return[i===0?"M":"L",r[0],r[1]]});return e&&t.push(["Z"]),t}function sP(n,e,t,r,i){if(i){var a=__read(i,4),o=a[0],s=a[1],l=a[2],c=a[3],u=n>0?1:-1,h=e>0?1:-1,f=u+h!==0?1:0;return[["M",u*o+t,r],["L",n-u*s+t,r],s?["A",s,s,0,0,f,n+t,h*s+r]:null,["L",n+t,e-h*l+r],l?["A",l,l,0,0,f,n+t-u*l,e+r]:null,["L",t+u*c,e+r],c?["A",c,c,0,0,f,t,e+r-h*c]:null,["L",t,h*o+r],o?["A",o,o,0,0,f,u*o+t,r]:null,["Z"]].filter(function(d){return d})}return[["M",t,r],["L",t+n,r],["L",t+n,r+e],["L",t,r+e],["Z"]]}function Iz(n,e){e===void 0&&(e=n.getLocalTransform());var t=[];switch(n.nodeName){case ct.LINE:var r=n.parsedStyle,i=r.x1,a=i===void 0?0:i,o=r.y1,s=o===void 0?0:o,l=r.x2,c=l===void 0?0:l,u=r.y2,h=u===void 0?0:u;t=aP(a,s,c,h);break;case ct.CIRCLE:{var f=n.parsedStyle,d=f.r,p=d===void 0?0:d,v=f.cx,g=v===void 0?0:v,m=f.cy,x=m===void 0?0:m;t=oy(p,p,g,x);break}case ct.ELLIPSE:{var S=n.parsedStyle,T=S.rx,b=T===void 0?0:T,y=S.ry,E=y===void 0?0:y,w=S.cx,g=w===void 0?0:w,C=S.cy,x=C===void 0?0:C;t=oy(b,E,g,x);break}case ct.POLYLINE:case ct.POLYGON:var M=n.parsedStyle.points;t=oP(M.points,n.nodeName===ct.POLYGON);break;case ct.RECT:var O=n.parsedStyle,A=O.width,R=A===void 0?0:A,L=O.height,z=L===void 0?0:L,Y=O.x,I=Y===void 0?0:Y,q=O.y,J=q===void 0?0:q,wt=O.radius,Ft=wt&&wt.some(function(xe){return xe!==0});t=sP(R,z,I,J,Ft&&wt.map(function(xe){return clamp(xe,0,Math.min(Math.abs(R)/2,Math.abs(z)/2))}));break;case ct.PATH:var fe=n.parsedStyle.d.absolutePath;t=__spreadArray([],__read(fe),!1);break}if(t.length)return iP(t,n,e)}function Dz(n,e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0);var a=n.map(function(o,s){var l=o[0],c=n[s+1],u=s===0&&(e!==0||t!==0),h=(s===n.length-1||c&&(c[0]==="M"||c[0]==="Z"))&&r!==0&&i!==0;switch(l){case"M":return u?"M ".concat(o[1]+e,",").concat(o[2]+t," L ").concat(o[1],",").concat(o[2]):"M ".concat(o[1],",").concat(o[2]);case"L":return"L ".concat(o[1]+(h?r:0),",").concat(o[2]+(h?i:0));case"Q":return"Q ".concat(o[1]," ").concat(o[2],",").concat(o[3]," ").concat(o[4])+(h?" L ".concat(o[3]+r,",").concat(o[4]+i):"");case"C":return"C ".concat(o[1]," ").concat(o[2],",").concat(o[3]," ").concat(o[4],",").concat(o[5]," ").concat(o[6])+(h?" L ".concat(o[5]+r,",").concat(o[6]+i):"");case"A":return"A ".concat(o[1]," ").concat(o[2]," ").concat(o[3]," ").concat(o[4]," ").concat(o[5]," ").concat(o[6]," ").concat(o[7])+(h?" L ".concat(o[6]+r,",").concat(o[7]+i):"");case"Z":return"Z"}}).join(" ");return~a.indexOf("NaN")?"":a}var sy=function(n){if(n===""||Array.isArray(n)&&n.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=Da(n)}catch(f){e=Da(""),console.error("[g]: Invalid SVG Path definition: ".concat(n))}JT(e);var t=QT(e),r=tP(e),i=r.polygons,a=r.polylines,o=nP(e),s=eP(o,0),l=s.x,c=s.y,u=s.width,h=s.height;return{absolutePath:e,hasArc:t,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(u)?u:0,height:Number.isFinite(h)?h:0}}},lP=Un(sy);function Bd(n){return qt(n)?lP(n):sy(n)}function cP(n,e,t){var r=n.curve,i=e.curve;(!r||r.length===0)&&(r=Oo(n.absolutePath,!1),n.curve=r),(!i||i.length===0)&&(i=Oo(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=Uc(r,i));var o=hs(a[0])!==hs(a[1])?id(a[0]):ad(a[0]);return[o,od(a[1],o),function(s){return s}]}function ly(n,e){var t;return qt(n)?t=n.split(" ").map(function(r){var i=P(r.split(","),2),a=i[0],o=i[1];return[Number(a),Number(o)]}):t=n,{points:t,totalLength:0,segments:[]}}function uP(n,e){return[n.points,e.points,function(t){return t}]}var cn=null;function Rr(n){return function(e){var t=0;return n.map(function(r){return r===cn?e[t++]:r})}}function ko(n){return n}var Jc={matrix:["NNNNNN",[cn,cn,0,0,cn,cn,0,0,0,0,1,0,cn,cn,0,1],ko],matrix3d:["NNNNNNNNNNNNNNNN",ko],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Rr([cn,cn,new Re(1)]),ko],scalex:["N",Rr([cn,new Re(1),new Re(1)]),Rr([cn,new Re(1)])],scaley:["N",Rr([new Re(1),cn,new Re(1)]),Rr([new Re(1),cn])],scalez:["N",Rr([new Re(1),new Re(1),cn])],scale3d:["NNN",ko],skew:["Aa",null,ko],skewx:["A",null,Rr([cn,Ei])],skewy:["A",null,Rr([Ei,cn])],translate:["Tt",Rr([cn,cn,gn]),ko],translatex:["T",Rr([cn,gn,gn]),Rr([cn,gn])],translatey:["T",Rr([gn,cn,gn]),Rr([gn,cn])],translatez:["L",Rr([gn,gn,cn])],translate3d:["TTL",ko]};function Fd(n){if(n=(n||"none").toLowerCase().trim(),n==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];i=r.index+r[0].length;var a=r[1],o=Jc[a];if(!o)return[];var s=r[2].split(","),l=o[0];if(l.length<s.length)return[];for(var c=[],u=0;u<l.length;u++){var h=s[u],f=l[u],d=void 0;if(h?d={A:function(p){return p.trim()==="0"?Ei:Km(p)},N:Ro,T:bs,L:XT}[f.toUpperCase()](h):d={a:Ei,n:c[0],t:gn}[f],d===void 0)return[];c.push(d)}if(t.push({t:a,d:c}),e.lastIndex===n.length)return t}return[]}function cy(n){if(n=(n||"none").toLowerCase().trim(),n==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];i=r.index+r[0].length;var a=r[1],o=Jc[a];if(!o)return[];var s=r[2].split(","),l=o[0];if(l.length<s.length)return[];for(var c=[],u=0;u<l.length;u++){var h=s[u],f=l[u],d=void 0;if(h?d={A:function(p){return p.trim()==="0"?Ei:Rd(p)},N:Es,T:_l,L:$m}[f.toUpperCase()](h):d={a:Ei,n:c[0],t:gn}[f],d===void 0)return[];c.push(d)}if(t.push({t:a,d:c}),e.lastIndex===n.length)return t}return[]}function hP(n){var e,t,r,i;switch(n.t){case"rotatex":return i=Ae(Nr(n.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotatey":return i=Ae(Nr(n.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotatez":return i=Ae(Nr(n.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=n.d[0].value,t=n.d[1].value,r=n.d[2].value,i=Ae(Nr(n.d[3]));var a=e*e+t*t+r*r;if(a===0)e=1,t=0,r=0;else if(a!==1){var o=Math.sqrt(a);e/=o,t/=o,r/=o}var s=Math.sin(i/2),l=s*Math.cos(i/2),c=s*s;return[1-2*(t*t+r*r)*c,2*(e*t*c+r*l),2*(e*r*c-t*l),0,2*(e*t*c-r*l),1-2*(e*e+r*r)*c,2*(t*r*c+e*l),0,2*(e*r*c+t*l),2*(t*r*c-e*l),1-2*(e*e+t*t)*c,0,0,0,0,1];case"scale":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scalex":return[n.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,n.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,n.d[0].value,0,0,0,0,1];case"scale3d":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,n.d[2].value,0,0,0,0,1];case"skew":var u=Ae(Nr(n.d[0])),h=Ae(Nr(n.d[1]));return[1,Math.tan(h),0,0,Math.tan(u),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return i=Ae(Nr(n.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return i=Ae(Nr(n.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return e=ti(n.d[0],0,null)||0,t=ti(n.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1];case"translatex":return e=ti(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,0,0,1];case"translatey":return t=ti(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,t,0,1];case"translatez":return r=ti(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r,1];case"translate3d":return e=ti(n.d[0],0,null)||0,t=ti(n.d[1],0,null)||0,r=ti(n.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,r,1];case"perspective":var f=ti(n.d[0],0,null)||0,d=f?-1/f:0;return[1,0,0,0,0,1,0,0,0,0,1,d,0,0,0,1];case"matrix":return[n.d[0].value,n.d[1].value,0,0,n.d[2].value,n.d[3].value,0,0,0,0,1,0,n.d[4].value,n.d[5].value,0,1];case"matrix3d":return n.d.map(function(p){return p.value})}}function fP(n,e){return[n[0]*e[0]+n[4]*e[1]+n[8]*e[2]+n[12]*e[3],n[1]*e[0]+n[5]*e[1]+n[9]*e[2]+n[13]*e[3],n[2]*e[0]+n[6]*e[1]+n[10]*e[2]+n[14]*e[3],n[3]*e[0]+n[7]*e[1]+n[11]*e[2]+n[15]*e[3],n[0]*e[4]+n[4]*e[5]+n[8]*e[6]+n[12]*e[7],n[1]*e[4]+n[5]*e[5]+n[9]*e[6]+n[13]*e[7],n[2]*e[4]+n[6]*e[5]+n[10]*e[6]+n[14]*e[7],n[3]*e[4]+n[7]*e[5]+n[11]*e[6]+n[15]*e[7],n[0]*e[8]+n[4]*e[9]+n[8]*e[10]+n[12]*e[11],n[1]*e[8]+n[5]*e[9]+n[9]*e[10]+n[13]*e[11],n[2]*e[8]+n[6]*e[9]+n[10]*e[10]+n[14]*e[11],n[3]*e[8]+n[7]*e[9]+n[11]*e[10]+n[15]*e[11],n[0]*e[12]+n[4]*e[13]+n[8]*e[14]+n[12]*e[15],n[1]*e[12]+n[5]*e[13]+n[9]*e[14]+n[13]*e[15],n[2]*e[12]+n[6]*e[13]+n[10]*e[14]+n[14]*e[15],n[3]*e[12]+n[7]*e[13]+n[11]*e[14]+n[15]*e[15]]}function dP(n){return n.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:n.map(hP).reduce(fP)}function uy(n){var e=[0,0,0],t=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return hT(dP(n),e,t,r,i,a),[[e,t,r,a,i]]}var pP=function(){function n(r,i){for(var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],o=0;o<4;o++)for(var s=0;s<4;s++)for(var l=0;l<4;l++)a[o][s]+=i[o][l]*r[l][s];return a}function e(r){return r[0][2]==0&&r[0][3]==0&&r[1][2]==0&&r[1][3]==0&&r[2][0]==0&&r[2][1]==0&&r[2][2]==1&&r[2][3]==0&&r[3][2]==0&&r[3][3]==1}function t(r,i,a,o,s){for(var l=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],c=0;c<4;c++)l[c][3]=s[c];for(var c=0;c<3;c++)for(var u=0;u<3;u++)l[3][c]+=r[u]*l[u][c];var h=o[0],f=o[1],d=o[2],p=o[3],v=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];v[0][0]=1-2*(f*f+d*d),v[0][1]=2*(h*f-d*p),v[0][2]=2*(h*d+f*p),v[1][0]=2*(h*f+d*p),v[1][1]=1-2*(h*h+d*d),v[1][2]=2*(f*d-h*p),v[2][0]=2*(h*d-f*p),v[2][1]=2*(f*d+h*p),v[2][2]=1-2*(h*h+f*f),l=n(l,v);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[2]&&(g[2][1]=a[2],l=n(l,g)),a[1]&&(g[2][1]=0,g[2][0]=a[0],l=n(l,g)),a[0]&&(g[2][0]=0,g[1][0]=a[0],l=n(l,g));for(var c=0;c<3;c++)for(var u=0;u<3;u++)l[c][u]*=i[c];return e(l)?[l[0][0],l[0][1],l[1][0],l[1][1],l[3][0],l[3][1]]:l[0].concat(l[1],l[2],l[3])}return t}();function vP(n){return n.toFixed(6).replace(".000000","")}function Gd(n,e){var t,r;return n.decompositionPair!==e&&(n.decompositionPair=e,t=uy(n)),e.decompositionPair!==n&&(e.decompositionPair=n,r=uy(e)),t[0]===null||r[0]===null?[[!1],[!0],function(i){return i?e[0].d:n[0].d}]:(t[0].push(0),r[0].push(1),[t,r,function(i){var a=mP(t[0][3],r[0][3],i[5]),o=pP(i[0],i[1],i[2],a,i[4]),s=o.map(vP).join(",");return s}])}function gP(n,e){for(var t=0,r=0;r<n.length;r++)t+=n[r]*e[r];return t}function mP(n,e,t){var r=gP(n,e);r=he(r,-1,1);var i=[];if(r===1)i=n;else for(var a=Math.acos(r),o=Math.sin(t*a)*1/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(n[s]*(Math.cos(t*a)-r*o)+e[s]*o);return i}function zd(n){return n.replace(/[xy]/,"")}function Wd(n){return n.replace(/(x|y|z|3d)?$/,"3d")}var yP=function(n,e){return n==="perspective"&&e==="perspective"||(n==="matrix"||n==="matrix3d")&&(e==="matrix"||e==="matrix3d")};function xP(n,e,t){var r=!1;if(!n.length||!e.length){n.length||(r=!0,n=e,e=[]);for(var i=function(y){var E=n[y],w=E.t,C=E.d,M=w.substring(0,5)==="scale"?1:0;e.push({t:w,d:C.map(function(O){return typeof O=="number"?Ge(M):Ge(M,O.unit)})})},a=0;a<n.length;a++)i(a)}var o=[],s=[],l=[];if(n.length!==e.length){var c=Gd(n,e);o=[c[0]],s=[c[1]],l=[["matrix",[c[2]]]]}else for(var a=0;a<n.length;a++){var u=n[a].t,h=e[a].t,f=n[a].d,d=e[a].d,p=Jc[u],v=Jc[h],g=void 0;if(yP(u,h)){var c=Gd([n[a]],[e[a]]);o.push(c[0]),s.push(c[1]),l.push(["matrix",[c[2]]]);continue}else if(u===h)g=u;else if(p[2]&&v[2]&&zd(u)===zd(h))g=zd(u),f=p[2](f),d=v[2](d);else if(p[1]&&v[1]&&Wd(u)===Wd(h))g=Wd(u),f=p[1](f),d=v[1](d);else{var c=Gd(n,e);o=[c[0]],s=[c[1]],l=[["matrix",[c[2]]]];break}for(var m=[],x=[],S=[],T=0;T<f.length;T++){var c=$T(f[T],d[T],t,!1,T);m[T]=c[0],x[T]=c[1],S.push(c[2])}o.push(m),s.push(x),l.push([g,S])}if(r){var b=o;o=s,s=b}return[o,s,function(y){return y.map(function(E,w){var C=E.map(function(M,O){return l[w][1][O](M)}).join(",");return l[w][0]==="matrix"&&C.split(",").length===16&&(l[w][0]="matrix3d"),l[w][0]==="matrix3d"&&C.split(",").length===6&&(l[w][0]="matrix"),l[w][0]+"("+C+")"}).join(" ")}]}var hy=Un(function(n){if(qt(n)){if(n==="text-anchor")return[Ge(0,"px"),Ge(0,"px")];var e=n.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[bs(Qc(e[0])),bs(Qc(e[1]))]}else return[Ge(n[0]||0,"px"),Ge(n[1]||0,"px")]}),bP=function(n){if(qt(n)){if(n==="text-anchor")return[Ge(0,"px"),Ge(0,"px")];var e=n.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[_l(Qc(e[0])),_l(Qc(e[1]))]}else return[Ge(n[0]||0,"px"),Ge(n[1]||0,"px")]};function Qc(n){return n==="center"?"50%":n==="left"||n==="top"?"0%":n==="right"||n==="bottom"?"100%":n}var Ud=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:St.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:St.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:St.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:St.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:St.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:St.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:St.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:St.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:St.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:St.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:St.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:St.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:St.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:St.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:St.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:St.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:St.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:St.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:St.FILTER},{n:"clipPath",syntax:St.DEFINED_PATH},{n:"textPath",syntax:St.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:St.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:St.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:St.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:St.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:St.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:St.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:St.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:St.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:St.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:St.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:St.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:St.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:St.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:St.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:St.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:St.COORDINATE},{n:"y1",int:!0,l:!0,syntax:St.COORDINATE},{n:"z1",int:!0,l:!0,syntax:St.COORDINATE},{n:"x2",int:!0,l:!0,syntax:St.COORDINATE},{n:"y2",int:!0,l:!0,syntax:St.COORDINATE},{n:"z2",int:!0,l:!0,syntax:St.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:St.PATH,p:50},{n:"points",int:!0,l:!0,syntax:St.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:St.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:St.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:St.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:St.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:St.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:St.NUMBER,d:function(n){return n===ct.PATH||n===ct.POLYGON||n===ct.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:St.MARKER},{n:"markerEnd",syntax:St.MARKER},{n:"markerMid",syntax:St.MARKER},{n:"markerStartOffset",syntax:St.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:St.LENGTH,l:!0,int:!0,d:"0"}],fy=Ud.filter(function(n){return!!n.l}).map(function(n){return n.n}),Ha={},ws=new WeakMap,EP=function(n,e){var t=ws.get(n);return!t||t.length===0?!0:t.includes(e)},wP=function(){function n(e){var t=this;this.runtime=e,Ud.forEach(function(r){t.registerMetadata(r)})}return n.prototype.registerMetadata=function(e){K([e.n],P(e.a||[]),!1).forEach(function(t){Ha[t]=e})},n.prototype.unregisterMetadata=function(e){delete Ha[e]},n.prototype.getPropertySyntax=function(e){return this.runtime.CSSPropertySyntaxFactory[e]},n.prototype.processProperties=function(e,t,r){var i=this;if(r===void 0&&(r={skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0}),this.runtime.enableCSSParsing){var u=r.skipUpdateAttribute,h=r.skipParse,f=r.forceUpdateGeometry,d=r.usedAttributes,p=r.memoize,v=f,g=Object.keys(t);g.forEach(function(m){var x;u||(e.attributes[m]=t[m]),!v&&(!((x=Ha[m])===null||x===void 0)&&x.l)&&(v=!0)}),h||g.forEach(function(m){e.computedStyle[m]=i.parseProperty(m,e.attributes[m],e,p)}),d!=null&&d.length&&(g=Array.from(new Set(g.concat(d)))),g.forEach(function(m){m in e.computedStyle&&(e.parsedStyle[m]=i.computeProperty(m,e.computedStyle[m],e,p))}),v&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e)),g.forEach(function(m){m in e.parsedStyle&&i.postProcessProperty(m,e,g)}),this.runtime.enableCSSParsing&&e.children.length&&g.forEach(function(m){m in e.parsedStyle&&i.isPropertyInheritable(m)&&e.children.forEach(function(x){x.internalSetAttribute(m,null,{skipUpdateAttribute:!0,skipParse:!0})})})}else{Object.assign(e.attributes,t);var a=Object.keys(t),o=e.parsedStyle.clipPath,s=e.parsedStyle.offsetPath;e.parsedStyle=Object.assign(e.parsedStyle,t);var l=!!r.forceUpdateGeometry;if(!l){for(var c=0;c<fy.length;c++)if(fy[c]in t){l=!0;break}}t.fill&&(e.parsedStyle.fill=xs(t.fill)),t.stroke&&(e.parsedStyle.stroke=xs(t.stroke)),t.shadowColor&&(e.parsedStyle.shadowColor=xs(t.shadowColor)),t.filter&&(e.parsedStyle.filter=Jm(t.filter)),pt(t.radius)||(e.parsedStyle.radius=Zm(t.radius,4)),pt(t.lineDash)||(e.parsedStyle.lineDash=Zm(t.lineDash,2)),t.points&&(e.parsedStyle.points=ly(t.points)),t.d===""&&(e.parsedStyle.d=N({},Ym)),t.d&&(e.parsedStyle.d=Bd(t.d)),t.textTransform&&this.runtime.CSSPropertySyntaxFactory["<text-transform>"].calculator(null,null,{value:t.textTransform},e,null),yt(t.clipPath)||this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("clipPath",o,t.clipPath,e,this.runtime),t.offsetPath&&this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("offsetPath",s,t.offsetPath,e,this.runtime),t.transform&&(e.parsedStyle.transform=Fd(t.transform)),t.transformOrigin&&(e.parsedStyle.transformOrigin=hy(t.transformOrigin)),t.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,t.markerStart,t.markerStart,null,null)),t.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,t.markerEnd,t.markerEnd,null,null)),t.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator("",t.markerMid,t.markerMid,null,null)),pt(t.zIndex)||this.runtime.CSSPropertySyntaxFactory["<z-index>"].postProcessor(e,a),pt(t.offsetDistance)||this.runtime.CSSPropertySyntaxFactory["<offset-distance>"].postProcessor(e,a),t.transform&&this.runtime.CSSPropertySyntaxFactory["<transform>"].postProcessor(e,a),t.transformOrigin&&this.runtime.CSSPropertySyntaxFactory["<transform-origin>"].postProcessor(e,a),l&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e))}},n.prototype.parseProperty=function(e,t,r,i){var a=Ha[e],o=t;if((t===""||pt(t))&&(t="unset"),t==="unset"||t==="initial"||t==="inherit")o=Od(t);else if(a){var s=a.k,l=a.syntax,c=l&&this.getPropertySyntax(l);s&&s.indexOf(t)>-1?o=Od(t):c&&(!i&&c.parserUnmemoize?o=c.parserUnmemoize(t,r):c.parser&&(o=c.parser(t,r)))}return o},n.prototype.computeProperty=function(e,t,r,i){var a=Ha[e],o=r.id==="g-root",s=t;if(a){var l=a.syntax,c=a.inh,u=a.d;if(t instanceof Ar){var h=t.value;if(h==="unset"&&(c&&!o?h="inherit":h="initial"),h==="initial")pt(u)||(t=this.parseProperty(e,ms(u)?u(r.nodeName):u,r,i));else if(h==="inherit"){var f=this.tryToResolveProperty(r,e,{inherited:!0});if(pt(f)){this.addUnresolveProperty(r,e);return}else return f}}var d=l&&this.getPropertySyntax(l);if(d&&d.calculator){var p=r.parsedStyle[e];s=d.calculator(e,p,t,r,this.runtime)}else t instanceof Ar?s=t.value:s=t}return s},n.prototype.postProcessProperty=function(e,t,r){var i=Ha[e];if(i&&i.syntax){var a=i.syntax&&this.getPropertySyntax(i.syntax),o=a;o&&o.postProcessor&&o.postProcessor(t,r)}},n.prototype.addUnresolveProperty=function(e,t){var r=ws.get(e);r||(ws.set(e,[]),r=ws.get(e)),r.indexOf(t)===-1&&r.push(t)},n.prototype.tryToResolveProperty=function(e,t,r){r===void 0&&(r={});var i=r.inherited;if(i&&e.parentElement&&EP(e.parentElement,t)){var a=e.parentElement.parsedStyle[t];return a==="unset"||a==="initial"||a==="inherit"?void 0:a}},n.prototype.recalc=function(e){var t=ws.get(e);if(t&&t.length){var r={};t.forEach(function(i){r[i]=e.attributes[i]}),this.processProperties(e,r),ws.delete(e)}},n.prototype.updateGeometry=function(e){var t=e.nodeName,r=this.runtime.geometryUpdaterFactory[t];if(r){var i=e.geometry;i.contentBounds||(i.contentBounds=new Fe),i.renderBounds||(i.renderBounds=new Fe);var a=e.parsedStyle,o=r.update(a,e),s=o.cx,l=s===void 0?0:s,c=o.cy,u=c===void 0?0:c,h=o.cz,f=h===void 0?0:h,d=o.hwidth,p=d===void 0?0:d,v=o.hheight,g=v===void 0?0:v,m=o.hdepth,x=m===void 0?0:m,S=[Math.abs(p),Math.abs(g),x],T=a,b=T.stroke,y=T.lineWidth,E=y===void 0?1:y,w=T.increasedLineWidthForHitTesting,C=w===void 0?0:w,M=T.shadowType,O=M===void 0?"outer":M,A=T.shadowColor,R=T.filter,L=R===void 0?[]:R,z=T.transformOrigin,Y=[l,u,f];i.contentBounds.update(Y,S);var I=t===ct.POLYLINE||t===ct.POLYGON||t===ct.PATH?Math.SQRT2:.5,q=b&&!b.isNone;if(q){var J=((E||0)+(C||0))*I;S[0]+=J,S[1]+=J}if(i.renderBounds.update(Y,S),A&&O&&O!=="inner"){var wt=i.renderBounds,Ft=wt.min,fe=wt.max,xe=a,Sr=xe.shadowBlur,jr=xe.shadowOffsetX,zn=xe.shadowOffsetY,rn=Sr||0,On=jr||0,di=zn||0,cr=Ft[0]-rn+On,$r=fe[0]+rn+On,xo=Ft[1]-rn+di,Pc=fe[1]+rn+di;Ft[0]=Math.min(Ft[0],cr),fe[0]=Math.max(fe[0],$r),Ft[1]=Math.min(Ft[1],xo),fe[1]=Math.max(fe[1],Pc),i.renderBounds.setMinMax(Ft,fe)}L.forEach(function(wo){var So=wo.name,Kr=wo.params;if(So==="blur"){var _o=Kr[0].value;i.renderBounds.update(i.renderBounds.center,Yc(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[_o,_o,0]))}else if(So==="drop-shadow"){var To=Kr[0].value,Po=Kr[1].value,Zr=Kr[2].value,Mo=i.renderBounds,pn=Mo.min,vn=Mo.max,Oc=pn[0]-Zr+To,Ac=vn[0]+Zr+To,Nc=pn[1]-Zr+Po,Rc=vn[1]+Zr+Po;pn[0]=Math.min(pn[0],Oc),vn[0]=Math.max(vn[0],Ac),pn[1]=Math.min(pn[1],Nc),vn[1]=Math.max(vn[1],Rc),i.renderBounds.setMinMax(pn,vn)}}),e.geometry.dirty=!1;var Mc=p<0,Cc=g<0,bo=(Mc?-1:1)*(z?ti(z[0],0,e,!0):0),Eo=(Cc?-1:1)*(z?ti(z[1],1,e,!0):0);(bo||Eo)&&e.setOrigin(bo,Eo)}},n.prototype.updateSizeAttenuation=function(e,t){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/t,e.nodeName===ct.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/t)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===ct.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR))},n.prototype.isPropertyInheritable=function(e){var t=Ha[e];return t?t.inh:!1},n}(),SP=function(){function n(){this.parser=Km,this.parserUnmemoize=Rd,this.parserWithCSSDisabled=null,this.mixer=kd}return n.prototype.calculator=function(e,t,r,i){return Nr(r)},n}(),_P=function(){function n(){}return n.prototype.calculator=function(e,t,r,i,a){return r instanceof Ar&&(r=null),a.sceneGraphService.updateDisplayObjectDependency(e,t,r,i),e==="clipPath"&&i.forEach(function(o){o.childNodes.length===0&&a.sceneGraphService.dirtifyToRoot(o)}),r},n}(),TP=function(){function n(){this.parser=xs,this.parserWithCSSDisabled=xs,this.mixer=YT}return n.prototype.calculator=function(e,t,r,i){return r instanceof Ar?r.value==="none"?$c:Hm:r},n}(),PP=function(){function n(){this.parser=Jm}return n.prototype.calculator=function(e,t,r){return r instanceof Ar?[]:r},n}();function dy(n){var e=n.parsedStyle.fontSize;return pt(e)?null:e}var Vd=function(){function n(){this.parser=bs,this.parserUnmemoize=_l,this.parserWithCSSDisabled=null,this.mixer=kd}return n.prototype.calculator=function(e,t,r,i,a){var o;if(te(r))return r;if(Re.isRelativeUnit(r.unit)){var s=a.styleValueRegistry;if(r.unit===xt.kPercentage)return 0;if(r.unit===xt.kEms){if(i.parentNode){var l=dy(i.parentNode);if(l)return l*=r.value,l;s.addUnresolveProperty(i,e)}else s.addUnresolveProperty(i,e);return 0}else if(r.unit===xt.kRems){if(!((o=i==null?void 0:i.ownerDocument)===null||o===void 0)&&o.documentElement){var l=dy(i.ownerDocument.documentElement);if(l)return l*=r.value,l;s.addUnresolveProperty(i,e)}else s.addUnresolveProperty(i,e);return 0}}else return r.value},n}(),MP=function(){function n(){this.mixer=ty}return n.prototype.parser=function(e){var t=qm(te(e)?[e]:e),r;return t.length===1?r=[t[0],t[0]]:r=[t[0],t[1]],r},n.prototype.calculator=function(e,t,r){return r.map(function(i){return i.value})},n}(),CP=function(){function n(){this.mixer=ty}return n.prototype.parser=function(e){var t=qm(te(e)?[e]:e),r;return t.length===1?r=[t[0],t[0],t[0],t[0]]:t.length===2?r=[t[0],t[1],t[0],t[1]]:t.length===3?r=[t[0],t[1],t[2],t[1]]:r=[t[0],t[1],t[2],t[3]],r},n.prototype.calculator=function(e,t,r){return r.map(function(i){return i.value})},n}(),OP=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){r instanceof Ar&&(r=null);var a=r==null?void 0:r.cloneNode(!0);return a&&(a.style.isMarker=!0),a},n}(),AP=function(){function n(){this.mixer=kd,this.parser=Ro,this.parserUnmemoize=Es,this.parserWithCSSDisabled=null}return n.prototype.calculator=function(e,t,r){return r.value},n}(),NP=function(){function n(){this.parser=Ro,this.parserUnmemoize=Es,this.parserWithCSSDisabled=null,this.mixer=Ld(0,1)}return n.prototype.calculator=function(e,t,r){return r.value},n.prototype.postProcessor=function(e){var t=e.parsedStyle,r=t.offsetPath,i=t.offsetDistance;if(r){var a=r.nodeName;if(a===ct.LINE||a===ct.PATH||a===ct.POLYLINE){var o=r.getPoint(i);o&&e.setLocalPosition(o.x,o.y)}}},n}(),RP=function(){function n(){this.parser=Ro,this.parserUnmemoize=Es,this.parserWithCSSDisabled=null,this.mixer=Ld(0,1)}return n.prototype.calculator=function(e,t,r){return r.value},n}(),kP=function(){function n(){this.parser=Bd,this.parserWithCSSDisabled=Bd,this.mixer=cP}return n.prototype.calculator=function(e,t,r){return r instanceof Ar&&r.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Ua(0,0,0,0)}:r},n}(),LP=function(){function n(){this.parser=ly,this.mixer=uP}return n}(),IP=function(n){B(e,n);function e(){var t=n.apply(this,K([],P(arguments),!1))||this;return t.mixer=Ld(0,1/0),t}return e}(Vd),DP=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){return r instanceof Ar?r.value==="unset"?"":r.value:"".concat(r)},n.prototype.postProcessor=function(e){e.nodeValue="".concat(e.parsedStyle.text)||""},n}(),BP=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){var a=i.getAttribute("text");if(a){var o=a;r.value==="capitalize"?o=a.charAt(0).toUpperCase()+a.slice(1):r.value==="lowercase"?o=a.toLowerCase():r.value==="uppercase"&&(o=a.toUpperCase()),i.parsedStyle.text=o}return r.value},n}(),Hd={},FP=0;function GP(n,e){if(n){var t=typeof n=="string"?n:n.id||FP++;Hd[t]&&Hd[t].destroy(),Hd[t]=e}}var Tl=typeof window!="undefined"&&typeof window.document!="undefined";function zP(n){return!!n.getAttribute}function WP(n,e){for(var t=0,r=n.length;t<r;){var i=t+r>>>1;py(n[i],e)<0?t=i+1:r=i}return t}function py(n,e){var t=Number(n.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(t===r){var i=n.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(n)-a.indexOf(e)}}return t-r}function vy(n){var e,t=n;do{var r=(e=t.parsedStyle)===null||e===void 0?void 0:e.clipPath;if(r)return t;t=t.parentElement}while(t!==null);return null}var gy="px";function UP(n,e,t){Tl&&n.style&&(n.style.width=e+gy,n.style.height=t+gy)}function my(n,e){if(Tl)return document.defaultView.getComputedStyle(n,null).getPropertyValue(e)}function VP(n){var e=my(n,"width");return e==="auto"?n.offsetWidth:parseFloat(e)}function HP(n){var e=my(n,"height");return e==="auto"?n.offsetHeight:parseFloat(e)}var YP=1,XP={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Yd=typeof performance=="object"&&performance.now?performance:Date;function Lo(n,e,t){n===void 0&&(n="auto");var r=!1,i=!1,a=!!e&&!e.isNone,o=!!t&&!t.isNone;return n==="visiblepainted"||n==="painted"||n==="auto"?(r=a,i=o):n==="visiblefill"||n==="fill"?r=!0:n==="visiblestroke"||n==="stroke"?i=!0:(n==="visible"||n==="all")&&(r=!0,i=!0),[r,i]}var jP=1,$P=function(){return jP++},ta=typeof self=="object"&&self.self==self?self:typeof D.g=="object"&&D.g.global==D.g?D.g:{},KP=Date.now(),ZP=function(){return ta.performance&&typeof ta.performance.now=="function"?ta.performance.now():Date.now()-KP},Pl={},yy=Date.now(),qP=function(n){if(typeof n!="function")throw new TypeError(n+" is not a function");var e=Date.now(),t=e-yy,r=t>16?0:16-t,i=$P();return Pl[i]=n,Object.keys(Pl).length>1||setTimeout(function(){yy=e;var a=Pl;Pl={},Object.keys(a).forEach(function(o){return a[o](ZP())})},r),i},JP=function(n){delete Pl[n]},QP=["","webkit","moz","ms","o"],xy=function(n){return typeof n!="string"?qP:n===""?ta.requestAnimationFrame:ta[n+"RequestAnimationFrame"]},tM=function(n){return typeof n!="string"?JP:n===""?ta.cancelAnimationFrame:ta[n+"CancelAnimationFrame"]||ta[n+"CancelRequestAnimationFrame"]},eM=function(n,e){for(var t=0;n[t]!==void 0;){if(e(n[t]))return n[t];t=t+1}},by=eM(QP,function(n){return!!xy(n)}),Xd=xy(by),Ey=tM(by);ta.requestAnimationFrame=Xd,ta.cancelAnimationFrame=Ey;var nM=function(){function n(){this.callbacks=[]}return n.prototype.getCallbacksNum=function(){return this.callbacks.length},n.prototype.tapPromise=function(e,t){this.callbacks.push(t)},n.prototype.promise=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Promise.all(this.callbacks.map(function(r){return r.apply(void 0,K([],P(e),!1))}))},n}(),rM=function(){function n(){this.callbacks=[]}return n.prototype.tapPromise=function(e,t){this.callbacks.push(t)},n.prototype.promise=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return j(this,void 0,void 0,function(){var r,i,a,o;return mt(this,function(s){switch(s.label){case 0:return this.callbacks.length?[4,(o=this.callbacks)[0].apply(o,K([],P(e),!1))]:[3,6];case 1:r=s.sent(),i=0,s.label=2;case 2:return i<this.callbacks.length-1?(a=this.callbacks[i],[4,a(r)]):[3,5];case 3:r=s.sent(),s.label=4;case 4:return i++,[3,2];case 5:return[2,r];case 6:return[2,null]}})})},n}(),vr=function(){function n(){this.callbacks=[]}return n.prototype.tap=function(e,t){this.callbacks.push(t)},n.prototype.call=function(){var e=arguments;this.callbacks.forEach(function(t){t.apply(void 0,e)})},n}(),jd=function(){function n(){this.callbacks=[]}return n.prototype.tap=function(e,t){this.callbacks.push(t)},n.prototype.call=function(){if(this.callbacks.length){for(var e=arguments,t=this.callbacks[0].apply(void 0,e),r=0;r<this.callbacks.length-1;r++){var i=this.callbacks[r];t=i(t)}return t}return null},n}(),iM=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],aM=/([\"\'])[^\'\"]+\1/;function oM(n){for(var e=n.fontSize,t=e===void 0?16:e,r=n.fontFamily,i=r===void 0?"sans-serif":r,a=n.fontStyle,o=a===void 0?"normal":a,s=n.fontVariant,l=s===void 0?"normal":s,c=n.fontWeight,u=c===void 0?"normal":c,h=te(t)&&"".concat(t,"px")||"16px",f=i.split(","),d=f.length-1;d>=0;d--){var p=f[d].trim();!aM.test(p)&&iM.indexOf(p)<0&&(p='"'.concat(p,'"')),f[d]=p}return"".concat(o," ").concat(l," ").concat(u," ").concat(h," ").concat(f.join(","))}function $d(n,e,t){return Xt(n),n[4]=Math.tan(e),n[1]=Math.tan(t),n}var Ml=1e-5,sM=Q(),Tn=Q();function wy(n,e){if(n.length){var t=Xt(sM);n.forEach(function(r){var i=r.t,a=r.d;if(i==="scale"){var o=(a==null?void 0:a.map(function(m){return Math.max(m.value,Ml)}))||[1,1];Oe(Tn,[o[0],o[1],1])}else if(i==="scalex"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,Ml)}))||[1];Oe(Tn,[o[0],1,1])}else if(i==="scaley"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,Ml)}))||[1];Oe(Tn,[1,o[0],1])}else if(i==="scalez"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,Ml)}))||[1];Oe(Tn,[1,1,o[0]])}else if(i==="scale3d"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,Ml)}))||[1,1,1];Oe(Tn,[o[0],o[1],o[2]])}else if(i==="translate"){var s=a||[gn,gn];ue(Tn,[s[0].value,s[1].value,0])}else if(i==="translatex"){var s=a||[gn];ue(Tn,[s[0].value,0,0])}else if(i==="translatey"){var s=a||[gn];ue(Tn,[0,s[0].value,0])}else if(i==="translatez"){var s=a||[gn];ue(Tn,[0,0,s[0].value])}else if(i==="translate3d"){var s=a||[gn,gn,gn];ue(Tn,[s[0].value,s[1].value,s[2].value])}else if(i==="rotate"){var l=a||[Ei];qr(Tn,Ae(Nr(l[0])))}else if(i==="rotatex"){var l=a||[Ei];ie(Tn,Ae(Nr(l[0])))}else if(i==="rotatey"){var l=a||[Ei];Xe(Tn,Ae(Nr(l[0])))}else if(i==="rotatez"){var l=a||[Ei];qr(Tn,Ae(Nr(l[0])))}else if(i==="rotate3d"){var l=a||[gn,gn,gn,Ei];Tr(Tn,Ae(Nr(l[3])),[l[0].value,l[1].value,l[2].value])}else if(i==="skew"){var c=(a==null?void 0:a.map(function(m){return m.value}))||[0,0];$d(Tn,Ae(c[0]),Ae(c[1]))}else if(i==="skewx"){var c=(a==null?void 0:a.map(function(x){return x.value}))||[0];$d(Tn,Ae(c[0]),0)}else if(i==="skewy"){var c=(a==null?void 0:a.map(function(x){return x.value}))||[0];$d(Tn,0,Ae(c[0]))}else if(i==="matrix"){var u=P(a.map(function(m){return m.value}),6),h=u[0],f=u[1],d=u[2],p=u[3],v=u[4],g=u[5];re(Tn,h,f,0,0,d,p,0,0,0,0,1,0,v,g,0,1)}else i==="matrix3d"&&re.apply(G,K([Tn],P(a.map(function(m){return m.value})),!1));Gc(t,t,Tn)}),e.setLocalTransform(t)}else e.resetLocalTransform();return e.getLocalTransform()}var lM=function(){function n(){this.parser=Fd,this.parserUnmemoize=cy,this.parserWithCSSDisabled=cy,this.mixer=xP}return n.prototype.calculator=function(e,t,r,i){return r instanceof Ar?[]:r},n.prototype.postProcessor=function(e){var t=e.parsedStyle.transform;wy(t,e)},n}(),cM=function(){function n(){this.parser=hy,this.parserUnmemoize=bP}return n.prototype.postProcessor=function(e){var t=e.parsedStyle.transformOrigin;t[0].unit===xt.kPixels&&t[1].unit===xt.kPixels?e.setOrigin(t[0].value,t[1].value):e.getGeometryBounds()},n}(),uM=function(){function n(){this.parser=Ro,this.parserUnmemoize=Es}return n.prototype.calculator=function(e,t,r,i){return r.value},n.prototype.postProcessor=function(e){if(e.parentNode){var t=e.parentNode,r=t.renderable,i=t.sortable;r&&(r.dirty=!0),i&&(i.dirty=!0,i.dirtyReason=ys.Z_INDEX_CHANGED)}},n}(),hM=function(){function n(){}return n.prototype.update=function(e,t){var r=e.cx,i=r===void 0?0:r,a=e.cy,o=a===void 0?0:a,s=e.r,l=s===void 0?0:s;return{cx:i,cy:o,hwidth:l,hheight:l}},n}(),fM=function(){function n(){}return n.prototype.update=function(e,t){var r=e.cx,i=r===void 0?0:r,a=e.cy,o=a===void 0?0:a,s=e.rx,l=s===void 0?0:s,c=e.ry,u=c===void 0?0:c;return{cx:i,cy:o,hwidth:l,hheight:u}},n}(),dM=function(){function n(){}return n.prototype.update=function(e){var t=e.x1,r=e.y1,i=e.x2,a=e.y2,o=Math.min(t,i),s=Math.max(t,i),l=Math.min(r,a),c=Math.max(r,a),u=s-o,h=c-l,f=u/2,d=h/2;return{cx:o+f,cy:l+d,hwidth:f,hheight:d}},n}(),pM=function(){function n(){}return n.prototype.update=function(e){var t=e.d,r=t.rect,i=r.x,a=r.y,o=r.width,s=r.height,l=o/2,c=s/2;return{cx:i+l,cy:a+c,hwidth:l,hheight:c}},n}(),vM=function(){function n(){}return n.prototype.update=function(e){if(e.points&&tr(e.points.points)){var t=e.points.points,r=Math.min.apply(Math,K([],P(t.map(function(h){return h[0]})),!1)),i=Math.max.apply(Math,K([],P(t.map(function(h){return h[0]})),!1)),a=Math.min.apply(Math,K([],P(t.map(function(h){return h[1]})),!1)),o=Math.max.apply(Math,K([],P(t.map(function(h){return h[1]})),!1)),s=i-r,l=o-a,c=s/2,u=l/2;return{cx:r+c,cy:a+u,hwidth:c,hheight:u}}return{cx:0,cy:0,hwidth:0,hheight:0}},n}(),gM=function(){function n(){}return n.prototype.update=function(e,t){var r=e.x,i=r===void 0?0:r,a=e.y,o=a===void 0?0:a,s=e.src,l=e.width,c=l===void 0?0:l,u=e.height,h=u===void 0?0:u,f=c,d=h;return s&&!qt(s)&&(f||(f=s.width,e.width=f),d||(d=s.height,e.height=d)),{cx:i+f/2,cy:o+d/2,hwidth:f/2,hheight:d/2}},n}(),mM=function(){function n(e){this.globalRuntime=e}return n.prototype.isReadyToMeasure=function(e,t){var r=e.text,i=e.textAlign,a=e.textBaseline,o=e.fontSize,s=e.fontStyle,l=e.fontWeight,c=e.fontVariant,u=e.lineWidth;return nt.enableCSSParsing?r&&o&&s&&l&&c&&i&&a&&!pt(u):r},n.prototype.update=function(e,t){var r,i,a=e.text,o=e.textAlign,s=o===void 0?"start":o,l=e.lineWidth,c=l===void 0?1:l,u=e.textBaseline,h=u===void 0?"alphabetic":u,f=e.dx,d=f===void 0?0:f,p=e.dy,v=p===void 0?0:p,g=e.x,m=g===void 0?0:g,x=e.y,S=x===void 0?0:x;if(!this.isReadyToMeasure(e,t))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var T=(((i=(r=t==null?void 0:t.ownerDocument)===null||r===void 0?void 0:r.defaultView)===null||i===void 0?void 0:i.getConfig())||{}).offscreenCanvas,b=this.globalRuntime.textService.measureText(a,e,T);e.metrics=b;var y=b.width,E=b.height,w=b.lineHeight,C=b.fontProperties,M=y/2,O=E/2,A=m+M;s==="center"||s==="middle"?A+=c/2-M:(s==="right"||s==="end")&&(A+=c-M*2);var R=S-O;return h==="middle"?R+=O:h==="top"||h==="hanging"?R+=O*2:h==="alphabetic"?R+=this.globalRuntime.enableCSSParsing?w-C.ascent:0:(h==="bottom"||h==="ideographic")&&(R+=0),d&&(A+=d),v&&(R+=v),{cx:A,cy:R,hwidth:M,hheight:O}},n}(),yM=function(){function n(){}return n.prototype.update=function(e,t){return{cx:0,cy:0,hwidth:0,hheight:0}},n}();function xM(n){return!!n.type}var tu=function(){function n(e){this.eventPhase=n.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Wn,this.page=new Wn,this.canvas=new Wn,this.viewport=new Wn,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}return Object.defineProperty(n.prototype,"name",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layerX",{get:function(){return this.layer.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layerY",{get:function(){return this.layer.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageX",{get:function(){return this.page.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageY",{get:function(){return this.page.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"x",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasX",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasY",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewportX",{get:function(){return this.viewport.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewportY",{get:function(){return this.viewport.y},enumerable:!1,configurable:!0}),n.prototype.composedPath=function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},Object.defineProperty(n.prototype,"propagationPath",{get:function(){return this.composedPath()},enumerable:!1,configurable:!0}),n.prototype.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},n.prototype.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},n.prototype.stopPropagation=function(){this.propagationStopped=!0},n.prototype.initEvent=function(){},n.prototype.initUIEvent=function(){},n.prototype.clone=function(){throw new Error(Ne)},n}(),Sy=function(n){B(e,n);function e(){var t=n.apply(this,K([],P(arguments),!1))||this;return t.client=new Wn,t.movement=new Wn,t.offset=new Wn,t.global=new Wn,t.screen=new Wn,t}return Object.defineProperty(e.prototype,"clientX",{get:function(){return this.client.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientY",{get:function(){return this.client.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementX",{get:function(){return this.movement.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementY",{get:function(){return this.movement.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetX",{get:function(){return this.offset.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetY",{get:function(){return this.offset.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalX",{get:function(){return this.global.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalY",{get:function(){return this.global.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenX",{get:function(){return this.screen.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenY",{get:function(){return this.screen.y},enumerable:!1,configurable:!0}),e.prototype.getModifierState=function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)},e.prototype.initMouseEvent=function(){throw new Error(Ne)},e}(tu),eu=function(n){B(e,n);function e(){var t=n.apply(this,K([],P(arguments),!1))||this;return t.width=0,t.height=0,t.isPrimary=!1,t}return e.prototype.getCoalescedEvents=function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]},e.prototype.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},e.prototype.clone=function(){return this.manager.clonePointerEvent(this)},e}(Sy),Kd=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.clone=function(){return this.manager.cloneWheelEvent(this)},e}(Sy),nr=function(n){B(e,n);function e(t,r){var i=n.call(this,null)||this;return i.type=t,i.detail=r,Object.assign(i,r),i}return e}(tu),_y=":",Ty=function(){function n(){this.emitter=new et}return n.prototype.on=function(e,t,r){return this.addEventListener(e,t,r),this},n.prototype.addEventListener=function(e,t,r){var i=za(r)&&r||Ye(r)&&r.capture,a=Ye(r)&&r.once,o=ms(t)?void 0:t,s=!1,l="";if(e.indexOf(_y)>-1){var c=P(e.split(_y),2),u=c[0],h=c[1];e=h,l=u,s=!0}if(e=i?"".concat(e,"capture"):e,t=ms(t)?t:t.handleEvent,s){var f=t;t=function(){for(var d,p=[],v=0;v<arguments.length;v++)p[v]=arguments[v];((d=p[0].target)===null||d===void 0?void 0:d.name)===l&&f.apply(void 0,K([],P(p),!1))}}return a?this.emitter.once(e,t,o):this.emitter.on(e,t,o),this},n.prototype.off=function(e,t,r){return e?this.removeEventListener(e,t,r):this.removeAllEventListeners(),this},n.prototype.removeAllEventListeners=function(){this.emitter.removeAllListeners()},n.prototype.removeEventListener=function(e,t,r){var i=za(r)&&r||Ye(r)&&r.capture,a=ms(t)?void 0:t;return e=i?"".concat(e,"capture"):e,t=ms(t)?t:t==null?void 0:t.handleEvent,this.emitter.off(e,t,a),this},n.prototype.emit=function(e,t){this.dispatchEvent(new nr(e,t))},n.prototype.dispatchEvent=function(e,t){var r,i;if(t===void 0&&(t=!1),!xM(e))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var a;if(this.document?a=this:this.defaultView?a=this.defaultView:a=(r=this.ownerDocument)===null||r===void 0?void 0:r.defaultView,a){if(e.manager=a.getEventService()||null,!e.manager)return!1;e.defaultPrevented=!1,e.path=[],t||(e.target=this),(i=e.manager)===null||i===void 0||i.dispatchEvent(e,e.type,t)}return!e.defaultPrevented},n}(),Dn=function(n){B(e,n);function e(){var t=n.call(this)||this;return t.shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return e.isNode=function(t){return!!t.childNodes},Object.defineProperty(e.prototype,"textContent",{get:function(){var t,r,i="";this.nodeName===ct.TEXT&&(i+=this.style.text);try{for(var a=vt(this.childNodes),o=a.next();!o.done;o=a.next()){var s=o.value;s.nodeName===ct.TEXT?i+=s.nodeValue:i+=s.textContent}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return i},set:function(t){var r=this;this.childNodes.slice().forEach(function(i){r.removeChild(i)}),this.nodeName===ct.TEXT&&(this.style.text="".concat(t))},enumerable:!1,configurable:!0}),e.prototype.getRootNode=function(t){return t===void 0&&(t={}),this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this},e.prototype.hasChildNodes=function(){return this.childNodes.length>0},e.prototype.isDefaultNamespace=function(t){throw new Error(Ne)},e.prototype.lookupNamespaceURI=function(t){throw new Error(Ne)},e.prototype.lookupPrefix=function(t){throw new Error(Ne)},e.prototype.normalize=function(){throw new Error(Ne)},e.prototype.isEqualNode=function(t){return this===t},e.prototype.isSameNode=function(t){return this.isEqualNode(t)},Object.defineProperty(e.prototype,"parent",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.childNodes.length>0?this.childNodes[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null},enumerable:!1,configurable:!0}),e.prototype.compareDocumentPosition=function(t){var r;if(t===this)return 0;for(var i=t,a=this,o=[i],s=[a];(r=i.parentNode)!==null&&r!==void 0?r:a.parentNode;)i=i.parentNode?(o.push(i.parentNode),i.parentNode):i,a=a.parentNode?(s.push(a.parentNode),a.parentNode):a;if(i!==a)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var l=o.length>s.length?o:s,c=l===o?s:o;if(l[l.length-c.length]===c[0])return l===o?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=l.length-c.length,h=c.length-1;h>=0;h--){var f=c[h],d=l[u+h];if(d!==f){var p=f.parentNode.childNodes;return p.indexOf(f)<p.indexOf(d)?c===o?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:l===o?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING},e.prototype.contain=function(t){return this.contains(t)},e.prototype.contains=function(t){for(var r=t;r&&this!==r;)r=r.parentNode;return!!r},e.prototype.getAncestor=function(t){for(var r=this;t>0&&r;)r=r.parentNode,t--;return r},e.prototype.forEach=function(t,r){r===void 0&&(r=!1),t(this)||(r?this.childNodes.slice():this.childNodes).forEach(function(i){i.forEach(t)})},e.DOCUMENT_POSITION_DISCONNECTED=1,e.DOCUMENT_POSITION_PRECEDING=2,e.DOCUMENT_POSITION_FOLLOWING=4,e.DOCUMENT_POSITION_CONTAINS=8,e.DOCUMENT_POSITION_CONTAINED_BY=16,e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,e}(Ty),bM=2048,EM=function(){function n(e,t){var r=this;this.globalRuntime=e,this.context=t,this.emitter=new et,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=Q(),this.tmpVec3=_.Ue(),this.onPointerDown=function(i){var a=r.createPointerEvent(i);if(r.dispatchEvent(a,"pointerdown"),a.pointerType==="touch")r.dispatchEvent(a,"touchstart");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var o=a.button===2;r.dispatchEvent(a,o?"rightdown":"mousedown")}var s=r.trackingData(i.pointerId);s.pressTargetsByButton[i.button]=a.composedPath(),r.freeEvent(a)},this.onPointerUp=function(i){var a,o=Yd.now(),s=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(s,"pointerup"),s.pointerType==="touch")r.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.dispatchEvent(s,l?"rightup":"mouseup")}var c=r.trackingData(i.pointerId),u=r.findMountedTarget(c.pressTargetsByButton[i.button]),h=u;if(u&&!s.composedPath().includes(u)){for(var f=u;f&&!s.composedPath().includes(f);){if(s.currentTarget=f,r.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")r.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.notifyTarget(s,l?"rightupoutside":"mouseupoutside")}Dn.isNode(f)&&(f=f.parentNode)}delete c.pressTargetsByButton[i.button],h=f}if(h){var d=r.clonePointerEvent(s,"click");d.target=h,d.path=[],c.clicksByButton[i.button]||(c.clicksByButton[i.button]={clickCount:0,target:d.target,timeStamp:o});var p=r.context.renderingContext.root.ownerDocument.defaultView,v=c.clicksByButton[i.button];v.target===d.target&&o-v.timeStamp<p.dblClickSpeed?++v.clickCount:v.clickCount=1,v.target=d.target,v.timeStamp=o,d.detail=v.clickCount,!((a=s.detail)===null||a===void 0)&&a.preventClick||(!r.context.config.useNativeClickEvent&&(d.pointerType==="mouse"||d.pointerType==="touch")&&r.dispatchEvent(d,"click"),r.dispatchEvent(d,"pointertap")),r.freeEvent(d)}r.freeEvent(s)},this.onPointerMove=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),o=a.pointerType==="mouse"||a.pointerType==="pen",s=r.trackingData(i.pointerId),l=r.findMountedTarget(s.overTargets);if(s.overTargets&&l!==a.target){var c=i.type==="mousemove"?"mouseout":"pointerout",u=r.createPointerEvent(i,c,l||void 0);if(r.dispatchEvent(u,"pointerout"),o&&r.dispatchEvent(u,"mouseout"),!a.composedPath().includes(l)){var h=r.createPointerEvent(i,"pointerleave",l||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!a.composedPath().includes(h.target);)h.currentTarget=h.target,r.notifyTarget(h),o&&r.notifyTarget(h,"mouseleave"),Dn.isNode(h.target)&&(h.target=h.target.parentNode);r.freeEvent(h)}r.freeEvent(u)}if(l!==a.target){var f=i.type==="mousemove"?"mouseover":"pointerover",d=r.clonePointerEvent(a,f);r.dispatchEvent(d,"pointerover"),o&&r.dispatchEvent(d,"mouseover");for(var p=l&&Dn.isNode(l)&&l.parentNode;p&&p!==(Dn.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&p!==a.target;)p=p.parentNode;var v=!p||p===(Dn.isNode(r.rootTarget)&&r.rootTarget.parentNode);if(v){var g=r.clonePointerEvent(a,"pointerenter");for(g.eventPhase=g.AT_TARGET;g.target&&g.target!==l&&g.target!==(Dn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)g.currentTarget=g.target,r.notifyTarget(g),o&&r.notifyTarget(g,"mouseenter"),Dn.isNode(g.target)&&(g.target=g.target.parentNode);r.freeEvent(g)}r.freeEvent(d)}r.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&r.dispatchEvent(a,"touchmove"),o&&(r.dispatchEvent(a,"mousemove"),r.cursor=r.getCursor(a.target)),s.overTargets=a.composedPath(),r.freeEvent(a)},this.onPointerOut=function(i){var a=r.trackingData(i.pointerId);if(a.overTargets){var o=i.pointerType==="mouse"||i.pointerType==="pen",s=r.findMountedTarget(a.overTargets),l=r.createPointerEvent(i,"pointerout",s||void 0);r.dispatchEvent(l),o&&r.dispatchEvent(l,"mouseout");var c=r.createPointerEvent(i,"pointerleave",s||void 0);for(c.eventPhase=c.AT_TARGET;c.target&&c.target!==(Dn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)c.currentTarget=c.target,r.notifyTarget(c),o&&r.notifyTarget(c,"mouseleave"),Dn.isNode(c.target)&&(c.target=c.target.parentNode);a.overTargets=null,r.freeEvent(l),r.freeEvent(c)}r.cursor=null},this.onPointerOver=function(i){var a=r.trackingData(i.pointerId),o=r.createPointerEvent(i),s=o.pointerType==="mouse"||o.pointerType==="pen";r.dispatchEvent(o,"pointerover"),s&&r.dispatchEvent(o,"mouseover"),o.pointerType==="mouse"&&(r.cursor=r.getCursor(o.target));var l=r.clonePointerEvent(o,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(Dn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)l.currentTarget=l.target,r.notifyTarget(l),s&&r.notifyTarget(l,"mouseenter"),Dn.isNode(l.target)&&(l.target=l.target.parentNode);a.overTargets=o.composedPath(),r.freeEvent(o),r.freeEvent(l)},this.onPointerUpOutside=function(i){var a=r.trackingData(i.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[i.button]),s=r.createPointerEvent(i);if(o){for(var l=o;l;)s.currentTarget=l,r.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"||(s.pointerType==="mouse"||s.pointerType==="pen")&&r.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),Dn.isNode(l)&&(l=l.parentNode);delete a.pressTargetsByButton[i.button]}r.freeEvent(s)},this.onWheel=function(i){var a=r.createWheelEvent(i);r.dispatchEvent(a),r.freeEvent(a)},this.onClick=function(i){if(r.context.config.useNativeClickEvent){var a=r.createPointerEvent(i);r.dispatchEvent(a),r.freeEvent(a)}},this.onPointerCancel=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(a),r.freeEvent(a)}}return n.prototype.init=function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)},n.prototype.destroy=function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()},n.prototype.getScale=function(){var e=this.context.contextService.getBoundingClientRect(),t=1,r=1,i=this.context.contextService.getDomElement();if(i&&e){var a=i.offsetWidth,o=i.offsetHeight;a&&o&&(t=e.width/a,r=e.height/o)}return{scaleX:t,scaleY:r,bbox:e}},n.prototype.client2Viewport=function(e){var t=this.getScale(),r=t.scaleX,i=t.scaleY,a=t.bbox;return new Wn((e.x-((a==null?void 0:a.left)||0))/r,(e.y-((a==null?void 0:a.top)||0))/i)},n.prototype.viewport2Client=function(e){var t=this.getScale(),r=t.scaleX,i=t.scaleY,a=t.bbox;return new Wn((e.x+((a==null?void 0:a.left)||0))*r,(e.y+((a==null?void 0:a.top)||0))*i)},n.prototype.viewport2Canvas=function(e){var t=e.x,r=e.y,i=this.rootTarget.defaultView,a=i.getCamera(),o=this.context.config,s=o.width,l=o.height,c=a.getPerspectiveInverse(),u=a.getWorldTransform(),h=Ut(this.tmpMatrix,u,c),f=_.t8(this.tmpVec3,t/s*2-1,(1-r/l)*2-1,0);return _.fF(f,f,h),new Wn(f[0],f[1])},n.prototype.canvas2Viewport=function(e){var t=this.rootTarget.defaultView,r=t.getCamera(),i=r.getPerspective(),a=r.getViewTransform(),o=Ut(this.tmpMatrix,i,a),s=_.t8(this.tmpVec3,e.x,e.y,0);_.fF(this.tmpVec3,this.tmpVec3,o);var l=this.context.config,c=l.width,u=l.height;return new Wn((s[0]+1)/2*c,(1-(s[1]+1)/2)*u)},n.prototype.setPickHandler=function(e){this.pickHandler=e},n.prototype.addEventMapping=function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(r,i){return r.priority-i.priority})},n.prototype.mapEvent=function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var r=0,i=t.length;r<i;r++)t[r].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type))}},n.prototype.dispatchEvent=function(e,t,r){if(!r)e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t);else{e.eventPhase=e.AT_TARGET;var i=this.rootTarget.defaultView||null;e.currentTarget=i,this.notifyListeners(e,t)}this.emitter.emit(t||e.type,e)},n.prototype.propagate=function(e,t){if(e.target){var r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var i=r.length-1;i>=1;i--)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){var a=r.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var i=a+1;i<r.length;i++)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}},n.prototype.propagationPath=function(e){var t=[e],r=this.rootTarget.defaultView||null;if(r&&r===e)return t.unshift(r.document),t;for(var i=0;i<bM&&e!==this.rootTarget;i++)Dn.isNode(e)&&e.parentNode&&(t.push(e.parentNode),e=e.parentNode);return r&&t.push(r),t},n.prototype.hitTest=function(e){var t=e.viewportX,r=e.viewportY,i=this.context.config,a=i.width,o=i.height,s=i.disableHitTesting;return t<0||r<0||t>a||r>o?null:!s&&this.pickHandler(e)||this.rootTarget||null},n.prototype.isNativeEventFromCanvas=function(e,t){var r=t==null?void 0:t.target;if(r!=null&&r.shadowRoot&&(r=t.composedPath()[0]),r){if(r===e)return!0;if(e&&e.contains)return e.contains(r)}return t!=null&&t.composedPath?t.composedPath().indexOf(e)>-1:!1},n.prototype.getExistedHTML=function(e){var t,r;if(e.nativeEvent.composedPath)try{for(var i=vt(e.nativeEvent.composedPath()),a=i.next();!a.done;a=i.next()){var o=a.value,s=this.nativeHTMLMap.get(o);if(s)return s}}catch(l){t={error:l}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return null},n.prototype.pickTarget=function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY})},n.prototype.createPointerEvent=function(e,t,r,i){var a=this.allocateEvent(eu);this.copyPointerData(e,a),this.copyMouseData(e,a),this.copyData(e,a),a.nativeEvent=e.nativeEvent,a.originalEvent=e;var o=this.getExistedHTML(a),s=this.context.contextService.getDomElement();return a.target=r!=null?r:o||this.isNativeEventFromCanvas(s,a.nativeEvent)&&this.pickTarget(a)||i,typeof t=="string"&&(a.type=t),a},n.prototype.createWheelEvent=function(e){var t=this.allocateEvent(Kd);this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e;var r=this.getExistedHTML(t),i=this.context.contextService.getDomElement();return t.target=r||this.isNativeEventFromCanvas(i,t.nativeEvent)&&this.pickTarget(t),t},n.prototype.trackingData=function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]},n.prototype.cloneWheelEvent=function(e){var t=this.allocateEvent(Kd);return t.nativeEvent=e.nativeEvent,t.originalEvent=e.originalEvent,this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.target=e.target,t.path=e.composedPath().slice(),t.type=e.type,t},n.prototype.clonePointerEvent=function(e,t){var r=this.allocateEvent(eu);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=t!=null?t:r.type,r},n.prototype.copyPointerData=function(e,t){t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist},n.prototype.copyMouseData=function(e,t){t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.client.copyFrom(e.client),t.movement.copyFrom(e.movement),t.canvas.copyFrom(e.canvas),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global),t.offset.copyFrom(e.offset)},n.prototype.copyWheelData=function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ},n.prototype.copyData=function(e,t){t.isTrusted=e.isTrusted,t.timeStamp=Yd.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.page.copyFrom(e.page),t.viewport.copyFrom(e.viewport)},n.prototype.allocateEvent=function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t},n.prototype.freeEvent=function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)},n.prototype.notifyTarget=function(e,t){t=t!=null?t:e.type;var r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)},n.prototype.notifyListeners=function(e,t){var r=e.currentTarget.emitter,i=r._events[t];if(i)if("fn"in i)i.once&&r.removeListener(t,i.fn,void 0,!0),i.fn.call(e.currentTarget||i.context,e);else for(var a=0;a<i.length&&!e.propagationImmediatelyStopped;a++)i[a].once&&r.removeListener(t,i[a].fn,void 0,!0),i[a].fn.call(e.currentTarget||i[a].context,e)},n.prototype.findMountedTarget=function(e){if(!e)return null;for(var t=e[e.length-1],r=e.length-2;r>=0;r--){var i=e[r];if(i===this.rootTarget||Dn.isNode(i)&&i.parentNode===t)t=e[r];else break}return t},n.prototype.getCursor=function(e){for(var t=e;t;){var r=zP(t)&&t.getAttribute("cursor");if(r)return r;t=Dn.isNode(t)&&t.parentNode}},n}(),wM=function(){function n(){}return n.prototype.getOrCreateCanvas=function(e,t){if(this.canvas)return this.canvas;if(e||nt.offscreenCanvas)this.canvas=e||nt.offscreenCanvas,this.context=this.canvas.getContext("2d",N({willReadFrequently:!0},t));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",N({willReadFrequently:!0},t)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",N({willReadFrequently:!0},t))}return this.canvas.width=10,this.canvas.height=10,this.canvas},n.prototype.getOrCreateContext=function(e,t){return this.context?this.context:(this.getOrCreateCanvas(e,t),this.context)},n}(),Io;(function(n){n[n.CAMERA_CHANGED=0]="CAMERA_CHANGED",n[n.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",n[n.NONE=2]="NONE"})(Io||(Io={}));var SM=function(){function n(e,t){this.globalRuntime=e,this.context=t,this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new vr,initAsync:new nM,dirtycheck:new jd,cull:new jd,beginFrame:new vr,beforeRender:new vr,render:new vr,afterRender:new vr,endFrame:new vr,destroy:new vr,pick:new rM,pickSync:new jd,pointerDown:new vr,pointerUp:new vr,pointerMove:new vr,pointerOut:new vr,pointerOver:new vr,pointerWheel:new vr,pointerCancel:new vr,click:new vr}}return n.prototype.init=function(e){var t=this,r=N(N({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(i){i.apply(r,t.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){t.inited=!0,e()})},n.prototype.getStats=function(){return this.stats},n.prototype.disableDirtyRectangleRendering=function(){var e=this.context.config.renderer,t=e.getConfig().enableDirtyRectangleRendering;return!t||this.context.renderingContext.renderReasons.has(Io.CAMERA_CHANGED)},n.prototype.render=function(e,t,r){var i=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var a=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=a.renderReasons.size===1&&a.renderReasons.has(Io.CAMERA_CHANGED),s=!e.disableRenderHooks||!(e.disableRenderHooks&&o);s&&this.renderDisplayObject(a.root,e,a),this.hooks.beginFrame.call(t),s&&a.renderListCurrentFrame.forEach(function(l){i.hooks.beforeRender.call(l),i.hooks.render.call(l),i.hooks.afterRender.call(l)}),this.hooks.endFrame.call(t),a.renderListCurrentFrame=[],a.renderReasons.clear(),r()}},n.prototype.renderDisplayObject=function(e,t,r){var i=this,a=t.renderer.getConfig(),o=a.enableDirtyCheck,s=a.enableCulling;this.globalRuntime.enableCSSParsing&&this.globalRuntime.styleValueRegistry.recalc(e);var l=e.renderable,c=o?l.dirty||r.dirtyRectangleRenderingDisabled?e:null:e;if(c){var u=s?this.hooks.cull.call(c,this.context.camera):c;u&&(this.stats.rendered++,r.renderListCurrentFrame.push(u))}e.renderable.dirty=!1,e.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var h=e.sortable;h.dirty&&(this.sort(e,h),h.dirty=!1,h.dirtyChildren=[],h.dirtyReason=void 0),(h.sorted||e.childNodes).forEach(function(f){i.renderDisplayObject(f,t,r)})},n.prototype.sort=function(e,t){t.sorted&&t.dirtyReason!==ys.Z_INDEX_CHANGED?t.dirtyChildren.forEach(function(r){var i=e.childNodes.indexOf(r);if(i===-1){var a=t.sorted.indexOf(r);a>=0&&t.sorted.splice(a,1)}else if(t.sorted.length===0)t.sorted.push(r);else{var o=WP(t.sorted,r);t.sorted.splice(o,0,r)}}):t.sorted=e.childNodes.slice().sort(py)},n.prototype.destroy=function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()},n.prototype.dirtify=function(){this.context.renderingContext.renderReasons.add(Io.DISPLAY_OBJECT_CHANGED)},n}(),_M=/\[\s*(.*)=(.*)\s*\]/,TM=function(){function n(){}return n.prototype.selectOne=function(e,t){var r=this;if(e.startsWith("."))return t.find(function(s){return((s==null?void 0:s.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.find(function(s){return s.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,o=i.value;return a?t.find(function(s){return t!==s&&(a==="name"?s.name===o:r.attributeToString(s,a)===o)}):null}else return t.find(function(s){return t!==s&&s.nodeName===e})},n.prototype.selectAll=function(e,t){var r=this;if(e.startsWith("."))return t.findAll(function(s){return t!==s&&((s==null?void 0:s.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.findAll(function(s){return t!==s&&s.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,o=i.value;return a?t.findAll(function(s){return t!==s&&(a==="name"?s.name===o:r.attributeToString(s,a)===o)}):[]}else return t.findAll(function(s){return t!==s&&s.nodeName===e})},n.prototype.is=function(e,t){if(e.startsWith("."))return t.className===this.getIdOrClassname(e);if(e.startsWith("#"))return t.id===this.getIdOrClassname(e);if(e.startsWith("[")){var r=this.getAttribute(e),i=r.name,a=r.value;return i==="name"?t.name===a:this.attributeToString(t,i)===a}else return t.nodeName===e},n.prototype.getIdOrClassname=function(e){return e.substring(1)},n.prototype.getAttribute=function(e){var t=e.match(_M),r="",i="";return t&&t.length>2&&(r=t[1].replace(/"/g,""),i=t[2].replace(/"/g,"")),{name:r,value:i}},n.prototype.attributeToString=function(e,t){if(!e.getAttribute)return"";var r=e.getAttribute(t);return pt(r)?"":r.toString?r.toString():""},n}(),Ya=function(n){B(e,n);function e(t,r,i,a,o,s,l,c){var u=n.call(this,null)||this;return u.relatedNode=r,u.prevValue=i,u.newValue=a,u.attrName=o,u.attrChange=s,u.prevParsedValue=l,u.newParsedValue=c,u.type=t,u}return e.ADDITION=2,e.MODIFICATION=1,e.REMOVAL=3,e}(tu),oe;(function(n){n.REPARENT="reparent",n.DESTROY="destroy",n.ATTR_MODIFIED="DOMAttrModified",n.INSERTED="DOMNodeInserted",n.REMOVED="removed",n.MOUNTED="DOMNodeInsertedIntoDocument",n.UNMOUNTED="DOMNodeRemovedFromDocument",n.BOUNDS_CHANGED="bounds-changed",n.CULLED="culled"})(oe||(oe={}));function Py(n){var e=n.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}var PM=new Ya(oe.REPARENT,null,"","","",0,"",""),MM=function(){function n(e){var t=this;this.runtime=e,this.pendingEvents=[],this.boundsChangedEvent=new nr(oe.BOUNDS_CHANGED),this.rotate=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=_.al(a,o,s));var c=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)t.rotateLocal(i,a);else{var u=Vt();yi(u,a[0],a[1],a[2]);var h=t.getRotation(i),f=t.getRotation(i.parentNode);xi(r,f),da(r,r),An(u,r,u),An(c.localRotation,u,h),Ia(c.localRotation,c.localRotation),l&&t.dirtifyLocal(i,c)}}}(),this.rotateLocal=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=_.al(a,o,s));var c=i.transformable;yi(r,a[0],a[1],a[2]),ss(c.localRotation,c.localRotation,r),l&&t.dirtifyLocal(i,c)}}(),this.setEulerAngles=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=_.al(a,o,s));var c=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)t.setLocalEulerAngles(i,a);else{yi(c.localRotation,a[0],a[1],a[2]);var u=t.getRotation(i.parentNode);xi(r,da(Vt(),u)),ss(c.localRotation,c.localRotation,r),l&&t.dirtifyLocal(i,c)}}}(),this.translateLocal=function(){return function(r,i,a,o,s){a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=!0),typeof i=="number"&&(i=_.al(i,a,o));var l=r.transformable;_.fS(i,_.Ue())||(_.VC(i,i,l.localRotation),_.IH(l.localPosition,l.localPosition,i),s&&t.dirtifyLocal(r,l))}}(),this.setPosition=function(){var r=Q(),i=_.Ue();return function(a,o,s){s===void 0&&(s=!0);var l=a.transformable;if(i[0]=o[0],i[1]=o[1],i[2]=o[2]||0,!_.fS(t.getPosition(a),i)){if(_.JG(l.position,i),a.parentNode===null||!a.parentNode.transformable)_.JG(l.localPosition,i);else{var c=a.parentNode.transformable;kt(r,c.worldTransform),Wt(r,r),_.fF(l.localPosition,i,r)}s&&t.dirtifyLocal(a,l)}}}(),this.setLocalPosition=function(){var r=_.Ue();return function(i,a,o){o===void 0&&(o=!0);var s=i.transformable;r[0]=a[0],r[1]=a[1],r[2]=a[2]||0,!_.fS(s.localPosition,r)&&(_.JG(s.localPosition,r),o&&t.dirtifyLocal(i,s))}}(),this.translate=function(){var r=_.Ue(),i=_.Ue(),a=_.Ue();return function(o,s,l,c,u){l===void 0&&(l=0),c===void 0&&(c=0),u===void 0&&(u=!0),typeof s=="number"&&(s=_.t8(i,s,l,c)),!_.fS(s,r)&&(_.IH(a,t.getPosition(o),s),t.setPosition(o,a,u))}}(),this.setRotation=function(){var r=Vt();return function(i,a,o,s,l,c){c===void 0&&(c=!0);var u=i.transformable;if(typeof a=="number"&&(a=pa(a,o,s,l)),i.parentNode===null||!i.parentNode.transformable)t.setLocalRotation(i,a);else{var h=t.getRotation(i.parentNode);xi(r,h),da(r,r),An(u.localRotation,r,a),Ia(u.localRotation,u.localRotation),c&&t.dirtifyLocal(i,u)}}},this.displayObjectDependencyMap=new WeakMap,this.calcLocalTransform=function(){var r=Q(),i=_.Ue(),a=pa(0,0,0,1);return function(o){var s=o.localSkew[0]!==0||o.localSkew[1]!==0;if(s){if(fr(o.localTransform,o.localRotation,o.localPosition,_.al(1,1,1),o.origin),o.localSkew[0]!==0||o.localSkew[1]!==0){var l=Xt(r);l[4]=Math.tan(o.localSkew[0]),l[1]=Math.tan(o.localSkew[1]),Ut(o.localTransform,o.localTransform,l)}var c=fr(r,a,i,o.localScale,o.origin);Ut(o.localTransform,o.localTransform,c)}else fr(o.localTransform,o.localRotation,o.localPosition,o.localScale,o.origin)}}()}return n.prototype.matches=function(e,t){return this.runtime.sceneGraphSelector.is(e,t)},n.prototype.querySelector=function(e,t){return this.runtime.sceneGraphSelector.selectOne(e,t)},n.prototype.querySelectorAll=function(e,t){return this.runtime.sceneGraphSelector.selectAll(e,t)},n.prototype.attach=function(e,t,r){var i,a=!1;e.parentNode&&(a=e.parentNode!==t,this.detach(e)),e.parentNode=t,pt(r)?e.parentNode.childNodes.push(e):e.parentNode.childNodes.splice(r,0,e);var o=t.sortable;(!((i=o==null?void 0:o.sorted)===null||i===void 0)&&i.length||e.parsedStyle.zIndex)&&(o.dirtyChildren.indexOf(e)===-1&&o.dirtyChildren.push(e),o.dirty=!0,o.dirtyReason=ys.ADDED);var s=e.transformable;s&&this.dirtifyWorld(e,s),s.frozen&&this.unfreezeParentToRoot(e),a&&e.dispatchEvent(PM)},n.prototype.detach=function(e){var t,r;if(e.parentNode){var i=e.transformable,a=e.parentNode.sortable;(!((t=a==null?void 0:a.sorted)===null||t===void 0)&&t.length||!((r=e.style)===null||r===void 0)&&r.zIndex)&&(a.dirtyChildren.indexOf(e)===-1&&a.dirtyChildren.push(e),a.dirty=!0,a.dirtyReason=ys.REMOVED);var o=e.parentNode.childNodes.indexOf(e);o>-1&&e.parentNode.childNodes.splice(o,1),i&&this.dirtifyWorld(e,i),e.parentNode=null}},n.prototype.getOrigin=function(e){return e.getGeometryBounds(),e.transformable.origin},n.prototype.setOrigin=function(e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=0),typeof t=="number"&&(t=[t,r,i]);var a=e.transformable;if(!(t[0]===a.origin[0]&&t[1]===a.origin[1]&&t[2]===a.origin[2])){var o=a.origin;o[0]=t[0],o[1]=t[1],o[2]=t[2]||0,this.dirtifyLocal(e,a)}},n.prototype.setLocalEulerAngles=function(e,t,r,i,a){r===void 0&&(r=0),i===void 0&&(i=0),a===void 0&&(a=!0),typeof t=="number"&&(t=_.al(t,r,i));var o=e.transformable;yi(o.localRotation,t[0],t[1],t[2]),a&&this.dirtifyLocal(e,o)},n.prototype.scaleLocal=function(e,t,r){r===void 0&&(r=!0);var i=e.transformable;_.Jp(i.localScale,i.localScale,_.al(t[0],t[1],t[2]||1)),r&&this.dirtifyLocal(e,i)},n.prototype.setLocalScale=function(e,t,r){r===void 0&&(r=!0);var i=e.transformable,a=_.al(t[0],t[1],t[2]||i.localScale[2]);_.fS(a,i.localScale)||(_.JG(i.localScale,a),r&&this.dirtifyLocal(e,i))},n.prototype.setLocalRotation=function(e,t,r,i,a,o){o===void 0&&(o=!0),typeof t=="number"&&(t=pa(t,r,i,a));var s=e.transformable;xi(s.localRotation,t),o&&this.dirtifyLocal(e,s)},n.prototype.setLocalSkew=function(e,t,r){typeof t=="number"&&(t=va.al(t,r));var i=e.transformable;va.JG(i.localSkew,t),this.dirtifyLocal(e,i)},n.prototype.dirtifyLocal=function(e,t){t.localDirtyFlag||(t.localDirtyFlag=!0,t.dirtyFlag||this.dirtifyWorld(e,t))},n.prototype.dirtifyWorld=function(e,t){t.dirtyFlag||this.unfreezeParentToRoot(e),this.dirtifyWorldInternal(e,t),this.dirtifyToRoot(e,!0)},n.prototype.triggerPendingEvents=function(){var e=this,t=new Set,r=function(i,a){i.isConnected&&!t.has(i.entity)&&(e.boundsChangedEvent.detail=a,e.boundsChangedEvent.target=i,i.isMutationObserved?i.dispatchEvent(e.boundsChangedEvent):i.ownerDocument.defaultView.dispatchEvent(e.boundsChangedEvent,!0),t.add(i.entity))};this.pendingEvents.forEach(function(i){var a=P(i,2),o=a[0],s=a[1];s.affectChildren?o.forEach(function(l){r(l,s)}):r(o,s)}),this.clearPendingEvents(),t.clear()},n.prototype.clearPendingEvents=function(){this.pendingEvents=[]},n.prototype.dirtifyToRoot=function(e,t){t===void 0&&(t=!1);var r=e;for(r.renderable&&(r.renderable.dirty=!0);r;)Py(r),r=r.parentNode;t&&e.forEach(function(i){Py(i)}),this.informDependentDisplayObjects(e),this.pendingEvents.push([e,{affectChildren:t}])},n.prototype.updateDisplayObjectDependency=function(e,t,r,i){if(t&&t!==r){var a=this.displayObjectDependencyMap.get(t);if(a&&a[e]){var o=a[e].indexOf(i);a[e].splice(o,1)}}if(r){var s=this.displayObjectDependencyMap.get(r);s||(this.displayObjectDependencyMap.set(r,{}),s=this.displayObjectDependencyMap.get(r)),s[e]||(s[e]=[]),s[e].push(i)}},n.prototype.informDependentDisplayObjects=function(e){var t=this,r=this.displayObjectDependencyMap.get(e);r&&Object.keys(r).forEach(function(i){r[i].forEach(function(a){t.dirtifyToRoot(a,!0),a.dispatchEvent(new Ya(oe.ATTR_MODIFIED,a,t,t,i,Ya.MODIFICATION,t,t)),a.isCustomElement&&a.isConnected&&a.attributeChangedCallback&&a.attributeChangedCallback(i,t,t)})})},n.prototype.getPosition=function(e){var t=e.transformable;return Qn(t.position,this.getWorldTransform(e,t))},n.prototype.getRotation=function(e){var t=e.transformable;return _n(t.rotation,this.getWorldTransform(e,t))},n.prototype.getScale=function(e){var t=e.transformable;return He(t.scaling,this.getWorldTransform(e,t))},n.prototype.getWorldTransform=function(e,t){return t===void 0&&(t=e.transformable),!t.localDirtyFlag&&!t.dirtyFlag||(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.sync(e,t)),t.worldTransform},n.prototype.getLocalPosition=function(e){return e.transformable.localPosition},n.prototype.getLocalRotation=function(e){return e.transformable.localRotation},n.prototype.getLocalScale=function(e){return e.transformable.localScale},n.prototype.getLocalSkew=function(e){return e.transformable.localSkew},n.prototype.getLocalTransform=function(e){var t=e.transformable;return t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.localTransform},n.prototype.setLocalTransform=function(e,t){var r=Qn(_.Ue(),t),i=_n(Vt(),t),a=He(_.Ue(),t);this.setLocalScale(e,a,!1),this.setLocalPosition(e,r,!1),this.setLocalRotation(e,i,void 0,void 0,void 0,!1),this.dirtifyLocal(e,e.transformable)},n.prototype.resetLocalTransform=function(e){this.setLocalScale(e,[1,1,1]),this.setLocalPosition(e,[0,0,0]),this.setLocalEulerAngles(e,[0,0,0]),this.setLocalSkew(e,[0,0])},n.prototype.getTransformedGeometryBounds=function(e,t,r){t===void 0&&(t=!1);var i=this.getGeometryBounds(e,t);if(Fe.isEmpty(i))return null;var a=r||new Fe;return a.setFromTransformedAABB(i,this.getWorldTransform(e)),a},n.prototype.getGeometryBounds=function(e,t){t===void 0&&(t=!1);var r=e.geometry;r.dirty&&nt.styleValueRegistry.updateGeometry(e);var i=t?r.renderBounds:r.contentBounds||null;return i||new Fe},n.prototype.getBounds=function(e,t){var r=this;t===void 0&&(t=!1);var i=e.renderable;if(!i.boundsDirty&&!t&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&t&&i.renderBounds)return i.renderBounds;var a=t?i.renderBounds:i.bounds,o=this.getTransformedGeometryBounds(e,t,a),s=e.childNodes;if(s.forEach(function(u){var h=r.getBounds(u,t);h&&(o?o.add(h):(o=a||new Fe,o.update(h.center,h.halfExtents)))}),o||(o=new Fe),t){var l=vy(e);if(l){var c=l.parsedStyle.clipPath.getBounds(t);o?c&&(o=c.intersection(o)):o.update(c.center,c.halfExtents)}}return t?(i.renderBounds=o,i.renderBoundsDirty=!1):(i.bounds=o,i.boundsDirty=!1),o},n.prototype.getLocalBounds=function(e){if(e.parentNode){var t=Q();e.parentNode.transformable&&(t=Wt(Q(),this.getWorldTransform(e.parentNode)));var r=this.getBounds(e);if(!Fe.isEmpty(r)){var i=new Fe;return i.setFromTransformedAABB(r,t),i}}return this.getBounds(e)},n.prototype.getBoundingClientRect=function(e){var t,r,i,a=this.getGeometryBounds(e);Fe.isEmpty(a)||(i=new Fe,i.setFromTransformedAABB(a,this.getWorldTransform(e)));var o=(r=(t=e.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect();if(i){var s=P(i.getMin(),2),l=s[0],c=s[1],u=P(i.getMax(),2),h=u[0],f=u[1];return new Ua(l+((o==null?void 0:o.left)||0),c+((o==null?void 0:o.top)||0),h-l,f-c)}return new Ua((o==null?void 0:o.left)||0,(o==null?void 0:o.top)||0,0,0)},n.prototype.dirtifyWorldInternal=function(e,t){var r=this;if(!t.dirtyFlag){t.dirtyFlag=!0,t.frozen=!1,e.childNodes.forEach(function(a){var o=a.transformable;o.dirtyFlag||r.dirtifyWorldInternal(a,o)});var i=e.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0)}},n.prototype.syncHierarchy=function(e){var t=e.transformable;if(!t.frozen){t.frozen=!0,(t.localDirtyFlag||t.dirtyFlag)&&this.sync(e,t);for(var r=e.childNodes,i=0;i<r.length;i++)this.syncHierarchy(r[i])}},n.prototype.sync=function(e,t){if(t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.dirtyFlag){var r=e.parentNode,i=r&&r.transformable;r===null||!i?kt(t.worldTransform,t.localTransform):Ut(t.worldTransform,i.worldTransform,t.localTransform),t.dirtyFlag=!1}},n.prototype.unfreezeParentToRoot=function(e){for(var t=e.parentNode;t;){var r=t.transformable;r&&(r.frozen=!1),t=t.parentNode}},n}(),Do={MetricsString:"|\xC9q\xC5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},My=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,CM=/[!%),.:;?\]}'""]/,OM=/[$('"]/,AM=/[!),.:;?\]}'""]/,NM=/[([{'"]/,RM=/[)\]'"?!:;,.]/,kM=/[(['"...]/,LM=/[!%),.:;?\]}'"]/,IM=/[$([{'"#]/,DM=new RegExp("".concat(CM.source,"|").concat(AM.source,"|").concat(RM.source,"|").concat(LM.source)),BM=new RegExp("".concat(OM.source,"|").concat(NM.source,"|").concat(kM.source,"|").concat(IM.source)),FM=function(){function n(e){var t=this;this.runtime=e,this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(r,i){return t.isBreakingSpace(i)?!1:!!(r&&(BM.exec(i)||DM.exec(r)))},this.trimByKinsokuShorui=function(r){var i=K([],P(r),!1),a=i[i.length-2];if(!a)return r;var o=a[a.length-1];return i[i.length-2]=a.slice(0,-1),i[i.length-1]=o+i[i.length-1],i}}return n.prototype.measureFont=function(e,t){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var r={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(t),a=this.runtime.offscreenCanvasCreator.getOrCreateContext(t,{willReadFrequently:!0});a.font=e;var o=Do.MetricsString+Do.BaselineSymbol,s=Math.ceil(a.measureText(o).width),l=Math.ceil(a.measureText(Do.BaselineSymbol).width),c=Do.HeightMultiplier*l;l=l*Do.BaselineMultiplier|0,i.width=s,i.height=c,a.fillStyle="#f00",a.fillRect(0,0,s,c),a.font=e,a.textBaseline="alphabetic",a.fillStyle="#000",a.fillText(o,0,l);var u=a.getImageData(0,0,s||1,c||1).data,h=u.length,f=s*4,d=0,p=0,v=!1;for(d=0;d<l;++d){for(var g=0;g<f;g+=4)if(u[p+g]!==255){v=!0;break}if(!v)p+=f;else break}for(r.ascent=l-d,p=h-f,v=!1,d=c;d>l;--d){for(var g=0;g<f;g+=4)if(u[p+g]!==255){v=!0;break}if(!v)p-=f;else break}return r.descent=d-l,r.fontSize=r.ascent+r.descent,this.fontMetricsCache[e]=r,r},n.prototype.measureText=function(e,t,r){var i=t.fontSize,a=i===void 0?16:i,o=t.wordWrap,s=o===void 0?!1:o,l=t.lineHeight,c=t.lineWidth,u=c===void 0?1:c,h=t.textBaseline,f=h===void 0?"alphabetic":h,d=t.textAlign,p=d===void 0?"start":d,v=t.letterSpacing,g=v===void 0?0:v,m=t.textPath;t.textPathSide,t.textPathStartOffset;var x=t.leading,S=x===void 0?0:x,T=oM(t),b=this.measureFont(T,r);b.fontSize===0&&(b.fontSize=a,b.ascent=a);var y=this.runtime.offscreenCanvasCreator.getOrCreateContext(r);y.font=T,t.isOverflowing=!1;var E=s?this.wordWrap(e,t,r):e,w=E.split(/(?:\r\n|\r|\n)/),C=new Array(w.length),M=0;if(m){m.getTotalLength();for(var O=0;O<w.length;O++)var A=y.measureText(w[O]).width+(w[O].length-1)*g}else{for(var O=0;O<w.length;O++){var R=y.measureText(w[O]).width+(w[O].length-1)*g;C[O]=R,M=Math.max(M,R)}var A=M+u,L=l||b.fontSize+u,z=Math.max(L,b.fontSize+u)+(w.length-1)*(L+S);L+=S;var Y=0;return f==="middle"?Y=-z/2:f==="bottom"||f==="alphabetic"||f==="ideographic"?Y=-z:(f==="top"||f==="hanging")&&(Y=0),{font:T,width:A,height:z,lines:w,lineWidths:C,lineHeight:L,maxLineWidth:M,fontProperties:b,lineMetrics:C.map(function(q,J){var wt=0;return p==="center"||p==="middle"?wt-=q/2:(p==="right"||p==="end")&&(wt-=q),new Ua(wt-u/2,Y+J*L,q+u,L)})}}},n.prototype.setGraphemeOnPath=function(){},n.prototype.wordWrap=function(e,t,r){var i=this,a=t.wordWrapWidth,o=a===void 0?0:a,s=t.letterSpacing,l=s===void 0?0:s,c=t.maxLines,u=c===void 0?1/0:c,h=t.textOverflow,f=this.runtime.offscreenCanvasCreator.getOrCreateContext(r),d=o+l,p="";h==="ellipsis"?p="...":h&&h!=="clip"&&(p=h);for(var v=[],g=0,m=0,x={},S=function(Y){return i.getFromCache(Y,l,x,f)},T=Array.from(p).reduce(function(Y,I){return Y+S(I)},0),b=Array.from(e),y=0;y<b.length;y++){var E=b[y],w=e[y-1],C=e[y+1],M=S(E);if(this.isNewline(E)){if(g++,g>=u){t.isOverflowing=!0;break}m=0,v[g]="";continue}if(m>0&&m+M>d){if(g+1>=u){if(t.isOverflowing=!0,T>0&&T<=d){for(var O=v[g].length,A=0,R=O,L=0;L<O;L++){var z=S(v[g][L]);if(A+z+T>d){R=L;break}A+=z}v[g]=(v[g]||"").slice(0,R)+p}break}if(g++,m=0,v[g]="",this.isBreakingSpace(E))continue;this.canBreakInLastChar(E)||(v=this.trimToBreakable(v),m=this.sumTextWidthByCache(v[g]||"",x)),this.shouldBreakByKinsokuShorui(E,C)&&(v=this.trimByKinsokuShorui(v),m+=S(w||""))}m+=M,v[g]=(v[g]||"")+E}return v.join(`
`)},n.prototype.isBreakingSpace=function(e){return typeof e!="string"?!1:Do.BreakingSpaces.indexOf(e.charCodeAt(0))>=0},n.prototype.isNewline=function(e){return typeof e!="string"?!1:Do.Newlines.indexOf(e.charCodeAt(0))>=0},n.prototype.trimToBreakable=function(e){var t=K([],P(e),!1),r=t[t.length-2],i=this.findBreakableIndex(r);if(i===-1||!r)return t;var a=r.slice(i,i+1),o=this.isBreakingSpace(a),s=i+1,l=i+(o?0:1);return t[t.length-1]+=r.slice(s,r.length),t[t.length-2]=r.slice(0,l),t},n.prototype.canBreakInLastChar=function(e){return!(e&&My.test(e))},n.prototype.sumTextWidthByCache=function(e,t){return e.split("").reduce(function(r,i){if(!t[i])throw Error("cannot count the word without cache");return r+t[i]},0)},n.prototype.findBreakableIndex=function(e){for(var t=e.length-1;t>=0;t--)if(!My.test(e[t]))return t;return-1},n.prototype.getFromCache=function(e,t,r,i){var a=r[e];if(typeof a!="number"){var o=e.length*t;a=i.measureText(e).width+o,r[e]=a}return a},n}(),nt={},GM=function(){var n,e=new gM,t=new vM;return n={},n[ct.CIRCLE]=new hM,n[ct.ELLIPSE]=new fM,n[ct.RECT]=e,n[ct.IMAGE]=e,n[ct.GROUP]=new yM,n[ct.LINE]=new dM,n[ct.TEXT]=new mM(nt),n[ct.POLYLINE]=t,n[ct.POLYGON]=t,n[ct.PATH]=new pM,n[ct.HTML]=null,n[ct.MESH]=null,n}(),zM=function(){var n,e=new TP,t=new Vd;return n={},n[St.PERCENTAGE]=null,n[St.NUMBER]=new AP,n[St.ANGLE]=new SP,n[St.DEFINED_PATH]=new _P,n[St.PAINT]=e,n[St.COLOR]=e,n[St.FILTER]=new PP,n[St.LENGTH]=t,n[St.LENGTH_PERCENTAGE]=t,n[St.LENGTH_PERCENTAGE_12]=new MP,n[St.LENGTH_PERCENTAGE_14]=new CP,n[St.COORDINATE]=new Vd,n[St.OFFSET_DISTANCE]=new NP,n[St.OPACITY_VALUE]=new RP,n[St.PATH]=new kP,n[St.LIST_OF_POINTS]=new LP,n[St.SHADOW_BLUR]=new IP,n[St.TEXT]=new DP,n[St.TEXT_TRANSFORM]=new BP,n[St.TRANSFORM]=new lM,n[St.TRANSFORM_ORIGIN]=new cM,n[St.Z_INDEX]=new uM,n[St.MARKER]=new OP,n}(),WM=function(){return typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:{}};nt.CameraContribution=zm,nt.AnimationTimeline=null,nt.EasingFunction=null,nt.offscreenCanvasCreator=new wM,nt.sceneGraphSelector=new TM,nt.sceneGraphService=new MM(nt),nt.textService=new FM(nt),nt.geometryUpdaterFactory=GM,nt.CSSPropertySyntaxFactory=zM,nt.styleValueRegistry=new wP(nt),nt.layoutRegistry=null,nt.globalThis=WM(),nt.enableCSSParsing=!1,nt.enableDataset=!1,nt.enableStyleSyntax=!0,nt.enableAttributeDashCased=!1,nt.enableSizeAttenuation=!1;var Cy=0;function Bz(){Cy=0}var Oy=new Ya(oe.INSERTED,null,"","","",0,"",""),Ay=new Ya(oe.REMOVED,null,"","","",0,"",""),UM=new nr(oe.DESTROY),VM=function(n){B(e,n);function e(){var t=n.call(this)||this;return t.entity=Cy++,t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.cullable={strategy:Ad.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle=nt.enableCSSParsing?{opacity:je,fillOpacity:je,strokeOpacity:je,fill:je,stroke:je,transform:je,transformOrigin:je,visibility:je,pointerEvents:je,lineWidth:je,lineCap:je,lineJoin:je,increasedLineWidthForHitTesting:je,fontSize:je,fontFamily:je,fontStyle:je,fontWeight:je,fontVariant:je,textAlign:je,textBaseline:je,textTransform:je,zIndex:je,filter:je,shadowType:je}:null,t.parsedStyle={},t.attributes={},t}return Object.defineProperty(e.prototype,"className",{get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"classList",{get:function(){return this.className.split(" ").filter(function(t){return t!==""})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagName",{get:function(){return this.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(t){throw new Error(Ne)},e.prototype.appendChild=function(t,r){var i;if(t.destroyed)throw new Error(gT);return nt.sceneGraphService.attach(t,this,r),!((i=this.ownerDocument)===null||i===void 0)&&i.defaultView&&this.ownerDocument.defaultView.mountChildren(t),this.isMutationObserved&&(Oy.relatedNode=this,t.dispatchEvent(Oy)),t},e.prototype.insertBefore=function(t,r){if(!r)this.appendChild(t);else{t.parentElement&&t.parentElement.removeChild(t);var i=this.childNodes.indexOf(r);i===-1?this.appendChild(t):this.appendChild(t,i)}return t},e.prototype.replaceChild=function(t,r){var i=this.childNodes.indexOf(r);return this.removeChild(r),this.appendChild(t,i),r},e.prototype.removeChild=function(t){var r;return Ay.relatedNode=this,t.dispatchEvent(Ay),!((r=t.ownerDocument)===null||r===void 0)&&r.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),nt.sceneGraphService.detach(t),t},e.prototype.removeChildren=function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];this.removeChild(r)}},e.prototype.destroyChildren=function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];r.childNodes.length&&r.destroyChildren(),r.destroy()}},e.prototype.matches=function(t){return nt.sceneGraphService.matches(t,this)},e.prototype.getElementById=function(t){return nt.sceneGraphService.querySelector("#".concat(t),this)},e.prototype.getElementsByName=function(t){return nt.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)},e.prototype.getElementsByClassName=function(t){return nt.sceneGraphService.querySelectorAll(".".concat(t),this)},e.prototype.getElementsByTagName=function(t){return nt.sceneGraphService.querySelectorAll(t,this)},e.prototype.querySelector=function(t){return nt.sceneGraphService.querySelector(t,this)},e.prototype.querySelectorAll=function(t){return nt.sceneGraphService.querySelectorAll(t,this)},e.prototype.closest=function(t){var r=this;do{if(nt.sceneGraphService.matches(t,r))return r;r=r.parentElement}while(r!==null);return null},e.prototype.find=function(t){var r=this,i=null;return this.forEach(function(a){return a!==r&&t(a)?(i=a,!0):!1}),i},e.prototype.findAll=function(t){var r=this,i=[];return this.forEach(function(a){a!==r&&t(a)&&i.push(a)}),i},e.prototype.after=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this);r.forEach(function(o,s){var l;return(l=t.parentNode)===null||l===void 0?void 0:l.appendChild(o,a+s+1)})}},e.prototype.before=function(){for(var t,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this),o=P(r),s=o[0],l=o.slice(1);this.parentNode.appendChild(s,a),(t=s).after.apply(t,K([],P(l),!1))}},e.prototype.replaceWith=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.after.apply(this,K([],P(t),!1)),this.remove()},e.prototype.append=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(a){return t.appendChild(a)})},e.prototype.prepend=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(a,o){return t.appendChild(a,o)})},e.prototype.replaceChildren=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,K([],P(t),!1))},e.prototype.remove=function(){return this.parentNode?this.parentNode.removeChild(this):this},e.prototype.destroy=function(){this.dispatchEvent(UM),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0},e.prototype.getGeometryBounds=function(){return nt.sceneGraphService.getGeometryBounds(this)},e.prototype.getRenderBounds=function(){return nt.sceneGraphService.getBounds(this,!0)},e.prototype.getBounds=function(){return nt.sceneGraphService.getBounds(this)},e.prototype.getLocalBounds=function(){return nt.sceneGraphService.getLocalBounds(this)},e.prototype.getBoundingClientRect=function(){return nt.sceneGraphService.getBoundingClientRect(this)},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},e.prototype.getAttributeNames=function(){return Object.keys(this.attributes)},e.prototype.getAttribute=function(t){if(TT(t))return nt.enableCSSParsing?null:void 0;var r=this.attributes[t];if(r===void 0){if(nt.enableAttributeDashCased){var i=Td(t);r=this.attributes[i]}return nt.enableCSSParsing&&pt(r)?null:r}else return r},e.prototype.hasAttribute=function(t){return this.getAttributeNames().includes(t)},e.prototype.hasAttributes=function(){return!!this.getAttributeNames().length},e.prototype.removeAttribute=function(t){this.setAttribute(t,null),delete this.attributes[t]},e.prototype.setAttribute=function(t,r,i,a){this.attributes[t]=r},e.prototype.getAttributeNS=function(t,r){throw new Error(Ne)},e.prototype.getAttributeNode=function(t){throw new Error(Ne)},e.prototype.getAttributeNodeNS=function(t,r){throw new Error(Ne)},e.prototype.hasAttributeNS=function(t,r){throw new Error(Ne)},e.prototype.removeAttributeNS=function(t,r){throw new Error(Ne)},e.prototype.removeAttributeNode=function(t){throw new Error(Ne)},e.prototype.setAttributeNS=function(t,r,i){throw new Error(Ne)},e.prototype.setAttributeNode=function(t){throw new Error(Ne)},e.prototype.setAttributeNodeNS=function(t){throw new Error(Ne)},e.prototype.toggleAttribute=function(t,r){throw new Error(Ne)},e}(Dn);function me(n){return!!(n!=null&&n.nodeName)}var Ny=nt.globalThis.Proxy?nt.globalThis.Proxy:function(){},ma=new Ya(oe.ATTR_MODIFIED,null,null,null,null,Ya.MODIFICATION,null,null),HM={opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",zIndex:"",filter:"",shadowType:""},YM={fill:$c,stroke:$c,transform:[],zIndex:0,filter:[],shadowType:"outer",miterLimit:10},XM=["opacity","fillOpacity","strokeOpacity","transformOrigin","visibility","pointerEvents","lineWidth","lineCap","lineJoin","increasedLineWidthForHitTesting"],jM=K(K([],P(XM),!1),["fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform"],!1),Ry="data-",ei=function(n){B(e,n);function e(t){var r=n.call(this)||this;return r.isCustomElement=!1,r.isMutationObserved=!1,r.activeAnimations=[],r.config=t,r.id=r.config.id||"",r.name=r.config.name||"",(r.config.className||r.config.class)&&(r.className=r.config.className||r.config.class),r.nodeName=r.config.type||ct.GROUP,nt.enableCSSParsing?(Object.assign(r.attributes,HM),Object.assign(r.parsedStyle,YM,r.config.initialParsedStyle)):r.config.initialParsedStyle&&Object.assign(r.parsedStyle,r.config.initialParsedStyle),r.initAttributes(r.config.style),nt.enableDataset&&(r.dataset=new Ny({},{get:function(i,a){var o="".concat(Ry).concat(Vm(a));return i[o]!==void 0?i[o]:r.getAttribute(o)},set:function(i,a,o){return r.setAttribute("".concat(Ry).concat(Vm(a)),o),!0}})),nt.enableStyleSyntax&&(r.style=new Ny({setProperty:function(i,a){r.setAttribute(i,a)},getPropertyValue:function(i){return r.getAttribute(i)},removeProperty:function(i){r.removeAttribute(i)},item:function(){return""}},{get:function(i,a){return i[a]!==void 0?i[a]:r.getAttribute(a)},set:function(i,a,o){return r.setAttribute(a,o),!0}})),r}return e.prototype.destroy=function(){n.prototype.destroy.call(this),this.getAnimations().forEach(function(t){t.cancel()})},e.prototype.cloneNode=function(t,r){var i=N({},this.attributes);for(var a in i){var o=i[a];me(o)&&a!=="clipPath"&&a!=="offsetPath"&&a!=="textPath"&&(i[a]=o.cloneNode(t)),r&&(i[a]=r(a,o))}var s=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:i});return s.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(l){if(!l.style.isMarker){var c=l.cloneNode(t);s.appendChild(c)}}),s},e.prototype.initAttributes=function(t){t===void 0&&(t={});var r=this.renderable,i={forceUpdateGeometry:!0};nt.enableCSSParsing&&(i.usedAttributes=jM);var a=t;if(nt.enableAttributeDashCased){a={};for(var o in t){var s=Td(o);a[s]=t[o]}}nt.styleValueRegistry.processProperties(this,a,i),r.dirty=!0},e.prototype.setAttribute=function(t,r,i,a){i===void 0&&(i=!1),a===void 0&&(a=!0),nt.enableAttributeDashCased&&(t=Td(t)),!yt(r)&&(i||r!==this.attributes[t])&&(this.internalSetAttribute(t,r,{memoize:a}),n.prototype.setAttribute.call(this,t,r))},e.prototype.internalSetAttribute=function(t,r,i){var a;i===void 0&&(i={});var o=this.renderable,s=this.attributes[t],l=this.parsedStyle[t];nt.styleValueRegistry.processProperties(this,(a={},a[t]=r,a),i),o.dirty=!0;var c=this.parsedStyle[t];this.isConnected&&(ma.relatedNode=this,ma.prevValue=s,ma.newValue=r,ma.attrName=t,ma.prevParsedValue=l,ma.newParsedValue=c,this.isMutationObserved?this.dispatchEvent(ma):(ma.target=this,this.ownerDocument.defaultView.dispatchEvent(ma,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&this.attributeChangedCallback&&this.attributeChangedCallback(t,s,r,l,c)},e.prototype.getBBox=function(){var t=this.getBounds(),r=P(t.getMin(),2),i=r[0],a=r[1],o=P(t.getMax(),2),s=o[0],l=o[1];return new Ua(i,a,s-i,l-a)},e.prototype.setOrigin=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),nt.sceneGraphService.setOrigin(this,pr(t,r,i)),this},e.prototype.getOrigin=function(){return nt.sceneGraphService.getOrigin(this)},e.prototype.setPosition=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),nt.sceneGraphService.setPosition(this,pr(t,r,i)),this},e.prototype.setLocalPosition=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),nt.sceneGraphService.setLocalPosition(this,pr(t,r,i)),this},e.prototype.translate=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),nt.sceneGraphService.translate(this,pr(t,r,i)),this},e.prototype.translateLocal=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),nt.sceneGraphService.translateLocal(this,pr(t,r,i)),this},e.prototype.getPosition=function(){return nt.sceneGraphService.getPosition(this)},e.prototype.getLocalPosition=function(){return nt.sceneGraphService.getLocalPosition(this)},e.prototype.scale=function(t,r,i){return this.scaleLocal(t,r,i)},e.prototype.scaleLocal=function(t,r,i){return typeof t=="number"&&(r=r||t,i=i||t,t=pr(t,r,i)),nt.sceneGraphService.scaleLocal(this,t),this},e.prototype.setLocalScale=function(t,r,i){return typeof t=="number"&&(r=r||t,i=i||t,t=pr(t,r,i)),nt.sceneGraphService.setLocalScale(this,t),this},e.prototype.getLocalScale=function(){return nt.sceneGraphService.getLocalScale(this)},e.prototype.getScale=function(){return nt.sceneGraphService.getScale(this)},e.prototype.getEulerAngles=function(){var t=P(bd(_.Ue(),nt.sceneGraphService.getWorldTransform(this)),3),r=t[2];return bi(r)},e.prototype.getLocalEulerAngles=function(){var t=P(bd(_.Ue(),nt.sceneGraphService.getLocalRotation(this)),3),r=t[2];return bi(r)},e.prototype.setEulerAngles=function(t){return nt.sceneGraphService.setEulerAngles(this,0,0,t),this},e.prototype.setLocalEulerAngles=function(t){return nt.sceneGraphService.setLocalEulerAngles(this,0,0,t),this},e.prototype.rotateLocal=function(t,r,i){return pt(r)&&pt(i)?nt.sceneGraphService.rotateLocal(this,0,0,t):nt.sceneGraphService.rotateLocal(this,t,r,i),this},e.prototype.rotate=function(t,r,i){return pt(r)&&pt(i)?nt.sceneGraphService.rotate(this,0,0,t):nt.sceneGraphService.rotate(this,t,r,i),this},e.prototype.setRotation=function(t,r,i,a){return nt.sceneGraphService.setRotation(this,t,r,i,a),this},e.prototype.setLocalRotation=function(t,r,i,a){return nt.sceneGraphService.setLocalRotation(this,t,r,i,a),this},e.prototype.setLocalSkew=function(t,r){return nt.sceneGraphService.setLocalSkew(this,t,r),this},e.prototype.getRotation=function(){return nt.sceneGraphService.getRotation(this)},e.prototype.getLocalRotation=function(){return nt.sceneGraphService.getLocalRotation(this)},e.prototype.getLocalSkew=function(){return nt.sceneGraphService.getLocalSkew(this)},e.prototype.getLocalTransform=function(){return nt.sceneGraphService.getLocalTransform(this)},e.prototype.getWorldTransform=function(){return nt.sceneGraphService.getWorldTransform(this)},e.prototype.setLocalTransform=function(t){return nt.sceneGraphService.setLocalTransform(this,t),this},e.prototype.resetLocalTransform=function(){nt.sceneGraphService.resetLocalTransform(this)},e.prototype.getAnimations=function(){return this.activeAnimations},e.prototype.animate=function(t,r){var i,a=(i=this.ownerDocument)===null||i===void 0?void 0:i.timeline;return a?a.play(this,t,r):null},e.prototype.isVisible=function(){var t,r;return nt.enableCSSParsing?((t=this.parsedStyle)===null||t===void 0?void 0:t.visibility)==="visible":((r=this.parsedStyle)===null||r===void 0?void 0:r.visibility)!=="hidden"},Object.defineProperty(e.prototype,"interactive",{get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"},enumerable:!1,configurable:!0}),e.prototype.isInteractive=function(){var t;return((t=this.parsedStyle)===null||t===void 0?void 0:t.pointerEvents)!=="none"},e.prototype.isCulled=function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)},e.prototype.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,K([],P(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})),!1))+1),this},e.prototype.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,K([],P(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})),!1))-1),this},e.prototype.getConfig=function(){return this.config},e.prototype.attr=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=P(r,2),o=a[0],s=a[1];return o?Ye(o)?(Object.keys(o).forEach(function(l){t.setAttribute(l,o[l])}),this):r.length===2?(this.setAttribute(o,s),this):this.attributes[o]:this.attributes},e.prototype.getMatrix=function(t){var r=t||this.getWorldTransform(),i=P(Qn(_.Ue(),r),2),a=i[0],o=i[1],s=P(He(_.Ue(),r),2),l=s[0],c=s[1],u=_n(Vt(),r),h=P(bd(_.Ue(),u),3),f=h[0],d=h[2];return cT(f||d,a,o,l,c)},e.prototype.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},e.prototype.setMatrix=function(t){var r=P(Dm(t),5),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];this.setEulerAngles(l).setPosition(i,a).setLocalScale(o,s)},e.prototype.setLocalMatrix=function(t){var r=P(Dm(t),5),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];this.setLocalEulerAngles(l).setLocalPosition(i,a).setLocalScale(o,s)},e.prototype.show=function(){nt.enableCSSParsing?this.style.visibility="visible":this.forEach(function(t){t.style.visibility="visible"})},e.prototype.hide=function(){nt.enableCSSParsing?this.style.visibility="hidden":this.forEach(function(t){t.style.visibility="hidden"})},e.prototype.getCount=function(){return this.childElementCount},e.prototype.getParent=function(){return this.parentElement},e.prototype.getChildren=function(){return this.children},e.prototype.getFirst=function(){return this.firstElementChild},e.prototype.getLast=function(){return this.lastElementChild},e.prototype.getChildByIndex=function(t){return this.children[t]||null},e.prototype.add=function(t,r){return this.appendChild(t,r)},e.prototype.set=function(t,r){this.config[t]=r},e.prototype.get=function(t){return this.config[t]},e.prototype.moveTo=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(t,r,i),this},e.prototype.move=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(t,r,i),this},e.prototype.setZIndex=function(t){return this.style.zIndex=t,this},e}(VM),Cl=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:ct.CIRCLE},t))||this}return e}(ei),$M=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);return r=n.call(this,N({style:nt.enableCSSParsing?N({},i):N({},i)},a))||this,r.isCustomElement=!0,r}return e}(ei),Zd=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:ct.ELLIPSE},t))||this}return e}(ei),Ol=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:ct.GROUP},t))||this}return e}(ei),qd=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);return r=n.call(this,N({type:ct.HTML,style:nt.enableCSSParsing?N({x:"",y:"",width:"auto",height:"auto",innerHTML:""},i):N({},i)},a))||this,r.cullable.enable=!1,r}return e.prototype.getDomElement=function(){return this.parsedStyle.$el},e.prototype.getBoundingClientRect=function(){if(this.parsedStyle.$el){var t=this.ownerDocument.defaultView.getCamera().getOrthoMatrix(),r=this.parsedStyle.$el.getBoundingClientRect();return Ua.applyTransform(r,Wt(Q(),t))}else{var i=this.parsedStyle,a=i.x,o=i.y,s=i.width,l=i.height;return new Ua(a,o,s,l)}},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.getBounds=function(){var t,r,i=this.getBoundingClientRect(),a=(r=(t=this.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect(),o=new Fe,s=i.left-((a==null?void 0:a.left)||0),l=i.top-((a==null?void 0:a.top)||0);return o.setMinMax([s,l,0],[s+i.width,l+i.height,0]),o},e.prototype.getLocalBounds=function(){if(this.parentNode){var t=Wt(Q(),this.parentNode.getWorldTransform()),r=this.getBounds();if(!Fe.isEmpty(r)){var i=new Fe;return i.setFromTransformedAABB(r,t),i}}return this.getBounds()},e}(ei),Jd=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:ct.IMAGE},t))||this}return e}(ei),nu=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);r=n.call(this,N({type:ct.LINE,style:N({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},a))||this,r.markerStartAngle=0,r.markerEndAngle=0;var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd;return s&&me(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),l&&me(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="x1"||t==="y1"||t==="x2"||t==="y2"||t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&me(a)&&(this.markerStartAngle=0,a.remove()),o&&me(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"&&(a&&me(a)&&(this.markerEndAngle=0,a.remove()),o&&me(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1)))},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=r.x1,c=r.x2,u=r.y1,h=r.y2,f=t?i:a;if(!(!f||!me(f))){var d=0,p,v,g,m,x,S;t?(g=l,m=u,p=c-l,v=h-u,x=o||0,S=this.markerStartAngle):(g=c,m=h,p=l-c,v=u-h,x=s||0,S=this.markerEndAngle),d=Math.atan2(v,p),f.setLocalEulerAngles(d*180/Math.PI+S),f.setLocalPosition(g+Math.cos(d)*x,m+Math.sin(d)*x)}},e.prototype.getPoint=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle,a=i.x1,o=i.y1,s=i.x2,l=i.y2,c=Cr(a,o,s,l,t),u=c.x,h=c.y,f=_.fF(_.Ue(),_.al(u,h,0),r?this.getWorldTransform():this.getLocalTransform());return new Wn(f[0],f[1])},e.prototype.getPointAtLength=function(t,r){return r===void 0&&(r=!1),this.getPoint(t/this.getTotalLength(),r)},e.prototype.getTotalLength=function(){var t=this.parsedStyle,r=t.x1,i=t.y1,a=t.x2,o=t.y2;return fs(r,i,a,o)},e}(ei),Xa=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);r=n.call(this,N({type:ct.PATH,style:nt.enableCSSParsing?N({d:"",miterLimit:""},i):N({},i),initialParsedStyle:nt.enableCSSParsing?null:{miterLimit:4,d:N({},Ym)}},a))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd,c=o.markerMid;return s&&me(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),c&&me(c)&&r.placeMarkerMid(c),l&&me(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&me(a)&&(this.markerStartAngle=0,a.remove()),o&&me(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"?(a&&me(a)&&(this.markerEndAngle=0,a.remove()),o&&me(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(o)},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=t?i:a;if(!(!l||!me(l))){var c=0,u,h,f,d,p,v;if(t){var g=P(this.getStartTangent(),2),m=g[0],x=g[1];f=x[0],d=x[1],u=m[0]-x[0],h=m[1]-x[1],p=o||0,v=this.markerStartAngle}else{var S=P(this.getEndTangent(),2),m=S[0],x=S[1];f=x[0],d=x[1],u=m[0]-x[0],h=m[1]-x[1],p=s||0,v=this.markerEndAngle}c=Math.atan2(h,u),l.setLocalEulerAngles(c*180/Math.PI+v),l.setLocalPosition(f+Math.cos(c)*p,d+Math.sin(c)*p)}},e.prototype.placeMarkerMid=function(t){var r=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(c){c.remove()}),t&&me(t))for(var i=1;i<r.length-1;i++){var a=P(r[i].currentPoint,2),o=a[0],s=a[1],l=i===1?t:t.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(o,s)}},e.prototype.getTotalLength=function(){return Id(this)},e.prototype.getPointAtLength=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle.d.absolutePath,a=sd(i,t),o=a.x,s=a.y,l=_.fF(_.Ue(),_.al(o,s,0),r?this.getWorldTransform():this.getLocalTransform());return new Wn(l[0],l[1])},e.prototype.getPoint=function(t,r){return r===void 0&&(r=!1),this.getPointAtLength(t*Id(this),r)},e.prototype.getStartTangent=function(){var t=this.parsedStyle.d.segments,r=[];if(t.length>1){var i=t[0].currentPoint,a=t[1].currentPoint,o=t[1].startTangent;r=[],o?(r.push([i[0]-o[0],i[1]-o[1]]),r.push([i[0],i[1]])):(r.push([a[0],a[1]]),r.push([i[0],i[1]]))}return r},e.prototype.getEndTangent=function(){var t=this.parsedStyle.d.segments,r=t.length,i=[];if(r>1){var a=t[r-2].currentPoint,o=t[r-1].currentPoint,s=t[r-1].endTangent;i=[],s?(i.push([o[0]-s[0],o[1]-s[1]]),i.push([o[0],o[1]])):(i.push([a[0],a[1]]),i.push([o[0],o[1]]))}return i},e}(ei),ru=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);r=n.call(this,N({type:ct.POLYGON,style:nt.enableCSSParsing?N({points:"",miterLimit:"",isClosed:!0},i):N({},i),initialParsedStyle:nt.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},a))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd,c=o.markerMid;return s&&me(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),c&&me(c)&&r.placeMarkerMid(c),l&&me(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&me(a)&&(this.markerStartAngle=0,a.remove()),o&&me(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"?(a&&me(a)&&(this.markerEndAngle=0,a.remove()),o&&me(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(o)},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=r.points,c=(l||{}).points,u=t?i:a;if(!(!u||!me(u)||!c)){var h=0,f,d,p,v,g,m;if(p=c[0][0],v=c[0][1],t)f=c[1][0]-c[0][0],d=c[1][1]-c[0][1],g=o||0,m=this.markerStartAngle;else{var x=c.length;this.parsedStyle.isClosed?(f=c[x-1][0]-c[0][0],d=c[x-1][1]-c[0][1]):(p=c[x-1][0],v=c[x-1][1],f=c[x-2][0]-c[x-1][0],d=c[x-2][1]-c[x-1][1]),g=s||0,m=this.markerEndAngle}h=Math.atan2(d,f),u.setLocalEulerAngles(h*180/Math.PI+m),u.setLocalPosition(p+Math.cos(h)*g,v+Math.sin(h)*g)}},e.prototype.placeMarkerMid=function(t){var r=this.parsedStyle.points,i=(r||{}).points;if(this.markerMidList.forEach(function(c){c.remove()}),this.markerMidList=[],t&&me(t)&&i)for(var a=1;a<(this.parsedStyle.isClosed?i.length:i.length-1);a++){var o=i[a][0],s=i[a][1],l=a===1?t:t.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(o,s)}},e}(ei),ky=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=V(t,["style"]);return n.call(this,N({type:ct.POLYLINE,style:nt.enableCSSParsing?N({points:"",miterLimit:"",isClosed:!1},r):N({},r),initialParsedStyle:nt.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i))||this}return e.prototype.getTotalLength=function(){return qT(this)},e.prototype.getPointAtLength=function(t,r){return r===void 0&&(r=!1),this.getPoint(t/this.getTotalLength(),r)},e.prototype.getPoint=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var a=[],o=0,s,l,c=this.getTotalLength();i.forEach(function(g,m){i[m+1]&&(s=[0,0],s[0]=o/c,l=fs(g[0],g[1],i[m+1][0],i[m+1][1]),o+=l,s[1]=o/c,a.push(s))}),this.parsedStyle.points.segments=a}var u=0,h=0;this.parsedStyle.points.segments.forEach(function(g,m){t>=g[0]&&t<=g[1]&&(u=(t-g[0])/(g[1]-g[0]),h=m)});var f=Cr(i[h][0],i[h][1],i[h+1][0],i[h+1][1],u),d=f.x,p=f.y,v=_.fF(_.Ue(),_.al(d,p,0),r?this.getWorldTransform():this.getLocalTransform());return new Wn(v[0],v[1])},e.prototype.getStartTangent=function(){var t=this.parsedStyle.points.points,r=[];return r.push([t[1][0],t[1][1]]),r.push([t[0][0],t[0][1]]),r},e.prototype.getEndTangent=function(){var t=this.parsedStyle.points.points,r=t.length-1,i=[];return i.push([t[r-1][0],t[r-1][1]]),i.push([t[r][0],t[r][1]]),i},e}(ru),ea=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:ct.RECT},t))||this}return e}(ei),Al=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=V(t,["style"]);return n.call(this,N({type:ct.TEXT,style:nt.enableCSSParsing?N({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:"",lineHeight:"",miterLimit:"",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},r):N({fill:"black"},r)},i))||this}return e.prototype.getComputedTextLength=function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.maxLineWidth)||0},e.prototype.getLineBoundingRects=function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.lineMetrics)||[]},e.prototype.isOverflowing=function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing},e}(ei),KM=function(){function n(){this.registry={},this.define(ct.CIRCLE,Cl),this.define(ct.ELLIPSE,Zd),this.define(ct.RECT,ea),this.define(ct.IMAGE,Jd),this.define(ct.LINE,nu),this.define(ct.GROUP,Ol),this.define(ct.PATH,Xa),this.define(ct.POLYGON,ru),this.define(ct.POLYLINE,ky),this.define(ct.TEXT,Al),this.define(ct.HTML,qd)}return n.prototype.define=function(e,t){this.registry[e]=t},n.prototype.get=function(e){return this.registry[e]},n}(),Fz={number:function(n){return new Re(n)},percent:function(n){return new Re(n,"%")},px:function(n){return new Re(n,"px")},em:function(n){return new Re(n,"em")},rem:function(n){return new Re(n,"rem")},deg:function(n){return new Re(n,"deg")},grad:function(n){return new Re(n,"grad")},rad:function(n){return new Re(n,"rad")},turn:function(n){return new Re(n,"turn")},s:function(n){return new Re(n,"s")},ms:function(n){return new Re(n,"ms")},registerProperty:function(n){var e=n.name,t=n.inherits,r=n.interpolable,i=n.initialValue,a=n.syntax;nt.styleValueRegistry.registerMetadata({n:e,inh:t,int:r,d:i,syntax:a})},registerLayout:function(n,e){nt.layoutRegistry.registerLayout(n,e)}},Ly=function(n){B(e,n);function e(){var t=n.call(this)||this;t.defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new nt.AnimationTimeline(t)}catch(i){}var r={};return Ud.forEach(function(i){var a=i.n,o=i.inh,s=i.d;o&&s&&(r[a]=ms(s)?s(ct.GROUP):s)}),t.documentElement=new Ol({id:"g-root",style:r}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),e.prototype.createElement=function(t,r){if(t==="svg")return this.documentElement;var i=this.defaultView.customElements.get(t);i||(console.warn("Unsupported tagName: ",t),i=t==="tspan"?Al:Ol);var a=new i(r);return a.ownerDocument=this,a},e.prototype.createElementNS=function(t,r,i){return this.createElement(r,i)},e.prototype.cloneNode=function(t){throw new Error(Ne)},e.prototype.destroy=function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(t){}},e.prototype.elementsFromBBox=function(t,r,i,a){var o=this.defaultView.context.rBushRoot,s=o.search({minX:t,minY:r,maxX:i,maxY:a}),l=[];return s.forEach(function(c){var u=c.displayObject,h=u.parsedStyle.pointerEvents,f=h===void 0?"auto":h,d=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(f);(!d||d&&u.isVisible())&&!u.isCulled()&&u.isInteractive()&&l.push(u)}),l.sort(function(c,u){return u.sortable.renderOrder-c.sortable.renderOrder}),l},e.prototype.elementFromPointSync=function(t,r){var i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height;if(a<0||o<0||a>l||o>c)return null;var u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]}).picked;return d&&d[0]||this.documentElement},e.prototype.elementFromPoint=function(t,r){return j(this,void 0,void 0,function(){var i,a,o,s,l,c,u,h,f,d;return mt(this,function(p){switch(p.label){case 0:return i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height,a<0||o<0||a>l||o>c?[2,null]:(u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]})]);case 1:return d=p.sent().picked,[2,d&&d[0]||this.documentElement]}})})},e.prototype.elementsFromPointSync=function(t,r){var i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height;if(a<0||o<0||a>l||o>c)return[];var u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]}).picked;return d[d.length-1]!==this.documentElement&&d.push(this.documentElement),d},e.prototype.elementsFromPoint=function(t,r){return j(this,void 0,void 0,function(){var i,a,o,s,l,c,u,h,f,d;return mt(this,function(p){switch(p.label){case 0:return i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height,a<0||o<0||a>l||o>c?[2,[]]:(u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]})]);case 1:return d=p.sent().picked,d[d.length-1]!==this.documentElement&&d.push(this.documentElement),[2,d]}})})},e.prototype.appendChild=function(t,r){throw new Error(gs)},e.prototype.insertBefore=function(t,r){throw new Error(gs)},e.prototype.removeChild=function(t,r){throw new Error(gs)},e.prototype.replaceChild=function(t,r,i){throw new Error(gs)},e.prototype.append=function(){throw new Error(gs)},e.prototype.prepend=function(){throw new Error(gs)},e.prototype.getElementById=function(t){return this.documentElement.getElementById(t)},e.prototype.getElementsByName=function(t){return this.documentElement.getElementsByName(t)},e.prototype.getElementsByTagName=function(t){return this.documentElement.getElementsByTagName(t)},e.prototype.getElementsByClassName=function(t){return this.documentElement.getElementsByClassName(t)},e.prototype.querySelector=function(t){return this.documentElement.querySelector(t)},e.prototype.querySelectorAll=function(t){return this.documentElement.querySelectorAll(t)},e.prototype.find=function(t){return this.documentElement.find(t)},e.prototype.findAll=function(t){return this.documentElement.findAll(t)},e}(Dn),ZM=function(){function n(e){this.strategies=e}return n.prototype.apply=function(e){var t=e.camera,r=e.renderingService,i=e.renderingContext,a=this.strategies;r.hooks.cull.tap(n.tag,function(o){if(o){var s=o.cullable;return a.length===0?s.visible=i.unculledEntities.indexOf(o.entity)>-1:s.visible=a.every(function(l){return l.isVisible(t,o)}),!o.isCulled()&&o.isVisible()?o:(o.dispatchEvent(new nr(oe.CULLED)),null)}return o}),r.hooks.afterRender.tap(n.tag,function(o){o.cullable.visibilityPlaneMask=-1})},n.tag="Culling",n}(),qM=function(){function n(){var e=this;this.autoPreventDefault=!1,this.rootPointerEvent=new eu(null),this.rootWheelEvent=new Kd(null),this.onPointerMove=function(t){var r,i,a,o,s=(o=(a=e.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||o===void 0?void 0:o.defaultView;if(!(s.supportsTouchEvents&&t.pointerType==="touch")){var l=e.normalizeToPointerEvent(t,s);try{for(var c=vt(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=e.bootstrapEvent(e.rootPointerEvent,h,s,t);e.context.eventService.mapEvent(f)}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var r,i,a,o,s=(o=(a=e.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||o===void 0?void 0:o.defaultView,l=e.normalizeToPointerEvent(t,s);try{for(var c=vt(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=e.bootstrapEvent(e.rootPointerEvent,h,s,t);e.context.eventService.mapEvent(f)}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}}return n.prototype.apply=function(e){var t=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(a){var o=t.context.renderingService.hooks.pickSync.call({position:a,picked:[],topmost:!0}).picked;return o[0]||null}),r.hooks.pointerWheel.tap(n.tag,function(a){var o=t.normalizeWheelEvent(a);t.context.eventService.mapEvent(o)}),r.hooks.pointerDown.tap(n.tag,function(a){var o,s;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var l=t.normalizeToPointerEvent(a,i);if(t.autoPreventDefault&&l[0].isNormalized){var c=a.cancelable||!("cancelable"in a);c&&a.preventDefault()}try{for(var u=vt(l),h=u.next();!h.done;h=u.next()){var f=h.value,d=t.bootstrapEvent(t.rootPointerEvent,f,i,a);t.context.eventService.mapEvent(d)}}catch(p){o={error:p}}finally{try{h&&!h.done&&(s=u.return)&&s.call(u)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerUp.tap(n.tag,function(a){var o,s;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var l=t.context.contextService.getDomElement(),c=t.context.eventService.isNativeEventFromCanvas(l,a),u=c?"":"outside",h=t.normalizeToPointerEvent(a,i);try{for(var f=vt(h),d=f.next();!d.done;d=f.next()){var p=d.value,v=t.bootstrapEvent(t.rootPointerEvent,p,i,a);v.type+=u,t.context.eventService.mapEvent(v)}}catch(g){o={error:g}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerMove.tap(n.tag,this.onPointerMove),r.hooks.pointerOver.tap(n.tag,this.onPointerMove),r.hooks.pointerOut.tap(n.tag,this.onPointerMove),r.hooks.click.tap(n.tag,this.onClick),r.hooks.pointerCancel.tap(n.tag,function(a){var o,s,l=t.normalizeToPointerEvent(a,i);try{for(var c=vt(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=t.bootstrapEvent(t.rootPointerEvent,h,i,a);t.context.eventService.mapEvent(f)}}catch(d){o={error:d}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)})},n.prototype.bootstrapEvent=function(e,t,r,i){e.view=r,e.originalEvent=null,e.nativeEvent=i,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);var a=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),o=a.x,s=a.y;e.viewport.x=o,e.viewport.y=s;var l=this.context.eventService.viewport2Canvas(e.viewport),c=l.x,u=l.y;return e.canvas.x=c,e.canvas.y=u,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=i.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=XP[e.type]||e.type),e},n.prototype.normalizeWheelEvent=function(e){var t=this.rootWheelEvent;this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;var r=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),i=r.x,a=r.y;t.viewport.x=i,t.viewport.y=a;var o=this.context.eventService.viewport2Canvas(t.viewport),s=o.x,l=o.y;return t.canvas.x=s,t.canvas.y=l,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.nativeEvent=e,t.type=e.type,t},n.prototype.transferMouseData=function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=Yd.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null},n.prototype.setCursor=function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default")},n.prototype.normalizeToPointerEvent=function(e,t){var r=[];if(t.isTouchEvent(e))for(var i=0;i<e.changedTouches.length;i++){var a=e.changedTouches[i];yt(a.button)&&(a.button=0),yt(a.buttons)&&(a.buttons=1),yt(a.isPrimary)&&(a.isPrimary=e.touches.length===1&&e.type==="touchstart"),yt(a.width)&&(a.width=a.radiusX||1),yt(a.height)&&(a.height=a.radiusY||1),yt(a.tiltX)&&(a.tiltX=0),yt(a.tiltY)&&(a.tiltY=0),yt(a.pointerType)&&(a.pointerType="touch"),yt(a.pointerId)&&(a.pointerId=a.identifier||0),yt(a.pressure)&&(a.pressure=a.force||.5),yt(a.twist)&&(a.twist=0),yt(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,a.type=e.type,r.push(a)}else if(t.isMouseEvent(e)){var o=e;yt(o.isPrimary)&&(o.isPrimary=!0),yt(o.width)&&(o.width=1),yt(o.height)&&(o.height=1),yt(o.tiltX)&&(o.tiltX=0),yt(o.tiltY)&&(o.tiltY=0),yt(o.pointerType)&&(o.pointerType="mouse"),yt(o.pointerId)&&(o.pointerId=YP),yt(o.pressure)&&(o.pressure=.5),yt(o.twist)&&(o.twist=0),yt(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,r.push(o)}else r.push(e);return r},n.tag="Event",n}(),JM=[ct.CIRCLE,ct.ELLIPSE,ct.IMAGE,ct.RECT,ct.LINE,ct.POLYLINE,ct.POLYGON,ct.TEXT,ct.PATH,ct.HTML],QM=function(){function n(){}return n.prototype.isVisible=function(e,t){var r,i,a=t.cullable;if(!a.enable)return!0;var o=t.getRenderBounds();if(Fe.isEmpty(o))return!1;var s=e.getFrustum(),l=(i=(r=t.parentNode)===null||r===void 0?void 0:r.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return a.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,o,l||Wa.INDETERMINATE,s.planes),a.visible=a.visibilityPlaneMask!==Wa.OUTSIDE,a.visible},n.prototype.computeVisibilityWithPlaneMask=function(e,t,r,i){if(r===Wa.OUTSIDE||r===Wa.INSIDE)return r;for(var a=Wa.INSIDE,o=JM.indexOf(e.nodeName)>-1,s=0,l=i.length;s<l;++s){var c=1<<s;if(r&c&&!(o&&(s===4||s===5))){var u=i[s],h=u.normal,f=u.distance;if(_.AK(h,t.getPositiveFarPoint(i[s]))+f<0)return Wa.OUTSIDE;_.AK(h,t.getNegativeFarPoint(i[s]))+f<0&&(a|=c)}}return a},n}(),tC=function(){function n(){this.toSync=new Set,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return n.prototype.apply=function(e){var t=this,r,i=e.renderingService,a=e.renderingContext,o=e.rBushRoot,s=a.root.ownerDocument.defaultView;this.rBush=o;var l=function(d){var p=d.target;p.renderable.dirty=!0,i.dirtify()},c=function(d){var p=d.detail.affectChildren,v=d.target;p&&v.forEach(function(m){t.toSync.add(m)});for(var g=v;g;)g.renderable&&t.toSync.add(g),g=g.parentElement;i.dirtify()},u=function(d){var p=d.target;nt.enableSizeAttenuation&&nt.styleValueRegistry.updateSizeAttenuation(p,s.getCamera().getZoom()),nt.enableCSSParsing&&nt.styleValueRegistry.recalc(p),nt.sceneGraphService.dirtifyToRoot(p),i.dirtify()},h=function(d){var p=d.target,v=p.rBushNode;v.aabb&&t.rBush.remove(v.aabb),t.toSync.delete(p),nt.sceneGraphService.dirtifyToRoot(p),i.dirtify()};i.hooks.init.tap(n.tag,function(){s.addEventListener(oe.MOUNTED,u),s.addEventListener(oe.UNMOUNTED,h),s.addEventListener(oe.ATTR_MODIFIED,l),s.addEventListener(oe.BOUNDS_CHANGED,c)}),i.hooks.destroy.tap(n.tag,function(){s.removeEventListener(oe.MOUNTED,u),s.removeEventListener(oe.UNMOUNTED,h),s.removeEventListener(oe.ATTR_MODIFIED,l),s.removeEventListener(oe.BOUNDS_CHANGED,c),t.toSync.clear()});var f=(r=nt.globalThis.requestIdleCallback)!==null&&r!==void 0?r:Xd.bind(nt.globalThis);i.hooks.endFrame.tap(n.tag,function(){t.isFirstTimeRendering?(t.isFirstTimeRendering=!1,t.syncing=!0,f(function(){t.syncRTree(!0),t.isFirstTimeRenderingFinished=!0})):t.syncRTree()})},n.prototype.syncRTree=function(e){var t=this;if(e===void 0&&(e=!1),!(!e&&(this.syncing||this.toSync.size===0))){this.syncing=!0;var r=[];Array.from(this.toSync).filter(function(i){return i.isConnected}).forEach(function(i){var a=i.rBushNode;a&&a.aabb&&t.rBush.remove(a.aabb);var o=i.getRenderBounds();if(o){var s=i.renderable;e&&(s.dirtyRenderBounds||(s.dirtyRenderBounds=new Fe),s.dirtyRenderBounds.update(o.center,o.halfExtents));var l=P(o.getMin(),2),c=l[0],u=l[1],h=P(o.getMax(),2),f=h[0],d=h[1];a.aabb||(a.aabb={}),a.aabb.displayObject=i,a.aabb.minX=c,a.aabb.minY=u,a.aabb.maxX=f,a.aabb.maxY=d}a.aabb&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.minX)&&!isNaN(a.aabb.minY)&&r.push(a.aabb)}),this.rBush.load(r),r.length=0,this.toSync.clear(),this.syncing=!1}},n.tag="Prepare",n}();function Gz(n){return!!n.document}var ni;(function(n){n.READY="ready",n.BEFORE_RENDER="beforerender",n.RERENDER="rerender",n.AFTER_RENDER="afterrender",n.BEFORE_DESTROY="beforedestroy",n.AFTER_DESTROY="afterdestroy",n.RESIZE="resize",n.DIRTY_RECTANGLE="dirtyrectangle",n.RENDERER_CHANGED="rendererchanged"})(ni||(ni={}));var Iy=500,eC=.1,nC=1e3,Qd=new nr(oe.MOUNTED),tp=new nr(oe.UNMOUNTED),Dy=new nr(ni.BEFORE_RENDER),rC=new nr(ni.RERENDER),By=new nr(ni.AFTER_RENDER),iu=function(n){B(e,n);function e(t){var r=n.call(this)||this;r.Element=ei,r.inited=!1,r.context={},r.document=new Ly,r.document.defaultView=r,r.customElements=new KM;var i=t.container,a=t.canvas,o=t.offscreenCanvas,s=t.width,l=t.height,c=t.devicePixelRatio,u=t.renderer,h=t.background,f=t.cursor,d=t.document,p=t.requestAnimationFrame,v=t.cancelAnimationFrame,g=t.createImage,m=t.supportsPointerEvents,x=t.supportsTouchEvents,S=t.supportsCSSTransform,T=t.supportsMutipleCanvasesInOneContainer,b=t.useNativeClickEvent,y=t.alwaysTriggerPointerEventOnCanvas,E=t.isTouchEvent,w=t.isMouseEvent,C=t.dblClickSpeed;T||GP(i,r);var M=s,O=l,A=c;return a&&(A=c||Tl&&window.devicePixelRatio||1,A=A>=1?Math.ceil(A):1,M=s||VP(a)||a.width/A,O=l||HP(a)||a.height/A),o&&(nt.offscreenCanvas=o),r.devicePixelRatio=A,r.requestAnimationFrame=p!=null?p:Xd.bind(nt.globalThis),r.cancelAnimationFrame=v!=null?v:Ey.bind(nt.globalThis),r.supportsTouchEvents=x!=null?x:"ontouchstart"in nt.globalThis,r.supportsPointerEvents=m!=null?m:!!nt.globalThis.PointerEvent,r.isTouchEvent=E!=null?E:function(R){return r.supportsTouchEvents&&R instanceof nt.globalThis.TouchEvent},r.isMouseEvent=w!=null?w:function(R){return!nt.globalThis.MouseEvent||R instanceof nt.globalThis.MouseEvent&&(!r.supportsPointerEvents||!(R instanceof nt.globalThis.PointerEvent))},r.dblClickSpeed=C!=null?C:200,r.initRenderingContext({container:i,canvas:a,width:M,height:O,renderer:u,offscreenCanvas:o,devicePixelRatio:A,cursor:f||"default",background:h||"transparent",createImage:g,document:d,supportsCSSTransform:S,useNativeClickEvent:b,alwaysTriggerPointerEventOnCanvas:y}),r.initDefaultCamera(M,O,u.clipSpaceNearZ),r.initRenderer(u,!0),r}return e.prototype.initRenderingContext=function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}},e.prototype.initDefaultCamera=function(t,r,i){var a=this,o=new nt.CameraContribution;o.clipSpaceNearZ=i,o.setType(we.EXPLORING,wl.DEFAULT).setPosition(t/2,r/2,Iy).setFocalPoint(t/2,r/2,0).setOrthographic(t/-2,t/2,r/2,r/-2,eC,nC),o.canvas=this,o.eventEmitter.on(Fm.UPDATED,function(){a.context.renderingContext.renderReasons.add(Io.CAMERA_CHANGED),nt.enableSizeAttenuation&&a.getConfig().renderer.getConfig().enableSizeAttenuation&&a.updateSizeAttenuation()}),this.context.camera=o},e.prototype.updateSizeAttenuation=function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach(function(r){nt.styleValueRegistry.updateSizeAttenuation(r,t)})},e.prototype.getConfig=function(){return this.context.config},e.prototype.getRoot=function(){return this.document.documentElement},e.prototype.getCamera=function(){return this.context.camera},e.prototype.getContextService=function(){return this.context.contextService},e.prototype.getEventService=function(){return this.context.eventService},e.prototype.getRenderingService=function(){return this.context.renderingService},e.prototype.getRenderingContext=function(){return this.context.renderingContext},e.prototype.getStats=function(){return this.getRenderingService().getStats()},Object.defineProperty(e.prototype,"ready",{get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise(function(r){t.resolveReadyPromise=function(){r(t)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t,r){if(t===void 0&&(t=!0),r===void 0&&(r=!1),r||this.dispatchEvent(new nr(ni.BEFORE_DESTROY)),this.frameId){var i=this.getConfig().cancelAnimationFrame||cancelAnimationFrame;i(this.frameId)}var a=this.getRoot();this.unmountChildren(a),t&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),t&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),r||this.dispatchEvent(new nr(ni.AFTER_DESTROY))},e.prototype.changeSize=function(t,r){this.resize(t,r)},e.prototype.resize=function(t,r){var i=this.context.config;i.width=t,i.height=r,this.getContextService().resize(t,r);var a=this.context.camera,o=a.getProjectionMode();a.setPosition(t/2,r/2,Iy).setFocalPoint(t/2,r/2,0),o===Or.ORTHOGRAPHIC?a.setOrthographic(t/-2,t/2,r/2,r/-2,a.getNear(),a.getFar()):a.setAspect(t/r),this.dispatchEvent(new nr(ni.RESIZE,{width:t,height:r}))},e.prototype.appendChild=function(t,r){return this.document.documentElement.appendChild(t,r)},e.prototype.insertBefore=function(t,r){return this.document.documentElement.insertBefore(t,r)},e.prototype.removeChild=function(t){return this.document.documentElement.removeChild(t)},e.prototype.removeChildren=function(){this.document.documentElement.removeChildren()},e.prototype.destroyChildren=function(){this.document.documentElement.destroyChildren()},e.prototype.render=function(t){var r=this;t&&(Dy.detail=t,By.detail=t),this.dispatchEvent(Dy);var i=this.getRenderingService();i.render(this.getConfig(),t,function(){r.dispatchEvent(rC)}),this.dispatchEvent(By)},e.prototype.run=function(){var t=this,r=function(i,a){t.render(a),t.frameId=t.requestAnimationFrame(r)};r()},e.prototype.initRenderer=function(t,r){var i=this;if(r===void 0&&(r=!1),!t)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new nT,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new qM,new tC,new ZM([new QM])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService(N(N({},nt),this.context)),this.context.renderingService=new SM(nt,this.context),this.context.eventService=new EM(nt,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,r,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(t,r)})},e.prototype.initRenderingService=function(t,r,i){var a=this;r===void 0&&(r=!1),i===void 0&&(i=!1),this.context.renderingService.init(function(){a.inited=!0,r?i?a.requestAnimationFrame(function(){a.dispatchEvent(new nr(ni.READY))}):a.dispatchEvent(new nr(ni.READY)):a.dispatchEvent(new nr(ni.RENDERER_CHANGED)),a.readyPromise&&a.resolveReadyPromise(),r||a.getRoot().forEach(function(o){var s=o.renderable;s&&(s.renderBoundsDirty=!0,s.boundsDirty=!0,s.dirty=!0)}),a.mountChildren(a.getRoot()),t.getConfig().enableAutoRendering&&a.run()})},e.prototype.loadRendererContainerModule=function(t){var r=this,i=t.getPlugins();i.forEach(function(a){a.context=r.context,a.init(nt)})},e.prototype.setRenderer=function(t){var r=this.getConfig();if(r.renderer!==t){var i=r.renderer;r.renderer=t,this.destroy(!1,!0),K([],P(i==null?void 0:i.getPlugins()),!1).reverse().forEach(function(a){a.destroy(nt)}),this.initRenderer(t)}},e.prototype.setCursor=function(t){var r=this.getConfig();r.cursor=t,this.getContextService().applyCursorStyle(t)},e.prototype.unmountChildren=function(t){var r=this;t.childNodes.forEach(function(i){r.unmountChildren(i)}),this.inited&&(t.isMutationObserved?t.dispatchEvent(tp):(tp.target=t,this.dispatchEvent(tp,!0)),t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1),t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()},e.prototype.mountChildren=function(t){var r=this;this.inited?t.isConnected||(t.ownerDocument=this.document,t.isConnected=!0,t.isMutationObserved?t.dispatchEvent(Qd):(Qd.target=t,this.dispatchEvent(Qd,!0))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName),t.childNodes.forEach(function(i){r.mountChildren(i)}),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()},e.prototype.client2Viewport=function(t){return this.getEventService().client2Viewport(t)},e.prototype.viewport2Client=function(t){return this.getEventService().viewport2Client(t)},e.prototype.viewport2Canvas=function(t){return this.getEventService().viewport2Canvas(t)},e.prototype.canvas2Viewport=function(t){return this.getEventService().canvas2Viewport(t)},e.prototype.getPointByClient=function(t,r){return this.client2Viewport({x:t,y:r})},e.prototype.getClientByPoint=function(t,r){return this.viewport2Client({x:t,y:r})},e}(Ty),iC=function(n){B(e,n);function e(){var t=n.apply(this,K([],P(arguments),!1))||this;return t.landmarks=[],t}return e.prototype.rotate=function(t,r,i){if(this.relElevation=vs(r),this.relAzimuth=vs(t),this.relRoll=vs(i),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===we.EXPLORING){var a=kn(Vt(),[1,0,0],Ae((this.rotateWorld?1:-1)*this.relElevation)),o=kn(Vt(),[0,1,0],Ae((this.rotateWorld?1:-1)*this.relAzimuth)),s=kn(Vt(),[0,0,1],Ae(this.relRoll)),l=An(Vt(),o,a);l=An(Vt(),l,s);var c=La(Q(),l);Ee(this.matrix,this.matrix,[0,0,-this.distance]),Ut(this.matrix,this.matrix,c),Ee(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===we.ORBITING||this.type===we.EXPLORING?this._getPosition():this.type===we.TRACKING&&this._getFocalPoint(),this._update(),this},e.prototype.pan=function(t,r){var i=pr(t,r,0),a=_.d9(this.position);return _.IH(a,a,_.bA(_.Ue(),this.right,i[0])),_.IH(a,a,_.bA(_.Ue(),this.up,i[1])),this._setPosition(a),this.triggerUpdate(),this},e.prototype.dolly=function(t){var r=this.forward,i=_.d9(this.position),a=t*this.dollyingStep,o=this.distance+t*this.dollyingStep;return a=Math.max(Math.min(o,this.maxDistance),this.minDistance)-this.distance,i[0]+=a*r[0],i[1]+=a*r[1],i[2]+=a*r[2],this._setPosition(i),this.type===we.ORBITING||this.type===we.EXPLORING?this._getDistance():this.type===we.TRACKING&&_.IH(this.focalPoint,i,this.distanceVector),this.triggerUpdate(),this},e.prototype.cancelLandmarkAnimation=function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)},e.prototype.createLandmark=function(t,r){var i,a,o,s;r===void 0&&(r={});var l=r.position,c=l===void 0?this.position:l,u=r.focalPoint,h=u===void 0?this.focalPoint:u,f=r.roll,d=r.zoom,p=new nt.CameraContribution;p.setType(this.type,void 0),p.setPosition(c[0],(i=c[1])!==null&&i!==void 0?i:this.position[1],(a=c[2])!==null&&a!==void 0?a:this.position[2]),p.setFocalPoint(h[0],(o=h[1])!==null&&o!==void 0?o:this.focalPoint[1],(s=h[2])!==null&&s!==void 0?s:this.focalPoint[2]),p.setRoll(f!=null?f:this.roll),p.setZoom(d!=null?d:this.zoom);var v={name:t,matrix:Bt(p.getWorldTransform()),right:_.d9(p.right),up:_.d9(p.up),forward:_.d9(p.forward),position:_.d9(p.getPosition()),focalPoint:_.d9(p.getFocalPoint()),distanceVector:_.d9(p.getDistanceVector()),distance:p.getDistance(),dollyingStep:p.getDollyingStep(),azimuth:p.getAzimuth(),elevation:p.getElevation(),roll:p.getRoll(),relAzimuth:p.relAzimuth,relElevation:p.relElevation,relRoll:p.relRoll,zoom:p.getZoom()};return this.landmarks.push(v),v},e.prototype.gotoLandmark=function(t,r){var i=this;r===void 0&&(r={});var a=qt(t)?this.landmarks.find(function(M){return M.name===t}):t;if(a){var o=te(r)?{duration:r}:r,s=o.easing,l=s===void 0?"linear":s,c=o.duration,u=c===void 0?100:c,h=o.easingFunction,f=h===void 0?void 0:h,d=o.onfinish,p=d===void 0?void 0:d,v=o.onframe,g=v===void 0?void 0:v,m=.01;this.cancelLandmarkAnimation();var x=a.position,S=a.focalPoint,T=a.zoom,b=a.roll,y=f||nt.EasingFunction(l),E,w=function(){i.setFocalPoint(S),i.setPosition(x),i.setRoll(b),i.setZoom(T),i.computeMatrix(),i.triggerUpdate(),p==null||p()};if(u===0)return w();var C=function(M){E===void 0&&(E=M);var O=M-E;if(O>=u){w();return}var A=y(O/u),R=_.Ue(),L=_.Ue(),z=1,Y=0;_.t7(R,i.focalPoint,S,A),_.t7(L,i.position,x,A),Y=i.roll*(1-A)+b*A,z=i.zoom*(1-A)+T*A,i.setFocalPoint(R),i.setPosition(L),i.setRoll(Y),i.setZoom(z);var I=_.TK(R,S)+_.TK(L,x);if(I<=m&&T==null&&b==null)return w();i.computeMatrix(),i.triggerUpdate(),O<u&&(g==null||g(A),i.landmarkAnimationID=i.canvas.requestAnimationFrame(C))};this.canvas.requestAnimationFrame(C)}},e}(zm);nt.CameraContribution=iC;var Fy=function(){function n(e,t){this.type=e,this.target=t,this.addedNodes=[],this.attributeName=null,this.attributeNamespace=null,this.nextSibling=null,this.oldValue=null,this.previousSibling=null,this.removedNodes=[]}return n.copy=function(e){var t=new n(e.type,e.target);return t.addedNodes=e.addedNodes.slice(),t.removedNodes=e.removedNodes.slice(),t.previousSibling=e.previousSibling,t.nextSibling=e.nextSibling,t.attributeName=e.attributeName,t.attributeNamespace=e.attributeNamespace,t.oldValue=e.oldValue,t},n}(),aC=0,Ss=new WeakMap,oC=function(){function n(e,t,r){this.observer=e,this.target=t,this.options=r,this.transientObservedNodes=[]}return n.prototype.enqueue=function(e){var t=this.observer.records,r=t.length;if(t.length>0){var i=t[r-1],a=uC(i,e);if(a){t[r-1]=a;return}}else fC(this.observer);t[r]=e},n.prototype.addListeners=function(){this.addListeners_(this.target)},n.prototype.addListeners_=function(e){var t=this.options;t.attributes&&e.addEventListener(oe.ATTR_MODIFIED,this,!0),t.childList&&e.addEventListener(oe.INSERTED,this,!0),(t.childList||t.subtree)&&e.addEventListener(oe.REMOVED,this,!0)},n.prototype.removeListeners=function(){this.removeListeners_(this.target)},n.prototype.removeListeners_=function(e){var t=this.options;t.attributes&&e.removeEventListener(oe.ATTR_MODIFIED,this,!0),t.childList&&e.removeEventListener(oe.INSERTED,this,!0),(t.childList||t.subtree)&&e.removeEventListener(oe.REMOVED,this,!0)},n.prototype.removeTransientObservers=function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(t){this.removeListeners_(t);for(var r=Ss.get(t),i=0;i<r.length;i++)if(r[i]===this){r.splice(i,1);break}},this)},n.prototype.handleEvent=function(e){e.stopImmediatePropagation();var t,r;switch(e.type){case oe.ATTR_MODIFIED:var i=e.attrName,a=e.relatedNode.namespaceURI;r=e.target,t=Gy("attributes",r),t.attributeName=i,t.attributeNamespace=a;var o=e.attrChange===Ya.ADDITION?null:e.prevValue;zy(r,function(f){if(f.attributes&&!(f.attributeFilter&&f.attributeFilter.length&&f.attributeFilter.indexOf(i)===-1&&f.attributeFilter.indexOf(a)===-1))return f.attributeOldValue?sC(o):t});break;case oe.REMOVED:case oe.INSERTED:r=e.relatedNode;var s=e.target,l=void 0,c=void 0;e.type===oe.INSERTED?(l=[s],c=[]):(l=[],c=[s]);var u=s.previousSibling,h=s.nextSibling;t=Gy("childList",r),t.addedNodes=l,t.removedNodes=c,t.previousSibling=u,t.nextSibling=h,zy(r,function(f){if(f.childList)return t})}lC()},n}(),zz=function(){function n(e){this.callback=e,this.nodes=[],this.records=[],this.uid=aC++}return n.prototype.observe=function(e,t){if(!t.childList&&!t.attributes&&!t.characterData||t.attributeOldValue&&!t.attributes||t.attributeFilter&&t.attributeFilter.length&&!t.attributes||t.characterDataOldValue&&!t.characterData)throw new SyntaxError;var r=Ss.get(e);r||Ss.set(e,r=[]);for(var i,a=0;a<r.length;a++)if(r[a].observer===this){i=r[a],i.removeListeners(),i.options=t;break}i||(i=new oC(this,e,t),r.push(i),this.nodes.push(e)),i.addListeners()},n.prototype.disconnect=function(){var e=this;this.nodes.forEach(function(t){for(var r=Ss.get(t),i=0;i<r.length;i++){var a=r[i];if(a.observer===e){a.removeListeners(),r.splice(i,1);break}}},this),this.records=[]},n.prototype.takeRecords=function(){var e=this.records;return this.records=[],e},n}(),au,ya;function Gy(n,e){return au=new Fy(n,e)}function sC(n){return ya||(ya=Fy.copy(au),ya.oldValue=n,ya)}function lC(){au=ya=void 0}function cC(n){return n===ya||n===au}function uC(n,e){return n===e?n:ya&&cC(n)?ya:null}function hC(n){n.nodes.forEach(function(e){var t=Ss.get(e);t&&t.forEach(function(r){r.observer===n&&r.removeTransientObservers()})})}function zy(n,e){for(var t=n;t;t=t.parentNode){var r=Ss.get(t);if(r)for(var i=0;i<r.length;i++){var a=r[i],o=a.options;if(!(t!==n&&!o.subtree)){var s=e(o);s&&a.enqueue(s)}}}}var ep=!1,np=[];function fC(n){np.push(n),ep||(ep=!0,typeof nt.globalThis!="undefined"?nt.globalThis.setTimeout(rp):rp())}function rp(){ep=!1;var n=np;np=[],n.sort(function(t,r){return t.uid-r.uid});var e=!1;n.forEach(function(t){var r=t.takeRecords();hC(t),r.length&&(t.callback(r,t),e=!0)}),e&&rp()}var ip=function(n){B(e,n);function e(t,r,i,a){var o=n.call(this,t)||this;return o.currentTime=i,o.timelineTime=a,o.target=r,o.type="finish",o.bubbles=!1,o.currentTarget=r,o.defaultPrevented=!1,o.eventPhase=o.AT_TARGET,o.timeStamp=Date.now(),o.currentTime=i,o.timelineTime=a,o}return e}(tu),dC=0,pC=function(){function n(e,t){var r;this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=t,this.id="".concat(dC++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((r=this.effect)===null||r===void 0?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return Object.defineProperty(n.prototype,"pending",{get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playState",{get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ready",{get:function(){var e=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(t,r){e.resolveReadyPromise=function(){t(e)},e.rejectReadyPromise=function(){r(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"finished",{get:function(){var e=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(t,r){e.resolveFinishedPromise=function(){t(e)},e.rejectFinishedPromise=function(){r(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(e){var t;e=Number(e),!isNaN(e)&&(this.timeline.restart(),!this._paused&&this._startTime!==null&&(this._startTime=Number((t=this.timeline)===null||t===void 0?void 0:t.currentTime)-e/this.playbackRate),this.currentTimePending=!1,this._currentTime!==e&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(e,!0),this.timeline.applyDirtiedAnimation(this)))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"startTime",{get:function(){return this._startTime},set:function(e){if(e!==null){if(this.updatePromises(),e=Number(e),isNaN(e)||this._paused||this._idle)return;this._startTime=e,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(e){if(e!==this._playbackRate){this.updatePromises();var t=this.currentTime;this._playbackRate=e,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),t!==null&&(this.currentTime=t),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_isFinished",{get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"totalDuration",{get:function(){return this._totalDuration},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_needsTick",{get:function(){return this.pending||this.playState==="running"||!this._finishedFlag},enumerable:!1,configurable:!0}),n.prototype.updatePromises=function(){var e=this.oldPlayState,t=this.pending?"pending":this.playState;return this.readyPromise&&t!==e&&(t==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):e==="pending"?this.resolveReadyPromise():t==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&t!==e&&(t==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):t==="finished"?this.resolveFinishedPromise():e==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=t,this.readyPromise||this.finishedPromise},n.prototype.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()},n.prototype.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()},n.prototype.finish=function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},n.prototype.cancel=function(){var e=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var t=new ip(null,this,this.currentTime,null);setTimeout(function(){e.oncancel(t)})}},n.prototype.reverse=function(){this.updatePromises();var e=this.currentTime;this.playbackRate*=-1,this.play(),e!==null&&(this.currentTime=e),this.updatePromises()},n.prototype.updatePlaybackRate=function(e){this.playbackRate=e},n.prototype.targetAnimations=function(){var e,t=(e=this.effect)===null||e===void 0?void 0:e.target;return t.getAnimations()},n.prototype.markTarget=function(){var e=this.targetAnimations();e.indexOf(this)===-1&&e.push(this)},n.prototype.unmarkTarget=function(){var e=this.targetAnimations(),t=e.indexOf(this);t!==-1&&e.splice(t,1)},n.prototype.tick=function(e,t){!this._idle&&!this._paused&&(this._startTime===null?t&&(this.startTime=e-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((e-this._startTime)*this.playbackRate)),t&&(this.currentTimePending=!1,this.fireEvents(e))},n.prototype.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")},n.prototype.persist=function(){throw new Error(Ne)},n.prototype.addEventListener=function(e,t,r){throw new Error(Ne)},n.prototype.removeEventListener=function(e,t,r){throw new Error(Ne)},n.prototype.dispatchEvent=function(e){throw new Error(Ne)},n.prototype.commitStyles=function(){throw new Error(Ne)},n.prototype.ensureAlive=function(){var e,t;this.playbackRate<0&&this.currentTime===0?this._inEffect=!!(!((e=this.effect)===null||e===void 0)&&e.update(-1)):this._inEffect=!!(!((t=this.effect)===null||t===void 0)&&t.update(this.currentTime)),!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))},n.prototype.tickCurrentTime=function(e,t){e!==this._currentTime&&(this._currentTime=e,this._isFinished&&!t&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())},n.prototype.fireEvents=function(e){var t=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var r=new ip(null,this,this.currentTime,e);setTimeout(function(){t.onfinish&&t.onfinish(r)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var i=new ip(null,this,this.currentTime,e);this.onframe(i)}this._finishedFlag=!1}},n}(),vC=4,gC=.001,mC=1e-7,yC=10,Nl=11,ou=1/(Nl-1),xC=typeof Float32Array=="function",Wy=function(n,e){return 1-3*e+3*n},Uy=function(n,e){return 3*e-6*n},Vy=function(n){return 3*n},su=function(n,e,t){return((Wy(e,t)*n+Uy(e,t))*n+Vy(e))*n},Hy=function(n,e,t){return 3*Wy(e,t)*n*n+2*Uy(e,t)*n+Vy(e)},bC=function(n,e,t,r,i){var a,o,s=0;do o=e+(t-e)/2,a=su(o,r,i)-n,a>0?t=o:e=o;while(Math.abs(a)>mC&&++s<yC);return o},EC=function(n,e,t,r){for(var i=0;i<vC;++i){var a=Hy(e,t,r);if(a===0)return e;var o=su(e,t,r)-n;e-=o/a}return e},ap=function(n,e,t,r){if(!(0<=n&&n<=1&&0<=t&&t<=1))throw new Error("bezier x values must be in [0, 1] range");if(n===e&&t===r)return function(s){return s};for(var i=xC?new Float32Array(Nl):new Array(Nl),a=0;a<Nl;++a)i[a]=su(a*ou,n,t);var o=function(s){for(var l=0,c=1,u=Nl-1;c!==u&&i[c]<=s;++c)l+=ou;--c;var h=(s-i[c])/(i[c+1]-i[c]),f=l+h*ou,d=Hy(f,n,t);return d>=gC?EC(s,f,n,t):d===0?f:bC(s,l,l+ou,n,t)};return function(s){return s===0||s===1?s:su(o(s),e,r)}},wC=function(n){return n=n.replace(/([A-Z])/g,function(e){return"-".concat(e.toLowerCase())}),n.charAt(0)==="-"?n.substring(1):n},lu=function(n){return Math.pow(n,2)},cu=function(n){return Math.pow(n,3)},uu=function(n){return Math.pow(n,4)},hu=function(n){return Math.pow(n,5)},fu=function(n){return Math.pow(n,6)},du=function(n){return 1-Math.cos(n*Math.PI/2)},pu=function(n){return 1-Math.sqrt(1-n*n)},vu=function(n){return n*n*(3*n-2)},gu=function(n){for(var e,t=4;n<((e=Math.pow(2,--t))-1)/11;);return 1/Math.pow(4,3-t)-7.5625*Math.pow((e*3-2)/22-n,2)},mu=function(n,e){e===void 0&&(e=[]);var t=P(e,2),r=t[0],i=r===void 0?1:r,a=t[1],o=a===void 0?.5:a,s=he(Number(i),1,10),l=he(Number(o),.1,2);return n===0||n===1?n:-s*Math.pow(2,10*(n-1))*Math.sin((n-1-l/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/l)},Rl=function(n,e,t){e===void 0&&(e=[]);var r=P(e,4),i=r[0],a=i===void 0?1:i,o=r[1],s=o===void 0?100:o,l=r[2],c=l===void 0?10:l,u=r[3],h=u===void 0?0:u;a=he(a,.1,1e3),s=he(s,.1,1e3),c=he(c,.1,1e3),h=he(h,.1,1e3);var f=Math.sqrt(s/a),d=c/(2*Math.sqrt(s*a)),p=d<1?f*Math.sqrt(1-d*d):0,v=1,g=d<1?(d*f+-h)/p:-h+f,m=t?t*n/1e3:n;return d<1?m=Math.exp(-m*d*f)*(v*Math.cos(p*m)+g*Math.sin(p*m)):m=(v+g*m)*Math.exp(-m*f),n===0||n===1?n:1-m},op=function(n,e){e===void 0&&(e=[]);var t=P(e,2),r=t[0],i=r===void 0?10:r,a=t[1],o=a=="start"?Math.ceil:Math.floor;return o(he(n,0,1)*i)/i},Yy=function(n,e){e===void 0&&(e=[]);var t=P(e,4),r=t[0],i=t[1],a=t[2],o=t[3];return ap(r,i,a,o)(n)},yu=ap(.42,0,1,1),wi=function(n){return function(e,t,r){return t===void 0&&(t=[]),1-n(1-e,t,r)}},Si=function(n){return function(e,t,r){return t===void 0&&(t=[]),e<.5?n(e*2,t,r)/2:1-n(e*-2+2,t,r)/2}},_i=function(n){return function(e,t,r){return t===void 0&&(t=[]),e<.5?(1-n(1-e*2,t,r))/2:(n(e*2-1,t,r)+1)/2}},Xy={steps:op,"step-start":function(n){return op(n,[1,"start"])},"step-end":function(n){return op(n,[1,"end"])},linear:function(n){return n},"cubic-bezier":Yy,ease:function(n){return Yy(n,[.25,.1,.25,1])},in:yu,out:wi(yu),"in-out":Si(yu),"out-in":_i(yu),"in-quad":lu,"out-quad":wi(lu),"in-out-quad":Si(lu),"out-in-quad":_i(lu),"in-cubic":cu,"out-cubic":wi(cu),"in-out-cubic":Si(cu),"out-in-cubic":_i(cu),"in-quart":uu,"out-quart":wi(uu),"in-out-quart":Si(uu),"out-in-quart":_i(uu),"in-quint":hu,"out-quint":wi(hu),"in-out-quint":Si(hu),"out-in-quint":_i(hu),"in-expo":fu,"out-expo":wi(fu),"in-out-expo":Si(fu),"out-in-expo":_i(fu),"in-sine":du,"out-sine":wi(du),"in-out-sine":Si(du),"out-in-sine":_i(du),"in-circ":pu,"out-circ":wi(pu),"in-out-circ":Si(pu),"out-in-circ":_i(pu),"in-back":vu,"out-back":wi(vu),"in-out-back":Si(vu),"out-in-back":_i(vu),"in-bounce":gu,"out-bounce":wi(gu),"in-out-bounce":Si(gu),"out-in-bounce":_i(gu),"in-elastic":mu,"out-elastic":wi(mu),"in-out-elastic":Si(mu),"out-in-elastic":_i(mu),spring:Rl,"spring-in":Rl,"spring-out":wi(Rl),"spring-in-out":Si(Rl),"spring-out-in":_i(Rl)},SC=function(n){return wC(n).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},_C=function(n){return Xy[SC(n)]||Xy.linear},TC=function(n){return n},PC=1,MC=.5,jy=0;function $y(n,e){return function(t){if(t>=1)return 1;var r=1/n;return t+=e*r,t-t%r}}var xu="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",CC=new RegExp("cubic-bezier\\("+xu+","+xu+","+xu+","+xu+"\\)"),OC=/steps\(\s*(\d+)\s*\)/,AC=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function sp(n){var e=CC.exec(n);if(e)return ap.apply(void 0,K([],P(e.slice(1).map(Number)),!1));var t=OC.exec(n);if(t)return $y(Number(t[1]),jy);var r=AC.exec(n);return r?$y(Number(r[1]),{start:PC,middle:MC,end:jy}[r[2]]):_C(n)}function NC(n){return Math.abs(RC(n)/(n.playbackRate||1))}function RC(n){var e;return n.duration===0||n.iterations===0?0:(n.duration==="auto"?0:Number(n.duration))*((e=n.iterations)!==null&&e!==void 0?e:1)}var Ky=0,lp=1,bu=2,Zy=3;function kC(n,e,t){if(e===null)return Ky;var r=t.endTime;return e<Math.min(t.delay,r)?lp:e>=Math.min(t.delay+n+t.endDelay,r)?bu:Zy}function LC(n,e,t,r,i){switch(r){case lp:return e==="backwards"||e==="both"?0:null;case Zy:return t-i;case bu:return e==="forwards"||e==="both"?n:null;case Ky:return null}}function IC(n,e,t,r,i){var a=i;return n===0?e!==lp&&(a+=t):a+=r/n,a}function DC(n,e,t,r,i,a){var o=n===1/0?e%1:n%1;return o===0&&t===bu&&r!==0&&(i!==0||a===0)&&(o=1),o}function BC(n,e,t,r){return n===bu&&e===1/0?1/0:t===1?Math.floor(r)-1:Math.floor(r)}function FC(n,e,t){var r=n;if(n!=="normal"&&n!=="reverse"){var i=e;n==="alternate-reverse"&&(i+=1),r="normal",i!==1/0&&i%2!==0&&(r="reverse")}return r==="normal"?t:1-t}function GC(n,e,t){var r=kC(n,e,t),i=LC(n,t.fill,e,r,t.delay);if(i===null)return null;var a=t.duration==="auto"?0:t.duration,o=IC(a,r,t.iterations,i,t.iterationStart),s=DC(o,t.iterationStart,r,t.iterations,i,a),l=BC(r,t.iterations,s,o),c=FC(t.direction,l,s);return t.currentIteration=l,t.progress=c,t.easingFunction(c)}function zC(n,e,t){var r=WC(n,e),i=UC(r,t);return function(a,o){if(o!==null)i.filter(function(l){return o>=l.applyFrom&&o<l.applyTo}).forEach(function(l){var c=o-l.startOffset,u=l.endOffset-l.startOffset,h=u===0?0:c/u;a.setAttribute(l.property,l.interpolation(h),!1,!1)});else for(var s in r)qy(s)&&a.setAttribute(s,null)}}function qy(n){return n!=="offset"&&n!=="easing"&&n!=="composite"&&n!=="computedOffset"}function WC(n,e){for(var t={},r=0;r<n.length;r++)for(var i in n[r])if(qy(i)){var a={offset:n[r].offset,computedOffset:n[r].computedOffset,easing:n[r].easing,easingFunction:sp(n[r].easing)||e.easingFunction,value:n[r][i]};t[i]=t[i]||[],t[i].push(a)}return t}function UC(n,e){var t=[];for(var r in n)for(var i=n[r],a=0;a<i.length-1;a++){var o=a,s=a+1,l=i[o].computedOffset,c=i[s].computedOffset,u=l,h=c;a===0&&(u=-1/0,c===0&&(s=o)),a===i.length-2&&(h=1/0,l===1&&(o=s)),t.push({applyFrom:u,applyTo:h,startOffset:i[o].computedOffset,endOffset:i[s].computedOffset,easingFunction:i[o].easingFunction,property:r,interpolation:VC(r,i[o].value,i[s].value,e)})}return t.sort(function(f,d){return f.startOffset-d.startOffset}),t}var Jy=function(n,e,t){return function(r){var i=Qy(n,e,r);return!nt.enableCSSParsing&&te(i)?i:t(i)}};function VC(n,e,t,r){var i=Ha[n];if(i&&i.syntax&&i.int){var a=nt.styleValueRegistry.getPropertySyntax(i.syntax);if(a){var o=void 0,s=void 0;if(nt.enableCSSParsing){var l=nt.styleValueRegistry.parseProperty(n,e,r,!1),c=nt.styleValueRegistry.parseProperty(n,t,r,!1);o=nt.styleValueRegistry.computeProperty(n,l,r,!1),s=nt.styleValueRegistry.computeProperty(n,c,r,!1)}else{var u=a.parserWithCSSDisabled;o=u?u(e,r):e,s=u?u(t,r):t}var h=a.mixer(o,s,r);if(h){var f=Jy.apply(void 0,K([],P(h),!1));return function(d){return d===0?e:d===1?t:f(d)}}}}return Jy(!1,!0,function(d){return d?t:e})}function Qy(n,e,t){if(typeof n=="number"&&typeof e=="number")return n*(1-t)+e*t;if(typeof n=="boolean"&&typeof e=="boolean"||typeof n=="string"&&typeof e=="string")return t<.5?n:e;if(Array.isArray(n)&&Array.isArray(e)){for(var r=n.length,i=e.length,a=Math.max(r,i),o=[],s=0;s<a;s++)o.push(Qy(n[s<r?s:r-1],e[s<i?s:i-1],t));return o}throw new Error("Mismatched interpolation arguments "+n+":"+e)}var HC=function(){function n(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=TC,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return Object.defineProperty(n.prototype,"easing",{get:function(){return this._easing},set:function(e){this.easingFunction=sp(e),this._easing=e},enumerable:!1,configurable:!0}),n}();function YC(n){var e=[];for(var t in n)if(!(t in["easing","offset","composite"])){var r=n[t];Array.isArray(r)||(r=[r]);for(var i=r.length,a=0;a<i;a++){if(!e[a]){var o={};"offset"in n&&(o.offset=Number(n.offset)),"easing"in n&&(o.easing=n.easing),"composite"in n&&(o.composite=n.composite),e[a]=o}r[a]!==void 0&&r[a]!==null&&(e[a][t]=r[a])}}return e.sort(function(s,l){return(s.computedOffset||0)-(l.computedOffset||0)}),e}function t1(n,e){if(n===null)return[];Array.isArray(n)||(n=YC(n));for(var t=n.map(function(l){var c={};e!=null&&e.composite&&(c.composite="auto");for(var u in l){var h=l[u];if(u==="offset"){if(h!==null){if(h=Number(h),!isFinite(h))throw new Error("Keyframe offsets must be numbers.");if(h<0||h>1)throw new Error("Keyframe offsets must be between 0 and 1.");c.computedOffset=h}}else if(u==="composite"&&["replace","add","accumulate","auto"].indexOf(h)===-1)throw new Error("".concat(h," compositing is not supported"));c[u]=h}return c.offset===void 0&&(c.offset=null),c.easing===void 0&&(c.easing=(e==null?void 0:e.easing)||"linear"),c.composite===void 0&&(c.composite="auto"),c}),r=!0,i=-1/0,a=0;a<t.length;a++){var o=t[a].offset;if(pt(o))r=!1;else{if(o<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=o}}t=t.filter(function(l){return Number(l.offset)>=0&&Number(l.offset)<=1});function s(){var l,c,u=t.length;t[u-1].computedOffset=Number((l=t[u-1].offset)!==null&&l!==void 0?l:1),u>1&&(t[0].computedOffset=Number((c=t[0].offset)!==null&&c!==void 0?c:0));for(var h=0,f=Number(t[0].computedOffset),d=1;d<u;d++){var p=t[d].computedOffset;if(!pt(p)&&!pt(f)){for(var v=1;v<d-h;v++)t[h+v].computedOffset=f+(Number(p)-f)*v/(d-h);h=d,f=Number(p)}}}return r||s(),t}var XC="backwards|forwards|both|none".split("|"),jC="reverse|alternate|alternate-reverse".split("|");function $C(n,e){var t=new HC;return e&&(t.fill="both",t.duration="auto"),typeof n=="number"&&!isNaN(n)?t.duration=n:n!==void 0&&Object.keys(n).forEach(function(r){if(n[r]!==void 0&&n[r]!==null&&n[r]!=="auto"){if((typeof t[r]=="number"||r==="duration")&&(typeof n[r]!="number"||isNaN(n[r]))||r==="fill"&&XC.indexOf(n[r])===-1||r==="direction"&&jC.indexOf(n[r])===-1)return;t[r]=n[r]}}),t}function KC(n,e){return n=ZC(n!=null?n:{duration:"auto"}),$C(n,e)}function ZC(n){return typeof n=="number"&&(isNaN(n)?n={duration:"auto"}:n={duration:n}),n}var qC=function(){function n(e,t,r){var i=this;this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=KC(r,!1),this.timing.effect=this,this.timing.activeDuration=NC(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=t1(t,this.timing),this.interpolations=zC(this.normalizedKeyframes,this.timing,this.target);var a=nt.globalThis.Proxy;this.computedTiming=a?new a(this.timing,{get:function(o,s){return s==="duration"?o.duration==="auto"?0:o.duration:s==="fill"?o.fill==="auto"?"none":o.fill:s==="localTime"?i.animation&&i.animation.currentTime||null:s==="currentIteration"?!i.animation||i.animation.playState!=="running"?null:o.currentIteration||0:s==="progress"?!i.animation||i.animation.playState!=="running"?null:o.progress||0:o[s]},set:function(){return!0}}):this.timing}return n.prototype.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},n.prototype.update=function(e){return e===null?!1:(this.timeFraction=GC(this.timing.activeDuration,e,this.timing),this.timeFraction!==null)},n.prototype.getKeyframes=function(){return this.normalizedKeyframes},n.prototype.setKeyframes=function(e){this.normalizedKeyframes=t1(e)},n.prototype.getComputedTiming=function(){return this.computedTiming},n.prototype.getTiming=function(){return this.timing},n.prototype.updateTiming=function(e){var t=this;Object.keys(e||{}).forEach(function(r){t.timing[r]=e[r]})},n}();function e1(n,e){return Number(n.id)-Number(e.id)}var JC=function(){function n(e){var t=this;this.document=e,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(r){t.currentTime=r,t.discardAnimations(),t.animations.length===0?t.timelineTicking=!1:t.requestAnimationFrame(t.webAnimationsNextTick)},this.processRafCallbacks=function(r){var i=t.rafCallbacks;t.rafCallbacks=[],r<Number(t.currentTime)&&(r=Number(t.currentTime)),t.animations.sort(e1),t.animations=t.tick(r,!0,t.animations)[0],i.forEach(function(a){a[1](r)}),t.applyPendingEffects()}}return n.prototype.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},n.prototype.isTicking=function(){return this.inTick},n.prototype.play=function(e,t,r){var i=new qC(e,t,r),a=new pC(i,this);return this.animations.push(a),this.restartWebAnimationsNextTick(),a.updatePromises(),a.play(),a.updatePromises(),a},n.prototype.applyDirtiedAnimation=function(e){var t=this;if(!this.inTick){e.markTarget();var r=e.targetAnimations();r.sort(e1);var i=this.tick(Number(this.currentTime),!1,r.slice())[1];i.forEach(function(a){var o=t.animations.indexOf(a);o!==-1&&t.animations.splice(o,1)}),this.applyPendingEffects()}},n.prototype.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},n.prototype.destroy=function(){this.document.defaultView.cancelAnimationFrame(this.frameId)},n.prototype.applyPendingEffects=function(){this.pendingEffects.forEach(function(e){e==null||e.applyInterpolations()}),this.pendingEffects=[]},n.prototype.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(e){return e.updatePromises()})},n.prototype.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(e){return e.playState!=="finished"&&e.playState!=="idle"})},n.prototype.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},n.prototype.rAF=function(e){var t=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([t,e]),t},n.prototype.requestAnimationFrame=function(e){var t=this;return this.rAF(function(r){t.updateAnimationsPromises(),e(r),t.updateAnimationsPromises()})},n.prototype.tick=function(e,t,r){var i,a,o=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=e,this.ticking=!1;var s=[],l=[],c=[],u=[];return r.forEach(function(h){h.tick(e,t),h._inEffect?(l.push(h.effect),h.markTarget()):(s.push(h.effect),h.unmarkTarget()),h._needsTick&&(o.ticking=!0);var f=h._inEffect||h._needsTick;h._inTimeline=f,f?c.push(h):u.push(h)}),(i=this.pendingEffects).push.apply(i,K([],P(s),!1)),(a=this.pendingEffects).push.apply(a,K([],P(l),!1)),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[c,u]},n}();nt.EasingFunction=sp,nt.AnimationTimeline=JC;var n1=function(n){return pt(n)?"":n.toString()},QC=function(n){var e=n1(n);return e.charAt(0).toUpperCase()+e.substring(1)},Eu=QC,tO=function(n){return typeof n=="object"&&n!==null},cp=tO,eO=function(n){return n!==null&&typeof n!="function"&&isFinite(n.length)},kl=eO,up=function(n,e){if(n===e)return!0;if(!n||!e||qt(n)||qt(e))return!1;if(kl(n)||kl(e)){if(n.length!==e.length)return!1;for(var t=!0,r=0;r<n.length&&(t=up(n[r],e[r]),!!t);r++);return t}if(cp(n)||cp(e)){var i=Object.keys(n),a=Object.keys(e);if(i.length!==a.length)return!1;for(var t=!0,r=0;r<i.length&&(t=up(n[i[r]],e[i[r]]),!!t);r++);return t}return!1},un=up;const nO={duration:500},rO={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"},Wz={CHANGE:"change"};var Qe;(function(n){n.NodeAdded="NodeAdded",n.NodeUpdated="NodeUpdated",n.NodeRemoved="NodeRemoved",n.EdgeAdded="EdgeAdded",n.EdgeUpdated="EdgeUpdated",n.EdgeRemoved="EdgeRemoved",n.ComboAdded="ComboAdded",n.ComboUpdated="ComboUpdated",n.ComboRemoved="ComboRemoved"})(Qe||(Qe={}));var kr;(function(n){n.DRAW="draw",n.COLLAPSE="collapse",n.EXPAND="expand",n.TRANSFORM="transform"})(kr||(kr={}));var xa;(function(n){n.CLICK="canvas:click",n.DBLCLICK="canvas:dblclick",n.POINTER_OVER="canvas:canvas:pointerover",n.POINTER_LEAVE="canvas:pointerleave",n.POINTER_ENTER="canvas:pointerenter",n.POINTER_MOVE="canvas:pointermove",n.POINTER_OUT="canvas:pointerout",n.POINTER_DOWN="canvas:pointerdown",n.POINTER_UP="canvas:pointerup",n.CONTEXT_MENU="canvas:contextmenu",n.DRAG_START="canvas:dragstart",n.DRAG="canvas:drag",n.DRAG_END="canvas:dragend",n.DRAG_ENTER="canvas:dragenter",n.DRAG_OVER="canvas:dragover",n.DRAG_LEAVE="canvas:dragleave",n.DROP="canvas:drop",n.WHEEL="canvas:wheel"})(xa||(xa={}));var Bo;(function(n){n.CLICK="combo:click",n.DBLCLICK="combo:dblclick",n.POINTER_OVER="combo:pointerover",n.POINTER_LEAVE="combo:pointerleave",n.POINTER_ENTER="combo:pointerenter",n.POINTER_MOVE="combo:pointermove",n.POINTER_OUT="combo:pointerout",n.POINTER_DOWN="combo:pointerdown",n.POINTER_UP="combo:pointerup",n.CONTEXT_MENU="combo:contextmenu",n.DRAG_START="combo:dragstart",n.DRAG="combo:drag",n.DRAG_END="combo:dragend",n.DRAG_ENTER="combo:dragenter",n.DRAG_OVER="combo:dragover",n.DRAG_LEAVE="combo:dragleave",n.DROP="combo:drop"})(Bo||(Bo={}));var ht;(function(n){n.CLICK="click",n.DBLCLICK="dblclick",n.POINTER_OVER="pointerover",n.POINTER_LEAVE="pointerleave",n.POINTER_ENTER="pointerenter",n.POINTER_MOVE="pointermove",n.POINTER_OUT="pointerout",n.POINTER_DOWN="pointerdown",n.POINTER_UP="pointerup",n.CONTEXT_MENU="contextmenu",n.DRAG_START="dragstart",n.DRAG="drag",n.DRAG_END="dragend",n.DRAG_ENTER="dragenter",n.DRAG_OVER="dragover",n.DRAG_LEAVE="dragleave",n.DROP="drop",n.KEY_DOWN="keydown",n.KEY_UP="keyup",n.WHEEL="wheel"})(ht||(ht={}));var _s;(function(n){n.KEY_DOWN="keydown",n.KEY_UP="keyup"})(_s||(_s={}));var wu;(function(n){n.CLICK="edge:click",n.DBLCLICK="edge:dblclick",n.POINTER_OVER="edge:pointerover",n.POINTER_LEAVE="edge:pointerleave",n.POINTER_ENTER="edge:pointerenter",n.POINTER_MOVE="edge:pointermove",n.POINTER_OUT="edge:pointerout",n.POINTER_DOWN="edge:pointerdown",n.POINTER_UP="edge:pointerup",n.CONTEXT_MENU="edge:contextmenu",n.DRAG_ENTER="edge:dragenter",n.DRAG_OVER="edge:dragover",n.DRAG_LEAVE="edge:dragleave",n.DROP="edge:drop"})(wu||(wu={}));var Mt;(function(n){n.BEFORE_CANVAS_INIT="beforecanvasinit",n.AFTER_CANVAS_INIT="aftercanvasinit",n.BEFORE_SIZE_CHANGE="beforesizechange",n.AFTER_SIZE_CHANGE="aftersizechange",n.BEFORE_ELEMENT_CREATE="beforeelementcreate",n.AFTER_ELEMENT_CREATE="afterelementcreate",n.BEFORE_ELEMENT_UPDATE="beforeelementupdate",n.AFTER_ELEMENT_UPDATE="afterelementupdate",n.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",n.AFTER_ELEMENT_DESTROY="afterelementdestroy",n.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",n.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",n.BEFORE_DRAW="beforedraw",n.AFTER_DRAW="afterdraw",n.BEFORE_RENDER="beforerender",n.AFTER_RENDER="afterrender",n.BEFORE_ANIMATE="beforeanimate",n.AFTER_ANIMATE="afteranimate",n.BEFORE_LAYOUT="beforelayout",n.AFTER_LAYOUT="afterlayout",n.BEFORE_STAGE_LAYOUT="beforestagelayout",n.AFTER_STAGE_LAYOUT="afterstagelayout",n.BEFORE_TRANSFORM="beforetransform",n.AFTER_TRANSFORM="aftertransform",n.BATCH_START="batchstart",n.BATCH_END="batchend",n.BEFORE_DESTROY="beforedestroy",n.AFTER_DESTROY="afterdestroy",n.BEFORE_RENDERER_CHANGE="beforerendererchange",n.AFTER_RENDERER_CHANGE="afterrendererchange"})(Mt||(Mt={}));var ja;(function(n){n.UNDO="undo",n.REDO="redo",n.CANCEL="cancel",n.ADD="add",n.CLEAR="clear",n.CHANGE="change"})(ja||(ja={}));var Ti;(function(n){n.CLICK="node:click",n.DBLCLICK="node:dblclick",n.POINTER_OVER="node:pointerover",n.POINTER_LEAVE="node:pointerleave",n.POINTER_ENTER="node:pointerenter",n.POINTER_MOVE="node:pointermove",n.POINTER_OUT="node:pointerout",n.POINTER_DOWN="node:pointerdown",n.POINTER_UP="node:pointerup",n.CONTEXT_MENU="node:contextmenu",n.DRAG_START="node:dragstart",n.DRAG="node:drag",n.DRAG_END="node:dragend",n.DRAG_ENTER="node:dragenter",n.DRAG_OVER="node:dragover",n.DRAG_LEAVE="node:dragleave",n.DROP="node:drop"})(Ti||(Ti={}));const tn="combo",$a="tree";var Ts;(function(n){n.NODE="node",n.EDGE="edge",n.COMBO="combo",n.THEME="theme",n.PALETTE="palette",n.LAYOUT="layout",n.BEHAVIOR="behavior",n.PLUGIN="plugin",n.ANIMATION="animation",n.TRANSFORM="transform",n.SHAPE="shape"})(Ts||(Ts={}));const hp={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function ba(n,e){var r;const t=(r=hp[n])==null?void 0:r[e];if(t)return t}function Uz(n){return EXTENSION_REGISTRY[n]}const iO="5.0.17",aO="G6";function Ea(n){return`[${aO} v${iO}] ${n}`}const Lr={mute:!1,debug:n=>{!Lr.mute&&console.debug(Ea(n))},info:n=>{!Lr.mute&&console.info(Ea(n))},warn:n=>{!Lr.mute&&console.warn(Ea(n))},error:n=>{!Lr.mute&&console.error(Ea(n))}};function r1(n){const{theme:e}=n;if(!e)return{};const t=ba(Ts.THEME,e);return t||(Lr.warn(`The theme of ${e} is not registered.`),{})}function fp(n,e){if(Array.isArray(n)&&n.length===0)return null;const t=Array.isArray(n)?n[0]:n,r=Array.isArray(n)?n.slice(1):e||[];return new Proxy(t,{get(i,a){return typeof i[a]=="function"&&!["onframe","onfinish"].includes(a)?(...o)=>{i[a](...o),r.forEach(s=>{var l;return(l=s[a])==null?void 0:l.call(s,...o)})}:a==="finished"?Promise.all([t.finished,...r.map(o=>o.finished)]):Reflect.get(i,a)},set(i,a,o){return["onframe","onfinish"].includes(a)||r.forEach(s=>{s[a]=o}),Reflect.set(i,a,o)}})}function dp(n){const e=n.reduce((r,i)=>(Object.entries(i).forEach(([a,o])=>{r[a]===void 0?r[a]=[o]:r[a].push(o)}),r),{});Object.entries(e).forEach(([r,i])=>{(i.length!==n.length||i.some(a=>pt(a))||i.every(a=>!["sourceNode","targetNode","childrenNode"].includes(r)&&un(a,i[0])))&&delete e[r]});const t=Object.entries(e).reduce((r,[i,a])=>(a.forEach((o,s)=>{r[s]?r[s][i]=o:r[s]={[i]:o}}),r),[]);return n.length!==0&&t.length===0&&t.push({_:0},{_:0}),t}function Su(n){switch(n){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function i1(n,e){const{animation:t}=n;if(t===!1||e===!1)return!1;const r=at({},nO);return Ye(t)&&Object.assign(r,t),Ye(e)&&Object.assign(r,e),r}function oO(n){if(typeof n=="string"){const e=ba(Ts.ANIMATION,n);return e||(Lr.warn(`The animation of ${n} is not registered.`),[])}return n}function sO(n,e,t,r){var u,h;const{animation:i}=n,a=(u=n==null?void 0:n[e])==null?void 0:u.animation;if(a===!1)return[];const o=a==null?void 0:a[t];if(o===!1)return[];if(i===!1||r===!1)return[];const s=(h=r1(n)[e])==null?void 0:h.animation,l=(f=[])=>oO(f).map(d=>at(at(at(at({},rO),Ye(i)&&i),d),Ye(r)&&r));if(o)return l(o);if(!s)return[];const c=s[t];return c===!1?[]:l(c)}var lO=function(n){if(!cp(n)||!ls(n,"Object"))return!1;if(Object.getPrototypeOf(n)===null)return!0;for(var e=n;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e},Ps=lO,cO=5;function uO(n,e){if(Object.hasOwn)return Object.hasOwn(n,e);if(n==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(n),e)}function a1(n,e,t,r){t=t||0,r=r||cO;for(var i in e)if(uO(e,i)){var a=e[i];a!==null&&Ps(a)?(Ps(n[i])||(n[i]={}),t<r?a1(n[i],a,t+1,r):n[i]=e[i]):tr(a)?(n[i]=[],n[i]=n[i].concat(a)):a!==void 0&&(n[i]=a)}}var hO=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r+=1)a1(n,e[r]);return n},Pi=hO;function it(n){if(n.id!==void 0)return n.id;if(n.source!==void 0&&n.target!==void 0)return`${n.source}-${n.target}`;throw new Error(Ea("The datum does not have available id."))}function pp(n){return n.combo}function o1(n,e){const t={nodes:(n.nodes||[]).map(it),edges:(n.edges||[]).map(it),combos:(n.combos||[]).map(it)};return e?Object.values(t).flat():t}function vp(n,e,t,r){const i=r?r.replace(/translate(3d)?\([^)]*\)/g,""):"";return t===0?`translate(${n}, ${e})${i}`:`translate3d(${n}, ${e}, ${t})${i}`}const Ll=(n,e,t,r,i=!1)=>{const a=it(r),o=`${t}s`,s=n.add[o].get(a)||n.update[o].get(a)||n.remove[o].get(a)||r;Object.entries(n).forEach(([l,c])=>{e===l?c[o].set(a,i?Pi(s,r):s):c[o].delete(a)})},fO=(n,e,t)=>{if(!t.length)return null;const[r,i]=e,a=c=>{var u;if(c){const h=n.getShape(c);if(!h)return null;const f=`get${Eu(c)}Style`,d=((u=n==null?void 0:n[f])==null?void 0:u.bind(n))||(g=>g),p=(d==null?void 0:d(r))||{},v=(d==null?void 0:d(i))||{};return{shape:h,fromStyle:p,toStyle:v}}else return{shape:n,fromStyle:r,toStyle:i}};let o;const s=t.map(d=>{var p=d,{fields:c,shape:u,states:h}=p,f=Ce(p,["fields","shape","states"]);const v=a(u);if(!v)return null;const{shape:g,fromStyle:m,toStyle:x}=v,S=[{},{}];if(c.forEach(b=>{var y,E;Object.assign(S[0],{[b]:(y=m[b])!=null?y:Su(b)}),Object.assign(S[1],{[b]:(E=x[b])!=null?E:Su(b)})}),S.some(b=>Object.keys(b).some(y=>["x","y","z"].includes(y)))){const{x:b=0,y=0,z:E=0,transform:w=""}=g.attributes||{};S.forEach(C=>{C.transform=vp(C.x||b,C.y||y,C.z||E,w)})}const T=g.animate(dp(S),f);return u===void 0&&(o=T),T}).filter(Boolean),l=o||(s==null?void 0:s[0]);return l?fp(l,s.filter(c=>c!==c)):null},dO=[{fields:["opacity"]}],pO=[{fields:["x","y"]}],s1=[{fields:["x","y"]}],vO=s1,l1=[{fields:["sourceNode","targetNode"]}],gO=l1,c1=[{fields:["childrenNode","x","y"]}],mO=c1,Vz=[{fields:["childrenNode","x","y"]}];function Ms(n,e,t){const r=new Map(n.map(h=>[t(h),h])),i=new Map(e.map(h=>[t(h),h])),a=new Set(r.keys()),o=new Set(i.keys()),s=[],l=[],c=[],u=[];return o.forEach(h=>{a.has(h)?un(r.get(h),i.get(h))?u.push(i.get(h)):l.push(i.get(h)):s.push(i.get(h))}),a.forEach(h=>{o.has(h)||c.push(r.get(h))}),{enter:s,exit:c,keep:u,update:l}}function yO(n,e,t){const r={},i=a=>(a in r||(r[a]=0),`${e}-${a}-${r[a]++}`);return t.map(a=>typeof a=="string"?{type:a,key:i(a)}:typeof a=="function"?a.call(n):a.key?a:_e(at({},a),{key:i(a.type)}))}class gp{constructor(e){k(this,"context");k(this,"extensions",[]);k(this,"extensionMap",{});this.context=e}setExtensions(e){const t=yO(this.context.graph,this.category,e),{enter:r,update:i,exit:a,keep:o}=Ms(this.extensions,t,s=>s.key);this.createExtensions(r),this.updateExtensions([...i,...o]),this.destroyExtensions(a),this.extensions=t}createExtension(e){const{category:t}=this,{key:r,type:i}=e,a=ba(t,i);if(!a)return Lr.warn(`The extension ${i} of ${t} is not registered.`);const o=new a(this.context,e);this.extensionMap[r]=o}createExtensions(e){e.forEach(t=>this.createExtension(t))}updateExtension(e){const{key:t}=e,r=this.extensionMap[t];r&&r.update(e)}updateExtensions(e){e.forEach(t=>this.updateExtension(t))}destroyExtension(e){const t=this.extensionMap[e];t&&(t.destroy(),delete this.extensionMap[e])}destroyExtensions(e){e.forEach(({key:t})=>this.destroyExtension(t))}destroy(){Object.values(this.extensionMap).forEach(e=>e.destroy()),this.context={},this.extensions=[],this.extensionMap={}}}class mp{constructor(e,t){k(this,"context");k(this,"options");k(this,"events",[]);k(this,"destroyed",!1);this.context=e,this.options=t}update(e){this.options=Object.assign(this.options,e)}destroy(){this.context={},this.options={},this.destroyed=!0}}class Mi extends mp{}var jt=function(n){return typeof n=="function"},yp=function(n){if(typeof n!="object"||n===null)return n;var e;if(tr(n)){e=[];for(var t=0,r=n.length;t<r;t++)typeof n[t]=="object"&&n[t]!=null?e[t]=yp(n[t]):e[t]=n[t]}else{e={};for(var i in n)typeof n[i]=="object"&&n[i]!=null?e[i]=yp(n[i]):e[i]=n[i]}return e},_u=yp;function xO(n){return"source"in n&&"target"in n}function bO(n){return n.length===2}function Hz(n){return n.length===3}function Cs(n){return n instanceof Float32Array?!0:Array.isArray(n)&&(n.length===2||n.length===3)?n.every(e=>typeof e=="number"):!1}function na(n,e,t){return n>=e&&n<=t}function Os(n=0){if(Array.isArray(n)){const[e=0,t=e,r=e,i=t]=n;return[e,t,r,i]}return[n,n,n,n]}function ra(n){return n.max[0]-n.min[0]}function ia(n){return n.max[1]-n.min[1]}function Ka(n){return[ra(n),ia(n)]}function Za(n,e){const t=Cs(n)?EO(n):n.getShape("key").getBounds();return e?Tu(t,e):t}function EO(n){const[e,t,r=0]=n,i=new Fe;return i.setMinMax([e,t,r],[e,t,r]),i}function Tu(n,e){const[t,r,i,a]=Os(e),[o,s,l]=n.min,[c,u,h]=n.max,f=new Fe;return f.setMinMax([o-a,s-t,l],[c+r,u+i,h]),f}function Il(n){if(n.length===0)return new Fe;if(n.length===1)return n[0];const e=new Fe;e.setMinMax(n[0].min,n[0].max);for(let t=1;t<n.length;t++){const r=n[t];e.setMinMax([Math.min(e.min[0],r.min[0]),Math.min(e.min[1],r.min[1]),Math.min(e.min[2],r.min[2])],[Math.max(e.max[0],r.max[0]),Math.max(e.max[1],r.max[1]),Math.max(e.max[2],r.max[2])])}return e}function wa(n,e){return na(n[0],e.min[0],e.max[0])&&na(n[1],e.min[1],e.max[1])}function u1(n,e,t=!1){const{min:[r,i],max:[a,o]}=e,s=(n[1]===i||n[1]===o)&&(t||na(n[0],r,a)),l=(n[0]===r||n[0]===a)&&(t||na(n[1],i,o));return s||l}function wO(n,e){return!wa(n,e)}function Pu(n,e){const[t,r]=e,[i,a]=n.min,[o,s]=n.max,l=t-i,c=o-t,u=r-a,h=s-r,f=Math.min(l,c,u,h);return f===l?"left":f===c?"right":f===u?"top":f===h?"bottom":"left"}function xp(n,e){const t=_u(e);if(wa(e,n))switch(Pu(n,e)){case"left":t[0]=n.min[0];break;case"right":t[0]=n.max[0];break;case"top":t[1]=n.min[1];break;case"bottom":t[1]=n.max[1];break}else{const[r,i]=e,[a,o]=n.min,[s,l]=n.max;t[0]=na(r,a,s)?r:r<a?a:s,t[1]=na(i,o,l)?i:i<o?o:l}return t}function SO(n,e){const{center:t}=n,[r,i]=Ka(n),a=e==="up"||e==="down"?t[0]:e==="right"?t[0]-r/6:t[0]+r/6,o=e==="left"||e==="right"?t[1]:e==="down"?t[1]-i/6:t[1]+i/6;return[a,o]}function _O(n,e){let[t,r]=Ka(n);return[t,r]=e==="up"||e==="down"?[t,r]:[r,t],(pi(r,2)-pi(Math.sqrt(pi(t/2,2)+pi(r,2))-t/2,2))/(2*r)}function TO(n){const{min:[e,t],max:[r,i]}=n,a=[e,i],o=[r,i],s=[r,t],l=[e,t];return[[a,o],[o,s],[s,l],[l,a]]}const h1=[0,0,0];function ge(n,e){return n.map((t,r)=>t+e[r])}function Nn(n,e){return n.map((t,r)=>t-e[r])}function bp(n,e){return typeof e=="number"?n.map(t=>t*e):n.map((t,r)=>t*e[r])}function As(n,e){return typeof e=="number"?n.map(t=>t/e):n.map((t,r)=>t/e[r])}function Yz(n,e){return n.reduce((t,r,i)=>t+r*e[i],0)}function PO(n,e){const t=Bl(n),r=Bl(e);return[t[1]*r[2]-t[2]*r[1],t[2]*r[0]-t[0]*r[2],t[0]*r[1]-t[1]*r[0]]}function qa(n,e){return n.map(t=>t*e)}function Ci(n,e){return Math.sqrt(n.reduce((t,r,i)=>t+pi(r-e[i]||0,2),0))}function Mu(n,e){return n.reduce((t,r,i)=>t+Math.abs(r-e[i]),0)}function Sa(n){const e=n.reduce((t,r)=>t+pi(r,2),0);return n.map(t=>t/Math.sqrt(e))}function Ep(n,e,t=!1){const r=n[0]*e[1]-n[1]*e[0];let i=Math.acos(bp(n,e).reduce((a,o)=>a+o,0)/(Ci(n,h1)*Ci(e,h1)));return t&&r<0&&(i=2*Math.PI-i),i}function Xz(n,e){return n.every((t,r)=>t===e[r])}function Cu(n,e=!0){return e?[-n[1],n[0]]:[n[1],-n[0]]}function MO(n,e){return n.map(t=>t%e)}function Dl(n){return[n[0],n[1]]}function Bl(n){return bO(n)?[n[0],n[1],0]:n}function f1(n,e){const[t,r]=n,[i,a]=e,o=Nn(t,r),s=Nn(i,a);return PO(o,s).every(l=>l===0)}function wp(n,e,t=!1){if(f1(n,e))return;const[r,i]=n,[a,o]=e,s=((r[0]-a[0])*(a[1]-o[1])-(r[1]-a[1])*(a[0]-o[0]))/((r[0]-i[0])*(a[1]-o[1])-(r[1]-i[1])*(a[0]-o[0])),l=o[0]-a[0]?(r[0]-a[0]+s*(i[0]-r[0]))/(o[0]-a[0]):(r[1]-a[1]+s*(i[1]-r[1]))/(o[1]-a[1]);if(!(!t&&(!na(s,0,1)||!na(l,0,1))))return[r[0]+s*(i[0]-r[0]),r[1]+s*(i[1]-r[1])]}function d1(n){if(Array.isArray(n))return na(n[0],0,1)&&na(n[1],0,1)?n:[.5,.5];const e=n.split("-"),t=e.includes("left")?0:e.includes("right")?1:.5,r=e.includes("top")?0:e.includes("bottom")?1:.5;return[t,r]}function Ui(n){const{x:e=0,y:t=0,z:r=0}=n.style||{};return[+e,+t,+r]}function p1(n,e){const[t,r]=e,{min:i,max:a}=n;return[i[0]+t*(a[0]-i[0]),i[1]+r*(a[1]-i[1])]}function _a(n,e="center"){const t=d1(e);return p1(n,t)}function jz(n,e){const t=parseAnchor(e);return p1(n,t)}const $z=n=>{const[e,t]=n;return{left:Math.min(e[0],t[0]),right:Math.max(e[0],t[0]),top:Math.min(e[1],t[1]),bottom:Math.max(e[1],t[1])}};function Ir(n){var e;return[n.x,n.y,(e=n.z)!=null?e:0]}function Fo(n){var e;return{x:n[0],y:n[1],z:(e=n[2])!=null?e:0}}function Kz(n){return n.sort((e,t)=>e[0]-t[0]||e[1]-t[1])}function Zz(n){const e=new Set;return n.filter(t=>{const r=t.join(",");return e.has(r)?!1:(e.add(r),!0)})}function Fl(n,e=0){return n.map(t=>parseFloat(t.toFixed(e)))}function Ja(n,e,t,r=!1){const i=r?Nn(n,e):Nn(e,n),a=Sa(i),o=[a[0]*t,a[1]*t];return ge(Dl(n),o)}function v1(n,e){return n[1]===e[1]}function CO(n,e){return n[0]===e[0]}function OO(n,e){return v1(n,e)||CO(n,e)}function AO(n,e,t){return f1([n,e],[e,t])}function g1(n,e,t,r=!0){for(let i=0;i<t.length;i++){let a=t[i],o=t[(i+1)%t.length];r&&(a=ge(e,a),o=ge(e,o));const s=wp([e,n],[a,o]);if(s)return{point:s,line:[a,o]}}return{point:e,line:void 0}}function NO(n,e,t,r){const i=n[0],a=n[1];let o=!1;t===void 0&&(t=0),r===void 0&&(r=e.length);const s=r-t;for(let l=0,c=s-1;l<s;c=l++){const u=e[l+t][0],h=e[l+t][1],f=e[c+t][0],d=e[c+t][1];h>a!=d>a&&i<(f-u)*(a-h)/(d-h)+u&&(o=!o)}return o}function RO(n,e){const t=_a(e,"center"),r=[_a(e,"left-top"),_a(e,"right-top"),_a(e,"right-bottom"),_a(e,"left-bottom")];return g1(n,t,r,!1).point}function Ou(n,e){const t=e.center,r=Nn(n,e.center),i=Math.atan2(r[1],r[0]);if(isNaN(i))return t;const a=ra(e)/2,o=ia(e)/2,s=t[0]+a*Math.cos(i),l=t[1]+o*Math.sin(i);return[s,l]}function kO(n,e){let t=1/0,r=[n[0],e[0]];return n.forEach(i=>{e.forEach(a=>{const o=Ci(i,a);o<t&&(t=o,r=[i,a])})}),r}function LO(n,e){let t=1/0,r=[[0,0],[0,0]];return e.forEach(i=>{const a=IO(n,i);a<t&&(t=a,r=i)}),r}function IO(n,e){const t=m1(n,e);return Ci(n,t)}function m1(n,e){const[t,r]=e[0],[i,a]=e[1],[o,s]=n,l=i-t,c=a-r;if(l===0&&c===0)return[t,r];let u=((o-t)*l+(s-r)*c)/(l*l+c*c);u>1?u=1:u<0&&(u=0);const h=t+u*l,f=r+u*c;return[h,f]}function DO(n){const e=n.reduce((t,r)=>ge(t,r),[0,0]);return As(e,n.length)}function y1(n,e=!0){const t=DO(n);return n.sort(([r,i],[a,o])=>{const s=Math.atan2(i-t[1],r-t[0]),l=Math.atan2(o-t[1],a-t[0]);return e?l-s:s-l})}function x1(n,e){return[n,[n[0],e[1]],e,[e[0],n[1]]]}const b1=n=>n.map(e=>qt(e)?e.toLocaleLowerCase():e);class Ns{constructor(e){k(this,"map",new Map);k(this,"emitter");k(this,"recordKey",new Set);k(this,"onKeyDown",e=>{e!=null&&e.key&&(this.recordKey.add(e.key),this.trigger(e))});k(this,"onKeyUp",e=>{e!=null&&e.key&&this.recordKey.delete(e.key)});k(this,"onWheel",e=>{this.triggerExtendKey(ht.WHEEL,e)});k(this,"onDrag",e=>{this.triggerExtendKey(ht.DRAG,e)});k(this,"onFocus",()=>{this.recordKey.clear()});this.emitter=e,this.bindEvents()}bind(e,t){e.length!==0&&this.map.set(e,t)}unbind(e,t){this.map.forEach((r,i)=>{un(i,e)&&(!t||t===r)&&this.map.delete(i)})}unbindAll(){this.map.clear()}match(e){const t=b1(Array.from(this.recordKey)).sort(),r=b1(e).sort();return un(t,r)}bindEvents(){const{emitter:e}=this;e.on(ht.KEY_DOWN,this.onKeyDown),e.on(ht.KEY_UP,this.onKeyUp),e.on(ht.WHEEL,this.onWheel),e.on(ht.DRAG,this.onDrag),window.addEventListener("focus",this.onFocus)}trigger(e){this.map.forEach((t,r)=>{this.match(r)&&t(e)})}triggerExtendKey(e,t){this.map.forEach((r,i)=>{i.includes(e)&&un(Array.from(this.recordKey),i.filter(a=>a!==e))&&r(t)})}destroy(){this.unbindAll(),this.emitter.off(ht.KEY_DOWN,this.onKeyDown),this.emitter.off(ht.KEY_UP,this.onKeyUp),this.emitter.off(ht.WHEEL,this.onWheel),this.emitter.off(ht.DRAG,this.onDrag),window.removeEventListener("blur",this.onFocus)}}const gg=class extends Mi{constructor(t,r){super(t,Pi({},gg.defaultOptions,r));k(this,"startPoint");k(this,"endPoint");k(this,"rectShape");k(this,"shortcut");this.shortcut=new Ns(t.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(t){if(!this.validate(t)||!this.isKeydown()||this.startPoint)return;const{canvas:r,graph:i}=this.context,a=at({},this.options.style);this.options.style.lineWidth&&(a.lineWidth=+this.options.style.lineWidth/i.getZoom()),this.rectShape=new ea({id:"g6-brush-select",style:a}),r.appendChild(this.rectShape),this.startPoint=[t.canvas.x,t.canvas.y]}onPointerMove(t){var a;if(!this.startPoint)return;const{immediately:r,mode:i}=this.options;this.endPoint=Au(t),(a=this.rectShape)==null||a.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),r&&i==="default"&&this.updateElementsStates(x1(this.startPoint,this.endPoint))}onPointerUp(t){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=Au(t),this.updateElementsStates(x1(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){const{graph:t}=this.context,r=Object.values(t.getData()).reduce((i,a)=>Object.assign({},i,a.reduce((o,s)=>(o[it(s)]=[],o),{})),{});t.setElementState(r,this.options.animation)}updateElementsStates(t){const{graph:r}=this.context,{enableElements:i,state:a,mode:o,onSelect:s}=this.options,l=this.selector(r,t,i);let c={};switch(o){case"union":l.forEach(u=>{c[u]=[...r.getElementState(u),a]});break;case"diff":l.forEach(u=>{const h=r.getElementState(u);c[u]=h.includes(a)?h.filter(f=>f!==a):[...h,a]});break;case"intersect":l.forEach(u=>{const h=r.getElementState(u);c[u]=h.includes(a)?[a]:[]});break;case"default":default:l.forEach(u=>{c[u]=[a]});break}jt(s)&&(c=s(c)),r.setElementState(c,this.options.animation)}selector(t,r,i){if(!i||i.length===0)return[];const a=[],o=t.getData();if(i.forEach(s=>{o[`${s}s`].forEach(l=>{const c=it(l);t.getElementVisibility(c)!=="hidden"&&NO(t.getElementPosition(c),r)&&a.push(c)})}),i.includes("edge")){const s=o.edges;s==null||s.forEach(l=>{const{source:c,target:u}=l;a.includes(c)&&a.includes(u)&&a.push(it(l))})}return a}clearBrush(){var t;(t=this.rectShape)==null||t.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){const{trigger:t}=this.options,r=Array.isArray(t)?t:[t];return this.shortcut.match(r.filter(i=>i!=="drag"))}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}bindEvents(){const{graph:t}=this.context;t.on(ht.POINTER_DOWN,this.onPointerDown),t.on(ht.POINTER_MOVE,this.onPointerMove),t.on(ht.POINTER_UP,this.onPointerUp),t.on(xa.CLICK,this.clearStates)}unbindEvents(){const{graph:t}=this.context;t.off(ht.POINTER_DOWN,this.onPointerDown),t.off(ht.POINTER_MOVE,this.onPointerMove),t.off(ht.POINTER_UP,this.onPointerUp),t.off(xa.CLICK,this.clearStates)}update(t){this.unbindEvents(),this.options=Pi(this.options,t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}};let Gl=gg;k(Gl,"defaultOptions",{animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}});const Au=n=>[n.canvas.x,n.canvas.y],Ta=.8,Go=["node","edge","combo"];function Rs(n,e,t,r,i=0){r==="TB"&&e(n,i);const a=t(n);if(a)for(const o of a)Rs(o,e,t,r,i+1);r==="BT"&&e(n,i)}function BO(n,e,t){const r=[[n,0]];for(;r.length;){const[i,a]=r.shift();e(i,a);const o=t(i);if(o)for(const s of o)r.push([s,a+1])}}function E1(n,e,t,r){if(e==="combo"||e==="node")return Sp(n,t,r);const i=n.getEdgeData(t);if(!i)return[];const a=Sp(n,i.source,r-1),o=Sp(n,i.target,r-1);return Array.from(new Set([...a,...o,t]))}function Sp(n,e,t){const r=new Set,i=new Set,a=new Set;return BO(e,(o,s)=>{s>t||(a.add(o),n.getRelatedEdgesData(o).forEach(l=>{const c=it(l);!i.has(c)&&s<t&&(a.add(c),i.add(c))}))},o=>n.getRelatedEdgesData(o).map(s=>s.source===o?s.target:s.source).filter(s=>r.has(s)?!1:(r.add(s),!0))),Array.from(a)}function _p(n){return n.states||[]}const mg=class extends Mi{constructor(t,r){super(t,Object.assign({},mg.defaultOptions,r));k(this,"shortcut");k(this,"onClickSelect",t=>Ct(this,null,function*(){var r,i;this.validate(t)&&(yield this.updateState(t),(i=(r=this.options).onClick)==null||i.call(r,t))}));k(this,"onClickCanvas",t=>Ct(this,null,function*(){var r,i;this.validate(t)&&(yield this.clearState(),(i=(r=this.options).onClick)==null||i.call(r,t))}));this.shortcut=new Ns(t.graph),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Go.forEach(r=>{t.on(`${r}:${ht.CLICK}`,this.onClickSelect)}),t.on(xa.CLICK,this.onClickCanvas)}get isMultipleSelect(){const{multiple:t,trigger:r}=this.options;return t&&this.shortcut.match(r)}getNeighborIds(t){const{target:r,targetType:i}=t,{graph:a}=this.context,{degree:o}=this.options;return E1(a,i,r.id,typeof o=="function"?o(t):o).filter(s=>s!==r.id)}updateState(t){return Ct(this,null,function*(){const{state:r,unselectedState:i,neighborState:a,animation:o}=this.options;if(!r&&!a&&!i)return;const{target:s}=t,{graph:l}=this.context,c=l.getElementData(s.id),u=_p(c).includes(r)?"unselect":"select",h={},f=this.isMultipleSelect,d=[s.id],p=this.getNeighborIds(t);if(f)if(Object.assign(h,this.getDataStates()),u==="select"){const v=(g,m)=>{g.forEach(x=>{const S=new Set(l.getElementState(x));S.add(m),S.delete(i),h[x]=Array.from(S)})};v(d,r),v(p,a),i&&Object.keys(h).forEach(g=>{const m=h[g];!m.includes(r)&&!m.includes(a)&&!m.includes(i)&&h[g].push(i)})}else{const v=h[s.id];h[s.id]=v.filter(g=>g!==r&&g!==a),v.includes(i)||h[s.id].push(i),p.forEach(g=>{h[g]=h[g].filter(m=>m!==a),h[g].includes(r)||h[g].push(i)})}else if(u==="select"){Object.assign(h,this.getClearStates(!!i));const v=(g,m)=>{g.forEach(x=>{h[x]||(h[x]=l.getElementState(x)),h[x].push(m)})};v(d,r),v(p,a),i&&Object.keys(h).forEach(g=>{!d.includes(g)&&!p.includes(g)&&h[g].push(i)})}else Object.assign(h,this.getClearStates());yield l.setElementState(h,o)})}getDataStates(){const{graph:t}=this.context,{nodes:r,edges:i,combos:a}=t.getData(),o={};return[...r,...i,...a].forEach(s=>{o[it(s)]=_p(s)}),o}getClearStates(t=!1){const{graph:r}=this.context,{state:i,unselectedState:a,neighborState:o}=this.options,s=new Set([i,a,o]),{nodes:l,edges:c,combos:u}=r.getData(),h={};return[...l,...c,...u].forEach(f=>{const d=_p(f),p=d.filter(v=>!s.has(v));(t||p.length!==d.length)&&(h[it(f)]=p)}),h}clearState(){return Ct(this,null,function*(){const{graph:t}=this.context;yield t.setElementState(this.getClearStates(),this.options.animation)})}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}unbindEvents(){const{graph:t}=this.context;Go.forEach(r=>{t.off(`${r}:${ht.CLICK}`,this.onClickSelect)}),t.off(xa.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}};let Nu=mg;k(Nu,"defaultOptions",{animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0});function ri(n){var e;return!!((e=n.style)!=null&&e.collapsed)}var gr=function(n,e,t){for(var r=0,i=qt(e)?e.split("."):e;n&&r<i.length;)n=n[i[r++]];return n===void 0||r<i.length?t:n},zl=function(n,e,t){var r=n,i=qt(e)?e.split("."):e;return i.forEach(function(a,o){o<i.length-1?(Ye(r[a])||(r[a]=te(i[o+1])?[]:{}),r=r[a]):r[a]=t}),n},FO=function(n){var e=n1(n);return e.charAt(0).toLowerCase()+e.substring(1)},GO=FO;function Wl(n,e){if(!n.startsWith(e))return!1;const t=n[e.length];return t>="A"&&t<="Z"}function w1(n,e){return`${e}${Eu(n)}`}function S1(n,e,t=!0){if(!e||!Wl(n,e))return n;const r=n.slice(e.length);return t?GO(r):r}function Rn(n,e){const t=Object.entries(n).reduce((r,[i,a])=>(i==="className"||i==="class"||Wl(i,e)&&Object.assign(r,{[S1(i,e)]:a}),r),{});if("opacity"in n){const r=w1("opacity",e),i=n.opacity;if(r in n){const a=n[r];Object.assign(t,{opacity:i*a})}else Object.assign(t,{opacity:i})}return t}function Tp(n,e){const t=e.length;return Object.keys(n).reduce((r,i)=>{if(i.startsWith(e)){const a=i.slice(t);r[a]=n[i]}return r},{})}function Pp(n,e){const t=typeof e=="string"?[e]:e,r={};return Object.keys(n).forEach(i=>{t.find(a=>i.startsWith(a))||(r[i]=n[i])}),r}function qz(n,e,t){return Object.entries(n).reduce((r,[i,a])=>(Wl(i,e)?r[w1(S1(i,e,!1),t)]=a:r[i]=a,r),{})}function Pa(n=0){if(typeof n=="number")return[n,n,n];const[e,t=e,r=e]=n;return[e,t,r]}function _1(n,e){const{datum:t,graph:r}=e;return typeof n=="function"?n.call(r,t):Object.fromEntries(Object.entries(n).map(([i,a])=>typeof a=="function"?[i,a.call(r,t)]:[i,a]))}function Vn(n,e){const t=(n==null?void 0:n.style)||{},r=(e==null?void 0:e.style)||{};return Object.assign({},n,e,{style:Object.assign({},t,r)})}function zO(n){const f=n,{x:e,y:t,z:r,class:i,className:a,transform:o,transformOrigin:s,context:l,zIndex:c,visibility:u}=f;return Ce(f,["x","y","z","class","className","transform","transformOrigin","context","zIndex","visibility"])}const ks="cachedStyle",Ru=n=>`__${n}__`;function T1(n,e){const t=Array.isArray(e)?e:[e];gr(n,ks)||zl(n,ks,{}),t.forEach(r=>{zl(gr(n,ks),Ru(r),n.attributes[r])})}function ku(n,e){return gr(n,[ks,Ru(e)])}function P1(n,e){return Ru(e)in(gr(n,ks)||{})}function M1(n,e,t){zl(n,[ks,Ru(e)],t)}function ii(n){return function(e,t,r){const i=r.value;return r.value=function(a,...o){const s=`${t}_invoke`;if(!ku(this,s))return M1(this,s,!0),i.call(this,a,...o);const l=`${t}_style`,c=ku(this,l),u=n(this,a);return M1(this,l,u),C1(c,u)?null:i.call(this,a,...o)},r}}const C1=(n,e,t=2)=>{if(typeof n!="object"||typeof e!="object")return n===e;const r=Object.keys(n),i=Object.keys(e);if(r.length!==i.length)return!1;for(const a of r){const o=n[a],s=e[a];if(t>1&&typeof o=="object"&&typeof s=="object"){if(!C1(o,s,t-1))return!1}else if(o!==s)return!1}return!0};function WO(n,e){const t=Pa(n);let r={};return e.text&&!e.fontSize&&(r={fontSize:Math.min(...t)*.5}),e.src&&(!e.width||!e.height)&&(r={width:t[0]*.5,height:t[1]*.5}),r}var UO=Object.prototype.hasOwnProperty;function VO(n,e){if(!e||!tr(n))return{};for(var t={},r=jt(e)?e:function(s){return s[e]},i,a=0;a<n.length;a++){var o=n[a];i=r(o),UO.call(t,i)?t[i].push(o):t[i]=[o]}return t}var Mp=VO;function O1(n){if(n)return typeof n=="string"||typeof n=="function"||Array.isArray(n)?{type:"group",field:e=>e.id,color:n,invert:!1}:n}function HO(n,e){if(!e)return{};const{type:t,color:r,field:i,invert:a}=e,o=l=>{const c=typeof r=="string"?ba("palette",r):r;if(typeof c=="function"){const u={};return l.forEach(([h,f])=>{u[h]=c(a?1-f:f)}),u}else if(Array.isArray(c)){const u=a?[...c].reverse():c,h={};return l.forEach(([f,d])=>{h[f]=u[d%c.length]}),h}return{}},s=(l,c)=>{var u;return typeof l=="string"?(u=c.data)==null?void 0:u[l]:l==null?void 0:l(c)};if(t==="group"){const l=Mp(n,f=>{if(!i)return"default";const d=s(i,f);return d?String(d):"default"}),c=Object.keys(l),u=o(c.map((f,d)=>[f,d])),h={};return Object.entries(l).forEach(([f,d])=>{d.forEach(p=>{h[it(p)]=u[f]})}),h}else if(t==="value"){const[l,c]=n.reduce(([h,f],d)=>{const p=s(i,d);if(typeof p!="number")throw new Error(Ea(`Palette field ${i} is not a number`));return[Math.min(h,p),Math.max(f,p)]},[1/0,-1/0]),u=c-l;return o(n.map(h=>[h.id,(s(i,h)-l)/u]))}}function A1(n){const e=typeof n=="string"?ba("palette",n):n;if(typeof e!="function")return e}function N1(n,e){let t=2*n;return typeof e=="string"?t=n*Number(e.replace("%",""))/100:typeof e=="number"&&(t=e),isNaN(t)&&(t=2*n),t}function R1(n,e,t=1,r=!1){const i=r?t:1,a=(n.max[0]-n.min[0])*i;return N1(a,e)}function YO(n,e,t=1){const r=Ci(n[0],n[1])*t;return N1(r,e)}const Ul=new WeakMap;function Vl(n,e,t=!1,r){if(e===void 0)return;const i=(a,o=e)=>{const s=(l=o)=>a.childNodes.forEach(c=>i(c,l));if(r&&!r(a))return s();if(!t&&a===n)n.style.visibility=e,Ul.delete(n),s(e);else{Ul.has(a)||Ul.set(a,a.style.visibility);const l=o==="hidden"||XO(a)==="hidden"?"hidden":"visible";a.style.visibility=l,s(l)}};i(n)}function XO(n){return Ul.has(n)?Ul.get(n):n.style.visibility}var jO={}.toString,$O=function(n){return jO.call(n).replace(/^\[object /,"").replace(/]$/,"")},KO=$O,ZO=Object.prototype,qO=function(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||ZO;return n===t},JO=qO,QO=Object.prototype.hasOwnProperty;function tA(n){if(pt(n))return!0;if(kl(n))return!n.length;var e=KO(n);if(e==="Map"||e==="Set")return!n.size;if(JO(n))return!Object.keys(n).length;for(var t in n)if(QO.call(n,t))return!1;return!0}var Cp=tA;class Hl extends $M{constructor(t){super(t);k(this,"shapeMap",{});k(this,"animateMap",{});this.transformPosition(this.attributes),this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(t,r,i,a,o){var c,u,h,f,d,p,v,g;const s=this.shapeMap[t];if(i===!1){s&&((c=o==null?void 0:o.beforeDestroy)==null||c.call(o,s),a.removeChild(s),delete this.shapeMap[t],(u=o==null?void 0:o.afterDestroy)==null||u.call(o,s));return}const l=typeof r=="string"?ba(Ts.SHAPE,r):r;if(!l)throw new Error(Ea(`Shape ${r} not found`));if(!s||s.destroyed||!(s instanceof l)){s&&((h=o==null?void 0:o.beforeDestroy)==null||h.call(o,s),s==null||s.destroy(),(f=o==null?void 0:o.afterDestroy)==null||f.call(o,s)),(d=o==null?void 0:o.beforeCreate)==null||d.call(o);const m=new l({className:t,style:i});return a.appendChild(m),this.shapeMap[t]=m,(p=o==null?void 0:o.afterCreate)==null||p.call(o,m),m}return(v=o==null?void 0:o.beforeUpdate)==null||v.call(o,s),Up(s,i),(g=o==null?void 0:o.afterUpdate)==null||g.call(o,s),s}transformPosition(t){const{x:r=0,y:i=0,z:a=0,transform:o}=t;(r!==0||i!==0||a!==0)&&(this.style.transform=vp(+r,+i,+a,o))}update(t={}){const r=Object.assign({},this.attributes,t);this.attr(r),this.render(r,this),this.transformPosition(r),this.setVisibility()}bindEvents(){}getGraphicStyle(t){return zO(t)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(t,r){if(t.length===0)return null;const i=[];if(t[0].x!==void 0||t[0].y!==void 0||t[0].z!==void 0){const{x:o=0,y:s=0,z:l=0}=this.attributes;t.forEach(c=>{const{x:u=o,y:h=s,z:f=l}=c;Object.assign(c,{transform:vp(+u,+h,+f)})})}const a=super.animate(t,r);if(a&&(Op(this,a),i.push(a)),Array.isArray(t)&&t.length>0){const o=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(t[0]).some(s=>!o.includes(s))){Object.entries(this.shapeMap).forEach(([l,c])=>{const u=`get${Eu(l)}Style`,h=this[u];if(jt(h)){const f=t.map(p=>h.call(this,at(at({},this.attributes),p))),d=c.animate(dp(f),r);d&&(Op(c,d),i.push(d))}});const s=(l,c)=>{if(!Cp(l)){const u=`get${Eu(c)}Style`,h=this[u];if(jt(h)){const f=t.map(d=>h.call(this,at(at({},this.attributes),d)));Object.entries(f[0]).map(([d])=>{const p=f.map(g=>g[d]),v=l[d];if(v){const g=v.animate(dp(p),r);g&&(Op(v,g),i.push(g))}})}}};this.compositeShapes.forEach(([l,c])=>{const u=Tp(this.shapeMap,c);s(u,l)})}}return fp(i)}getShape(t){return this.shapeMap[t]}setVisibility(){const{visibility:t}=this.attributes;Vl(this,t,!0)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function Op(n,e){e==null||e.finished.then(()=>{const t=n.activeAnimations.findIndex(r=>r===e);t>-1&&n.activeAnimations.splice(t,1)})}const yg=class extends Hl{constructor(e){super(Vn({style:yg.defaultStyleProps},e))}isTextStyle(e){return Wl(e,"label")}isBackgroundStyle(e){return Wl(e,"background")}getTextStyle(e){const i=this.getGraphicStyle(e),{padding:t}=i,r=Ce(i,["padding"]);return Pp(r,"background")}getBackgroundStyle(e){if(e.background===!1)return!1;const t=this.getGraphicStyle(e),{wordWrap:r,wordWrapWidth:i,padding:a}=t,o=Rn(t,"background"),{min:[s,l],center:[c,u],halfExtents:[h,f]}=this.shapeMap.text.getGeometryBounds(),[d,p,v,g]=Os(a),m=h*2+g+p,{width:x,height:S}=o;x&&S?Object.assign(o,{x:c-Number(x)/2,y:u-Number(S)/2}):Object.assign(o,{x:s-g,y:l-d,width:r?Math.min(m,i+g+p):m,height:f*2+d+v});const{radius:T}=o;if(typeof T=="string"&&T.endsWith("%")){const b=Number(T.replace("%",""))/100;o.radius=Math.min(+o.width,+o.height)*b}return o}render(e=this.parsedAttributes,t=this){this.upsert("text",Al,this.getTextStyle(e),t),this.upsert("background",ea,this.getBackgroundStyle(e),t)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}};let Qa=yg;k(Qa,"defaultStyleProps",{padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0});const xg=class extends Hl{constructor(e){super(Vn({style:xg.defaultStyleProps},e))}getBadgeStyle(e){return this.getGraphicStyle(e)}render(e=this.parsedAttributes,t=this){this.upsert("label",Qa,this.getBadgeStyle(e),t)}getGeometryBounds(){const e=this.getShape("label");return(e.getShape("background")||e.getShape("text")).getGeometryBounds()}};let Ls=xg;k(Ls,"defaultStyleProps",{padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1});function eA(n,e=!0){const t=[];return n.forEach((r,i)=>{t.push([i===0?"M":"L",...r])}),e&&t.push(["Z"]),t}const k1={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};function nA(n){const e=n.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),t=[];let r="",i={};for(;e.length>0;){let a=e.shift();a in k1?r=a:e.unshift(a),i={type:r},k1[r].forEach(l=>{a=e.shift(),i[l]=a}),r==="M"?r="L":r==="m"&&(r="l");const[o,...s]=Object.values(i);t.push([o,...s.map(Number)])}return t}function rA(n){const e=[];return(typeof n=="string"?nA(n):n).forEach(r=>{const i=r[0];if(i==="Z"){e.push(e[0]);return}if(i!=="A")for(let a=1;a<r.length;a=a+2)e.push([r[a],r[a+1],0]);else{const a=r.length;e.push([r[a-2],r[a-1],0])}}),e}const L1=n=>{if(n.length<2)return[["M",0,0],["L",0,0]];const e=n[0],t=n[1],r=n[n.length-1],i=n[n.length-2];n.unshift(i,r),n.push(e,t);const a=[["M",r[0],r[1]]];for(let o=1;o<n.length-2;o+=1){const[s,l]=n[o-1],[c,u]=n[o],[h,f]=n[o+1],[d,p]=o!==n.length-2?n[o+2]:[h,f],v=c+(h-s)/6,g=u+(f-l)/6,m=h-(d-c)/6,x=f-(p-u)/6;a.push(["C",v,g,m,x,h,f])}return a};function iA(n,e,t,r,i,a,o){const[s,l]=_a(n,e),c={textAlign:e==="left"?"right":e==="right"?"left":"center",textBaseline:e==="top"?"bottom":e==="bottom"?"top":"middle",transform:`translate(${s+t}, ${l+r})`};if(e==="center"||!i)return c;const u=rA(a);if(!u||u.length<=3)return c;const h=u.map((p,v)=>{const g=p,m=u[(v+1)%u.length];return un(g,m)?null:[g,m]}).filter(Boolean),f=LO([s,l],h),d=m1([s,l],f);if(d&&f&&(c.transform=`translate(${d[0]+t}, ${d[1]+r})`,o)){const p=Math.atan((f[0][1]-f[1][1])/(f[0][0]-f[1][0]));c.transform+=`rotate(${p/Math.PI*180}deg)`,c.textAlign="center",(e==="right"||e==="left")&&(p>0?c.textBaseline=e==="right"?"bottom":"top":c.textBaseline=e==="right"?"top":"bottom")}return c}const bg=class extends Hl{constructor(e){super(Vn({style:bg.defaultStyleProps},e))}getLabelStyle(e){if(!e.label||!e.d||e.d.length===0)return!1;const h=Rn(this.getGraphicStyle(e),"label"),{maxWidth:t,offsetX:r,offsetY:i,autoRotate:a,placement:o,closeToPath:s}=h,l=Ce(h,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),c=this.shapeMap.key,u=c==null?void 0:c.getRenderBounds();return Object.assign(iA(u,o,r,i,s,e.d,a),{wordWrapWidth:R1(u,t)},l)}getKeyStyle(e){return this.getGraphicStyle(e)}render(e,t){this.upsert("key",Xa,this.getKeyStyle(e),t),this.upsert("label",Qa,this.getLabelStyle(e),t)}};let Yl=bg;k(Yl,"defaultStyleProps",{label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0});function aA(n){const e=[],t=r=>{r!=null&&r.children.length&&r.children.forEach(i=>{e.push(i),t(i)})};return t(n),e}function oA(n){const e=[];let t=n.parentNode;for(;t;)e.push(t),t=t.parentNode;return e}class Ap extends Jd{constructor(t){super(t);k(this,"onMounted",()=>{this.handleRadius()});k(this,"onAttrModified",()=>{this.handleRadius()});Is=this,this.isMutationObserved=!0,this.addEventListener(oe.MOUNTED,this.onMounted),this.addEventListener(oe.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){const{radius:t,clipPath:r,width:i=0,height:a=0}=this.attributes;if(t&&i&&a){const[o,s]=this.getBounds().min,l={x:o,y:s,radius:t,width:i,height:a};if(r)Object.assign(this.parsedStyle.clipPath.style,l);else{const c=new ea({style:l});this.style.clipPath=c}}else r&&(this.style.clipPath=null)}}const Np=new WeakMap;let Is=null;const Rp=n=>{if(Is&&oA(Is).includes(n)){const e=Np.get(n);e?e.includes(Is)||e.push(Is):Np.set(n,[Is])}},kp=n=>{const e=Np.get(n);e&&e.forEach(t=>t.handleRadius())};class I1 extends Hl{constructor(e){super(e)}isImage(){const{src:e}=this.attributes;return!!e}getIconStyle(e=this.attributes){const{width:t=0,height:r=0}=e,i=this.getGraphicStyle(e);return this.isImage()?at({x:-t/2,y:-r/2},i):at({textBaseline:"middle",textAlign:"center"},i)}render(e=this.attributes,t=this){this.upsert("icon",this.isImage()?Ap:Al,this.getIconStyle(e),t)}}class D1 extends Hl{get context(){return this.attributes.context}get parsedAttributes(){return this.attributes}onframe(){}animate(e,t){const r=super.animate(e,t);return r&&(r.onframe=()=>this.onframe(),r.finished.then(()=>this.onframe())),r}}var Ds=function(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(o=n[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};const Eg=class extends D1{constructor(t){super(Vn({style:Eg.defaultStyleProps},t));k(this,"type","node")}getSize(t=this.attributes){const{size:r}=t;return Pa(r)}getKeyStyle(t){const r=this.getGraphicStyle(t);return Object.assign(Pp(r,["label","halo","icon","badge","port"]))}getLabelStyle(t){if(t.label===!1||!t.labelText)return!1;const c=Rn(this.getGraphicStyle(t),"label"),{placement:r,maxWidth:i,offsetX:a,offsetY:o}=c,s=Ce(c,["placement","maxWidth","offsetX","offsetY"]),l=this.getShape("key").getLocalBounds();return Object.assign(rx(l,r,a,o),{wordWrapWidth:R1(l,i)},s)}getHaloStyle(t){if(t.halo===!1)return!1;const o=this.getKeyStyle(t),{fill:r}=o,i=Ce(o,["fill"]),a=Rn(this.getGraphicStyle(t),"halo");return at(_e(at({},i),{stroke:r}),a)}getIconStyle(t){if(t.icon===!1||!t.iconText&&!t.iconSrc)return!1;const r=Rn(this.getGraphicStyle(t),"icon");return Object.assign(WO(t.size,r),r)}getBadgesStyle(t){var h;const r=Tp(this.shapeMap,"badge-"),i={};if(Object.keys(r).forEach(d=>{i[d]=!1}),t.badge===!1||!((h=t.badges)!=null&&h.length))return i;const f=t,{badges:a=[],badgePalette:o,opacity:s=1}=f,l=Ce(f,["badges","badgePalette","opacity"]),c=A1(o),u=Rn(this.getGraphicStyle(l),"badge");return a.forEach((d,p)=>{i[p]=at(at({backgroundFill:c?c[p%(c==null?void 0:c.length)]:void 0,opacity:s},u),this.getBadgeStyle(d))}),i}getBadgeStyle(t){const r=this.getShape("key"),c=t,{placement:i="top",offsetX:a,offsetY:o}=c,s=Ce(c,["placement","offsetX","offsetY"]),l=rx(r.getLocalBounds(),i,a,o,!0);return at(at({},l),s)}getPortsStyle(t){var s;const r=this.getPorts(),i={};if(Object.keys(r).forEach(l=>{i[l]=!1}),t.port===!1||!((s=t.ports)!=null&&s.length))return i;const a=Rn(this.getGraphicStyle(t),"port"),{ports:o=[]}=t;return o.forEach((l,c)=>{const u=l.key||c,h=at(at({},a),l);if(tx(h))i[u]=!1;else{const[f,d]=this.getPortXY(t,l);i[u]=at({transform:`translate(${f}, ${d})`},h)}}),i}getPortXY(t,r){const{placement:i="left"}=r,a=this.getShape("key");return Gp(sA(this.context,a),i)}getPorts(){return Tp(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(t){const r=this.getShape("key").getBounds();return RO(t,r)}drawHaloShape(t,r){const i=this.getShape("key");this.upsert("halo",i.constructor,this.getHaloStyle(t),r)}drawIconShape(t,r){this.upsert("icon",I1,this.getIconStyle(t),r),Rp(this)}drawBadgeShapes(t,r){const i=this.getBadgesStyle(t);Object.keys(i).forEach(a=>{this.upsert(`badge-${a}`,Ls,i[a],r)})}drawPortShapes(t,r){const i=this.getPortsStyle(t);Object.keys(i).forEach(a=>{this.upsert(`port-${a}`,Cl,i[a],r)})}drawLabelShape(t,r){this.upsert("label",Qa,this.getLabelStyle(t),r)}_drawKeyShape(t,r){return this.drawKeyShape(t,r)}render(t=this.parsedAttributes,r=this){this._drawKeyShape(t,r),this.getShape("key")&&(this.drawHaloShape(t,r),this.drawIconShape(t,r),this.drawBadgeShapes(t,r),this.drawLabelShape(t,r),this.drawPortShapes(t,r))}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&kp(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}};let Hn=Eg;k(Hn,"defaultStyleProps",{x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0}),Ds([ii((n,e)=>n.getHaloStyle(e))],Hn.prototype,"drawHaloShape",null),Ds([ii((n,e)=>n.getIconStyle(e))],Hn.prototype,"drawIconShape",null),Ds([ii((n,e)=>n.getBadgesStyle(e))],Hn.prototype,"drawBadgeShapes",null),Ds([ii((n,e)=>n.getPortsStyle(e))],Hn.prototype,"drawPortShapes",null),Ds([ii((n,e)=>n.getLabelStyle(e))],Hn.prototype,"drawLabelShape",null),Ds([ii((n,e)=>n.getKeyStyle(e))],Hn.prototype,"_drawKeyShape",null);function sA(n,e){if(!n)return e.getLocalBounds();const t=n.canvas.getLayer(),r=e.cloneNode();Vl(r,"hidden"),t.appendChild(r);const i=r.getLocalBounds();return t.removeChild(r),i}const wg=class extends Hn{constructor(e){super(Vn({style:wg.defaultStyleProps},e))}drawKeyShape(e,t){return this.upsert("key",Cl,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e);return _e(at({},t),{r:Math.min(...this.getSize(e))/2})}getIconStyle(e){const t=super.getIconStyle(e),{r}=this.getShape("key").attributes,i=r*2*Ta;return t?at({width:i,height:i},t):!1}getIntersectPoint(e){const t=this.getShape("key").getBounds();return Ou(e,t)}};let Bs=wg;k(Bs,"defaultStyleProps",{size:32});class Lu extends Hn{constructor(e){super(e)}get parsedAttributes(){return this.attributes}drawKeyShape(e,t){return this.upsert("key",ru,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e);return _e(at({},t),{points:this.getPoints(e)})}getIntersectPoint(e){var i,a;const{points:t}=this.getShape("key").attributes,r=[+(((i=this.attributes)==null?void 0:i.x)||0),+(((a=this.attributes)==null?void 0:a.y)||0)];return g1(e,r,t).point}}class lA extends Lu{constructor(e){super(e)}getPoints(e){const[t,r]=this.getSize(e);return cN(t,r)}}const Sg=class extends Bs{constructor(e){super(Vn({style:Sg.defaultStyleProps},e))}parseOuterR(){const{size:e}=this.parsedAttributes;return Math.min(...Pa(e))/2}parseInnerR(){const{innerR:e}=this.parsedAttributes;return qt(e)?parseInt(e)/100*this.parseOuterR():e}drawDonutShape(e,t){const{donuts:r}=e;if(!(r!=null&&r.length))return;const i=r.map(h=>te(h)?{value:h}:h),a=Rn(this.getGraphicStyle(e),"donut"),o=A1(e.donutPalette);if(!o)return;const s=i.reduce((h,f)=>{var d;return h+((d=f.value)!=null?d:0)},0),l=this.parseOuterR(),c=this.parseInnerR();let u=0;i.forEach((h,f)=>{const m=h,{value:d=0,color:p=o[f%o.length]}=m,v=Ce(m,["value","color"]),g=(s===0?1/i.length:d/s)*360;this.upsert(`round${f}`,Xa,at(_e(at({},a),{d:hA(l,c,u,u+g),fill:p}),v),t),u+=g})}render(e,t=this){super.render(e,t),this.drawDonutShape(e,t)}};let Iu=Sg;k(Iu,"defaultStyleProps",{innerR:"50%",donuts:[],donutPalette:"tableau"});const Du=(n,e,t,r)=>[n+Math.sin(r)*t,e-Math.cos(r)*t],cA=(n,e,t,r)=>r<=0||t<=r?[["M",n-t,e],["A",t,t,0,1,1,n+t,e],["A",t,t,0,1,1,n-t,e],["Z"]]:[["M",n-t,e],["A",t,t,0,1,1,n+t,e],["A",t,t,0,1,1,n-t,e],["Z"],["M",n+r,e],["A",r,r,0,1,0,n-r,e],["A",r,r,0,1,0,n+r,e],["Z"]],uA=(n,e,t,r,i,a)=>{const[o,s]=[i/360*2*Math.PI,a/360*2*Math.PI],l=[Du(n,e,r,o),Du(n,e,t,o),Du(n,e,t,s),Du(n,e,r,s)],c=s-o>Math.PI?1:0;return[["M",l[0][0],l[0][1]],["L",l[1][0],l[1][1]],["A",t,t,0,c,1,l[2][0],l[2][1]],["L",l[3][0],l[3][1]],["A",r,r,0,c,0,l[0][0],l[0][1]],["Z"]]},hA=(n=0,e=0,t,r)=>{const[i,a]=[0,0];return Math.abs(t-r)%360<1e-6?cA(i,a,n,e):uA(i,a,n,e,t,r)},_g=class extends Hn{constructor(e){super(Vn({style:_g.defaultStyleProps},e))}drawKeyShape(e,t){return this.upsert("key",Zd,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e),[r,i]=this.getSize(e);return _e(at({},t),{rx:r/2,ry:i/2})}getIconStyle(e){const t=super.getIconStyle(e),{rx:r,ry:i}=this.getShape("key").attributes,a=Math.min(+r,+i)*2*Ta;return t?at({width:a,height:a},t):!1}getIntersectPoint(e){const t=this.getShape("key").getBounds();return Ou(e,t)}};let Bu=_g;k(Bu,"defaultStyleProps",{size:[45,35]});class fA extends Lu{constructor(e){super(e)}getOuterR(e){return e.outerR||Math.min(...this.getSize(e))/2}getPoints(e){return hN(this.getOuterR(e))}getIconStyle(e){const t=super.getIconStyle(e),r=this.getOuterR(e)*Ta;return t?at({width:r,height:r},t):!1}}function dA(n,e){if(n){var t;if(tr(n))for(var r=0,i=n.length;r<i&&(t=e(n[r],r),t!==!1);r++);else if(Ye(n)){for(var a in n)if(n.hasOwnProperty(a)&&(t=e(n[a],a),t===!1))break}}}var B1=dA,pA=Object.prototype.hasOwnProperty,Lp=function(n,e){if(n===null||!Ps(n))return{};var t={};return B1(e,function(r){pA.call(n,r)&&(t[r]=n[r])}),t};const Tg=class extends Hn{constructor(t){super(_e(at({},t),{style:Object.assign({},Tg.defaultStyleProps,t.style)}));k(this,"rootPointerEvent",new eu(null));k(this,"forwardEvents",t=>{const r=this.context.canvas,i=r.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(t,i).forEach(o=>{const s=this.bootstrapEvent(this.rootPointerEvent,o,i,t);r.context.eventService.mapEvent(s)})})}get eventService(){return this.context.canvas.context.eventService}get events(){return[ht.CLICK,ht.POINTER_DOWN,ht.POINTER_MOVE,ht.POINTER_UP,ht.POINTER_OVER,ht.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}getKeyStyle(t){const r=Lp(t,["innerHTML","pointerEvents","cursor"]),[i,a]=this.getSize(t);return _e(at({},r),{width:i,height:a})}drawKeyShape(t,r){const i=this.getKeyStyle(t),{width:a=0,height:o=0}=i,s=this.upsert("key-container",ea,{width:a,height:o,opacity:0},r);return this.upsert("key",qd,i,s)}connectedCallback(){const t=this.getDomElement();this.events.forEach(r=>{t.addEventListener(r,this.forwardEvents)})}attributeChangedCallback(t,r,i){t==="zIndex"&&r!==i&&(this.getDomElement().style.zIndex=i)}destroy(){const t=this.getDomElement();this.events.forEach(r=>{t.removeEventListener(r,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(t,r){const i=[];if(r.isTouchEvent(t))for(let a=0;a<t.changedTouches.length;a++){const o=t.changedTouches[a];yt(o.button)&&(o.button=0),yt(o.buttons)&&(o.buttons=1),yt(o.isPrimary)&&(o.isPrimary=t.touches.length===1&&t.type==="touchstart"),yt(o.width)&&(o.width=o.radiusX||1),yt(o.height)&&(o.height=o.radiusY||1),yt(o.tiltX)&&(o.tiltX=0),yt(o.tiltY)&&(o.tiltY=0),yt(o.pointerType)&&(o.pointerType="touch"),yt(o.pointerId)&&(o.pointerId=o.identifier||0),yt(o.pressure)&&(o.pressure=o.force||.5),yt(o.twist)&&(o.twist=0),yt(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,o.type=t.type,i.push(o)}else if(r.isMouseEvent(t)){const a=t;yt(a.isPrimary)&&(a.isPrimary=!0),yt(a.width)&&(a.width=1),yt(a.height)&&(a.height=1),yt(a.tiltX)&&(a.tiltX=0),yt(a.tiltY)&&(a.tiltY=0),yt(a.pointerType)&&(a.pointerType="mouse"),yt(a.pointerId)&&(a.pointerId=1),yt(a.pressure)&&(a.pressure=.5),yt(a.twist)&&(a.twist=0),yt(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,i.push(a)}else i.push(t);return i}transferMouseData(t,r){t.isTrusted=r.isTrusted,t.srcElement=r.srcElement,t.timeStamp=performance.now(),t.type=r.type,t.altKey=r.altKey,t.metaKey=r.metaKey,t.shiftKey=r.shiftKey,t.ctrlKey=r.ctrlKey,t.button=r.button,t.buttons=r.buttons,t.client.x=r.clientX,t.client.y=r.clientY,t.movement.x=r.movementX,t.movement.y=r.movementY,t.page.x=r.pageX,t.page.y=r.pageY,t.screen.x=r.screenX,t.screen.y=r.screenY,t.relatedTarget=null}bootstrapEvent(t,r,i,a){t.view=i,t.originalEvent=null,t.nativeEvent=a,t.pointerId=r.pointerId,t.width=r.width,t.height=r.height,t.isPrimary=r.isPrimary,t.pointerType=r.pointerType,t.pressure=r.pressure,t.tangentialPressure=r.tangentialPressure,t.tiltX=r.tiltX,t.tiltY=r.tiltY,t.twist=r.twist,this.transferMouseData(t,r);const{x:o,y:s}=this.getViewportXY(r);t.viewport.x=o,t.viewport.y=s;const[l,c]=this.context.canvas.getCanvasByViewport([o,s]);return t.canvas.x=l,t.canvas.y=c,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=a.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t}getViewportXY(t){let r,i;const{offsetX:a,offsetY:o,clientX:s,clientY:l}=t;if(this.context.canvas.context.config.supportsCSSTransform&&!pt(a)&&!pt(o))r=a,i=o;else{const c=this.eventService.client2Viewport({x:s,y:l});r=c.x,i=c.y}return{x:r,y:i}}onframe(){super.onframe();const{opacity:t}=this.attributes;this.getDomElement().style.opacity=`${t}`}};let Fu=Tg;k(Fu,"defaultStyleProps",{size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"});const Pg=class extends Hn{constructor(e){super(Vn({style:Pg.defaultStyleProps},e))}getKeyStyle(e){const[t,r]=this.getSize(e),s=super.getKeyStyle(e),{fillOpacity:i,opacity:a=i}=s,o=Ce(s,["fillOpacity","opacity"]);return _e(at({opacity:a},o),{width:t,height:r,x:-t/2,y:-r/2})}getHaloStyle(e){if(e.halo===!1)return!1;const u=this.getShape("key").attributes,{fill:t,stroke:r}=u,i=Ce(u,["fill","stroke"]),a=Rn(this.getGraphicStyle(e),"halo"),o=Number(a.lineWidth),[s,l]=ge(this.getSize(e),[o,o]),c="transparent";return _e(at({},a),{width:s,height:l,fill:c,x:-s/2,y:-l/2})}getIconStyle(e){const t=super.getIconStyle(e),[r,i]=this.getSize(e);return t?at({width:r*Ta,height:i*Ta},t):!1}drawKeyShape(e,t){const r=this.upsert("key",Ap,this.getKeyStyle(e),t);return Rp(this),r}drawHaloShape(e,t){this.upsert("halo",ea,this.getHaloStyle(e),t)}update(e){super.update(e),e&&("x"in e||"y"in e||"z"in e)&&kp(this)}};let Gu=Pg;k(Gu,"defaultStyleProps",{size:32});class vA extends Hn{constructor(e){super(e)}getKeyStyle(e){const[t,r]=this.getSize(e);return _e(at({},super.getKeyStyle(e)),{width:t,height:r,x:-t/2,y:-r/2})}getIconStyle(e){const t=super.getIconStyle(e),{width:r,height:i}=this.getShape("key").attributes;return t?at({width:r*Ta,height:i*Ta},t):!1}drawKeyShape(e,t){return this.upsert("key",ea,this.getKeyStyle(e),t)}}class gA extends Lu{constructor(e){super(e)}getInnerR(e){return e.innerR||this.getOuterR(e)*3/8}getOuterR(e){return Math.min(...this.getSize(e))/2}getPoints(e){return aN(this.getOuterR(e),this.getInnerR(e))}getIconStyle(e){const t=super.getIconStyle(e),r=this.getInnerR(e)*2*Ta;return t?at({width:r,height:r},t):!1}getPortXY(e,t){const{placement:r="top"}=t,i=this.getShape("key").getLocalBounds(),a=oN(this.getOuterR(e),this.getInnerR(e));return Gp(i,r,a,!1)}}const Mg=class extends Lu{constructor(e){super(Vn({style:Mg.defaultStyleProps},e))}getPoints(e){const{direction:t}=e,[r,i]=this.getSize(e);return sN(r,i,t)}getPortXY(e,t){const{direction:r}=e,{placement:i="top"}=t,a=this.getShape("key").getLocalBounds(),[o,s]=this.getSize(e),l=lN(o,s,r);return Gp(a,i,l,!1)}getIconStyle(e){const{icon:t,iconText:r,iconSrc:i,direction:a}=e;if(t===!1||Cp(r||i))return!1;const o=Rn(this.getGraphicStyle(e),"icon"),s=this.getShape("key").getLocalBounds(),[l,c]=SO(s,a),u=_O(s,a)*2*Ta;return at({x:l,y:c,width:u,height:u},o)}};let zu=Mg;k(zu,"defaultStyleProps",{size:40,direction:"up"});var mA=function(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(o=n[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};const Cg=class extends Hn{constructor(t){super(Vn({style:Cg.defaultStyleProps},t));k(this,"type","combo");this.updateComboPosition(this.parsedAttributes)}getKeySize(t){const{collapsed:r,childrenNode:i=[]}=t;return i.length===0?this.getEmptyKeySize(t):r?this.getCollapsedKeySize(t):this.getExpandedKeySize(t)}getEmptyKeySize(t){const{padding:r,collapsedSize:i}=t,[a,o,s,l]=Os(r);return ge(Pa(i),[l+o,a+s,0])}getCollapsedKeySize(t){return Pa(t.collapsedSize)}getExpandedKeySize(t){const r=this.getContentBBox(t);return[ra(r),ia(r),0]}getContentBBox(t){const{context:r,childrenNode:i=[],padding:a}=t,o=i.map(l=>r.element.getElement(l)).filter(Boolean);if(o.length===0){const l=new Fe,{x:c=0,y:u=0,size:h}=t,[f,d]=Pa(h);return l.setMinMax([c-f/2,u-d/2,0],[c+f/2,u+d/2,0]),l}const s=Il(o.map(l=>l.getBounds()));return a?Tu(s,a):s}drawCollapsedMarkerShape(t,r){this.upsert("collapsed-marker",I1,this.getCollapsedMarkerStyle(t),r),Rp(this)}getCollapsedMarkerStyle(t){if(!t.collapsed||!t.collapsedMarker)return!1;const c=Rn(this.getGraphicStyle(t),"collapsedMarker"),{type:r}=c,i=Ce(c,["type"]),a=this.getShape("key"),[o,s]=_a(a.getLocalBounds(),"center"),l=_e(at({},i),{x:o,y:s});if(r){const u=this.getCollapsedMarkerText(r,t);Object.assign(l,{text:u})}return l}getCollapsedMarkerText(t,r){const{context:i,childrenData:a=[]}=r,{model:o}=i;return t==="descendant-count"?o.getDescendantsData(this.id).length.toString():t==="child-count"?a.length.toString():t==="node-count"?o.getDescendantsData(this.id).filter(s=>o.getElementType(it(s))==="node").length.toString():jt(t)?t(a):""}getComboZIndex(t){return(this.context.model.getAncestorsData(this.id,tn)||[]).length}getComboPosition(t){const{x:r=0,y:i=0,collapsed:a,context:o,childrenData:s=[]}=t;if(s.length===0)return[+r,+i,0];if(a){const{model:l}=o,c=l.getDescendantsData(this.id).filter(u=>!l.isCombo(it(u)));if(c.length>0){const u=c.reduce((h,f)=>ge(h,Ui(f)),[0,0,0]);return As(u,c.length)}return[+r,+i,0]}return this.getContentBBox(t).center}getComboStyle(t){const{zIndex:r=this.getComboZIndex(t)}=t,[i,a]=this.getComboPosition(t);return{x:i,y:a,transform:`translate(${i}, ${a})`,zIndex:r}}updateComboPosition(t){const r=this.getComboStyle(t);Object.assign(this.style,r);const{x:i,y:a}=r;this.context.model.syncComboDatum({id:this.id,style:{x:i,y:a}}),kp(this)}render(t,r=this){super.render(t,r),this.drawCollapsedMarkerShape(t,r)}update(t={}){super.update(t),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(t,r){const i=super.animate(this.attributes.collapsed?t:t.map(u=>{var h=u,{x:a,y:o,z:s,transform:l}=h,c=Ce(h,["x","y","z","transform"]);return c}),r);return i&&new Proxy(i,{set:(a,o,s)=>(o==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(a,o,s))})}};let zo=Cg;k(zo,"defaultStyleProps",{childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"}),mA([ii((n,e)=>n.getCollapsedMarkerStyle(e))],zo.prototype,"drawCollapsedMarkerShape",null);class yA extends zo{constructor(e){super(e)}drawKeyShape(e,t){return this.upsert("key",Cl,this.getKeyStyle(e),t)}getKeyStyle(e){const{collapsed:t}=e,r=super.getKeyStyle(e),[i]=this.getKeySize(e);return _e(at(at({},r),t&&Rn(r,"collapsed")),{r:i/2})}getCollapsedKeySize(e){const[t,r]=Pa(e.collapsedSize),i=Math.max(t,r)/2;return[i*2,i*2,0]}getExpandedKeySize(e){const t=this.getContentBBox(e),[r,i]=Ka(t),a=Math.sqrt(pi(r,2)+pi(i,2))/2;return[a*2,a*2,0]}getIntersectPoint(e){const t=this.getShape("key").getBounds();return Ou(e,t)}}class xA extends zo{constructor(e){super(e)}drawKeyShape(e,t){return this.upsert("key",ea,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e),[r,i]=this.getKeySize(e);return _e(at(at({},t),e.collapsed&&Rn(t,"collapsed")),{width:r,height:i,x:-r/2,y:-i/2})}}var bA=function(n,e){if(!kl(n))return n;for(var t=[],r=0;r<n.length;r++){var i=n[r];e(i,r)&&t.push(i)}return t},EA=bA,wA=function(n,e){return kl(n)?n.indexOf(e)>-1:!1},SA=wA,_A=function(n,e){return e===void 0&&(e=[]),EA(n,function(t){return!SA(e,t)})},TA=_A;const PA={padding:10};function F1(n,e,t,r,i,a){const{padding:o}=Object.assign(PA,a),s=Za(t,o),l=Za(r,o),c=[n,...i,e];let u=null;const h=[];for(let f=0,d=c.length;f<d-1;f++){const p=f+1,v=c[f],g=c[p],m=OO(v,g);let x=null;f===0?p===d-1?s.intersects(l)?x=Dp(v,g,s,l):m||(x=OA(v,g,s,l)):wa(g,s)?x=Dp(v,g,s,Za(g,o),u):m||(x=Wu(v,g,s)):p===d-1?wa(v,l)?x=Dp(v,g,Za(v,o),l,u):m||(x=z1(v,g,l,u)):m||(x=CA(v,g,u)),x?(h.push(...x.points),u=x.direction):u=ai(v,g),p<d-1&&h.push(g)}return h}const MA={N:"S",S:"N",W:"E",E:"W"},G1={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function ai(n,e){const[t,r]=n,[i,a]=e;return t===i?r>a?"N":"S":r===a?t>i?"W":"E":null}function Ip(n,e){return e==="N"||e==="S"?ia(n):ra(n)}function CA(n,e,t){const r=[n[0],e[1]],i=[e[0],n[1]],a=ai(n,r),o=ai(n,i),s=t?MA[t]:null,l=a===t||a!==s&&o!==t?r:i;return{points:[l],direction:ai(l,e)}}function Wu(n,e,t){const r=Xl(n,e,t);return{points:[r],direction:ai(r,e)}}function z1(n,e,t,r){const i=[[e[0],n[1]],[n[0],e[1]]],a=i.filter(s=>wO(s,t)&&!u1(s,t,!0)),o=a.filter(s=>ai(s,n)!==r);if(o.length>0){const s=o.find(l=>ai(n,l)===r)||o[0];return{points:[s],direction:ai(s,e)}}else{const s=TA(i,a)[0],l=Ja(e,s,Ip(t,r)/2);return{points:[Xl(l,n,t),l],direction:ai(l,e)}}}function OA(n,e,t,r){let i=Wu(n,e,t);const a=Bl(i.points[0]);if(wa(a,r)){i=Wu(e,n,r);const o=Bl(i.points[0]);if(wa(o,t)){const s=Ja(n,a,Ip(t,ai(n,a))/2),l=Ja(e,o,Ip(r,ai(e,o))/2),c=[(s[0]+l[0])/2,(s[1]+l[1])/2],u=Wu(n,c,t),h=z1(c,e,r,u.direction);i.points=[u.points[0],h.points[0]],i.direction=h.direction}}return i}function Dp(n,e,t,r,i){const o=Il([t,r]),s=Ci(e,o.center)>Ci(n,o.center),[l,c]=s?[e,n]:[n,e],u=ia(o)+ra(o);let h;if(i){const p=[l[0]+u*Math.cos(G1[i]),l[1]+u*Math.sin(G1[i])];h=Ja(xp(o,p),p,.01)}else h=Ja(xp(o,l),l,-.01);let f=Xl(h,c,o),d=[Fl(h,2),Fl(f,2)];if(un(Fl(h),Fl(f))){const p=Ep(Nn(h,l),[1,0,0])+Math.PI/2;f=[c[0]+u*Math.cos(p),c[1]+u*Math.sin(p),0],f=Fl(Ja(xp(o,f),c,-.01),2);const v=Xl(h,f,o);d=[h,v,f]}return{points:s?d.reverse():d,direction:ai(s?h:f,e)}}function Xl(n,e,t){let r=[n[0],e[1]];return wa(r,t)&&(r=[e[0],n[1]]),r}function W1(n,e,t,r,i){let l=typeof e=="number"?e:.5;e==="start"&&(l=0),e==="end"&&(l=.99);const c=Ir(n.getPoint(l)),u=Ir(n.getPoint(l+.01));let h=e==="start"?"left":e==="end"?"right":"center";if(v1(c,u)||!t){const[m,x]=U1(n,l,r,i);return{transform:`translate(${m}, ${x})`,textAlign:h}}let f=Math.atan2(u[1]-c[1],u[0]-c[0]);u[0]<c[0]&&(h=h==="center"?h:h==="left"?"right":"left",r*=-1,f+=Math.PI);const[p,v]=U1(n,l,r,i,f),g=`translate(${p}, ${v}) rotate(${f/Math.PI*180}deg)`;return{textAlign:h,transform:g}}function AA(n,e,t,r,i){var s,l;const a=((s=n.badge)==null?void 0:s.getGeometryBounds().halfExtents[0])*2||0,o=((l=n.label)==null?void 0:l.getGeometryBounds().halfExtents[0])*2||0;return W1(n.key,t,!0,(o?(o/2+a/2)*(e==="suffix"?1:-1):0)+r,i)}function U1(n,e,t,r,i){const[a,o]=Ir(n.getPoint(e));let s=t,l=r;return i&&(s=t*Math.cos(i)-r*Math.sin(i),l=t*Math.sin(i)+r*Math.cos(i)),[a+s,o+l]}function Bp(n,e,t,r){if(un(n,e))return n;const i=Nn(e,n),a=[n[0]+t*i[0],n[1]+t*i[1]],o=Sa(Cu(i,!1));return a[0]+=r*o[0],a[1]+=r*o[1],a}function NA(n){return te(n)?[n,-n]:n}function RA(n){return te(n)?[n,1-n]:n}function kA(n,e,t){return[["M",n[0],n[1]],["Q",t[0],t[1],e[0],e[1]]]}function V1(n,e,t){return[["M",n[0],n[1]],["C",t[0][0],t[0][1],t[1][0],t[1][1],e[0],e[1]]]}function H1(n,e=0,t=!1){const r=n[0],i=n[n.length-1],a=n.slice(1,n.length-1),o=[["M",r[0],r[1]]];return a.forEach((s,l)=>{const c=a[l-1]||r,u=a[l+1]||i;if(!AO(c,s,u)&&e){const[h,f]=LA(c,s,u,e);o.push(["L",h[0],h[1]],["Q",s[0],s[1],f[0],f[1]],["L",f[0],f[1]])}else o.push(["L",s[0],s[1]])}),o.push(["L",i[0],i[1]]),t&&o.push(["Z"]),o}function LA(n,e,t,r){const i=Mu(n,e),a=Mu(t,e),o=Math.min(r,Math.min(i,a)/2),s=[e[0]-o/i*(e[0]-n[0]),e[1]-o/i*(e[1]-n[1])],l=[e[0]-o/a*(e[0]-t[0]),e[1]-o/a*(e[1]-t[1])];return[s,l]}const IA=n=>{const e=Math.PI/2,t=ia(n)/2,r=ra(n)/2,i=Math.atan2(t,r)/2,a=Math.atan2(r,t)/2;return{top:[-e-a,-e+a],"top-right":[-e+a,-i],"right-top":[-e+a,-i],right:[-i,i],"bottom-right":[i,e-a],"right-bottom":[i,e-a],bottom:[e-a,e+a],"bottom-left":[e+a,Math.PI-i],"left-bottom":[e+a,Math.PI-i],left:[Math.PI-i,Math.PI+i],"top-left":[Math.PI+i,-e-a],"left-top":[Math.PI+i,-e-a]}};function Y1(n,e,t,r,i){const a=Za(n),o=n.getCenter();let s=r&&to(r),l=i&&to(i);if(!s||!l){const c=IA(a),u=c[e][0],h=c[e][1],[f,d]=Ka(a),p=Math.max(f,d),v=ge(o,[p*Math.cos(u),p*Math.sin(u),0]),g=ge(o,[p*Math.cos(h),p*Math.sin(h),0]);s=Wp(n,v),l=Wp(n,g),t||([s,l]=[l,s])}return[s,l]}function DA(n,e,t,r,i,a){const o=n.getPorts()[i||a],s=n.getPorts()[a||i];let[l,c]=Y1(n,e,t,o,s);const u=BA(n,l,c,r);return o&&(l=Kl(o,u[0])),s&&(c=Kl(s,u[u.length-1])),V1(l,c,u)}function BA(n,e,t,r){const i=n.getCenter();if(un(e,t)){const a=Nn(e,i),o=[r*Math.sign(a[0])||r/2,r*Math.sign(a[1])||-r/2,0];return[ge(e,o),ge(t,bp(o,[1,-1,1]))]}return[Ja(i,e,Ci(i,e)+r),Ja(i,t,Ci(i,t)+r)]}function FA(n,e,t,r,i,a,o){const s=zp(n),l=s[a||o],c=s[o||a];let[u,h]=Y1(n,t,r,l,c);const f=GA(n,u,h,i);return l&&(u=Kl(l,f[0])),c&&(h=Kl(c,f[f.length-1])),H1([u,...f,h],e)}function GA(n,e,t,r){const i=[],a=Za(n);if(un(e,t))switch(Pu(a,e)){case"left":i.push([e[0]-r,e[1]]),i.push([e[0]-r,e[1]+r]),i.push([e[0],e[1]+r]);break;case"right":i.push([e[0]+r,e[1]]),i.push([e[0]+r,e[1]+r]),i.push([e[0],e[1]+r]);break;case"top":i.push([e[0],e[1]-r]),i.push([e[0]+r,e[1]-r]),i.push([e[0]+r,e[1]]);break;case"bottom":i.push([e[0],e[1]+r]),i.push([e[0]+r,e[1]+r]),i.push([e[0]+r,e[1]]);break}else{const o=Pu(a,e),s=Pu(a,t);if(o===s){const l=o;let c,u;switch(l){case"left":c=Math.min(e[0],t[0])-r,i.push([c,e[1]]),i.push([c,t[1]]);break;case"right":c=Math.max(e[0],t[0])+r,i.push([c,e[1]]),i.push([c,t[1]]);break;case"top":u=Math.min(e[1],t[1])-r,i.push([e[0],u]),i.push([t[0],u]);break;case"bottom":u=Math.max(e[1],t[1])+r,i.push([e[0],u]),i.push([t[0],u]);break}}else{const l=(f,d)=>({left:[d[0]-r,d[1]],right:[d[0]+r,d[1]],top:[d[0],d[1]-r],bottom:[d[0],d[1]+r]})[f],c=l(o,e),u=l(s,t),h=Xl(c,u,a);i.push(c,h,u)}}return i}function X1(n,e){const t=new Set,r=new Set,i=new Set;return n.forEach(a=>{e(a).forEach(s=>{t.add(s),n.includes(s.source)&&n.includes(s.target)?r.add(s):i.add(s)})}),{edges:Array.from(t),internal:Array.from(r),external:Array.from(i)}}function j1(n,e){const t=[];let r=n;for(;r;){t.push(r);const i=e(it(r));if(i)r=i;else break}if(t.some(i=>{var a;return(a=i.style)==null?void 0:a.collapsed})){const i=t.reverse().findIndex(ri);return t[i]||t.at(-1)}return n}function zA(n,e){return e||(n<4?10:n===4?12:n*2.5)}const WA=(n,e)=>{const t=Math.max(n,e)/2;return[["M",-n/2,0],["A",t,t,0,1,0,2*t-n/2,0],["A",t,t,0,1,0,-n/2,0],["Z"]]},$1=(n,e)=>[["M",-n/2,0],["L",n/2,-e/2],["L",n/2,e/2],["Z"]],UA=(n,e)=>[["M",-n/2,0],["L",0,-e/2],["L",n/2,0],["L",0,e/2],["Z"]],VA=(n,e)=>[["M",-n/2,0],["L",n/2,-e/2],["L",4*n/5-n/2,0],["L",n/2,e/2],["Z"]],HA=(n,e)=>[["M",-n/2,-e/2],["L",n/2,-e/2],["L",n/2,e/2],["L",-n/2,e/2],["Z"]],YA=(n,e)=>{const t=n/2,r=n/7,i=n-r;return[["M",-t,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",i-t,-e/2],["L",i+r-t,-e/2],["L",i+r-t,e/2],["L",i-t,e/2],["Z"]]},XA=(n,e)=>[["M",n/2,-e/2],["L",-n/2,0],["L",n/2,0],["L",-n/2,0],["L",n/2,e/2]];var Fs=function(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(o=n[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};const Og=class extends D1{constructor(t){super(Vn({style:Og.defaultStyleProps},t));k(this,"type","edge")}get sourceNode(){const{context:t,sourceNode:r}=this.parsedAttributes;return t.element.getElement(r)}get targetNode(){const{context:t,targetNode:r}=this.parsedAttributes;return t.element.getElement(r)}getKeyStyle(t){const l=this.getGraphicStyle(t),{loop:r}=l,i=Ce(l,["loop"]),{sourceNode:a,targetNode:o}=this,s=r&&eN(a,o)?this.getLoopPath(t):this.getKeyPath(t);return at({d:s},Pp(i,["halo","label","startArrow","endArrow"]))}getLoopPath(t){const{sourcePort:r,targetPort:i}=t,a=this.sourceNode,o=Za(a),s=Math.max(ra(o),ia(o)),{placement:l,clockwise:c,dist:u=s}=Rn(this.getGraphicStyle(t),"loop");return DA(a,l,c,u,r,i)}getEndpoints(t,r=!0,i=[]){const{sourcePort:a,targetPort:o}=t,{sourceNode:s,targetNode:l}=this,[c,u]=rN(s,l,a,o);if(!r){const p=c?to(c):s.getCenter(),v=u?to(u):l.getCenter();return[p,v]}const h=typeof i=="function"?i():i,f=nx(c||s,h[0]||u||l),d=nx(u||l,h[h.length-1]||c||s);return[f,d]}getHaloStyle(t){if(t.halo===!1)return!1;const r=this.getKeyStyle(t),i=Rn(this.getGraphicStyle(t),"halo");return at(at({},r),i)}getLabelStyle(t){if(t.label===!1||!t.labelText)return!1;const d=Rn(this.getGraphicStyle(t),"label"),{placement:i,offsetX:a,offsetY:o,autoRotate:s,maxWidth:l}=d,c=Ce(d,["placement","offsetX","offsetY","autoRotate","maxWidth"]),u=W1(this.shapeMap.key,i,s,a,o),h=this.shapeMap.key.getLocalBounds(),f=YO([h.min,h.max],l);return Object.assign({wordWrapWidth:f},u,c)}getBadgeStyle(t){if(t.badge===!1||!t.badgeText)return!1;const s=Rn(t,"badge"),{offsetX:r,offsetY:i,placement:a}=s,o=Ce(s,["offsetX","offsetY","placement"]);return Object.assign(o,AA(this.shapeMap,a,t.labelPlacement,r,i))}drawArrow(t,r){var l;const i=r==="start",o=t[r==="start"?"startArrow":"endArrow"],s=this.shapeMap.key;if(o){const c=this.getArrowStyle(t,i),[u,h,f]=i?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],d=s.parsedStyle[u];if(d)d.attr(c);else{const p=c.src?Jd:Xa,v=new p({style:c});s.style[u]=v}s.style[h]=t[f]||c.width/2+ +c.lineWidth}else{const c=i?"markerStart":"markerEnd";(l=s.style[c])==null||l.destroy(),s.style[c]=null}}getArrowStyle(t,r){const i=this.getShape("key").attributes,a=r?"startArrow":"endArrow",d=Rn(this.getGraphicStyle(t),a),{size:o,type:s}=d,l=Ce(d,["size","type"]),[c,u]=Pa(zA(i.lineWidth,o)),f=(jt(s)?s:lt[s]||$1)(c,u);return Object.assign(Lp(i,["stroke","strokeOpacity","fillOpacity"]),{width:c,height:u},at({},f&&{d:f,fill:s==="simple"?"":i.stroke}),l)}drawLabelShape(t,r){this.upsert("label",Qa,this.getLabelStyle(t),r)}drawHaloShape(t,r){this.upsert("halo",Xa,this.getHaloStyle(t),r)}drawBadgeShape(t,r){this.upsert("badge",Ls,this.getBadgeStyle(t),r)}drawSourceArrow(t){this.drawArrow(t,"start")}drawTargetArrow(t){this.drawArrow(t,"end")}drawKeyShape(t,r){return this.upsert("key",Xa,this.getKeyStyle(t),r)}render(t=this.parsedAttributes,r=this){this.drawKeyShape(t,r),this.getShape("key")&&(this.drawSourceArrow(t),this.drawTargetArrow(t),this.drawLabelShape(t,r),this.drawHaloShape(t,r),this.drawBadgeShape(t,r))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(t,r){const i=super.animate(t,r);return i&&new Proxy(i,{set:(a,o,s)=>(o==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(a,o,s))})}};let Dr=Og;k(Dr,"defaultStyleProps",{badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0}),Fs([ii((n,e)=>n.getLabelStyle(e))],Dr.prototype,"drawLabelShape",null),Fs([ii((n,e)=>n.getHaloStyle(e))],Dr.prototype,"drawHaloShape",null),Fs([ii((n,e)=>n.getBadgeStyle(e))],Dr.prototype,"drawBadgeShape",null),Fs([ii((n,e)=>n.getArrowStyle(e,"start"))],Dr.prototype,"drawSourceArrow",null),Fs([ii((n,e)=>n.getArrowStyle(e,"end"))],Dr.prototype,"drawTargetArrow",null),Fs([ii((n,e)=>n.getKeyStyle(e))],Dr.prototype,"drawKeyShape",null);const Ag=class extends Dr{constructor(e){super(Vn({style:Ag.defaultStyleProps},e))}getKeyPath(e){const[t,r]=this.getEndpoints(e),{controlPoints:i,curvePosition:a,curveOffset:o}=e,s=this.getControlPoints(t,r,RA(a),NA(o),i);return V1(t,r,s)}getControlPoints(e,t,r,i,a){return(a==null?void 0:a.length)===2?a:[Bp(e,t,r[0],i[0]),Bp(e,t,r[1],i[1])]}};let Wo=Ag;k(Wo,"defaultStyleProps",{curvePosition:.5,curveOffset:20});const Ng=class extends Wo{constructor(e){super(Vn({style:Ng.defaultStyleProps},e))}getControlPoints(e,t,r,i){const a=t[0]-e[0];return[[e[0]+a*r[0]+i[0],e[1]],[t[0]-a*r[1]+i[1],t[1]]]}};let Uu=Ng;k(Uu,"defaultStyleProps",{curvePosition:[.5,.5],curveOffset:[0,0]});const Rg=class extends Wo{constructor(e){super(Vn({style:Rg.defaultStyleProps},e))}getControlPoints(e,t,r,i){const a=t[1]-e[1];return[[e[0],e[1]+a*r[0]+i[0]],[t[0],t[1]-a*r[1]+i[1]]]}};let Vu=Rg;k(Vu,"defaultStyleProps",{curvePosition:[.5,.5],curveOffset:[0,0]});const kg=class extends Dr{constructor(e){super(Vn({style:kg.defaultStyleProps},e))}getKeyPath(e){const[t,r]=this.getEndpoints(e);return[["M",t[0],t[1]],["L",r[0],r[1]]]}};let jl=kg;k(jl,"defaultStyleProps",{});const jA={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:Mu},Ma=n=>`${Math.round(n[0])}|||${Math.round(n[1])}`;function Uo(n,e){const t=r=>Math.round(r/e);return te(n)?t(n):n.map(t)}function $A(n,e){const t=Math.abs(n-e);return t>Math.PI?2*Math.PI-t:t}function K1(n,e){const t=e[0]-n[0],r=e[1]-n[1];return!t&&!r?0:Math.atan2(r,t)}function Z1(n,e,t,r){const i=K1(n,e),a=t[Ma(n)],s=K1(a||r,n);return $A(s,i)}const KA=(n,e)=>{const{offset:t,gridSize:r}=e,i={};return n.forEach(a=>{if(!a||a.destroyed||!a.isVisible())return;const o=Tu(a.getRenderBounds(),t);for(let s=Uo(o.min[0],r);s<=Uo(o.max[0],r);s+=1)for(let l=Uo(o.min[1],r);l<=Uo(o.max[1],r);l+=1)i[`${s}|||${l}`]=!0}),i};function q1(n,e,t){return Math.min(...e.map(r=>t(n,r)))}function ZA(n,e,t){let r=n[0],i=t(n[0],e);for(let a=0;a<n.length;a++){const o=n[a],s=t(o,e);s<i&&(r=o,i=s)}return r}const J1=(n,e,t,r)=>{if(!e)return[n];const{directionMap:i,offset:a}=r,o=Tu(e.getRenderBounds(),a),s=Object.keys(i).reduce((l,c)=>{if(t.includes(c)){const u=i[c],[h,f]=Ka(o),d=[n[0]+u.stepX*h,n[1]+u.stepY*f],p=TO(o);for(let v=0;v<p.length;v++){const g=wp([n,d],p[v]);g&&u1(g,o)&&l.push(g)}}return l},[]);return wa(n,o)||s.push(n),s.map(l=>Uo(l,r.gridSize))},qA=(n,e,t,r,i,a,o)=>{const s=[];let l=[a[0]===r[0]?r[0]:n[0]*o,a[1]===r[1]?r[1]:n[1]*o];s.unshift(l);let c=n,u=e[Ma(c)];for(;u;){const d=u,p=c;Z1(d,p,e,t)&&(l=[d[0]===p[0]?l[0]:d[0]*o,d[1]===p[1]?l[1]:d[1]*o],s.unshift(l)),u=e[Ma(d)],c=d}const h=i.map(d=>[d[0]*o,d[1]*o]),f=ZA(h,l,Mu);return s.unshift(f),s};function JA(n,e,t,r){const i=Dl(n.getCenter()),a=Dl(e.getCenter()),o=Object.assign(jA,r),{gridSize:s}=o,l=o.enableObstacleAvoidance?t:[n,e],c=KA(l,o),u=Uo(i,s),h=Uo(a,s),f=J1(i,n,o.startDirections,o),d=J1(a,e,o.endDirections,o);f.forEach(w=>delete c[Ma(w)]),d.forEach(w=>delete c[Ma(w)]);const p={},v={},g={},m={},x={},S=new QA;for(let w=0;w<f.length;w++){const C=f[w],M=Ma(C);p[M]=C,m[M]=0,x[M]=q1(C,d,o.distFunc),S.add({id:M,value:x[M]})}const T=d.map(w=>Ma(w));let b=o.maximumLoops,y,E=1/0;for(const[w,C]of Object.entries(p))x[w]<=E&&(E=x[w],y=C);for(;Object.keys(p).length>0&&b>0;){const w=S.minId(!1);if(w)y=p[w];else break;const C=Ma(y);if(T.includes(C))return qA(y,g,u,a,f,h,s);delete p[C],S.remove(C),v[C]=!0;for(const M of Object.values(o.directionMap)){const O=ge(y,[M.stepX,M.stepY]),A=Ma(O);if(v[A])continue;const R=Z1(y,O,g,u);if(R>o.maxAllowedDirectionChange||c[A])continue;p[A]||(p[A]=O);const L=o.penalties[R],z=o.distFunc(y,O)+(isNaN(L)?s:L),Y=m[C]+z,I=m[A];I&&Y>=I||(g[A]=y,m[A]=Y,x[A]=Y+q1(O,d,o.distFunc),S.add({id:A,value:x[A]}))}b-=1}return[]}class QA{constructor(){k(this,"arr",[]);k(this,"map",{});this.arr=[],this.map={}}_innerAdd(e,t){let r=0,i=t-1;for(;i-r>1;){const a=Math.floor((r+i)/2);if(this.arr[a].value>e.value)i=a;else if(this.arr[a].value<e.value)r=a;else{this.arr.splice(a,0,e),this.map[e.id]=!0;return}}this.arr.splice(i,0,e),this.map[e.id]=!0}add(e){delete this.map[e.id];const t=this.arr.length;if(!t||this.arr[t-1].value<e.value){this.arr.push(e),this.map[e.id]=!0;return}this._innerAdd(e,t)}remove(e){this.map[e]&&delete this.map[e]}_clearAndGetMinId(){let e;for(let t=this.arr.length-1;t>=0;t--)this.map[this.arr[t].id]?e=this.arr[t].id:this.arr.splice(t,1);return e}_findFirstId(){for(;this.arr.length;){const e=this.arr.shift();if(this.map[e.id])return e.id}}minId(e){return e?this._clearAndGetMinId():this._findFirstId()}}const Lg=class extends Dr{constructor(e){super(Vn({style:Lg.defaultStyleProps},e))}getControlPoints(e){const{router:t}=e,{sourceNode:r,targetNode:i}=this,[a,o]=this.getEndpoints(e,!1);let s=[];if(!t)s=e.controlPoints;else if(t.type==="shortest-path"){const l=this.context.element.getNodes();s=JA(r,i,l,t),s.length||(s=F1(a,o,r,i,e.controlPoints,{padding:t.offset}))}else t.type==="orth"&&(s=F1(a,o,r,i,e.controlPoints,t));return s}getPoints(e){const t=this.getControlPoints(e),[r,i]=this.getEndpoints(e,!0,t);return[r,...t,i]}getKeyPath(e){const t=this.getPoints(e);return H1(t,e.radius)}getLoopPath(e){const{sourcePort:t,targetPort:r,radius:i}=e,a=this.sourceNode,o=Za(a),s=Math.max(ra(o),ia(o))/4,{placement:l,clockwise:c,dist:u=s}=Rn(this.getGraphicStyle(e),"loop");return FA(a,i,l,c,u,t,r)}};let Hu=Lg;k(Hu,"defaultStyleProps",{radius:0,controlPoints:[],router:!1});const Ig=class extends Dr{constructor(e){super(Vn({style:Ig.defaultStyleProps},e))}getKeyPath(e){const{curvePosition:t,curveOffset:r}=e,[i,a]=this.getEndpoints(e),o=e.controlPoint||Bp(i,a,t,r);return kA(i,a,o)}};let Yu=Ig;k(Yu,"defaultStyleProps",{curvePosition:.5,curveOffset:30});function $l(n){return n instanceof Hn&&n.type==="node"}function Q1(n){return n instanceof Dr}function Fp(n){return n instanceof zo}function tN(n){return $l(n)||Q1(n)||Fp(n)}function eN(n,e){return!n||!e?!1:n===e}const nN={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],default:[.5,.5]};function Gp(n,e,t=nN,r=!0){const i=[.5,.5],a=qt(e)?gr(t,e.toLocaleLowerCase(),i):e;if(!r&&qt(e))return a;const[o,s]=a||i;return[n.min[0]+ra(n)*o,n.min[1]+ia(n)*s]}function zp(n){if(!n)return{};const e=n.getPorts();return(n.attributes.ports||[]).forEach((r,i)=>{var s;const{key:a,placement:o}=r;tx(r)&&(e[s=a||i]||(e[s]=_a(n.getShape("key").getBounds(),o)))}),e}function tx(n){const{r:e}=n;return!e||Number(e)===0}function to(n){return Cs(n)?n:n.getPosition()}function rN(n,e,t,r){const i=ex(n,e,t,r),a=ex(e,n,r,t);return[i,a]}function ex(n,e,t,r){const i=zp(n);if(t)return i[t];const a=Object.values(i);if(a.length===0)return;const o=a.map(c=>to(c)),s=iN(e,r),[l]=kO(o,s);return a.find(c=>to(c)===l)}function iN(n,e){const t=zp(n);if(e)return[to(t[e])];const r=Object.values(t);return r.length>0?r.map(i=>to(i)):[n.getCenter()]}function nx(n,e){return Fp(n)||$l(n)?Wp(n,e):Kl(n,e)}function Kl(n,e){if(!n||!e)return[0,0,0];if(Cs(n))return n;if(n.attributes.linkToCenter)return n.getPosition();const t=Cs(e)?e:$l(e)?e.getCenter():e.getPosition();return Ou(t,n.getBounds())}function Wp(n,e){if(!n||!e)return[0,0,0];const t=Cs(e)?e:$l(e)?e.getCenter():e.getPosition();return n.getIntersectPoint(t)||n.getCenter()}function rx(n,e="bottom",t=0,r=0,i=!1){const a=e.split("-"),[o,s]=_a(n,e),l=a.includes("left")?"right":a.includes("right")?"left":"center";let c=a.includes("top")?"bottom":a.includes("bottom")?"top":"middle";return i&&(c=c==="top"?"bottom":c==="bottom"?"top":c),{transform:`translate(${o+t}, ${s+r})`,textBaseline:c,textAlign:l}}function aN(n,e){return[[0,-n],[e*Math.cos(3*Math.PI/10),-e*Math.sin(3*Math.PI/10)],[n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],[e*Math.cos(Math.PI/10),e*Math.sin(Math.PI/10)],[n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],[0,e],[-n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],[-e*Math.cos(Math.PI/10),e*Math.sin(Math.PI/10)],[-n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],[-e*Math.cos(3*Math.PI/10),-e*Math.sin(3*Math.PI/10)]]}function oN(n,e){const t={};return t.top=[0,-n],t.left=[-n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],t["left-bottom"]=[-n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],t.bottom=[0,e],t["right-bottom"]=[n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],t.right=t.default=[n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],t}function sN(n,e,t){const r=e/2,i=n/2,a={up:[[-i,r],[i,r],[0,-r]],left:[[-i,0],[i,r],[i,-r]],right:[[-i,r],[-i,-r],[i,0]],down:[[-i,-r],[i,-r],[0,r]]};return a[t]||a.up}function lN(n,e,t){const r=e/2,i=n/2,a={};return t==="down"?(a.bottom=a.default=[0,r],a.right=[i,-r],a.left=[-i,-r]):t==="left"?(a.top=[i,-r],a.bottom=[i,r],a.left=a.default=[-i,0]):t==="right"?(a.top=[-i,-r],a.bottom=[-i,r],a.right=a.default=[i,0]):(a.left=[-i,r],a.top=a.default=[0,-r],a.right=[i,r]),a}function Jz(n,e){return[[n/2,-e/2],[n/2,e/2],[-n/2,e/2],[-n/2,-e/2]]}function cN(n,e){return[[0,-e/2],[n/2,0],[0,e/2],[-n/2,0]]}function uN(n){return gr(n,["style","visibility"])!=="hidden"}function Up(n,e){"update"in n?n.update(e):n.attr(e)}function hN(n){return[[0,n],[n*Math.sqrt(3)/2,n/2],[n*Math.sqrt(3)/2,-n/2],[0,-n],[-n*Math.sqrt(3)/2,-n/2],[-n*Math.sqrt(3)/2,n/2]]}function fN(n){zl(n,"__to_be_destroyed__",!0)}function Vp(n){return gr(n,"__to_be_destroyed__",!1)}const Dg=class extends Mi{constructor(t,r){super(t,Object.assign({},Dg.defaultOptions,r));k(this,"onCollapseExpand",t=>Ct(this,null,function*(){if(!this.validate(t))return;const{target:r}=t;if(!tN(r))return;const i=r.id,{model:a,graph:o}=this.context,s=a.getElementDataById(i);if(!s)return!1;const{onCollapse:l,onExpand:c,animation:u}=this.options;ri(s)?(yield o.expandElement(i,u),c==null||c(i)):(yield o.collapseElement(i,u),l==null||l(i))}));this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;t.on(`node:${r}`,this.onCollapseExpand),t.on(`combo:${r}`,this.onCollapseExpand)}unbindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;t.off(`node:${r}`,this.onCollapseExpand),t.off(`combo:${r}`,this.onCollapseExpand)}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}destroy(){this.unbindEvents(),super.destroy()}};let Xu=Dg;k(Xu,"defaultOptions",{enable:!0,animation:!0,trigger:ht.DBLCLICK});var ju={},dN=function(n){return n=n||"g",ju[n]?ju[n]+=1:ju[n]=1,n+ju[n]};const pN="g6-create-edge-assist-edge-id",$u="g6-create-edge-assist-node-id",Bg=class extends Mi{constructor(t,r){super(t,Object.assign({},Bg.defaultOptions,r));k(this,"source");k(this,"drop",t=>Ct(this,null,function*(){const{targetType:r}=t;["combo","node"].includes(r)&&this.source?yield this.handleCreateEdge(t):yield this.cancelEdge()}));k(this,"handleCreateEdge",t=>Ct(this,null,function*(){var l;if(!this.validate(t))return;const{graph:r,canvas:i,batch:a,element:o}=this.context,{style:s}=this.options;if(this.source){this.createEdge(t),yield this.cancelEdge();return}a.startBatch(),i.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([t.target.id])[0],r.addNodeData([{id:$u,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}]}}]),r.addEdgeData([{id:pN,source:this.source,target:$u,style:at({pointerEvents:"none"},s)}]),yield(l=o.draw({animation:!1}))==null?void 0:l.finished}));k(this,"updateAssistEdge",t=>Ct(this,null,function*(){var a;if(!this.source)return;const{model:r,element:i}=this.context;r.translateNodeTo($u,[t.canvas.x,t.canvas.y]),yield(a=i.draw({animation:!1,silence:!0}))==null?void 0:a.finished}));k(this,"createEdge",t=>{var h,f;const{graph:r}=this.context,{style:i,onFinish:a,onCreate:o}=this.options;if(((h=t.target)==null?void 0:h.id)===void 0||this.source===void 0)return;const l=(f=this.getSelectedNodeIDs([t.target.id]))==null?void 0:f[0],c=`${this.source}-${l}-${dN()}`,u=o({id:c,source:this.source,target:l,style:i});r.addEdgeData([u]),a(u)});k(this,"cancelEdge",()=>Ct(this,null,function*(){var a;if(!this.source)return;const{graph:t,element:r,batch:i}=this.context;t.removeNodeData([$u]),this.source=void 0,yield(a=r.draw({animation:!1}))==null?void 0:a.finished,i.endBatch()}));this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;this.unbindEvents(),r==="click"?(t.on(Ti.CLICK,this.handleCreateEdge),t.on(Bo.CLICK,this.handleCreateEdge),t.on(xa.CLICK,this.cancelEdge),t.on(wu.CLICK,this.cancelEdge)):(t.on(Ti.DRAG_START,this.handleCreateEdge),t.on(Bo.DRAG_START,this.handleCreateEdge),t.on(ht.POINTER_UP,this.drop)),t.on(ht.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(r=>r.id).concat(t)))}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}unbindEvents(){const{graph:t}=this.context;t.off(Ti.CLICK,this.handleCreateEdge),t.off(Bo.CLICK,this.handleCreateEdge),t.off(xa.CLICK,this.cancelEdge),t.off(wu.CLICK,this.cancelEdge),t.off(Ti.DRAG_START,this.handleCreateEdge),t.off(Bo.DRAG_START,this.handleCreateEdge),t.off(ht.POINTER_UP,this.drop),t.off(ht.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}};let Ku=Bg;k(Ku,"defaultOptions",{animation:!0,enable:!0,style:{},trigger:"drag",onCreate:t=>t,onFinish:()=>{}});function vN(n,e,t){var r;return function(){var i=this,a=arguments,o=function(){r=null,t||n.apply(i,a)},s=t&&!r;clearTimeout(r),r=setTimeout(o,e),s&&n.apply(i,a)}}var Zu=vN;const Fg=class extends Mi{constructor(t,r){super(t,Object.assign({},Fg.defaultOptions,r));k(this,"shortcut");k(this,"defaultCursor");k(this,"isDragging",!1);k(this,"onDragStart",t=>{this.validate(t)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))});k(this,"onDrag",t=>{if(!this.isDragging)return;const{x:r,y:i}=t.movement;r|i&&this.translate([r,i],!1)});k(this,"onDragEnd",()=>{var t,r;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),(r=(t=this.options).onFinish)==null||r.call(t)});k(this,"invokeOnFinish",Zu(()=>{var t,r;(r=(t=this.options).onFinish)==null||r.call(t)},300));this.shortcut=new Ns(t.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{trigger:t}=this.options;if(Ye(t)){const{up:r=[],down:i=[],left:a=[],right:o=[]}=t;this.shortcut.bind(r,s=>this.onTranslate([0,1],s)),this.shortcut.bind(i,s=>this.onTranslate([0,-1],s)),this.shortcut.bind(a,s=>this.onTranslate([1,0],s)),this.shortcut.bind(o,s=>this.onTranslate([-1,0],s))}else{const{graph:r}=this.context;r.on(ht.DRAG_START,this.onDragStart),r.on(ht.DRAG,this.onDrag),r.on(ht.DRAG_END,this.onDragEnd)}}onTranslate(t,r){return Ct(this,null,function*(){if(!this.validate(r))return;const{sensitivity:i}=this.options,a=i*-1;yield this.translate(bp(t,a),this.options.animation),this.invokeOnFinish()})}translate(t,r){return Ct(this,null,function*(){let[i,a]=t;const{direction:o}=this.options;o==="x"?a=0:o==="y"&&(i=0),yield this.context.graph.translateBy([i,a],r)})}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return typeof r=="function"?r(t):!!r}unbindEvents(){this.shortcut.unbindAll();const{graph:t}=this.context;t.off(ht.DRAG_START,this.onDragStart),t.off(ht.DRAG,this.onDrag),t.off(ht.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}};let qu=Fg;k(qu,"defaultOptions",{enable:t=>"targetType"in t?t.targetType==="canvas":!0,sensitivity:10,direction:"both"});const Gg=class extends Mi{constructor(t,r){super(t,Object.assign({},Gg.defaultOptions,r));k(this,"enable",!1);k(this,"enableElements",["node","combo"]);k(this,"target",[]);k(this,"shadow");k(this,"shadowOrigin",[0,0]);k(this,"hiddenEdges",[]);k(this,"isDragging",!1);k(this,"onDrop",t=>Ct(this,null,function*(){var o;if(this.options.dropEffect!=="link")return;const{model:r,element:i}=this.context,a=t.target.id;this.target.forEach(s=>{const l=r.getParentData(s,tn);l&&it(l)===a&&r.refreshComboData(a),r.setParent(s,a,tn)}),yield(o=i==null?void 0:i.draw({animation:!0}))==null?void 0:o.finished}));k(this,"setCursor",t=>{if(this.isDragging)return;const{type:r}=t,{canvas:i}=this.context,{cursor:a}=this.options;r===ht.POINTER_ENTER?i.setCursor((a==null?void 0:a.grab)||"grab"):i.setCursor((a==null?void 0:a.default)||"default")});this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}get animation(){return this.options.shadow?this.options.animation:!1}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.enableElements.forEach(r=>{t.on(`${r}:${ht.DRAG_START}`,this.onDragStart),t.on(`${r}:${ht.DRAG}`,this.onDrag),t.on(`${r}:${ht.DRAG_END}`,this.onDragEnd),t.on(`${r}:${ht.POINTER_ENTER}`,this.setCursor),t.on(`${r}:${ht.POINTER_LEAVE}`,this.setCursor)}),["link"].includes(this.options.dropEffect)&&(t.on(Bo.DROP,this.onDrop),t.on(xa.DROP,this.onDrop))}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(r=>r.id).concat(t)))}getDelta(t){const r=this.context.graph.getZoom();return As([t.dx,t.dy],r)}onDragStart(t){var a;if(this.enable=this.validate(t),!this.enable)return;const{batch:r,canvas:i}=this.context;i.setCursor(((a=this.options.cursor)==null?void 0:a.grabbing)||"grabbing"),this.isDragging=!0,r.startBatch(),this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(t){if(!this.enable)return;const r=this.getDelta(t);this.options.shadow?this.moveShadow(r):this.moveElement(this.target,r)}onDragEnd(){var i,a,o;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";const{x:s=0,y:l=0}=this.shadow.attributes,[c,u]=Nn([+s,+l],this.shadowOrigin);this.moveElement(this.target,[c,u])}this.showEdges(),(a=(i=this.options).onFinish)==null||a.call(i,this.target);const{batch:t,canvas:r}=this.context;t.endBatch(),r.setCursor(((o=this.options.cursor)==null?void 0:o.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}moveElement(t,r){return Ct(this,null,function*(){const{graph:i,model:a}=this.context,{dropEffect:o}=this.options;o==="move"&&t.forEach(s=>a.refreshComboData(s)),i.translateElementBy(Object.fromEntries(t.map(s=>[s,r])),!1)})}moveShadow(t){if(!this.shadow)return;const{x:r=0,y:i=0}=this.shadow.attributes,[a,o]=t;this.shadow.attr({x:+r+a,y:+i+o})}createShadow(t){const r=Rn(this.options,"shadow"),i=Il(t.map(u=>this.context.element.getElement(u).getBounds())),[a,o]=i.min;this.shadowOrigin=[a,o];const[s,l]=Ka(i),c={width:s,height:l,x:a,y:o};this.shadow?this.shadow.attr(_e(at(at({},r),c),{visibility:"visible"})):(this.shadow=new ea({style:_e(at(at({$layer:"transient"},r),c),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||this.hiddenEdges.length===0||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){const{hideEdge:t,shadow:r}=this.options;if(t==="none"||r)return;const{graph:i}=this.context;t==="all"?this.hiddenEdges=i.getEdgeData().map(it):this.hiddenEdges=Array.from(new Set(this.target.map(a=>i.getRelatedEdgesData(a,t).map(it)).flat())),i.hideElement(this.hiddenEdges)}unbindEvents(){const{graph:t}=this.context;this.enableElements.forEach(r=>{t.off(`${r}:${ht.DRAG_START}`,this.onDragStart),t.off(`${r}:${ht.DRAG}`,this.onDrag),t.off(`${r}:${ht.DRAG_END}`,this.onDragEnd),t.off(`${r}:${ht.POINTER_ENTER}`,this.setCursor),t.off(`${r}:${ht.POINTER_LEAVE}`,this.setCursor)}),t.off(`combo:${ht.DROP}`,this.onDrop),t.off(`canvas:${ht.DROP}`,this.onDrop)}destroy(){var t;this.unbindEvents(),(t=this.shadow)==null||t.destroy(),super.destroy()}};let Zl=Gg;k(Zl,"defaultOptions",{animation:!0,enable:t=>["node","combo"].includes(t.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}});var Hp=D(72137);class ix{constructor(e,t){k(this,"options");k(this,"context");k(this,"stop");k(this,"tick");this.context=e,this.options=t||{}}}function Qz(n){const{type:e}=n;return!!(["comboCombined","comboForce"].includes(e)||e==="antv-dagre"&&n.sortByCombo)}function gN(n){const{type:e}=n;return["compact-box","mindmap","dendrogram","indented"].includes(e)}function tW(n){return isNumber(n.x)&&isNumber(n.y)}function Ju(n){const{nodes:e,edges:t}=n,r={nodes:[],edges:[],combos:[]};return e.forEach(i=>{const a=i.data._isCombo?r.combos:r.nodes,{x:o,y:s,z:l=0}=i.data;a==null||a.push({id:i.id,style:{x:o,y:s,z:l}})}),t.forEach(i=>{const{id:a,source:o,target:s,data:{points:l=[],controlPoints:c=l.slice(1,l.length-1)}}=i;r.edges.push({id:a,source:o,target:s,style:at({},c!=null&&c.length?{controlPoints:c.map(Ir)}:{})})}),r}function mN(n,e){class t extends ix{constructor(a,o){super(a,o);k(this,"instance");k(this,"id");if(this.instance=new n({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){const s=this.instance;this.stop=s.stop.bind(s),this.tick=l=>{const c=s.tick(l);return Ju(c)}}}execute(a,o){return Ct(this,null,function*(){return Ju(yield this.instance.execute(this.graphData2LayoutModel(a),this.transformOptions(Pi({},this.options,o))))})}transformOptions(a){const{onTick:o}=a;return o&&(a.onTick=s=>o(Ju(s))),a}graphData2LayoutModel(a){const{nodes:o=[],edges:s=[],combos:l=[]}=a,c=o.map(p=>{const v=it(p),{data:g,style:m,combo:x}=p,S={id:v,data:at(at({},g),x?{parentId:x}:{}),style:at({},m)};return m!=null&&m.x&&Object.assign(S.data,{x:m.x}),m!=null&&m.y&&Object.assign(S.data,{y:m.y}),m!=null&&m.z&&Object.assign(S.data,{z:m.z}),S}),u=new Map(c.map(p=>[p.id,p])),h=s.filter(p=>{const{source:v,target:g}=p;return u.has(v)&&u.has(g)}).map(p=>{const{source:v,target:g,data:m,style:x}=p;return{id:it(p),source:v,target:g,data:at({},m),style:at({},x)}}),f=l.map(p=>({id:it(p),data:at({_isCombo:!0},p.data),style:at({},p.style)})),d=new Hp.k({nodes:[...c,...f],edges:h});return e.model.model.hasTreeStructure(tn)&&(d.attachTreeStructure(tn),c.forEach(p=>{const v=e.model.model.getParent(p.id,tn);v&&d.hasNode(v.id)&&d.setParent(p.id,v.id,tn)})),d}}return t}function Yp(n,e,...t){if(e in n)return n[e](...t);if("instance"in n){const r=n.instance;if(e in r)return r[e](...t)}return null}function ax(n,e){if(e in n)return n[e];if("instance"in n){const t=n.instance;if(e in t)return t[e]}return null}class yN extends Zl{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(e=>["d3-force","d3-force-3d"].includes(e==null?void 0:e.id))}validate(e){return this.context.layout?this.forceLayoutInstance?super.validate(e):(Lr.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1):!1}moveElement(e,t){return Ct(this,null,function*(){const r=this.forceLayoutInstance;this.context.graph.getNodeData(e).forEach((i,a)=>{const{x:o=0,y:s=0}=i.style||{};r&&Yp(r,"setFixedPosition",e[a],[...ge([+o,+s],t)])})})}onDragStart(e){if(this.enable=this.validate(e),!this.enable)return;this.target=this.getSelectedNodeIDs([e.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);const t=this.forceLayoutInstance;t&&ax(t,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(r=>{const{x:i=0,y:a=0}=r.style||{};t&&Yp(t,"setFixedPosition",it(r),[+i,+a])})}onDrag(e){if(!this.enable)return;const t=this.getDelta(e);this.moveElement(this.target,t)}onDragEnd(){const e=this.forceLayoutInstance;e&&ax(e,"simulation").alphaTarget(0),this.context.graph.getNodeData(this.target).forEach(t=>{e&&Yp(e,"setFixedPosition",it(t),[null,null,null])})}}const zg=class extends Mi{constructor(t,r){super(t,Object.assign({},zg.defaultOptions,r));k(this,"elementCache",new Map);k(this,"isZoomEvent",t=>"scale"in t.data);k(this,"fixElementSize",t=>Ct(this,null,function*(){if(!this.isZoomEvent(t)||!this.validate(t))return;const{graph:r,element:i}=this.context,{state:a}=this.options,o=a?[...r.getElementDataByState("node",a),...r.getElementDataByState("edge",a),...r.getElementDataByState("combo",a)]:Object.values(r.getData()).flat();if(!o.length)return;const s=t.data.scale||r.getZoom();o.forEach(l=>{const c=it(l),u=i==null?void 0:i.getElement(c),h=r.getElementType(c),f=this.options[h];if(!f){this.elementCache.set(c,u),h==="edge"&&(u.style.transformOrigin="center"),u.setLocalScale(1/s);return}const d=aA(u);(Array.isArray(f)?f:[f]).forEach(v=>{const{shape:g,fields:m}=v,x=g(d);m.forEach(S=>{P1(x,S)||T1(x,S);const T=ku(x,S);te(T)&&(x.style[S]=T/s)})})})}));k(this,"resetTransform",()=>Ct(this,null,function*(){this.elementCache&&(this.elementCache.forEach(t=>t.setLocalScale(1)),this.elementCache.clear())}));this.bindEvents()}bindEvents(){const{graph:t}=this.context;t.on(Mt.AFTER_TRANSFORM,this.fixElementSize),t.on(Mt.BEFORE_DRAW,this.resetTransform)}unbindEvents(){const{graph:t}=this.context;t.off(Mt.AFTER_TRANSFORM,this.fixElementSize),t.off(Mt.BEFORE_DRAW,this.resetTransform)}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}destroy(){this.unbindEvents(),super.destroy()}};let Qu=zg;k(Qu,"defaultOptions",{enable:t=>t.data.scale<1,state:"selected",edge:[{shape:t=>t.find(r=>r.className==="key"),fields:["lineWidth"]},{shape:t=>t.find(r=>{var i;return((i=r.parentElement)==null?void 0:i.className)==="label"&&r.className==="text"}),fields:["fontSize","lineHeight"]}]});const Wg=class extends Mi{constructor(t,r){super(t,Object.assign({},Wg.defaultOptions,r));k(this,"focus",t=>Ct(this,null,function*(){if(!this.validate(t))return;const{graph:r}=this.context;yield r.focusElement(t.target.id,this.options.animation)}));this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Go.forEach(r=>{t.on(`${r}:${ht.CLICK}`,this.focus)})}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}unbindEvents(){const{graph:t}=this.context;Go.forEach(r=>{t.off(`${r}:${ht.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),super.destroy()}};let th=Wg;k(th,"defaultOptions",{animation:{easing:"ease-in",duration:500},enable:!0});const Ug=class extends Mi{constructor(t,r){super(t,Object.assign({},Ug.defaultOptions,r));k(this,"isFrozen",!1);k(this,"toggleFrozen",t=>{this.isFrozen=t.type==="dragstart"});k(this,"hoverElement",t=>{if(!this.validate(t))return;const r=t.type===ht.POINTER_OVER;this.updateElementsState(t,r);const{onHover:i,onHoverEnd:a}=this.options;r?i==null||i(t):a==null||a(t)});k(this,"updateElementsState",(t,r)=>{if(!this.options.state&&!this.options.inactiveState)return;const{graph:i}=this.context,{state:a,degree:o,animation:s,inactiveState:l}=this.options,{targetType:c,target:u}=t,h=o?E1(i,c,u.id,o):[u.id],f={};if(a&&Object.assign(f,this.getElementsState(h,a,r)),l){const d=o1(i.getData(),!0).filter(p=>!h.includes(p));Object.assign(f,this.getElementsState(d,l,r))}i.setElementState(f,s)});k(this,"getElementsState",(t,r,i)=>{const{graph:a}=this.context,o={};return t.forEach(s=>{const l=a.getElementState(s),c=i?[...l,r]:l.filter(u=>u!==r);o[s]=c}),o});this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Go.forEach(i=>{t.on(`${i}:${ht.POINTER_OVER}`,this.hoverElement),t.on(`${i}:${ht.POINTER_OUT}`,this.hoverElement)});const r=this.context.canvas.document;r.addEventListener(`${ht.DRAG_START}`,this.toggleFrozen),r.addEventListener(`${ht.DRAG_END}`,this.toggleFrozen)}validate(t){if(this.destroyed||this.isFrozen||this.context.graph.isCollapsingExpanding)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}unbindEvents(){const{graph:t}=this.context;Go.forEach(i=>{t.off(`${i}:${ht.POINTER_OVER}`,this.hoverElement),t.off(`${i}:${ht.POINTER_OUT}`,this.hoverElement)});const r=this.context.canvas.document;r.removeEventListener(`${ht.DRAG_START}`,this.toggleFrozen),r.removeEventListener(`${ht.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}};let eh=Ug;k(eh,"defaultOptions",{animation:!1,enable:!0,degree:0,state:"active",inactiveState:void 0});class xN extends Gl{constructor(){super(...arguments);k(this,"points");k(this,"pathShape")}onPointerDown(t){if(!super.validate(t)||!super.isKeydown()||this.points)return;const{canvas:r}=this.context;this.pathShape=new Xa({id:"g6-lasso-select",style:this.options.style}),r.appendChild(this.pathShape),this.points=[Au(t)]}onPointerMove(t){var a;if(!this.points)return;const{immediately:r,mode:i}=this.options;this.points.push(Au(t)),(a=this.pathShape)==null||a.setAttribute("d",eA(this.points)),r&&i==="default"&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var t;(t=this.pathShape)==null||t.remove(),this.pathShape=void 0,this.points=void 0}}const Vg=class extends Mi{constructor(t,r){super(t,Object.assign({},Vg.defaultOptions,r));k(this,"isVisible",!0);k(this,"setElementsVisibility",(t,r,i)=>{t.forEach(a=>{Vl(a,r,!1,o=>o.className?!(i!=null&&i.includes(o.className)):!0)})});k(this,"hideShapes",t=>{if(!this.validate(t)||!this.isVisible)return;const{element:r}=this.context,{shapes:i={}}=this.options;this.setElementsVisibility(r.getNodes(),"hidden",i.node),this.setElementsVisibility(r.getEdges(),"hidden",i.edge),this.setElementsVisibility(r.getCombos(),"hidden",i.combo),this.isVisible=!1});k(this,"showShapes",Zu(t=>{if(!this.validate(t)||this.isVisible)return;const{element:r}=this.context;this.setElementsVisibility(r.getNodes(),"visible"),this.setElementsVisibility(r.getEdges(),"visible"),this.setElementsVisibility(r.getCombos(),"visible"),this.isVisible=!0},this.options.debounce));this.bindEvents()}bindEvents(){const{graph:t}=this.context;t.on(Mt.BEFORE_TRANSFORM,this.hideShapes),t.on(Mt.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){const{graph:t}=this.context;t.off(Mt.BEFORE_TRANSFORM,this.hideShapes),t.off(Mt.AFTER_TRANSFORM,this.showShapes)}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}destroy(){this.unbindEvents(),super.destroy()}};let nh=Vg;k(nh,"defaultOptions",{enable:!0,debounce:200,shapes:{node:["key"]}});const Hg=class extends Mi{constructor(t,r){super(t,Object.assign({},Hg.defaultOptions,r));k(this,"shortcut");k(this,"onWheel",t=>Ct(this,null,function*(){this.options.preventDefault&&t.preventDefault();const r=t.deltaX,i=t.deltaY;yield this.scroll([-r,-i],t)}));this.shortcut=new Ns(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var r,i;const{trigger:t}=this.options;if(this.shortcut.unbindAll(),Ye(t)){(r=this.graphDom)==null||r.removeEventListener(ht.WHEEL,this.onWheel);const{up:a=[],down:o=[],left:s=[],right:l=[]}=t;this.shortcut.bind(a,c=>this.scroll([0,-10],c)),this.shortcut.bind(o,c=>this.scroll([0,10],c)),this.shortcut.bind(s,c=>this.scroll([-10,0],c)),this.shortcut.bind(l,c=>this.scroll([10,0],c))}else(i=this.graphDom)==null||i.addEventListener(ht.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement([t,r]){const{direction:i,sensitivity:a}=this.options;return t=t*a,r=r*a,i==="x"?r=0:i==="y"&&(t=0),[t,r]}scroll(t,r){return Ct(this,null,function*(){if(!this.validate(r))return;const{onFinish:i}=this.options,a=this.context.graph,o=this.formatDisplacement(t);yield a.translateBy(o,!1),i==null||i()})}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}destroy(){var t;this.shortcut.destroy(),(t=this.graphDom)==null||t.removeEventListener(ht.WHEEL,this.onWheel),super.destroy()}};let rh=Hg;k(rh,"defaultOptions",{enable:!0,sensitivity:1,preventDefault:!0});const Yg=class extends Mi{constructor(t,r){super(t,Object.assign({},Yg.defaultOptions,r));k(this,"shortcut");k(this,"zoom",(t,r,i)=>Ct(this,null,function*(){if(!this.validate(r))return;const{graph:a}=this.context;let o;"viewport"in r&&(o=Ir(r.viewport));const{sensitivity:s,onFinish:l}=this.options,c=1+he(t,-50,50)*s/100,u=a.getZoom();yield a.zoomTo(u*c,i,o),l==null||l()}));k(this,"onReset",()=>Ct(this,null,function*(){yield this.context.graph.zoomTo(1,this.options.animation)}));k(this,"preventDefault",t=>{this.options.preventDefault&&t.preventDefault()});this.shortcut=new Ns(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var r;const{trigger:t}=this.options;if(this.shortcut.unbindAll(),Array.isArray(t)&&((r=this.context.canvas.getContainer())==null||r.addEventListener(ht.WHEEL,this.preventDefault),this.shortcut.bind([...t,ht.WHEEL],i=>{const{deltaX:a,deltaY:o}=i;this.zoom(-(o!=null?o:a),i,!1)})),typeof t=="object"){const{zoomIn:i=[],zoomOut:a=[],reset:o=[]}=t;this.shortcut.bind(i,s=>this.zoom(10,s,this.options.animation)),this.shortcut.bind(a,s=>this.zoom(-10,s,this.options.animation)),this.shortcut.bind(o,this.onReset)}}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}destroy(){var t;this.shortcut.destroy(),(t=this.context.canvas.getContainer())==null||t.removeEventListener(ht.WHEEL,this.preventDefault),super.destroy()}};let ih=Yg;k(ih,"defaultOptions",{animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0});var ah=D(81746),bN=D(28104),EN=D(63795),wN=D(39233),SN=D(5192),_N=D(76750),TN=D(51712),PN=D(67753),MN=D(12368),CN=D(89469),ON=D(41733),AN=D(64912),NN=D(29257),RN=D(26629);const kN=["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],LN=["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],IN=["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],DN=["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],BN=["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"];var FN=function(n,e,t){if(!tr(n)&&!Ps(n))return n;var r=t;return B1(n,function(i,a){r=e(r,i,a)}),r},GN=FN,Xp=function(n,e){return GN(n,function(t,r,i){return e.includes(i)||(t[i]=r),t},{})};const Gs=n=>n?parseInt(n):0;function zN(n){const e=getComputedStyle(n),t=n.clientWidth||Gs(e.width),r=n.clientHeight||Gs(e.height),i=Gs(e.paddingLeft)+Gs(e.paddingRight),a=Gs(e.paddingTop)+Gs(e.paddingBottom);return[t-i,r-a]}function ox(n){let e=640,t=480;const[r,i]=zN(n);e=r||e,t=i||t;const a=1,o=1;return[Math.max(te(e)?e:a,a),Math.max(te(t)?t:o,o)]}function ql(n,e=!0){const t=document.createElement("div");return t.setAttribute("class",`g6-${n}`),t.style.position="absolute",t.style.display="block",e&&(t.style.inset="0px",t.style.height="100%",t.style.width="100%",t.style.overflow="hidden",t.style.pointerEvents="none"),t}function jp(n,e="div",t={},r="",i=document.body){const a=document.getElementById(n);a&&a.remove();const o=document.createElement(e);return o.innerHTML=r,o.id=n,Object.assign(o.style,t),i.appendChild(o),o}function WN(n,e){const t=n.firstChild;t?n.insertBefore(e,t):n.appendChild(e)}class mr extends mp{}const Hf=class extends mr{constructor(t,r){super(t,Object.assign({},Hf.defaultOptions,r));k(this,"$element",ql("background"));this.context.canvas.getContainer().prepend(this.$element),this.update(r)}update(t){return Ct(this,null,function*(){$f(Hf.prototype,this,"update").call(this,t),Object.assign(this.$element.style,Xp(this.options,["key","type"]))})}destroy(){super.destroy(),this.$element.remove()}};let oh=Hf;k(oh,"defaultOptions",{transition:"background 0.5s",backgroundSize:"cover"});function $p(n,e,t,r,i,a){const o=n,s=e,l=t-o,c=r-s;let u=i-o,h=a-s,f=u*l+h*c,d=0;f<=0?d=0:(u=l-u,h=c-h,f=u*l+h*c,f<=0?d=0:d=f*f/(l*l+c*c));const p=u*u+h*h-d;return p<0?0:p}function eo(n,e,t,r){return(n-t)*(n-t)+(e-r)*(e-r)}function sx(n,e,t,r,i){return eo(n,e,t,r)<i*i}function UN(n){if(!Number.isFinite(n))return t=>t;if(n===0)return Math.round;const e=Math.pow(10,n);return t=>Math.round(t*e)/e}function lx(n){const e=Math.min(n.x1,n.x2),t=Math.max(n.x1,n.x2),r=Math.min(n.y1,n.y2),i=Math.max(n.y1,n.y2);return{x:e,y:r,x2:t,y2:i,width:t-e,height:i-r}}class Bn{constructor(e,t,r,i){this.x1=e,this.y1=t,this.x2=r,this.y2=i}equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2}draw(e){e.moveTo(this.x1,this.y1),e.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(e){return new Bn(e.x1,e.y1,e.x2,e.y2)}cuts(e,t){if(this.y1===this.y2||t<this.y1&&t<=this.y2||t>this.y1&&t>=this.y2||e>this.x1&&e>=this.x2)return!1;if(e<this.x1&&e<=this.x2)return!0;const r=this.x1+(t-this.y1)*(this.x2-this.x1)/(this.y2-this.y1);return e<=r}distSquare(e,t){return $p(this.x1,this.y1,this.x2,this.y2,e,t)}ptClose(e,t,r){if(this.x1<this.x2){if(e<this.x1-r||e>this.x2+r)return!1}else if(e<this.x2-r||e>this.x1+r)return!1;if(this.y1<this.y2){if(t<this.y1-r||t>this.y2+r)return!1}else if(t<this.y2-r||t>this.y1+r)return!1;return!0}}var mn;(function(n){n[n.POINT=1]="POINT",n[n.PARALLEL=2]="PARALLEL",n[n.COINCIDENT=3]="COINCIDENT",n[n.NONE=4]="NONE"})(mn||(mn={}));class Kp{constructor(e,t=0,r=0){this.state=e,this.x=t,this.y=r}}function sh(n,e){const t=(e.x2-e.x1)*(n.y1-e.y1)-(e.y2-e.y1)*(n.x1-e.x1),r=(n.x2-n.x1)*(n.y1-e.y1)-(n.y2-n.y1)*(n.x1-e.x1),i=(e.y2-e.y1)*(n.x2-n.x1)-(e.x2-e.x1)*(n.y2-n.y1);if(i){const a=t/i,o=r/i;return 0<=a&&a<=1&&0<=o&&o<=1?new Kp(mn.POINT,n.x1+a*(n.x2-n.x1),n.y1+a*(n.y2-n.y1)):new Kp(mn.NONE)}return new Kp(t===0||r===0?mn.COINCIDENT:mn.PARALLEL)}function cx(n,e){const t=(e.x2-e.x1)*(n.y1-e.y1)-(e.y2-e.y1)*(n.x1-e.x1),r=(n.x2-n.x1)*(n.y1-e.y1)-(n.y2-n.y1)*(n.x1-e.x1),i=(e.y2-e.y1)*(n.x2-n.x1)-(e.x2-e.x1)*(n.y2-n.y1);if(i){const a=t/i,o=r/i;if(0<=a&&a<=1&&0<=o&&o<=1)return a}return Number.POSITIVE_INFINITY}function VN(n,e){function t(i,a,o,s){let l=cx(e,new Bn(i,a,o,s));return l=Math.abs(l-.5),l>=0&&l<=1?1:0}let r=t(n.x,n.y,n.x2,n.y);return r+=t(n.x,n.y,n.x,n.y2),r>1||(r+=t(n.x,n.y2,n.x2,n.y2),r>1)?!0:(r+=t(n.x2,n.y,n.x2,n.y2),r>0)}var yn;(function(n){n[n.LEFT=0]="LEFT",n[n.TOP=1]="TOP",n[n.RIGHT=2]="RIGHT",n[n.BOTTOM=3]="BOTTOM"})(yn||(yn={}));function lh(n,e,t){const r=new Set;return n.width<=0?(r.add(yn.LEFT),r.add(yn.RIGHT)):e<n.x?r.add(yn.LEFT):e>n.x+n.width&&r.add(yn.RIGHT),n.height<=0?(r.add(yn.TOP),r.add(yn.BOTTOM)):t<n.y?r.add(yn.TOP):t>n.y+n.height&&r.add(yn.BOTTOM),r}function ux(n,e){let t=e.x1,r=e.y1;const i=e.x2,a=e.y2,o=Array.from(lh(n,i,a));if(o.length===0)return!0;let s=lh(n,t,r);for(;s.size!==0;){for(const l of o)if(s.has(l))return!1;if(s.has(yn.RIGHT)||s.has(yn.LEFT)){let l=n.x;s.has(yn.RIGHT)&&(l+=n.width),r=r+(l-t)*(a-r)/(i-t),t=l}else{let l=n.y;s.has(yn.BOTTOM)&&(l+=n.height),t=t+(l-r)*(i-t)/(a-r),r=l}s=lh(n,t,r)}return!0}function HN(n,e){let t=Number.POSITIVE_INFINITY,r=0;function i(a,o,s,l){let c=cx(e,new Bn(a,o,s,l));c=Math.abs(c-.5),c>=0&&c<=1&&(r++,c<t&&(t=c))}return i(n.x,n.y,n.x2,n.y),i(n.x,n.y,n.x,n.y2),r>1||(i(n.x,n.y2,n.x2,n.y2),r>1)?t:(i(n.x2,n.y,n.x2,n.y2),r===0?-1:t)}function YN(n,e){let t=0;const r=sh(n,new Bn(e.x,e.y,e.x2,e.y));t+=r.state===mn.POINT?1:0;const i=sh(n,new Bn(e.x,e.y,e.x,e.y2));t+=i.state===mn.POINT?1:0;const a=sh(n,new Bn(e.x,e.y2,e.x2,e.y2));t+=a.state===mn.POINT?1:0;const o=sh(n,new Bn(e.x2,e.y,e.x2,e.y2));return t+=o.state===mn.POINT?1:0,{top:r,left:i,bottom:a,right:o,count:t}}class rr{constructor(e,t,r,i){this.x=e,this.y=t,this.width=r,this.height=i}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(e){return new rr(e.x,e.y,e.width,e.height)}equals(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height}clone(){return new rr(this.x,this.y,this.width,this.height)}add(e){const t=Math.min(this.x,e.x),r=Math.min(this.y,e.y),i=Math.max(this.x2,e.x+e.width),a=Math.max(this.y2,e.y+e.height);this.x=t,this.y=r,this.width=i-t,this.height=a-r}addPoint(e){const t=Math.min(this.x,e.x),r=Math.min(this.y,e.y),i=Math.max(this.x2,e.x),a=Math.max(this.y2,e.y);this.x=t,this.y=r,this.width=i-t,this.height=a-r}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(e){e.rect(this.x,this.y,this.width,this.height)}containsPt(e,t){return e>=this.x&&e<=this.x2&&t>=this.y&&t<=this.y2}get area(){return this.width*this.height}intersects(e){return this.area<=0||e.width<=0||e.height<=0?!1:e.x+e.width>this.x&&e.y+e.height>this.y&&e.x<this.x2&&e.y<this.y2}distSquare(e,t){if(this.containsPt(e,t))return 0;const r=lh(this,e,t);return r.has(yn.TOP)?r.has(yn.LEFT)?eo(e,t,this.x,this.y):r.has(yn.RIGHT)?eo(e,t,this.x2,this.y):(this.y-t)*(this.y-t):r.has(yn.BOTTOM)?r.has(yn.LEFT)?eo(e,t,this.x,this.y2):r.has(yn.RIGHT)?eo(e,t,this.x2,this.y2):(t-this.y2)*(t-this.y2):r.has(yn.LEFT)?(this.x-e)*(this.x-e):r.has(yn.RIGHT)?(e-this.x2)*(e-this.x2):0}}function XN(n){if(n.length===0)return null;const e=n[0],t=new rr(e.x,e.y,0,0);for(const r of n)t.addPoint(r);return t}class ch{constructor(e,t,r){this.cx=e,this.cy=t,this.radius=r}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return this.radius*2}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return this.radius*2}static from(e){return new ch(e.cx,e.cy,e.radius)}containsPt(e,t){return eo(this.cx,this.cy,e,t)<this.radius*this.radius}distSquare(e,t){const r=eo(this.cx,this.cy,e,t);if(r<this.radius*this.radius)return 0;const i=Math.sqrt(r)-this.radius;return i*i}draw(e){e.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,Math.PI*2)}}class Vo{constructor(e,t=0,r=0,i=0,a=0,o=10,s=10,l=new Float32Array(Math.max(0,o*s)).fill(0)){this.pixelGroup=e,this.i=t,this.j=r,this.pixelX=i,this.pixelY=a,this.width=o,this.height=s,this.area=l}createSub(e,t){return new Vo(this.pixelGroup,e.x,e.y,t.x,t.y,e.width,e.height)}static fromPixelRegion(e,t){return new Vo(t,0,0,e.x,e.y,Math.ceil(e.width/t),Math.ceil(e.height/t))}copy(e,t){return new Vo(this.pixelGroup,this.scaleX(t.x),this.scaleY(t.y),t.x,t.y,e.width,e.height,e.area)}boundX(e){return e<this.i?this.i:e>=this.width?this.width-1:e}boundY(e){return e<this.j?this.j:e>=this.height?this.height-1:e}scaleX(e){return this.boundX(Math.floor((e-this.pixelX)/this.pixelGroup))}scaleY(e){return this.boundY(Math.floor((e-this.pixelY)/this.pixelGroup))}scale(e){const t=this.scaleX(e.x),r=this.scaleY(e.y),i=this.boundX(Math.ceil((e.x+e.width-this.pixelX)/this.pixelGroup)),a=this.boundY(Math.ceil((e.y+e.height-this.pixelY)/this.pixelGroup)),o=i-t,s=a-r;return new rr(t,r,o,s)}invertScaleX(e){return Math.round(e*this.pixelGroup+this.pixelX)}invertScaleY(e){return Math.round(e*this.pixelGroup+this.pixelY)}addPadding(e,t){const r=Math.ceil(t/this.pixelGroup),i=this.boundX(e.x-r),a=this.boundY(e.y-r),o=this.boundX(e.x2+r),s=this.boundY(e.y2+r),l=o-i,c=s-a;return new rr(i,a,l,c)}get(e,t){return e<0||t<0||e>=this.width||t>=this.height?Number.NaN:this.area[e+t*this.width]}inc(e,t,r){e<0||t<0||e>=this.width||t>=this.height||(this.area[e+t*this.width]+=r)}set(e,t,r){e<0||t<0||e>=this.width||t>=this.height||(this.area[e+t*this.width]=r)}incArea(e,t){if(e.width<=0||e.height<=0||t===0)return;const r=this.width,i=e.width,a=Math.max(0,e.i),o=Math.max(0,e.j),s=Math.min(e.i+e.width,r),l=Math.min(e.j+e.height,this.height);if(!(l<=0||s<=0||a>=r||l>=this.height))for(let c=o;c<l;c++){const u=(c-e.j)*i,h=c*r;for(let f=a;f<s;f++){const d=e.area[f-e.i+u];d!==0&&(this.area[f+h]+=t*d)}}}fill(e){this.area.fill(e)}fillArea(e,t){const r=e.x+e.y*this.width;for(let i=0;i<e.height;i++){const a=r+i*this.width;this.area.fill(t,a,a+e.width)}}fillHorizontalLine(e,t,r,i){const a=e+t*this.width;this.area.fill(i,a,a+r)}fillVerticalLine(e,t,r,i){const a=e+t*this.width;for(let o=0;o<r;o++)this.area[a+o*this.width]=i}clear(){this.area.fill(0)}toString(){let e="";for(let t=0;t<this.height;t++){const r=t*this.width;for(let i=0;i<this.width;i++){const a=this.area[r+i];e+=a.toFixed(1).padStart(6),e+=" "}e+=`
`}return e}draw(e,t=!0){if(this.width<=0||this.height<=0)return;e.save(),t&&e.translate(this.pixelX,this.pixelY);const r=this.area.reduce((o,s)=>Math.min(o,s),Number.POSITIVE_INFINITY),i=this.area.reduce((o,s)=>Math.max(o,s),Number.NEGATIVE_INFINITY),a=o=>(o-r)/(i-r);e.scale(this.pixelGroup,this.pixelGroup);for(let o=0;o<this.width;o++)for(let s=0;s<this.height;s++){const l=this.area[o+s*this.width];e.fillStyle=`rgba(0, 0, 0, ${a(l)})`,e.fillRect(o,s,1,1)}e.restore()}drawThreshold(e,t,r=!0){if(!(this.width<=0||this.height<=0)){e.save(),r&&e.translate(this.pixelX,this.pixelY),e.scale(this.pixelGroup,this.pixelGroup);for(let i=0;i<this.width;i++)for(let a=0;a<this.height;a++){const o=this.area[i+a*this.width];e.fillStyle=o>t?"black":"white",e.fillRect(i,a,1,1)}e.restore()}}}function hx(n,e){const t=r=>({x:r.x-e,y:r.y-e,width:r.width+2*e,height:r.height+2*e});return Array.isArray(n)?n.map(t):t(n)}function fx(n,e,t){return dx(Object.assign(lx(n),{distSquare:(r,i)=>$p(n.x1,n.y1,n.x2,n.y2,r,i)}),e,t)}function dx(n,e,t){const r=hx(n,t),i=e.scale(r),a=e.createSub(i,r);return jN(a,e,t,(o,s)=>n.distSquare(o,s)),a}function jN(n,e,t,r){const i=t*t;for(let a=0;a<n.height;a++)for(let o=0;o<n.width;o++){const s=e.invertScaleX(n.i+o),l=e.invertScaleY(n.j+a),c=r(s,l);if(c===0){n.set(o,a,i);continue}if(c<i){const u=t-Math.sqrt(c);n.set(o,a,u*u)}}return n}function $N(n,e,t){const r=e.scale(n),i=e.addPadding(r,t),a=e.createSub(i,{x:n.x-t,y:n.y-t}),o=r.x-i.x,s=r.y-i.y,l=i.x2-r.x2,c=i.y2-r.y2,u=i.width-o-l,h=i.height-s-c,f=t*t;a.fillArea({x:o,y:s,width:u+1,height:h+1},f);const d=[0],p=Math.max(s,o,l,c);{const x=e.invertScaleX(r.x+r.width/2);for(let S=1;S<p;S++){const T=e.invertScaleY(r.y-S),b=n.distSquare(x,T);if(b<f){const y=t-Math.sqrt(b);d.push(y*y)}else break}}const v=[],g=Math.max(o,l),m=Math.max(s,l);for(let x=1;x<g;x++){const S=e.invertScaleX(r.x-x),T=[];for(let b=1;b<m;b++){const y=e.invertScaleY(r.y-b),E=n.distSquare(S,y);if(E<f){const w=t-Math.sqrt(E);T.push(w*w)}else T.push(0)}v.push(T)}for(let x=1;x<Math.min(s,d.length);x++){const S=d[x];a.fillHorizontalLine(o,s-x,u+1,S)}for(let x=1;x<Math.min(c,d.length);x++){const S=d[x];a.fillHorizontalLine(o,s+h+x,u+1,S)}for(let x=1;x<Math.min(o,d.length);x++){const S=d[x];a.fillVerticalLine(o-x,s,h+1,S)}for(let x=1;x<Math.min(c,d.length);x++){const S=d[x];a.fillVerticalLine(o+u+x,s,h+1,S)}for(let x=1;x<o;x++){const S=v[x-1],T=o-x;for(let b=1;b<s;b++)a.set(T,s-b,S[b-1]);for(let b=1;b<c;b++)a.set(T,s+h+b,S[b-1])}for(let x=1;x<l;x++){const S=v[x-1],T=o+u+x;for(let b=1;b<s;b++)a.set(T,s-b,S[b-1]);for(let b=1;b<c;b++)a.set(T,s+h+b,S[b-1])}return a}function eW(n,e,t,r){return{x:n,y:e,width:t,height:r}}function nW(n,e,t){return{cx:n,cy:e,radius:t}}function rW(n,e,t,r){return{x1:n,y1:e,x2:t,y2:r}}function en(n,e){return{x:n,y:e}}function KN(n,e,t,r){if(n.length===0)return[];const i=tR(n);return i.map((a,o)=>{const s=i.slice(0,o);return ZN(e,a,s,t,r)}).flat()}function ZN(n,e,t,r,i){const a=en(e.cx,e.cy),o=QN(a,t,n);if(o==null)return[];const s=new Bn(a.x,a.y,o.cx,o.cy),l=qN(s,n,r,i);return JN(l,n)}function qN(n,e,t,r){const i=[],a=[];a.push(n);let o=!0;for(let s=0;s<t&&o;s++)for(o=!1;!o&&a.length>0;){const l=a.pop(),c=px(e,l),u=c?YN(l,c):null;if(!c||!u||u.count!==2){o||i.push(l);continue}let h=r,f=hh(c,h,u,!0),d=no(f,a)||no(f,i),p=uh(f,e);for(;!d&&p&&h>=1;)h/=1.5,f=hh(c,h,u,!0),d=no(f,a)||no(f,i),p=uh(f,e);if(f&&!d&&!p&&(a.push(new Bn(l.x1,l.y1,f.x,f.y)),a.push(new Bn(f.x,f.y,l.x2,l.y2)),o=!0),o)continue;h=r,f=hh(c,h,u,!1);let v=no(f,a)||no(f,i);for(p=uh(f,e);!v&&p&&h>=1;)h/=1.5,f=hh(c,h,u,!1),v=no(f,a)||no(f,i),p=uh(f,e);f&&!v&&(a.push(new Bn(l.x1,l.y1,f.x,f.y)),a.push(new Bn(f.x,f.y,l.x2,l.y2)),o=!0),o||i.push(l)}for(;a.length>0;)i.push(a.pop());return i}function JN(n,e){const t=[];for(;n.length>0;){const r=n.pop();if(n.length===0){t.push(r);break}const i=n.pop(),a=new Bn(r.x1,r.y1,i.x2,i.y2);px(e,a)?(t.push(r),n.push(i)):n.push(a)}return t}function QN(n,e,t){let r=Number.POSITIVE_INFINITY;return e.reduce((i,a)=>{const o=eo(n.x,n.y,a.cx,a.cy);if(o>r)return i;const s=new Bn(n.x,n.y,a.cx,a.cy),l=eR(t,s);return o*(l+1)*(l+1)<r&&(i=a,r=o*(l+1)*(l+1)),i},null)}function tR(n){if(n.length<2)return n;let e=0,t=0;return n.forEach(r=>{e+=r.cx,t+=r.cy}),e/=n.length,t/=n.length,n.map(r=>{const i=e-r.cx,a=t-r.cy,o=i*i+a*a;return[r,o]}).sort((r,i)=>r[1]-i[1]).map(r=>r[0])}function uh(n,e){return e.some(t=>t.containsPt(n.x,n.y))}function no(n,e){return e.some(t=>!!(sx(t.x1,t.y1,n.x,n.y,.001)||sx(t.x2,t.y2,n.x,n.y,.001)))}function px(n,e){let t=Number.POSITIVE_INFINITY,r=null;for(const i of n){if(!ux(i,e))continue;const a=HN(i,e);a>=0&&a<t&&(r=i,t=a)}return r}function eR(n,e){return n.reduce((t,r)=>ux(r,e)&&VN(r,e)?t+1:t,0)}function hh(n,e,t,r){const i=t.top,a=t.left,o=t.bottom,s=t.right;if(r){if(a.state===mn.POINT){if(i.state===mn.POINT)return en(n.x-e,n.y-e);if(o.state===mn.POINT)return en(n.x-e,n.y2+e);const f=n.width*n.height;return n.width*((a.y-n.y+(s.y-n.y))*.5)<f*.5?a.y>s.y?en(n.x-e,n.y-e):en(n.x2+e,n.y-e):a.y<s.y?en(n.x-e,n.y2+e):en(n.x2+e,n.y2+e)}if(s.state===mn.POINT){if(i.state===mn.POINT)return en(n.x2+e,n.y-e);if(o.state===mn.POINT)return en(n.x2+e,n.y2+e)}const u=n.height*n.width;return n.height*((i.x-n.x+(s.x-n.x))*.5)<u*.5?i.x>o.x?en(n.x-e,n.y-e):en(n.x-e,n.y2+e):i.x<o.x?en(n.x2+e,n.y-e):en(n.x2+e,n.y2+e)}if(a.state===mn.POINT){if(i.state===mn.POINT)return en(n.x2+e,n.y2+e);if(o.state===mn.POINT)return en(n.x2+e,n.y-e);const u=n.height*n.width;return n.width*((a.y-n.y+(s.y-n.y))*.5)<u*.5?a.y>s.y?en(n.x2+e,n.y2+e):en(n.x-e,n.y2+e):a.y<s.y?en(n.x2+e,n.y-e):en(n.x-e,n.y-e)}if(s.state===mn.POINT){if(i.state===mn.POINT)return en(n.x-e,n.y2+e);if(o.state===mn.POINT)return en(n.x-e,n.y-e)}const l=n.height*n.width;return n.height*((i.x-n.x+(s.x-n.x))*.5)<l*.5?i.x>o.x?en(n.x2+e,n.y2+e):en(n.x2+e,n.y-e):i.x<o.x?en(n.x-e,n.y2+e):en(n.x-e,n.y-e)}function nR(n,e,t,r){if(!(n.closed?t<n.length:t<n.length-1))return!1;const a=n.get(e),o=n.get(t+1);for(let s=e+1;s<=t;s++){const l=n.get(s);if($p(a.x,a.y,o.x,o.y,l.x,l.y)>r)return!1}return!0}function rR(n=0){return e=>{if(n<0||e.length<3)return e;const t=[];let r=0;const i=n*n;for(;r<e.length;){let a=r+1;for(;nR(e,r,a,i);)a++;t.push(e.get(r)),r=a}return new Ho(t)}}function iR(n,e){switch(n){case-2:return(((-e+3)*e-3)*e+1)/6;case-1:return((3*e-6)*e*e+4)/6;case 0:return(((-3*e+3)*e+3)*e+1)/6;case 1:return e*e*e/6;default:throw new Error("unknown error")}}function aR(n=6){function a(o,s,l){let c=0,u=0;for(let h=-2;h<=1;h++){const f=o.get(s+h),d=iR(h,l);c+=d*f.x,u+=d*f.y}return{x:c,y:u}}return o=>{if(o.length<3)return o;const s=[],l=o.closed,c=o.length+3-1+(l?0:2);s.push(a(o,2-(l?0:2),0));for(let u=2-(l?0:2);u<c;u++)for(let h=1;h<=n;h++)s.push(a(o,u,h/n));return new Ho(s)}}function oR(n=8){return e=>{let t=n,r=e.length;if(t>1)for(r=Math.floor(e.length/t);r<3&&t>1;)t-=1,r=Math.floor(e.length/t);const i=[];for(let a=0,o=0;o<r;o++,a+=t)i.push(e.get(a));return new Ho(i)}}class Ho{constructor(e=[],t=!0){this.points=e,this.closed=t}get(e){const t=e,r=this.points.length;return e<0?this.closed?this.get(e+r):this.points[0]:e>=r?this.closed?this.get(e-r):this.points[r-1]:this.points[t]}get length(){return this.points.length}toString(e=1/0){const t=this.points;if(t.length===0)return"";const r=typeof e=="function"?e:UN(e);let i="M";for(const a of t)i+=`${r(a.x)},${r(a.y)} L`;return i=i.slice(0,-1),this.closed&&(i+=" Z"),i}draw(e){const t=this.points;if(t.length!==0){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(const r of t)e.lineTo(r.x,r.y);this.closed&&e.closePath()}}sample(e){return oR(e)(this)}simplify(e){return rR(e)(this)}bSplines(e){return aR(e)(this)}apply(e){return e(this)}containsElements(e){const t=XN(this.points);return t?e.every(r=>t.containsPt(r.cx,r.cy)&&this.withinArea(r.cx,r.cy)):!1}withinArea(e,t){if(this.length===0)return!1;let r=0;const i=this.points[0],a=new Bn(i.x,i.y,i.x,i.y);for(let o=1;o<this.points.length;o++){const s=this.points[o];a.x1=a.x2,a.y1=a.y2,a.x2=s.x,a.y2=s.y,a.cuts(e,t)&&r++}return a.x1=a.x2,a.y1=a.y2,a.x2=i.x,a.y2=i.y,a.cuts(e,t)&&r++,r%2===1}}class sR{constructor(e=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=e}add(e){this.set.add(`${e.x}x${e.y}`),this.arr[this.count++]=e}contains(e){return this.set.has(`${e.x}x${e.y}`)}isFirst(e){if(this.count===0)return!1;const t=this.arr[0];return t!=null&&t.x===e.x&&t.y===e.y}path(){return new Ho(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(e){return this.arr[e]}get length(){return this.count}}const Jl=0,fh=1,dh=2,Zp=3;function lR(n,e){const t=(Math.floor(n.width)+Math.floor(n.height))*2,r=new sR(t);function i(l,c,u,h){const f=n.get(l,c);return Number.isNaN(f)?Number.NaN:f>e?u+h:u}function a(l,c){let u=Jl;return u=i(l,c,u,1),u=i(l+1,c,u,2),u=i(l,c+1,u,4),u=i(l+1,c+1,u,8),Number.isNaN(u)?-1:u}let o=fh;function s(l,c){let u=l,h=c,f=n.invertScaleX(u),d=n.invertScaleY(h);for(let p=0;p<n.width*n.height;p++){const v={x:f,y:d};if(r.contains(v)){if(r.isFirst(v))return!0}else r.add(v);const g=a(u,h);switch(g){case-1:return!0;case 0:case 3:case 2:case 7:o=dh;break;case 12:case 14:case 4:o=Zp;break;case 6:o=o===Jl?Zp:dh;break;case 1:case 13:case 5:o=Jl;break;case 9:o=o===dh?Jl:fh;break;case 10:case 8:case 11:o=fh;break;default:return console.warn("Marching squares invalid state: "+g),!0}switch(o){case Jl:h--,d-=n.pixelGroup;break;case fh:h++,d+=n.pixelGroup;break;case Zp:u--,f-=n.pixelGroup;break;case dh:u++,f+=n.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+g),!0}}return!0}for(let l=0;l<n.width;l++)for(let c=0;c<n.height;c++){if(n.get(l,c)<=e)continue;const u=a(l,c);if(!(u<0||u===15)&&s(l,c))return r.path()}return null}const ph={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function Ql(n){return n!=null&&typeof n.radius=="number"}function vx(n,e){if(Ql(n)!==Ql(e))return!1;if(Ql(n)){const r=e;return n.cx===r.cx&&n.cy===r.cy&&n.radius===r.radius}const t=e;return n.x===t.x&&n.y===t.y&&n.width===t.width&&n.height===t.height}var Vi;(function(n){n[n.MEMBERS=0]="MEMBERS",n[n.NON_MEMBERS=1]="NON_MEMBERS",n[n.EDGES=2]="EDGES"})(Vi||(Vi={}));class qp{constructor(e={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new rr(0,0,0,0),this.potentialArea=new Vo(1,0,0,0,0,0,0),this.o=Object.assign({},ph,e)}pushMember(...e){if(e.length!==0){this.dirty.add(Vi.MEMBERS);for(const t of e)this.members.push({raw:t,obj:Ql(t)?ch.from(t):rr.from(t),area:null})}}removeMember(e){const t=this.members.findIndex(r=>vx(r.raw,e));return t<0?!1:(this.members.splice(t,1),this.dirty.add(Vi.MEMBERS),!0)}removeNonMember(e){const t=this.nonMembers.findIndex(r=>vx(r.raw,e));return t<0?!1:(this.nonMembers.splice(t,1),this.dirty.add(Vi.NON_MEMBERS),!0)}removeEdge(e){const t=this.edges.findIndex(r=>r.obj.equals(e));return t<0?!1:(this.edges.splice(t,1),this.dirty.add(Vi.NON_MEMBERS),!0)}pushNonMember(...e){if(e.length!==0){this.dirty.add(Vi.NON_MEMBERS);for(const t of e)this.nonMembers.push({raw:t,obj:Ql(t)?ch.from(t):rr.from(t),area:null})}}pushEdge(...e){if(e.length!==0){this.dirty.add(Vi.EDGES);for(const t of e)this.edges.push({raw:t,obj:Bn.from(t),area:null})}}update(){const e=this.dirty.has(Vi.MEMBERS),t=this.dirty.has(Vi.NON_MEMBERS);let r=this.dirty.has(Vi.EDGES);this.dirty.clear();const i=this.members.map(c=>c.obj);if(this.o.virtualEdges&&(e||t)){const c=this.nonMembers.map(f=>f.obj),u=KN(i,c,this.o.maxRoutingIterations,this.o.morphBuffer),h=new Map(this.virtualEdges.map(f=>[f.obj.toString(),f.area]));this.virtualEdges=u.map(f=>{var d;return{raw:f,obj:f,area:(d=h.get(f.toString()))!==null&&d!==void 0?d:null}}),r=!0}let a=!1;if(e||r){const c=this.virtualEdges.concat(this.edges).map(d=>d.obj),u=uR(i,c),h=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,f=rr.from(hx(u,h));f.equals(this.activeRegion)||(a=!0,this.activeRegion=f)}if(a){const c=Math.ceil(this.activeRegion.width/this.o.pixelGroup),u=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=Vo.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(h=>h.area=null),this.nonMembers.forEach(h=>h.area=null),this.edges.forEach(h=>h.area=null),this.virtualEdges.forEach(h=>h.area=null)):(c!==this.potentialArea.width||u!==this.potentialArea.height)&&(this.potentialArea=Vo.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}const o=new Map,s=c=>{if(c.area){const u=`${c.obj.width}x${c.obj.height}x${c.obj instanceof rr?"R":"C"}`;o.set(u,c.area)}},l=c=>{if(c.area)return;const u=`${c.obj.width}x${c.obj.height}x${c.obj instanceof rr?"R":"C"}`;if(o.has(u)){const f=o.get(u);c.area=this.potentialArea.copy(f,{x:c.obj.x-this.o.nodeR1,y:c.obj.y-this.o.nodeR1});return}const h=c.obj instanceof rr?$N(c.obj,this.potentialArea,this.o.nodeR1):dx(c.obj,this.potentialArea,this.o.nodeR1);c.area=h,o.set(u,h)};this.members.forEach(s),this.nonMembers.forEach(s),this.members.forEach(l),this.nonMembers.forEach(c=>{this.activeRegion.intersects(c.obj)?l(c):c.area=null}),this.edges.forEach(c=>{c.area||(c.area=fx(c.obj,this.potentialArea,this.o.edgeR1))}),this.virtualEdges.forEach(c=>{c.area||(c.area=fx(c.obj,this.potentialArea,this.o.edgeR1))})}drawMembers(e){for(const t of this.members)t.obj.draw(e)}drawNonMembers(e){for(const t of this.nonMembers)t.obj.draw(e)}drawEdges(e){for(const t of this.edges)t.obj.draw(e)}drawPotentialArea(e,t=!0){this.potentialArea.draw(e,t)}compute(){if(this.members.length===0)return new Ho([]);this.dirty.size>0&&this.update();const{o:e,potentialArea:t}=this,r=this.members.map(s=>s.area),i=this.virtualEdges.concat(this.edges).map(s=>s.area),a=this.nonMembers.filter(s=>s.area!=null).map(s=>s.area),o=this.members.map(s=>s.obj);return cR(t,r,i,a,s=>s.containsElements(o),e)}}function cR(n,e,t,r,i,a={}){const o=Object.assign({},ph,a);let s=o.threshold,l=o.memberInfluenceFactor,c=o.edgeInfluenceFactor,u=o.nonMemberInfluenceFactor;const h=(o.nodeR0-o.nodeR1)*(o.nodeR0-o.nodeR1),f=(o.edgeR0-o.edgeR1)*(o.edgeR0-o.edgeR1);for(let d=0;d<o.maxMarchingIterations;d++){if(n.clear(),l!==0){const v=l/h;for(const g of e)n.incArea(g,v)}if(c!==0){const v=c/f;for(const g of t)n.incArea(g,v)}if(u!==0){const v=u/h;for(const g of r)n.incArea(g,v)}const p=lR(n,s);if(p&&i(p))return p;if(s*=.95,d<=o.maxMarchingIterations*.5)l*=1.2,c*=1.2;else if(u!==0&&r.length>0)u*=.8;else break}return new Ho([])}function uR(n,e){if(n.length===0)return new rr(0,0,0,0);const t=rr.from(n[0]);for(const r of n)t.add(r);for(const r of e)t.add(lx(r));return t}function iW(n,e=[],t=[],r={}){if(n.length===0)return new Ho([]);const i=new qp(r);return i.pushMember(...n),i.pushNonMember(...e),i.pushEdge(...t),i.compute()}const Xg=class extends mr{constructor(t,r){super(t,Pi({},Xg.defaultOptions,r));k(this,"shape");k(this,"bubbleSets");k(this,"path");k(this,"members",new Map);k(this,"avoidMembers",new Map);k(this,"bubbleSetOptions",{});k(this,"drawBubbleSets",()=>{const{style:t,bubbleSetOptions:r}=this.parseOptions();un(this.bubbleSetOptions,r)||this.init(),this.bubbleSetOptions=at({},r);const i=_e(at({},t),{d:this.getPath()});this.shape?this.shape.update(i):(this.shape=new Yl({style:i}),this.context.canvas.appendChild(this.shape))});k(this,"updateBubbleSetsPath",t=>{if(!this.shape)return;const r=it(t.data);[...this.options.members,...this.options.avoidMembers].includes(r)&&this.shape.update(_e(at({},this.parseOptions().style),{d:this.getPath(r)}))});k(this,"getPath",t=>{const{graph:r}=this.context,i=this.options.members,a=[...this.members.keys()],o=this.options.avoidMembers,s=[...this.avoidMembers.keys()];if(!t&&un(i,a)&&un(o,s))return this.path;const{enter:l=[],exit:c=[]}=Ms(a,i,v=>v),{enter:u=[],exit:h=[]}=Ms(s,o,v=>v);t&&(c.push(t),l.push(t));const f=(v,g,m)=>{v.forEach(x=>{const S=m?this.members:this.avoidMembers,T=m?"pushMember":"pushNonMember",b=m?"removeMember":"removeNonMember";if(g){let y;r.getElementType(x)==="edge"?([y]=fR(r,x),this.bubbleSets.pushEdge(y)):([y]=hR(r,x),this.bubbleSets[T](y)),S.set(x,y)}else{const y=S.get(x);y&&(r.getElementType(x)==="edge"?this.bubbleSets.removeEdge(y):this.bubbleSets[b](y),S.delete(x))}})};f(c,!1,!0),f(l,!0,!0),f(h,!1,!1),f(u,!0,!1);const p=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=L1(p.points.map(Ir)),this.path});this.bindEvents(),this.bubbleSets=new qp(this.options)}bindEvents(){this.context.graph.on(Mt.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(Mt.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new qp(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){const l=this.options,{type:t,key:r,members:i,avoidMembers:a}=l,o=Ce(l,["type","key","members","avoidMembers"]),s=Object.keys(o).reduce((c,u)=>(u in ph?c.bubbleSetOptions[u]=o[u]:c.style[u]=o[u],c),{style:{},bubbleSetOptions:{}});return at({type:t,key:r,members:i,avoidMembers:a},s)}addMember(t){const r=Array.isArray(t)?t:[t];r.some(i=>this.options.avoidMembers.includes(i))&&(this.options.avoidMembers=this.options.avoidMembers.filter(i=>!r.includes(i))),this.options.members=[...new Set([...this.options.members,...r])],this.drawBubbleSets()}removeMember(t){const r=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(i=>!r.includes(i)),this.drawBubbleSets()}updateMember(t){this.options.members=jt(t)?t(this.options.members):t,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(t){const r=Array.isArray(t)?t:[t];r.some(i=>this.options.members.includes(i))&&(this.options.members=this.options.members.filter(i=>!r.includes(i))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...r])],this.drawBubbleSets()}removeAvoidMember(t){const r=Array.isArray(t)?t:[t];this.options.avoidMembers.some(i=>r.includes(i))&&(this.options.avoidMembers=this.options.avoidMembers.filter(i=>!r.includes(i)),this.drawBubbleSets())}updateAvoidMember(t){this.options.avoidMembers=Array.isArray(t)?t:[t],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(Mt.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(Mt.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}};let vh=Xg;k(vh,"defaultOptions",at({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},ph));const hR=(n,e)=>(Array.isArray(e)?e:[e]).map(r=>{const i=n.getElementRenderBounds(r);return new rr(i.min[0],i.min[1],ra(i),ia(i))}),fR=(n,e)=>(Array.isArray(e)?e:[e]).map(r=>{const i=n.getEdgeData(r),a=n.getElementPosition(i.source),o=n.getElementPosition(i.target);return Bn.from({x1:a[0],y1:a[1],x2:o[0],y2:o[1]})});class aW extends null{constructor(t,r){super(t,r);k(this,"setOptions",t=>{const r={cameraType:"setType",near:"setNear",far:"setFar",fov:"setFov",aspect:"setAspect",projectionMode:"setProjectionMode",distance:"setDistance",minDistance:"setMinDistance",maxDistance:"setMaxDistance",roll:"setRoll",elevation:"setElevation",azimuth:"setAzimuth"},i=(a,o)=>{switch(a){case"projectionMode":return o==="perspective"?1:0;case"cameraType":return{orbiting:0,exploring:1,tracking:2}[o];case"aspect":return typeof o=="number"?o:this.getCanvasAspect();default:return o}};Object.entries(r).forEach(([a,o])=>{const s=t[a];if(s!==void 0){const l=i(a,s);this.context.canvas.getCamera()[o](l)}})});this.bindEvents()}update(t){this.setOptions(t),super.update(t)}bindEvents(){this.context.graph.once(GraphEvent.BEFORE_DRAW,()=>this.setOptions(this.options))}getCanvasAspect(){const[t,r]=this.context.viewport.getCanvasSize();return t/r}}function dR(n){return`
    <ul class="g6-contextmenu-ul">
      ${n.map(e=>`<li  class="g6-contextmenu-li" value="${e.value}">${e.name}</li>`).join("")}
    </ul>
  `}const pR=`
  .g6-contextmenu {
    font-size: 12px;
    background-color: rgba(255, 255, 255, 0.96);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;
    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;
  }

  .g6-contextmenu-ul {
    max-width: 256px;
    min-width: 96px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .g6-contextmenu-li {
    padding: 8px 12px;
    cursor: pointer;
    user-select: none;
  }

  .g6-contextmenu-li:hover {
    background-color: #f5f5f5;
    cursor: pointer;
  }
`,jg=class extends mr{constructor(t,r){super(t,Object.assign({},jg.defaultOptions,r));k(this,"$element");k(this,"targetElement",null);k(this,"onTriggerEvent",t=>{var r;(r=t.preventDefault)==null||r.call(t),this.show(t)});k(this,"onMenuItemClick",t=>{const{onClick:r,trigger:i}=this.options;if(t.target instanceof HTMLElement&&t.target.className.includes("g6-contextmenu-li")){const a=t.target.getAttribute("value");r==null||r(a,t.target,this.targetElement),this.hide()}i!=="click"&&this.hide()});this.initElement(),this.update(r)}initElement(){this.$element=ql("contextmenu",!1);const{className:t}=this.options;t&&this.$element.classList.add(t),this.context.canvas.getContainer().appendChild(this.$element),jp("g6-contextmenu-css","style",{},pR,document.head)}show(t){return Ct(this,null,function*(){const{enable:r,offset:i}=this.options;if(typeof r=="function"&&!r(t)||!r){this.hide();return}const a=yield this.getDOMContent(t);a instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(a)):this.$element.innerHTML=a;const o=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${t.client.x-o.left+i[0]}px`,this.$element.style.top=`${t.client.y-o.top+i[1]}px`,this.$element.style.display="block",this.targetElement=t.target})}hide(){this.$element.style.display="none",this.targetElement=null}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(t){return Ct(this,null,function*(){const{getContent:r,getItems:i}=this.options;return i?dR(yield i(t)):yield r(t)})}bindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;t.on(`canvas:${r}`,this.onTriggerEvent),t.on(`node:${r}`,this.onTriggerEvent),t.on(`edge:${r}`,this.onTriggerEvent),t.on(`combo:${r}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;t.off(`canvas:${r}`,this.onTriggerEvent),t.off(`node:${r}`,this.onTriggerEvent),t.off(`edge:${r}`,this.onTriggerEvent),t.off(`combo:${r}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}};let gh=jg;k(gh,"defaultOptions",{trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0});const vR={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8},gx=.05,$g=class extends mr{constructor(t,r){super(t,Object.assign({},$g.defaultOptions,r));k(this,"lens");k(this,"shapes",new Map);k(this,"r",this.options.r);k(this,"onEdgeFilter",t=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const r=Ir(t.canvas);this.renderLens(r),this.renderFocusElements()});k(this,"renderLens",t=>{const[r,i]=t,a={size:this.r*2,x:r,y:i};if(this.isLensOn)this.lens.update(a);else{const o=Object.assign({},vR,this.options.style,a);this.lens=new Bs({style:o})}this.canvas.appendChild(this.lens)});k(this,"getFilterData",()=>{const{filter:t}=this.options,{model:r}=this.context,i=r.getData();if(!t)return i;const{nodes:a,edges:o,combos:s}=i;return{nodes:a.filter(l=>t(it(l),"node")),edges:o.filter(l=>t(it(l),"edge")),combos:s.filter(l=>t(it(l),"combo"))}});k(this,"getFocusElements",t=>{const{nodes:r,edges:i}=this.getFilterData(),a=r.filter(l=>Ci(Ui(l),t)<this.r),o=a.map(l=>it(l)),s=i.filter(l=>{const{source:c,target:u}=l,h=o.includes(c),f=o.includes(u);switch(this.options.nodeType){case"both":return h&&f;case"either":return h!==f;case"source":return h&&!f;case"target":return!h&&f;default:return!1}});return{nodes:a,edges:s}});k(this,"renderFocusElements",()=>{const{element:t,graph:r}=this.context;if(!this.isLensOn)return;const i=this.lens.getCenter(),{nodes:a,edges:o}=this.getFocusElements(i),s=new Set,{nodeStyle:l,edgeStyle:c}=this.options,u=h=>{const f=it(h);s.add(f);const d=t.getElement(f);if(!d)return;const p=this.shapes.get(f)||d.cloneNode();p.setPosition(d.getPosition()),p.id=d.id,this.shapes.has(f)?Object.entries(d.attributes).forEach(([m,x])=>{p.style[m]!==x&&(p.style[m]=x)}):(this.canvas.appendChild(p),this.shapes.set(f,p));const v=r.getElementType(f),g=this.getElementStyle(v,h);p.update(g)};a.forEach(u),o.forEach(u),this.shapes.forEach((h,f)=>{s.has(f)||(h.destroy(),this.shapes.delete(f))})});k(this,"scaleRByWheel",t=>{var v;this.options.preventDefault&&t.preventDefault();const{clientX:r,clientY:i,deltaX:a,deltaY:o}=t,{graph:s,canvas:l}=this.context,c=s.getCanvasByClient([r,i]),u=(v=this.lens)==null?void 0:v.getCenter();if(!this.isLensOn||Ci(c,u)>this.r)return;const{maxR:h,minR:f}=this.options,d=a+o>0?1/(1-gx):1-gx,p=Math.min(...l.getSize())/2;this.r=Math.max(f||0,Math.min(h||p,this.r*d)),this.renderLens(u),this.renderFocusElements()});k(this,"isLensDragging",!1);k(this,"onDragStart",t=>{var a;const r=Ir(t.canvas),i=(a=this.lens)==null?void 0:a.getCenter();!this.isLensOn||Ci(r,i)>this.r||(this.isLensDragging=!0)});k(this,"onDrag",t=>{if(!this.isLensDragging)return;const r=Ir(t.canvas);this.renderLens(r),this.renderFocusElements()});k(this,"onDragEnd",()=>{this.isLensDragging=!1});this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(t,r){const i=t==="node"?this.options.nodeStyle:this.options.edgeStyle;return typeof i=="function"?i(r):i}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var o;const{graph:t}=this.context,{trigger:r,scaleRByWheel:i}=this.options,a=t.getCanvas().getLayer();["click","drag"].includes(r)&&a.addEventListener(ht.CLICK,this.onEdgeFilter),r==="pointermove"?a.addEventListener(ht.POINTER_MOVE,this.onEdgeFilter):r==="drag"&&(a.addEventListener(ht.DRAG_START,this.onDragStart),a.addEventListener(ht.DRAG,this.onDrag),a.addEventListener(ht.DRAG_END,this.onDragEnd)),i&&((o=this.graphDom)==null||o.addEventListener(ht.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var o;const{graph:t}=this.context,{trigger:r,scaleRByWheel:i}=this.options,a=t.getCanvas().getLayer();["click","drag"].includes(r)&&a.removeEventListener(ht.CLICK,this.onEdgeFilter),r==="pointermove"?a.removeEventListener(ht.POINTER_MOVE,this.onEdgeFilter):r==="drag"&&(a.removeEventListener(ht.DRAG_START,this.onDragStart),a.removeEventListener(ht.DRAG,this.onDrag),a.removeEventListener(ht.DRAG_END,this.onDragEnd)),i&&((o=this.graphDom)==null||o.removeEventListener(ht.WHEEL,this.scaleRByWheel))}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((t,r)=>{t.destroy(),this.shapes.delete(r)}),super.destroy()}};let mh=$g;k(mh,"defaultOptions",{trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRByWheel:!0,preventDefault:!0});const Kg=class extends mr{constructor(t,r){super(t,Object.assign({},Kg.defaultOptions,r));k(this,"shortcut");k(this,"style");k(this,"$el",this.context.canvas.getContainer());k(this,"graphSize",[0,0]);k(this,"onFullscreenChange",()=>{var r,i,a,o;const t=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(t),t?(i=(r=this.options).onEnter)==null||i.call(r):(o=(a=this.options).onExit)==null||o.call(a)});this.shortcut=new Ns(t.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML=`
      :not(:root):fullscreen::backdrop {
        background: transparent;
      }
    `}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();const{request:t=[],exit:r=[]}=this.options.trigger;this.shortcut.bind(t,this.request),this.shortcut.bind(r,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(a=>{document.addEventListener(a,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(r=>{document.removeEventListener(r,this.onFullscreenChange,!1)})}setGraphSize(t=!0){let r,i;t?(r=window.screen.width,i=window.screen.height,this.graphSize=this.context.graph.getSize()):[r,i]=this.graphSize,this.context.graph.setSize(r,i),this.context.graph.render()}request(){document.fullscreenElement||!gR()||this.$el.requestFullscreen().catch(t=>{Lr.warn(`Error attempting to enable full-screen: ${t.message} (${t.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}};let yh=Kg;k(yh,"defaultOptions",{trigger:{},autoFit:!0});function gR(){return document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled")}const Zg=class extends mr{constructor(t,r){super(t,Object.assign({},Zg.defaultOptions,r));k(this,"$element",ql("grid-line"));k(this,"offset",[0,0]);k(this,"onTransform",t=>{if(!this.options.follow)return;const{data:{translate:r}}=t;r&&this.updateOffset(r)});const i=this.context.canvas.getContainer();WN(i,this.$element),this.updateStyle(),this.bindEvents()}update(t){super.update(t),this.updateStyle()}bindEvents(){const{graph:t}=this.context;t.on(Mt.AFTER_TRANSFORM,this.onTransform)}updateStyle(){const{size:t,stroke:r,lineWidth:i,border:a,borderLineWidth:o,borderStroke:s,borderStyle:l}=this.options;Object.assign(this.$element.style,{border:a?`${o}px ${l} ${s}`:"none",backgroundImage:`linear-gradient(${r} ${i}px, transparent ${i}px), linear-gradient(90deg, ${r} ${i}px, transparent ${i}px)`,backgroundSize:`${t}px ${t}px`})}updateOffset(t){this.offset=MO(ge(this.offset,t),this.options.size),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}destroy(){this.context.graph.off(Mt.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}};let xh=Zg;k(xh,"defaultOptions",{border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"});var Jp=D(90494);function Qp(n){const e={Added:new Map,Updated:new Map,Removed:new Map};return n.forEach(t=>{const{type:r,value:i}=t,a=it(i);if(r==="NodeAdded"||r==="EdgeAdded"||r==="ComboAdded")e.Added.set(a,t);else if(r==="NodeUpdated"||r==="EdgeUpdated"||r==="ComboUpdated")if(e.Added.has(a))e.Added.set(a,{type:r.replace("Updated","Added"),value:i});else if(e.Updated.has(a)){const{original:o}=e.Updated.get(a);e.Updated.set(a,{type:r,value:i,original:o})}else e.Removed.has(a)||e.Updated.set(a,t);else(r==="NodeRemoved"||r==="EdgeRemoved"||r==="ComboRemoved")&&(e.Added.has(a)?e.Added.delete(a):(e.Updated.has(a)&&e.Updated.delete(a),e.Removed.set(a,t)))}),[...Array.from(e.Added.values()),...Array.from(e.Updated.values()),...Array.from(e.Removed.values())]}function mx(n){const{NodeAdded:e=[],NodeUpdated:t=[],NodeRemoved:r=[],EdgeAdded:i=[],EdgeUpdated:a=[],EdgeRemoved:o=[],ComboAdded:s=[],ComboUpdated:l=[],ComboRemoved:c=[]}=Mp(n,u=>u.type);return{add:{nodes:e,edges:i,combos:s},update:{nodes:t,edges:a,combos:l},remove:{nodes:r,edges:o,combos:c}}}function yx(n,e){for(const t in n)Ye(n[t])&&!Array.isArray(n[t])&&n[t]!==null?(e[t]||(e[t]={}),yx(n[t],e[t])):e[t]===void 0&&(e[t]=Su(t))}function mR(n,e=!1,t){const r={animation:e,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:i,update:a,remove:o}=mx(Qp(n));return["nodes","edges","combos"].forEach(s=>{a[s]&&a[s].forEach(l=>{var h,f;const c=at({},l.value);let u=at({},l.original);if(t){const d=t.graph.getElementType(it(l.original)),p=d==="edge"?"stroke":"fill",v=t.element.getElementComputedStyle(d,l.original);u=_e(at({},l.original),{style:at({[p]:v[p]},l.original.style)})}yx(c,u),(h=r.current.update)[s]||(h[s]=[]),r.current.update[s].push(c),(f=r.original.update)[s]||(f[s]=[]),r.original.update[s].push(u)}),i[s]&&i[s].forEach(l=>{var u,h;const c=at({},l.value);(u=r.current.add)[s]||(u[s]=[]),r.current.add[s].push(c),(h=r.original.remove)[s]||(h[s]=[]),r.original.remove[s].push(c)}),o[s]&&o[s].forEach(l=>{var u,h;const c=at({},l.value);(u=r.current.remove)[s]||(u[s]=[]),r.current.remove[s].push(c),(h=r.original.add)[s]||(h[s]=[]),r.original.add[s].push(c)})}),r}const qg=class extends mr{constructor(t,r){super(t,Object.assign({},qg.defaultOptions,r));k(this,"emitter");k(this,"batchChanges",null);k(this,"batchAnimation",!1);k(this,"undoStack",[]);k(this,"redoStack",[]);k(this,"freezed",!1);k(this,"executeCommand",(t,r=!0)=>{var a,o,s;this.freezed=!0,(o=(a=this.options).executeCommand)==null||o.call(a,t);const i=r?t.original:t.current;this.context.graph.addData(i.add),this.context.graph.updateData(i.update),this.context.graph.removeData(o1(i.remove,!1)),(s=this.context.element)==null||s.draw({silence:!0,animation:t.animation}),this.freezed=!1});k(this,"addCommand",t=>{var r;if(!this.freezed){if(t.type===Mt.AFTER_DRAW){const{dataChanges:i=[],animation:a=!0}=t.data;if((r=this.context.batch)!=null&&r.isBatching){if(!this.batchChanges)return;this.batchChanges.push(i),this.batchAnimation&&(this.batchAnimation=a);return}this.batchChanges=[i],this.batchAnimation=a}this.undoStackPush(mR(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(ja.ADD,this.undoStack[this.undoStack.length-1])}});k(this,"initBatchCommand",t=>{const{initiate:r}=t.data;this.batchAnimation=!1,r?this.batchChanges=[]:this.undoStack.pop()||(this.batchChanges=null)});this.emitter=new Jp.Z;const{graph:i}=this.context;i.on(Mt.AFTER_DRAW,this.addCommand),i.on(Mt.BATCH_START,this.initBatchCommand),i.on(Mt.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var r,i,a,o;const t=this.undoStack.pop();if(t){if(this.executeCommand(t),((i=(r=this.options).beforeAddCommand)==null?void 0:i.call(r,t,!1))===!1)return;this.redoStack.push(t),(o=(a=this.options).afterAddCommand)==null||o.call(a,t,!1),this.notify(ja.UNDO,t)}return this}redo(){const t=this.redoStack.pop();return t&&(this.executeCommand(t,!1),this.undoStackPush(t),this.notify(ja.REDO,t)),this}undoAndCancel(){const t=this.undoStack.pop();return t&&(this.executeCommand(t,!1),this.redoStack=[],this.notify(ja.CANCEL,t)),this}undoStackPush(t){var a,o,s,l;const{stackSize:r}=this.options;r!==0&&this.undoStack.length>=r&&this.undoStack.shift(),((o=(a=this.options).beforeAddCommand)==null?void 0:o.call(a,t,!0))!==!1&&(this.undoStack.push(t),(l=(s=this.options).afterAddCommand)==null||l.call(s,t,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(ja.CLEAR,null)}notify(t,r){this.emitter.emit(t,{cmd:r}),this.emitter.emit(ja.CHANGE,{cmd:r})}on(t,r){this.emitter.on(t,r)}destroy(){const{graph:t}=this.context;t.off(Mt.AFTER_DRAW,this.addCommand),t.off(Mt.BATCH_START,this.initBatchCommand),t.off(Mt.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}};let bh=qg;k(bh,"defaultOptions",{stackSize:0});var yR=D(1344),xR=D.n(yR);function bR(n,e,t){if(n.length===1)return ER(n[0],e,t);if(n.length===2)return wR(n,e,t);switch(t){case"smooth":return _R(n,e);case"sharp":return TR(n,e);case"rounded":default:return SR(n,e)}}const ER=(n,e,t)=>{if(t==="sharp")return[["M",n[0]-e,n[1]-e],["L",n[0]+e,n[1]-e],["L",n[0]+e,n[1]+e],["L",n[0]-e,n[1]+e],["Z"]];const r=[e,e,0,0,0];return[["M",n[0],n[1]-e],["A",...r,n[0],n[1]+e],["A",...r,n[0],n[1]-e]]},wR=(n,e,t)=>{const r=[e,e,0,0,0],i=t==="sharp"?ge(n[0],qa(Sa(Nn(n[0],n[1])),e)):n[0],a=t==="sharp"?ge(n[1],qa(Sa(Nn(n[1],n[0])),e)):n[1],o=qa(Sa(Cu(Nn(i,a),!1)),e),s=qa(o,-1),l=ge(i,o),c=ge(a,o),u=ge(a,s),h=ge(i,s);return t==="sharp"?[["M",l[0],l[1]],["L",c[0],c[1]],["L",u[0],u[1]],["L",h[0],h[1]],["Z"]]:[["M",l[0],l[1]],["L",c[0],c[1]],["A",...r,u[0],u[1]],["L",h[0],h[1]],["A",...r,l[0],l[1]]]},SR=(n,e)=>{const t=y1(n).map((s,l)=>{const c=(l-2+n.length)%n.length,u=(l-1+n.length)%n.length,h=(l+1)%n.length,f=n[c],d=n[u],p=n[h],v=Nn(f,d),g=Nn(d,s),m=Nn(s,p),x=(E,w)=>Ep(E,w,!0)<Math.PI,S=x(v,g),T=x(g,m),b=E=>qa(Sa(Cu(E,!1)),e),y=b(g);return[{p:Dl(S?ge(d,b(v)):ge(d,y)),concave:S&&d},{p:Dl(T?ge(s,b(m)):ge(s,y)),concave:T&&s}]}),r=[e,e,0,0,0],i=t.findIndex((s,l)=>!t[(l-1+t.length)%t.length][0].concave&&!t[(l-1+t.length)%t.length][1].concave&&!s[0].concave&&!s[0].concave&&!s[1].concave),a=t.slice(i).concat(t.slice(0,i));let o=[];return a.flatMap((s,l)=>{const c=[],u=a[t.length-1];return l===0&&c.push(["M",...u[1].p]),s[0].concave?o.push(s[0].p,s[1].p):c.push(["A",...r,...s[0].p]),s[1].concave?o.unshift(s[1].p):c.push(["L",...s[1].p]),o.length===3&&(c.pop(),c.push(["C",...o.flat()]),o=[]),c})},_R=(n,e)=>{const t=y1(n).map((r,i)=>{const a=n[(i+1)%n.length];return{p:r,v:Sa(Nn(a,r))}});return t.forEach((r,i)=>{const a=i>0?i-1:n.length-1,o=t[a].v,s=Sa(ge(o,qa(r.v,Ep(o,r.v,!0)<Math.PI?1:-1)));r.p=ge(r.p,qa(s,e))}),L1(t.map(r=>r.p))},TR=(n,e)=>{const r=n.map((a,o)=>{const s=n[o===0?n.length-1:o-1],l=Bl(qa(Sa(Cu(Nn(s,a),!1)),e));return[ge(s,l),ge(a,l)]}).flat();return r.map((a,o)=>{if(o%2===0)return null;const s=[r[(o-1)%r.length],r[o%r.length]],l=[r[(o+1)%r.length],r[(o+2)%r.length]];return wp(s,l,!0)}).filter(Boolean).map((a,o)=>[o===0?"M":"L",a[0],a[1]]).concat([["Z"]])},Jg=class extends mr{constructor(t,r){super(t,Object.assign({},Jg.defaultOptions,r));k(this,"shape");k(this,"hullMemberIds",[]);k(this,"path");k(this,"optionsCache");k(this,"drawHull",()=>{if(!this.shape)this.shape=new Yl({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);else{const t=!un(this.optionsCache,this.options);this.shape.update(this.getHullStyle(t))}this.optionsCache=at({},this.options)});k(this,"updateHullPath",t=>{this.shape&&this.options.members.includes(it(t.data))&&this.shape.update({d:this.getHullPath(!0)})});k(this,"getHullPath",(t=!1)=>{const{graph:r}=this.context,i=this.getMember();if(i.length===0)return"";const a=i.map(l=>r.getNodeData(l)),o=xR()(a.map(Ui),this.options.concavity).slice(1).reverse(),s=o.flatMap(l=>a.filter(c=>un(Ui(c),l)).map(it));return un(s,this.hullMemberIds)&&!t?this.path:(this.hullMemberIds=s,this.path=bR(o,this.getPadding(),this.options.corner),this.path)});this.bindEvents()}bindEvents(){this.context.graph.on(Mt.AFTER_RENDER,this.drawHull),this.context.graph.on(Mt.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(t){const s=this.options,{members:r,padding:i,corner:a}=s,o=Ce(s,["members","padding","corner"]);return _e(at({},o),{d:this.getHullPath(t)})}getPadding(){const{graph:t}=this.context;return this.hullMemberIds.reduce((i,a)=>{const{halfExtents:o}=t.getElementRenderBounds(a),s=Math.max(o[0],o[1]);return Math.max(i,s)},0)+this.options.padding}addMember(t){const r=Array.isArray(t)?t:[t];this.options.members=[...new Set([...this.options.members,...r])],this.shape.update({d:this.getHullPath()})}removeMember(t){const r=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(i=>!r.includes(i)),r.some(i=>this.hullMemberIds.includes(i))&&this.shape.update({d:this.getHullPath()})}updateMember(t){this.options.members=jt(t)?t(this.options.members):t,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.context.graph.off(Mt.AFTER_DRAW,this.drawHull),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}};let Eh=Jg;k(Eh,"defaultOptions",{members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2});var PR=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:typeof self!="undefined"?self:{},xx={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(PR,function(){function t(b,y,E,w,C){r(b,y,E||0,w||b.length-1,C||a)}function r(b,y,E,w,C){for(;w>E;){if(w-E>600){var M=w-E+1,O=y-E+1,A=Math.log(M),R=.5*Math.exp(2*A/3),L=.5*Math.sqrt(A*R*(M-R)/M)*(O-M/2<0?-1:1),z=Math.max(E,Math.floor(y-O*R/M+L)),Y=Math.min(w,Math.floor(y+(M-O)*R/M+L));r(b,y,z,Y,C)}var I=b[y],q=E,J=w;for(i(b,E,y),C(b[w],I)>0&&i(b,E,w);q<J;){for(i(b,q,J),q++,J--;C(b[q],I)<0;)q++;for(;C(b[J],I)>0;)J--}C(b[E],I)===0?i(b,E,J):(J++,i(b,J,w)),J<=y&&(E=J+1),y<=J&&(w=J-1)}}function i(b,y,E){var w=b[y];b[y]=b[E],b[E]=w}function a(b,y){return b<y?-1:b>y?1:0}var o=function(y){y===void 0&&(y=9),this._maxEntries=Math.max(4,y),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(y){var E=this.data,w=[];if(!x(y,E))return w;for(var C=this.toBBox,M=[];E;){for(var O=0;O<E.children.length;O++){var A=E.children[O],R=E.leaf?C(A):A;x(y,R)&&(E.leaf?w.push(A):m(y,R)?this._all(A,w):M.push(A))}E=M.pop()}return w},o.prototype.collides=function(y){var E=this.data;if(!x(y,E))return!1;for(var w=[];E;){for(var C=0;C<E.children.length;C++){var M=E.children[C],O=E.leaf?this.toBBox(M):M;if(x(y,O)){if(E.leaf||m(y,O))return!0;w.push(M)}}E=w.pop()}return!1},o.prototype.load=function(y){if(!(y&&y.length))return this;if(y.length<this._minEntries){for(var E=0;E<y.length;E++)this.insert(y[E]);return this}var w=this._build(y.slice(),0,y.length-1,0);if(!this.data.children.length)this.data=w;else if(this.data.height===w.height)this._splitRoot(this.data,w);else{if(this.data.height<w.height){var C=this.data;this.data=w,w=C}this._insert(w,this.data.height-w.height-1,!0)}return this},o.prototype.insert=function(y){return y&&this._insert(y,this.data.height-1),this},o.prototype.clear=function(){return this.data=S([]),this},o.prototype.remove=function(y,E){if(!y)return this;for(var w=this.data,C=this.toBBox(y),M=[],O=[],A,R,L;w||M.length;){if(w||(w=M.pop(),R=M[M.length-1],A=O.pop(),L=!0),w.leaf){var z=s(y,w.children,E);if(z!==-1)return w.children.splice(z,1),M.push(w),this._condense(M),this}!L&&!w.leaf&&m(w,C)?(M.push(w),O.push(A),A=0,R=w,w=w.children[0]):R?(A++,w=R.children[A],L=!1):w=null}return this},o.prototype.toBBox=function(y){return y},o.prototype.compareMinX=function(y,E){return y.minX-E.minX},o.prototype.compareMinY=function(y,E){return y.minY-E.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(y){return this.data=y,this},o.prototype._all=function(y,E){for(var w=[];y;)y.leaf?E.push.apply(E,y.children):w.push.apply(w,y.children),y=w.pop();return E},o.prototype._build=function(y,E,w,C){var M=w-E+1,O=this._maxEntries,A;if(M<=O)return A=S(y.slice(E,w+1)),l(A,this.toBBox),A;C||(C=Math.ceil(Math.log(M)/Math.log(O)),O=Math.ceil(M/Math.pow(O,C-1))),A=S([]),A.leaf=!1,A.height=C;var R=Math.ceil(M/O),L=R*Math.ceil(Math.sqrt(O));T(y,E,w,L,this.compareMinX);for(var z=E;z<=w;z+=L){var Y=Math.min(z+L-1,w);T(y,z,Y,R,this.compareMinY);for(var I=z;I<=Y;I+=R){var q=Math.min(I+R-1,Y);A.children.push(this._build(y,I,q,C-1))}}return l(A,this.toBBox),A},o.prototype._chooseSubtree=function(y,E,w,C){for(;C.push(E),!(E.leaf||C.length-1===w);){for(var M=1/0,O=1/0,A=void 0,R=0;R<E.children.length;R++){var L=E.children[R],z=d(L),Y=v(y,L)-z;Y<O?(O=Y,M=z<M?z:M,A=L):Y===O&&z<M&&(M=z,A=L)}E=A||E.children[0]}return E},o.prototype._insert=function(y,E,w){var C=w?y:this.toBBox(y),M=[],O=this._chooseSubtree(C,this.data,E,M);for(O.children.push(y),u(O,C);E>=0&&M[E].children.length>this._maxEntries;)this._split(M,E),E--;this._adjustParentBBoxes(C,M,E)},o.prototype._split=function(y,E){var w=y[E],C=w.children.length,M=this._minEntries;this._chooseSplitAxis(w,M,C);var O=this._chooseSplitIndex(w,M,C),A=S(w.children.splice(O,w.children.length-O));A.height=w.height,A.leaf=w.leaf,l(w,this.toBBox),l(A,this.toBBox),E?y[E-1].children.push(A):this._splitRoot(w,A)},o.prototype._splitRoot=function(y,E){this.data=S([y,E]),this.data.height=y.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(y,E,w){for(var C,M=1/0,O=1/0,A=E;A<=w-E;A++){var R=c(y,0,A,this.toBBox),L=c(y,A,w,this.toBBox),z=g(R,L),Y=d(R)+d(L);z<M?(M=z,C=A,O=Y<O?Y:O):z===M&&Y<O&&(O=Y,C=A)}return C||w-E},o.prototype._chooseSplitAxis=function(y,E,w){var C=y.leaf?this.compareMinX:h,M=y.leaf?this.compareMinY:f,O=this._allDistMargin(y,E,w,C),A=this._allDistMargin(y,E,w,M);O<A&&y.children.sort(C)},o.prototype._allDistMargin=function(y,E,w,C){y.children.sort(C);for(var M=this.toBBox,O=c(y,0,E,M),A=c(y,w-E,w,M),R=p(O)+p(A),L=E;L<w-E;L++){var z=y.children[L];u(O,y.leaf?M(z):z),R+=p(O)}for(var Y=w-E-1;Y>=E;Y--){var I=y.children[Y];u(A,y.leaf?M(I):I),R+=p(A)}return R},o.prototype._adjustParentBBoxes=function(y,E,w){for(var C=w;C>=0;C--)u(E[C],y)},o.prototype._condense=function(y){for(var E=y.length-1,w=void 0;E>=0;E--)y[E].children.length===0?E>0?(w=y[E-1].children,w.splice(w.indexOf(y[E]),1)):this.clear():l(y[E],this.toBBox)};function s(b,y,E){if(!E)return y.indexOf(b);for(var w=0;w<y.length;w++)if(E(b,y[w]))return w;return-1}function l(b,y){c(b,0,b.children.length,y,b)}function c(b,y,E,w,C){C||(C=S(null)),C.minX=1/0,C.minY=1/0,C.maxX=-1/0,C.maxY=-1/0;for(var M=y;M<E;M++){var O=b.children[M];u(C,b.leaf?w(O):O)}return C}function u(b,y){return b.minX=Math.min(b.minX,y.minX),b.minY=Math.min(b.minY,y.minY),b.maxX=Math.max(b.maxX,y.maxX),b.maxY=Math.max(b.maxY,y.maxY),b}function h(b,y){return b.minX-y.minX}function f(b,y){return b.minY-y.minY}function d(b){return(b.maxX-b.minX)*(b.maxY-b.minY)}function p(b){return b.maxX-b.minX+(b.maxY-b.minY)}function v(b,y){return(Math.max(y.maxX,b.maxX)-Math.min(y.minX,b.minX))*(Math.max(y.maxY,b.maxY)-Math.min(y.minY,b.minY))}function g(b,y){var E=Math.max(b.minX,y.minX),w=Math.max(b.minY,y.minY),C=Math.min(b.maxX,y.maxX),M=Math.min(b.maxY,y.maxY);return Math.max(0,C-E)*Math.max(0,M-w)}function m(b,y){return b.minX<=y.minX&&b.minY<=y.minY&&y.maxX<=b.maxX&&y.maxY<=b.maxY}function x(b,y){return y.minX<=b.maxX&&y.minY<=b.maxY&&y.maxX>=b.minX&&y.maxY>=b.minY}function S(b){return{children:b,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function T(b,y,E,w,C){for(var M=[y,E];M.length;)if(E=M.pop(),y=M.pop(),!(E-y<=w)){var O=y+Math.ceil((E-y)/w/2)*w;t(b,O,y,E,C),M.push(y,O,O,E)}}return o})})(xx);var MR=xx.exports,Rt;(function(n){n.GROUP="g",n.CIRCLE="circle",n.ELLIPSE="ellipse",n.IMAGE="image",n.RECT="rect",n.LINE="line",n.POLYLINE="polyline",n.POLYGON="polygon",n.TEXT="text",n.PATH="path",n.HTML="html",n.MESH="mesh"})(Rt||(Rt={}));var zs;(function(n){n[n.ZERO=0]="ZERO",n[n.NEGATIVE_ONE=1]="NEGATIVE_ONE"})(zs||(zs={}));var oW=function(){function n(){this.plugins=[]}return n.prototype.addRenderingPlugin=function(e){this.plugins.push(e),this.context.renderingPlugins.push(e)},n.prototype.removeAllRenderingPlugins=function(){var e=this;this.plugins.forEach(function(t){var r=e.context.renderingPlugins.indexOf(t);r>=0&&e.context.renderingPlugins.splice(r,1)})},n}(),sW=function(){function n(e){this.clipSpaceNearZ=zs.NEGATIVE_ONE,this.plugins=[],this.config=N({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0},e)}return n.prototype.registerPlugin=function(e){var t=this.plugins.findIndex(function(r){return r===e});t===-1&&this.plugins.push(e)},n.prototype.unregisterPlugin=function(e){var t=this.plugins.findIndex(function(r){return r===e});t>-1&&this.plugins.splice(t,1)},n.prototype.getPlugins=function(){return this.plugins},n.prototype.getPlugin=function(e){return this.plugins.find(function(t){return t.name===e})},n.prototype.getConfig=function(){return this.config},n.prototype.setConfig=function(e){Object.assign(this.config,e)},n}();function Ws(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function tv(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function wh(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function bx(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function CR(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n}function OR(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n}function Us(n){return n===void 0?0:n>360||n<-360?n%360:n}function yr(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=0),Array.isArray(n)&&n.length===3?_.d9(n):te(n)?_.al(n,e,t):_.al(n[0],n[1]||e,n[2]||t)}function ke(n){return n*(Math.PI/180)}function Oi(n){return n*(180/Math.PI)}function lW(n){return n=n%400,n<0&&(n+=400),n/400*360}function cW(n){return n/360}function AR(n){return 360*n}function NR(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=t*t,s=r*r,l=i*i,c=a*a,u=o+s+l+c,h=t*a-r*i;return h>.499995*u?(n[0]=Math.PI/2,n[1]=2*Math.atan2(r,t),n[2]=0):h<-.499995*u?(n[0]=-Math.PI/2,n[1]=2*Math.atan2(r,t),n[2]=0):(n[0]=Math.asin(2*(t*i-a*r)),n[1]=Math.atan2(2*(t*a+r*i),1-2*(l+c)),n[2]=Math.atan2(2*(t*r+i*a),1-2*(s+l))),n}function RR(n,e){var t,r,i=Math.PI*.5,a=P(He(_.Ue(),e),3),o=a[0],s=a[1],l=a[2],c=Math.asin(-e[2]/o);return c<i?c>-i?(t=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,t=-Math.atan2(e[4]/s,e[5]/s)):(r=0,t=Math.atan2(e[4]/s,e[5]/s)),n[0]=t,n[1]=c,n[2]=r,n}function ev(n,e){return e.length===16?RR(n,e):NR(n,e)}function kR(n,e,t,r,i){var a=Math.cos(n),o=Math.sin(n);return qi.al(r*a,i*o,0,-r*o,i*a,0,e,t,1)}function LR(n,e,t,r,i,a,o,s){s===void 0&&(s=!1);var l=2*a/(t-e),c=2*a/(r-i),u=(t+e)/(t-e),h=(r+i)/(r-i),f,d;return s?(f=-o/(o-a),d=-o*a/(o-a)):(f=-(o+a)/(o-a),d=-2*o*a/(o-a)),n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=u,n[9]=h,n[10]=f,n[11]=-1,n[12]=0,n[13]=0,n[14]=d,n[15]=0,n}function Ex(n){var e=n[0],t=n[1],r=n[3],i=n[4],a=Math.sqrt(e*e+t*t),o=Math.sqrt(r*r+i*i),s=e*i-t*r;s<0&&(e<i?a=-a:o=-o),a&&(e*=1/a,t*=1/a),o&&(r*=1/o,i*=1/o);var l=Math.atan2(t,e),c=Oi(l);return[n[6],n[7],a,o,c]}var aa=Q(),Hi=Q(),tc=an(),Kt=[_.Ue(),_.Ue(),_.Ue()],wx=_.Ue();function IR(n,e,t,r,i,a){if(!DR(aa,n)||(kt(Hi,aa),Hi[3]=0,Hi[7]=0,Hi[11]=0,Hi[15]=1,Math.abs(Pe(Hi))<1e-8))return!1;var o=aa[3],s=aa[7],l=aa[11],c=aa[12],u=aa[13],h=aa[14],f=aa[15];if(o!==0||s!==0||l!==0){tc[0]=o,tc[1]=s,tc[2]=l,tc[3]=f;var d=Wt(Hi,Hi);if(!d)return!1;Te(Hi,Hi),ln(i,tc,Hi)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=c,e[1]=u,e[2]=h,BR(Kt,aa),t[0]=_.kE(Kt[0]),_.Fv(Kt[0],Kt[0]),r[0]=_.AK(Kt[0],Kt[1]),nv(Kt[1],Kt[1],Kt[0],1,-r[0]),t[1]=_.kE(Kt[1]),_.Fv(Kt[1],Kt[1]),r[0]/=t[1],r[1]=_.AK(Kt[0],Kt[2]),nv(Kt[2],Kt[2],Kt[0],1,-r[1]),r[2]=_.AK(Kt[1],Kt[2]),nv(Kt[2],Kt[2],Kt[1],1,-r[2]),t[2]=_.kE(Kt[2]),_.Fv(Kt[2],Kt[2]),r[1]/=t[2],r[2]/=t[2],_.kC(wx,Kt[1],Kt[2]),_.AK(Kt[0],wx)<0)for(var p=0;p<3;p++)t[p]*=-1,Kt[p][0]*=-1,Kt[p][1]*=-1,Kt[p][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+Kt[0][0]-Kt[1][1]-Kt[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-Kt[0][0]+Kt[1][1]-Kt[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-Kt[0][0]-Kt[1][1]+Kt[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+Kt[0][0]+Kt[1][1]+Kt[2][2],0)),Kt[2][1]>Kt[1][2]&&(a[0]=-a[0]),Kt[0][2]>Kt[2][0]&&(a[1]=-a[1]),Kt[1][0]>Kt[0][1]&&(a[2]=-a[2]),!0}function DR(n,e){var t=e[15];if(t===0)return!1;for(var r=1/t,i=0;i<16;i++)n[i]=e[i]*r;return!0}function BR(n,e){n[0][0]=e[0],n[0][1]=e[1],n[0][2]=e[2],n[1][0]=e[4],n[1][1]=e[5],n[1][2]=e[6],n[2][0]=e[8],n[2][1]=e[9],n[2][2]=e[10]}function nv(n,e,t,r,i){n[0]=e[0]*r+t[0]*i,n[1]=e[1]*r+t[1]*i,n[2]=e[2]*r+t[2]*i}var ir=function(){function n(){this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return n.isEmpty=function(e){return!e||e.halfExtents[0]===0&&e.halfExtents[1]===0&&e.halfExtents[2]===0},n.prototype.update=function(e,t){Ws(this.center,e),Ws(this.halfExtents,t),tv(this.min,this.center,this.halfExtents),wh(this.max,this.center,this.halfExtents)},n.prototype.setMinMax=function(e,t){wh(this.center,t,e),bx(this.center,this.center,.5),tv(this.halfExtents,t,e),bx(this.halfExtents,this.halfExtents,.5),Ws(this.min,e),Ws(this.max,t)},n.prototype.getMin=function(){return this.min},n.prototype.getMax=function(){return this.max},n.prototype.add=function(e){if(!n.isEmpty(e)){if(n.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return}var t=this.center,r=t[0],i=t[1],a=t[2],o=this.halfExtents,s=o[0],l=o[1],c=o[2],u=r-s,h=r+s,f=i-l,d=i+l,p=a-c,v=a+c,g=e.center,m=g[0],x=g[1],S=g[2],T=e.halfExtents,b=T[0],y=T[1],E=T[2],w=m-b,C=m+b,M=x-y,O=x+y,A=S-E,R=S+E;w<u&&(u=w),C>h&&(h=C),M<f&&(f=M),O>d&&(d=O),A<p&&(p=A),R>v&&(v=R),t[0]=(u+h)*.5,t[1]=(f+d)*.5,t[2]=(p+v)*.5,o[0]=(h-u)*.5,o[1]=(d-f)*.5,o[2]=(v-p)*.5,this.min[0]=u,this.min[1]=f,this.min[2]=p,this.max[0]=h,this.max[1]=d,this.max[2]=v}},n.prototype.setFromTransformedAABB=function(e,t){var r=this.center,i=this.halfExtents,a=e.center,o=e.halfExtents,s=t[0],l=t[4],c=t[8],u=t[1],h=t[5],f=t[9],d=t[2],p=t[6],v=t[10],g=Math.abs(s),m=Math.abs(l),x=Math.abs(c),S=Math.abs(u),T=Math.abs(h),b=Math.abs(f),y=Math.abs(d),E=Math.abs(p),w=Math.abs(v);r[0]=t[12]+s*a[0]+l*a[1]+c*a[2],r[1]=t[13]+u*a[0]+h*a[1]+f*a[2],r[2]=t[14]+d*a[0]+p*a[1]+v*a[2],i[0]=g*o[0]+m*o[1]+x*o[2],i[1]=S*o[0]+T*o[1]+b*o[2],i[2]=y*o[0]+E*o[1]+w*o[2],tv(this.min,r,i),wh(this.max,r,i)},n.prototype.intersects=function(e){var t=this.getMax(),r=this.getMin(),i=e.getMax(),a=e.getMin();return r[0]<=i[0]&&t[0]>=a[0]&&r[1]<=i[1]&&t[1]>=a[1]&&r[2]<=i[2]&&t[2]>=a[2]},n.prototype.intersection=function(e){if(!this.intersects(e))return null;var t=new n,r=CR([0,0,0],this.getMin(),e.getMin()),i=OR([0,0,0],this.getMax(),e.getMax());return t.setMinMax(r,i),t},n.prototype.getNegativeFarPoint=function(e){return e.pnVertexFlag===273?Ws([0,0,0],this.min):e.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:e.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]},n.prototype.getPositiveFarPoint=function(e){return e.pnVertexFlag===273?Ws([0,0,0],this.max):e.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:e.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]},n}(),FR=function(){function n(e,t){this.distance=e||0,this.normal=t||_.al(0,1,0),this.updatePNVertexFlag()}return n.prototype.updatePNVertexFlag=function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)},n.prototype.distanceToPoint=function(e){return _.AK(e,this.normal)-this.distance},n.prototype.normalize=function(){var e=1/_.Zh(this.normal);_.bA(this.normal,this.normal,e),this.distance*=e},n.prototype.intersectsLine=function(e,t,r){var i=this.distanceToPoint(e),a=this.distanceToPoint(t),o=i/(i-a),s=o>=0&&o<=1;return s&&r&&_.t7(r,e,t,o),s},n}(),ro;(function(n){n[n.OUTSIDE=4294967295]="OUTSIDE",n[n.INSIDE=0]="INSIDE",n[n.INDETERMINATE=2147483647]="INDETERMINATE"})(ro||(ro={}));var GR=function(){function n(e){if(this.planes=[],e)this.planes=e;else for(var t=0;t<6;t++)this.planes.push(new FR)}return n.prototype.extractFromVPMatrix=function(e){var t=P(e,16),r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],f=t[9],d=t[10],p=t[11],v=t[12],g=t[13],m=t[14],x=t[15];_.t8(this.planes[0].normal,o-r,u-s,p-h),this.planes[0].distance=x-v,_.t8(this.planes[1].normal,o+r,u+s,p+h),this.planes[1].distance=x+v,_.t8(this.planes[2].normal,o+i,u+l,p+f),this.planes[2].distance=x+g,_.t8(this.planes[3].normal,o-i,u-l,p-f),this.planes[3].distance=x-g,_.t8(this.planes[4].normal,o-a,u-c,p-d),this.planes[4].distance=x-m,_.t8(this.planes[5].normal,o+a,u+c,p+d),this.planes[5].distance=x+m,this.planes.forEach(function(S){S.normalize(),S.updatePNVertexFlag()})},n}(),ar=function(){function n(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.copyFrom=function(e){this.x=e.x,this.y=e.y},n}(),Yo=function(){function n(e,t,r,i){this.x=e,this.y=t,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=t,this.bottom=t+i}return n.prototype.toJSON=function(){},n}(),Le="Method not implemented.",Vs="Use document.documentElement instead.",zR="Cannot append a destroyed element.",Se;(function(n){n[n.ORBITING=0]="ORBITING",n[n.EXPLORING=1]="EXPLORING",n[n.TRACKING=2]="TRACKING"})(Se||(Se={}));var ec;(function(n){n[n.DEFAULT=0]="DEFAULT",n[n.ROTATIONAL=1]="ROTATIONAL",n[n.TRANSLATIONAL=2]="TRANSLATIONAL",n[n.CINEMATIC=3]="CINEMATIC"})(ec||(ec={}));var Br;(function(n){n[n.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",n[n.PERSPECTIVE=1]="PERSPECTIVE"})(Br||(Br={}));var Sx={UPDATED:"updated"},_x=2e-4,Tx=function(){function n(){this.clipSpaceNearZ=zs.NEGATIVE_ONE,this.eventEmitter=new et,this.matrix=Q(),this.right=_.al(1,0,0),this.up=_.al(0,1,0),this.forward=_.al(0,0,1),this.position=_.al(0,0,1),this.focalPoint=_.al(0,0,0),this.distanceVector=_.al(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=Q(),this.projectionMatrixInverse=Q(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=Se.EXPLORING,this.trackingMode=ec.DEFAULT,this.projectionMode=Br.PERSPECTIVE,this.frustum=new GR,this.orthoMatrix=Q()}return n.prototype.isOrtho=function(){return this.projectionMode===Br.ORTHOGRAPHIC},n.prototype.getProjectionMode=function(){return this.projectionMode},n.prototype.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},n.prototype.getPerspectiveInverse=function(){return this.projectionMatrixInverse},n.prototype.getFrustum=function(){return this.frustum},n.prototype.getPosition=function(){return this.position},n.prototype.getFocalPoint=function(){return this.focalPoint},n.prototype.getDollyingStep=function(){return this.dollyingStep},n.prototype.getNear=function(){return this.near},n.prototype.getFar=function(){return this.far},n.prototype.getZoom=function(){return this.zoom},n.prototype.getOrthoMatrix=function(){return this.orthoMatrix},n.prototype.getView=function(){return this.view},n.prototype.setEnableUpdate=function(e){this.enableUpdate=e},n.prototype.setType=function(e,t){return this.type=e,this.type===Se.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Se.TRACKING&&t!==void 0&&this.setTrackingMode(t),this},n.prototype.setProjectionMode=function(e){return this.projectionMode=e,this},n.prototype.setTrackingMode=function(e){if(this.type!==Se.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this},n.prototype.setWorldRotation=function(e){return this.rotateWorld=e,this._getAngles(),this},n.prototype.getViewTransform=function(){return Wt(Q(),this.matrix)},n.prototype.getWorldTransform=function(){return this.matrix},n.prototype.jitterProjectionMatrix=function(e,t){var r=ue(Q(),[e,t,0]);this.jitteredProjectionMatrix=Ut(Q(),r,this.projectionMatrix)},n.prototype.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},n.prototype.setMatrix=function(e){return this.matrix=e,this._update(),this},n.prototype.setProjectionMatrix=function(e){this.projectionMatrix=e},n.prototype.setFov=function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this},n.prototype.setAspect=function(e){return this.setPerspective(this.near,this.far,this.fov,e),this},n.prototype.setNear=function(e){return this.projectionMode===Br.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this},n.prototype.setFar=function(e){return this.projectionMode===Br.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this},n.prototype.setViewOffset=function(e,t,r,i,a,o){return this.aspect=e/t,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.projectionMode===Br.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},n.prototype.clearViewOffset=function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Br.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},n.prototype.setZoom=function(e){return this.zoom=e,this.projectionMode===Br.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Br.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},n.prototype.setZoomByViewportPoint=function(e,t){var r=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),i=r.x,a=r.y,o=this.roll;this.rotate(0,0,-o),this.setPosition(i,a),this.setFocalPoint(i,a),this.setZoom(e),this.rotate(0,0,o);var s=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),l=s.x,c=s.y,u=_.al(l-i,c-a,0),h=_.AK(u,this.right)/_.kE(this.right),f=_.AK(u,this.up)/_.kE(this.up),d=P(this.getPosition(),2),p=d[0],v=d[1],g=P(this.getFocalPoint(),2),m=g[0],x=g[1];return this.setPosition(p-h,v-f),this.setFocalPoint(m-h,x-f),this},n.prototype.setPerspective=function(e,t,r,i){var a;this.projectionMode=Br.PERSPECTIVE,this.fov=r,this.near=e,this.far=t,this.aspect=i;var o=this.near*Math.tan(ke(.5*this.fov))/this.zoom,s=2*o,l=this.aspect*s,c=-.5*l;if(!((a=this.view)===null||a===void 0)&&a.enabled){var u=this.view.fullWidth,h=this.view.fullHeight;c+=this.view.offsetX*l/u,o-=this.view.offsetY*s/h,l*=this.view.width/u,s*=this.view.height/h}return LR(this.projectionMatrix,c,c+l,o-s,o,e,this.far,this.clipSpaceNearZ===zs.ZERO),Wt(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},n.prototype.setOrthographic=function(e,t,r,i,a,o){var s;this.projectionMode=Br.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=r,this.bottom=i,this.near=a,this.far=o;var l=(this.rright-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,f=u-l,d=u+l,p=h+c,v=h-c;if(!((s=this.view)===null||s===void 0)&&s.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;f+=g*this.view.offsetX,d=f+g*this.view.width,p-=m*this.view.offsetY,v=p-m*this.view.height}return this.clipSpaceNearZ===zs.NEGATIVE_ONE?Dc(this.projectionMatrix,f,d,p,v,a,o):Bc(this.projectionMatrix,f,d,p,v,a,o),Wt(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},n.prototype.setPosition=function(e,t,r){t===void 0&&(t=this.position[1]),r===void 0&&(r=this.position[2]);var i=yr(e,t,r);return this._setPosition(i),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},n.prototype.setFocalPoint=function(e,t,r){t===void 0&&(t=this.focalPoint[1]),r===void 0&&(r=this.focalPoint[2]);var i=_.al(0,1,0);if(this.focalPoint=yr(e,t,r),this.trackingMode===ec.CINEMATIC){var a=_.$X(_.Ue(),this.focalPoint,this.position);e=a[0],t=a[1],r=a[2];var o=_.kE(a),s=Oi(Math.asin(t/o)),l=90+Oi(Math.atan2(r,e)),c=Q();ur(c,c,ke(l)),_r(c,c,ke(s)),i=_.fF(_.Ue(),[0,1,0],c)}return Wt(this.matrix,Fc(Q(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},n.prototype.getDistance=function(){return this.distance},n.prototype.getDistanceVector=function(){return this.distanceVector},n.prototype.setDistance=function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<_x&&(this.distance=_x),this.dollyingStep=this.distance/100;var t=_.Ue();e=this.distance;var r=this.forward,i=this.focalPoint;return t[0]=e*r[0]+i[0],t[1]=e*r[1]+i[1],t[2]=e*r[2]+i[2],this._setPosition(t),this.triggerUpdate(),this},n.prototype.setMaxDistance=function(e){return this.maxDistance=e,this},n.prototype.setMinDistance=function(e){return this.minDistance=e,this},n.prototype.setAzimuth=function(e){return this.azimuth=Us(e),this.computeMatrix(),this._getAxes(),this.type===Se.ORBITING||this.type===Se.EXPLORING?this._getPosition():this.type===Se.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getAzimuth=function(){return this.azimuth},n.prototype.setElevation=function(e){return this.elevation=Us(e),this.computeMatrix(),this._getAxes(),this.type===Se.ORBITING||this.type===Se.EXPLORING?this._getPosition():this.type===Se.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getElevation=function(){return this.elevation},n.prototype.setRoll=function(e){return this.roll=Us(e),this.computeMatrix(),this._getAxes(),this.type===Se.ORBITING||this.type===Se.EXPLORING?this._getPosition():this.type===Se.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getRoll=function(){return this.roll},n.prototype._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},n.prototype.computeMatrix=function(){var e=kn(Vt(),[0,0,1],ke(this.roll));Xt(this.matrix);var t=kn(Vt(),[1,0,0],ke((this.rotateWorld&&this.type!==Se.TRACKING||this.type===Se.TRACKING?1:-1)*this.elevation)),r=kn(Vt(),[0,1,0],ke((this.rotateWorld&&this.type!==Se.TRACKING||this.type===Se.TRACKING?1:-1)*this.azimuth)),i=An(Vt(),r,t);i=An(Vt(),i,e);var a=La(Q(),i);this.type===Se.ORBITING||this.type===Se.EXPLORING?(Ee(this.matrix,this.matrix,this.focalPoint),Ut(this.matrix,this.matrix,a),Ee(this.matrix,this.matrix,[0,0,this.distance])):this.type===Se.TRACKING&&(Ee(this.matrix,this.matrix,this.position),Ut(this.matrix,this.matrix,a))},n.prototype._setPosition=function(e,t,r){this.position=yr(e,t,r);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()},n.prototype._getAxes=function(){_.JG(this.right,yr(ln(an(),[1,0,0,0],this.matrix))),_.JG(this.up,yr(ln(an(),[0,1,0,0],this.matrix))),_.JG(this.forward,yr(ln(an(),[0,0,1,0],this.matrix))),_.Fv(this.right,this.right),_.Fv(this.up,this.up),_.Fv(this.forward,this.forward)},n.prototype._getAngles=function(){var e=this.distanceVector[0],t=this.distanceVector[1],r=this.distanceVector[2],i=_.kE(this.distanceVector);if(i===0){this.elevation=0,this.azimuth=0;return}this.type===Se.TRACKING?(this.elevation=Oi(Math.asin(t/i)),this.azimuth=Oi(Math.atan2(-e,-r))):this.rotateWorld?(this.elevation=Oi(Math.asin(t/i)),this.azimuth=Oi(Math.atan2(-e,-r))):(this.elevation=-Oi(Math.asin(t/i)),this.azimuth=-Oi(Math.atan2(-e,-r)))},n.prototype._getPosition=function(){_.JG(this.position,yr(ln(an(),[0,0,0,1],this.matrix))),this._getDistance()},n.prototype._getFocalPoint=function(){_.kK(this.distanceVector,[0,0,-this.distance],qi.xO(qi.Ue(),this.matrix)),_.IH(this.focalPoint,this.position,this.distanceVector),this._getDistance()},n.prototype._getDistance=function(){this.distanceVector=_.$X(_.Ue(),this.focalPoint,this.position),this.distance=_.kE(this.distanceVector),this.dollyingStep=this.distance/100},n.prototype._getOrthoMatrix=function(){if(this.projectionMode===Br.ORTHOGRAPHIC){var e=this.position,t=kn(Vt(),[0,0,1],-this.roll*Math.PI/180);fr(this.orthoMatrix,t,_.al((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),_.al(this.zoom,this.zoom,1),e)}},n.prototype.triggerUpdate=function(){if(this.enableUpdate){var e=this.getViewTransform(),t=Ut(Q(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(t),this.eventEmitter.emit(Sx.UPDATED)}},n.prototype.rotate=function(e,t,r){throw new Error(Le)},n.prototype.pan=function(e,t){throw new Error(Le)},n.prototype.dolly=function(e){throw new Error(Le)},n.prototype.createLandmark=function(e,t){throw new Error(Le)},n.prototype.gotoLandmark=function(e,t){throw new Error(Le)},n.prototype.cancelLandmarkAnimation=function(){throw new Error(Le)},n}();function Yn(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var t=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=e?e.apply(this,r):r[0],o=t.cache;if(o.has(a))return o.get(a);var s=n.apply(this,r);return t.cache=o.set(a,s)||o,s};return t.cache=new(Yn.Cache||Map),t}Yn.Cache=Map;var bt;(function(n){n[n.kUnknown=0]="kUnknown",n[n.kNumber=1]="kNumber",n[n.kPercentage=2]="kPercentage",n[n.kEms=3]="kEms",n[n.kPixels=4]="kPixels",n[n.kRems=5]="kRems",n[n.kDegrees=6]="kDegrees",n[n.kRadians=7]="kRadians",n[n.kGradians=8]="kGradians",n[n.kTurns=9]="kTurns",n[n.kMilliseconds=10]="kMilliseconds",n[n.kSeconds=11]="kSeconds",n[n.kInteger=12]="kInteger"})(bt||(bt={}));var oi;(function(n){n[n.kUNumber=0]="kUNumber",n[n.kUPercent=1]="kUPercent",n[n.kULength=2]="kULength",n[n.kUAngle=3]="kUAngle",n[n.kUTime=4]="kUTime",n[n.kUOther=5]="kUOther"})(oi||(oi={}));var Px;(function(n){n[n.kAll=0]="kAll",n[n.kNonNegative=1]="kNonNegative",n[n.kInteger=2]="kInteger",n[n.kNonNegativeInteger=3]="kNonNegativeInteger",n[n.kPositiveInteger=4]="kPositiveInteger"})(Px||(Px={}));var rv;(function(n){n[n.kYes=0]="kYes",n[n.kNo=1]="kNo"})(rv||(rv={}));var iv;(function(n){n[n.kYes=0]="kYes",n[n.kNo=1]="kNo"})(iv||(iv={}));var WR=[{name:"em",unit_type:bt.kEms},{name:"px",unit_type:bt.kPixels},{name:"deg",unit_type:bt.kDegrees},{name:"rad",unit_type:bt.kRadians},{name:"grad",unit_type:bt.kGradians},{name:"ms",unit_type:bt.kMilliseconds},{name:"s",unit_type:bt.kSeconds},{name:"rem",unit_type:bt.kRems},{name:"turn",unit_type:bt.kTurns}],io;(function(n){n[n.kUnknownType=0]="kUnknownType",n[n.kUnparsedType=1]="kUnparsedType",n[n.kKeywordType=2]="kKeywordType",n[n.kUnitType=3]="kUnitType",n[n.kSumType=4]="kSumType",n[n.kProductType=5]="kProductType",n[n.kNegateType=6]="kNegateType",n[n.kInvertType=7]="kInvertType",n[n.kMinType=8]="kMinType",n[n.kMaxType=9]="kMaxType",n[n.kClampType=10]="kClampType",n[n.kTransformType=11]="kTransformType",n[n.kPositionType=12]="kPositionType",n[n.kURLImageType=13]="kURLImageType",n[n.kColorType=14]="kColorType",n[n.kUnsupportedColorType=15]="kUnsupportedColorType"})(io||(io={}));var UR=function(n){return WR.find(function(e){return e.name===n}).unit_type},VR=function(n){return n?n==="number"?bt.kNumber:n==="percent"||n==="%"?bt.kPercentage:UR(n):bt.kUnknown},HR=function(n){switch(n){case bt.kNumber:case bt.kInteger:return oi.kUNumber;case bt.kPercentage:return oi.kUPercent;case bt.kPixels:return oi.kULength;case bt.kMilliseconds:case bt.kSeconds:return oi.kUTime;case bt.kDegrees:case bt.kRadians:case bt.kGradians:case bt.kTurns:return oi.kUAngle;default:return oi.kUOther}},YR=function(n){switch(n){case oi.kUNumber:return bt.kNumber;case oi.kULength:return bt.kPixels;case oi.kUPercent:return bt.kPercentage;case oi.kUTime:return bt.kSeconds;case oi.kUAngle:return bt.kDegrees;default:return bt.kUnknown}},Mx=function(n){var e=1;switch(n){case bt.kPixels:case bt.kDegrees:case bt.kSeconds:break;case bt.kMilliseconds:e=.001;break;case bt.kRadians:e=180/Math.PI;break;case bt.kGradians:e=.9;break;case bt.kTurns:e=360;break}return e},av=function(n){switch(n){case bt.kNumber:case bt.kInteger:return"";case bt.kPercentage:return"%";case bt.kEms:return"em";case bt.kRems:return"rem";case bt.kPixels:return"px";case bt.kDegrees:return"deg";case bt.kRadians:return"rad";case bt.kGradians:return"grad";case bt.kMilliseconds:return"ms";case bt.kSeconds:return"s";case bt.kTurns:return"turn"}return""},Sh=function(){function n(){}return n.isAngle=function(e){return e===bt.kDegrees||e===bt.kRadians||e===bt.kGradians||e===bt.kTurns},n.isLength=function(e){return e>=bt.kEms&&e<bt.kDegrees},n.isRelativeUnit=function(e){return e===bt.kPercentage||e===bt.kEms||e===bt.kRems},n.isTime=function(e){return e===bt.kSeconds||e===bt.kMilliseconds},n.prototype.toString=function(){return this.buildCSSText(rv.kNo,iv.kNo,"")},n.prototype.isNumericValue=function(){return this.getType()>=io.kUnitType&&this.getType()<=io.kClampType},n}(),XR=function(n){B(e,n);function e(t){var r=n.call(this)||this;return r.colorSpace=t,r}return e.prototype.getType=function(){return io.kColorType},e.prototype.to=function(t){return this},e}(Sh),Hs;(function(n){n[n.Constant=0]="Constant",n[n.LinearGradient=1]="LinearGradient",n[n.RadialGradient=2]="RadialGradient"})(Hs||(Hs={}));var _h=function(n){B(e,n);function e(t,r){var i=n.call(this)||this;return i.type=t,i.value=r,i}return e.prototype.clone=function(){return new e(this.type,this.value)},e.prototype.buildCSSText=function(t,r,i){return i},e.prototype.getType=function(){return io.kColorType},e}(Sh),Fr=function(n){B(e,n);function e(t){var r=n.call(this)||this;return r.value=t,r}return e.prototype.clone=function(){return new e(this.value)},e.prototype.getType=function(){return io.kKeywordType},e.prototype.buildCSSText=function(t,r,i){return i+this.value},e}(Sh),jR=Yn(function(n){return n===void 0&&(n=""),n.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})}),Cx=function(n){return n.split("").map(function(e,t){return e.toUpperCase()===e?"".concat(t!==0?"-":"").concat(e.toLowerCase()):e}).join("")};function $R(n){if(!n)throw new Error}function Ys(n){return typeof n=="function"}function KR(n){return typeof n=="symbol"}var uW=function(n){return Object.fromEntries(Object.entries(n).filter(function(e){var t=__read(e,2),r=t[1];return r!==void 0}))},ZR={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign"},src:{alias:"img"}},ov=Yn(function(n){var e=jR(n),t=ZR[e];return e=(t==null?void 0:t.alias)||e,e}),qR=function(n,e){e===void 0&&(e="");var t="";return Number.isFinite(n)?($R(Number.isNaN(n)),t="NaN"):n>0?t="infinity":t="-infinity",t+=e},sv=function(n){return YR(HR(n))},Ie=function(n){B(e,n);function e(t,r){r===void 0&&(r=bt.kNumber);var i=n.call(this)||this,a;return typeof r=="string"?a=VR(r):a=r,i.unit=a,i.value=t,i}return e.prototype.clone=function(){return new e(this.value,this.unit)},e.prototype.equals=function(t){var r=t;return this.value===r.value&&this.unit===r.unit},e.prototype.getType=function(){return io.kUnitType},e.prototype.convertTo=function(t){if(this.unit===t)return new e(this.value,this.unit);var r=sv(this.unit);if(r!==sv(t)||r===bt.kUnknown)return null;var i=Mx(this.unit)/Mx(t);return new e(this.value*i,t)},e.prototype.buildCSSText=function(t,r,i){var a;switch(this.unit){case bt.kUnknown:break;case bt.kInteger:a=Number(this.value).toFixed(0);break;case bt.kNumber:case bt.kPercentage:case bt.kEms:case bt.kRems:case bt.kPixels:case bt.kDegrees:case bt.kRadians:case bt.kGradians:case bt.kMilliseconds:case bt.kSeconds:case bt.kTurns:{var o=-999999,s=999999,l=this.value,c=av(this.unit);if(l<o||l>s){var u=av(this.unit);!Number.isFinite(l)||Number.isNaN(l)?a=qR(l,u):a=l+(u||"")}else a="".concat(l).concat(c)}}return i+=a,i},e}(Sh),xn=new Ie(0,"px");new Ie(1,"px");var Ai=new Ie(0,"deg"),lv=function(n){B(e,n);function e(t,r,i,a,o){a===void 0&&(a=1),o===void 0&&(o=!1);var s=n.call(this,"rgb")||this;return s.r=t,s.g=r,s.b=i,s.alpha=a,s.isNone=o,s}return e.prototype.clone=function(){return new e(this.r,this.g,this.b,this.alpha)},e.prototype.buildCSSText=function(t,r,i){return i+"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")},e}(XR),$e=new Fr("unset"),JR=new Fr("initial"),QR=new Fr("inherit"),cv={"":$e,unset:$e,initial:JR,inherit:QR},uv=function(n){return cv[n]||(cv[n]=new Fr(n)),cv[n]},Th=new lv(0,0,0,0,!0),Ox=new lv(0,0,0,0),tk=Yn(function(n,e,t,r){return new lv(n,e,t,r)},function(n,e,t,r){return"rgba(".concat(n,",").concat(e,",").concat(t,",").concat(r,")")}),ze=function(n,e){return e===void 0&&(e=bt.kNumber),new Ie(n,e)};new Ie(50,"%");var hv;(function(n){n[n.Standard=0]="Standard"})(hv||(hv={}));var Xs;(function(n){n[n.ADDED=0]="ADDED",n[n.REMOVED=1]="REMOVED",n[n.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED"})(Xs||(Xs={}));var Ax={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Yo(0,0,0,0)},_t;(function(n){n.COORDINATE="<coordinate>",n.COLOR="<color>",n.PAINT="<paint>",n.NUMBER="<number>",n.ANGLE="<angle>",n.OPACITY_VALUE="<opacity-value>",n.SHADOW_BLUR="<shadow-blur>",n.LENGTH="<length>",n.PERCENTAGE="<percentage>",n.LENGTH_PERCENTAGE="<length> | <percentage>",n.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",n.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",n.LIST_OF_POINTS="<list-of-points>",n.PATH="<path>",n.FILTER="<filter>",n.Z_INDEX="<z-index>",n.OFFSET_DISTANCE="<offset-distance>",n.DEFINED_PATH="<defined-path>",n.MARKER="<marker>",n.TRANSFORM="<transform>",n.TRANSFORM_ORIGIN="<transform-origin>",n.TEXT="<text>",n.TEXT_TRANSFORM="<text-transform>"})(_t||(_t={}));function ek(n){var e=n.type,t=n.value;return e==="hex"?"#".concat(t):e==="literal"?t:e==="rgb"?"rgb(".concat(t.join(","),")"):"rgba(".concat(t.join(","),")")}var nk=function(){var n={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function t(I){throw new Error(e+": "+I)}function r(){var I=i();return e.length>0&&t("Invalid input not EOF"),I}function i(){return S(a)}function a(){return o("linear-gradient",n.linearGradient,l)||o("repeating-linear-gradient",n.repeatingLinearGradient,l)||o("radial-gradient",n.radialGradient,h)||o("repeating-radial-gradient",n.repeatingRadialGradient,h)||o("conic-gradient",n.conicGradient,h)}function o(I,q,J){return s(q,function(wt){var Ft=J();return Ft&&(z(n.comma)||t("Missing comma before color stops")),{type:I,orientation:Ft,colorStops:S(T)}})}function s(I,q){var J=z(I);if(J){z(n.startCall)||t("Missing (");var wt=q(J);return z(n.endCall)||t("Missing )"),wt}}function l(){return c()||u()}function c(){return L("directional",n.sideOrCorner,1)}function u(){return L("angular",n.angleValue,1)}function h(){var I,q=f(),J;return q&&(I=[],I.push(q),J=e,z(n.comma)&&(q=f(),q?I.push(q):e=J)),I}function f(){var I=d()||p();if(I)I.at=g();else{var q=v();if(q){I=q;var J=g();J&&(I.at=J)}else{var wt=m();wt&&(I={type:"default-radial",at:wt})}}return I}function d(){var I=L("shape",/^(circle)/i,0);return I&&(I.style=R()||v()),I}function p(){var I=L("shape",/^(ellipse)/i,0);return I&&(I.style=O()||v()),I}function v(){return L("extent-keyword",n.extentKeywords,1)}function g(){if(L("position",/^at/,0)){var I=m();return I||t("Missing positioning value"),I}}function m(){var I=x();if(I.x||I.y)return{type:"position",value:I}}function x(){return{x:O(),y:O()}}function S(I){var q=I(),J=[];if(q)for(J.push(q);z(n.comma);)q=I(),q?J.push(q):t("One extra comma");return J}function T(){var I=b();return I||t("Expected color definition"),I.length=O(),I}function b(){return E()||C()||w()||y()}function y(){return L("literal",n.literalColor,0)}function E(){return L("hex",n.hexColor,1)}function w(){return s(n.rgbColor,function(){return{type:"rgb",value:S(M)}})}function C(){return s(n.rgbaColor,function(){return{type:"rgba",value:S(M)}})}function M(){return z(n.number)[1]}function O(){return L("%",n.percentageValue,1)||A()||R()}function A(){return L("position-keyword",n.positionKeywords,1)}function R(){return L("px",n.pixelValue,1)||L("em",n.emValue,1)}function L(I,q,J){var wt=z(q);if(wt)return{type:I,value:wt[J]}}function z(I){var q=/^[\n\r\t\s]+/.exec(e);q&&Y(q[0].length);var J=I.exec(e);return J&&Y(J[0].length),J}function Y(I){e=e.substring(I)}return function(I){return e=I,r()}}();function hW(n,e,t,r){var i=ke(r.value),a=0,o=0,s=a+e/2,l=o+t/2,c=Math.abs(e*Math.cos(i))+Math.abs(t*Math.sin(i)),u=n[0]+s-Math.cos(i)*c/2,h=n[1]+l-Math.sin(i)*c/2,f=n[0]+s+Math.cos(i)*c/2,d=n[1]+l+Math.sin(i)*c/2;return{x1:u,y1:h,x2:f,y2:d}}function fW(n,e,t,r,i,a){var o=r.value,s=i.value;r.unit===bt.kPercentage&&(o=r.value/100*e),i.unit===bt.kPercentage&&(s=i.value/100*t);var l=Math.max(distanceSquareRoot([0,0],[o,s]),distanceSquareRoot([0,t],[o,s]),distanceSquareRoot([e,t],[o,s]),distanceSquareRoot([e,0],[o,s]));return a&&(a instanceof Ie?l=a.value:a instanceof Fr&&(a.value==="closest-side"?l=Math.min(o,e-o,s,t-s):a.value==="farthest-side"?l=Math.max(o,e-o,s,t-s):a.value==="closest-corner"&&(l=Math.min(distanceSquareRoot([0,0],[o,s]),distanceSquareRoot([0,t],[o,s]),distanceSquareRoot([e,t],[o,s]),distanceSquareRoot([e,0],[o,s]))))),{x:o+n[0],y:s+n[1],r:l}}var rk=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,ik=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,ak=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,Nx=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function ok(n){var e,t,r,i=n.length;n[i-1].length=(e=n[i-1].length)!==null&&e!==void 0?e:{type:"%",value:"100"},i>1&&(n[0].length=(t=n[0].length)!==null&&t!==void 0?t:{type:"%",value:"0"});for(var a=0,o=Number(n[0].length.value),s=1;s<i;s++){var l=(r=n[s].length)===null||r===void 0?void 0:r.value;if(!pt(l)&&!pt(o)){for(var c=1;c<s-a;c++)n[a+c].length={type:"%",value:"".concat(o+(Number(l)-o)*c/(s-a))};a=s,o=Number(l)}}}var sk={left:270-90,top:0-90,bottom:180-90,right:90-90,"left top":315-90,"top left":315-90,"left bottom":225-90,"bottom left":225-90,"right top":45-90,"top right":45-90,"right bottom":135-90,"bottom right":135-90},lk=Yn(function(n){var e;return n.type==="angular"?e=Number(n.value):e=sk[n.value]||0,ze(e,"deg")}),ck=Yn(function(n){var e=50,t=50,r="%",i="%";if((n==null?void 0:n.type)==="position"){var a=n.value,o=a.x,s=a.y;(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?e=0:o.value==="center"?e=50:o.value==="right"?e=100:o.value==="top"?t=0:o.value==="bottom"&&(t=100)),(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?e=0:s.value==="center"?t=50:s.value==="right"?e=100:s.value==="top"?t=0:s.value==="bottom"&&(t=100)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(r=o==null?void 0:o.type,e=Number(o.value)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(i=s==null?void 0:s.type,t=Number(s.value))}return{cx:ze(e,r),cy:ze(t,i)}}),uk=Yn(function(n){var e;if(n.indexOf("linear")>-1||n.indexOf("radial")>-1){var t=nk(n);return t.map(function(s){var l=s.type,c=s.orientation,u=s.colorStops;ok(u);var h=u.map(function(S){return{offset:ze(Number(S.length.value),"%"),color:ek(S)}});if(l==="linear-gradient")return new _h(Hs.LinearGradient,{angle:c?lk(c):Ai,steps:h});if(l==="radial-gradient"&&(c||(c=[{type:"shape",value:"circle"}]),c[0].type==="shape"&&c[0].value==="circle")){var f=ck(c[0].at),d=f.cx,p=f.cy,v=void 0;if(c[0].style){var g=c[0].style,m=g.type,x=g.value;m==="extent-keyword"?v=uv(x):v=ze(x,m)}return new _h(Hs.RadialGradient,{cx:d,cy:p,size:v,steps:h})}})}var r=n[0];if(n[1]==="("||n[2]==="("){if(r==="l"){var i=rk.exec(n);if(i){var a=((e=i[2].match(Nx))===null||e===void 0?void 0:e.map(function(s){return s.split(":")}))||[];return[new _h(Hs.LinearGradient,{angle:ze(parseFloat(i[1]),"deg"),steps:a.map(function(s){var l=P(s,2),c=l[0],u=l[1];return{offset:ze(Number(c)*100,"%"),color:u}})})]}}else if(r==="r"){var o=hk(n);if(o)if(qt(o))n=o;else return[new _h(Hs.RadialGradient,o)]}else if(r==="p")return fk(n)}});function hk(n){var e,t=ik.exec(n);if(t){var r=((e=t[4].match(Nx))===null||e===void 0?void 0:e.map(function(i){return i.split(":")}))||[];return{cx:ze(50,"%"),cy:ze(50,"%"),steps:r.map(function(i){var a=P(i,2),o=a[0],s=a[1];return{offset:ze(Number(o)*100,"%"),color:s}})}}return null}function fk(n){var e=ak.exec(n);if(e){var t=e[1],r=e[2];switch(t){case"a":t="repeat";break;case"x":t="repeat-x";break;case"y":t="repeat-y";break;case"n":t="no-repeat";break;default:t="no-repeat"}return{image:r,repetition:t}}return null}function dW(n){return!!n.type&&!!n.value}function dk(n){return n&&!!n.image}function Rx(n){return n&&!pt(n.r)&&!pt(n.g)&&!pt(n.b)}var js=Yn(function(n){if(dk(n))return N({repetition:"repeat"},n);if(pt(n)&&(n=""),n==="transparent")return Ox;if(n==="currentColor")n="black";else if(n==="none")return Th;var e=uk(n);if(e)return e;var t=ld.ZP(n),r=[0,0,0,0];return t!==null&&(r[0]=t.r||0,r[1]=t.g||0,r[2]=t.b||0,r[3]=t.opacity),tk.apply(void 0,K([],P(r),!1))});function pk(n,e){if(!(!Rx(n)||!Rx(e)))return[[Number(n.r),Number(n.g),Number(n.b),Number(n.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var r=t.slice();if(r[3])for(var i=0;i<3;i++)r[i]=Math.round(he(r[i],0,255));return r[3]=he(r[3],0,1),"rgba(".concat(r.join(","),")")}]}function nc(n,e){if(pt(e))return ze(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(n)>=0)return ze(Number(e),"px");if("deg".search(n)>=0)return ze(Number(e),"deg")}var t=[];e=e.replace(n,function(i){return t.push(i),"U"+i});var r="U("+n.source+")";return t.map(function(i){return ze(Number(e.replace(new RegExp("U"+i,"g"),"").replace(new RegExp(r,"g"),"*0")),i)})[0]}var kx=function(n){return nc(new RegExp("px","g"),n)},vk=Yn(kx),gk=function(n){return nc(new RegExp("%","g"),n)};Yn(gk);var rc=function(n){return te(n)||isFinite(Number(n))?ze(Number(n)||0,"px"):nc(new RegExp("px|%|em|rem","g"),n)},$s=Yn(rc),fv=function(n){return nc(new RegExp("deg|rad|grad|turn","g"),n)},Lx=Yn(fv);function mk(n,e,t,r,i){i===void 0&&(i=0);var a="",o=n.value||0,s=e.value||0,l=sv(n.unit),c=n.convertTo(l),u=e.convertTo(l);return c&&u?(o=c.value,s=u.value,a=av(n.unit)):(Ie.isLength(n.unit)||Ie.isLength(e.unit))&&(o=si(n,i,t),s=si(e,i,t),a="px"),[o,s,function(h){return r&&(h=Math.max(h,0)),h+a}]}function Gr(n){var e=0;return n.unit===bt.kDegrees?e=n.value:n.unit===bt.kRadians?e=Oi(Number(n.value)):n.unit===bt.kTurns&&(e=AR(Number(n.value))),e}function Ix(n,e){var t;return Array.isArray(n)?t=n.map(function(r){return Number(r)}):qt(n)?t=n.split(" ").map(function(r){return Number(r)}):te(n)&&(t=[n]),e===2?t.length===1?[t[0],t[0]]:[t[0],t[1]]:t.length===1?[t[0],t[0],t[0],t[0]]:t.length===2?[t[0],t[1],t[0],t[1]]:t.length===3?[t[0],t[1],t[2],t[1]]:[t[0],t[1],t[2],t[3]]}function Dx(n){return qt(n)?n.split(" ").map(function(e){return $s(e)}):n.map(function(e){return $s(e.toString())})}function si(n,e,t,r){if(r===void 0&&(r=!1),n.unit===bt.kPixels)return Number(n.value);if(n.unit===bt.kPercentage&&t){var i=t.nodeName===Rt.GROUP?t.getLocalBounds():t.getGeometryBounds();return(r?i.min[e]:0)+n.value/100*i.halfExtents[e]*2}return 0}var yk=function(n){return nc(/deg|rad|grad|turn|px|%/g,n)},xk=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function Bx(n){if(n===void 0&&(n=""),n=n.toLowerCase().trim(),n==="none")return[];for(var e=/\s*([\w-]+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];if(i=r.index+r[0].length,xk.indexOf(r[1])>-1&&t.push({name:r[1],params:r[2].split(" ").map(function(a){return yk(a)||js(a)})}),e.lastIndex===n.length)return t}return[]}function Fx(n){return n.toString()}var Ks=function(n){return typeof n=="number"?ze(n):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(n)?ze(Number(n)):ze(0)},Xo=Yn(Ks);Yn(function(n){return qt(n)?n.split(" ").map(Xo):n.map(Xo)});function dv(n,e){return[n,e,Fx]}function pv(n,e){return function(t,r){return[t,r,function(i){return Fx(he(i,n,e))}]}}function Gx(n,e){if(n.length===e.length)return[n,e,function(t){return t}]}function zx(n){return n.parsedStyle.d.totalLength===0&&(n.parsedStyle.d.totalLength=nd(n.parsedStyle.d.absolutePath)),n.parsedStyle.d.totalLength}function bk(n){return n.parsedStyle.points.totalLength===0&&(n.parsedStyle.points.totalLength=gd(n.parsedStyle.points.points)),n.parsedStyle.points.totalLength}function Ek(n){for(var e=0;e<n.length;e++){var t=n[e-1],r=n[e],i=r[0];if(i==="M"&&t){var a=t[0],o=[r[1],r[2]],s=void 0;a==="L"||a==="M"?s=[t[1],t[2]]:(a==="C"||a==="A"||a==="Q")&&(s=[t[t.length-2],t[t.length-1]]),s&&Ph(o,s)&&(n.splice(e,1),e--)}}}function wk(n){for(var e=!1,t=n.length,r=0;r<t;r++){var i=n[r],a=i[0];if(a==="C"||a==="A"||a==="Q"){e=!0;break}}return e}function Sk(n){for(var e=[],t=[],r=[],i=0;i<n.length;i++){var a=n[i],o=a[0];o==="M"?(r.length&&(t.push(r),r=[]),r.push([a[1],a[2]])):o==="Z"?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]])}return r.length>0&&t.push(r),{polygons:e,polylines:t}}function Ph(n,e){return n[0]===e[0]&&n[1]===e[1]}function _k(n,e){for(var t=[],r=[],i=[],a=0;a<n.length;a++){var o=n[a],s=o.currentPoint,l=o.params,c=o.prePoint,u=void 0;switch(o.command){case"Q":u=yd(c[0],c[1],l[1],l[2],l[3],l[4]);break;case"C":u=vd(c[0],c[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;u=dd(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:t.push(s[0]),r.push(s[1]);break}u&&(o.box=u,t.push(u.x,u.x+u.width),r.push(u.y,u.y+u.height)),e&&(o.command==="L"||o.command==="M")&&o.prePoint&&o.nextPoint&&i.push(o)}t=t.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0}),r=r.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0});var f=Fa(t),d=Fa(r),p=Ga(t),v=Ga(r);if(i.length===0)return{x:f,y:d,width:p-f,height:v-d};for(var a=0;a<i.length;a++){var o=i[a],s=o.currentPoint,g=void 0;s[0]===f?(g=Mh(o,e),f=f-g.xExtra):s[0]===p&&(g=Mh(o,e),p=p+g.xExtra),s[1]===d?(g=Mh(o,e),d=d-g.yExtra):s[1]===v&&(g=Mh(o,e),v=v+g.yExtra)}return{x:f,y:d,width:p-f,height:v-d}}function Mh(n,e){var t=n.prePoint,r=n.currentPoint,i=n.nextPoint,a=Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2),l=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!l||Math.sin(l)===0||Co(l,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));c=c>Math.PI/2?Math.PI-c:c,u=u>Math.PI/2?Math.PI-u:u;var h={xExtra:Math.cos(l/2-c)*(e/2*(1/Math.sin(l/2)))-e/2||0,yExtra:Math.cos(u-l/2)*(e/2*(1/Math.sin(l/2)))-e/2||0};return h}function Wx(n,e){return[e[0]+(e[0]-n[0]),e[1]+(e[1]-n[1])]}var Ux=function(n,e){var t=n.x*e.x+n.y*e.y,r=Math.sqrt((Math.pow(n.x,2)+Math.pow(n.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2))),i=n.x*e.y-n.y*e.x<0?-1:1,a=i*Math.acos(t/r);return a},Vx=function(n,e,t,r,i,a,o,s){e=Math.abs(e),t=Math.abs(t),r=us(r,360);var l=ke(r);if(n.x===o.x&&n.y===o.y)return{x:n.x,y:n.y,ellipticalArcAngle:0};if(e===0||t===0)return{x:0,y:0,ellipticalArcAngle:0};var c=(n.x-o.x)/2,u=(n.y-o.y)/2,h={x:Math.cos(l)*c+Math.sin(l)*u,y:-Math.sin(l)*c+Math.cos(l)*u},f=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(t,2);f>1&&(e=Math.sqrt(f)*e,t=Math.sqrt(f)*t);var d=Math.pow(e,2)*Math.pow(t,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(t,2)*Math.pow(h.x,2),p=Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(t,2)*Math.pow(h.x,2),v=d/p;v=v<0?0:v;var g=(i!==a?1:-1)*Math.sqrt(v),m={x:g*(e*h.y/t),y:g*(-(t*h.x)/e)},x={x:Math.cos(l)*m.x-Math.sin(l)*m.y+(n.x+o.x)/2,y:Math.sin(l)*m.x+Math.cos(l)*m.y+(n.y+o.y)/2},S={x:(h.x-m.x)/e,y:(h.y-m.y)/t},T=Ux({x:1,y:0},S),b={x:(-h.x-m.x)/e,y:(-h.y-m.y)/t},y=Ux(S,b);!a&&y>0?y-=2*Math.PI:a&&y<0&&(y+=2*Math.PI),y%=2*Math.PI;var E=T+y*s,w=e*Math.cos(E),C=t*Math.sin(E),M={x:Math.cos(l)*w-Math.sin(l)*C+x.x,y:Math.sin(l)*w+Math.cos(l)*C+x.y,ellipticalArcStartAngle:T,ellipticalArcEndAngle:T+y,ellipticalArcAngle:E,ellipticalArcCenter:x,resultantRx:e,resultantRy:t};return M};function Tk(n){for(var e=[],t=null,r=null,i=null,a=0,o=n.length,s=0;s<o;s++){var l=n[s];r=n[s+1];var c=l[0],u={command:c,prePoint:t,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(c){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=Pk(t,l);u.arcParams=h;break}if(c==="Z")t=i,r=n[a+1];else{var f=l.length;t=[l[f-2],l[f-1]]}r&&r[0]==="Z"&&(r=n[a],e[a]&&(e[a].prePoint=t)),u.currentPoint=t,e[a]&&Ph(t,e[a].currentPoint)&&(e[a].prePoint=u.prePoint);var d=r?[r[r.length-2],r[r.length-1]]:null;u.nextPoint=d;var p=u.prePoint;if(["L","H","V"].includes(c))u.startTangent=[p[0]-t[0],p[1]-t[1]],u.endTangent=[t[0]-p[0],t[1]-p[1]];else if(c==="Q"){var v=[l[1],l[2]];u.startTangent=[p[0]-v[0],p[1]-v[1]],u.endTangent=[t[0]-v[0],t[1]-v[1]]}else if(c==="T"){var g=e[s-1],v=Wx(g.currentPoint,p);g.command==="Q"?(u.command="Q",u.startTangent=[p[0]-v[0],p[1]-v[1]],u.endTangent=[t[0]-v[0],t[1]-v[1]]):(u.command="TL",u.startTangent=[p[0]-t[0],p[1]-t[1]],u.endTangent=[t[0]-p[0],t[1]-p[1]])}else if(c==="C"){var m=[l[1],l[2]],x=[l[3],l[4]];u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]],u.startTangent[0]===0&&u.startTangent[1]===0&&(u.startTangent=[m[0]-x[0],m[1]-x[1]]),u.endTangent[0]===0&&u.endTangent[1]===0&&(u.endTangent=[x[0]-m[0],x[1]-m[1]])}else if(c==="S"){var g=e[s-1],m=Wx(g.currentPoint,p),x=[l[1],l[2]];g.command==="C"?(u.command="C",u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]]):(u.command="SQ",u.startTangent=[p[0]-x[0],p[1]-x[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]])}else if(c==="A"){var S=Hx(u,0),T=S.x,b=S.y,y=Hx(u,1,!1),E=y.x,w=y.y;u.startTangent=[T,b],u.endTangent=[E,w]}e.push(u)}return e}function Hx(n,e,t){t===void 0&&(t=!0);var r=n.arcParams,i=r.rx,a=i===void 0?0:i,o=r.ry,s=o===void 0?0:o,l=r.xRotation,c=r.arcFlag,u=r.sweepFlag,h=Vx({x:n.prePoint[0],y:n.prePoint[1]},a,s,l,!!c,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},e),f=Vx({x:n.prePoint[0],y:n.prePoint[1]},a,s,l,!!c,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},t?e+.005:e-.005),d=f.x-h.x,p=f.y-h.y,v=Math.sqrt(d*d+p*p);return{x:-d/v,y:-p/v}}function Ch(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function vv(n,e){return Ch(n)*Ch(e)?(n[0]*e[0]+n[1]*e[1])/(Ch(n)*Ch(e)):1}function Yx(n,e){return(n[0]*e[1]<n[1]*e[0]?-1:1)*Math.acos(vv(n,e))}function Pk(n,e){var t=e[1],r=e[2],i=us(ke(e[3]),Math.PI*2),a=e[4],o=e[5],s=n[0],l=n[1],c=e[6],u=e[7],h=Math.cos(i)*(s-c)/2+Math.sin(i)*(l-u)/2,f=-1*Math.sin(i)*(s-c)/2+Math.cos(i)*(l-u)/2,d=h*h/(t*t)+f*f/(r*r);d>1&&(t*=Math.sqrt(d),r*=Math.sqrt(d));var p=t*t*(f*f)+r*r*(h*h),v=p?Math.sqrt((t*t*(r*r)-p)/p):1;a===o&&(v*=-1),isNaN(v)&&(v=0);var g=r?v*t*f/r:0,m=t?v*-r*h/t:0,x=(s+c)/2+Math.cos(i)*g-Math.sin(i)*m,S=(l+u)/2+Math.sin(i)*g+Math.cos(i)*m,T=[(h-g)/t,(f-m)/r],b=[(-1*h-g)/t,(-1*f-m)/r],y=Yx([1,0],T),E=Yx(T,b);return vv(T,b)<=-1&&(E=Math.PI),vv(T,b)>=1&&(E=0),o===0&&E>0&&(E=E-2*Math.PI),o===1&&E<0&&(E=E+2*Math.PI),{cx:x,cy:S,rx:Ph(n,[c,u])?0:t,ry:Ph(n,[c,u])?0:r,startAngle:y,endAngle:y+E,xRotation:i,arcFlag:a,sweepFlag:o}}function Mk(n,e,t){return n.reduce(function(r,i){var a="";if(i[0]==="M"||i[0]==="L"){var o=vec3.fromValues(i[1],i[2],0);t&&vec3.transformMat4(o,o,t),a="".concat(i[0]).concat(o[0],",").concat(o[1])}else if(i[0]==="Z")a=i[0];else if(i[0]==="C"){var s=vec3.fromValues(i[1],i[2],0),l=vec3.fromValues(i[3],i[4],0),c=vec3.fromValues(i[5],i[6],0);t&&(vec3.transformMat4(s,s,t),vec3.transformMat4(l,l,t),vec3.transformMat4(c,c,t)),a="".concat(i[0]).concat(s[0],",").concat(s[1],",").concat(l[0],",").concat(l[1],",").concat(c[0],",").concat(c[1])}else if(i[0]==="A"){var u=vec3.fromValues(i[6],i[7],0);t&&vec3.transformMat4(u,u,t),a="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],",").concat(i[5],",").concat(u[0],",").concat(u[1])}else if(i[0]==="Q"){var s=vec3.fromValues(i[1],i[2],0),l=vec3.fromValues(i[3],i[4],0);t&&(vec3.transformMat4(s,s,t),vec3.transformMat4(l,l,t)),a="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],"}")}return r+=a},"")}function Ck(n,e,t,r){return[["M",n,e],["L",t,r]]}function Xx(n,e,t,r){var i=(-1+Math.sqrt(2))/3*4,a=n*i,o=e*i,s=t-n,l=t+n,c=r-e,u=r+e;return[["M",s,r],["C",s,r-o,t-a,c,t,c],["C",t+a,c,l,r-o,l,r],["C",l,r+o,t+a,u,t,u],["C",t-a,u,s,r+o,s,r],["Z"]]}function Ok(n,e){var t=n.map(function(r,i){return[i===0?"M":"L",r[0],r[1]]});return e&&t.push(["Z"]),t}function Ak(n,e,t,r,i){if(i){var a=__read(i,4),o=a[0],s=a[1],l=a[2],c=a[3],u=n>0?1:-1,h=e>0?1:-1,f=u+h!==0?1:0;return[["M",u*o+t,r],["L",n-u*s+t,r],s?["A",s,s,0,0,f,n+t,h*s+r]:null,["L",n+t,e-h*l+r],l?["A",l,l,0,0,f,n+t-u*l,e+r]:null,["L",t+u*c,e+r],c?["A",c,c,0,0,f,t,e+r-h*c]:null,["L",t,h*o+r],o?["A",o,o,0,0,f,u*o+t,r]:null,["Z"]].filter(function(d){return d})}return[["M",t,r],["L",t+n,r],["L",t+n,r+e],["L",t,r+e],["Z"]]}function pW(n,e){e===void 0&&(e=n.getLocalTransform());var t=[];switch(n.nodeName){case Rt.LINE:var r=n.parsedStyle,i=r.x1,a=i===void 0?0:i,o=r.y1,s=o===void 0?0:o,l=r.x2,c=l===void 0?0:l,u=r.y2,h=u===void 0?0:u;t=Ck(a,s,c,h);break;case Rt.CIRCLE:{var f=n.parsedStyle,d=f.r,p=d===void 0?0:d,v=f.cx,g=v===void 0?0:v,m=f.cy,x=m===void 0?0:m;t=Xx(p,p,g,x);break}case Rt.ELLIPSE:{var S=n.parsedStyle,T=S.rx,b=T===void 0?0:T,y=S.ry,E=y===void 0?0:y,w=S.cx,g=w===void 0?0:w,C=S.cy,x=C===void 0?0:C;t=Xx(b,E,g,x);break}case Rt.POLYLINE:case Rt.POLYGON:var M=n.parsedStyle.points;t=Ok(M.points,n.nodeName===Rt.POLYGON);break;case Rt.RECT:var O=n.parsedStyle,A=O.width,R=A===void 0?0:A,L=O.height,z=L===void 0?0:L,Y=O.x,I=Y===void 0?0:Y,q=O.y,J=q===void 0?0:q,wt=O.radius,Ft=wt&&wt.some(function(xe){return xe!==0});t=Ak(R,z,I,J,Ft&&wt.map(function(xe){return clamp(xe,0,Math.min(Math.abs(R)/2,Math.abs(z)/2))}));break;case Rt.PATH:var fe=n.parsedStyle.d.absolutePath;t=__spreadArray([],__read(fe),!1);break}if(t.length)return Mk(t,n,e)}function vW(n,e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0);var a=n.map(function(o,s){var l=o[0],c=n[s+1],u=s===0&&(e!==0||t!==0),h=(s===n.length-1||c&&(c[0]==="M"||c[0]==="Z"))&&r!==0&&i!==0;switch(l){case"M":return u?"M ".concat(o[1]+e,",").concat(o[2]+t," L ").concat(o[1],",").concat(o[2]):"M ".concat(o[1],",").concat(o[2]);case"L":return"L ".concat(o[1]+(h?r:0),",").concat(o[2]+(h?i:0));case"Q":return"Q ".concat(o[1]," ").concat(o[2],",").concat(o[3]," ").concat(o[4])+(h?" L ".concat(o[3]+r,",").concat(o[4]+i):"");case"C":return"C ".concat(o[1]," ").concat(o[2],",").concat(o[3]," ").concat(o[4],",").concat(o[5]," ").concat(o[6])+(h?" L ".concat(o[5]+r,",").concat(o[6]+i):"");case"A":return"A ".concat(o[1]," ").concat(o[2]," ").concat(o[3]," ").concat(o[4]," ").concat(o[5]," ").concat(o[6]," ").concat(o[7])+(h?" L ".concat(o[6]+r,",").concat(o[7]+i):"");case"Z":return"Z"}}).join(" ");return~a.indexOf("NaN")?"":a}var jx=function(n){if(n===""||Array.isArray(n)&&n.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=Da(n)}catch(f){e=Da(""),console.error("[g]: Invalid SVG Path definition: ".concat(n))}Ek(e);var t=wk(e),r=Sk(e),i=r.polygons,a=r.polylines,o=Tk(e),s=_k(o,0),l=s.x,c=s.y,u=s.width,h=s.height;return{absolutePath:e,hasArc:t,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(u)?u:0,height:Number.isFinite(h)?h:0}}},Nk=Yn(jx);function gv(n){return qt(n)?Nk(n):jx(n)}function Rk(n,e,t){var r=n.curve,i=e.curve;(!r||r.length===0)&&(r=Oo(n.absolutePath,!1),n.curve=r),(!i||i.length===0)&&(i=Oo(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=Uc(r,i));var o=hs(a[0])!==hs(a[1])?id(a[0]):ad(a[0]);return[o,od(a[1],o),function(s){return s}]}function $x(n,e){var t;return qt(n)?t=n.split(" ").map(function(r){var i=P(r.split(","),2),a=i[0],o=i[1];return[Number(a),Number(o)]}):t=n,{points:t,totalLength:0,segments:[]}}function kk(n,e){return[n.points,e.points,function(t){return t}]}var hn=null;function zr(n){return function(e){var t=0;return n.map(function(r){return r===hn?e[t++]:r})}}function jo(n){return n}var Oh={matrix:["NNNNNN",[hn,hn,0,0,hn,hn,0,0,0,0,1,0,hn,hn,0,1],jo],matrix3d:["NNNNNNNNNNNNNNNN",jo],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",zr([hn,hn,new Ie(1)]),jo],scalex:["N",zr([hn,new Ie(1),new Ie(1)]),zr([hn,new Ie(1)])],scaley:["N",zr([new Ie(1),hn,new Ie(1)]),zr([new Ie(1),hn])],scalez:["N",zr([new Ie(1),new Ie(1),hn])],scale3d:["NNN",jo],skew:["Aa",null,jo],skewx:["A",null,zr([hn,Ai])],skewy:["A",null,zr([Ai,hn])],translate:["Tt",zr([hn,hn,xn]),jo],translatex:["T",zr([hn,xn,xn]),zr([hn,xn])],translatey:["T",zr([xn,hn,xn]),zr([xn,hn])],translatez:["L",zr([xn,xn,hn])],translate3d:["TTL",jo]};function Kx(n){if(n=(n||"none").toLowerCase().trim(),n==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];i=r.index+r[0].length;var a=r[1],o=Oh[a];if(!o)return[];var s=r[2].split(","),l=o[0];if(l.length<s.length)return[];for(var c=[],u=0;u<l.length;u++){var h=s[u],f=l[u],d=void 0;if(h?d={A:function(p){return p.trim()==="0"?Ai:Lx(p)},N:Xo,T:$s,L:vk}[f.toUpperCase()](h):d={a:Ai,n:c[0],t:xn}[f],d===void 0)return[];c.push(d)}if(t.push({t:a,d:c}),e.lastIndex===n.length)return t}return[]}function Zx(n){if(n=(n||"none").toLowerCase().trim(),n==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];i=r.index+r[0].length;var a=r[1],o=Oh[a];if(!o)return[];var s=r[2].split(","),l=o[0];if(l.length<s.length)return[];for(var c=[],u=0;u<l.length;u++){var h=s[u],f=l[u],d=void 0;if(h?d={A:function(p){return p.trim()==="0"?Ai:fv(p)},N:Ks,T:rc,L:kx}[f.toUpperCase()](h):d={a:Ai,n:c[0],t:xn}[f],d===void 0)return[];c.push(d)}if(t.push({t:a,d:c}),e.lastIndex===n.length)return t}return[]}function Lk(n){var e,t,r,i;switch(n.t){case"rotatex":return i=ke(Gr(n.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotatey":return i=ke(Gr(n.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotatez":return i=ke(Gr(n.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=n.d[0].value,t=n.d[1].value,r=n.d[2].value,i=ke(Gr(n.d[3]));var a=e*e+t*t+r*r;if(a===0)e=1,t=0,r=0;else if(a!==1){var o=Math.sqrt(a);e/=o,t/=o,r/=o}var s=Math.sin(i/2),l=s*Math.cos(i/2),c=s*s;return[1-2*(t*t+r*r)*c,2*(e*t*c+r*l),2*(e*r*c-t*l),0,2*(e*t*c-r*l),1-2*(e*e+r*r)*c,2*(t*r*c+e*l),0,2*(e*r*c+t*l),2*(t*r*c-e*l),1-2*(e*e+t*t)*c,0,0,0,0,1];case"scale":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scalex":return[n.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,n.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,n.d[0].value,0,0,0,0,1];case"scale3d":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,n.d[2].value,0,0,0,0,1];case"skew":var u=ke(Gr(n.d[0])),h=ke(Gr(n.d[1]));return[1,Math.tan(h),0,0,Math.tan(u),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return i=ke(Gr(n.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return i=ke(Gr(n.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return e=si(n.d[0],0,null)||0,t=si(n.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1];case"translatex":return e=si(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,0,0,1];case"translatey":return t=si(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,t,0,1];case"translatez":return r=si(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r,1];case"translate3d":return e=si(n.d[0],0,null)||0,t=si(n.d[1],0,null)||0,r=si(n.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,r,1];case"perspective":var f=si(n.d[0],0,null)||0,d=f?-1/f:0;return[1,0,0,0,0,1,0,0,0,0,1,d,0,0,0,1];case"matrix":return[n.d[0].value,n.d[1].value,0,0,n.d[2].value,n.d[3].value,0,0,0,0,1,0,n.d[4].value,n.d[5].value,0,1];case"matrix3d":return n.d.map(function(p){return p.value})}}function Ik(n,e){return[n[0]*e[0]+n[4]*e[1]+n[8]*e[2]+n[12]*e[3],n[1]*e[0]+n[5]*e[1]+n[9]*e[2]+n[13]*e[3],n[2]*e[0]+n[6]*e[1]+n[10]*e[2]+n[14]*e[3],n[3]*e[0]+n[7]*e[1]+n[11]*e[2]+n[15]*e[3],n[0]*e[4]+n[4]*e[5]+n[8]*e[6]+n[12]*e[7],n[1]*e[4]+n[5]*e[5]+n[9]*e[6]+n[13]*e[7],n[2]*e[4]+n[6]*e[5]+n[10]*e[6]+n[14]*e[7],n[3]*e[4]+n[7]*e[5]+n[11]*e[6]+n[15]*e[7],n[0]*e[8]+n[4]*e[9]+n[8]*e[10]+n[12]*e[11],n[1]*e[8]+n[5]*e[9]+n[9]*e[10]+n[13]*e[11],n[2]*e[8]+n[6]*e[9]+n[10]*e[10]+n[14]*e[11],n[3]*e[8]+n[7]*e[9]+n[11]*e[10]+n[15]*e[11],n[0]*e[12]+n[4]*e[13]+n[8]*e[14]+n[12]*e[15],n[1]*e[12]+n[5]*e[13]+n[9]*e[14]+n[13]*e[15],n[2]*e[12]+n[6]*e[13]+n[10]*e[14]+n[14]*e[15],n[3]*e[12]+n[7]*e[13]+n[11]*e[14]+n[15]*e[15]]}function Dk(n){return n.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:n.map(Lk).reduce(Ik)}function qx(n){var e=[0,0,0],t=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return IR(Dk(n),e,t,r,i,a),[[e,t,r,a,i]]}var Bk=function(){function n(r,i){for(var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],o=0;o<4;o++)for(var s=0;s<4;s++)for(var l=0;l<4;l++)a[o][s]+=i[o][l]*r[l][s];return a}function e(r){return r[0][2]==0&&r[0][3]==0&&r[1][2]==0&&r[1][3]==0&&r[2][0]==0&&r[2][1]==0&&r[2][2]==1&&r[2][3]==0&&r[3][2]==0&&r[3][3]==1}function t(r,i,a,o,s){for(var l=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],c=0;c<4;c++)l[c][3]=s[c];for(var c=0;c<3;c++)for(var u=0;u<3;u++)l[3][c]+=r[u]*l[u][c];var h=o[0],f=o[1],d=o[2],p=o[3],v=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];v[0][0]=1-2*(f*f+d*d),v[0][1]=2*(h*f-d*p),v[0][2]=2*(h*d+f*p),v[1][0]=2*(h*f+d*p),v[1][1]=1-2*(h*h+d*d),v[1][2]=2*(f*d-h*p),v[2][0]=2*(h*d-f*p),v[2][1]=2*(f*d+h*p),v[2][2]=1-2*(h*h+f*f),l=n(l,v);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[2]&&(g[2][1]=a[2],l=n(l,g)),a[1]&&(g[2][1]=0,g[2][0]=a[0],l=n(l,g)),a[0]&&(g[2][0]=0,g[1][0]=a[0],l=n(l,g));for(var c=0;c<3;c++)for(var u=0;u<3;u++)l[c][u]*=i[c];return e(l)?[l[0][0],l[0][1],l[1][0],l[1][1],l[3][0],l[3][1]]:l[0].concat(l[1],l[2],l[3])}return t}();function Fk(n){return n.toFixed(6).replace(".000000","")}function mv(n,e){var t,r;return n.decompositionPair!==e&&(n.decompositionPair=e,t=qx(n)),e.decompositionPair!==n&&(e.decompositionPair=n,r=qx(e)),t[0]===null||r[0]===null?[[!1],[!0],function(i){return i?e[0].d:n[0].d}]:(t[0].push(0),r[0].push(1),[t,r,function(i){var a=zk(t[0][3],r[0][3],i[5]),o=Bk(i[0],i[1],i[2],a,i[4]),s=o.map(Fk).join(",");return s}])}function Gk(n,e){for(var t=0,r=0;r<n.length;r++)t+=n[r]*e[r];return t}function zk(n,e,t){var r=Gk(n,e);r=he(r,-1,1);var i=[];if(r===1)i=n;else for(var a=Math.acos(r),o=Math.sin(t*a)*1/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(n[s]*(Math.cos(t*a)-r*o)+e[s]*o);return i}function yv(n){return n.replace(/[xy]/,"")}function xv(n){return n.replace(/(x|y|z|3d)?$/,"3d")}var Wk=function(n,e){return n==="perspective"&&e==="perspective"||(n==="matrix"||n==="matrix3d")&&(e==="matrix"||e==="matrix3d")};function Uk(n,e,t){var r=!1;if(!n.length||!e.length){n.length||(r=!0,n=e,e=[]);for(var i=function(y){var E=n[y],w=E.t,C=E.d,M=w.substring(0,5)==="scale"?1:0;e.push({t:w,d:C.map(function(O){return typeof O=="number"?ze(M):ze(M,O.unit)})})},a=0;a<n.length;a++)i(a)}var o=[],s=[],l=[];if(n.length!==e.length){var c=mv(n,e);o=[c[0]],s=[c[1]],l=[["matrix",[c[2]]]]}else for(var a=0;a<n.length;a++){var u=n[a].t,h=e[a].t,f=n[a].d,d=e[a].d,p=Oh[u],v=Oh[h],g=void 0;if(Wk(u,h)){var c=mv([n[a]],[e[a]]);o.push(c[0]),s.push(c[1]),l.push(["matrix",[c[2]]]);continue}else if(u===h)g=u;else if(p[2]&&v[2]&&yv(u)===yv(h))g=yv(u),f=p[2](f),d=v[2](d);else if(p[1]&&v[1]&&xv(u)===xv(h))g=xv(u),f=p[1](f),d=v[1](d);else{var c=mv(n,e);o=[c[0]],s=[c[1]],l=[["matrix",[c[2]]]];break}for(var m=[],x=[],S=[],T=0;T<f.length;T++){var c=mk(f[T],d[T],t,!1,T);m[T]=c[0],x[T]=c[1],S.push(c[2])}o.push(m),s.push(x),l.push([g,S])}if(r){var b=o;o=s,s=b}return[o,s,function(y){return y.map(function(E,w){var C=E.map(function(M,O){return l[w][1][O](M)}).join(",");return l[w][0]==="matrix"&&C.split(",").length===16&&(l[w][0]="matrix3d"),l[w][0]==="matrix3d"&&C.split(",").length===6&&(l[w][0]="matrix"),l[w][0]+"("+C+")"}).join(" ")}]}var Jx=Yn(function(n){if(qt(n)){if(n==="text-anchor")return[ze(0,"px"),ze(0,"px")];var e=n.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[$s(Ah(e[0])),$s(Ah(e[1]))]}else return[ze(n[0]||0,"px"),ze(n[1]||0,"px")]}),Vk=function(n){if(qt(n)){if(n==="text-anchor")return[ze(0,"px"),ze(0,"px")];var e=n.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[rc(Ah(e[0])),rc(Ah(e[1]))]}else return[ze(n[0]||0,"px"),ze(n[1]||0,"px")]};function Ah(n){return n==="center"?"50%":n==="left"||n==="top"?"0%":n==="right"||n==="bottom"?"100%":n}var bv=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:_t.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:_t.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:_t.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:_t.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:_t.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:_t.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:_t.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:_t.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:_t.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:_t.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:_t.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:_t.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:_t.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:_t.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:_t.FILTER},{n:"clipPath",syntax:_t.DEFINED_PATH},{n:"textPath",syntax:_t.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:_t.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:_t.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:_t.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:_t.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:_t.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:_t.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:_t.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:_t.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:_t.COORDINATE},{n:"y1",int:!0,l:!0,syntax:_t.COORDINATE},{n:"z1",int:!0,l:!0,syntax:_t.COORDINATE},{n:"x2",int:!0,l:!0,syntax:_t.COORDINATE},{n:"y2",int:!0,l:!0,syntax:_t.COORDINATE},{n:"z2",int:!0,l:!0,syntax:_t.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:_t.PATH,p:50},{n:"points",int:!0,l:!0,syntax:_t.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:_t.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:_t.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:_t.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:_t.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:_t.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:_t.NUMBER,d:function(n){return n===Rt.PATH||n===Rt.POLYGON||n===Rt.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:_t.MARKER},{n:"markerEnd",syntax:_t.MARKER},{n:"markerMid",syntax:_t.MARKER},{n:"markerStartOffset",syntax:_t.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:_t.LENGTH,l:!0,int:!0,d:"0"}],Qx=bv.filter(function(n){return!!n.l}).map(function(n){return n.n}),ao={},Zs=new WeakMap,Hk=function(n,e){var t=Zs.get(n);return!t||t.length===0?!0:t.includes(e)},Yk=function(){function n(e){var t=this;this.runtime=e,bv.forEach(function(r){t.registerMetadata(r)})}return n.prototype.registerMetadata=function(e){K([e.n],P(e.a||[]),!1).forEach(function(t){ao[t]=e})},n.prototype.unregisterMetadata=function(e){delete ao[e]},n.prototype.getPropertySyntax=function(e){return this.runtime.CSSPropertySyntaxFactory[e]},n.prototype.processProperties=function(e,t,r){var i=this;if(r===void 0&&(r={skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0}),this.runtime.enableCSSParsing){var u=r.skipUpdateAttribute,h=r.skipParse,f=r.forceUpdateGeometry,d=r.usedAttributes,p=r.memoize,v=f,g=Object.keys(t);g.forEach(function(m){var x;u||(e.attributes[m]=t[m]),!v&&(!((x=ao[m])===null||x===void 0)&&x.l)&&(v=!0)}),h||g.forEach(function(m){e.computedStyle[m]=i.parseProperty(m,e.attributes[m],e,p)}),d!=null&&d.length&&(g=Array.from(new Set(g.concat(d)))),g.forEach(function(m){m in e.computedStyle&&(e.parsedStyle[m]=i.computeProperty(m,e.computedStyle[m],e,p))}),v&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e)),g.forEach(function(m){m in e.parsedStyle&&i.postProcessProperty(m,e,g)}),this.runtime.enableCSSParsing&&e.children.length&&g.forEach(function(m){m in e.parsedStyle&&i.isPropertyInheritable(m)&&e.children.forEach(function(x){x.internalSetAttribute(m,null,{skipUpdateAttribute:!0,skipParse:!0})})})}else{Object.assign(e.attributes,t);var a=Object.keys(t),o=e.parsedStyle.clipPath,s=e.parsedStyle.offsetPath;e.parsedStyle=Object.assign(e.parsedStyle,t);var l=!!r.forceUpdateGeometry;if(!l){for(var c=0;c<Qx.length;c++)if(Qx[c]in t){l=!0;break}}t.fill&&(e.parsedStyle.fill=js(t.fill)),t.stroke&&(e.parsedStyle.stroke=js(t.stroke)),t.shadowColor&&(e.parsedStyle.shadowColor=js(t.shadowColor)),t.filter&&(e.parsedStyle.filter=Bx(t.filter)),pt(t.radius)||(e.parsedStyle.radius=Ix(t.radius,4)),pt(t.lineDash)||(e.parsedStyle.lineDash=Ix(t.lineDash,2)),t.points&&(e.parsedStyle.points=$x(t.points)),t.d===""&&(e.parsedStyle.d=N({},Ax)),t.d&&(e.parsedStyle.d=gv(t.d)),t.textTransform&&this.runtime.CSSPropertySyntaxFactory["<text-transform>"].calculator(null,null,{value:t.textTransform},e,null),yt(t.clipPath)||this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("clipPath",o,t.clipPath,e,this.runtime),t.offsetPath&&this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("offsetPath",s,t.offsetPath,e,this.runtime),t.transform&&(e.parsedStyle.transform=Kx(t.transform)),t.transformOrigin&&(e.parsedStyle.transformOrigin=Jx(t.transformOrigin)),t.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,t.markerStart,t.markerStart,null,null)),t.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,t.markerEnd,t.markerEnd,null,null)),t.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator("",t.markerMid,t.markerMid,null,null)),pt(t.zIndex)||this.runtime.CSSPropertySyntaxFactory["<z-index>"].postProcessor(e,a),pt(t.offsetDistance)||this.runtime.CSSPropertySyntaxFactory["<offset-distance>"].postProcessor(e,a),t.transform&&this.runtime.CSSPropertySyntaxFactory["<transform>"].postProcessor(e,a),t.transformOrigin&&this.runtime.CSSPropertySyntaxFactory["<transform-origin>"].postProcessor(e,a),l&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e))}},n.prototype.parseProperty=function(e,t,r,i){var a=ao[e],o=t;if((t===""||pt(t))&&(t="unset"),t==="unset"||t==="initial"||t==="inherit")o=uv(t);else if(a){var s=a.k,l=a.syntax,c=l&&this.getPropertySyntax(l);s&&s.indexOf(t)>-1?o=uv(t):c&&(!i&&c.parserUnmemoize?o=c.parserUnmemoize(t,r):c.parser&&(o=c.parser(t,r)))}return o},n.prototype.computeProperty=function(e,t,r,i){var a=ao[e],o=r.id==="g-root",s=t;if(a){var l=a.syntax,c=a.inh,u=a.d;if(t instanceof Fr){var h=t.value;if(h==="unset"&&(c&&!o?h="inherit":h="initial"),h==="initial")pt(u)||(t=this.parseProperty(e,Ys(u)?u(r.nodeName):u,r,i));else if(h==="inherit"){var f=this.tryToResolveProperty(r,e,{inherited:!0});if(pt(f)){this.addUnresolveProperty(r,e);return}else return f}}var d=l&&this.getPropertySyntax(l);if(d&&d.calculator){var p=r.parsedStyle[e];s=d.calculator(e,p,t,r,this.runtime)}else t instanceof Fr?s=t.value:s=t}return s},n.prototype.postProcessProperty=function(e,t,r){var i=ao[e];if(i&&i.syntax){var a=i.syntax&&this.getPropertySyntax(i.syntax),o=a;o&&o.postProcessor&&o.postProcessor(t,r)}},n.prototype.addUnresolveProperty=function(e,t){var r=Zs.get(e);r||(Zs.set(e,[]),r=Zs.get(e)),r.indexOf(t)===-1&&r.push(t)},n.prototype.tryToResolveProperty=function(e,t,r){r===void 0&&(r={});var i=r.inherited;if(i&&e.parentElement&&Hk(e.parentElement,t)){var a=e.parentElement.parsedStyle[t];return a==="unset"||a==="initial"||a==="inherit"?void 0:a}},n.prototype.recalc=function(e){var t=Zs.get(e);if(t&&t.length){var r={};t.forEach(function(i){r[i]=e.attributes[i]}),this.processProperties(e,r),Zs.delete(e)}},n.prototype.updateGeometry=function(e){var t=e.nodeName,r=this.runtime.geometryUpdaterFactory[t];if(r){var i=e.geometry;i.contentBounds||(i.contentBounds=new ir),i.renderBounds||(i.renderBounds=new ir);var a=e.parsedStyle,o=r.update(a,e),s=o.cx,l=s===void 0?0:s,c=o.cy,u=c===void 0?0:c,h=o.cz,f=h===void 0?0:h,d=o.hwidth,p=d===void 0?0:d,v=o.hheight,g=v===void 0?0:v,m=o.hdepth,x=m===void 0?0:m,S=[Math.abs(p),Math.abs(g),x],T=a,b=T.stroke,y=T.lineWidth,E=y===void 0?1:y,w=T.increasedLineWidthForHitTesting,C=w===void 0?0:w,M=T.shadowType,O=M===void 0?"outer":M,A=T.shadowColor,R=T.filter,L=R===void 0?[]:R,z=T.transformOrigin,Y=[l,u,f];i.contentBounds.update(Y,S);var I=t===Rt.POLYLINE||t===Rt.POLYGON||t===Rt.PATH?Math.SQRT2:.5,q=b&&!b.isNone;if(q){var J=((E||0)+(C||0))*I;S[0]+=J,S[1]+=J}if(i.renderBounds.update(Y,S),A&&O&&O!=="inner"){var wt=i.renderBounds,Ft=wt.min,fe=wt.max,xe=a,Sr=xe.shadowBlur,jr=xe.shadowOffsetX,zn=xe.shadowOffsetY,rn=Sr||0,On=jr||0,di=zn||0,cr=Ft[0]-rn+On,$r=fe[0]+rn+On,xo=Ft[1]-rn+di,Pc=fe[1]+rn+di;Ft[0]=Math.min(Ft[0],cr),fe[0]=Math.max(fe[0],$r),Ft[1]=Math.min(Ft[1],xo),fe[1]=Math.max(fe[1],Pc),i.renderBounds.setMinMax(Ft,fe)}L.forEach(function(wo){var So=wo.name,Kr=wo.params;if(So==="blur"){var _o=Kr[0].value;i.renderBounds.update(i.renderBounds.center,wh(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[_o,_o,0]))}else if(So==="drop-shadow"){var To=Kr[0].value,Po=Kr[1].value,Zr=Kr[2].value,Mo=i.renderBounds,pn=Mo.min,vn=Mo.max,Oc=pn[0]-Zr+To,Ac=vn[0]+Zr+To,Nc=pn[1]-Zr+Po,Rc=vn[1]+Zr+Po;pn[0]=Math.min(pn[0],Oc),vn[0]=Math.max(vn[0],Ac),pn[1]=Math.min(pn[1],Nc),vn[1]=Math.max(vn[1],Rc),i.renderBounds.setMinMax(pn,vn)}}),e.geometry.dirty=!1;var Mc=p<0,Cc=g<0,bo=(Mc?-1:1)*(z?si(z[0],0,e,!0):0),Eo=(Cc?-1:1)*(z?si(z[1],1,e,!0):0);(bo||Eo)&&e.setOrigin(bo,Eo)}},n.prototype.updateSizeAttenuation=function(e,t){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/t,e.nodeName===Rt.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/t)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===Rt.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR))},n.prototype.isPropertyInheritable=function(e){var t=ao[e];return t?t.inh:!1},n}(),Xk=function(){function n(){this.parser=Lx,this.parserUnmemoize=fv,this.parserWithCSSDisabled=null,this.mixer=dv}return n.prototype.calculator=function(e,t,r,i){return Gr(r)},n}(),jk=function(){function n(){}return n.prototype.calculator=function(e,t,r,i,a){return r instanceof Fr&&(r=null),a.sceneGraphService.updateDisplayObjectDependency(e,t,r,i),e==="clipPath"&&i.forEach(function(o){o.childNodes.length===0&&a.sceneGraphService.dirtifyToRoot(o)}),r},n}(),$k=function(){function n(){this.parser=js,this.parserWithCSSDisabled=js,this.mixer=pk}return n.prototype.calculator=function(e,t,r,i){return r instanceof Fr?r.value==="none"?Th:Ox:r},n}(),Kk=function(){function n(){this.parser=Bx}return n.prototype.calculator=function(e,t,r){return r instanceof Fr?[]:r},n}();function tb(n){var e=n.parsedStyle.fontSize;return pt(e)?null:e}var Ev=function(){function n(){this.parser=$s,this.parserUnmemoize=rc,this.parserWithCSSDisabled=null,this.mixer=dv}return n.prototype.calculator=function(e,t,r,i,a){var o;if(te(r))return r;if(Ie.isRelativeUnit(r.unit)){var s=a.styleValueRegistry;if(r.unit===bt.kPercentage)return 0;if(r.unit===bt.kEms){if(i.parentNode){var l=tb(i.parentNode);if(l)return l*=r.value,l;s.addUnresolveProperty(i,e)}else s.addUnresolveProperty(i,e);return 0}else if(r.unit===bt.kRems){if(!((o=i==null?void 0:i.ownerDocument)===null||o===void 0)&&o.documentElement){var l=tb(i.ownerDocument.documentElement);if(l)return l*=r.value,l;s.addUnresolveProperty(i,e)}else s.addUnresolveProperty(i,e);return 0}}else return r.value},n}(),Zk=function(){function n(){this.mixer=Gx}return n.prototype.parser=function(e){var t=Dx(te(e)?[e]:e),r;return t.length===1?r=[t[0],t[0]]:r=[t[0],t[1]],r},n.prototype.calculator=function(e,t,r){return r.map(function(i){return i.value})},n}(),qk=function(){function n(){this.mixer=Gx}return n.prototype.parser=function(e){var t=Dx(te(e)?[e]:e),r;return t.length===1?r=[t[0],t[0],t[0],t[0]]:t.length===2?r=[t[0],t[1],t[0],t[1]]:t.length===3?r=[t[0],t[1],t[2],t[1]]:r=[t[0],t[1],t[2],t[3]],r},n.prototype.calculator=function(e,t,r){return r.map(function(i){return i.value})},n}(),Jk=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){r instanceof Fr&&(r=null);var a=r==null?void 0:r.cloneNode(!0);return a&&(a.style.isMarker=!0),a},n}(),Qk=function(){function n(){this.mixer=dv,this.parser=Xo,this.parserUnmemoize=Ks,this.parserWithCSSDisabled=null}return n.prototype.calculator=function(e,t,r){return r.value},n}(),t3=function(){function n(){this.parser=Xo,this.parserUnmemoize=Ks,this.parserWithCSSDisabled=null,this.mixer=pv(0,1)}return n.prototype.calculator=function(e,t,r){return r.value},n.prototype.postProcessor=function(e){var t=e.parsedStyle,r=t.offsetPath,i=t.offsetDistance;if(r){var a=r.nodeName;if(a===Rt.LINE||a===Rt.PATH||a===Rt.POLYLINE){var o=r.getPoint(i);o&&e.setLocalPosition(o.x,o.y)}}},n}(),e3=function(){function n(){this.parser=Xo,this.parserUnmemoize=Ks,this.parserWithCSSDisabled=null,this.mixer=pv(0,1)}return n.prototype.calculator=function(e,t,r){return r.value},n}(),n3=function(){function n(){this.parser=gv,this.parserWithCSSDisabled=gv,this.mixer=Rk}return n.prototype.calculator=function(e,t,r){return r instanceof Fr&&r.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Yo(0,0,0,0)}:r},n}(),r3=function(){function n(){this.parser=$x,this.mixer=kk}return n}(),i3=function(n){B(e,n);function e(){var t=n.apply(this,K([],P(arguments),!1))||this;return t.mixer=pv(0,1/0),t}return e}(Ev),a3=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){return r instanceof Fr?r.value==="unset"?"":r.value:"".concat(r)},n.prototype.postProcessor=function(e){e.nodeValue="".concat(e.parsedStyle.text)||""},n}(),o3=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){var a=i.getAttribute("text");if(a){var o=a;r.value==="capitalize"?o=a.charAt(0).toUpperCase()+a.slice(1):r.value==="lowercase"?o=a.toLowerCase():r.value==="uppercase"&&(o=a.toUpperCase()),i.parsedStyle.text=o}return r.value},n}(),wv={},s3=0;function l3(n,e){if(n){var t=typeof n=="string"?n:n.id||s3++;wv[t]&&wv[t].destroy(),wv[t]=e}}var Sv=typeof window!="undefined"&&typeof window.document!="undefined";function c3(n){return!!n.getAttribute}function u3(n,e){for(var t=0,r=n.length;t<r;){var i=t+r>>>1;eb(n[i],e)<0?t=i+1:r=i}return t}function eb(n,e){var t=Number(n.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(t===r){var i=n.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(n)-a.indexOf(e)}}return t-r}function h3(n){var e,t=n;do{var r=(e=t.parsedStyle)===null||e===void 0?void 0:e.clipPath;if(r)return t;t=t.parentElement}while(t!==null);return null}var nb="px";function gW(n,e,t){Sv&&n.style&&(n.style.width=e+nb,n.style.height=t+nb)}function rb(n,e){if(Sv)return document.defaultView.getComputedStyle(n,null).getPropertyValue(e)}function f3(n){var e=rb(n,"width");return e==="auto"?n.offsetWidth:parseFloat(e)}function d3(n){var e=rb(n,"height");return e==="auto"?n.offsetHeight:parseFloat(e)}var p3=1,v3={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},_v=typeof performance=="object"&&performance.now?performance:Date;function mW(n,e,t){n===void 0&&(n="auto");var r=!1,i=!1,a=!!e&&!e.isNone,o=!!t&&!t.isNone;return n==="visiblepainted"||n==="painted"||n==="auto"?(r=a,i=o):n==="visiblefill"||n==="fill"?r=!0:n==="visiblestroke"||n==="stroke"?i=!0:(n==="visible"||n==="all")&&(r=!0,i=!0),[r,i]}var g3=1,m3=function(){return g3++},oa=typeof self=="object"&&self.self==self?self:typeof D.g=="object"&&D.g.global==D.g?D.g:{},y3=Date.now(),x3=function(){return oa.performance&&typeof oa.performance.now=="function"?oa.performance.now():Date.now()-y3},ic={},ib=Date.now(),b3=function(n){if(typeof n!="function")throw new TypeError(n+" is not a function");var e=Date.now(),t=e-ib,r=t>16?0:16-t,i=m3();return ic[i]=n,Object.keys(ic).length>1||setTimeout(function(){ib=e;var a=ic;ic={},Object.keys(a).forEach(function(o){return a[o](x3())})},r),i},E3=function(n){delete ic[n]},w3=["","webkit","moz","ms","o"],ab=function(n){return typeof n!="string"?b3:n===""?oa.requestAnimationFrame:oa[n+"RequestAnimationFrame"]},S3=function(n){return typeof n!="string"?E3:n===""?oa.cancelAnimationFrame:oa[n+"CancelAnimationFrame"]||oa[n+"CancelRequestAnimationFrame"]},_3=function(n,e){for(var t=0;n[t]!==void 0;){if(e(n[t]))return n[t];t=t+1}},ob=_3(w3,function(n){return!!ab(n)}),Tv=ab(ob),sb=S3(ob);oa.requestAnimationFrame=Tv,oa.cancelAnimationFrame=sb;var T3=function(){function n(){this.callbacks=[]}return n.prototype.getCallbacksNum=function(){return this.callbacks.length},n.prototype.tapPromise=function(e,t){this.callbacks.push(t)},n.prototype.promise=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Promise.all(this.callbacks.map(function(r){return r.apply(void 0,K([],P(e),!1))}))},n}(),P3=function(){function n(){this.callbacks=[]}return n.prototype.tapPromise=function(e,t){this.callbacks.push(t)},n.prototype.promise=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return j(this,void 0,void 0,function(){var r,i,a,o;return mt(this,function(s){switch(s.label){case 0:return this.callbacks.length?[4,(o=this.callbacks)[0].apply(o,K([],P(e),!1))]:[3,6];case 1:r=s.sent(),i=0,s.label=2;case 2:return i<this.callbacks.length-1?(a=this.callbacks[i],[4,a(r)]):[3,5];case 3:r=s.sent(),s.label=4;case 4:return i++,[3,2];case 5:return[2,r];case 6:return[2,null]}})})},n}(),xr=function(){function n(){this.callbacks=[]}return n.prototype.tap=function(e,t){this.callbacks.push(t)},n.prototype.call=function(){var e=arguments;this.callbacks.forEach(function(t){t.apply(void 0,e)})},n}(),Pv=function(){function n(){this.callbacks=[]}return n.prototype.tap=function(e,t){this.callbacks.push(t)},n.prototype.call=function(){if(this.callbacks.length){for(var e=arguments,t=this.callbacks[0].apply(void 0,e),r=0;r<this.callbacks.length-1;r++){var i=this.callbacks[r];t=i(t)}return t}return null},n}(),M3=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],C3=/([\"\'])[^\'\"]+\1/;function O3(n){for(var e=n.fontSize,t=e===void 0?16:e,r=n.fontFamily,i=r===void 0?"sans-serif":r,a=n.fontStyle,o=a===void 0?"normal":a,s=n.fontVariant,l=s===void 0?"normal":s,c=n.fontWeight,u=c===void 0?"normal":c,h=te(t)&&"".concat(t,"px")||"16px",f=i.split(","),d=f.length-1;d>=0;d--){var p=f[d].trim();!C3.test(p)&&M3.indexOf(p)<0&&(p='"'.concat(p,'"')),f[d]=p}return"".concat(o," ").concat(l," ").concat(u," ").concat(h," ").concat(f.join(","))}function Mv(n,e,t){return Xt(n),n[4]=Math.tan(e),n[1]=Math.tan(t),n}var ac=1e-5,A3=Q(),Pn=Q();function N3(n,e){if(n.length){var t=Xt(A3);n.forEach(function(r){var i=r.t,a=r.d;if(i==="scale"){var o=(a==null?void 0:a.map(function(m){return Math.max(m.value,ac)}))||[1,1];Oe(Pn,[o[0],o[1],1])}else if(i==="scalex"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,ac)}))||[1];Oe(Pn,[o[0],1,1])}else if(i==="scaley"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,ac)}))||[1];Oe(Pn,[1,o[0],1])}else if(i==="scalez"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,ac)}))||[1];Oe(Pn,[1,1,o[0]])}else if(i==="scale3d"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,ac)}))||[1,1,1];Oe(Pn,[o[0],o[1],o[2]])}else if(i==="translate"){var s=a||[xn,xn];ue(Pn,[s[0].value,s[1].value,0])}else if(i==="translatex"){var s=a||[xn];ue(Pn,[s[0].value,0,0])}else if(i==="translatey"){var s=a||[xn];ue(Pn,[0,s[0].value,0])}else if(i==="translatez"){var s=a||[xn];ue(Pn,[0,0,s[0].value])}else if(i==="translate3d"){var s=a||[xn,xn,xn];ue(Pn,[s[0].value,s[1].value,s[2].value])}else if(i==="rotate"){var l=a||[Ai];qr(Pn,ke(Gr(l[0])))}else if(i==="rotatex"){var l=a||[Ai];ie(Pn,ke(Gr(l[0])))}else if(i==="rotatey"){var l=a||[Ai];Xe(Pn,ke(Gr(l[0])))}else if(i==="rotatez"){var l=a||[Ai];qr(Pn,ke(Gr(l[0])))}else if(i==="rotate3d"){var l=a||[xn,xn,xn,Ai];Tr(Pn,ke(Gr(l[3])),[l[0].value,l[1].value,l[2].value])}else if(i==="skew"){var c=(a==null?void 0:a.map(function(m){return m.value}))||[0,0];Mv(Pn,ke(c[0]),ke(c[1]))}else if(i==="skewx"){var c=(a==null?void 0:a.map(function(x){return x.value}))||[0];Mv(Pn,ke(c[0]),0)}else if(i==="skewy"){var c=(a==null?void 0:a.map(function(x){return x.value}))||[0];Mv(Pn,0,ke(c[0]))}else if(i==="matrix"){var u=P(a.map(function(m){return m.value}),6),h=u[0],f=u[1],d=u[2],p=u[3],v=u[4],g=u[5];re(Pn,h,f,0,0,d,p,0,0,0,0,1,0,v,g,0,1)}else i==="matrix3d"&&re.apply(G,K([Pn],P(a.map(function(m){return m.value})),!1));Gc(t,t,Pn)}),e.setLocalTransform(t)}else e.resetLocalTransform();return e.getLocalTransform()}var R3=function(){function n(){this.parser=Kx,this.parserUnmemoize=Zx,this.parserWithCSSDisabled=Zx,this.mixer=Uk}return n.prototype.calculator=function(e,t,r,i){return r instanceof Fr?[]:r},n.prototype.postProcessor=function(e){var t=e.parsedStyle.transform;N3(t,e)},n}(),k3=function(){function n(){this.parser=Jx,this.parserUnmemoize=Vk}return n.prototype.postProcessor=function(e){var t=e.parsedStyle.transformOrigin;t[0].unit===bt.kPixels&&t[1].unit===bt.kPixels?e.setOrigin(t[0].value,t[1].value):e.getGeometryBounds()},n}(),L3=function(){function n(){this.parser=Xo,this.parserUnmemoize=Ks}return n.prototype.calculator=function(e,t,r,i){return r.value},n.prototype.postProcessor=function(e){if(e.parentNode){var t=e.parentNode,r=t.renderable,i=t.sortable;r&&(r.dirty=!0),i&&(i.dirty=!0,i.dirtyReason=Xs.Z_INDEX_CHANGED)}},n}(),I3=function(){function n(){}return n.prototype.update=function(e,t){var r=e.cx,i=r===void 0?0:r,a=e.cy,o=a===void 0?0:a,s=e.r,l=s===void 0?0:s;return{cx:i,cy:o,hwidth:l,hheight:l}},n}(),D3=function(){function n(){}return n.prototype.update=function(e,t){var r=e.cx,i=r===void 0?0:r,a=e.cy,o=a===void 0?0:a,s=e.rx,l=s===void 0?0:s,c=e.ry,u=c===void 0?0:c;return{cx:i,cy:o,hwidth:l,hheight:u}},n}(),B3=function(){function n(){}return n.prototype.update=function(e){var t=e.x1,r=e.y1,i=e.x2,a=e.y2,o=Math.min(t,i),s=Math.max(t,i),l=Math.min(r,a),c=Math.max(r,a),u=s-o,h=c-l,f=u/2,d=h/2;return{cx:o+f,cy:l+d,hwidth:f,hheight:d}},n}(),F3=function(){function n(){}return n.prototype.update=function(e){var t=e.d,r=t.rect,i=r.x,a=r.y,o=r.width,s=r.height,l=o/2,c=s/2;return{cx:i+l,cy:a+c,hwidth:l,hheight:c}},n}(),G3=function(){function n(){}return n.prototype.update=function(e){if(e.points&&tr(e.points.points)){var t=e.points.points,r=Math.min.apply(Math,K([],P(t.map(function(h){return h[0]})),!1)),i=Math.max.apply(Math,K([],P(t.map(function(h){return h[0]})),!1)),a=Math.min.apply(Math,K([],P(t.map(function(h){return h[1]})),!1)),o=Math.max.apply(Math,K([],P(t.map(function(h){return h[1]})),!1)),s=i-r,l=o-a,c=s/2,u=l/2;return{cx:r+c,cy:a+u,hwidth:c,hheight:u}}return{cx:0,cy:0,hwidth:0,hheight:0}},n}(),z3=function(){function n(){}return n.prototype.update=function(e,t){var r=e.x,i=r===void 0?0:r,a=e.y,o=a===void 0?0:a,s=e.src,l=e.width,c=l===void 0?0:l,u=e.height,h=u===void 0?0:u,f=c,d=h;return s&&!qt(s)&&(f||(f=s.width,e.width=f),d||(d=s.height,e.height=d)),{cx:i+f/2,cy:o+d/2,hwidth:f/2,hheight:d/2}},n}(),W3=function(){function n(e){this.globalRuntime=e}return n.prototype.isReadyToMeasure=function(e,t){var r=e.text,i=e.textAlign,a=e.textBaseline,o=e.fontSize,s=e.fontStyle,l=e.fontWeight,c=e.fontVariant,u=e.lineWidth;return rt.enableCSSParsing?r&&o&&s&&l&&c&&i&&a&&!pt(u):r},n.prototype.update=function(e,t){var r,i,a=e.text,o=e.textAlign,s=o===void 0?"start":o,l=e.lineWidth,c=l===void 0?1:l,u=e.textBaseline,h=u===void 0?"alphabetic":u,f=e.dx,d=f===void 0?0:f,p=e.dy,v=p===void 0?0:p,g=e.x,m=g===void 0?0:g,x=e.y,S=x===void 0?0:x;if(!this.isReadyToMeasure(e,t))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var T=(((i=(r=t==null?void 0:t.ownerDocument)===null||r===void 0?void 0:r.defaultView)===null||i===void 0?void 0:i.getConfig())||{}).offscreenCanvas,b=this.globalRuntime.textService.measureText(a,e,T);e.metrics=b;var y=b.width,E=b.height,w=b.lineHeight,C=b.fontProperties,M=y/2,O=E/2,A=m+M;s==="center"||s==="middle"?A+=c/2-M:(s==="right"||s==="end")&&(A+=c-M*2);var R=S-O;return h==="middle"?R+=O:h==="top"||h==="hanging"?R+=O*2:h==="alphabetic"?R+=this.globalRuntime.enableCSSParsing?w-C.ascent:0:(h==="bottom"||h==="ideographic")&&(R+=0),d&&(A+=d),v&&(R+=v),{cx:A,cy:R,hwidth:M,hheight:O}},n}(),U3=function(){function n(){}return n.prototype.update=function(e,t){return{cx:0,cy:0,hwidth:0,hheight:0}},n}();function V3(n){return!!n.type}var Nh=function(){function n(e){this.eventPhase=n.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ar,this.page=new ar,this.canvas=new ar,this.viewport=new ar,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}return Object.defineProperty(n.prototype,"name",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layerX",{get:function(){return this.layer.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layerY",{get:function(){return this.layer.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageX",{get:function(){return this.page.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageY",{get:function(){return this.page.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"x",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasX",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasY",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewportX",{get:function(){return this.viewport.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewportY",{get:function(){return this.viewport.y},enumerable:!1,configurable:!0}),n.prototype.composedPath=function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},Object.defineProperty(n.prototype,"propagationPath",{get:function(){return this.composedPath()},enumerable:!1,configurable:!0}),n.prototype.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},n.prototype.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},n.prototype.stopPropagation=function(){this.propagationStopped=!0},n.prototype.initEvent=function(){},n.prototype.initUIEvent=function(){},n.prototype.clone=function(){throw new Error(Le)},n}(),lb=function(n){B(e,n);function e(){var t=n.apply(this,K([],P(arguments),!1))||this;return t.client=new ar,t.movement=new ar,t.offset=new ar,t.global=new ar,t.screen=new ar,t}return Object.defineProperty(e.prototype,"clientX",{get:function(){return this.client.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientY",{get:function(){return this.client.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementX",{get:function(){return this.movement.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementY",{get:function(){return this.movement.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetX",{get:function(){return this.offset.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetY",{get:function(){return this.offset.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalX",{get:function(){return this.global.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalY",{get:function(){return this.global.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenX",{get:function(){return this.screen.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenY",{get:function(){return this.screen.y},enumerable:!1,configurable:!0}),e.prototype.getModifierState=function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)},e.prototype.initMouseEvent=function(){throw new Error(Le)},e}(Nh),Cv=function(n){B(e,n);function e(){var t=n.apply(this,K([],P(arguments),!1))||this;return t.width=0,t.height=0,t.isPrimary=!1,t}return e.prototype.getCoalescedEvents=function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]},e.prototype.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},e.prototype.clone=function(){return this.manager.clonePointerEvent(this)},e}(lb),Ov=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.clone=function(){return this.manager.cloneWheelEvent(this)},e}(lb),Ln=function(n){B(e,n);function e(t,r){var i=n.call(this,null)||this;return i.type=t,i.detail=r,Object.assign(i,r),i}return e}(Nh),cb=":",ub=function(){function n(){this.emitter=new et}return n.prototype.on=function(e,t,r){return this.addEventListener(e,t,r),this},n.prototype.addEventListener=function(e,t,r){var i=za(r)&&r||Ye(r)&&r.capture,a=Ye(r)&&r.once,o=Ys(t)?void 0:t,s=!1,l="";if(e.indexOf(cb)>-1){var c=P(e.split(cb),2),u=c[0],h=c[1];e=h,l=u,s=!0}if(e=i?"".concat(e,"capture"):e,t=Ys(t)?t:t.handleEvent,s){var f=t;t=function(){for(var d,p=[],v=0;v<arguments.length;v++)p[v]=arguments[v];((d=p[0].target)===null||d===void 0?void 0:d.name)===l&&f.apply(void 0,K([],P(p),!1))}}return a?this.emitter.once(e,t,o):this.emitter.on(e,t,o),this},n.prototype.off=function(e,t,r){return e?this.removeEventListener(e,t,r):this.removeAllEventListeners(),this},n.prototype.removeAllEventListeners=function(){this.emitter.removeAllListeners()},n.prototype.removeEventListener=function(e,t,r){var i=za(r)&&r||Ye(r)&&r.capture,a=Ys(t)?void 0:t;return e=i?"".concat(e,"capture"):e,t=Ys(t)?t:t==null?void 0:t.handleEvent,this.emitter.off(e,t,a),this},n.prototype.emit=function(e,t){this.dispatchEvent(new Ln(e,t))},n.prototype.dispatchEvent=function(e,t){var r,i;if(t===void 0&&(t=!1),!V3(e))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var a;if(this.document?a=this:this.defaultView?a=this.defaultView:a=(r=this.ownerDocument)===null||r===void 0?void 0:r.defaultView,a){if(e.manager=a.getEventService()||null,!e.manager)return!1;e.defaultPrevented=!1,e.path=[],t||(e.target=this),(i=e.manager)===null||i===void 0||i.dispatchEvent(e,e.type,t)}return!e.defaultPrevented},n}(),Xn=function(n){B(e,n);function e(){var t=n.call(this)||this;return t.shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return e.isNode=function(t){return!!t.childNodes},Object.defineProperty(e.prototype,"textContent",{get:function(){var t,r,i="";this.nodeName===Rt.TEXT&&(i+=this.style.text);try{for(var a=vt(this.childNodes),o=a.next();!o.done;o=a.next()){var s=o.value;s.nodeName===Rt.TEXT?i+=s.nodeValue:i+=s.textContent}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return i},set:function(t){var r=this;this.childNodes.slice().forEach(function(i){r.removeChild(i)}),this.nodeName===Rt.TEXT&&(this.style.text="".concat(t))},enumerable:!1,configurable:!0}),e.prototype.getRootNode=function(t){return t===void 0&&(t={}),this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this},e.prototype.hasChildNodes=function(){return this.childNodes.length>0},e.prototype.isDefaultNamespace=function(t){throw new Error(Le)},e.prototype.lookupNamespaceURI=function(t){throw new Error(Le)},e.prototype.lookupPrefix=function(t){throw new Error(Le)},e.prototype.normalize=function(){throw new Error(Le)},e.prototype.isEqualNode=function(t){return this===t},e.prototype.isSameNode=function(t){return this.isEqualNode(t)},Object.defineProperty(e.prototype,"parent",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.childNodes.length>0?this.childNodes[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null},enumerable:!1,configurable:!0}),e.prototype.compareDocumentPosition=function(t){var r;if(t===this)return 0;for(var i=t,a=this,o=[i],s=[a];(r=i.parentNode)!==null&&r!==void 0?r:a.parentNode;)i=i.parentNode?(o.push(i.parentNode),i.parentNode):i,a=a.parentNode?(s.push(a.parentNode),a.parentNode):a;if(i!==a)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var l=o.length>s.length?o:s,c=l===o?s:o;if(l[l.length-c.length]===c[0])return l===o?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=l.length-c.length,h=c.length-1;h>=0;h--){var f=c[h],d=l[u+h];if(d!==f){var p=f.parentNode.childNodes;return p.indexOf(f)<p.indexOf(d)?c===o?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:l===o?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING},e.prototype.contain=function(t){return this.contains(t)},e.prototype.contains=function(t){for(var r=t;r&&this!==r;)r=r.parentNode;return!!r},e.prototype.getAncestor=function(t){for(var r=this;t>0&&r;)r=r.parentNode,t--;return r},e.prototype.forEach=function(t,r){r===void 0&&(r=!1),t(this)||(r?this.childNodes.slice():this.childNodes).forEach(function(i){i.forEach(t)})},e.DOCUMENT_POSITION_DISCONNECTED=1,e.DOCUMENT_POSITION_PRECEDING=2,e.DOCUMENT_POSITION_FOLLOWING=4,e.DOCUMENT_POSITION_CONTAINS=8,e.DOCUMENT_POSITION_CONTAINED_BY=16,e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,e}(ub),H3=2048,Y3=function(){function n(e,t){var r=this;this.globalRuntime=e,this.context=t,this.emitter=new et,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=Q(),this.tmpVec3=_.Ue(),this.onPointerDown=function(i){var a=r.createPointerEvent(i);if(r.dispatchEvent(a,"pointerdown"),a.pointerType==="touch")r.dispatchEvent(a,"touchstart");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var o=a.button===2;r.dispatchEvent(a,o?"rightdown":"mousedown")}var s=r.trackingData(i.pointerId);s.pressTargetsByButton[i.button]=a.composedPath(),r.freeEvent(a)},this.onPointerUp=function(i){var a,o=_v.now(),s=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(s,"pointerup"),s.pointerType==="touch")r.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.dispatchEvent(s,l?"rightup":"mouseup")}var c=r.trackingData(i.pointerId),u=r.findMountedTarget(c.pressTargetsByButton[i.button]),h=u;if(u&&!s.composedPath().includes(u)){for(var f=u;f&&!s.composedPath().includes(f);){if(s.currentTarget=f,r.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")r.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.notifyTarget(s,l?"rightupoutside":"mouseupoutside")}Xn.isNode(f)&&(f=f.parentNode)}delete c.pressTargetsByButton[i.button],h=f}if(h){var d=r.clonePointerEvent(s,"click");d.target=h,d.path=[],c.clicksByButton[i.button]||(c.clicksByButton[i.button]={clickCount:0,target:d.target,timeStamp:o});var p=c.clicksByButton[i.button];p.target===d.target&&o-p.timeStamp<200?++p.clickCount:p.clickCount=1,p.target=d.target,p.timeStamp=o,d.detail=p.clickCount,!((a=s.detail)===null||a===void 0)&&a.preventClick||(!r.context.config.useNativeClickEvent&&(d.pointerType==="mouse"||d.pointerType==="touch")&&r.dispatchEvent(d,"click"),r.dispatchEvent(d,"pointertap")),r.freeEvent(d)}r.freeEvent(s)},this.onPointerMove=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),o=a.pointerType==="mouse"||a.pointerType==="pen",s=r.trackingData(i.pointerId),l=r.findMountedTarget(s.overTargets);if(s.overTargets&&l!==a.target){var c=i.type==="mousemove"?"mouseout":"pointerout",u=r.createPointerEvent(i,c,l||void 0);if(r.dispatchEvent(u,"pointerout"),o&&r.dispatchEvent(u,"mouseout"),!a.composedPath().includes(l)){var h=r.createPointerEvent(i,"pointerleave",l||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!a.composedPath().includes(h.target);)h.currentTarget=h.target,r.notifyTarget(h),o&&r.notifyTarget(h,"mouseleave"),Xn.isNode(h.target)&&(h.target=h.target.parentNode);r.freeEvent(h)}r.freeEvent(u)}if(l!==a.target){var f=i.type==="mousemove"?"mouseover":"pointerover",d=r.clonePointerEvent(a,f);r.dispatchEvent(d,"pointerover"),o&&r.dispatchEvent(d,"mouseover");for(var p=l&&Xn.isNode(l)&&l.parentNode;p&&p!==(Xn.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&p!==a.target;)p=p.parentNode;var v=!p||p===(Xn.isNode(r.rootTarget)&&r.rootTarget.parentNode);if(v){var g=r.clonePointerEvent(a,"pointerenter");for(g.eventPhase=g.AT_TARGET;g.target&&g.target!==l&&g.target!==(Xn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)g.currentTarget=g.target,r.notifyTarget(g),o&&r.notifyTarget(g,"mouseenter"),Xn.isNode(g.target)&&(g.target=g.target.parentNode);r.freeEvent(g)}r.freeEvent(d)}r.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&r.dispatchEvent(a,"touchmove"),o&&(r.dispatchEvent(a,"mousemove"),r.cursor=r.getCursor(a.target)),s.overTargets=a.composedPath(),r.freeEvent(a)},this.onPointerOut=function(i){var a=r.trackingData(i.pointerId);if(a.overTargets){var o=i.pointerType==="mouse"||i.pointerType==="pen",s=r.findMountedTarget(a.overTargets),l=r.createPointerEvent(i,"pointerout",s||void 0);r.dispatchEvent(l),o&&r.dispatchEvent(l,"mouseout");var c=r.createPointerEvent(i,"pointerleave",s||void 0);for(c.eventPhase=c.AT_TARGET;c.target&&c.target!==(Xn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)c.currentTarget=c.target,r.notifyTarget(c),o&&r.notifyTarget(c,"mouseleave"),Xn.isNode(c.target)&&(c.target=c.target.parentNode);a.overTargets=null,r.freeEvent(l),r.freeEvent(c)}r.cursor=null},this.onPointerOver=function(i){var a=r.trackingData(i.pointerId),o=r.createPointerEvent(i),s=o.pointerType==="mouse"||o.pointerType==="pen";r.dispatchEvent(o,"pointerover"),s&&r.dispatchEvent(o,"mouseover"),o.pointerType==="mouse"&&(r.cursor=r.getCursor(o.target));var l=r.clonePointerEvent(o,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(Xn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)l.currentTarget=l.target,r.notifyTarget(l),s&&r.notifyTarget(l,"mouseenter"),Xn.isNode(l.target)&&(l.target=l.target.parentNode);a.overTargets=o.composedPath(),r.freeEvent(o),r.freeEvent(l)},this.onPointerUpOutside=function(i){var a=r.trackingData(i.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[i.button]),s=r.createPointerEvent(i);if(o){for(var l=o;l;)s.currentTarget=l,r.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"||(s.pointerType==="mouse"||s.pointerType==="pen")&&r.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),Xn.isNode(l)&&(l=l.parentNode);delete a.pressTargetsByButton[i.button]}r.freeEvent(s)},this.onWheel=function(i){var a=r.createWheelEvent(i);r.dispatchEvent(a),r.freeEvent(a)},this.onClick=function(i){if(r.context.config.useNativeClickEvent){var a=r.createPointerEvent(i);r.dispatchEvent(a),r.freeEvent(a)}},this.onPointerCancel=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(a),r.freeEvent(a)}}return n.prototype.init=function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)},n.prototype.destroy=function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()},n.prototype.getScale=function(){var e=this.context.contextService.getBoundingClientRect(),t=1,r=1,i=this.context.contextService.getDomElement();if(i&&e){var a=i.offsetWidth,o=i.offsetHeight;a&&o&&(t=e.width/a,r=e.height/o)}return{scaleX:t,scaleY:r,bbox:e}},n.prototype.client2Viewport=function(e){var t=this.getScale(),r=t.scaleX,i=t.scaleY,a=t.bbox;return new ar((e.x-((a==null?void 0:a.left)||0))/r,(e.y-((a==null?void 0:a.top)||0))/i)},n.prototype.viewport2Client=function(e){var t=this.getScale(),r=t.scaleX,i=t.scaleY,a=t.bbox;return new ar((e.x+((a==null?void 0:a.left)||0))*r,(e.y+((a==null?void 0:a.top)||0))*i)},n.prototype.viewport2Canvas=function(e){var t=e.x,r=e.y,i=this.rootTarget.defaultView,a=i.getCamera(),o=this.context.config,s=o.width,l=o.height,c=a.getPerspectiveInverse(),u=a.getWorldTransform(),h=Ut(this.tmpMatrix,u,c),f=_.t8(this.tmpVec3,t/s*2-1,(1-r/l)*2-1,0);return _.fF(f,f,h),new ar(f[0],f[1])},n.prototype.canvas2Viewport=function(e){var t=this.rootTarget.defaultView,r=t.getCamera(),i=r.getPerspective(),a=r.getViewTransform(),o=Ut(this.tmpMatrix,i,a),s=_.t8(this.tmpVec3,e.x,e.y,0);_.fF(this.tmpVec3,this.tmpVec3,o);var l=this.context.config,c=l.width,u=l.height;return new ar((s[0]+1)/2*c,(1-(s[1]+1)/2)*u)},n.prototype.setPickHandler=function(e){this.pickHandler=e},n.prototype.addEventMapping=function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(r,i){return r.priority-i.priority})},n.prototype.mapEvent=function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var r=0,i=t.length;r<i;r++)t[r].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type))}},n.prototype.dispatchEvent=function(e,t,r){if(!r)e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t);else{e.eventPhase=e.AT_TARGET;var i=this.rootTarget.defaultView||null;e.currentTarget=i,this.notifyListeners(e,t)}this.emitter.emit(t||e.type,e)},n.prototype.propagate=function(e,t){if(e.target){var r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var i=r.length-1;i>=1;i--)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){var a=r.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var i=a+1;i<r.length;i++)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}},n.prototype.propagationPath=function(e){var t=[e],r=this.rootTarget.defaultView||null;if(r&&r===e)return t.unshift(r.document),t;for(var i=0;i<H3&&e!==this.rootTarget;i++)Xn.isNode(e)&&e.parentNode&&(t.push(e.parentNode),e=e.parentNode);return r&&t.push(r),t},n.prototype.hitTest=function(e){var t=e.viewportX,r=e.viewportY,i=this.context.config,a=i.width,o=i.height,s=i.disableHitTesting;return t<0||r<0||t>a||r>o?null:!s&&this.pickHandler(e)||this.rootTarget||null},n.prototype.isNativeEventFromCanvas=function(e,t){var r=t==null?void 0:t.target;if(r!=null&&r.shadowRoot&&(r=t.composedPath()[0]),r){if(r===e)return!0;if(e&&e.contains)return e.contains(r)}return t!=null&&t.composedPath?t.composedPath().indexOf(e)>-1:!1},n.prototype.getExistedHTML=function(e){var t,r;if(e.nativeEvent.composedPath)try{for(var i=vt(e.nativeEvent.composedPath()),a=i.next();!a.done;a=i.next()){var o=a.value,s=this.nativeHTMLMap.get(o);if(s)return s}}catch(l){t={error:l}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return null},n.prototype.pickTarget=function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY})},n.prototype.createPointerEvent=function(e,t,r,i){var a=this.allocateEvent(Cv);this.copyPointerData(e,a),this.copyMouseData(e,a),this.copyData(e,a),a.nativeEvent=e.nativeEvent,a.originalEvent=e;var o=this.getExistedHTML(a),s=this.context.contextService.getDomElement();return a.target=r!=null?r:o||this.isNativeEventFromCanvas(s,a.nativeEvent)&&this.pickTarget(a)||i,typeof t=="string"&&(a.type=t),a},n.prototype.createWheelEvent=function(e){var t=this.allocateEvent(Ov);this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e;var r=this.getExistedHTML(t),i=this.context.contextService.getDomElement();return t.target=r||this.isNativeEventFromCanvas(i,t.nativeEvent)&&this.pickTarget(t),t},n.prototype.trackingData=function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]},n.prototype.cloneWheelEvent=function(e){var t=this.allocateEvent(Ov);return t.nativeEvent=e.nativeEvent,t.originalEvent=e.originalEvent,this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.target=e.target,t.path=e.composedPath().slice(),t.type=e.type,t},n.prototype.clonePointerEvent=function(e,t){var r=this.allocateEvent(Cv);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=t!=null?t:r.type,r},n.prototype.copyPointerData=function(e,t){t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist},n.prototype.copyMouseData=function(e,t){t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.client.copyFrom(e.client),t.movement.copyFrom(e.movement),t.canvas.copyFrom(e.canvas),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global),t.offset.copyFrom(e.offset)},n.prototype.copyWheelData=function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ},n.prototype.copyData=function(e,t){t.isTrusted=e.isTrusted,t.timeStamp=_v.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.page.copyFrom(e.page),t.viewport.copyFrom(e.viewport)},n.prototype.allocateEvent=function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t},n.prototype.freeEvent=function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)},n.prototype.notifyTarget=function(e,t){t=t!=null?t:e.type;var r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)},n.prototype.notifyListeners=function(e,t){var r=e.currentTarget.emitter,i=r._events[t];if(i)if("fn"in i)i.once&&r.removeListener(t,i.fn,void 0,!0),i.fn.call(e.currentTarget||i.context,e);else for(var a=0;a<i.length&&!e.propagationImmediatelyStopped;a++)i[a].once&&r.removeListener(t,i[a].fn,void 0,!0),i[a].fn.call(e.currentTarget||i[a].context,e)},n.prototype.findMountedTarget=function(e){if(!e)return null;for(var t=e[e.length-1],r=e.length-2;r>=0;r--){var i=e[r];if(i===this.rootTarget||Xn.isNode(i)&&i.parentNode===t)t=e[r];else break}return t},n.prototype.getCursor=function(e){for(var t=e;t;){var r=c3(t)&&t.getAttribute("cursor");if(r)return r;t=Xn.isNode(t)&&t.parentNode}},n}(),X3=function(){function n(){}return n.prototype.getOrCreateCanvas=function(e,t){if(this.canvas)return this.canvas;if(e||rt.offscreenCanvas)this.canvas=e||rt.offscreenCanvas,this.context=this.canvas.getContext("2d",N({willReadFrequently:!0},t));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",N({willReadFrequently:!0},t)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",N({willReadFrequently:!0},t))}return this.canvas.width=10,this.canvas.height=10,this.canvas},n.prototype.getOrCreateContext=function(e,t){return this.context?this.context:(this.getOrCreateCanvas(e,t),this.context)},n}(),qs;(function(n){n[n.CAMERA_CHANGED=0]="CAMERA_CHANGED",n[n.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",n[n.NONE=2]="NONE"})(qs||(qs={}));var j3=function(){function n(e,t){this.globalRuntime=e,this.context=t,this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new xr,initAsync:new T3,dirtycheck:new Pv,cull:new Pv,beginFrame:new xr,beforeRender:new xr,render:new xr,afterRender:new xr,endFrame:new xr,destroy:new xr,pick:new P3,pickSync:new Pv,pointerDown:new xr,pointerUp:new xr,pointerMove:new xr,pointerOut:new xr,pointerOver:new xr,pointerWheel:new xr,pointerCancel:new xr,click:new xr}}return n.prototype.init=function(e){var t=this,r=N(N({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(i){i.apply(r,t.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){t.inited=!0,e()})},n.prototype.getStats=function(){return this.stats},n.prototype.disableDirtyRectangleRendering=function(){var e=this.context.config.renderer,t=e.getConfig().enableDirtyRectangleRendering;return!t||this.context.renderingContext.renderReasons.has(qs.CAMERA_CHANGED)},n.prototype.render=function(e,t,r){var i=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var a=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=a.renderReasons.size===1&&a.renderReasons.has(qs.CAMERA_CHANGED),s=!e.disableRenderHooks||!(e.disableRenderHooks&&o);s&&this.renderDisplayObject(a.root,e,a),this.hooks.beginFrame.call(t),s&&a.renderListCurrentFrame.forEach(function(l){i.hooks.beforeRender.call(l),i.hooks.render.call(l),i.hooks.afterRender.call(l)}),this.hooks.endFrame.call(t),a.renderListCurrentFrame=[],a.renderReasons.clear(),r()}},n.prototype.renderDisplayObject=function(e,t,r){var i=this,a=t.renderer.getConfig(),o=a.enableDirtyCheck,s=a.enableCulling;this.globalRuntime.enableCSSParsing&&this.globalRuntime.styleValueRegistry.recalc(e);var l=e.renderable,c=o?l.dirty||r.dirtyRectangleRenderingDisabled?e:null:e;if(c){var u=s?this.hooks.cull.call(c,this.context.camera):c;u&&(this.stats.rendered++,r.renderListCurrentFrame.push(u))}e.renderable.dirty=!1,e.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var h=e.sortable;h.dirty&&(this.sort(e,h),h.dirty=!1,h.dirtyChildren=[],h.dirtyReason=void 0),(h.sorted||e.childNodes).forEach(function(f){i.renderDisplayObject(f,t,r)})},n.prototype.sort=function(e,t){t.sorted&&t.dirtyReason!==Xs.Z_INDEX_CHANGED?t.dirtyChildren.forEach(function(r){var i=e.childNodes.indexOf(r);if(i===-1){var a=t.sorted.indexOf(r);a>=0&&t.sorted.splice(a,1)}else if(t.sorted.length===0)t.sorted.push(r);else{var o=u3(t.sorted,r);t.sorted.splice(o,0,r)}}):t.sorted=e.childNodes.slice().sort(eb)},n.prototype.destroy=function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()},n.prototype.dirtify=function(){this.context.renderingContext.renderReasons.add(qs.DISPLAY_OBJECT_CHANGED)},n}(),$3=/\[\s*(.*)=(.*)\s*\]/,K3=function(){function n(){}return n.prototype.selectOne=function(e,t){var r=this;if(e.startsWith("."))return t.find(function(s){return((s==null?void 0:s.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.find(function(s){return s.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,o=i.value;return a?t.find(function(s){return t!==s&&(a==="name"?s.name===o:r.attributeToString(s,a)===o)}):null}else return t.find(function(s){return t!==s&&s.nodeName===e})},n.prototype.selectAll=function(e,t){var r=this;if(e.startsWith("."))return t.findAll(function(s){return t!==s&&((s==null?void 0:s.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.findAll(function(s){return t!==s&&s.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,o=i.value;return a?t.findAll(function(s){return t!==s&&(a==="name"?s.name===o:r.attributeToString(s,a)===o)}):[]}else return t.findAll(function(s){return t!==s&&s.nodeName===e})},n.prototype.is=function(e,t){if(e.startsWith("."))return t.className===this.getIdOrClassname(e);if(e.startsWith("#"))return t.id===this.getIdOrClassname(e);if(e.startsWith("[")){var r=this.getAttribute(e),i=r.name,a=r.value;return i==="name"?t.name===a:this.attributeToString(t,i)===a}else return t.nodeName===e},n.prototype.getIdOrClassname=function(e){return e.substring(1)},n.prototype.getAttribute=function(e){var t=e.match($3),r="",i="";return t&&t.length>2&&(r=t[1].replace(/"/g,""),i=t[2].replace(/"/g,"")),{name:r,value:i}},n.prototype.attributeToString=function(e,t){if(!e.getAttribute)return"";var r=e.getAttribute(t);return pt(r)?"":r.toString?r.toString():""},n}(),oo=function(n){B(e,n);function e(t,r,i,a,o,s,l,c){var u=n.call(this,null)||this;return u.relatedNode=r,u.prevValue=i,u.newValue=a,u.attrName=o,u.attrChange=s,u.prevParsedValue=l,u.newParsedValue=c,u.type=t,u}return e.ADDITION=2,e.MODIFICATION=1,e.REMOVAL=3,e}(Nh),pe;(function(n){n.REPARENT="reparent",n.DESTROY="destroy",n.ATTR_MODIFIED="DOMAttrModified",n.INSERTED="DOMNodeInserted",n.REMOVED="removed",n.MOUNTED="DOMNodeInsertedIntoDocument",n.UNMOUNTED="DOMNodeRemovedFromDocument",n.BOUNDS_CHANGED="bounds-changed",n.CULLED="culled"})(pe||(pe={}));function hb(n){var e=n.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}var Z3=new oo(pe.REPARENT,null,"","","",0,"",""),q3=function(){function n(e){var t=this;this.runtime=e,this.pendingEvents=[],this.boundsChangedEvent=new Ln(pe.BOUNDS_CHANGED),this.rotate=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=_.al(a,o,s));var c=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)t.rotateLocal(i,a);else{var u=Vt();yi(u,a[0],a[1],a[2]);var h=t.getRotation(i),f=t.getRotation(i.parentNode);xi(r,f),da(r,r),An(u,r,u),An(c.localRotation,u,h),Ia(c.localRotation,c.localRotation),l&&t.dirtifyLocal(i,c)}}}(),this.rotateLocal=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=_.al(a,o,s));var c=i.transformable;yi(r,a[0],a[1],a[2]),ss(c.localRotation,c.localRotation,r),l&&t.dirtifyLocal(i,c)}}(),this.setEulerAngles=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=_.al(a,o,s));var c=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)t.setLocalEulerAngles(i,a);else{yi(c.localRotation,a[0],a[1],a[2]);var u=t.getRotation(i.parentNode);xi(r,da(Vt(),u)),ss(c.localRotation,c.localRotation,r),l&&t.dirtifyLocal(i,c)}}}(),this.translateLocal=function(){return function(r,i,a,o,s){a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=!0),typeof i=="number"&&(i=_.al(i,a,o));var l=r.transformable;_.fS(i,_.Ue())||(_.VC(i,i,l.localRotation),_.IH(l.localPosition,l.localPosition,i),s&&t.dirtifyLocal(r,l))}}(),this.setPosition=function(){var r=Q(),i=_.Ue();return function(a,o,s){s===void 0&&(s=!0);var l=a.transformable;if(i[0]=o[0],i[1]=o[1],i[2]=o[2]||0,!_.fS(t.getPosition(a),i)){if(_.JG(l.position,i),a.parentNode===null||!a.parentNode.transformable)_.JG(l.localPosition,i);else{var c=a.parentNode.transformable;kt(r,c.worldTransform),Wt(r,r),_.fF(l.localPosition,i,r)}s&&t.dirtifyLocal(a,l)}}}(),this.setLocalPosition=function(){var r=_.Ue();return function(i,a,o){o===void 0&&(o=!0);var s=i.transformable;r[0]=a[0],r[1]=a[1],r[2]=a[2]||0,!_.fS(s.localPosition,r)&&(_.JG(s.localPosition,r),o&&t.dirtifyLocal(i,s))}}(),this.translate=function(){var r=_.Ue(),i=_.Ue(),a=_.Ue();return function(o,s,l,c,u){l===void 0&&(l=0),c===void 0&&(c=0),u===void 0&&(u=!0),typeof s=="number"&&(s=_.t8(i,s,l,c)),!_.fS(s,r)&&(_.IH(a,t.getPosition(o),s),t.setPosition(o,a,u))}}(),this.setRotation=function(){var r=Vt();return function(i,a,o,s,l,c){c===void 0&&(c=!0);var u=i.transformable;if(typeof a=="number"&&(a=pa(a,o,s,l)),i.parentNode===null||!i.parentNode.transformable)t.setLocalRotation(i,a);else{var h=t.getRotation(i.parentNode);xi(r,h),da(r,r),An(u.localRotation,r,a),Ia(u.localRotation,u.localRotation),c&&t.dirtifyLocal(i,u)}}},this.displayObjectDependencyMap=new WeakMap,this.calcLocalTransform=function(){var r=Q(),i=_.Ue(),a=pa(0,0,0,1);return function(o){var s=o.localSkew[0]!==0||o.localSkew[1]!==0;if(s){if(fr(o.localTransform,o.localRotation,o.localPosition,_.al(1,1,1),o.origin),o.localSkew[0]!==0||o.localSkew[1]!==0){var l=Xt(r);l[4]=Math.tan(o.localSkew[0]),l[1]=Math.tan(o.localSkew[1]),Ut(o.localTransform,o.localTransform,l)}var c=fr(r,a,i,o.localScale,o.origin);Ut(o.localTransform,o.localTransform,c)}else fr(o.localTransform,o.localRotation,o.localPosition,o.localScale,o.origin)}}()}return n.prototype.matches=function(e,t){return this.runtime.sceneGraphSelector.is(e,t)},n.prototype.querySelector=function(e,t){return this.runtime.sceneGraphSelector.selectOne(e,t)},n.prototype.querySelectorAll=function(e,t){return this.runtime.sceneGraphSelector.selectAll(e,t)},n.prototype.attach=function(e,t,r){var i,a=!1;e.parentNode&&(a=e.parentNode!==t,this.detach(e)),e.parentNode=t,pt(r)?e.parentNode.childNodes.push(e):e.parentNode.childNodes.splice(r,0,e);var o=t.sortable;(!((i=o==null?void 0:o.sorted)===null||i===void 0)&&i.length||e.parsedStyle.zIndex)&&(o.dirtyChildren.indexOf(e)===-1&&o.dirtyChildren.push(e),o.dirty=!0,o.dirtyReason=Xs.ADDED);var s=e.transformable;s&&this.dirtifyWorld(e,s),s.frozen&&this.unfreezeParentToRoot(e),a&&e.dispatchEvent(Z3)},n.prototype.detach=function(e){var t,r;if(e.parentNode){var i=e.transformable,a=e.parentNode.sortable;(!((t=a==null?void 0:a.sorted)===null||t===void 0)&&t.length||!((r=e.style)===null||r===void 0)&&r.zIndex)&&(a.dirtyChildren.indexOf(e)===-1&&a.dirtyChildren.push(e),a.dirty=!0,a.dirtyReason=Xs.REMOVED);var o=e.parentNode.childNodes.indexOf(e);o>-1&&e.parentNode.childNodes.splice(o,1),i&&this.dirtifyWorld(e,i),e.parentNode=null}},n.prototype.getOrigin=function(e){return e.getGeometryBounds(),e.transformable.origin},n.prototype.setOrigin=function(e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=0),typeof t=="number"&&(t=[t,r,i]);var a=e.transformable;if(!(t[0]===a.origin[0]&&t[1]===a.origin[1]&&t[2]===a.origin[2])){var o=a.origin;o[0]=t[0],o[1]=t[1],o[2]=t[2]||0,this.dirtifyLocal(e,a)}},n.prototype.setLocalEulerAngles=function(e,t,r,i,a){r===void 0&&(r=0),i===void 0&&(i=0),a===void 0&&(a=!0),typeof t=="number"&&(t=_.al(t,r,i));var o=e.transformable;yi(o.localRotation,t[0],t[1],t[2]),a&&this.dirtifyLocal(e,o)},n.prototype.scaleLocal=function(e,t,r){r===void 0&&(r=!0);var i=e.transformable;_.Jp(i.localScale,i.localScale,_.al(t[0],t[1],t[2]||1)),r&&this.dirtifyLocal(e,i)},n.prototype.setLocalScale=function(e,t,r){r===void 0&&(r=!0);var i=e.transformable,a=_.al(t[0],t[1],t[2]||i.localScale[2]);_.fS(a,i.localScale)||(_.JG(i.localScale,a),r&&this.dirtifyLocal(e,i))},n.prototype.setLocalRotation=function(e,t,r,i,a,o){o===void 0&&(o=!0),typeof t=="number"&&(t=pa(t,r,i,a));var s=e.transformable;xi(s.localRotation,t),o&&this.dirtifyLocal(e,s)},n.prototype.setLocalSkew=function(e,t,r){typeof t=="number"&&(t=va.al(t,r));var i=e.transformable;va.JG(i.localSkew,t),this.dirtifyLocal(e,i)},n.prototype.dirtifyLocal=function(e,t){t.localDirtyFlag||(t.localDirtyFlag=!0,t.dirtyFlag||this.dirtifyWorld(e,t))},n.prototype.dirtifyWorld=function(e,t){t.dirtyFlag||this.unfreezeParentToRoot(e),this.dirtifyWorldInternal(e,t),this.dirtifyToRoot(e,!0)},n.prototype.triggerPendingEvents=function(){var e=this,t=new Set,r=function(i,a){i.isConnected&&!t.has(i.entity)&&(e.boundsChangedEvent.detail=a,e.boundsChangedEvent.target=i,i.isMutationObserved?i.dispatchEvent(e.boundsChangedEvent):i.ownerDocument.defaultView.dispatchEvent(e.boundsChangedEvent,!0),t.add(i.entity))};this.pendingEvents.forEach(function(i){var a=P(i,2),o=a[0],s=a[1];s.affectChildren?o.forEach(function(l){r(l,s)}):r(o,s)}),this.clearPendingEvents(),t.clear()},n.prototype.clearPendingEvents=function(){this.pendingEvents=[]},n.prototype.dirtifyToRoot=function(e,t){t===void 0&&(t=!1);var r=e;for(r.renderable&&(r.renderable.dirty=!0);r;)hb(r),r=r.parentNode;t&&e.forEach(function(i){hb(i)}),this.informDependentDisplayObjects(e),this.pendingEvents.push([e,{affectChildren:t}])},n.prototype.updateDisplayObjectDependency=function(e,t,r,i){if(t&&t!==r){var a=this.displayObjectDependencyMap.get(t);if(a&&a[e]){var o=a[e].indexOf(i);a[e].splice(o,1)}}if(r){var s=this.displayObjectDependencyMap.get(r);s||(this.displayObjectDependencyMap.set(r,{}),s=this.displayObjectDependencyMap.get(r)),s[e]||(s[e]=[]),s[e].push(i)}},n.prototype.informDependentDisplayObjects=function(e){var t=this,r=this.displayObjectDependencyMap.get(e);r&&Object.keys(r).forEach(function(i){r[i].forEach(function(a){t.dirtifyToRoot(a,!0),a.dispatchEvent(new oo(pe.ATTR_MODIFIED,a,t,t,i,oo.MODIFICATION,t,t)),a.isCustomElement&&a.isConnected&&a.attributeChangedCallback&&a.attributeChangedCallback(i,t,t)})})},n.prototype.getPosition=function(e){var t=e.transformable;return Qn(t.position,this.getWorldTransform(e,t))},n.prototype.getRotation=function(e){var t=e.transformable;return _n(t.rotation,this.getWorldTransform(e,t))},n.prototype.getScale=function(e){var t=e.transformable;return He(t.scaling,this.getWorldTransform(e,t))},n.prototype.getWorldTransform=function(e,t){return t===void 0&&(t=e.transformable),!t.localDirtyFlag&&!t.dirtyFlag||(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.sync(e,t)),t.worldTransform},n.prototype.getLocalPosition=function(e){return e.transformable.localPosition},n.prototype.getLocalRotation=function(e){return e.transformable.localRotation},n.prototype.getLocalScale=function(e){return e.transformable.localScale},n.prototype.getLocalSkew=function(e){return e.transformable.localSkew},n.prototype.getLocalTransform=function(e){var t=e.transformable;return t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.localTransform},n.prototype.setLocalTransform=function(e,t){var r=Qn(_.Ue(),t),i=_n(Vt(),t),a=He(_.Ue(),t);this.setLocalScale(e,a,!1),this.setLocalPosition(e,r,!1),this.setLocalRotation(e,i,void 0,void 0,void 0,!1),this.dirtifyLocal(e,e.transformable)},n.prototype.resetLocalTransform=function(e){this.setLocalScale(e,[1,1,1]),this.setLocalPosition(e,[0,0,0]),this.setLocalEulerAngles(e,[0,0,0]),this.setLocalSkew(e,[0,0])},n.prototype.getTransformedGeometryBounds=function(e,t,r){t===void 0&&(t=!1);var i=this.getGeometryBounds(e,t);if(ir.isEmpty(i))return null;var a=r||new ir;return a.setFromTransformedAABB(i,this.getWorldTransform(e)),a},n.prototype.getGeometryBounds=function(e,t){t===void 0&&(t=!1);var r=e.geometry;r.dirty&&rt.styleValueRegistry.updateGeometry(e);var i=t?r.renderBounds:r.contentBounds||null;return i||new ir},n.prototype.getBounds=function(e,t){var r=this;t===void 0&&(t=!1);var i=e.renderable;if(!i.boundsDirty&&!t&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&t&&i.renderBounds)return i.renderBounds;var a=t?i.renderBounds:i.bounds,o=this.getTransformedGeometryBounds(e,t,a),s=e.childNodes;if(s.forEach(function(u){var h=r.getBounds(u,t);h&&(o?o.add(h):(o=a||new ir,o.update(h.center,h.halfExtents)))}),o||(o=new ir),t){var l=h3(e);if(l){var c=l.parsedStyle.clipPath.getBounds(t);o?c&&(o=c.intersection(o)):o.update(c.center,c.halfExtents)}}return t?(i.renderBounds=o,i.renderBoundsDirty=!1):(i.bounds=o,i.boundsDirty=!1),o},n.prototype.getLocalBounds=function(e){if(e.parentNode){var t=Q();e.parentNode.transformable&&(t=Wt(Q(),this.getWorldTransform(e.parentNode)));var r=this.getBounds(e);if(!ir.isEmpty(r)){var i=new ir;return i.setFromTransformedAABB(r,t),i}}return this.getBounds(e)},n.prototype.getBoundingClientRect=function(e){var t,r,i,a=this.getGeometryBounds(e);ir.isEmpty(a)||(i=new ir,i.setFromTransformedAABB(a,this.getWorldTransform(e)));var o=(r=(t=e.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect();if(i){var s=P(i.getMin(),2),l=s[0],c=s[1],u=P(i.getMax(),2),h=u[0],f=u[1];return new Yo(l+((o==null?void 0:o.left)||0),c+((o==null?void 0:o.top)||0),h-l,f-c)}return new Yo((o==null?void 0:o.left)||0,(o==null?void 0:o.top)||0,0,0)},n.prototype.dirtifyWorldInternal=function(e,t){var r=this;if(!t.dirtyFlag){t.dirtyFlag=!0,t.frozen=!1,e.childNodes.forEach(function(a){var o=a.transformable;o.dirtyFlag||r.dirtifyWorldInternal(a,o)});var i=e.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0)}},n.prototype.syncHierarchy=function(e){var t=e.transformable;if(!t.frozen){t.frozen=!0,(t.localDirtyFlag||t.dirtyFlag)&&this.sync(e,t);for(var r=e.childNodes,i=0;i<r.length;i++)this.syncHierarchy(r[i])}},n.prototype.sync=function(e,t){if(t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.dirtyFlag){var r=e.parentNode,i=r&&r.transformable;r===null||!i?kt(t.worldTransform,t.localTransform):Ut(t.worldTransform,i.worldTransform,t.localTransform),t.dirtyFlag=!1}},n.prototype.unfreezeParentToRoot=function(e){for(var t=e.parentNode;t;){var r=t.transformable;r&&(r.frozen=!1),t=t.parentNode}},n}(),$o={MetricsString:"|\xC9q\xC5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},fb=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,J3=/[!%),.:;?\]}'""]/,Q3=/[$('"]/,tL=/[!),.:;?\]}'""]/,eL=/[([{'"]/,nL=/[)\]'"?!:;,.]/,rL=/[(['"...]/,iL=/[!%),.:;?\]}'"]/,aL=/[$([{'"#]/,oL=new RegExp("".concat(J3.source,"|").concat(tL.source,"|").concat(nL.source,"|").concat(iL.source)),sL=new RegExp("".concat(Q3.source,"|").concat(eL.source,"|").concat(rL.source,"|").concat(aL.source)),lL=function(){function n(e){var t=this;this.runtime=e,this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(r,i){return t.isBreakingSpace(i)?!1:!!(r&&(sL.exec(i)||oL.exec(r)))},this.trimByKinsokuShorui=function(r){var i=K([],P(r),!1),a=i[i.length-2];if(!a)return r;var o=a[a.length-1];return i[i.length-2]=a.slice(0,-1),i[i.length-1]=o+i[i.length-1],i}}return n.prototype.measureFont=function(e,t){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var r={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(t),a=this.runtime.offscreenCanvasCreator.getOrCreateContext(t,{willReadFrequently:!0});a.font=e;var o=$o.MetricsString+$o.BaselineSymbol,s=Math.ceil(a.measureText(o).width),l=Math.ceil(a.measureText($o.BaselineSymbol).width),c=$o.HeightMultiplier*l;l=l*$o.BaselineMultiplier|0,i.width=s,i.height=c,a.fillStyle="#f00",a.fillRect(0,0,s,c),a.font=e,a.textBaseline="alphabetic",a.fillStyle="#000",a.fillText(o,0,l);var u=a.getImageData(0,0,s||1,c||1).data,h=u.length,f=s*4,d=0,p=0,v=!1;for(d=0;d<l;++d){for(var g=0;g<f;g+=4)if(u[p+g]!==255){v=!0;break}if(!v)p+=f;else break}for(r.ascent=l-d,p=h-f,v=!1,d=c;d>l;--d){for(var g=0;g<f;g+=4)if(u[p+g]!==255){v=!0;break}if(!v)p-=f;else break}return r.descent=d-l,r.fontSize=r.ascent+r.descent,this.fontMetricsCache[e]=r,r},n.prototype.measureText=function(e,t,r){var i=t.fontSize,a=i===void 0?16:i,o=t.wordWrap,s=o===void 0?!1:o,l=t.lineHeight,c=t.lineWidth,u=c===void 0?1:c,h=t.textBaseline,f=h===void 0?"alphabetic":h,d=t.textAlign,p=d===void 0?"start":d,v=t.letterSpacing,g=v===void 0?0:v,m=t.textPath;t.textPathSide,t.textPathStartOffset;var x=t.leading,S=x===void 0?0:x,T=O3(t),b=this.measureFont(T,r);b.fontSize===0&&(b.fontSize=a,b.ascent=a);var y=this.runtime.offscreenCanvasCreator.getOrCreateContext(r);y.font=T,t.isOverflowing=!1;var E=s?this.wordWrap(e,t,r):e,w=E.split(/(?:\r\n|\r|\n)/),C=new Array(w.length),M=0;if(m){m.getTotalLength();for(var O=0;O<w.length;O++)var A=y.measureText(w[O]).width+(w[O].length-1)*g}else{for(var O=0;O<w.length;O++){var R=y.measureText(w[O]).width+(w[O].length-1)*g;C[O]=R,M=Math.max(M,R)}var A=M+u,L=l||b.fontSize+u,z=Math.max(L,b.fontSize+u)+(w.length-1)*(L+S);L+=S;var Y=0;return f==="middle"?Y=-z/2:f==="bottom"||f==="alphabetic"||f==="ideographic"?Y=-z:(f==="top"||f==="hanging")&&(Y=0),{font:T,width:A,height:z,lines:w,lineWidths:C,lineHeight:L,maxLineWidth:M,fontProperties:b,lineMetrics:C.map(function(q,J){var wt=0;return p==="center"||p==="middle"?wt-=q/2:(p==="right"||p==="end")&&(wt-=q),new Yo(wt-u/2,Y+J*L,q+u,L)})}}},n.prototype.setGraphemeOnPath=function(){},n.prototype.wordWrap=function(e,t,r){var i=this,a=t.wordWrapWidth,o=a===void 0?0:a,s=t.letterSpacing,l=s===void 0?0:s,c=t.maxLines,u=c===void 0?1/0:c,h=t.textOverflow,f=this.runtime.offscreenCanvasCreator.getOrCreateContext(r),d=o+l,p="";h==="ellipsis"?p="...":h&&h!=="clip"&&(p=h);for(var v=[],g=0,m=0,x={},S=function(Y){return i.getFromCache(Y,l,x,f)},T=Array.from(p).reduce(function(Y,I){return Y+S(I)},0),b=Array.from(e),y=0;y<b.length;y++){var E=b[y],w=e[y-1],C=e[y+1],M=S(E);if(this.isNewline(E)){if(g++,g>=u){t.isOverflowing=!0;break}m=0,v[g]="";continue}if(m>0&&m+M>d){if(g+1>=u){if(t.isOverflowing=!0,T>0&&T<=d){for(var O=v[g].length,A=0,R=O,L=0;L<O;L++){var z=S(v[g][L]);if(A+z+T>d){R=L;break}A+=z}v[g]=(v[g]||"").slice(0,R)+p}break}if(g++,m=0,v[g]="",this.isBreakingSpace(E))continue;this.canBreakInLastChar(E)||(v=this.trimToBreakable(v),m=this.sumTextWidthByCache(v[g]||"",x)),this.shouldBreakByKinsokuShorui(E,C)&&(v=this.trimByKinsokuShorui(v),m+=S(w||""))}m+=M,v[g]=(v[g]||"")+E}return v.join(`
`)},n.prototype.isBreakingSpace=function(e){return typeof e!="string"?!1:$o.BreakingSpaces.indexOf(e.charCodeAt(0))>=0},n.prototype.isNewline=function(e){return typeof e!="string"?!1:$o.Newlines.indexOf(e.charCodeAt(0))>=0},n.prototype.trimToBreakable=function(e){var t=K([],P(e),!1),r=t[t.length-2],i=this.findBreakableIndex(r);if(i===-1||!r)return t;var a=r.slice(i,i+1),o=this.isBreakingSpace(a),s=i+1,l=i+(o?0:1);return t[t.length-1]+=r.slice(s,r.length),t[t.length-2]=r.slice(0,l),t},n.prototype.canBreakInLastChar=function(e){return!(e&&fb.test(e))},n.prototype.sumTextWidthByCache=function(e,t){return e.split("").reduce(function(r,i){if(!t[i])throw Error("cannot count the word without cache");return r+t[i]},0)},n.prototype.findBreakableIndex=function(e){for(var t=e.length-1;t>=0;t--)if(!fb.test(e[t]))return t;return-1},n.prototype.getFromCache=function(e,t,r,i){var a=r[e];if(typeof a!="number"){var o=e.length*t;a=i.measureText(e).width+o,r[e]=a}return a},n}(),rt={},cL=function(){var n,e=new z3,t=new G3;return n={},n[Rt.CIRCLE]=new I3,n[Rt.ELLIPSE]=new D3,n[Rt.RECT]=e,n[Rt.IMAGE]=e,n[Rt.GROUP]=new U3,n[Rt.LINE]=new B3,n[Rt.TEXT]=new W3(rt),n[Rt.POLYLINE]=t,n[Rt.POLYGON]=t,n[Rt.PATH]=new F3,n[Rt.HTML]=null,n[Rt.MESH]=null,n}(),uL=function(){var n,e=new $k,t=new Ev;return n={},n[_t.PERCENTAGE]=null,n[_t.NUMBER]=new Qk,n[_t.ANGLE]=new Xk,n[_t.DEFINED_PATH]=new jk,n[_t.PAINT]=e,n[_t.COLOR]=e,n[_t.FILTER]=new Kk,n[_t.LENGTH]=t,n[_t.LENGTH_PERCENTAGE]=t,n[_t.LENGTH_PERCENTAGE_12]=new Zk,n[_t.LENGTH_PERCENTAGE_14]=new qk,n[_t.COORDINATE]=new Ev,n[_t.OFFSET_DISTANCE]=new t3,n[_t.OPACITY_VALUE]=new e3,n[_t.PATH]=new n3,n[_t.LIST_OF_POINTS]=new r3,n[_t.SHADOW_BLUR]=new i3,n[_t.TEXT]=new a3,n[_t.TEXT_TRANSFORM]=new o3,n[_t.TRANSFORM]=new R3,n[_t.TRANSFORM_ORIGIN]=new k3,n[_t.Z_INDEX]=new L3,n[_t.MARKER]=new Jk,n}(),hL=function(){return typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:{}};rt.CameraContribution=Tx,rt.AnimationTimeline=null,rt.EasingFunction=null,rt.offscreenCanvasCreator=new X3,rt.sceneGraphSelector=new K3,rt.sceneGraphService=new q3(rt),rt.textService=new lL(rt),rt.geometryUpdaterFactory=cL,rt.CSSPropertySyntaxFactory=uL,rt.styleValueRegistry=new Yk(rt),rt.layoutRegistry=null,rt.globalThis=hL(),rt.enableCSSParsing=!1,rt.enableDataset=!1,rt.enableStyleSyntax=!0,rt.enableAttributeDashCased=!1,rt.enableSizeAttenuation=!1;var db=0;function yW(){db=0}var pb=new oo(pe.INSERTED,null,"","","",0,"",""),vb=new oo(pe.REMOVED,null,"","","",0,"",""),fL=new Ln(pe.DESTROY),dL=function(n){B(e,n);function e(){var t=n.call(this)||this;return t.entity=db++,t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.cullable={strategy:hv.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle=rt.enableCSSParsing?{opacity:$e,fillOpacity:$e,strokeOpacity:$e,fill:$e,stroke:$e,transform:$e,transformOrigin:$e,visibility:$e,pointerEvents:$e,lineWidth:$e,lineCap:$e,lineJoin:$e,increasedLineWidthForHitTesting:$e,fontSize:$e,fontFamily:$e,fontStyle:$e,fontWeight:$e,fontVariant:$e,textAlign:$e,textBaseline:$e,textTransform:$e,zIndex:$e,filter:$e,shadowType:$e}:null,t.parsedStyle={},t.attributes={},t}return Object.defineProperty(e.prototype,"className",{get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"classList",{get:function(){return this.className.split(" ").filter(function(t){return t!==""})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagName",{get:function(){return this.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(t){throw new Error(Le)},e.prototype.appendChild=function(t,r){var i;if(t.destroyed)throw new Error(zR);return rt.sceneGraphService.attach(t,this,r),!((i=this.ownerDocument)===null||i===void 0)&&i.defaultView&&this.ownerDocument.defaultView.mountChildren(t),this.isMutationObserved&&(pb.relatedNode=this,t.dispatchEvent(pb)),t},e.prototype.insertBefore=function(t,r){if(!r)this.appendChild(t);else{t.parentElement&&t.parentElement.removeChild(t);var i=this.childNodes.indexOf(r);i===-1?this.appendChild(t):this.appendChild(t,i)}return t},e.prototype.replaceChild=function(t,r){var i=this.childNodes.indexOf(r);return this.removeChild(r),this.appendChild(t,i),r},e.prototype.removeChild=function(t){var r;return vb.relatedNode=this,t.dispatchEvent(vb),!((r=t.ownerDocument)===null||r===void 0)&&r.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),rt.sceneGraphService.detach(t),t},e.prototype.removeChildren=function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];this.removeChild(r)}},e.prototype.destroyChildren=function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];r.childNodes.length&&r.destroyChildren(),r.destroy()}},e.prototype.matches=function(t){return rt.sceneGraphService.matches(t,this)},e.prototype.getElementById=function(t){return rt.sceneGraphService.querySelector("#".concat(t),this)},e.prototype.getElementsByName=function(t){return rt.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)},e.prototype.getElementsByClassName=function(t){return rt.sceneGraphService.querySelectorAll(".".concat(t),this)},e.prototype.getElementsByTagName=function(t){return rt.sceneGraphService.querySelectorAll(t,this)},e.prototype.querySelector=function(t){return rt.sceneGraphService.querySelector(t,this)},e.prototype.querySelectorAll=function(t){return rt.sceneGraphService.querySelectorAll(t,this)},e.prototype.closest=function(t){var r=this;do{if(rt.sceneGraphService.matches(t,r))return r;r=r.parentElement}while(r!==null);return null},e.prototype.find=function(t){var r=this,i=null;return this.forEach(function(a){return a!==r&&t(a)?(i=a,!0):!1}),i},e.prototype.findAll=function(t){var r=this,i=[];return this.forEach(function(a){a!==r&&t(a)&&i.push(a)}),i},e.prototype.after=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this);r.forEach(function(o,s){var l;return(l=t.parentNode)===null||l===void 0?void 0:l.appendChild(o,a+s+1)})}},e.prototype.before=function(){for(var t,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this),o=P(r),s=o[0],l=o.slice(1);this.parentNode.appendChild(s,a),(t=s).after.apply(t,K([],P(l),!1))}},e.prototype.replaceWith=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.after.apply(this,K([],P(t),!1)),this.remove()},e.prototype.append=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(a){return t.appendChild(a)})},e.prototype.prepend=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(a,o){return t.appendChild(a,o)})},e.prototype.replaceChildren=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,K([],P(t),!1))},e.prototype.remove=function(){return this.parentNode?this.parentNode.removeChild(this):this},e.prototype.destroy=function(){this.dispatchEvent(fL),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0},e.prototype.getGeometryBounds=function(){return rt.sceneGraphService.getGeometryBounds(this)},e.prototype.getRenderBounds=function(){return rt.sceneGraphService.getBounds(this,!0)},e.prototype.getBounds=function(){return rt.sceneGraphService.getBounds(this)},e.prototype.getLocalBounds=function(){return rt.sceneGraphService.getLocalBounds(this)},e.prototype.getBoundingClientRect=function(){return rt.sceneGraphService.getBoundingClientRect(this)},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},e.prototype.getAttributeNames=function(){return Object.keys(this.attributes)},e.prototype.getAttribute=function(t){if(KR(t))return rt.enableCSSParsing?null:void 0;var r=this.attributes[t];if(r===void 0){if(rt.enableAttributeDashCased){var i=ov(t);r=this.attributes[i]}return rt.enableCSSParsing&&pt(r)?null:r}else return r},e.prototype.hasAttribute=function(t){return this.getAttributeNames().includes(t)},e.prototype.hasAttributes=function(){return!!this.getAttributeNames().length},e.prototype.removeAttribute=function(t){this.setAttribute(t,null),delete this.attributes[t]},e.prototype.setAttribute=function(t,r,i,a){this.attributes[t]=r},e.prototype.getAttributeNS=function(t,r){throw new Error(Le)},e.prototype.getAttributeNode=function(t){throw new Error(Le)},e.prototype.getAttributeNodeNS=function(t,r){throw new Error(Le)},e.prototype.hasAttributeNS=function(t,r){throw new Error(Le)},e.prototype.removeAttributeNS=function(t,r){throw new Error(Le)},e.prototype.removeAttributeNode=function(t){throw new Error(Le)},e.prototype.setAttributeNS=function(t,r,i){throw new Error(Le)},e.prototype.setAttributeNode=function(t){throw new Error(Le)},e.prototype.setAttributeNodeNS=function(t){throw new Error(Le)},e.prototype.toggleAttribute=function(t,r){throw new Error(Le)},e}(Xn);function Ke(n){return!!(n!=null&&n.nodeName)}var gb=rt.globalThis.Proxy?rt.globalThis.Proxy:function(){},Ca=new oo(pe.ATTR_MODIFIED,null,null,null,null,oo.MODIFICATION,null,null),pL={opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",zIndex:"",filter:"",shadowType:""},vL={fill:Th,stroke:Th,transform:[],zIndex:0,filter:[],shadowType:"outer",miterLimit:10},gL=["opacity","fillOpacity","strokeOpacity","transformOrigin","visibility","pointerEvents","lineWidth","lineCap","lineJoin","increasedLineWidthForHitTesting"],mL=K(K([],P(gL),!1),["fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform"],!1),mb="data-",Wr=function(n){B(e,n);function e(t){var r=n.call(this)||this;return r.isCustomElement=!1,r.isMutationObserved=!1,r.activeAnimations=[],r.config=t,r.id=r.config.id||"",r.name=r.config.name||"",(r.config.className||r.config.class)&&(r.className=r.config.className||r.config.class),r.nodeName=r.config.type||Rt.GROUP,rt.enableCSSParsing?(Object.assign(r.attributes,pL),Object.assign(r.parsedStyle,vL,r.config.initialParsedStyle)):r.config.initialParsedStyle&&Object.assign(r.parsedStyle,r.config.initialParsedStyle),r.initAttributes(r.config.style),rt.enableDataset&&(r.dataset=new gb({},{get:function(i,a){var o="".concat(mb).concat(Cx(a));return i[o]!==void 0?i[o]:r.getAttribute(o)},set:function(i,a,o){return r.setAttribute("".concat(mb).concat(Cx(a)),o),!0}})),rt.enableStyleSyntax&&(r.style=new gb({setProperty:function(i,a){r.setAttribute(i,a)},getPropertyValue:function(i){return r.getAttribute(i)},removeProperty:function(i){r.removeAttribute(i)},item:function(){return""}},{get:function(i,a){return i[a]!==void 0?i[a]:r.getAttribute(a)},set:function(i,a,o){return r.setAttribute(a,o),!0}})),r}return e.prototype.destroy=function(){n.prototype.destroy.call(this),this.getAnimations().forEach(function(t){t.cancel()})},e.prototype.cloneNode=function(t,r){var i=N({},this.attributes);for(var a in i){var o=i[a];Ke(o)&&a!=="clipPath"&&a!=="offsetPath"&&a!=="textPath"&&(i[a]=o.cloneNode(t)),r&&(i[a]=r(a,o))}var s=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:i});return s.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(l){if(!l.style.isMarker){var c=l.cloneNode(t);s.appendChild(c)}}),s},e.prototype.initAttributes=function(t){t===void 0&&(t={});var r=this.renderable,i={forceUpdateGeometry:!0};rt.enableCSSParsing&&(i.usedAttributes=mL);var a=t;if(rt.enableAttributeDashCased){a={};for(var o in t){var s=ov(o);a[s]=t[o]}}rt.styleValueRegistry.processProperties(this,a,i),r.dirty=!0},e.prototype.setAttribute=function(t,r,i,a){i===void 0&&(i=!1),a===void 0&&(a=!0),rt.enableAttributeDashCased&&(t=ov(t)),!yt(r)&&(i||r!==this.attributes[t])&&(this.internalSetAttribute(t,r,{memoize:a}),n.prototype.setAttribute.call(this,t,r))},e.prototype.internalSetAttribute=function(t,r,i){var a;i===void 0&&(i={});var o=this.renderable,s=this.attributes[t],l=this.parsedStyle[t];rt.styleValueRegistry.processProperties(this,(a={},a[t]=r,a),i),o.dirty=!0;var c=this.parsedStyle[t];this.isConnected&&(Ca.relatedNode=this,Ca.prevValue=s,Ca.newValue=r,Ca.attrName=t,Ca.prevParsedValue=l,Ca.newParsedValue=c,this.isMutationObserved?this.dispatchEvent(Ca):(Ca.target=this,this.ownerDocument.defaultView.dispatchEvent(Ca,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&this.attributeChangedCallback&&this.attributeChangedCallback(t,s,r,l,c)},e.prototype.getBBox=function(){var t=this.getBounds(),r=P(t.getMin(),2),i=r[0],a=r[1],o=P(t.getMax(),2),s=o[0],l=o[1];return new Yo(i,a,s-i,l-a)},e.prototype.setOrigin=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),rt.sceneGraphService.setOrigin(this,yr(t,r,i)),this},e.prototype.getOrigin=function(){return rt.sceneGraphService.getOrigin(this)},e.prototype.setPosition=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),rt.sceneGraphService.setPosition(this,yr(t,r,i)),this},e.prototype.setLocalPosition=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),rt.sceneGraphService.setLocalPosition(this,yr(t,r,i)),this},e.prototype.translate=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),rt.sceneGraphService.translate(this,yr(t,r,i)),this},e.prototype.translateLocal=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),rt.sceneGraphService.translateLocal(this,yr(t,r,i)),this},e.prototype.getPosition=function(){return rt.sceneGraphService.getPosition(this)},e.prototype.getLocalPosition=function(){return rt.sceneGraphService.getLocalPosition(this)},e.prototype.scale=function(t,r,i){return this.scaleLocal(t,r,i)},e.prototype.scaleLocal=function(t,r,i){return typeof t=="number"&&(r=r||t,i=i||t,t=yr(t,r,i)),rt.sceneGraphService.scaleLocal(this,t),this},e.prototype.setLocalScale=function(t,r,i){return typeof t=="number"&&(r=r||t,i=i||t,t=yr(t,r,i)),rt.sceneGraphService.setLocalScale(this,t),this},e.prototype.getLocalScale=function(){return rt.sceneGraphService.getLocalScale(this)},e.prototype.getScale=function(){return rt.sceneGraphService.getScale(this)},e.prototype.getEulerAngles=function(){var t=P(ev(_.Ue(),rt.sceneGraphService.getWorldTransform(this)),3),r=t[2];return Oi(r)},e.prototype.getLocalEulerAngles=function(){var t=P(ev(_.Ue(),rt.sceneGraphService.getLocalRotation(this)),3),r=t[2];return Oi(r)},e.prototype.setEulerAngles=function(t){return rt.sceneGraphService.setEulerAngles(this,0,0,t),this},e.prototype.setLocalEulerAngles=function(t){return rt.sceneGraphService.setLocalEulerAngles(this,0,0,t),this},e.prototype.rotateLocal=function(t,r,i){return pt(r)&&pt(i)?rt.sceneGraphService.rotateLocal(this,0,0,t):rt.sceneGraphService.rotateLocal(this,t,r,i),this},e.prototype.rotate=function(t,r,i){return pt(r)&&pt(i)?rt.sceneGraphService.rotate(this,0,0,t):rt.sceneGraphService.rotate(this,t,r,i),this},e.prototype.setRotation=function(t,r,i,a){return rt.sceneGraphService.setRotation(this,t,r,i,a),this},e.prototype.setLocalRotation=function(t,r,i,a){return rt.sceneGraphService.setLocalRotation(this,t,r,i,a),this},e.prototype.setLocalSkew=function(t,r){return rt.sceneGraphService.setLocalSkew(this,t,r),this},e.prototype.getRotation=function(){return rt.sceneGraphService.getRotation(this)},e.prototype.getLocalRotation=function(){return rt.sceneGraphService.getLocalRotation(this)},e.prototype.getLocalSkew=function(){return rt.sceneGraphService.getLocalSkew(this)},e.prototype.getLocalTransform=function(){return rt.sceneGraphService.getLocalTransform(this)},e.prototype.getWorldTransform=function(){return rt.sceneGraphService.getWorldTransform(this)},e.prototype.setLocalTransform=function(t){return rt.sceneGraphService.setLocalTransform(this,t),this},e.prototype.resetLocalTransform=function(){rt.sceneGraphService.resetLocalTransform(this)},e.prototype.getAnimations=function(){return this.activeAnimations},e.prototype.animate=function(t,r){var i,a=(i=this.ownerDocument)===null||i===void 0?void 0:i.timeline;return a?a.play(this,t,r):null},e.prototype.isVisible=function(){var t,r;return rt.enableCSSParsing?((t=this.parsedStyle)===null||t===void 0?void 0:t.visibility)==="visible":((r=this.parsedStyle)===null||r===void 0?void 0:r.visibility)!=="hidden"},Object.defineProperty(e.prototype,"interactive",{get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"},enumerable:!1,configurable:!0}),e.prototype.isInteractive=function(){var t;return((t=this.parsedStyle)===null||t===void 0?void 0:t.pointerEvents)!=="none"},e.prototype.isCulled=function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)},e.prototype.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,K([],P(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})),!1))+1),this},e.prototype.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,K([],P(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})),!1))-1),this},e.prototype.getConfig=function(){return this.config},e.prototype.attr=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=P(r,2),o=a[0],s=a[1];return o?Ye(o)?(Object.keys(o).forEach(function(l){t.setAttribute(l,o[l])}),this):r.length===2?(this.setAttribute(o,s),this):this.attributes[o]:this.attributes},e.prototype.getMatrix=function(t){var r=t||this.getWorldTransform(),i=P(Qn(_.Ue(),r),2),a=i[0],o=i[1],s=P(He(_.Ue(),r),2),l=s[0],c=s[1],u=_n(Vt(),r),h=P(ev(_.Ue(),u),3),f=h[0],d=h[2];return kR(f||d,a,o,l,c)},e.prototype.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},e.prototype.setMatrix=function(t){var r=P(Ex(t),5),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];this.setEulerAngles(l).setPosition(i,a).setLocalScale(o,s)},e.prototype.setLocalMatrix=function(t){var r=P(Ex(t),5),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];this.setLocalEulerAngles(l).setLocalPosition(i,a).setLocalScale(o,s)},e.prototype.show=function(){rt.enableCSSParsing?this.style.visibility="visible":this.forEach(function(t){t.style.visibility="visible"})},e.prototype.hide=function(){rt.enableCSSParsing?this.style.visibility="hidden":this.forEach(function(t){t.style.visibility="hidden"})},e.prototype.getCount=function(){return this.childElementCount},e.prototype.getParent=function(){return this.parentElement},e.prototype.getChildren=function(){return this.children},e.prototype.getFirst=function(){return this.firstElementChild},e.prototype.getLast=function(){return this.lastElementChild},e.prototype.getChildByIndex=function(t){return this.children[t]||null},e.prototype.add=function(t,r){return this.appendChild(t,r)},e.prototype.set=function(t,r){this.config[t]=r},e.prototype.get=function(t){return this.config[t]},e.prototype.moveTo=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(t,r,i),this},e.prototype.move=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(t,r,i),this},e.prototype.setZIndex=function(t){return this.style.zIndex=t,this},e}(dL),Rh=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:Rt.CIRCLE},t))||this}return e}(Wr),yL=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);return r=n.call(this,N({style:rt.enableCSSParsing?N({},i):N({},i)},a))||this,r.isCustomElement=!0,r}return e}(Wr),yb=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:Rt.ELLIPSE},t))||this}return e}(Wr),jn=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:Rt.GROUP},t))||this}return e}(Wr),xb=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);return r=n.call(this,N({type:Rt.HTML,style:rt.enableCSSParsing?N({x:"",y:"",width:"auto",height:"auto",innerHTML:""},i):N({},i)},a))||this,r.cullable.enable=!1,r}return e.prototype.getDomElement=function(){return this.parsedStyle.$el},e.prototype.getBoundingClientRect=function(){if(this.parsedStyle.$el)return this.parsedStyle.$el.getBoundingClientRect();var t=this.parsedStyle,r=t.x,i=t.y,a=t.width,o=t.height;return new Yo(r,i,a,o)},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.getBounds=function(){var t,r,i=this.getBoundingClientRect(),a=(r=(t=this.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect(),o=new ir,s=i.left-((a==null?void 0:a.left)||0),l=i.top-((a==null?void 0:a.top)||0);return o.setMinMax([s,l,0],[s+i.width,l+i.height,0]),o},e.prototype.getLocalBounds=function(){if(this.parentNode){var t=Wt(Q(),this.parentNode.getWorldTransform()),r=this.getBounds();if(!ir.isEmpty(r)){var i=new ir;return i.setFromTransformedAABB(r,t),i}}return this.getBounds()},e}(Wr),bb=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:Rt.IMAGE},t))||this}return e}(Wr),Av=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);r=n.call(this,N({type:Rt.LINE,style:N({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},a))||this,r.markerStartAngle=0,r.markerEndAngle=0;var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd;return s&&Ke(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),l&&Ke(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="x1"||t==="y1"||t==="x2"||t==="y2"||t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&Ke(a)&&(this.markerStartAngle=0,a.remove()),o&&Ke(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"&&(a&&Ke(a)&&(this.markerEndAngle=0,a.remove()),o&&Ke(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1)))},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=r.x1,c=r.x2,u=r.y1,h=r.y2,f=t?i:a;if(!(!f||!Ke(f))){var d=0,p,v,g,m,x,S;t?(g=l,m=u,p=c-l,v=h-u,x=o||0,S=this.markerStartAngle):(g=c,m=h,p=l-c,v=u-h,x=s||0,S=this.markerEndAngle),d=Math.atan2(v,p),f.setLocalEulerAngles(d*180/Math.PI+S),f.setLocalPosition(g+Math.cos(d)*x,m+Math.sin(d)*x)}},e.prototype.getPoint=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle,a=i.x1,o=i.y1,s=i.x2,l=i.y2,c=Cr(a,o,s,l,t),u=c.x,h=c.y,f=_.fF(_.Ue(),_.al(u,h,0),r?this.getWorldTransform():this.getLocalTransform());return new ar(f[0],f[1])},e.prototype.getPointAtLength=function(t,r){return r===void 0&&(r=!1),this.getPoint(t/this.getTotalLength(),r)},e.prototype.getTotalLength=function(){var t=this.parsedStyle,r=t.x1,i=t.y1,a=t.x2,o=t.y2;return fs(r,i,a,o)},e}(Wr),kh=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);r=n.call(this,N({type:Rt.PATH,style:rt.enableCSSParsing?N({d:"",miterLimit:""},i):N({},i),initialParsedStyle:rt.enableCSSParsing?null:{miterLimit:4,d:N({},Ax)}},a))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd,c=o.markerMid;return s&&Ke(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),c&&Ke(c)&&r.placeMarkerMid(c),l&&Ke(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&Ke(a)&&(this.markerStartAngle=0,a.remove()),o&&Ke(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"?(a&&Ke(a)&&(this.markerEndAngle=0,a.remove()),o&&Ke(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(o)},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=t?i:a;if(!(!l||!Ke(l))){var c=0,u,h,f,d,p,v;if(t){var g=P(this.getStartTangent(),2),m=g[0],x=g[1];f=x[0],d=x[1],u=m[0]-x[0],h=m[1]-x[1],p=o||0,v=this.markerStartAngle}else{var S=P(this.getEndTangent(),2),m=S[0],x=S[1];f=x[0],d=x[1],u=m[0]-x[0],h=m[1]-x[1],p=s||0,v=this.markerEndAngle}c=Math.atan2(h,u),l.setLocalEulerAngles(c*180/Math.PI+v),l.setLocalPosition(f+Math.cos(c)*p,d+Math.sin(c)*p)}},e.prototype.placeMarkerMid=function(t){var r=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(c){c.remove()}),t&&Ke(t))for(var i=1;i<r.length-1;i++){var a=P(r[i].currentPoint,2),o=a[0],s=a[1],l=i===1?t:t.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(o,s)}},e.prototype.getTotalLength=function(){return zx(this)},e.prototype.getPointAtLength=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle.d.absolutePath,a=sd(i,t),o=a.x,s=a.y,l=_.fF(_.Ue(),_.al(o,s,0),r?this.getWorldTransform():this.getLocalTransform());return new ar(l[0],l[1])},e.prototype.getPoint=function(t,r){return r===void 0&&(r=!1),this.getPointAtLength(t*zx(this),r)},e.prototype.getStartTangent=function(){var t=this.parsedStyle.d.segments,r=[];if(t.length>1){var i=t[0].currentPoint,a=t[1].currentPoint,o=t[1].startTangent;r=[],o?(r.push([i[0]-o[0],i[1]-o[1]]),r.push([i[0],i[1]])):(r.push([a[0],a[1]]),r.push([i[0],i[1]]))}return r},e.prototype.getEndTangent=function(){var t=this.parsedStyle.d.segments,r=t.length,i=[];if(r>1){var a=t[r-2].currentPoint,o=t[r-1].currentPoint,s=t[r-1].endTangent;i=[],s?(i.push([o[0]-s[0],o[1]-s[1]]),i.push([o[0],o[1]])):(i.push([a[0],a[1]]),i.push([o[0],o[1]]))}return i},e}(Wr),Nv=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);r=n.call(this,N({type:Rt.POLYGON,style:rt.enableCSSParsing?N({points:"",miterLimit:"",isClosed:!0},i):N({},i),initialParsedStyle:rt.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},a))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd,c=o.markerMid;return s&&Ke(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),c&&Ke(c)&&r.placeMarkerMid(c),l&&Ke(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&Ke(a)&&(this.markerStartAngle=0,a.remove()),o&&Ke(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"?(a&&Ke(a)&&(this.markerEndAngle=0,a.remove()),o&&Ke(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(o)},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=r.points,c=(l||{}).points,u=t?i:a;if(!(!u||!Ke(u)||!c)){var h=0,f,d,p,v,g,m;if(p=c[0][0],v=c[0][1],t)f=c[1][0]-c[0][0],d=c[1][1]-c[0][1],g=o||0,m=this.markerStartAngle;else{var x=c.length;this.parsedStyle.isClosed?(f=c[x-1][0]-c[0][0],d=c[x-1][1]-c[0][1]):(p=c[x-1][0],v=c[x-1][1],f=c[x-2][0]-c[x-1][0],d=c[x-2][1]-c[x-1][1]),g=s||0,m=this.markerEndAngle}h=Math.atan2(d,f),u.setLocalEulerAngles(h*180/Math.PI+m),u.setLocalPosition(p+Math.cos(h)*g,v+Math.sin(h)*g)}},e.prototype.placeMarkerMid=function(t){var r=this.parsedStyle.points,i=(r||{}).points;if(this.markerMidList.forEach(function(c){c.remove()}),this.markerMidList=[],t&&Ke(t)&&i)for(var a=1;a<(this.parsedStyle.isClosed?i.length:i.length-1);a++){var o=i[a][0],s=i[a][1],l=a===1?t:t.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(o,s)}},e}(Wr),Eb=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=V(t,["style"]);return n.call(this,N({type:Rt.POLYLINE,style:rt.enableCSSParsing?N({points:"",miterLimit:"",isClosed:!1},r):N({},r),initialParsedStyle:rt.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i))||this}return e.prototype.getTotalLength=function(){return bk(this)},e.prototype.getPointAtLength=function(t,r){return r===void 0&&(r=!1),this.getPoint(t/this.getTotalLength(),r)},e.prototype.getPoint=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var a=[],o=0,s,l,c=this.getTotalLength();i.forEach(function(g,m){i[m+1]&&(s=[0,0],s[0]=o/c,l=fs(g[0],g[1],i[m+1][0],i[m+1][1]),o+=l,s[1]=o/c,a.push(s))}),this.parsedStyle.points.segments=a}var u=0,h=0;this.parsedStyle.points.segments.forEach(function(g,m){t>=g[0]&&t<=g[1]&&(u=(t-g[0])/(g[1]-g[0]),h=m)});var f=Cr(i[h][0],i[h][1],i[h+1][0],i[h+1][1],u),d=f.x,p=f.y,v=_.fF(_.Ue(),_.al(d,p,0),r?this.getWorldTransform():this.getLocalTransform());return new ar(v[0],v[1])},e.prototype.getStartTangent=function(){var t=this.parsedStyle.points.points,r=[];return r.push([t[1][0],t[1][1]]),r.push([t[0][0],t[0][1]]),r},e.prototype.getEndTangent=function(){var t=this.parsedStyle.points.points,r=t.length-1,i=[];return i.push([t[r-1][0],t[r-1][1]]),i.push([t[r][0],t[r][1]]),i},e}(Nv),Ko=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:Rt.RECT},t))||this}return e}(Wr),Rv=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=V(t,["style"]);return n.call(this,N({type:Rt.TEXT,style:rt.enableCSSParsing?N({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:"",lineHeight:"",miterLimit:"",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},r):N({fill:"black"},r)},i))||this}return e.prototype.getComputedTextLength=function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.maxLineWidth)||0},e.prototype.getLineBoundingRects=function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.lineMetrics)||[]},e.prototype.isOverflowing=function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing},e}(Wr),xL=function(){function n(){this.registry={},this.define(Rt.CIRCLE,Rh),this.define(Rt.ELLIPSE,yb),this.define(Rt.RECT,Ko),this.define(Rt.IMAGE,bb),this.define(Rt.LINE,Av),this.define(Rt.GROUP,jn),this.define(Rt.PATH,kh),this.define(Rt.POLYGON,Nv),this.define(Rt.POLYLINE,Eb),this.define(Rt.TEXT,Rv),this.define(Rt.HTML,xb)}return n.prototype.define=function(e,t){this.registry[e]=t},n.prototype.get=function(e){return this.registry[e]},n}(),xW={number:function(n){return new Ie(n)},percent:function(n){return new Ie(n,"%")},px:function(n){return new Ie(n,"px")},em:function(n){return new Ie(n,"em")},rem:function(n){return new Ie(n,"rem")},deg:function(n){return new Ie(n,"deg")},grad:function(n){return new Ie(n,"grad")},rad:function(n){return new Ie(n,"rad")},turn:function(n){return new Ie(n,"turn")},s:function(n){return new Ie(n,"s")},ms:function(n){return new Ie(n,"ms")},registerProperty:function(n){var e=n.name,t=n.inherits,r=n.interpolable,i=n.initialValue,a=n.syntax;rt.styleValueRegistry.registerMetadata({n:e,inh:t,int:r,d:i,syntax:a})},registerLayout:function(n,e){rt.layoutRegistry.registerLayout(n,e)}},bL=function(n){B(e,n);function e(){var t=n.call(this)||this;t.defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new rt.AnimationTimeline(t)}catch(i){}var r={};return bv.forEach(function(i){var a=i.n,o=i.inh,s=i.d;o&&s&&(r[a]=Ys(s)?s(Rt.GROUP):s)}),t.documentElement=new jn({id:"g-root",style:r}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),e.prototype.createElement=function(t,r){if(t==="svg")return this.documentElement;var i=this.defaultView.customElements.get(t);i||(console.warn("Unsupported tagName: ",t),i=t==="tspan"?Rv:jn);var a=new i(r);return a.ownerDocument=this,a},e.prototype.createElementNS=function(t,r,i){return this.createElement(r,i)},e.prototype.cloneNode=function(t){throw new Error(Le)},e.prototype.destroy=function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(t){}},e.prototype.elementsFromBBox=function(t,r,i,a){var o=this.defaultView.context.rBushRoot,s=o.search({minX:t,minY:r,maxX:i,maxY:a}),l=[];return s.forEach(function(c){var u=c.displayObject,h=u.parsedStyle.pointerEvents,f=h===void 0?"auto":h,d=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(f);(!d||d&&u.isVisible())&&!u.isCulled()&&u.isInteractive()&&l.push(u)}),l.sort(function(c,u){return u.sortable.renderOrder-c.sortable.renderOrder}),l},e.prototype.elementFromPointSync=function(t,r){var i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height;if(a<0||o<0||a>l||o>c)return null;var u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]}).picked;return d&&d[0]||this.documentElement},e.prototype.elementFromPoint=function(t,r){return j(this,void 0,void 0,function(){var i,a,o,s,l,c,u,h,f,d;return mt(this,function(p){switch(p.label){case 0:return i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height,a<0||o<0||a>l||o>c?[2,null]:(u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]})]);case 1:return d=p.sent().picked,[2,d&&d[0]||this.documentElement]}})})},e.prototype.elementsFromPointSync=function(t,r){var i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height;if(a<0||o<0||a>l||o>c)return[];var u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]}).picked;return d[d.length-1]!==this.documentElement&&d.push(this.documentElement),d},e.prototype.elementsFromPoint=function(t,r){return j(this,void 0,void 0,function(){var i,a,o,s,l,c,u,h,f,d;return mt(this,function(p){switch(p.label){case 0:return i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height,a<0||o<0||a>l||o>c?[2,[]]:(u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]})]);case 1:return d=p.sent().picked,d[d.length-1]!==this.documentElement&&d.push(this.documentElement),[2,d]}})})},e.prototype.appendChild=function(t,r){throw new Error(Vs)},e.prototype.insertBefore=function(t,r){throw new Error(Vs)},e.prototype.removeChild=function(t,r){throw new Error(Vs)},e.prototype.replaceChild=function(t,r,i){throw new Error(Vs)},e.prototype.append=function(){throw new Error(Vs)},e.prototype.prepend=function(){throw new Error(Vs)},e.prototype.getElementById=function(t){return this.documentElement.getElementById(t)},e.prototype.getElementsByName=function(t){return this.documentElement.getElementsByName(t)},e.prototype.getElementsByTagName=function(t){return this.documentElement.getElementsByTagName(t)},e.prototype.getElementsByClassName=function(t){return this.documentElement.getElementsByClassName(t)},e.prototype.querySelector=function(t){return this.documentElement.querySelector(t)},e.prototype.querySelectorAll=function(t){return this.documentElement.querySelectorAll(t)},e.prototype.find=function(t){return this.documentElement.find(t)},e.prototype.findAll=function(t){return this.documentElement.findAll(t)},e}(Xn),EL=function(){function n(e){this.strategies=e}return n.prototype.apply=function(e){var t=e.camera,r=e.renderingService,i=e.renderingContext,a=this.strategies;r.hooks.cull.tap(n.tag,function(o){if(o){var s=o.cullable;return a.length===0?s.visible=i.unculledEntities.indexOf(o.entity)>-1:s.visible=a.every(function(l){return l.isVisible(t,o)}),!o.isCulled()&&o.isVisible()?o:(o.dispatchEvent(new Ln(pe.CULLED)),null)}return o}),r.hooks.afterRender.tap(n.tag,function(o){o.cullable.visibilityPlaneMask=-1})},n.tag="Culling",n}(),wL=function(){function n(){var e=this;this.autoPreventDefault=!1,this.rootPointerEvent=new Cv(null),this.rootWheelEvent=new Ov(null),this.onPointerMove=function(t){var r,i,a,o,s=(o=(a=e.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||o===void 0?void 0:o.defaultView;if(!(s.supportsTouchEvents&&t.pointerType==="touch")){var l=e.normalizeToPointerEvent(t,s);try{for(var c=vt(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=e.bootstrapEvent(e.rootPointerEvent,h,s,t);e.context.eventService.mapEvent(f)}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var r,i,a,o,s=(o=(a=e.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||o===void 0?void 0:o.defaultView,l=e.normalizeToPointerEvent(t,s);try{for(var c=vt(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=e.bootstrapEvent(e.rootPointerEvent,h,s,t);e.context.eventService.mapEvent(f)}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}}return n.prototype.apply=function(e){var t=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(a){var o=t.context.renderingService.hooks.pickSync.call({position:a,picked:[],topmost:!0}).picked;return o[0]||null}),r.hooks.pointerWheel.tap(n.tag,function(a){var o=t.normalizeWheelEvent(a);t.context.eventService.mapEvent(o)}),r.hooks.pointerDown.tap(n.tag,function(a){var o,s;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var l=t.normalizeToPointerEvent(a,i);if(t.autoPreventDefault&&l[0].isNormalized){var c=a.cancelable||!("cancelable"in a);c&&a.preventDefault()}try{for(var u=vt(l),h=u.next();!h.done;h=u.next()){var f=h.value,d=t.bootstrapEvent(t.rootPointerEvent,f,i,a);t.context.eventService.mapEvent(d)}}catch(p){o={error:p}}finally{try{h&&!h.done&&(s=u.return)&&s.call(u)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerUp.tap(n.tag,function(a){var o,s;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var l=t.context.contextService.getDomElement(),c=t.context.eventService.isNativeEventFromCanvas(l,a),u=c?"":"outside",h=t.normalizeToPointerEvent(a,i);try{for(var f=vt(h),d=f.next();!d.done;d=f.next()){var p=d.value,v=t.bootstrapEvent(t.rootPointerEvent,p,i,a);v.type+=u,t.context.eventService.mapEvent(v)}}catch(g){o={error:g}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerMove.tap(n.tag,this.onPointerMove),r.hooks.pointerOver.tap(n.tag,this.onPointerMove),r.hooks.pointerOut.tap(n.tag,this.onPointerMove),r.hooks.click.tap(n.tag,this.onClick),r.hooks.pointerCancel.tap(n.tag,function(a){var o,s,l=t.normalizeToPointerEvent(a,i);try{for(var c=vt(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=t.bootstrapEvent(t.rootPointerEvent,h,i,a);t.context.eventService.mapEvent(f)}}catch(d){o={error:d}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)})},n.prototype.bootstrapEvent=function(e,t,r,i){e.view=r,e.originalEvent=null,e.nativeEvent=i,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);var a=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),o=a.x,s=a.y;e.viewport.x=o,e.viewport.y=s;var l=this.context.eventService.viewport2Canvas(e.viewport),c=l.x,u=l.y;return e.canvas.x=c,e.canvas.y=u,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=i.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=v3[e.type]||e.type),e},n.prototype.normalizeWheelEvent=function(e){var t=this.rootWheelEvent;this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;var r=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),i=r.x,a=r.y;t.viewport.x=i,t.viewport.y=a;var o=this.context.eventService.viewport2Canvas(t.viewport),s=o.x,l=o.y;return t.canvas.x=s,t.canvas.y=l,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.nativeEvent=e,t.type=e.type,t},n.prototype.transferMouseData=function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=_v.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null},n.prototype.setCursor=function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default")},n.prototype.normalizeToPointerEvent=function(e,t){var r=[];if(t.isTouchEvent(e))for(var i=0;i<e.changedTouches.length;i++){var a=e.changedTouches[i];yt(a.button)&&(a.button=0),yt(a.buttons)&&(a.buttons=1),yt(a.isPrimary)&&(a.isPrimary=e.touches.length===1&&e.type==="touchstart"),yt(a.width)&&(a.width=a.radiusX||1),yt(a.height)&&(a.height=a.radiusY||1),yt(a.tiltX)&&(a.tiltX=0),yt(a.tiltY)&&(a.tiltY=0),yt(a.pointerType)&&(a.pointerType="touch"),yt(a.pointerId)&&(a.pointerId=a.identifier||0),yt(a.pressure)&&(a.pressure=a.force||.5),yt(a.twist)&&(a.twist=0),yt(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,a.type=e.type,r.push(a)}else if(t.isMouseEvent(e)){var o=e;yt(o.isPrimary)&&(o.isPrimary=!0),yt(o.width)&&(o.width=1),yt(o.height)&&(o.height=1),yt(o.tiltX)&&(o.tiltX=0),yt(o.tiltY)&&(o.tiltY=0),yt(o.pointerType)&&(o.pointerType="mouse"),yt(o.pointerId)&&(o.pointerId=p3),yt(o.pressure)&&(o.pressure=.5),yt(o.twist)&&(o.twist=0),yt(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,r.push(o)}else r.push(e);return r},n.tag="Event",n}(),SL=[Rt.CIRCLE,Rt.ELLIPSE,Rt.IMAGE,Rt.RECT,Rt.LINE,Rt.POLYLINE,Rt.POLYGON,Rt.TEXT,Rt.PATH,Rt.HTML],_L=function(){function n(){}return n.prototype.isVisible=function(e,t){var r,i,a=t.cullable;if(!a.enable)return!0;var o=t.getRenderBounds();if(ir.isEmpty(o))return!1;var s=e.getFrustum(),l=(i=(r=t.parentNode)===null||r===void 0?void 0:r.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return a.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,o,l||ro.INDETERMINATE,s.planes),a.visible=a.visibilityPlaneMask!==ro.OUTSIDE,a.visible},n.prototype.computeVisibilityWithPlaneMask=function(e,t,r,i){if(r===ro.OUTSIDE||r===ro.INSIDE)return r;for(var a=ro.INSIDE,o=SL.indexOf(e.nodeName)>-1,s=0,l=i.length;s<l;++s){var c=1<<s;if(r&c&&!(o&&(s===4||s===5))){var u=i[s],h=u.normal,f=u.distance;if(_.AK(h,t.getPositiveFarPoint(i[s]))+f<0)return ro.OUTSIDE;_.AK(h,t.getNegativeFarPoint(i[s]))+f<0&&(a|=c)}}return a},n}(),TL=function(){function n(){this.toSync=new Set,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return n.prototype.apply=function(e){var t=this,r,i=e.renderingService,a=e.renderingContext,o=e.rBushRoot,s=a.root.ownerDocument.defaultView;this.rBush=o;var l=function(d){var p=d.target;p.renderable.dirty=!0,i.dirtify()},c=function(d){var p=d.detail.affectChildren,v=d.target;p&&v.forEach(function(m){t.toSync.add(m)});for(var g=v;g;)g.renderable&&t.toSync.add(g),g=g.parentElement;i.dirtify()},u=function(d){var p=d.target;rt.enableSizeAttenuation&&rt.styleValueRegistry.updateSizeAttenuation(p,s.getCamera().getZoom()),rt.enableCSSParsing&&rt.styleValueRegistry.recalc(p),rt.sceneGraphService.dirtifyToRoot(p),i.dirtify()},h=function(d){var p=d.target,v=p.rBushNode;v.aabb&&t.rBush.remove(v.aabb),t.toSync.delete(p),rt.sceneGraphService.dirtifyToRoot(p),i.dirtify()};i.hooks.init.tap(n.tag,function(){s.addEventListener(pe.MOUNTED,u),s.addEventListener(pe.UNMOUNTED,h),s.addEventListener(pe.ATTR_MODIFIED,l),s.addEventListener(pe.BOUNDS_CHANGED,c)}),i.hooks.destroy.tap(n.tag,function(){s.removeEventListener(pe.MOUNTED,u),s.removeEventListener(pe.UNMOUNTED,h),s.removeEventListener(pe.ATTR_MODIFIED,l),s.removeEventListener(pe.BOUNDS_CHANGED,c),t.toSync.clear()});var f=(r=rt.globalThis.requestIdleCallback)!==null&&r!==void 0?r:Tv.bind(rt.globalThis);i.hooks.endFrame.tap(n.tag,function(){t.isFirstTimeRendering?(t.isFirstTimeRendering=!1,t.syncing=!0,f(function(){t.syncRTree(!0),t.isFirstTimeRenderingFinished=!0})):t.syncRTree()})},n.prototype.syncRTree=function(e){var t=this;if(e===void 0&&(e=!1),!(!e&&(this.syncing||this.toSync.size===0))){this.syncing=!0;var r=[];Array.from(this.toSync).filter(function(i){return i.isConnected}).forEach(function(i){var a=i.rBushNode;a&&a.aabb&&t.rBush.remove(a.aabb);var o=i.getRenderBounds();if(o){var s=i.renderable;e&&(s.dirtyRenderBounds||(s.dirtyRenderBounds=new ir),s.dirtyRenderBounds.update(o.center,o.halfExtents));var l=P(o.getMin(),2),c=l[0],u=l[1],h=P(o.getMax(),2),f=h[0],d=h[1];a.aabb||(a.aabb={}),a.aabb.displayObject=i,a.aabb.minX=c,a.aabb.minY=u,a.aabb.maxX=f,a.aabb.maxY=d}a.aabb&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.minX)&&!isNaN(a.aabb.minY)&&r.push(a.aabb)}),this.rBush.load(r),r.length=0,this.toSync.clear(),this.syncing=!1}},n.tag="Prepare",n}();function bW(n){return!!n.document}var Yi;(function(n){n.READY="ready",n.BEFORE_RENDER="beforerender",n.RERENDER="rerender",n.AFTER_RENDER="afterrender",n.BEFORE_DESTROY="beforedestroy",n.AFTER_DESTROY="afterdestroy",n.RESIZE="resize",n.DIRTY_RECTANGLE="dirtyrectangle",n.RENDERER_CHANGED="rendererchanged"})(Yi||(Yi={}));var wb=500,PL=.1,ML=1e3,kv=new Ln(pe.MOUNTED),Lv=new Ln(pe.UNMOUNTED),Sb=new Ln(Yi.BEFORE_RENDER),CL=new Ln(Yi.RERENDER),_b=new Ln(Yi.AFTER_RENDER),EW=function(n){B(e,n);function e(t){var r=n.call(this)||this;r.Element=Wr,r.inited=!1,r.context={},r.document=new bL,r.document.defaultView=r,r.customElements=new xL;var i=t.container,a=t.canvas,o=t.offscreenCanvas,s=t.width,l=t.height,c=t.devicePixelRatio,u=t.renderer,h=t.background,f=t.cursor,d=t.document,p=t.requestAnimationFrame,v=t.cancelAnimationFrame,g=t.createImage,m=t.supportsPointerEvents,x=t.supportsTouchEvents,S=t.supportsCSSTransform,T=t.supportsMutipleCanvasesInOneContainer,b=t.useNativeClickEvent,y=t.alwaysTriggerPointerEventOnCanvas,E=t.isTouchEvent,w=t.isMouseEvent;T||l3(i,r);var C=s,M=l,O=c;return a&&(O=c||Sv&&window.devicePixelRatio||1,O=O>=1?Math.ceil(O):1,C=s||f3(a)||a.width/O,M=l||d3(a)||a.height/O),o&&(rt.offscreenCanvas=o),r.devicePixelRatio=O,r.requestAnimationFrame=p!=null?p:Tv.bind(rt.globalThis),r.cancelAnimationFrame=v!=null?v:sb.bind(rt.globalThis),r.supportsTouchEvents=x!=null?x:"ontouchstart"in rt.globalThis,r.supportsPointerEvents=m!=null?m:!!rt.globalThis.PointerEvent,r.isTouchEvent=E!=null?E:function(A){return r.supportsTouchEvents&&A instanceof rt.globalThis.TouchEvent},r.isMouseEvent=w!=null?w:function(A){return!rt.globalThis.MouseEvent||A instanceof rt.globalThis.MouseEvent&&(!r.supportsPointerEvents||!(A instanceof rt.globalThis.PointerEvent))},r.initRenderingContext({container:i,canvas:a,width:C,height:M,renderer:u,offscreenCanvas:o,devicePixelRatio:O,cursor:f||"default",background:h||"transparent",createImage:g,document:d,supportsCSSTransform:S,useNativeClickEvent:b,alwaysTriggerPointerEventOnCanvas:y}),r.initDefaultCamera(C,M,u.clipSpaceNearZ),r.initRenderer(u,!0),r}return e.prototype.initRenderingContext=function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}},e.prototype.initDefaultCamera=function(t,r,i){var a=this,o=new rt.CameraContribution;o.clipSpaceNearZ=i,o.setType(Se.EXPLORING,ec.DEFAULT).setPosition(t/2,r/2,wb).setFocalPoint(t/2,r/2,0).setOrthographic(t/-2,t/2,r/2,r/-2,PL,ML),o.canvas=this,o.eventEmitter.on(Sx.UPDATED,function(){a.context.renderingContext.renderReasons.add(qs.CAMERA_CHANGED),rt.enableSizeAttenuation&&a.getConfig().renderer.getConfig().enableSizeAttenuation&&a.updateSizeAttenuation()}),this.context.camera=o},e.prototype.updateSizeAttenuation=function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach(function(r){rt.styleValueRegistry.updateSizeAttenuation(r,t)})},e.prototype.getConfig=function(){return this.context.config},e.prototype.getRoot=function(){return this.document.documentElement},e.prototype.getCamera=function(){return this.context.camera},e.prototype.getContextService=function(){return this.context.contextService},e.prototype.getEventService=function(){return this.context.eventService},e.prototype.getRenderingService=function(){return this.context.renderingService},e.prototype.getRenderingContext=function(){return this.context.renderingContext},e.prototype.getStats=function(){return this.getRenderingService().getStats()},Object.defineProperty(e.prototype,"ready",{get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise(function(r){t.resolveReadyPromise=function(){r(t)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t,r){if(t===void 0&&(t=!0),r===void 0&&(r=!1),r||this.dispatchEvent(new Ln(Yi.BEFORE_DESTROY)),this.frameId){var i=this.getConfig().cancelAnimationFrame||cancelAnimationFrame;i(this.frameId)}var a=this.getRoot();this.unmountChildren(a),t&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),t&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),r||this.dispatchEvent(new Ln(Yi.AFTER_DESTROY))},e.prototype.changeSize=function(t,r){this.resize(t,r)},e.prototype.resize=function(t,r){var i=this.context.config;i.width=t,i.height=r,this.getContextService().resize(t,r);var a=this.context.camera,o=a.getProjectionMode();a.setPosition(t/2,r/2,wb).setFocalPoint(t/2,r/2,0),o===Br.ORTHOGRAPHIC?a.setOrthographic(t/-2,t/2,r/2,r/-2,a.getNear(),a.getFar()):a.setAspect(t/r),this.dispatchEvent(new Ln(Yi.RESIZE,{width:t,height:r}))},e.prototype.appendChild=function(t,r){return this.document.documentElement.appendChild(t,r)},e.prototype.insertBefore=function(t,r){return this.document.documentElement.insertBefore(t,r)},e.prototype.removeChild=function(t){return this.document.documentElement.removeChild(t)},e.prototype.removeChildren=function(){this.document.documentElement.removeChildren()},e.prototype.destroyChildren=function(){this.document.documentElement.destroyChildren()},e.prototype.render=function(t){var r=this;t&&(Sb.detail=t,_b.detail=t),this.dispatchEvent(Sb);var i=this.getRenderingService();i.render(this.getConfig(),t,function(){r.dispatchEvent(CL)}),this.dispatchEvent(_b)},e.prototype.run=function(){var t=this,r=function(i,a){t.render(a),t.frameId=t.requestAnimationFrame(r)};r()},e.prototype.initRenderer=function(t,r){var i=this;if(r===void 0&&(r=!1),!t)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new MR,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new wL,new TL,new EL([new _L])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService(N(N({},rt),this.context)),this.context.renderingService=new j3(rt,this.context),this.context.eventService=new Y3(rt,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,r,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(t,r)})},e.prototype.initRenderingService=function(t,r,i){var a=this;r===void 0&&(r=!1),i===void 0&&(i=!1),this.context.renderingService.init(function(){a.inited=!0,r?(i?a.requestAnimationFrame(function(){a.dispatchEvent(new Ln(Yi.READY))}):a.dispatchEvent(new Ln(Yi.READY)),a.readyPromise&&a.resolveReadyPromise()):a.dispatchEvent(new Ln(Yi.RENDERER_CHANGED)),r||a.getRoot().forEach(function(o){var s=o.renderable;s&&(s.renderBoundsDirty=!0,s.boundsDirty=!0,s.dirty=!0)}),a.mountChildren(a.getRoot()),t.getConfig().enableAutoRendering&&a.run()})},e.prototype.loadRendererContainerModule=function(t){var r=this,i=t.getPlugins();i.forEach(function(a){a.context=r.context,a.init(rt)})},e.prototype.setRenderer=function(t){var r=this.getConfig();if(r.renderer!==t){var i=r.renderer;r.renderer=t,this.destroy(!1,!0),K([],P(i==null?void 0:i.getPlugins()),!1).reverse().forEach(function(a){a.destroy(rt)}),this.initRenderer(t)}},e.prototype.setCursor=function(t){var r=this.getConfig();r.cursor=t,this.getContextService().applyCursorStyle(t)},e.prototype.unmountChildren=function(t){var r=this;t.childNodes.forEach(function(i){r.unmountChildren(i)}),this.inited&&(t.isMutationObserved?t.dispatchEvent(Lv):(Lv.target=t,this.dispatchEvent(Lv,!0)),t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1),t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()},e.prototype.mountChildren=function(t){var r=this;this.inited?t.isConnected||(t.ownerDocument=this.document,t.isConnected=!0,t.isMutationObserved?t.dispatchEvent(kv):(kv.target=t,this.dispatchEvent(kv,!0))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName),t.childNodes.forEach(function(i){r.mountChildren(i)}),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()},e.prototype.client2Viewport=function(t){return this.getEventService().client2Viewport(t)},e.prototype.viewport2Client=function(t){return this.getEventService().viewport2Client(t)},e.prototype.viewport2Canvas=function(t){return this.getEventService().viewport2Canvas(t)},e.prototype.canvas2Viewport=function(t){return this.getEventService().canvas2Viewport(t)},e.prototype.getPointByClient=function(t,r){return this.client2Viewport({x:t,y:r})},e.prototype.getClientByPoint=function(t,r){return this.viewport2Client({x:t,y:r})},e}(ub),OL=function(n){B(e,n);function e(){var t=n.apply(this,K([],P(arguments),!1))||this;return t.landmarks=[],t}return e.prototype.rotate=function(t,r,i){if(this.relElevation=Us(r),this.relAzimuth=Us(t),this.relRoll=Us(i),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===Se.EXPLORING){var a=kn(Vt(),[1,0,0],ke((this.rotateWorld?1:-1)*this.relElevation)),o=kn(Vt(),[0,1,0],ke((this.rotateWorld?1:-1)*this.relAzimuth)),s=kn(Vt(),[0,0,1],ke(this.relRoll)),l=An(Vt(),o,a);l=An(Vt(),l,s);var c=La(Q(),l);Ee(this.matrix,this.matrix,[0,0,-this.distance]),Ut(this.matrix,this.matrix,c),Ee(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===Se.ORBITING||this.type===Se.EXPLORING?this._getPosition():this.type===Se.TRACKING&&this._getFocalPoint(),this._update(),this},e.prototype.pan=function(t,r){var i=yr(t,r,0),a=_.d9(this.position);return _.IH(a,a,_.bA(_.Ue(),this.right,i[0])),_.IH(a,a,_.bA(_.Ue(),this.up,i[1])),this._setPosition(a),this.triggerUpdate(),this},e.prototype.dolly=function(t){var r=this.forward,i=_.d9(this.position),a=t*this.dollyingStep,o=this.distance+t*this.dollyingStep;return a=Math.max(Math.min(o,this.maxDistance),this.minDistance)-this.distance,i[0]+=a*r[0],i[1]+=a*r[1],i[2]+=a*r[2],this._setPosition(i),this.type===Se.ORBITING||this.type===Se.EXPLORING?this._getDistance():this.type===Se.TRACKING&&_.IH(this.focalPoint,i,this.distanceVector),this.triggerUpdate(),this},e.prototype.cancelLandmarkAnimation=function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)},e.prototype.createLandmark=function(t,r){var i,a,o,s;r===void 0&&(r={});var l=r.position,c=l===void 0?this.position:l,u=r.focalPoint,h=u===void 0?this.focalPoint:u,f=r.roll,d=r.zoom,p=new rt.CameraContribution;p.setType(this.type,void 0),p.setPosition(c[0],(i=c[1])!==null&&i!==void 0?i:this.position[1],(a=c[2])!==null&&a!==void 0?a:this.position[2]),p.setFocalPoint(h[0],(o=h[1])!==null&&o!==void 0?o:this.focalPoint[1],(s=h[2])!==null&&s!==void 0?s:this.focalPoint[2]),p.setRoll(f!=null?f:this.roll),p.setZoom(d!=null?d:this.zoom);var v={name:t,matrix:Bt(p.getWorldTransform()),right:_.d9(p.right),up:_.d9(p.up),forward:_.d9(p.forward),position:_.d9(p.getPosition()),focalPoint:_.d9(p.getFocalPoint()),distanceVector:_.d9(p.getDistanceVector()),distance:p.getDistance(),dollyingStep:p.getDollyingStep(),azimuth:p.getAzimuth(),elevation:p.getElevation(),roll:p.getRoll(),relAzimuth:p.relAzimuth,relElevation:p.relElevation,relRoll:p.relRoll,zoom:p.getZoom()};return this.landmarks.push(v),v},e.prototype.gotoLandmark=function(t,r){var i=this;r===void 0&&(r={});var a=qt(t)?this.landmarks.find(function(M){return M.name===t}):t;if(a){var o=te(r)?{duration:r}:r,s=o.easing,l=s===void 0?"linear":s,c=o.duration,u=c===void 0?100:c,h=o.easingFunction,f=h===void 0?void 0:h,d=o.onfinish,p=d===void 0?void 0:d,v=o.onframe,g=v===void 0?void 0:v,m=.01;this.cancelLandmarkAnimation();var x=a.position,S=a.focalPoint,T=a.zoom,b=a.roll,y=f||rt.EasingFunction(l),E,w=function(){i.setFocalPoint(S),i.setPosition(x),i.setRoll(b),i.setZoom(T),i.computeMatrix(),i.triggerUpdate(),p==null||p()};if(u===0)return w();var C=function(M){E===void 0&&(E=M);var O=M-E;if(O>=u){w();return}var A=y(O/u),R=_.Ue(),L=_.Ue(),z=1,Y=0;_.t7(R,i.focalPoint,S,A),_.t7(L,i.position,x,A),Y=i.roll*(1-A)+b*A,z=i.zoom*(1-A)+T*A,i.setFocalPoint(R),i.setPosition(L),i.setRoll(Y),i.setZoom(z);var I=_.TK(R,S)+_.TK(L,x);if(I<=m&&T==null&&b==null)return w();i.computeMatrix(),i.triggerUpdate(),O<u&&(g==null||g(A),i.landmarkAnimationID=i.canvas.requestAnimationFrame(C))};this.canvas.requestAnimationFrame(C)}},e}(Tx);rt.CameraContribution=OL;var Tb=function(){function n(e,t){this.type=e,this.target=t,this.addedNodes=[],this.attributeName=null,this.attributeNamespace=null,this.nextSibling=null,this.oldValue=null,this.previousSibling=null,this.removedNodes=[]}return n.copy=function(e){var t=new n(e.type,e.target);return t.addedNodes=e.addedNodes.slice(),t.removedNodes=e.removedNodes.slice(),t.previousSibling=e.previousSibling,t.nextSibling=e.nextSibling,t.attributeName=e.attributeName,t.attributeNamespace=e.attributeNamespace,t.oldValue=e.oldValue,t},n}(),AL=0,Js=new WeakMap,NL=function(){function n(e,t,r){this.observer=e,this.target=t,this.options=r,this.transientObservedNodes=[]}return n.prototype.enqueue=function(e){var t=this.observer.records,r=t.length;if(t.length>0){var i=t[r-1],a=IL(i,e);if(a){t[r-1]=a;return}}else BL(this.observer);t[r]=e},n.prototype.addListeners=function(){this.addListeners_(this.target)},n.prototype.addListeners_=function(e){var t=this.options;t.attributes&&e.addEventListener(pe.ATTR_MODIFIED,this,!0),t.childList&&e.addEventListener(pe.INSERTED,this,!0),(t.childList||t.subtree)&&e.addEventListener(pe.REMOVED,this,!0)},n.prototype.removeListeners=function(){this.removeListeners_(this.target)},n.prototype.removeListeners_=function(e){var t=this.options;t.attributes&&e.removeEventListener(pe.ATTR_MODIFIED,this,!0),t.childList&&e.removeEventListener(pe.INSERTED,this,!0),(t.childList||t.subtree)&&e.removeEventListener(pe.REMOVED,this,!0)},n.prototype.removeTransientObservers=function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(t){this.removeListeners_(t);for(var r=Js.get(t),i=0;i<r.length;i++)if(r[i]===this){r.splice(i,1);break}},this)},n.prototype.handleEvent=function(e){e.stopImmediatePropagation();var t,r;switch(e.type){case pe.ATTR_MODIFIED:var i=e.attrName,a=e.relatedNode.namespaceURI;r=e.target,t=Pb("attributes",r),t.attributeName=i,t.attributeNamespace=a;var o=e.attrChange===oo.ADDITION?null:e.prevValue;Mb(r,function(f){if(f.attributes&&!(f.attributeFilter&&f.attributeFilter.length&&f.attributeFilter.indexOf(i)===-1&&f.attributeFilter.indexOf(a)===-1))return f.attributeOldValue?RL(o):t});break;case pe.REMOVED:case pe.INSERTED:r=e.relatedNode;var s=e.target,l=void 0,c=void 0;e.type===pe.INSERTED?(l=[s],c=[]):(l=[],c=[s]);var u=s.previousSibling,h=s.nextSibling;t=Pb("childList",r),t.addedNodes=l,t.removedNodes=c,t.previousSibling=u,t.nextSibling=h,Mb(r,function(f){if(f.childList)return t})}kL()},n}(),wW=function(){function n(e){this.callback=e,this.nodes=[],this.records=[],this.uid=AL++}return n.prototype.observe=function(e,t){if(!t.childList&&!t.attributes&&!t.characterData||t.attributeOldValue&&!t.attributes||t.attributeFilter&&t.attributeFilter.length&&!t.attributes||t.characterDataOldValue&&!t.characterData)throw new SyntaxError;var r=Js.get(e);r||Js.set(e,r=[]);for(var i,a=0;a<r.length;a++)if(r[a].observer===this){i=r[a],i.removeListeners(),i.options=t;break}i||(i=new NL(this,e,t),r.push(i),this.nodes.push(e)),i.addListeners()},n.prototype.disconnect=function(){var e=this;this.nodes.forEach(function(t){for(var r=Js.get(t),i=0;i<r.length;i++){var a=r[i];if(a.observer===e){a.removeListeners(),r.splice(i,1);break}}},this),this.records=[]},n.prototype.takeRecords=function(){var e=this.records;return this.records=[],e},n}(),Lh,Oa;function Pb(n,e){return Lh=new Tb(n,e)}function RL(n){return Oa||(Oa=Tb.copy(Lh),Oa.oldValue=n,Oa)}function kL(){Lh=Oa=void 0}function LL(n){return n===Oa||n===Lh}function IL(n,e){return n===e?n:Oa&&LL(n)?Oa:null}function DL(n){n.nodes.forEach(function(e){var t=Js.get(e);t&&t.forEach(function(r){r.observer===n&&r.removeTransientObservers()})})}function Mb(n,e){for(var t=n;t;t=t.parentNode){var r=Js.get(t);if(r)for(var i=0;i<r.length;i++){var a=r[i],o=a.options;if(!(t!==n&&!o.subtree)){var s=e(o);s&&a.enqueue(s)}}}}var Iv=!1,Dv=[];function BL(n){Dv.push(n),Iv||(Iv=!0,typeof rt.globalThis!="undefined"?rt.globalThis.setTimeout(Bv):Bv())}function Bv(){Iv=!1;var n=Dv;Dv=[],n.sort(function(t,r){return t.uid-r.uid});var e=!1;n.forEach(function(t){var r=t.takeRecords();DL(t),r.length&&(t.callback(r,t),e=!0)}),e&&Bv()}var Fv=function(n){B(e,n);function e(t,r,i,a){var o=n.call(this,t)||this;return o.currentTime=i,o.timelineTime=a,o.target=r,o.type="finish",o.bubbles=!1,o.currentTarget=r,o.defaultPrevented=!1,o.eventPhase=o.AT_TARGET,o.timeStamp=Date.now(),o.currentTime=i,o.timelineTime=a,o}return e}(Nh),FL=0,GL=function(){function n(e,t){var r;this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=t,this.id="".concat(FL++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((r=this.effect)===null||r===void 0?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return Object.defineProperty(n.prototype,"pending",{get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playState",{get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ready",{get:function(){var e=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(t,r){e.resolveReadyPromise=function(){t(e)},e.rejectReadyPromise=function(){r(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"finished",{get:function(){var e=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(t,r){e.resolveFinishedPromise=function(){t(e)},e.rejectFinishedPromise=function(){r(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(e){var t;e=Number(e),!isNaN(e)&&(this.timeline.restart(),!this._paused&&this._startTime!==null&&(this._startTime=Number((t=this.timeline)===null||t===void 0?void 0:t.currentTime)-e/this.playbackRate),this.currentTimePending=!1,this._currentTime!==e&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(e,!0),this.timeline.applyDirtiedAnimation(this)))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"startTime",{get:function(){return this._startTime},set:function(e){if(e!==null){if(this.updatePromises(),e=Number(e),isNaN(e)||this._paused||this._idle)return;this._startTime=e,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(e){if(e!==this._playbackRate){this.updatePromises();var t=this.currentTime;this._playbackRate=e,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),t!==null&&(this.currentTime=t),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_isFinished",{get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"totalDuration",{get:function(){return this._totalDuration},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_needsTick",{get:function(){return this.pending||this.playState==="running"||!this._finishedFlag},enumerable:!1,configurable:!0}),n.prototype.updatePromises=function(){var e=this.oldPlayState,t=this.pending?"pending":this.playState;return this.readyPromise&&t!==e&&(t==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):e==="pending"?this.resolveReadyPromise():t==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&t!==e&&(t==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):t==="finished"?this.resolveFinishedPromise():e==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=t,this.readyPromise||this.finishedPromise},n.prototype.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()},n.prototype.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()},n.prototype.finish=function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},n.prototype.cancel=function(){var e=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var t=new Fv(null,this,this.currentTime,null);setTimeout(function(){e.oncancel(t)})}},n.prototype.reverse=function(){this.updatePromises();var e=this.currentTime;this.playbackRate*=-1,this.play(),e!==null&&(this.currentTime=e),this.updatePromises()},n.prototype.updatePlaybackRate=function(e){this.playbackRate=e},n.prototype.targetAnimations=function(){var e,t=(e=this.effect)===null||e===void 0?void 0:e.target;return t.getAnimations()},n.prototype.markTarget=function(){var e=this.targetAnimations();e.indexOf(this)===-1&&e.push(this)},n.prototype.unmarkTarget=function(){var e=this.targetAnimations(),t=e.indexOf(this);t!==-1&&e.splice(t,1)},n.prototype.tick=function(e,t){!this._idle&&!this._paused&&(this._startTime===null?t&&(this.startTime=e-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((e-this._startTime)*this.playbackRate)),t&&(this.currentTimePending=!1,this.fireEvents(e))},n.prototype.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")},n.prototype.persist=function(){throw new Error(Le)},n.prototype.addEventListener=function(e,t,r){throw new Error(Le)},n.prototype.removeEventListener=function(e,t,r){throw new Error(Le)},n.prototype.dispatchEvent=function(e){throw new Error(Le)},n.prototype.commitStyles=function(){throw new Error(Le)},n.prototype.ensureAlive=function(){var e,t;this.playbackRate<0&&this.currentTime===0?this._inEffect=!!(!((e=this.effect)===null||e===void 0)&&e.update(-1)):this._inEffect=!!(!((t=this.effect)===null||t===void 0)&&t.update(this.currentTime)),!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))},n.prototype.tickCurrentTime=function(e,t){e!==this._currentTime&&(this._currentTime=e,this._isFinished&&!t&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())},n.prototype.fireEvents=function(e){var t=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var r=new Fv(null,this,this.currentTime,e);setTimeout(function(){t.onfinish&&t.onfinish(r)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var i=new Fv(null,this,this.currentTime,e);this.onframe(i)}this._finishedFlag=!1}},n}(),zL=4,WL=.001,UL=1e-7,VL=10,oc=11,Ih=1/(oc-1),HL=typeof Float32Array=="function",Cb=function(n,e){return 1-3*e+3*n},Ob=function(n,e){return 3*e-6*n},Ab=function(n){return 3*n},Dh=function(n,e,t){return((Cb(e,t)*n+Ob(e,t))*n+Ab(e))*n},Nb=function(n,e,t){return 3*Cb(e,t)*n*n+2*Ob(e,t)*n+Ab(e)},YL=function(n,e,t,r,i){var a,o,s=0;do o=e+(t-e)/2,a=Dh(o,r,i)-n,a>0?t=o:e=o;while(Math.abs(a)>UL&&++s<VL);return o},XL=function(n,e,t,r){for(var i=0;i<zL;++i){var a=Nb(e,t,r);if(a===0)return e;var o=Dh(e,t,r)-n;e-=o/a}return e},Gv=function(n,e,t,r){if(!(0<=n&&n<=1&&0<=t&&t<=1))throw new Error("bezier x values must be in [0, 1] range");if(n===e&&t===r)return function(s){return s};for(var i=HL?new Float32Array(oc):new Array(oc),a=0;a<oc;++a)i[a]=Dh(a*Ih,n,t);var o=function(s){for(var l=0,c=1,u=oc-1;c!==u&&i[c]<=s;++c)l+=Ih;--c;var h=(s-i[c])/(i[c+1]-i[c]),f=l+h*Ih,d=Nb(f,n,t);return d>=WL?XL(s,f,n,t):d===0?f:YL(s,l,l+Ih,n,t)};return function(s){return s===0||s===1?s:Dh(o(s),e,r)}},jL=function(n){return n=n.replace(/([A-Z])/g,function(e){return"-".concat(e.toLowerCase())}),n.charAt(0)==="-"?n.substring(1):n},Bh=function(n){return Math.pow(n,2)},Fh=function(n){return Math.pow(n,3)},Gh=function(n){return Math.pow(n,4)},zh=function(n){return Math.pow(n,5)},Wh=function(n){return Math.pow(n,6)},Uh=function(n){return 1-Math.cos(n*Math.PI/2)},Vh=function(n){return 1-Math.sqrt(1-n*n)},Hh=function(n){return n*n*(3*n-2)},Yh=function(n){for(var e,t=4;n<((e=Math.pow(2,--t))-1)/11;);return 1/Math.pow(4,3-t)-7.5625*Math.pow((e*3-2)/22-n,2)},Xh=function(n,e){e===void 0&&(e=[]);var t=P(e,2),r=t[0],i=r===void 0?1:r,a=t[1],o=a===void 0?.5:a,s=he(Number(i),1,10),l=he(Number(o),.1,2);return n===0||n===1?n:-s*Math.pow(2,10*(n-1))*Math.sin((n-1-l/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/l)},sc=function(n,e,t){e===void 0&&(e=[]);var r=P(e,4),i=r[0],a=i===void 0?1:i,o=r[1],s=o===void 0?100:o,l=r[2],c=l===void 0?10:l,u=r[3],h=u===void 0?0:u;a=he(a,.1,1e3),s=he(s,.1,1e3),c=he(c,.1,1e3),h=he(h,.1,1e3);var f=Math.sqrt(s/a),d=c/(2*Math.sqrt(s*a)),p=d<1?f*Math.sqrt(1-d*d):0,v=1,g=d<1?(d*f+-h)/p:-h+f,m=t?t*n/1e3:n;return d<1?m=Math.exp(-m*d*f)*(v*Math.cos(p*m)+g*Math.sin(p*m)):m=(v+g*m)*Math.exp(-m*f),n===0||n===1?n:1-m},zv=function(n,e){e===void 0&&(e=[]);var t=P(e,2),r=t[0],i=r===void 0?10:r,a=t[1],o=a=="start"?Math.ceil:Math.floor;return o(he(n,0,1)*i)/i},Rb=function(n,e){e===void 0&&(e=[]);var t=P(e,4),r=t[0],i=t[1],a=t[2],o=t[3];return Gv(r,i,a,o)(n)},jh=Gv(.42,0,1,1),Ni=function(n){return function(e,t,r){return t===void 0&&(t=[]),1-n(1-e,t,r)}},Ri=function(n){return function(e,t,r){return t===void 0&&(t=[]),e<.5?n(e*2,t,r)/2:1-n(e*-2+2,t,r)/2}},ki=function(n){return function(e,t,r){return t===void 0&&(t=[]),e<.5?(1-n(1-e*2,t,r))/2:(n(e*2-1,t,r)+1)/2}},kb={steps:zv,"step-start":function(n){return zv(n,[1,"start"])},"step-end":function(n){return zv(n,[1,"end"])},linear:function(n){return n},"cubic-bezier":Rb,ease:function(n){return Rb(n,[.25,.1,.25,1])},in:jh,out:Ni(jh),"in-out":Ri(jh),"out-in":ki(jh),"in-quad":Bh,"out-quad":Ni(Bh),"in-out-quad":Ri(Bh),"out-in-quad":ki(Bh),"in-cubic":Fh,"out-cubic":Ni(Fh),"in-out-cubic":Ri(Fh),"out-in-cubic":ki(Fh),"in-quart":Gh,"out-quart":Ni(Gh),"in-out-quart":Ri(Gh),"out-in-quart":ki(Gh),"in-quint":zh,"out-quint":Ni(zh),"in-out-quint":Ri(zh),"out-in-quint":ki(zh),"in-expo":Wh,"out-expo":Ni(Wh),"in-out-expo":Ri(Wh),"out-in-expo":ki(Wh),"in-sine":Uh,"out-sine":Ni(Uh),"in-out-sine":Ri(Uh),"out-in-sine":ki(Uh),"in-circ":Vh,"out-circ":Ni(Vh),"in-out-circ":Ri(Vh),"out-in-circ":ki(Vh),"in-back":Hh,"out-back":Ni(Hh),"in-out-back":Ri(Hh),"out-in-back":ki(Hh),"in-bounce":Yh,"out-bounce":Ni(Yh),"in-out-bounce":Ri(Yh),"out-in-bounce":ki(Yh),"in-elastic":Xh,"out-elastic":Ni(Xh),"in-out-elastic":Ri(Xh),"out-in-elastic":ki(Xh),spring:sc,"spring-in":sc,"spring-out":Ni(sc),"spring-in-out":Ri(sc),"spring-out-in":ki(sc)},$L=function(n){return jL(n).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},KL=function(n){return kb[$L(n)]||kb.linear},ZL=function(n){return n},qL=1,JL=.5,Lb=0;function Ib(n,e){return function(t){if(t>=1)return 1;var r=1/n;return t+=e*r,t-t%r}}var $h="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",QL=new RegExp("cubic-bezier\\("+$h+","+$h+","+$h+","+$h+"\\)"),tI=/steps\(\s*(\d+)\s*\)/,eI=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function Wv(n){var e=QL.exec(n);if(e)return Gv.apply(void 0,K([],P(e.slice(1).map(Number)),!1));var t=tI.exec(n);if(t)return Ib(Number(t[1]),Lb);var r=eI.exec(n);return r?Ib(Number(r[1]),{start:qL,middle:JL,end:Lb}[r[2]]):KL(n)}function nI(n){return Math.abs(rI(n)/(n.playbackRate||1))}function rI(n){var e;return n.duration===0||n.iterations===0?0:(n.duration==="auto"?0:Number(n.duration))*((e=n.iterations)!==null&&e!==void 0?e:1)}var Db=0,Uv=1,Kh=2,Bb=3;function iI(n,e,t){if(e===null)return Db;var r=t.endTime;return e<Math.min(t.delay,r)?Uv:e>=Math.min(t.delay+n+t.endDelay,r)?Kh:Bb}function aI(n,e,t,r,i){switch(r){case Uv:return e==="backwards"||e==="both"?0:null;case Bb:return t-i;case Kh:return e==="forwards"||e==="both"?n:null;case Db:return null}}function oI(n,e,t,r,i){var a=i;return n===0?e!==Uv&&(a+=t):a+=r/n,a}function sI(n,e,t,r,i,a){var o=n===1/0?e%1:n%1;return o===0&&t===Kh&&r!==0&&(i!==0||a===0)&&(o=1),o}function lI(n,e,t,r){return n===Kh&&e===1/0?1/0:t===1?Math.floor(r)-1:Math.floor(r)}function cI(n,e,t){var r=n;if(n!=="normal"&&n!=="reverse"){var i=e;n==="alternate-reverse"&&(i+=1),r="normal",i!==1/0&&i%2!==0&&(r="reverse")}return r==="normal"?t:1-t}function uI(n,e,t){var r=iI(n,e,t),i=aI(n,t.fill,e,r,t.delay);if(i===null)return null;var a=t.duration==="auto"?0:t.duration,o=oI(a,r,t.iterations,i,t.iterationStart),s=sI(o,t.iterationStart,r,t.iterations,i,a),l=lI(r,t.iterations,s,o),c=cI(t.direction,l,s);return t.currentIteration=l,t.progress=c,t.easingFunction(c)}function hI(n,e,t){var r=fI(n,e),i=dI(r,t);return function(a,o){if(o!==null)i.filter(function(l){return o>=l.applyFrom&&o<l.applyTo}).forEach(function(l){var c=o-l.startOffset,u=l.endOffset-l.startOffset,h=u===0?0:c/u;a.setAttribute(l.property,l.interpolation(h),!1,!1)});else for(var s in r)Fb(s)&&a.setAttribute(s,null)}}function Fb(n){return n!=="offset"&&n!=="easing"&&n!=="composite"&&n!=="computedOffset"}function fI(n,e){for(var t={},r=0;r<n.length;r++)for(var i in n[r])if(Fb(i)){var a={offset:n[r].offset,computedOffset:n[r].computedOffset,easing:n[r].easing,easingFunction:Wv(n[r].easing)||e.easingFunction,value:n[r][i]};t[i]=t[i]||[],t[i].push(a)}return t}function dI(n,e){var t=[];for(var r in n)for(var i=n[r],a=0;a<i.length-1;a++){var o=a,s=a+1,l=i[o].computedOffset,c=i[s].computedOffset,u=l,h=c;a===0&&(u=-1/0,c===0&&(s=o)),a===i.length-2&&(h=1/0,l===1&&(o=s)),t.push({applyFrom:u,applyTo:h,startOffset:i[o].computedOffset,endOffset:i[s].computedOffset,easingFunction:i[o].easingFunction,property:r,interpolation:pI(r,i[o].value,i[s].value,e)})}return t.sort(function(f,d){return f.startOffset-d.startOffset}),t}var Gb=function(n,e,t){return function(r){var i=zb(n,e,r);return!rt.enableCSSParsing&&te(i)?i:t(i)}};function pI(n,e,t,r){var i=ao[n];if(i&&i.syntax&&i.int){var a=rt.styleValueRegistry.getPropertySyntax(i.syntax);if(a){var o=void 0,s=void 0;if(rt.enableCSSParsing){var l=rt.styleValueRegistry.parseProperty(n,e,r,!1),c=rt.styleValueRegistry.parseProperty(n,t,r,!1);o=rt.styleValueRegistry.computeProperty(n,l,r,!1),s=rt.styleValueRegistry.computeProperty(n,c,r,!1)}else{var u=a.parserWithCSSDisabled;o=u?u(e,r):e,s=u?u(t,r):t}var h=a.mixer(o,s,r);if(h){var f=Gb.apply(void 0,K([],P(h),!1));return function(d){return d===0?e:d===1?t:f(d)}}}}return Gb(!1,!0,function(d){return d?t:e})}function zb(n,e,t){if(typeof n=="number"&&typeof e=="number")return n*(1-t)+e*t;if(typeof n=="boolean"&&typeof e=="boolean"||typeof n=="string"&&typeof e=="string")return t<.5?n:e;if(Array.isArray(n)&&Array.isArray(e)){for(var r=n.length,i=e.length,a=Math.max(r,i),o=[],s=0;s<a;s++)o.push(zb(n[s<r?s:r-1],e[s<i?s:i-1],t));return o}throw new Error("Mismatched interpolation arguments "+n+":"+e)}var vI=function(){function n(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=ZL,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return Object.defineProperty(n.prototype,"easing",{get:function(){return this._easing},set:function(e){this.easingFunction=Wv(e),this._easing=e},enumerable:!1,configurable:!0}),n}();function gI(n){var e=[];for(var t in n)if(!(t in["easing","offset","composite"])){var r=n[t];Array.isArray(r)||(r=[r]);for(var i=r.length,a=0;a<i;a++){if(!e[a]){var o={};"offset"in n&&(o.offset=Number(n.offset)),"easing"in n&&(o.easing=n.easing),"composite"in n&&(o.composite=n.composite),e[a]=o}r[a]!==void 0&&r[a]!==null&&(e[a][t]=r[a])}}return e.sort(function(s,l){return(s.computedOffset||0)-(l.computedOffset||0)}),e}function Wb(n,e){if(n===null)return[];Array.isArray(n)||(n=gI(n));for(var t=n.map(function(l){var c={};e!=null&&e.composite&&(c.composite="auto");for(var u in l){var h=l[u];if(u==="offset"){if(h!==null){if(h=Number(h),!isFinite(h))throw new Error("Keyframe offsets must be numbers.");if(h<0||h>1)throw new Error("Keyframe offsets must be between 0 and 1.");c.computedOffset=h}}else if(u==="composite"&&["replace","add","accumulate","auto"].indexOf(h)===-1)throw new Error("".concat(h," compositing is not supported"));c[u]=h}return c.offset===void 0&&(c.offset=null),c.easing===void 0&&(c.easing=(e==null?void 0:e.easing)||"linear"),c.composite===void 0&&(c.composite="auto"),c}),r=!0,i=-1/0,a=0;a<t.length;a++){var o=t[a].offset;if(pt(o))r=!1;else{if(o<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=o}}t=t.filter(function(l){return Number(l.offset)>=0&&Number(l.offset)<=1});function s(){var l,c,u=t.length;t[u-1].computedOffset=Number((l=t[u-1].offset)!==null&&l!==void 0?l:1),u>1&&(t[0].computedOffset=Number((c=t[0].offset)!==null&&c!==void 0?c:0));for(var h=0,f=Number(t[0].computedOffset),d=1;d<u;d++){var p=t[d].computedOffset;if(!pt(p)&&!pt(f)){for(var v=1;v<d-h;v++)t[h+v].computedOffset=f+(Number(p)-f)*v/(d-h);h=d,f=Number(p)}}}return r||s(),t}var mI="backwards|forwards|both|none".split("|"),yI="reverse|alternate|alternate-reverse".split("|");function xI(n,e){var t=new vI;return e&&(t.fill="both",t.duration="auto"),typeof n=="number"&&!isNaN(n)?t.duration=n:n!==void 0&&Object.keys(n).forEach(function(r){if(n[r]!==void 0&&n[r]!==null&&n[r]!=="auto"){if((typeof t[r]=="number"||r==="duration")&&(typeof n[r]!="number"||isNaN(n[r]))||r==="fill"&&mI.indexOf(n[r])===-1||r==="direction"&&yI.indexOf(n[r])===-1)return;t[r]=n[r]}}),t}function bI(n,e){return n=EI(n!=null?n:{duration:"auto"}),xI(n,e)}function EI(n){return typeof n=="number"&&(isNaN(n)?n={duration:"auto"}:n={duration:n}),n}var wI=function(){function n(e,t,r){var i=this;this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=bI(r,!1),this.timing.effect=this,this.timing.activeDuration=nI(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Wb(t,this.timing),this.interpolations=hI(this.normalizedKeyframes,this.timing,this.target);var a=rt.globalThis.Proxy;this.computedTiming=a?new a(this.timing,{get:function(o,s){return s==="duration"?o.duration==="auto"?0:o.duration:s==="fill"?o.fill==="auto"?"none":o.fill:s==="localTime"?i.animation&&i.animation.currentTime||null:s==="currentIteration"?!i.animation||i.animation.playState!=="running"?null:o.currentIteration||0:s==="progress"?!i.animation||i.animation.playState!=="running"?null:o.progress||0:o[s]},set:function(){return!0}}):this.timing}return n.prototype.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},n.prototype.update=function(e){return e===null?!1:(this.timeFraction=uI(this.timing.activeDuration,e,this.timing),this.timeFraction!==null)},n.prototype.getKeyframes=function(){return this.normalizedKeyframes},n.prototype.setKeyframes=function(e){this.normalizedKeyframes=Wb(e)},n.prototype.getComputedTiming=function(){return this.computedTiming},n.prototype.getTiming=function(){return this.timing},n.prototype.updateTiming=function(e){var t=this;Object.keys(e||{}).forEach(function(r){t.timing[r]=e[r]})},n}();function Ub(n,e){return Number(n.id)-Number(e.id)}var SI=function(){function n(e){var t=this;this.document=e,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(r){t.currentTime=r,t.discardAnimations(),t.animations.length===0?t.timelineTicking=!1:t.requestAnimationFrame(t.webAnimationsNextTick)},this.processRafCallbacks=function(r){var i=t.rafCallbacks;t.rafCallbacks=[],r<Number(t.currentTime)&&(r=Number(t.currentTime)),t.animations.sort(Ub),t.animations=t.tick(r,!0,t.animations)[0],i.forEach(function(a){a[1](r)}),t.applyPendingEffects()}}return n.prototype.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},n.prototype.isTicking=function(){return this.inTick},n.prototype.play=function(e,t,r){var i=new wI(e,t,r),a=new GL(i,this);return this.animations.push(a),this.restartWebAnimationsNextTick(),a.updatePromises(),a.play(),a.updatePromises(),a},n.prototype.applyDirtiedAnimation=function(e){var t=this;if(!this.inTick){e.markTarget();var r=e.targetAnimations();r.sort(Ub);var i=this.tick(Number(this.currentTime),!1,r.slice())[1];i.forEach(function(a){var o=t.animations.indexOf(a);o!==-1&&t.animations.splice(o,1)}),this.applyPendingEffects()}},n.prototype.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},n.prototype.destroy=function(){this.document.defaultView.cancelAnimationFrame(this.frameId)},n.prototype.applyPendingEffects=function(){this.pendingEffects.forEach(function(e){e==null||e.applyInterpolations()}),this.pendingEffects=[]},n.prototype.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(e){return e.updatePromises()})},n.prototype.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(e){return e.playState!=="finished"&&e.playState!=="idle"})},n.prototype.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},n.prototype.rAF=function(e){var t=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([t,e]),t},n.prototype.requestAnimationFrame=function(e){var t=this;return this.rAF(function(r){t.updateAnimationsPromises(),e(r),t.updateAnimationsPromises()})},n.prototype.tick=function(e,t,r){var i,a,o=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=e,this.ticking=!1;var s=[],l=[],c=[],u=[];return r.forEach(function(h){h.tick(e,t),h._inEffect?(l.push(h.effect),h.markTarget()):(s.push(h.effect),h.unmarkTarget()),h._needsTick&&(o.ticking=!0);var f=h._inEffect||h._needsTick;h._inTimeline=f,f?c.push(h):u.push(h)}),(i=this.pendingEffects).push.apply(i,K([],P(s),!1)),(a=this.pendingEffects).push.apply(a,K([],P(l),!1)),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[c,u]},n}();rt.EasingFunction=Wv,rt.AnimationTimeline=SI;var fn=function(){function n(e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=e,this.y=t,this.width=r,this.height=i}return Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),n.fromRect=function(e){return new n(e.x,e.y,e.width,e.height)},n.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},n.prototype.isPointIn=function(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom},n}();function SW(n){var e=n.getRenderBounds(),t=__read(e.min,2),r=t[0],i=t[1],a=__read(e.max,2),o=a[0],s=a[1],l=o-r,c=s-i;return new fn(r,i,l,c)}function Vb(n){for(var e=1/0,t=1/0,r=-1/0,i=-1/0,a=0;a<n.length;a++){var o=n[a],s=o.x,l=o.y,c=o.width,u=o.height,h=P([s+c,l+u],2),f=h[0],d=h[1];s<e&&(e=s),l<t&&(t=l),f>r&&(r=f),d>i&&(i=d)}return new fn(e,t,r-e,i-t)}var _I=function(n,e,t){var r=n.width,i=n.height,a=t.flexDirection,o=a===void 0?"row":a,s=t.flexWrap,l=s===void 0?"nowrap":s,c=t.justifyContent,u=c===void 0?"flex-start":c,h=t.alignContent,f=h===void 0?"flex-start":h,d=t.alignItems,p=d===void 0?"flex-start":d,v=o==="row",g=o==="row"||o==="column",m=v?g?[1,0]:[-1,0]:g?[0,1]:[0,-1],x=P([0,0],2),S=x[0],T=x[1],b=e.map(function(R){var L,z=R.width,Y=R.height,I=P([S,T],2),q=I[0],J=I[1];return L=P([S+z*m[0],T+Y*m[1]],2),S=L[0],T=L[1],new fn(q,J,z,Y)}),y=Vb(b),E={"flex-start":0,"flex-end":v?r-y.width:i-y.height,center:v?(r-y.width)/2:(i-y.height)/2},w=b.map(function(R){var L=R.x,z=R.y,Y=fn.fromRect(R);return Y.x=v?L+E[u]:L,Y.y=v?z:z+E[u],Y}),C=Vb(w),M=function(R){var L=P(v?["height",i]:["width",r],2),z=L[0],Y=L[1];switch(p){case"flex-start":return 0;case"flex-end":return Y-R[z];case"center":return Y/2-R[z]/2;default:return 0}},O=w.map(function(R){var L=R.x,z=R.y,Y=fn.fromRect(R);return Y.x=v?L:L+M(Y),Y.y=v?z+M(Y):z,Y}),A=O.map(function(R){var L,z,Y=fn.fromRect(R);return Y.x+=(L=n.x)!==null&&L!==void 0?L:0,Y.y+=(z=n.y)!==null&&z!==void 0?z:0,Y});return A},TI=function(n,e,t){return[]},PI=function(n,e,t){if(e.length===0)return[];var r={flex:_I,grid:TI},i=t.display in r?r[t.display]:null;return(i==null?void 0:i.call(null,n,e,t))||[]};function Mn(n){if(te(n))return[n,n,n,n];if(tr(n)){var e=n.length;if(e===1)return[n[0],n[0],n[0],n[0]];if(e===2)return[n[0],n[1],n[0],n[1]];if(e===3)return[n[0],n[1],n[2],n[1]];if(e===4)return n}return[0,0,0,0]}var MI=function(n){B(e,n);function e(t){var r=n.call(this,t)||this;r.layoutEvents=[pe.BOUNDS_CHANGED,pe.INSERTED,pe.REMOVED],r.$margin=Mn(0),r.$padding=Mn(0);var i=t.style||{},a=i.margin,o=a===void 0?0:a,s=i.padding,l=s===void 0?0:s;return r.margin=o,r.padding=l,r.isMutationObserved=!0,r.bindEvents(),r}return Object.defineProperty(e.prototype,"margin",{get:function(){return this.$margin},set:function(t){this.$margin=Mn(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return this.$padding},set:function(t){this.$padding=Mn(t)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t=this.attributes,r=t.x,i=r===void 0?0:r,a=t.y,o=a===void 0?0:a,s=t.width,l=t.height,c=P(this.$margin,4),u=c[0],h=c[1],f=c[2],d=c[3];return new fn(i-d,o-u,s+d+h,l+u+f)},e.prototype.appendChild=function(t,r){return t.isMutationObserved=!0,n.prototype.appendChild.call(this,t,r),t},e.prototype.getAvailableSpace=function(){var t=this.attributes,r=t.width,i=t.height,a=P(this.$padding,4),o=a[0],s=a[1],l=a[2],c=a[3],u=P(this.$margin,4),h=u[0],f=u[3];return new fn(c+f,o+h,r-c-s,i-o-l)},e.prototype.layout=function(){if(!(!this.attributes.display||!this.isConnected)&&!this.children.some(function(o){return!o.isConnected}))try{var t=this.attributes,r=t.x,i=t.y;this.style.transform="translate(".concat(r,", ").concat(i,")");var a=PI(this.getAvailableSpace(),this.children.map(function(o){return o.getBBox()}),this.attributes);this.children.forEach(function(o,s){var l=a[s],c=l.x,u=l.y;o.style.transform="translate(".concat(c,", ").concat(u,")")})}catch(o){}},e.prototype.bindEvents=function(){var t=this;this.layoutEvents.forEach(function(r){t.addEventListener(r,function(i){i.target.isMutationObserved=!0,t.layout()})})},e.prototype.attributeChangedCallback=function(t,r,i){t==="margin"?this.margin=i:t==="padding"&&(this.padding=i),this.layout()},e}(jn);function Hb(n,e){e(n),n.children&&n.children.forEach(function(t){t&&Hb(t,e)})}function lc(n){Zh(n,!0)}function Xi(n){Zh(n,!1)}function Zh(n,e){var t=e?"visible":"hidden";Hb(n,function(r){r.attr("visibility",t)})}var CI=5,Yb=function(n,e,t,r){t===void 0&&(t=0),r===void 0&&(r=CI),Object.entries(e).forEach(function(i){var a=P(i,2),o=a[0],s=a[1],l=n;Object.prototype.hasOwnProperty.call(e,o)&&(s?Ps(s)?(Ps(n[o])||(l[o]={}),t<r?Yb(n[o],s,t+1,r):l[o]=e[o]):tr(s)?(l[o]=[],l[o]=l[o].concat(s)):l[o]=s:l[o]=s)})},Fn=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r+=1)Yb(n,e[r]);return n},OI=function(n){B(e,n);function e(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=n.apply(this,K([],P(t),!1))||this;return i.isMutationObserved=!0,i.addEventListener(pe.INSERTED,function(){Xi(i)}),i}return e}(jn);function Xb(n){var e=n.appendChild(new OI({class:"offscreen"}));return Xi(e),e}function AI(n){for(var e=n;e;){if(e.className==="offscreen")return!0;e=e.parent}return!1}function NI(){Zh(this,this.attributes.visibility!=="hidden")}var bn=function(n){B(e,n);function e(t,r){r===void 0&&(r={});var i=n.call(this,Fn({},{style:r},t))||this;return i.initialized=!1,i._defaultOptions=r,i}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=Xb(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},e.prototype.disconnectedCallback=function(){var t;(t=this._offscreen)===null||t===void 0||t.destroy()},e.prototype.attributeChangedCallback=function(t){t==="visibility"&&NI.call(this)},e.prototype.update=function(t,r){var i;return this.attr(Fn({},this.attributes,t||{})),(i=this.render)===null||i===void 0?void 0:i.call(this,this.attributes,this,r)},e.prototype.clear=function(){this.removeChildren()},e.prototype.bindEvents=function(t,r){},e.prototype.getSubShapeStyle=function(t){var r=t.x,i=t.y,a=t.transform,o=t.transformOrigin,s=t.class,l=t.className,c=t.zIndex,u=V(t,["x","y","transform","transformOrigin","class","className","zIndex"]);return u},e}(yL);function Vv(n){return n.toString().charAt(0).toUpperCase()+n.toString().slice(1)}function RI(n){return n.toString().charAt(0).toLowerCase()+n.toString().slice(1)}function kI(n,e){return"".concat(e).concat(Vv(n))}function jb(n,e,t){var r;t===void 0&&(t=!0);var i=e||((r=n.match(/^([a-z][a-z0-9]+)/))===null||r===void 0?void 0:r[0])||"",a=n.replace(new RegExp("^(".concat(i,")")),"");return t?RI(a):a}function LI(n,e){Object.entries(e).forEach(function(t){var r=P(t,2),i=r[0],a=r[1];K([n],P(n.querySelectorAll(i)),!1).filter(function(o){return o.matches(i)}).forEach(function(o){if(o){var s=o;s.style.cssText+=Object.entries(a).reduce(function(l,c){return"".concat(l).concat(c.join(":"),";")},"")}})})}var qh=function(n,e){if(!(n!=null&&n.startsWith(e)))return!1;var t=n[e.length];return t>="A"&&t<="Z"};function ee(n,e,t){t===void 0&&(t=!1);var r={};return Object.entries(n).forEach(function(i){var a=P(i,2),o=a[0],s=a[1];if(!(o==="className"||o==="class")){if(qh(o,"show")&&qh(jb(o,"show"),e)!==t)o===kI(e,"show")?r[o]=s:r[o.replace(new RegExp(Vv(e)),"")]=s;else if(!qh(o,"show")&&qh(o,e)!==t){var l=jb(o,e);l==="filter"&&typeof s=="function"||(r[l]=s)}}}),r}function Qs(n,e){return Object.entries(n).reduce(function(t,r){var i=P(r,2),a=i[0],o=i[1];return a.startsWith("show")?t["show".concat(e).concat(a.slice(4))]=o:t["".concat(e).concat(Vv(a))]=o,t},{})}function Aa(n,e){e===void 0&&(e=["x","y","class","className"]);var t=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],r={},i={};return Object.entries(n).forEach(function(a){var o=P(a,2),s=o[0],l=o[1];e.includes(s)||(t.indexOf(s)!==-1?i[s]=l:r[s]=l)}),[r,i]}var Hv=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=V(t,["style"]);return n.call(this,N({style:N({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},r)},i))||this}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=Xb(this)),this._offscreen},enumerable:!1,configurable:!0}),e.prototype.disconnectedCallback=function(){var t;(t=this._offscreen)===null||t===void 0||t.destroy()},e}(Rv);function II(n,e){var t=new Map;return n.forEach(function(r){var i=e(r);t.has(i)||t.set(i,[]),t.get(i).push(r)}),t}function DI(n){throw new Error(n)}var BI=function(){function n(i,a,o,s,l,c,u){i===void 0&&(i=null),a===void 0&&(a=null),o===void 0&&(o=null),s===void 0&&(s=null),l===void 0&&(l=[null,null,null,null,null]),c===void 0&&(c=[]),u===void 0&&(u=[]),e.add(this),this._elements=Array.from(i),this._data=a,this._parent=o,this._document=s,this._enter=l[0],this._update=l[1],this._exit=l[2],this._merge=l[3],this._split=l[4],this._transitions=c,this._facetElements=u}n.prototype.selectAll=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i):i;return new t(a,null,this._elements[0],this._document)},n.prototype.selectFacetAll=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i):i;return new t(this._elements,null,this._parent,this._document,void 0,void 0,a)},n.prototype.select=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i)[0]||null:i;return new t([a],null,a,this._document)},n.prototype.append=function(i){var a=this,o=typeof i=="function"?i:function(){return a.createElement(i)},s=[];if(this._data!==null){for(var l=0;l<this._data.length;l++){var c=this._data[l],u=P(Array.isArray(c)?c:[c,null],2),h=u[0],f=u[1],d=o(h,l);d.__data__=h,f!==null&&(d.__fromElements__=f),this._parent.appendChild(d),s.push(d)}return new t(s,null,this._parent,this._document)}for(var l=0;l<this._elements.length;l++){var p=this._elements[l],h=p.__data__,d=o(h,l);p.appendChild(d),s.push(d)}return new t(s,null,s[0],this._document)},n.prototype.maybeAppend=function(i,a){var o=In(this,e,"m",r).call(this,i[0]==="#"?i:"#".concat(i),a);return o.attr("id",i),o},n.prototype.maybeAppendByClassName=function(i,a){var o=i.toString(),s=In(this,e,"m",r).call(this,o[0]==="."?o:".".concat(o),a);return s.attr("className",o),s},n.prototype.maybeAppendByName=function(i,a){var o=In(this,e,"m",r).call(this,'[name="'.concat(i,'"]'),a);return o.attr("name",i),o},n.prototype.data=function(i,a,o){var s,l;a===void 0&&(a=function(M){return M}),o===void 0&&(o=function(){return null});for(var c=[],u=[],h=new Set(this._elements),f=[],d=new Set,p=new Map(this._elements.map(function(M,O){return[a(M.__data__,O),M]})),v=new Map(this._facetElements.map(function(M,O){return[a(M.__data__,O),M]})),g=II(this._elements,function(M){return o(M.__data__)}),m=0;m<i.length;m++){var x=i[m],S=a(x,m),T=o(x,m);if(p.has(S)){var b=p.get(S);b.__data__=x,b.__facet__=!1,u.push(b),h.delete(b),p.delete(S)}else if(v.has(S)){var b=v.get(S);b.__data__=x,b.__facet__=!0,u.push(b),v.delete(S)}else if(g.has(S)){var y=g.get(S);f.push([x,y]);try{for(var E=(s=void 0,vt(y)),w=E.next();!w.done;w=E.next()){var b=w.value;h.delete(b)}}catch(M){s={error:M}}finally{try{w&&!w.done&&(l=E.return)&&l.call(E)}finally{if(s)throw s.error}}g.delete(S)}else if(p.has(T)){var b=p.get(T);b.__toData__?b.__toData__.push(x):b.__toData__=[x],d.add(b),h.delete(b)}else c.push(x)}var C=[new t([],c,this._parent,this._document),new t(u,null,this._parent,this._document),new t(h,null,this._parent,this._document),new t([],f,this._parent,this._document),new t(d,null,this._parent,this._document)];return new t(this._elements,null,this._parent,this._document,C)},n.prototype.merge=function(i){var a=K(K([],P(this._elements),!1),P(i._elements),!1),o=K(K([],P(this._transitions),!1),P(i._transitions),!1);return new t(a,null,this._parent,this._document,void 0,o)},n.prototype.createElement=function(i){if(this._document)return this._document.createElement(i,{});var a=t.registry[i];return a?new a:DI("Unknown node type: ".concat(i))},n.prototype.join=function(i,a,o,s,l){i===void 0&&(i=function(p){return p}),a===void 0&&(a=function(p){return p}),o===void 0&&(o=function(p){return p.remove()}),s===void 0&&(s=function(p){return p}),l===void 0&&(l=function(p){return p.remove()});var c=i(this._enter),u=a(this._update),h=o(this._exit),f=s(this._merge),d=l(this._split);return u.merge(c).merge(h).merge(f).merge(d)},n.prototype.remove=function(){for(var i=function(s){var l=a._elements[s],c=a._transitions[s];c?c.then(function(){return l.remove()}):l.remove()},a=this,o=0;o<this._elements.length;o++)i(o);return new t([],null,this._parent,this._document,void 0,this._transitions)},n.prototype.each=function(i){for(var a=0;a<this._elements.length;a++){var o=this._elements[a],s=o.__data__;i.call(o,s,a)}return this},n.prototype.attr=function(i,a){var o=typeof a!="function"?function(){return a}:a;return this.each(function(s,l){a!==void 0&&(this[i]=o.call(this,s,l))})},n.prototype.style=function(i,a,o){o===void 0&&(o=!0);var s=typeof a!="function"||!o?function(){return a}:a;return this.each(function(l,c){a!==void 0&&(this.style[i]=s.call(this,l,c))})},n.prototype.styles=function(i,a){return i===void 0&&(i={}),a===void 0&&(a=!0),this.each(function(o,s){var l=this;Object.entries(i).forEach(function(c){var u=P(c,2),h=u[0],f=u[1],d=typeof f!="function"||!a?function(){return f}:f;f!==void 0&&l.attr(h,d.call(l,o,s))})})},n.prototype.update=function(i,a){a===void 0&&(a=!0);var o=typeof i!="function"||!a?function(){return i}:i;return this.each(function(s,l){i&&this.update&&this.update(o.call(this,s,l))})},n.prototype.maybeUpdate=function(i,a){a===void 0&&(a=!0);var o=typeof i!="function"||!a?function(){return i}:i;return this.each(function(s,l){i&&this.update&&this.update(o.call(this,s,l))})},n.prototype.transition=function(i){var a=this._transitions;return this.each(function(o,s){a[s]=i.call(this,o,s)})},n.prototype.on=function(i,a){return this.each(function(){this.addEventListener(i,a)}),this},n.prototype.call=function(i){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];return i.call.apply(i,K([this._parent,this],P(a),!1)),this},n.prototype.node=function(){return this._elements[0]},n.prototype.nodes=function(){return this._elements},n.prototype.transitions=function(){return this._transitions.filter(function(i){return!!i})},n.prototype.parent=function(){return this._parent};var e,t,r;return t=n,e=new WeakSet,r=function(a,o){var s=this._elements[0],l=s.querySelector(a);if(l)return new t([l],null,this._parent,this._document);var c=typeof o=="string"?this.createElement(o):o();return s.appendChild(c),new t([c],null,this._parent,this._document)},n.registry={g:jn,rect:Ko,circle:Rh,path:kh,text:Hv,ellipse:yb,image:bb,line:Av,polygon:Nv,polyline:Eb,html:xb},n}();function Lt(n){return new BI([n],null,n,n.ownerDocument)}function FI(n,e,t){return n.querySelector(e)?Lt(n).select(e):Lt(n).append(t)}var ji=function(n,e){var t=function(i){return"".concat(e,"-").concat(i)},r=Object.fromEntries(Object.entries(n).map(function(i){var a=P(i,2),o=a[0],s=a[1],l=t(s);return[o,{name:l,class:".".concat(l),id:"#".concat(l),toString:function(){return l}}]}));return Object.assign(r,{prefix:t}),r};function li(n,e,t,r,i){return r===void 0&&(r=!0),i===void 0&&(i=function(a){a.node().removeChildren()}),n?t(e):(r&&i(e),null)}var $b=ji({text:"text"},"title");function Jh(n){return/\S+-\S+/g.test(n)?n.split("-").map(function(e){return e[0]}):n.length>2?[n[0]]:n.split("")}function GI(n,e){var t=n.attributes,r=t.position,i=t.spacing,a=t.inset,o=t.text,s=n.getBBox(),l=e.getBBox(),c=Jh(r),u=P(Mn(o?i:0),4),h=u[0],f=u[1],d=u[2],p=u[3],v=P(Mn(a),4),g=v[0],m=v[1],x=v[2],S=v[3],T=P([p+f,h+d],2),b=T[0],y=T[1],E=P([S+m,g+x],2),w=E[0],C=E[1];if(c[0]==="l")return new fn(s.x,s.y,l.width+s.width+b+w,Math.max(l.height+C,s.height));if(c[0]==="t")return new fn(s.x,s.y,Math.max(l.width+w,s.width),l.height+s.height+y+C);var M=P([e.attributes.width||l.width,e.attributes.height||l.height],2),O=M[0],A=M[1];return new fn(l.x,l.y,O+s.width+b+w,A+s.height+y+C)}function zI(n,e){var t=Object.entries(e).reduce(function(r,i){var a=P(i,2),o=a[0],s=a[1],l=n.node().attr(o);return l||(r[o]=s),r},{});n.styles(t)}function WI(n){var e,t,r,i,a=n,o=a.width,s=a.height,l=a.position,c=P([+o/2,+s/2],2),u=c[0],h=c[1],f=P([+u,+h,"center","middle"],4),d=f[0],p=f[1],v=f[2],g=f[3],m=Jh(l);return m.includes("l")&&(e=P([0,"start"],2),d=e[0],v=e[1]),m.includes("r")&&(t=P([+o,"end"],2),d=t[0],v=t[1]),m.includes("t")&&(r=P([0,"top"],2),p=r[0],g=r[1]),m.includes("b")&&(i=P([+s,"bottom"],2),p=i[0],g=i[1]),{x:d,y:p,textAlign:v,textBaseline:g}}var UI=function(n){B(e,n);function e(t){return n.call(this,t,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return e.prototype.getAvailableSpace=function(){var t=this,r=this.attributes,i=r.width,a=r.height,o=r.position,s=r.spacing,l=r.inset,c=t.querySelector($b.text.class);if(!c)return new fn(0,0,+i,+a);var u=c.getBBox(),h=u.width,f=u.height,d=P(Mn(s),4),p=d[0],v=d[1],g=d[2],m=d[3],x=P([0,0,+i,+a],4),S=x[0],T=x[1],b=x[2],y=x[3],E=Jh(o);if(E.includes("i"))return new fn(S,T,b,y);E.forEach(function(Y,I){var q,J,wt,Ft;Y==="t"&&(q=P(I===0?[f+g,+a-f-g]:[0,+a],2),T=q[0],y=q[1]),Y==="r"&&(J=P([+i-h-m],1),b=J[0]),Y==="b"&&(wt=P([+a-f-p],1),y=wt[0]),Y==="l"&&(Ft=P(I===0?[h+v,+i-h-v]:[0,+i],2),S=Ft[0],b=Ft[1])});var w=P(Mn(l),4),C=w[0],M=w[1],O=w[2],A=w[3],R=P([A+M,C+O],2),L=R[0],z=R[1];return new fn(S+A,T+C,b-L,y-z)},e.prototype.getBBox=function(){return this.title?this.title.getBBox():new fn(0,0,0,0)},e.prototype.render=function(t,r){var i=this,a=t.width,o=t.height,s=t.position,l=t.spacing,c=V(t,["width","height","position","spacing"]),u=P(Aa(c),1),h=u[0],f=WI(t),d=f.x,p=f.y,v=f.textAlign,g=f.textBaseline;li(!!c.text,Lt(r),function(m){i.title=m.maybeAppendByClassName($b.text,"text").styles(h).call(zI,{x:d,y:p,textAlign:v,textBaseline:g}).node()})},e}(bn),Yv=function(){};function Li(n,e){return jt(n)?n.apply(void 0,K([],P(e),!1)):n}function VI(n,e){return n.reduce(function(t,r){return(t[r[e]]=t[r[e]]||[]).push(r),t},{})}function HI(n){return typeof n=="boolean"?!1:"enter"in n&&"update"in n&&"exit"in n}function Kb(n){if(!n)return{enter:!1,update:!1,exit:!1};var e=["enter","update","exit"],t=Object.fromEntries(Object.entries(n).filter(function(r){var i=P(r,1),a=i[0];return!e.includes(a)}));return Object.fromEntries(e.map(function(r){return HI(n)?n[r]===!1?[r,!1]:[r,N(N({},n[r]),t)]:[r,t]}))}function tl(n,e){n?n.finished.then(e):e()}function YI(n,e){n.length===0?e():Promise.all(n.map(function(t){return t==null?void 0:t.finished})).then(e)}function Zb(n,e){"update"in n?n.update(e):n.attr(e)}function qb(n,e,t){if(e.length===0)return null;if(!t){var r=e.slice(-1)[0];return Zb(n,{style:r}),null}return n.animate(e,t)}function XI(n,e){return!(n.nodeName!=="text"||e.nodeName!=="text"||n.attributes.text!==e.attributes.text)}function jI(n,e,t,r){if(r===void 0&&(r="destroy"),XI(n,e))return n.remove(),[null];var i=function(){r==="destroy"?n.destroy():r==="hide"&&Xi(n),e.isVisible()&&lc(e)};if(!t)return i(),[null];var a=t.duration,o=a===void 0?0:a,s=t.delay,l=s===void 0?0:s,c=Math.ceil(+o/2),u=+o/4,h=P(n.getGeometryBounds().center,2),f=h[0],d=h[1],p=P(e.getGeometryBounds().center,2),v=p[0],g=p[1],m=P([(f+v)/2-f,(d+g)/2-d],2),x=m[0],S=m[1],T=n.style.opacity,b=T===void 0?1:T,y=e.style.opacity,E=y===void 0?1:y,w=n.style.transform||"",C=e.style.transform||"",M=n.animate([{opacity:b,transform:"translate(0, 0) ".concat(w)},{opacity:0,transform:"translate(".concat(x,", ").concat(S,") ").concat(w)}],N(N({fill:"both"},t),{duration:l+c+u})),O=e.animate([{opacity:0,transform:"translate(".concat(-x,", ").concat(-S,") ").concat(C),offset:.01},{opacity:E,transform:"translate(0, 0) ".concat(C)}],N(N({fill:"both"},t),{duration:c+u,delay:l+c-u}));return tl(O,i),[M,O]}function $i(n,e,t){var r={},i={};return Object.entries(e).forEach(function(a){var o=P(a,2),s=o[0],l=o[1];if(!pt(l)){var c=n.style[s]||n.parsedStyle[s]||0;c!==l&&(r[s]=c,i[s]=l)}}),t?qb(n,[r,i],N({fill:"both"},t)):(Zb(n,i),null)}function $I(n){var e;return((e=n[0])===null||e===void 0?void 0:e.map(function(t,r){return n.map(function(i){return i[r]})}))||[]}function Xv(n,e,t){t===void 0&&(t=!1);var r=n.getBBox(),i=r.width,a=r.height,o=e/Math.max(i,a);return t&&(n.style.transform="scale(".concat(o,")")),o}var Jb=function(n,e,t){return[["M",n-t,e],["A",t,t,0,1,0,n+t,e],["A",t,t,0,1,0,n-t,e],["Z"]]},KI=Jb,ZI=function(n,e,t){return[["M",n-t,e-t],["L",n+t,e-t],["L",n+t,e+t],["L",n-t,e+t],["Z"]]},qI=function(n,e,t){return[["M",n-t,e],["L",n,e-t],["L",n+t,e],["L",n,e+t],["Z"]]},JI=function(n,e,t){var r=t*Math.sin(.3333333333333333*Math.PI);return[["M",n-t,e+r],["L",n,e-r],["L",n+t,e+r],["Z"]]},QI=function(n,e,t){var r=t*Math.sin(.3333333333333333*Math.PI);return[["M",n-t,e-r],["L",n+t,e-r],["L",n,e+r],["Z"]]},tD=function(n,e,t){var r=t/2*Math.sqrt(3);return[["M",n,e-t],["L",n+r,e-t/2],["L",n+r,e+t/2],["L",n,e+t],["L",n-r,e+t/2],["L",n-r,e-t/2],["Z"]]},eD=function(n,e,t){var r=t-1.5;return[["M",n-t,e-r],["L",n+t,e+r],["L",n+t,e-r],["L",n-t,e+r],["Z"]]},Qb=function(n,e,t){return[["M",n,e+t],["L",n,e-t]]},nD=function(n,e,t){return[["M",n-t,e-t],["L",n+t,e+t],["M",n+t,e-t],["L",n-t,e+t]]},rD=function(n,e,t){return[["M",n-t/2,e-t],["L",n+t/2,e-t],["M",n,e-t],["L",n,e+t],["M",n-t/2,e+t],["L",n+t/2,e+t]]},iD=function(n,e,t){return[["M",n-t,e],["L",n+t,e],["M",n,e-t],["L",n,e+t]]},aD=function(n,e,t){return[["M",n-t,e],["L",n+t,e]]},tE=function(n,e,t){return[["M",n-t,e],["L",n+t,e]]},oD=tE,sD=function(n,e,t){return[["M",n-t,e],["A",t/2,t/2,0,1,1,n,e],["A",t/2,t/2,0,1,0,n+t,e]]},lD=function(n,e,t){return[["M",n-t-1,e-2.5],["L",n,e-2.5],["L",n,e+2.5],["L",n+t+1,e+2.5]]},cD=function(n,e,t){return[["M",n-t-1,e+2.5],["L",n,e+2.5],["L",n,e-2.5],["L",n+t+1,e-2.5]]},uD=function(n,e,t){return[["M",n-(t+1),e+2.5],["L",n-t/2,e+2.5],["L",n-t/2,e-2.5],["L",n+t/2,e-2.5],["L",n+t/2,e+2.5],["L",n+t+1,e+2.5]]};function hD(n,e){return[["M",n-5,e+2.5],["L",n-5,e],["L",n,e],["L",n,e-3],["L",n,e+3],["L",n+6.5,e+3]]}var fD=function(n,e,t){return[["M",n-t,e-t],["L",n+t,e],["L",n-t,e+t],["Z"]]},Ii=ji({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),dD=function(n){B(e,n);function e(t){var r=n.call(this,t,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:fD(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(i,a){return"".concat(i,"/").concat(a)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return r.playState="idle",r.contentGroup=r.appendChild(new jn({class:Ii.contentGroup.name})),r.playWindow=r.contentGroup.appendChild(new jn({class:Ii.playWindow.name})),r.innerCurrPage=r.defaultPage,r}return Object.defineProperty(e.prototype,"defaultPage",{get:function(){var t=this.attributes.defaultPage;return he(t,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var t=this.pageViews,r=P($I(t.map(function(h){var f=h.getBBox(),d=f.width,p=f.height;return[d,p]})).map(function(h){return Math.max.apply(Math,K([],P(h),!1))}),2),i=r[0],a=r[1],o=this.attributes,s=o.pageWidth,l=s===void 0?i:s,c=o.pageHeight,u=c===void 0?a:c;return{pageWidth:l,pageHeight:u}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t=n.prototype.getBBox.call(this),r=t.x,i=t.y,a=this.controllerShape,o=this.pageShape,s=o.pageWidth,l=o.pageHeight;return new fn(r,i,s+a.width,l)},e.prototype.goTo=function(t){var r=this,i=this.attributes.animate,a=this,o=a.currPage,s=a.playState,l=a.playWindow,c=a.pageViews;if(s!=="idle"||t<0||c.length<=0||t>=c.length)return null;c[o].setLocalPosition(0,0),this.prepareFollowingPage(t);var u=P(this.getFollowingPageDiff(t),2),h=u[0],f=u[1];this.playState="running";var d=qb(l,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-h,", ").concat(-f,")")}],i);return tl(d,function(){r.innerCurrPage=t,r.playState="idle",r.setVisiblePages([t]),r.updatePageInfo()}),d},e.prototype.prev=function(){var t=this.attributes.loop,r=this.pageViews.length,i=this.currPage;if(!t&&i<=0)return null;var a=t?(i-1+r)%r:he(i-1,0,r);return this.goTo(a)},e.prototype.next=function(){var t=this.attributes.loop,r=this.pageViews.length,i=this.currPage;if(!t&&i>=r-1)return null;var a=t?(i+1)%r:he(i+1,0,r);return this.goTo(a)},e.prototype.renderClipPath=function(t){var r=this.pageShape,i=r.pageWidth,a=r.pageHeight;if(!i||!a){this.contentGroup.style.clipPath=void 0;return}this.clipPath=t.maybeAppendByClassName(Ii.clipPath,"rect").styles({width:i,height:a}),this.contentGroup.attr("clipPath",this.clipPath.node())},e.prototype.setVisiblePages=function(t){this.playWindow.children.forEach(function(r,i){t.includes(i)?lc(r):Xi(r)})},e.prototype.adjustControllerLayout=function(){var t=this,r=t.prevBtnGroup,i=t.nextBtnGroup,a=t.pageInfoGroup,o=this.attributes,s=o.orientation,l=o.controllerPadding,c=a.getBBox(),u=c.width,h=c.height,f=P(s==="horizontal"?[-180,0]:[-90,90],2),d=f[0],p=f[1];r.setLocalEulerAngles(d),i.setLocalEulerAngles(p);var v=r.getBBox(),g=v.width,m=v.height,x=i.getBBox(),S=x.width,T=x.height,b=Math.max(g,u,S),y=s==="horizontal"?{offset:[[0,0],[g/2+l,0],[g+u+l*2,0]],textAlign:"start"}:{offset:[[b/2,-m-l],[b/2,0],[b/2,T+l]],textAlign:"center"},E=P(y.offset,3),w=P(E[0],2),C=w[0],M=w[1],O=P(E[1],2),A=O[0],R=O[1],L=P(E[2],2),z=L[0],Y=L[1],I=y.textAlign,q=a.querySelector("text");q&&(q.style.textAlign=I),r.setLocalPosition(C,M),a.setLocalPosition(A,R),i.setLocalPosition(z,Y)},e.prototype.updatePageInfo=function(){var t,r=this,i=r.currPage,a=r.pageViews,o=r.attributes.formatter;a.length<2||((t=this.pageInfoGroup.querySelector(Ii.pageInfo.class))===null||t===void 0||t.attr("text",o(i+1,a.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(t){var r=this.currPage;if(r===t)return[0,0];var i=this.attributes.orientation,a=this.pageShape,o=a.pageWidth,s=a.pageHeight,l=t<r?-1:1;return i==="horizontal"?[l*o,0]:[0,l*s]},e.prototype.prepareFollowingPage=function(t){var r=this,i=r.currPage,a=r.pageViews;if(this.setVisiblePages([t,i]),t!==i){var o=P(this.getFollowingPageDiff(t),2),s=o[0],l=o[1];a[t].setLocalPosition(s,l)}},e.prototype.renderController=function(t){var r=this,i=this.attributes.controllerSpacing,a=this.pageShape,o=a.pageWidth,s=a.pageHeight,l=this.pageViews.length>=2,c=t.maybeAppendByClassName(Ii.controller,"g");if(Zh(c.node(),l),!!l){var u=ee(this.attributes,"button"),h=ee(this.attributes,"pageNum"),f=P(Aa(u),2),d=f[0],p=f[1],v=d.size,g=V(d,["size"]),m=!c.select(Ii.prevBtnGroup.class).node(),x=c.maybeAppendByClassName(Ii.prevBtnGroup,"g").styles(p);this.prevBtnGroup=x.node();var S=x.maybeAppendByClassName(Ii.prevBtn,"path"),T=c.maybeAppendByClassName(Ii.nextBtnGroup,"g").styles(p);this.nextBtnGroup=T.node();var b=T.maybeAppendByClassName(Ii.nextBtn,"path");[S,b].forEach(function(E){E.styles(N(N({},g),{transformOrigin:"center"})),Xv(E.node(),v,!0)});var y=c.maybeAppendByClassName(Ii.pageInfoGroup,"g");this.pageInfoGroup=y.node(),y.maybeAppendByClassName(Ii.pageInfo,"text").styles(h),this.updatePageInfo(),c.node().setLocalPosition(o+i,s/2),m&&(this.prevBtnGroup.addEventListener("click",function(){r.prev()}),this.nextBtnGroup.addEventListener("click",function(){r.next()}))}},e.prototype.render=function(t,r){var i=t.x,a=i===void 0?0:i,o=t.y,s=o===void 0?0:o;this.attr("transform","translate(".concat(a,", ").concat(s,")"));var l=Lt(r);this.renderClipPath(l),this.renderController(l),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var t=this,r=Zu(function(){return t.render(t.attributes,t)},50);this.playWindow.addEventListener(pe.INSERTED,r),this.playWindow.addEventListener(pe.REMOVED,r)},e}(bn);function pD(n){var e="default";if(Ye(n)&&n instanceof Image)e="image";else if(jt(n))e="symbol";else if(qt(n)){var t=new RegExp("data:(image|text)");n.match(t)?e="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(n)?e="url":e="symbol"}return e}function vD(n){var e=pD(n);return["base64","url","image"].includes(e)?"image":n&&e==="symbol"?"path":null}var We=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r){var i=t.x,a=i===void 0?0:i,o=t.y,s=o===void 0?0:o,l=this.getSubShapeStyle(t),c=l.symbol,u=l.size,h=u===void 0?16:u,f=V(l,["symbol","size"]),d=vD(c);li(!!d,Lt(r),function(p){p.maybeAppendByClassName("marker",d).attr("className","marker ".concat(d,"-marker")).call(function(v){if(d==="image"){var g=h*2;v.styles({img:c,width:g,height:g,x:a-h,y:s-h})}else{var g=h/2,m=jt(c)?c:e.getSymbol(c);v.styles(N({d:m==null?void 0:m(a,s,g)},f))}})})},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(t,r){e.MARKER_SYMBOL_MAP.set(t,r)},e.getSymbol=function(t){return e.MARKER_SYMBOL_MAP.get(t)},e.getSymbols=function(){return Array.from(e.MARKER_SYMBOL_MAP.keys())},e}(bn);We.registerSymbol("cross",nD),We.registerSymbol("hyphen",aD),We.registerSymbol("line",Qb),We.registerSymbol("plus",iD),We.registerSymbol("tick",rD),We.registerSymbol("circle",Jb),We.registerSymbol("point",KI),We.registerSymbol("bowtie",eD),We.registerSymbol("hexagon",tD),We.registerSymbol("square",ZI),We.registerSymbol("diamond",qI),We.registerSymbol("triangle",JI),We.registerSymbol("triangle-down",QI),We.registerSymbol("line",Qb),We.registerSymbol("dot",tE),We.registerSymbol("dash",oD),We.registerSymbol("smooth",sD),We.registerSymbol("hv",lD),We.registerSymbol("vh",cD),We.registerSymbol("hvh",uD),We.registerSymbol("vhv",hD);function _W(n,e,t){var r=Math.round((n-t)/e);return t+r*e}function gD(n,e,t){var r=1.4,i=r*t;return[["M",n-t,e-i],["L",n+t,e-i],["L",n+t,e+i],["L",n-t,e+i],["Z"]]}var eE=1.4,nE=.4;function mD(n,e,t){var r=t,i=r*eE,a=r/2,o=r/6,s=n+i*nE;return[["M",n,e],["L",s,e+a],["L",n+i,e+a],["L",n+i,e-a],["L",s,e-a],["Z"],["M",s,e+o],["L",n+i-2,e+o],["M",s,e-o],["L",n+i-2,e-o]]}function yD(n,e,t){var r=t,i=r*eE,a=r/2,o=r/6,s=e+i*nE;return[["M",n,e],["L",n-a,s],["L",n-a,e+i],["L",n+a,e+i],["L",n+a,s],["Z"],["M",n-o,s],["L",n-o,e+i-2],["M",n+o,s],["L",n+o,e+i-2]]}We.registerSymbol("hiddenHandle",gD),We.registerSymbol("verticalHandle",mD),We.registerSymbol("horizontalHandle",yD);var TW=function(n,e,t){return n===void 0&&(n="horizontal"),n==="horizontal"?e:t};function PW(n,e,t,r){var i;r===void 0&&(r=4);var a=__read(n,2),o=a[0],s=a[1],l=__read(e,2),c=l[0],u=l[1],h=__read(t,2),f=h[0],d=h[1],p=__read([c,u],2),v=p[0],g=p[1],m=g-v;return v>g&&(i=__read([g,v],2),v=i[0],g=i[1]),m>s-o?[o,s]:v<o?f===o&&d===g?[o,g]:[o,m+o]:g>s?d===s&&f===v?[v,s]:[s-m,s]:[v,g]}function jv(n,e,t){return n===void 0&&(n="horizontal"),n==="horizontal"?e:t}function MW(n){var e=n&&n.getRenderBounds();if(!e)return{width:0,height:0};var t=e.getMax(),r=e.getMin();return{width:t[0]-r[0],height:t[1]-r[1]}}function rE(n){var e=n.getLocalBounds(),t=e.min,r=e.max,i=P([t,r],2),a=P(i[0],2),o=a[0],s=a[1],l=P(i[1],2),c=l[0],u=l[1];return{x:o,y:s,width:c-o,height:u-s,left:o,bottom:u,top:s,right:c}}function CW(n,e){var t=select(n).append("text").node();return t.attr(__assign(__assign({},e),{visibility:"hidden"})),t}function xD(n,e){var t=P(n,2),r=t[0],i=t[1],a=P(e,2),o=a[0],s=a[1];return r!==o&&i===s}function OW(n,e){var t=__read(n,2),r=t[0],i=t[1],a=__read(e,2),o=a[0],s=a[1];return r===o&&i!==s}function bD(n,e){var t,r,i=e.attributes;try{for(var a=vt(Object.entries(i)),o=a.next();!o.done;o=a.next()){var s=P(o.value,2),l=s[0],c=s[1];l!=="id"&&l!=="className"&&n.attr(l,c)}}catch(u){t={error:u}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}}function Na(n){return typeof n=="function"?n():qt(n)||te(n)?new Hv({style:{text:String(n)}}):n}function ED(n){var e,t,r,i=n||1;function a(s,l){++e>i&&(r=t,o(1),++e),t[s]=l}function o(s){e=0,t=Object.create(null),s||(r=Object.create(null))}return o(),{clear:o,has:function(s){return t[s]!==void 0||r[s]!==void 0},get:function(s){var l=t[s];if(l!==void 0)return l;if((l=r[s])!==void 0)return a(s,l),l},set:function(s,l){t[s]!==void 0?t[s]=l:a(s,l)}}}var wD=function(n,e,t){if(t===void 0&&(t=128),!jt(n))throw new TypeError("Expected a function");var r=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=e?e.apply(this,i):i[0],s=r.cache;if(s.has(o))return s.get(o);var l=n.apply(this,i);return s.set(o,l),l};return r.cache=ED(t),r},Qh,$v;function AW(n){$v=n}var SD=wD(function(n,e){var t=e.fontSize,r=e.fontFamily,i=e.fontWeight,a=e.fontStyle,o=e.fontVariant;return $v?$v(n,t):(Qh||(Qh=rt.offscreenCanvasCreator.getOrCreateContext(void 0)),Qh.font=[a,o,i,"".concat(t,"px"),r].join(" "),Qh.measureText(n).width)},function(n,e){return[n,Object.values(e||iE(n)).join()].join("")},4096),iE=function(n){var e=n.style.fontFamily||"sans-serif",t=n.style.fontWeight||"normal",r=n.style.fontStyle||"normal",i=n.style.fontVariant,a=n.style.fontSize;return a=typeof a=="object"?a.value:a,{fontSize:a,fontFamily:e,fontWeight:t,fontStyle:r,fontVariant:i}};function aE(n){return n.nodeName==="text"?n:n.nodeName==="g"&&n.children.length===1&&n.children[0].nodeName==="text"?n.children[0]:null}function oE(n,e){var t=aE(n);t&&t.attr(e)}function Kv(n,e,t){t===void 0&&(t="..."),oE(n,{wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:t})}var ci=ji({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item");function _D(n){var e=n.querySelector(ci.marker.class);return e?e.style:{}}var TD=function(n){B(e,n);function e(t){return n.call(this,t,{span:[1,1],marker:function(){return new Rh({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return Object.defineProperty(e.prototype,"showValue",{get:function(){var t=this.attributes.valueText;return t?typeof t=="string"||typeof t=="number"?t!=="":typeof t=="function"?!0:t.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var t=this.labelGroup,r=this.valueGroup,i=this.attributes.markerSize,a=t.node().getBBox(),o=a.width,s=a.height,l=r.node().getBBox(),c=l.width,u=l.height;return{markerWidth:i,labelWidth:o,valueWidth:c,height:Math.max(i,s,u)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var t=this.attributes.span;if(!t)return[1,1];var r=P(Mn(t),2),i=r[0],a=r[1],o=this.showValue?a:0,s=i+o;return[i/s,o/s]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t,r=this.attributes,i=r.markerSize,a=r.width,o=this.actualSpace,s=o.markerWidth,l=o.height,c=this.actualSpace,u=c.labelWidth,h=c.valueWidth,f=P(this.spacing,2),d=f[0],p=f[1];if(a){var v=a-i-d-p,g=P(this.span,2),m=g[0],x=g[1];t=P([m*v,x*v],2),u=t[0],h=t[1]}var S=s+u+h+d+p;return{width:S,height:l,markerWidth:s,labelWidth:u,valueWidth:h}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var t=this.attributes.spacing;if(!t)return[0,0];var r=P(Mn(t),2),i=r[0],a=r[1];return this.showValue?[i,a]:[i,0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var t=this.shape,r=t.markerWidth,i=t.labelWidth,a=t.valueWidth,o=t.width,s=t.height,l=P(this.spacing,2),c=l[0],u=l[1];return{height:s,width:o,markerWidth:r,labelWidth:i,valueWidth:a,position:[r/2,r+c,r+i+c+u]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleSize",{get:function(){var t=_D(this.markerGroup.node()),r=this.attributes,i=r.markerSize,a=r.markerStrokeWidth,o=a===void 0?t.strokeWidth:a,s=r.markerLineWidth,l=s===void 0?t.lineWidth:s,c=r.markerStroke,u=c===void 0?t.stroke:c,h=+(o||l||(u?1:0))*Math.sqrt(2),f=this.markerGroup.node().getBBox(),d=f.width,p=f.height;return(1-h/Math.max(d,p))*i},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(t){var r=this,i=this.attributes.marker,a=ee(this.attributes,"marker");this.markerGroup=t.maybeAppendByClassName(ci.markerGroup,"g").style("zIndex",0),li(!!i,this.markerGroup,function(){var o,s=r.markerGroup.node(),l=(o=s.childNodes)===null||o===void 0?void 0:o[0],c=typeof i=="string"?new We({style:{symbol:i},className:ci.marker.name}):i();l?c.nodeName===l.nodeName?l instanceof We?l.update(N(N({},a),{symbol:i})):(bD(l,c),Lt(l).styles(a)):(l.remove(),Lt(c).attr("className",ci.marker.name).styles(a),s.appendChild(c)):(c instanceof We||Lt(c).attr("className",ci.marker.name).styles(a),s.appendChild(c)),r.markerGroup.node().scale(1/r.markerGroup.node().getScale()[0]);var u=Xv(r.markerGroup.node(),r.scaleSize,!0);r.markerGroup.node().style._transform="scale(".concat(u,")")})},e.prototype.renderLabel=function(t){var r=ee(this.attributes,"label"),i=r.text,a=V(r,["text"]);this.labelGroup=t.maybeAppendByClassName(ci.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(ci.label,function(){return Na(i)}).styles(a)},e.prototype.renderValue=function(t){var r=this,i=ee(this.attributes,"value"),a=i.text,o=V(i,["text"]);this.valueGroup=t.maybeAppendByClassName(ci.valueGroup,"g").style("zIndex",0),li(this.showValue,this.valueGroup,function(){r.valueGroup.maybeAppendByClassName(ci.value,function(){return Na(a)}).styles(o)})},e.prototype.renderBackground=function(t){var r=this.shape,i=r.width,a=r.height,o=ee(this.attributes,"background");this.background=t.maybeAppendByClassName(ci.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(ci.background,"rect").styles(N({width:i,height:a},o))},e.prototype.adjustLayout=function(){var t=this.layout,r=t.labelWidth,i=t.valueWidth,a=t.height,o=P(t.position,3),s=o[0],l=o[1],c=o[2],u=a/2;this.markerGroup.styles({transform:"translate(".concat(s,", ").concat(u,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(l,", ").concat(u,")")}),Kv(this.labelGroup.select(ci.label.class).node(),Math.ceil(r)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(c,", ").concat(u,")")}),Kv(this.valueGroup.select(ci.value.class).node(),Math.ceil(i)))},e.prototype.render=function(t,r){var i=Lt(r),a=t.x,o=a===void 0?0:a,s=t.y,l=s===void 0?0:s;i.styles({transform:"translate(".concat(o,", ").concat(l,")")}),this.renderMarker(i),this.renderLabel(i),this.renderValue(i),this.renderBackground(i),this.adjustLayout()},e}(bn),Zo=ji({page:"item-page",navigator:"navigator",item:"item"},"items"),sE=function(n,e,t){return t===void 0&&(t=!0),n?e(n):t},PD=function(n){B(e,n);function e(t){var r=n.call(this,t,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:Yv,mouseenter:Yv,mouseleave:Yv})||this;return r.navigatorShape=[0,0],r}return Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var t=this.attributes,r=t.gridRow,i=t.gridCol,a=t.data;if(!r&&!i)throw new Error("gridRow and gridCol can not be set null at the same time");return r&&i?[r,i]:r?[r,a.length]:[a.length,i]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var t=this.attributes,r=t.data,i=t.layout,a=ee(this.attributes,"item"),o=r.map(function(s,l){var c=s.id,u=c===void 0?l:c,h=s.label,f=s.value;return{id:"".concat(u),index:l,style:N({layout:i,labelText:h,valueText:f},Object.fromEntries(Object.entries(a).map(function(d){var p=P(d,2),v=p[0],g=p[1];return[v,Li(g,[s,l,r])]})))}});return o},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var t=this,r=this.attributes,i=r.orientation,a=r.width,o=r.rowPadding,s=r.colPadding,l=P(this.navigatorShape,1),c=l[0],u=P(this.grid,2),h=u[0],f=u[1],d=f*h,p=0;return this.pageViews.children.map(function(v,g){var m,x,S=Math.floor(g/d),T=g%d,b=t.ifHorizontal(f,h),y=[Math.floor(T/b),T%b];i==="vertical"&&y.reverse();var E=P(y,2),w=E[0],C=E[1],M=(a-c-(f-1)*s)/f,O=v.getBBox().height,A=P([0,0],2),R=A[0],L=A[1];return i==="horizontal"?(m=P([p,w*(O+o)],2),R=m[0],L=m[1],p=C===f-1?0:p+M+s):(x=P([C*(M+s),p],2),R=x[0],L=x[1],p=w===h-1?0:p+O+o),{page:S,index:g,row:w,col:C,pageIndex:T,width:M,height:O,x:R,y:L}})},e.prototype.getFlexLayout=function(){var t=this.attributes,r=t.width,i=t.height,a=t.rowPadding,o=t.colPadding,s=P(this.navigatorShape,1),l=s[0],c=P(this.grid,2),u=c[0],h=c[1],f=P([r-l,i],2),d=f[0],p=f[1],v=P([0,0,0,0,0,0,0,0],8),g=v[0],m=v[1],x=v[2],S=v[3],T=v[4],b=v[5],y=v[6],E=v[7];return this.pageViews.children.map(function(w,C){var M,O,A,R,L=w.getBBox(),z=L.width,Y=L.height,I=y===0?0:o,q=y+I+z;if(q<=d&&sE(T,function(wt){return wt<h}))return M=P([y+I,E,q],3),g=M[0],m=M[1],y=M[2],{width:z,height:Y,x:g,y:m,page:x,index:C,pageIndex:S++,row:b,col:T++};O=P([b+1,0,0,E+Y+a],4),b=O[0],T=O[1],y=O[2],E=O[3];var J=E+Y;return J<=p&&sE(b,function(wt){return wt<u})?(A=P([y,E,z],3),g=A[0],m=A[1],y=A[2],{width:z,height:Y,x:g,y:m,page:x,index:C,pageIndex:S++,row:b,col:T++}):(R=P([0,0,z,0,x+1,0,0,0],8),g=R[0],m=R[1],y=R[2],E=R[3],x=R[4],S=R[5],b=R[6],T=R[7],{width:z,height:Y,x:g,y:m,page:x,index:C,pageIndex:S++,row:b,col:T++})})},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var t=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,r=t.call(this);return r.slice(-1)[0].page>0?(this.navigatorShape=[55,0],t.call(this)):r},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(t,r){var i=this.attributes.orientation;return jv(i,t,r)},e.prototype.flattenPage=function(t){t.querySelectorAll(Zo.item.class).forEach(function(r){t.appendChild(r)}),t.querySelectorAll(Zo.page.class).forEach(function(r){var i=t.removeChild(r);i.destroy()})},e.prototype.renderItems=function(t){var r=this.attributes,i=r.click,a=r.mouseenter,o=r.mouseleave;this.flattenPage(t);var s=this.dispatchCustomEvent.bind(this);Lt(t).selectAll(Zo.item.class).data(this.renderData,function(l){return l.id}).join(function(l){return l.append(function(c){var u=c.style;return new TD({style:u})}).attr("className",Zo.item.name).on("click",function(){i==null||i(this),s("itemClick",{item:this})}).on("pointerenter",function(){a==null||a(this),s("itemMouseenter",{item:this})}).on("pointerleave",function(){o==null||o(this),s("itemMouseleave",{item:this})})},function(l){return l.each(function(c){var u=c.style;this.update(u)})},function(l){return l.remove()})},e.prototype.relayoutNavigator=function(){var t,r=this.attributes,i=r.layout,a=r.width,o=((t=this.pageViews.children[0])===null||t===void 0?void 0:t.getBBox().height)||0,s=P(this.navigatorShape,2),l=s[0],c=s[1];this.navigator.update(i==="grid"?{pageWidth:a-l,pageHeight:o-c}:{})},e.prototype.adjustLayout=function(){var t=this,r=Object.entries(VI(this.itemsLayout,"page")).map(function(a){var o=P(a,2),s=o[0],l=o[1];return{page:s,layouts:l}}),i=K([],P(this.navigator.getContainer().children),!1);r.forEach(function(a){var o=a.layouts,s=t.pageViews.appendChild(new jn({className:Zo.page.name}));o.forEach(function(l){var c=l.x,u=l.y,h=l.index,f=l.width,d=l.height,p=i[h];s.appendChild(p),zl(p,"__layout__",l),p.update({x:c,y:u,width:f,height:d})})}),this.relayoutNavigator()},e.prototype.renderNavigator=function(t){var r=this.attributes.orientation,i=ee(this.attributes,"nav"),a=Fn({orientation:r},i),o=this;return t.selectAll(Zo.navigator.class).data(["nav"]).join(function(s){return s.append(function(){return new dD({style:a})}).attr("className",Zo.navigator.name).each(function(){o.navigator=this})},function(s){return s.each(function(){this.update(a)})},function(s){return s.remove()}),this.navigator},e.prototype.getBBox=function(){return this.navigator.getBBox()},e.prototype.render=function(t,r){var i=this.attributes.data;if(!(!i||i.length===0)){var a=this.renderNavigator(Lt(r));this.renderItems(a.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(t,r){var i=new Ln(t,{detail:r});this.dispatchEvent(i)},e}(bn),cc=ji({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),lE={showLabel:!0,formatter:function(n){return n.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0},NW=function(n){B(e,n);function e(t){return n.call(this,t,lE)||this}return e.prototype.render=function(t,r){var i=Lt(r).maybeAppendByClassName(cc.markerGroup,"g");this.renderMarker(i);var a=Lt(r).maybeAppendByClassName(cc.labelGroup,"g");this.renderLabel(a)},e.prototype.renderMarker=function(t){var r=this,i=this.attributes,a=i.orientation,o=i.markerSymbol,s=o===void 0?jv(a,"horizontalHandle","verticalHandle"):o;li(!!s,t,function(l){var c=ee(r.attributes,"marker"),u=N({symbol:s},c);r.marker=l.maybeAppendByClassName(cc.marker,function(){return new We({style:u})}).update(u)})},e.prototype.renderLabel=function(t){var r=this,i=this.attributes,a=i.showLabel,o=i.orientation,s=i.spacing,l=s===void 0?0:s,c=i.formatter;li(a,t,function(u){var h,f=ee(r.attributes,"label"),d=f.text,p=V(f,["text"]),v=((h=u.select(cc.marker.class))===null||h===void 0?void 0:h.node().getBBox())||{},g=v.width,m=g===void 0?0:g,x=v.height,S=x===void 0?0:x,T=P(jv(o,[0,S+l,"center","top"],[m+l,0,"start","middle"]),4),b=T[0],y=T[1],E=T[2],w=T[3];u.maybeAppendByClassName(cc.label,"text").styles(N(N({},p),{x:b,y,text:c(d).toString(),textAlign:E,textBaseline:w}))})},e}(bn),cE={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},MD=Fn({},cE,{}),RW=Fn({},cE,Qs(lE,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"}),kW=.01,LW=.5,uc=ji({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend"),CD=function(n){B(e,n);function e(t){return n.call(this,t,MD)||this}return e.prototype.renderTitle=function(t,r,i){var a=this.attributes,o=a.showTitle,s=a.titleText,l=ee(this.attributes,"title"),c=P(Aa(l),2),u=c[0],h=c[1];this.titleGroup=t.maybeAppendByClassName(uc.titleGroup,"g").styles(h);var f=N(N({width:r,height:i},u),{text:o?s:""});this.title=this.titleGroup.maybeAppendByClassName(uc.title,function(){return new UI({style:f})}).update(f)},e.prototype.renderItems=function(t,r){var i=r.x,a=r.y,o=r.width,s=r.height,l=ee(this.attributes,"title",!0),c=P(Aa(l),2),u=c[0],h=c[1],f=N(N({},u),{width:o,height:s,x:0,y:0});this.itemsGroup=t.maybeAppendByClassName(uc.itemsGroup,"g").styles(N(N({},h),{transform:"translate(".concat(i,", ").concat(a,")")}));var d=this;this.itemsGroup.selectAll(uc.items.class).data(["items"]).join(function(p){return p.append(function(){return new PD({style:f})}).attr("className",uc.items.name).each(function(){d.items=Lt(this)})},function(p){return p.update(f)},function(p){return p.remove()})},e.prototype.adjustLayout=function(){var t=this.attributes.showTitle;if(t){var r=this.title.node().getAvailableSpace(),i=r.x,a=r.y;this.itemsGroup.node().style.transform="translate(".concat(i,", ").concat(a,")")}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,r=t.showTitle,i=t.width,a=t.height;return r?this.title.node().getAvailableSpace():new fn(0,0,i,a)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t,r,i=(t=this.title)===null||t===void 0?void 0:t.node(),a=(r=this.items)===null||r===void 0?void 0:r.node();return!i||!a?n.prototype.getBBox.call(this):GI(i,a)},e.prototype.render=function(t,r){var i=this.attributes,a=i.width,o=i.height,s=i.x,l=s===void 0?0:s,c=i.y,u=c===void 0?0:c,h=Lt(r);r.style.transform="translate(".concat(l,", ").concat(u,")"),this.renderTitle(h,a,o),this.renderItems(h,this.availableSpace),this.adjustLayout()},e}(bn);const Qg=class extends mr{constructor(t,r){super(t,Object.assign({},Qg.defaultOptions,r));k(this,"typePrefix","__data__");k(this,"element",null);k(this,"draw",!1);k(this,"fieldMap",{node:new Map,edge:new Map,combo:new Map});k(this,"selectedItems",[]);k(this,"bindEvents",()=>{const{graph:t}=this.context;t.on(Mt.AFTER_DRAW,this.createElement)});k(this,"changeState",(t,r)=>{const{graph:i}=this.context,{typePrefix:a}=this,o=gr(t,[a,"id"]),s=gr(t,[a,"style","labelText"]),[l]=o.split("__"),c=this.fieldMap[l].get(s)||[];i.setElementState(Object.fromEntries(c==null?void 0:c.map(u=>[u,r])))});k(this,"click",t=>{if(this.options.trigger==="hover")return;const r=gr(t,[this.typePrefix,"id"]);this.selectedItems.includes(r)?(this.selectedItems=this.selectedItems.filter(i=>i!==r),this.changeState(t,[])):(this.selectedItems.push(r),this.changeState(t,"selected"))});k(this,"mouseleave",t=>{this.options.trigger!=="click"&&(this.selectedItems=[],this.changeState(t,[]))});k(this,"mouseenter",t=>{if(this.options.trigger==="click")return;const r=gr(t,[this.typePrefix,"id"]);this.selectedItems.includes(r)?this.selectedItems=this.selectedItems.filter(i=>i!==r):(this.selectedItems.push(r),this.changeState(t,"active"))});k(this,"setFieldMap",(t,r,i)=>{if(!t)return;const a=this.fieldMap[i];if(a)if(!a.has(t))a.set(t,[r]);else{const o=a.get(t);o&&(o.push(r),a.set(t,o))}});k(this,"getEvents",()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}));k(this,"getMarkerData",(t,r)=>{if(!t)return[];const{model:i,element:a,graph:o}=this.context,{nodes:s,edges:l,combos:c}=i.getData(),u={},h=g=>jt(t)?t(g):t,f={node:"circle",edge:"line",combo:"rect"},d={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},p=(g,m)=>a==null?void 0:a.getElementComputedStyle(g,m),v=(g,m)=>{g.forEach(x=>{const{id:S}=x,T=gr(x,["data",h(x)]),b=(a==null?void 0:a.getElementType(m,x))||"circle",y=p(m,x),E=(m==="edge"?y==null?void 0:y.stroke:y==null?void 0:y.fill)||"#1783ff";S&&T&&T.replace(/\s+/g,"")&&(this.setFieldMap(T,S,m),u[T]||(u[T]={id:`${m}__${S}`,label:T,marker:d[b]||f[m],elementType:m,lineWidth:1,stroke:E,fill:E}))})};switch(r){case"node":v(s,"node");break;case"edge":v(l,"edge");break;case"combo":v(c,"combo");break;default:return[]}return Object.values(u)});k(this,"layout",t=>{const r={flexDirection:"row",alignItems:"flex-end",justifyContent:"center"};let{flexDirection:i,alignItems:a,justifyContent:o}=r;const s={top:["row","flex-start","center"],bottom:["row","flex-end","center"],left:["column","flex-start","center"],right:["column","flex-end","center"]};return t in s&&([i,a,o]=s[t]),{display:"flex",flexDirection:i,justifyContent:o,alignItems:a}});k(this,"createElement",()=>{if(this.draw){this.updateElement();return}const{canvas:t}=this.context,[r,i]=t.getSize(),b=this.options,{width:a=r,height:o=i,nodeField:s,edgeField:l,comboField:c,trigger:u,position:h}=b,f=Ce(b,["width","height","nodeField","edgeField","comboField","trigger","position"]),d=this.getMarkerData(s,"node"),p=this.getMarkerData(l,"edge"),v=this.getMarkerData(c,"combo"),g=[...d,...v,...p],m=this.layout(h),x=new MI({style:at({width:a,height:o},m)}),S=Object.assign({width:a,height:o,data:g,itemMarkerLineWidth:({lineWidth:y})=>y,itemMarker:({marker:y})=>y,itemMarkerStroke:({stroke:y})=>y,itemMarkerFill:({fill:y})=>y,gridCol:d.length},f,this.getEvents()),T=new CD({className:"legend",style:S});x.appendChild(T),t.appendChild(x),this.element=x,this.draw=!0});this.bindEvents()}update(t){super.update(t),this.clear(),this.createElement()}clear(){var t;(t=this.element)==null||t.destroy(),this.element=null,this.draw=!1}updateElement(){if(!this.element)return;this.element.getChildByIndex(0).update({itemMarkerOpacity:({id:r})=>!this.selectedItems.length||this.selectedItems.includes(r)?1:.5,itemLabelOpacity:({id:r})=>!this.selectedItems.length||this.selectedItems.includes(r)?1:.5})}destroy(){this.clear(),this.context.graph.off(Mt.AFTER_DRAW,this.createElement),super.destroy()}};let tf=Qg;k(tf,"defaultOptions",{position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16});function OD(n,e){var t=e.cx,r=t===void 0?0:t,i=e.cy,a=i===void 0?0:i,o=e.r;n.arc(r,a,o,0,Math.PI*2,!1)}function AD(n,e){var t=e.cx,r=t===void 0?0:t,i=e.cy,a=i===void 0?0:i,o=e.rx,s=e.ry;if(n.ellipse)n.ellipse(r,a,o,s,0,0,Math.PI*2,!1);else{var l=o>s?o:s,c=o>s?1:o/s,u=o>s?s/o:1;n.save(),n.scale(c,u),n.arc(r,a,l,0,Math.PI*2)}}function ND(n,e){var t=e.x1,r=e.y1,i=e.x2,a=e.y2,o=e.markerStart,s=e.markerEnd,l=e.markerStartOffset,c=e.markerEndOffset,u=0,h=0,f=0,d=0,p=0,v,g;o&&me(o)&&l&&(v=i-t,g=a-r,p=Math.atan2(g,v),u=Math.cos(p)*(l||0),h=Math.sin(p)*(l||0)),s&&me(s)&&c&&(v=t-i,g=r-a,p=Math.atan2(g,v),f=Math.cos(p)*(c||0),d=Math.sin(p)*(c||0)),n.moveTo(t+u,r+h),n.lineTo(i+f,a+d)}function RD(n,e){var t=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,o=e.d,s=o.absolutePath,l=o.segments,c=0,u=0,h=0,f=0,d=0,p,v;if(t&&me(t)&&i){var g=P(t.parentNode.getStartTangent(),2),m=g[0],x=g[1];p=m[0]-x[0],v=m[1]-x[1],d=Math.atan2(v,p),c=Math.cos(d)*(i||0),u=Math.sin(d)*(i||0)}if(r&&me(r)&&a){var S=P(r.parentNode.getEndTangent(),2),m=S[0],x=S[1];p=m[0]-x[0],v=m[1]-x[1],d=Math.atan2(v,p),h=Math.cos(d)*(a||0),f=Math.sin(d)*(a||0)}for(var T=0;T<s.length;T++){var b=s[T],y=b[0],E=s[T+1],w=T===0&&(c!==0||u!==0),C=(T===s.length-1||E&&(E[0]==="M"||E[0]==="Z"))&&h!==0&&f!==0;switch(y){case"M":w?(n.moveTo(b[1]+c,b[2]+u),n.lineTo(b[1],b[2])):n.moveTo(b[1],b[2]);break;case"L":C?n.lineTo(b[1]+h,b[2]+f):n.lineTo(b[1],b[2]);break;case"Q":n.quadraticCurveTo(b[1],b[2],b[3],b[4]),C&&n.lineTo(b[3]+h,b[4]+f);break;case"C":n.bezierCurveTo(b[1],b[2],b[3],b[4],b[5],b[6]),C&&n.lineTo(b[5]+h,b[6]+f);break;case"A":{var M=l[T].arcParams,O=M.cx,A=M.cy,R=M.rx,L=M.ry,z=M.startAngle,Y=M.endAngle,I=M.xRotation,q=M.sweepFlag;if(n.ellipse)n.ellipse(O,A,R,L,I,z,Y,!!(1-q));else{var J=R>L?R:L,wt=R>L?1:R/L,Ft=R>L?L/R:1;n.translate(O,A),n.rotate(I),n.scale(wt,Ft),n.arc(0,0,J,z,Y,!!(1-q)),n.scale(1/wt,1/Ft),n.rotate(-I),n.translate(-O,-A)}C&&n.lineTo(b[6]+h,b[7]+f);break}case"Z":n.closePath();break}}}function kD(n,e){var t=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,o=e.points.points,s=o.length,l=o[0][0],c=o[0][1],u=o[s-1][0],h=o[s-1][1],f=0,d=0,p=0,v=0,g=0,m,x;t&&me(t)&&i&&(m=o[1][0]-o[0][0],x=o[1][1]-o[0][1],g=Math.atan2(x,m),f=Math.cos(g)*(i||0),d=Math.sin(g)*(i||0)),r&&me(r)&&a&&(m=o[s-1][0]-o[0][0],x=o[s-1][1]-o[0][1],g=Math.atan2(x,m),p=Math.cos(g)*(a||0),v=Math.sin(g)*(a||0)),n.moveTo(l+(f||p),c+(d||v));for(var S=1;S<s-1;S++){var T=o[S];n.lineTo(T[0],T[1])}n.lineTo(u,h)}function LD(n,e){var t=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,o=e.points.points,s=o.length,l=o[0][0],c=o[0][1],u=o[s-1][0],h=o[s-1][1],f=0,d=0,p=0,v=0,g=0,m,x;t&&me(t)&&i&&(m=o[1][0]-o[0][0],x=o[1][1]-o[0][1],g=Math.atan2(x,m),f=Math.cos(g)*(i||0),d=Math.sin(g)*(i||0)),r&&me(r)&&a&&(m=o[s-2][0]-o[s-1][0],x=o[s-2][1]-o[s-1][1],g=Math.atan2(x,m),p=Math.cos(g)*(a||0),v=Math.sin(g)*(a||0)),n.moveTo(l+f,c+d);for(var S=1;S<s-1;S++){var T=o[S];n.lineTo(T[0],T[1])}n.lineTo(u+p,h+v)}function ID(n,e){var t=e.x,r=t===void 0?0:t,i=e.y,a=i===void 0?0:i,o=e.radius,s=e.width,l=e.height,c=s,u=l,h=o&&o.some(function(T){return T!==0});if(!h)n.rect(r,a,c,u);else{var f=s>0?1:-1,d=l>0?1:-1,p=f+d===0,v=P(o.map(function(T){return he(T,0,Math.min(Math.abs(c)/2,Math.abs(u)/2))}),4),g=v[0],m=v[1],x=v[2],S=v[3];n.moveTo(f*g+r,a),n.lineTo(c-f*m+r,a),m!==0&&n.arc(c-f*m+r,d*m+a,m,-d*Math.PI/2,f>0?0:Math.PI,p),n.lineTo(c+r,u-d*x+a),x!==0&&n.arc(c-f*x+r,u-d*x+a,x,f>0?0:Math.PI,d>0?Math.PI/2:1.5*Math.PI,p),n.lineTo(f*S+r,u+a),S!==0&&n.arc(f*S+r,u-d*S+a,S,d>0?Math.PI/2:-Math.PI/2,f>0?Math.PI:0,p),n.lineTo(r,d*g+a),g!==0&&n.arc(f*g+r,d*g+a,g,f>0?Math.PI:0,d>0?Math.PI*1.5:Math.PI/2,p)}}var DD=function(n){B(e,n);function e(){var t=n.apply(this,K([],P(arguments),!1))||this;return t.name="canvas-path-generator",t}return e.prototype.init=function(){var t,r=(t={},t[ct.CIRCLE]=OD,t[ct.ELLIPSE]=AD,t[ct.RECT]=ID,t[ct.LINE]=ND,t[ct.POLYLINE]=LD,t[ct.POLYGON]=kD,t[ct.PATH]=RD,t[ct.TEXT]=void 0,t[ct.GROUP]=void 0,t[ct.IMAGE]=void 0,t[ct.HTML]=void 0,t[ct.MESH]=void 0,t);this.context.pathGeneratorFactory=r},e.prototype.destroy=function(){delete this.context.pathGeneratorFactory},e}(No),BD=_.Ue(),FD=_.Ue(),GD=_.Ue(),zD=Q(),WD=function(){function n(){var e=this;this.isHit=function(t,r,i,a){var o=e.context.pointInPathPickerFactory[t.nodeName];if(o){var s=Wt(zD,i),l=_.fF(FD,_.t8(GD,r[0],r[1],0),s);if(o(t,new Wn(l[0],l[1]),a,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(t,r){var i=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),a=e.context.pathGeneratorFactory[t.nodeName];return a&&(i.beginPath(),a(i,t.parsedStyle),i.closePath()),i.isPointInPath(r.x,r.y)}}return n.prototype.apply=function(e,t){var r=this,i,a=e.renderingService,o=e.renderingContext;this.context=e,this.runtime=t;var s=(i=o.root)===null||i===void 0?void 0:i.ownerDocument;a.hooks.pick.tapPromise(n.tag,function(l){return j(r,void 0,void 0,function(){return mt(this,function(c){return[2,this.pick(s,l)]})})}),a.hooks.pickSync.tap(n.tag,function(l){return r.pick(s,l)})},n.prototype.pick=function(e,t){var r,i,a=t.topmost,o=t.position,s=o.x,l=o.y,c=_.t8(BD,s,l,0),u=e.elementsFromBBox(c[0],c[1],c[0],c[1]),h=[];try{for(var f=vt(u),d=f.next();!d.done;d=f.next()){var p=d.value,v=p.getWorldTransform(),g=this.isHit(p,c,v,!1);if(g){var m=vy(p);if(m){var x=m.parsedStyle.clipPath,S=this.isHit(x,c,x.getWorldTransform(),!0);if(S){if(a)return t.picked=[p],t;h.push(p)}}else{if(a)return t.picked=[p],t;h.push(p)}}}}catch(T){r={error:T}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}return t.picked=h,t},n.tag="CanvasPicker",n}();function UD(n,e,t){var r=n.parsedStyle,i=r.cx,a=i===void 0?0:i,o=r.cy,s=o===void 0?0:o,l=r.r,c=r.fill,u=r.stroke,h=r.lineWidth,f=h===void 0?1:h,d=r.increasedLineWidthForHitTesting,p=d===void 0?0:d,v=r.pointerEvents,g=v===void 0?"auto":v,m=(f+p)/2,x=er(a,s,e.x,e.y),S=P(Lo(g,c,u),2),T=S[0],b=S[1];return T&&b||t?x<=l+m:T?x<=l:b?x>=l-m&&x<=l+m:!1}function ef(n,e,t,r){return n/(t*t)+e/(r*r)}function VD(n,e,t){var r=n.parsedStyle,i=r.cx,a=i===void 0?0:i,o=r.cy,s=o===void 0?0:o,l=r.rx,c=r.ry,u=r.fill,h=r.stroke,f=r.lineWidth,d=f===void 0?1:f,p=r.increasedLineWidthForHitTesting,v=p===void 0?0:p,g=r.pointerEvents,m=g===void 0?"auto":g,x=e.x,S=e.y,T=P(Lo(m,u,h),2),b=T[0],y=T[1],E=(d+v)/2,w=(x-a)*(x-a),C=(S-s)*(S-s);return b&&y||t?ef(w,C,l+E,c+E)<=1:b?ef(w,C,l,c)<=1:y?ef(w,C,l-E,c-E)>=1&&ef(w,C,l+E,c+E)<=1:!1}function qo(n,e,t,r,i,a){return i>=n&&i<=n+t&&a>=e&&a<=e+r}function HD(n,e,t,r,i,a,o){var s=i/2;return qo(n-s,e-s,t,i,a,o)||qo(n+t-s,e-s,i,r,a,o)||qo(n+s,e+r-s,t,i,a,o)||qo(n-s,e+s,i,r,a,o)}function nf(n,e,t,r,i,a,o,s){var l=(Math.atan2(s-e,o-n)+Math.PI*2)%(Math.PI*2),c={x:n+t*Math.cos(l),y:e+t*Math.sin(l)};return er(c.x,c.y,o,s)<=a/2}function so(n,e,t,r,i,a,o){var s=Math.min(n,t),l=Math.max(n,t),c=Math.min(e,r),u=Math.max(e,r),h=i/2;return a>=s-h&&a<=l+h&&o>=c-h&&o<=u+h?_m(n,e,t,r,a,o)<=i/2:!1}function uE(n,e,t,r,i){var a=n.length;if(a<2)return!1;for(var o=0;o<a-1;o++){var s=n[o][0],l=n[o][1],c=n[o+1][0],u=n[o+1][1];if(so(s,l,c,u,e,t,r))return!0}if(i){var h=n[0],f=n[a-1];if(so(h[0],h[1],f[0],f[1],e,t,r))return!0}return!1}var YD=1e-6;function Zv(n){return Math.abs(n)<YD?0:n<0?-1:1}function XD(n,e,t){return(t[0]-n[0])*(e[1]-n[1])===(e[0]-n[0])*(t[1]-n[1])&&Math.min(n[0],e[0])<=t[0]&&t[0]<=Math.max(n[0],e[0])&&Math.min(n[1],e[1])<=t[1]&&t[1]<=Math.max(n[1],e[1])}function hE(n,e,t){var r=!1,i=n.length;if(i<=2)return!1;for(var a=0;a<i;a++){var o=n[a],s=n[(a+1)%i];if(XD(o,s,[e,t]))return!0;Zv(o[1]-t)>0!=Zv(s[1]-t)>0&&Zv(e-(t-o[1])*(o[0]-s[0])/(o[1]-s[1])-o[0])<0&&(r=!r)}return r}function fE(n,e,t){for(var r=!1,i=0;i<n.length;i++){var a=n[i];if(r=hE(a,e,t),r)break}return r}function jD(n,e,t){var r=n.parsedStyle,i=r.x1,a=r.y1,o=r.x2,s=r.y2,l=r.lineWidth,c=l===void 0?1:l,u=r.increasedLineWidthForHitTesting,h=u===void 0?0:u,f=r.pointerEvents,d=f===void 0?"auto":f,p=r.fill,v=r.stroke,g=P(Lo(d,p,v),2),m=g[1];return!m&&!t||!c?!1:so(i,a,o,s,c+h,e.x,e.y)}function $D(n,e,t,r,i){for(var a=!1,o=e/2,s=0;s<n.length;s++){var l=n[s],c=l.currentPoint,u=l.params,h=l.prePoint,f=l.box;if(!(f&&!qo(f.x-o,f.y-o,f.width+e,f.height+e,t,r)))switch(l.command){case"L":case"Z":if(a=so(h[0],h[1],c[0],c[1],e,t,r),a)return!0;break;case"Q":var d=tT(h[0],h[1],u[1],u[2],u[3],u[4],t,r);if(a=d<=e/2,a)return!0;break;case"C":var p=Mm(h[0],h[1],u[1],u[2],u[3],u[4],u[5],u[6],t,r,i);if(a=p<=e/2,a)return!0;break;case"A":l.cubicParams||(l.cubicParams=rd(h[0],h[1],u[1],u[2],u[3],u[4],u[5],u[6],u[7],void 0));for(var v=l.cubicParams,g=h,m=0;m<v.length;m+=6){var x=Mm(g[0],g[1],v[m],v[m+1],v[m+2],v[m+3],v[m+4],v[m+5],t,r,i);if(g=[v[m+4],v[m+5]],a=x<=e/2,a)return!0}break}}return a}function KD(n,e,t,r,i,a){var o=n.parsedStyle,s=o.lineWidth,l=s===void 0?1:s,c=o.increasedLineWidthForHitTesting,u=c===void 0?0:c,h=o.stroke,f=o.fill,d=o.d,p=o.pointerEvents,v=p===void 0?"auto":p,g=d.segments,m=d.hasArc,x=d.polylines,S=d.polygons,T=P(Lo(v,(S==null?void 0:S.length)&&f,h),2),b=T[0],y=T[1],E=Id(n),w=!1;return b||t?(m?w=r(n,e):w=fE(S,e.x,e.y)||fE(x,e.x,e.y),w):((y||t)&&(w=$D(g,l+u,e.x,e.y,E)),w)}function ZD(n,e,t){var r=n.parsedStyle,i=r.stroke,a=r.fill,o=r.lineWidth,s=o===void 0?1:o,l=r.increasedLineWidthForHitTesting,c=l===void 0?0:l,u=r.points,h=r.pointerEvents,f=h===void 0?"auto":h,d=P(Lo(f,a,i),2),p=d[0],v=d[1],g=!1;return(v||t)&&(g=uE(u.points,s+c,e.x,e.y,!0)),!g&&(p||t)&&(g=hE(u.points,e.x,e.y)),g}function qD(n,e,t){var r=n.parsedStyle,i=r.lineWidth,a=i===void 0?1:i,o=r.increasedLineWidthForHitTesting,s=o===void 0?0:o,l=r.points,c=r.pointerEvents,u=c===void 0?"auto":c,h=r.fill,f=r.stroke,d=P(Lo(u,h,f),2),p=d[1];return!p&&!t||!a?!1:uE(l.points,a+s,e.x,e.y,!1)}function JD(n,e,t,r,i){var a=n.parsedStyle,o=a.radius,s=a.fill,l=a.stroke,c=a.lineWidth,u=c===void 0?1:c,h=a.increasedLineWidthForHitTesting,f=h===void 0?0:h,d=a.x,p=d===void 0?0:d,v=a.y,g=v===void 0?0:v,m=a.width,x=a.height,S=a.pointerEvents,T=S===void 0?"auto":S,b=P(Lo(T,s,l),2),y=b[0],E=b[1],w=o&&o.some(function(A){return A!==0}),C=u+f;if(w){var O=!1;return(E||t)&&(O=QD(p,g,m,x,o.map(function(A){return he(A,0,Math.min(Math.abs(m)/2,Math.abs(x)/2))}),C,e.x,e.y)),!O&&(y||t)&&(O=r(n,e)),O}else{var M=C/2;if(y&&E||t)return qo(p-M,g-M,m+M,x+M,e.x,e.y);if(y)return qo(p,g,m,x,e.x,e.y);if(E)return HD(p,g,m,x,C,e.x,e.y)}return!1}function QD(n,e,t,r,i,a,o,s){var l=P(i,4),c=l[0],u=l[1],h=l[2],f=l[3];return so(n+c,e,n+t-u,e,a,o,s)||so(n+t,e+u,n+t,e+r-h,a,o,s)||so(n+t-h,e+r,n+f,e+r,a,o,s)||so(n,e+r-f,n,e+c,a,o,s)||nf(n+t-u,e+u,u,1.5*Math.PI,2*Math.PI,a,o,s)||nf(n+t-h,e+r-h,h,0,.5*Math.PI,a,o,s)||nf(n+f,e+r-f,f,.5*Math.PI,Math.PI,a,o,s)||nf(n+c,e+c,c,Math.PI,1.5*Math.PI,a,o,s)}function t6(n,e,t,r,i,a){var o=n.parsedStyle,s=o.pointerEvents,l=s===void 0?"auto":s,c=o.x,u=c===void 0?0:c,h=o.y,f=h===void 0?0:h,d=o.width,p=o.height;if(l==="non-transparent-pixel"){var v=i.config.offscreenCanvas,g=a.offscreenCanvasCreator.getOrCreateCanvas(v),m=a.offscreenCanvasCreator.getOrCreateContext(v,{willReadFrequently:!0});g.width=d,g.height=p,i.defaultStyleRendererFactory[ct.IMAGE].render(m,N(N({},n.parsedStyle),{x:0,y:0}),n,void 0,void 0,void 0);var x=m.getImageData(e.x-u,e.y-f,1,1).data;return x.every(function(S){return S!==0})}return!0}var e6=function(n){B(e,n);function e(){var t=n.apply(this,K([],P(arguments),!1))||this;return t.name="canvas-picker",t}return e.prototype.init=function(){var t,r=function(){return!0},i=(t={},t[ct.CIRCLE]=UD,t[ct.ELLIPSE]=VD,t[ct.RECT]=JD,t[ct.LINE]=jD,t[ct.POLYLINE]=qD,t[ct.POLYGON]=ZD,t[ct.PATH]=KD,t[ct.TEXT]=r,t[ct.GROUP]=null,t[ct.IMAGE]=t6,t[ct.HTML]=null,t[ct.MESH]=null,t);this.context.pointInPathPickerFactory=i,this.addRenderingPlugin(new WD)},e.prototype.destroy=function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()},e}(No),n6=function(){function n(e){this.canvasRendererPluginOptions=e,this.removedRBushNodeAABBs=[],this.renderQueue=[],this.restoreStack=[],this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=Q(),this.dprMatrix=Q(),this.tmpMat4=Q(),this.vec3a=_.Ue(),this.vec3b=_.Ue(),this.vec3c=_.Ue(),this.vec3d=_.Ue()}return n.prototype.apply=function(e,t){var r=this;this.context=e;var i=e.config,a=e.camera,o=e.renderingService,s=e.renderingContext,l=e.rBushRoot,c=e.pathGeneratorFactory;this.rBush=l,this.pathGeneratorFactory=c;var u=e.contextService,h=s.root.ownerDocument.defaultView,f=function(v){var g=v.target,m=g.rBushNode;m.aabb&&r.removedRBushNodeAABBs.push(m.aabb)},d=function(v){var g=v.target,m=g.rBushNode;m.aabb&&r.removedRBushNodeAABBs.push(m.aabb)};o.hooks.init.tap(n.tag,function(){h.addEventListener(oe.UNMOUNTED,f),h.addEventListener(oe.CULLED,d);var v=u.getDPR(),g=i.width,m=i.height,x=u.getContext();r.clearRect(x,0,0,g*v,m*v,i.background)}),o.hooks.destroy.tap(n.tag,function(){h.removeEventListener(oe.UNMOUNTED,f),h.removeEventListener(oe.CULLED,d),r.renderQueue=[],r.removedRBushNodeAABBs=[],r.restoreStack=[]}),o.hooks.beginFrame.tap(n.tag,function(){var v,g=u.getContext(),m=u.getDPR(),x=i.width,S=i.height,T=r.canvasRendererPluginOptions,b=T.dirtyObjectNumThreshold,y=T.dirtyObjectRatioThreshold,E=o.getStats(),w=E.total,C=E.rendered,M=C/w;r.clearFullScreen=r.clearFullScreenLastFrame||!(!((v=h.context.renderingPlugins[1])===null||v===void 0)&&v.isFirstTimeRenderingFinished)||o.disableDirtyRectangleRendering()||C>b&&M>y,g&&(g.resetTransform?g.resetTransform():g.setTransform(1,0,0,1,0,0),r.clearFullScreen&&r.clearRect(g,0,0,x*m,S*m,i.background))});var p=function(v,g){v.isVisible()&&!v.isCulled()&&r.renderDisplayObject(v,g,r.context,r.restoreStack,t);var m=v.sortable.sorted||v.childNodes;m.forEach(function(x){p(x,g)})};o.hooks.endFrame.tap(n.tag,function(){if(s.root.childNodes.length===0){r.clearFullScreenLastFrame=!0;return}r.clearFullScreenLastFrame=!1;var v=u.getContext(),g=u.getDPR();if(Oe(r.dprMatrix,[g,g,1]),Ut(r.vpMatrix,r.dprMatrix,a.getOrthoMatrix()),r.clearFullScreen)p(s.root,v);else{var m=r.safeMergeAABB.apply(r,K([r.mergeDirtyAABBs(r.renderQueue)],P(r.removedRBushNodeAABBs.map(function(Ft){var fe=Ft.minX,xe=Ft.minY,Sr=Ft.maxX,jr=Ft.maxY,zn=new Fe;return zn.setMinMax([fe,xe,0],[Sr,jr,0]),zn})),!1));if(r.removedRBushNodeAABBs=[],Fe.isEmpty(m)){r.renderQueue=[];return}var x=r.convertAABB2Rect(m),S=x.x,T=x.y,b=x.width,y=x.height,E=_.fF(r.vec3a,[S,T,0],r.vpMatrix),w=_.fF(r.vec3b,[S+b,T,0],r.vpMatrix),C=_.fF(r.vec3c,[S,T+y,0],r.vpMatrix),M=_.fF(r.vec3d,[S+b,T+y,0],r.vpMatrix),O=Math.min(E[0],w[0],M[0],C[0]),A=Math.min(E[1],w[1],M[1],C[1]),R=Math.max(E[0],w[0],M[0],C[0]),L=Math.max(E[1],w[1],M[1],C[1]),z=Math.floor(O),Y=Math.floor(A),I=Math.ceil(R-O),q=Math.ceil(L-A);v.save(),r.clearRect(v,z,Y,I,q,i.background),v.beginPath(),v.rect(z,Y,I,q),v.clip(),v.setTransform(r.vpMatrix[0],r.vpMatrix[1],r.vpMatrix[4],r.vpMatrix[5],r.vpMatrix[12],r.vpMatrix[13]);var J=i.renderer.getConfig().enableDirtyRectangleRenderingDebug;J&&h.dispatchEvent(new nr(ni.DIRTY_RECTANGLE,{dirtyRect:{x:z,y:Y,width:I,height:q}}));var wt=r.searchDirtyObjects(m);wt.sort(function(Ft,fe){return Ft.sortable.renderOrder-fe.sortable.renderOrder}).forEach(function(Ft){Ft&&Ft.isVisible()&&!Ft.isCulled()&&r.renderDisplayObject(Ft,v,r.context,r.restoreStack,t)}),v.restore(),r.renderQueue.forEach(function(Ft){r.saveDirtyAABB(Ft)}),r.renderQueue=[]}r.restoreStack.forEach(function(){v.restore()}),r.restoreStack=[]}),o.hooks.render.tap(n.tag,function(v){r.clearFullScreen||r.renderQueue.push(v)})},n.prototype.clearRect=function(e,t,r,i,a,o){e.clearRect(t,r,i,a),o&&(e.fillStyle=o,e.fillRect(t,r,i,a))},n.prototype.renderDisplayObject=function(e,t,r,i,a){var o=e.nodeName,s=i[i.length-1];s&&!(e.compareDocumentPosition(s)&Dn.DOCUMENT_POSITION_CONTAINS)&&(t.restore(),i.pop());var l=this.context.styleRendererFactory[o],c=this.pathGeneratorFactory[o],u=e.parsedStyle.clipPath;if(u){this.applyWorldTransform(t,u);var h=this.pathGeneratorFactory[u.nodeName];h&&(t.save(),i.push(e),t.beginPath(),h(t,u.parsedStyle),t.closePath(),t.clip())}l&&(this.applyWorldTransform(t,e),t.save(),this.applyAttributesToContext(t,e)),c&&(t.beginPath(),c(t,e.parsedStyle),e.nodeName!==ct.LINE&&e.nodeName!==ct.PATH&&e.nodeName!==ct.POLYLINE&&t.closePath()),l&&(l.render(t,e.parsedStyle,e,r,this,a),t.restore()),e.renderable.dirty=!1},n.prototype.convertAABB2Rect=function(e){var t=e.getMin(),r=e.getMax(),i=Math.floor(t[0]),a=Math.floor(t[1]),o=Math.ceil(r[0]),s=Math.ceil(r[1]),l=o-i,c=s-a;return{x:i,y:a,width:l,height:c}},n.prototype.mergeDirtyAABBs=function(e){var t=new Fe;return e.forEach(function(r){var i=r.getRenderBounds();t.add(i);var a=r.renderable.dirtyRenderBounds;a&&t.add(a)}),t},n.prototype.searchDirtyObjects=function(e){var t=P(e.getMin(),2),r=t[0],i=t[1],a=P(e.getMax(),2),o=a[0],s=a[1],l=this.rBush.search({minX:r,minY:i,maxX:o,maxY:s});return l.map(function(c){var u=c.displayObject;return u})},n.prototype.saveDirtyAABB=function(e){var t=e.renderable;t.dirtyRenderBounds||(t.dirtyRenderBounds=new Fe);var r=e.getRenderBounds();r&&t.dirtyRenderBounds.update(r.center,r.halfExtents)},n.prototype.applyAttributesToContext=function(e,t){var r=t.parsedStyle,i=r.stroke,a=r.fill,o=r.opacity,s=r.lineDash,l=r.lineDashOffset;s&&e.setLineDash(s),pt(l)||(e.lineDashOffset=l),pt(o)||(e.globalAlpha*=o),!pt(i)&&!Array.isArray(i)&&!i.isNone&&(e.strokeStyle=t.attributes.stroke),!pt(a)&&!Array.isArray(a)&&!a.isNone&&(e.fillStyle=t.attributes.fill)},n.prototype.applyWorldTransform=function(e,t,r){r?(kt(this.tmpMat4,t.getLocalTransform()),Ut(this.tmpMat4,r,this.tmpMat4),Ut(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(kt(this.tmpMat4,t.getWorldTransform()),Ut(this.tmpMat4,this.vpMatrix,this.tmpMat4)),e.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])},n.prototype.safeMergeAABB=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=new Fe;return e.forEach(function(i){r.add(i)}),r},n.tag="CanvasRenderer",n}(),lo=function(){function n(e){this.imagePool=e}return n.prototype.render=function(e,t,r,i,a,o){var s=t.fill,l=t.fillRule,c=t.opacity,u=c===void 0?1:c,h=t.fillOpacity,f=h===void 0?1:h,d=t.stroke,p=t.strokeOpacity,v=p===void 0?1:p,g=t.lineWidth,m=g===void 0?1:g,x=t.lineCap,S=t.lineJoin,T=t.shadowType,b=t.shadowColor,y=t.shadowBlur,E=t.filter,w=t.miterLimit,C=s&&!s.isNone,M=d&&!d.isNone&&m>0,O=(s==null?void 0:s.alpha)===0,A=!!(E&&E.length),R=!pt(b)&&y>0,L=r.nodeName,z=T==="inner",Y=M&&R&&(L===ct.PATH||L===ct.LINE||L===ct.POLYLINE||O||z);C&&(e.globalAlpha=u*f,Y||rf(r,e,R),vE(e,r,s,l,i,a,o,this.imagePool),Y||this.clearShadowAndFilter(e,A,R)),M&&(e.globalAlpha=u*v,e.lineWidth=m,pt(w)||(e.miterLimit=w),pt(x)||(e.lineCap=x),pt(S)||(e.lineJoin=S),Y&&(z&&(e.globalCompositeOperation="source-atop"),rf(r,e,!0),z&&(qv(e,r,d,i,a,o,this.imagePool),e.globalCompositeOperation="source-over",this.clearShadowAndFilter(e,A,!0))),qv(e,r,d,i,a,o,this.imagePool))},n.prototype.clearShadowAndFilter=function(e,t,r){if(r&&(e.shadowColor="transparent",e.shadowBlur=0),t){var i=e.filter;!pt(i)&&i.indexOf("drop-shadow")>-1&&(e.filter=i.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}},n}();function rf(n,e,t){var r=n.parsedStyle,i=r.filter,a=r.shadowColor,o=r.shadowBlur,s=r.shadowOffsetX,l=r.shadowOffsetY;i&&i.length&&(e.filter=n.style.filter),t&&(e.shadowColor=a.toString(),e.shadowBlur=o||0,e.shadowOffsetX=s||0,e.shadowOffsetY=l||0)}function dE(n,e,t,r,i,a,o){var s,l;if(n.image.nodeName==="rect"){var c=n.image.parsedStyle,u=c.width,h=c.height;l=r.contextService.getDPR();var f=r.config.offscreenCanvas;s=a.offscreenCanvasCreator.getOrCreateCanvas(f),s.width=u*l,s.height=h*l;var d=a.offscreenCanvasCreator.getOrCreateContext(f),p=[];n.image.forEach(function(g){i.renderDisplayObject(g,d,r,p,a)}),p.forEach(function(){d.restore()})}var v=o.getOrCreatePatternSync(n,t,s,l,e.getGeometryBounds().min,function(){e.renderable.dirty=!0,r.renderingService.dirtify()});return v}function pE(n,e,t,r){var i;if(n.type===Qi.LinearGradient||n.type===Qi.RadialGradient){var a=e.getGeometryBounds(),o=a&&a.halfExtents[0]*2||1,s=a&&a.halfExtents[1]*2||1,l=a&&a.min||[0,0];i=r.getOrCreateGradient(N(N({type:n.type},n.value),{min:l,width:o,height:s}),t)}return i}function vE(n,e,t,r,i,a,o,s,l){l===void 0&&(l=!1),Array.isArray(t)?t.forEach(function(c){n.fillStyle=pE(c,e,n,s),l||(r?n.fill(r):n.fill())}):(Nd(t)&&(n.fillStyle=dE(t,e,n,i,a,o,s)),l||(r?n.fill(r):n.fill()))}function qv(n,e,t,r,i,a,o,s){s===void 0&&(s=!1),Array.isArray(t)?t.forEach(function(l){n.strokeStyle=pE(l,e,n,o),s||n.stroke()}):(Nd(t)&&(n.strokeStyle=dE(t,e,n,r,i,a,o)),s||n.stroke())}var r6=function(){function n(e){this.imagePool=e}return n.prototype.render=function(e,t,r){var i=t.x,a=i===void 0?0:i,o=t.y,s=o===void 0?0:o,l=t.width,c=t.height,u=t.src,h=t.shadowColor,f=t.shadowBlur,d,p=l,v=c;if(qt(u)?d=this.imagePool.getImageSync(u):(p||(p=u.width),v||(v=u.height),d=u),d){var g=!pt(h)&&f>0;rf(r,e,g);try{e.drawImage(d,a,s,p,v)}catch(m){}}},n}(),i6=function(){function n(e){this.imagePool=e}return n.prototype.render=function(e,t,r,i,a,o){r.getBounds();var s=t,l=s.lineWidth,c=l===void 0?1:l,u=s.textAlign,h=u===void 0?"start":u,f=s.textBaseline,d=f===void 0?"alphabetic":f,p=s.lineJoin,v=p===void 0?"miter":p,g=s.miterLimit,m=g===void 0?10:g,x=s.letterSpacing,S=x===void 0?0:x,T=s.stroke,b=s.fill,y=s.fillRule,E=s.fillOpacity,w=E===void 0?1:E,C=s.strokeOpacity,M=C===void 0?1:C,O=s.opacity,A=O===void 0?1:O,R=s.metrics,L=s.x,z=L===void 0?0:L,Y=s.y,I=Y===void 0?0:Y,q=s.dx,J=s.dy,wt=s.shadowColor,Ft=s.shadowBlur,fe=R.font,xe=R.lines,Sr=R.height,jr=R.lineHeight,zn=R.lineMetrics;e.font=fe,e.lineWidth=c,e.textAlign=h==="middle"?"center":h;var rn=d;!o.enableCSSParsing&&rn==="alphabetic"&&(rn="bottom"),e.lineJoin=v,pt(m)||(e.miterLimit=m);var On=I;d==="middle"?On+=-Sr/2-jr/2:d==="bottom"||d==="alphabetic"||d==="ideographic"?On+=-Sr:(d==="top"||d==="hanging")&&(On+=-jr);var di=z+(q||0);On+=J||0,xe.length===1&&(rn==="bottom"?(rn="middle",On-=.5*Sr):rn==="top"&&(rn="middle",On+=.5*Sr)),e.textBaseline=rn;var cr=!pt(wt)&&Ft>0;rf(r,e,cr);for(var $r=0;$r<xe.length;$r++){var xo=c/2+di;On+=jr,!pt(T)&&!T.isNone&&c&&this.drawLetterSpacing(e,r,xe[$r],zn[$r],h,xo,On,S,b,y,w,T,M,A,!0,i,a,o),pt(b)||this.drawLetterSpacing(e,r,xe[$r],zn[$r],h,xo,On,S,b,y,w,T,M,A,!1,i,a,o)}},n.prototype.drawLetterSpacing=function(e,t,r,i,a,o,s,l,c,u,h,f,d,p,v,g,m,x){if(l===0){v?this.strokeText(e,t,r,o,s,f,d,g,m,x):this.fillText(e,t,r,o,s,c,u,h,p,g,m,x);return}var S=e.textAlign;e.textAlign="left";var T=o;a==="center"||a==="middle"?T=o-i.width/2:(a==="right"||a==="end")&&(T=o-i.width);for(var b=Array.from(r),y=e.measureText(r).width,E=0,w=0;w<b.length;++w){var C=b[w];v?this.strokeText(e,t,C,T,s,f,d,g,m,x):this.fillText(e,t,C,T,s,c,u,h,p,g,m,x),E=e.measureText(r.substring(w+1)).width,T+=y-E+l,y=E}e.textAlign=S},n.prototype.fillText=function(e,t,r,i,a,o,s,l,c,u,h,f){vE(e,t,o,s,u,h,f,this.imagePool,!0);var d,p=!pt(l)&&l!==1;p&&(d=e.globalAlpha,e.globalAlpha=l*c),e.fillText(r,i,a),p&&(e.globalAlpha=d)},n.prototype.strokeText=function(e,t,r,i,a,o,s,l,c,u){qv(e,t,o,l,c,u,this.imagePool,!0);var h,f=!pt(s)&&s!==1;f&&(h=e.globalAlpha,e.globalAlpha=s),e.strokeText(r,i,a),f&&(e.globalAlpha=h)},n}(),IW=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(lo),DW=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(lo),BW=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(lo),FW=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(lo),GW=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(lo),zW=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(lo),WW=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(lo),a6=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=n.call(this)||this;return r.options=t,r.name="canvas-renderer",r}return e.prototype.init=function(){var t,r=N({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),i=this.context.imagePool,a=new lo(i),o=(t={},t[ct.CIRCLE]=a,t[ct.ELLIPSE]=a,t[ct.RECT]=a,t[ct.IMAGE]=new r6(i),t[ct.TEXT]=new i6(i),t[ct.LINE]=a,t[ct.POLYLINE]=a,t[ct.POLYGON]=a,t[ct.PATH]=a,t[ct.GROUP]=void 0,t[ct.HTML]=void 0,t[ct.MESH]=void 0,t);this.context.defaultStyleRendererFactory=o,this.context.styleRendererFactory=o,this.addRenderingPlugin(new n6(r))},e.prototype.destroy=function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory},e}(No),o6=function(){function n(){}return n.prototype.apply=function(e,t){var r=this,i=e.renderingService,a=e.renderingContext,o=e.config;this.context=e;var s=a.root.ownerDocument.defaultView,l=function(y){i.hooks.pointerMove.call(y)},c=function(y){i.hooks.pointerUp.call(y)},u=function(y){i.hooks.pointerDown.call(y)},h=function(y){i.hooks.pointerOver.call(y)},f=function(y){i.hooks.pointerOut.call(y)},d=function(y){i.hooks.pointerCancel.call(y)},p=function(y){i.hooks.pointerWheel.call(y)},v=function(y){i.hooks.click.call(y)},g=function(y){t.globalThis.document.addEventListener("pointermove",l,!0),y.addEventListener("pointerdown",u,!0),y.addEventListener("pointerleave",f,!0),y.addEventListener("pointerover",h,!0),t.globalThis.addEventListener("pointerup",c,!0),t.globalThis.addEventListener("pointercancel",d,!0)},m=function(y){y.addEventListener("touchstart",u,!0),y.addEventListener("touchend",c,!0),y.addEventListener("touchmove",l,!0),y.addEventListener("touchcancel",d,!0)},x=function(y){t.globalThis.document.addEventListener("mousemove",l,!0),y.addEventListener("mousedown",u,!0),y.addEventListener("mouseout",f,!0),y.addEventListener("mouseover",h,!0),t.globalThis.addEventListener("mouseup",c,!0)},S=function(y){t.globalThis.document.removeEventListener("pointermove",l,!0),y.removeEventListener("pointerdown",u,!0),y.removeEventListener("pointerleave",f,!0),y.removeEventListener("pointerover",h,!0),t.globalThis.removeEventListener("pointerup",c,!0)},T=function(y){y.removeEventListener("touchstart",u,!0),y.removeEventListener("touchend",c,!0),y.removeEventListener("touchmove",l,!0),y.removeEventListener("touchcancel",d,!0)},b=function(y){t.globalThis.document.removeEventListener("mousemove",l,!0),y.removeEventListener("mousedown",u,!0),y.removeEventListener("mouseout",f,!0),y.removeEventListener("mouseover",h,!0),t.globalThis.removeEventListener("mouseup",c,!0)};i.hooks.init.tap(n.tag,function(){var y=r.context.contextService.getDomElement();t.globalThis.navigator.msPointerEnabled?(y.style.msContentZooming="none",y.style.msTouchAction="none"):s.supportsPointerEvents&&(y.style.touchAction="none"),s.supportsPointerEvents?g(y):x(y),s.supportsTouchEvents&&m(y),o.useNativeClickEvent&&y.addEventListener("click",v,!0),y.addEventListener("wheel",p,{passive:!0,capture:!0})}),i.hooks.destroy.tap(n.tag,function(){var y=r.context.contextService.getDomElement();t.globalThis.navigator.msPointerEnabled?(y.style.msContentZooming="",y.style.msTouchAction=""):s.supportsPointerEvents&&(y.style.touchAction=""),s.supportsPointerEvents?S(y):b(y),s.supportsTouchEvents&&T(y),o.useNativeClickEvent&&y.removeEventListener("click",v,!0),y.removeEventListener("wheel",p,!0)})},n.tag="DOMInteraction",n}(),s6=function(n){B(e,n);function e(){var t=n.apply(this,K([],P(arguments),!1))||this;return t.name="dom-interaction",t}return e.prototype.init=function(){this.addRenderingPlugin(new o6)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(No),Jv=function(n,e){return Jv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},Jv(n,e)};function Me(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Jv(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var se=function(){return se=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},se.apply(this,arguments)};function co(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function l6(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(o=n[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function c6(n,e){return function(t,r){e(t,r,n)}}function UW(n,e,t,r,i,a){function o(m){if(m!==void 0&&typeof m!="function")throw new TypeError("Function expected");return m}for(var s=r.kind,l=s==="getter"?"get":s==="setter"?"set":"value",c=!e&&n?r.static?n:n.prototype:null,u=e||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),h,f=!1,d=t.length-1;d>=0;d--){var p={};for(var v in r)p[v]=v==="access"?{}:r[v];for(var v in r.access)p.access[v]=r.access[v];p.addInitializer=function(m){if(f)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(m||null))};var g=(0,t[d])(s==="accessor"?{get:u.get,set:u.set}:u[l],p);if(s==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(h=o(g.get))&&(u.get=h),(h=o(g.set))&&(u.set=h),(h=o(g.init))&&i.unshift(h)}else(h=o(g))&&(s==="field"?i.unshift(h):u[l]=h)}c&&Object.defineProperty(c,r.name,u),f=!0}function VW(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0}function HW(n){return typeof n=="symbol"?n:"".concat(n)}function YW(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function u6(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function af(n,e,t,r){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):i(u.value).then(s,l)}c((r=r.apply(n,e||[])).next())})}function of(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(r=1,i&&(a=c[0]&2?i.return:c[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,c[1])).done)return a;switch(i=0,a&&(c=[c[0]&2,a.value]),c[0]){case 0:case 1:a=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){t.label=c[1];break}if(c[0]===6&&t.label<a[1]){t.label=a[1],a=c;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(c);break}a[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],i=0}finally{r=a=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var Qv=Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]};function h6(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Qv(e,n,t)}function sa(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ht(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function f6(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Ht(arguments[e]));return n}function d6(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function nn(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function hc(n){return this instanceof hc?(this.v=n,this):new hc(n)}function p6(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,a=[];return i={},s("next"),s("throw"),s("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(d){return function(p){return Promise.resolve(p).then(d,h)}}function s(d,p){r[d]&&(i[d]=function(v){return new Promise(function(g,m){a.push([d,v,g,m])>1||l(d,v)})},p&&(i[d]=p(i[d])))}function l(d,p){try{c(r[d](p))}catch(v){f(a[0][3],v)}}function c(d){d.value instanceof hc?Promise.resolve(d.value.v).then(u,h):f(a[0][2],d)}function u(d){l("next",d)}function h(d){l("throw",d)}function f(d,p){d(p),a.shift(),a.length&&l(a[0][0],a[0][1])}}function v6(n){var e,t;return e={},r("next"),r("throw",function(i){throw i}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(i,a){e[i]=n[i]?function(o){return(t=!t)?{value:hc(n[i](o)),done:!1}:a?a(o):o}:a}}function g6(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof sa=="function"?sa(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(s,l){o=n[a](o),i(s,l,o.done,o.value)})}}function i(a,o,s,l){Promise.resolve(l).then(function(c){a({value:c,done:s})},o)}}function m6(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var y6=Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e};function x6(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&Qv(e,n,t);return y6(e,n),e}function b6(n){return n&&n.__esModule?n:{default:n}}function E6(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function w6(n,e,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t}function S6(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function _6(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var T6=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function P6(n){function e(r){n.error=n.hasError?new T6(r,n.error,"An error was suppressed during disposal."):r,n.hasError=!0}function t(){for(;n.stack.length;){var r=n.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(t,function(a){return e(a),t()})}catch(a){e(a)}}if(n.hasError)throw n.error}return t()}var XW={__extends:Me,__assign:se,__rest:co,__decorate:l6,__param:c6,__metadata:u6,__awaiter:af,__generator:of,__createBinding:Qv,__exportStar:h6,__values:sa,__read:Ht,__spread:f6,__spreadArrays:d6,__spreadArray:nn,__await:hc,__asyncGenerator:p6,__asyncDelegator:v6,__asyncValues:g6,__makeTemplateObject:m6,__importStar:x6,__importDefault:b6,__classPrivateFieldGet:E6,__classPrivateFieldSet:w6,__classPrivateFieldIn:S6,__addDisposableResource:_6,__disposeResources:P6},M6=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:typeof self!="undefined"?self:{},gE={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(M6,function(){function t(b,y,E,w,C){r(b,y,E||0,w||b.length-1,C||a)}function r(b,y,E,w,C){for(;w>E;){if(w-E>600){var M=w-E+1,O=y-E+1,A=Math.log(M),R=.5*Math.exp(2*A/3),L=.5*Math.sqrt(A*R*(M-R)/M)*(O-M/2<0?-1:1),z=Math.max(E,Math.floor(y-O*R/M+L)),Y=Math.min(w,Math.floor(y+(M-O)*R/M+L));r(b,y,z,Y,C)}var I=b[y],q=E,J=w;for(i(b,E,y),C(b[w],I)>0&&i(b,E,w);q<J;){for(i(b,q,J),q++,J--;C(b[q],I)<0;)q++;for(;C(b[J],I)>0;)J--}C(b[E],I)===0?i(b,E,J):(J++,i(b,J,w)),J<=y&&(E=J+1),y<=J&&(w=J-1)}}function i(b,y,E){var w=b[y];b[y]=b[E],b[E]=w}function a(b,y){return b<y?-1:b>y?1:0}var o=function(y){y===void 0&&(y=9),this._maxEntries=Math.max(4,y),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(y){var E=this.data,w=[];if(!x(y,E))return w;for(var C=this.toBBox,M=[];E;){for(var O=0;O<E.children.length;O++){var A=E.children[O],R=E.leaf?C(A):A;x(y,R)&&(E.leaf?w.push(A):m(y,R)?this._all(A,w):M.push(A))}E=M.pop()}return w},o.prototype.collides=function(y){var E=this.data;if(!x(y,E))return!1;for(var w=[];E;){for(var C=0;C<E.children.length;C++){var M=E.children[C],O=E.leaf?this.toBBox(M):M;if(x(y,O)){if(E.leaf||m(y,O))return!0;w.push(M)}}E=w.pop()}return!1},o.prototype.load=function(y){if(!(y&&y.length))return this;if(y.length<this._minEntries){for(var E=0;E<y.length;E++)this.insert(y[E]);return this}var w=this._build(y.slice(),0,y.length-1,0);if(!this.data.children.length)this.data=w;else if(this.data.height===w.height)this._splitRoot(this.data,w);else{if(this.data.height<w.height){var C=this.data;this.data=w,w=C}this._insert(w,this.data.height-w.height-1,!0)}return this},o.prototype.insert=function(y){return y&&this._insert(y,this.data.height-1),this},o.prototype.clear=function(){return this.data=S([]),this},o.prototype.remove=function(y,E){if(!y)return this;for(var w=this.data,C=this.toBBox(y),M=[],O=[],A,R,L;w||M.length;){if(w||(w=M.pop(),R=M[M.length-1],A=O.pop(),L=!0),w.leaf){var z=s(y,w.children,E);if(z!==-1)return w.children.splice(z,1),M.push(w),this._condense(M),this}!L&&!w.leaf&&m(w,C)?(M.push(w),O.push(A),A=0,R=w,w=w.children[0]):R?(A++,w=R.children[A],L=!1):w=null}return this},o.prototype.toBBox=function(y){return y},o.prototype.compareMinX=function(y,E){return y.minX-E.minX},o.prototype.compareMinY=function(y,E){return y.minY-E.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(y){return this.data=y,this},o.prototype._all=function(y,E){for(var w=[];y;)y.leaf?E.push.apply(E,y.children):w.push.apply(w,y.children),y=w.pop();return E},o.prototype._build=function(y,E,w,C){var M=w-E+1,O=this._maxEntries,A;if(M<=O)return A=S(y.slice(E,w+1)),l(A,this.toBBox),A;C||(C=Math.ceil(Math.log(M)/Math.log(O)),O=Math.ceil(M/Math.pow(O,C-1))),A=S([]),A.leaf=!1,A.height=C;var R=Math.ceil(M/O),L=R*Math.ceil(Math.sqrt(O));T(y,E,w,L,this.compareMinX);for(var z=E;z<=w;z+=L){var Y=Math.min(z+L-1,w);T(y,z,Y,R,this.compareMinY);for(var I=z;I<=Y;I+=R){var q=Math.min(I+R-1,Y);A.children.push(this._build(y,I,q,C-1))}}return l(A,this.toBBox),A},o.prototype._chooseSubtree=function(y,E,w,C){for(;C.push(E),!(E.leaf||C.length-1===w);){for(var M=1/0,O=1/0,A=void 0,R=0;R<E.children.length;R++){var L=E.children[R],z=d(L),Y=v(y,L)-z;Y<O?(O=Y,M=z<M?z:M,A=L):Y===O&&z<M&&(M=z,A=L)}E=A||E.children[0]}return E},o.prototype._insert=function(y,E,w){var C=w?y:this.toBBox(y),M=[],O=this._chooseSubtree(C,this.data,E,M);for(O.children.push(y),u(O,C);E>=0&&M[E].children.length>this._maxEntries;)this._split(M,E),E--;this._adjustParentBBoxes(C,M,E)},o.prototype._split=function(y,E){var w=y[E],C=w.children.length,M=this._minEntries;this._chooseSplitAxis(w,M,C);var O=this._chooseSplitIndex(w,M,C),A=S(w.children.splice(O,w.children.length-O));A.height=w.height,A.leaf=w.leaf,l(w,this.toBBox),l(A,this.toBBox),E?y[E-1].children.push(A):this._splitRoot(w,A)},o.prototype._splitRoot=function(y,E){this.data=S([y,E]),this.data.height=y.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(y,E,w){for(var C,M=1/0,O=1/0,A=E;A<=w-E;A++){var R=c(y,0,A,this.toBBox),L=c(y,A,w,this.toBBox),z=g(R,L),Y=d(R)+d(L);z<M?(M=z,C=A,O=Y<O?Y:O):z===M&&Y<O&&(O=Y,C=A)}return C||w-E},o.prototype._chooseSplitAxis=function(y,E,w){var C=y.leaf?this.compareMinX:h,M=y.leaf?this.compareMinY:f,O=this._allDistMargin(y,E,w,C),A=this._allDistMargin(y,E,w,M);O<A&&y.children.sort(C)},o.prototype._allDistMargin=function(y,E,w,C){y.children.sort(C);for(var M=this.toBBox,O=c(y,0,E,M),A=c(y,w-E,w,M),R=p(O)+p(A),L=E;L<w-E;L++){var z=y.children[L];u(O,y.leaf?M(z):z),R+=p(O)}for(var Y=w-E-1;Y>=E;Y--){var I=y.children[Y];u(A,y.leaf?M(I):I),R+=p(A)}return R},o.prototype._adjustParentBBoxes=function(y,E,w){for(var C=w;C>=0;C--)u(E[C],y)},o.prototype._condense=function(y){for(var E=y.length-1,w=void 0;E>=0;E--)y[E].children.length===0?E>0?(w=y[E-1].children,w.splice(w.indexOf(y[E]),1)):this.clear():l(y[E],this.toBBox)};function s(b,y,E){if(!E)return y.indexOf(b);for(var w=0;w<y.length;w++)if(E(b,y[w]))return w;return-1}function l(b,y){c(b,0,b.children.length,y,b)}function c(b,y,E,w,C){C||(C=S(null)),C.minX=1/0,C.minY=1/0,C.maxX=-1/0,C.maxY=-1/0;for(var M=y;M<E;M++){var O=b.children[M];u(C,b.leaf?w(O):O)}return C}function u(b,y){return b.minX=Math.min(b.minX,y.minX),b.minY=Math.min(b.minY,y.minY),b.maxX=Math.max(b.maxX,y.maxX),b.maxY=Math.max(b.maxY,y.maxY),b}function h(b,y){return b.minX-y.minX}function f(b,y){return b.minY-y.minY}function d(b){return(b.maxX-b.minX)*(b.maxY-b.minY)}function p(b){return b.maxX-b.minX+(b.maxY-b.minY)}function v(b,y){return(Math.max(y.maxX,b.maxX)-Math.min(y.minX,b.minX))*(Math.max(y.maxY,b.maxY)-Math.min(y.minY,b.minY))}function g(b,y){var E=Math.max(b.minX,y.minX),w=Math.max(b.minY,y.minY),C=Math.min(b.maxX,y.maxX),M=Math.min(b.maxY,y.maxY);return Math.max(0,C-E)*Math.max(0,M-w)}function m(b,y){return b.minX<=y.minX&&b.minY<=y.minY&&y.maxX<=b.maxX&&y.maxY<=b.maxY}function x(b,y){return y.minX<=b.maxX&&y.minY<=b.maxY&&y.maxX>=b.minX&&y.maxY>=b.minY}function S(b){return{children:b,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function T(b,y,E,w,C){for(var M=[y,E];M.length;)if(E=M.pop(),y=M.pop(),!(E-y<=w)){var O=y+Math.ceil((E-y)/w/2)*w;t(b,O,y,E,C),M.push(y,O,O,E)}}return o})})(gE);var C6=gE.exports,At;(function(n){n.GROUP="g",n.CIRCLE="circle",n.ELLIPSE="ellipse",n.IMAGE="image",n.RECT="rect",n.LINE="line",n.POLYLINE="polyline",n.POLYGON="polygon",n.TEXT="text",n.PATH="path",n.HTML="html",n.MESH="mesh"})(At||(At={}));var el;(function(n){n[n.ZERO=0]="ZERO",n[n.NEGATIVE_ONE=1]="NEGATIVE_ONE"})(el||(el={}));var O6=function(){function n(){this.plugins=[]}return n.prototype.addRenderingPlugin=function(e){this.plugins.push(e),this.context.renderingPlugins.push(e)},n.prototype.removeAllRenderingPlugins=function(){var e=this;this.plugins.forEach(function(t){var r=e.context.renderingPlugins.indexOf(t);r>=0&&e.context.renderingPlugins.splice(r,1)})},n}(),jW=function(){function n(e){this.clipSpaceNearZ=el.NEGATIVE_ONE,this.plugins=[],this.config=se({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0},e)}return n.prototype.registerPlugin=function(e){var t=this.plugins.findIndex(function(r){return r===e});t===-1&&this.plugins.push(e)},n.prototype.unregisterPlugin=function(e){var t=this.plugins.findIndex(function(r){return r===e});t>-1&&this.plugins.splice(t,1)},n.prototype.getPlugins=function(){return this.plugins},n.prototype.getPlugin=function(e){return this.plugins.find(function(t){return t.name===e})},n.prototype.getConfig=function(){return this.config},n.prototype.setConfig=function(e){Object.assign(this.config,e)},n}();function nl(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function t0(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function sf(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function mE(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function A6(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n}function N6(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n}function e0(n){return n===void 0?0:n>360||n<-360?n%360:n}function Ur(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=0),Array.isArray(n)&&n.length===3?_.d9(n):te(n)?_.al(n,e,t):_.al(n[0],n[1]||e,n[2]||t)}function Ze(n){return n*(Math.PI/180)}function Di(n){return n*(180/Math.PI)}function $W(n){return n=n%400,n<0&&(n+=400),n/400*360}function KW(n){return n/360}function R6(n){return 360*n}function k6(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=t*t,s=r*r,l=i*i,c=a*a,u=o+s+l+c,h=t*a-r*i;return h>.499995*u?(n[0]=Math.PI/2,n[1]=2*Math.atan2(r,t),n[2]=0):h<-.499995*u?(n[0]=-Math.PI/2,n[1]=2*Math.atan2(r,t),n[2]=0):(n[0]=Math.asin(2*(t*i-a*r)),n[1]=Math.atan2(2*(t*a+r*i),1-2*(l+c)),n[2]=Math.atan2(2*(t*r+i*a),1-2*(s+l))),n}function L6(n,e){var t,r,i=Math.PI*.5,a=Ht(He(_.Ue(),e),3),o=a[0],s=a[1],l=a[2],c=Math.asin(-e[2]/o);return c<i?c>-i?(t=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,t=-Math.atan2(e[4]/s,e[5]/s)):(r=0,t=Math.atan2(e[4]/s,e[5]/s)),n[0]=t,n[1]=c,n[2]=r,n}function n0(n,e){return e.length===16?L6(n,e):k6(n,e)}function I6(n,e,t,r,i){var a=Math.cos(n),o=Math.sin(n);return qi.al(r*a,i*o,0,-r*o,i*a,0,e,t,1)}function D6(n,e,t,r,i,a,o,s){s===void 0&&(s=!1);var l=2*a/(t-e),c=2*a/(r-i),u=(t+e)/(t-e),h=(r+i)/(r-i),f,d;return s?(f=-o/(o-a),d=-o*a/(o-a)):(f=-(o+a)/(o-a),d=-2*o*a/(o-a)),n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=u,n[9]=h,n[10]=f,n[11]=-1,n[12]=0,n[13]=0,n[14]=d,n[15]=0,n}function yE(n){var e=n[0],t=n[1],r=n[3],i=n[4],a=Math.sqrt(e*e+t*t),o=Math.sqrt(r*r+i*i),s=e*i-t*r;s<0&&(e<i?a=-a:o=-o),a&&(e*=1/a,t*=1/a),o&&(r*=1/o,i*=1/o);var l=Math.atan2(t,e),c=Di(l);return[n[6],n[7],a,o,c]}var la=Q(),Ki=Q(),fc=an(),Zt=[_.Ue(),_.Ue(),_.Ue()],xE=_.Ue();function B6(n,e,t,r,i,a){if(!F6(la,n)||(kt(Ki,la),Ki[3]=0,Ki[7]=0,Ki[11]=0,Ki[15]=1,Math.abs(Pe(Ki))<1e-8))return!1;var o=la[3],s=la[7],l=la[11],c=la[12],u=la[13],h=la[14],f=la[15];if(o!==0||s!==0||l!==0){fc[0]=o,fc[1]=s,fc[2]=l,fc[3]=f;var d=Wt(Ki,Ki);if(!d)return!1;Te(Ki,Ki),ln(i,fc,Ki)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=c,e[1]=u,e[2]=h,G6(Zt,la),t[0]=_.kE(Zt[0]),_.Fv(Zt[0],Zt[0]),r[0]=_.AK(Zt[0],Zt[1]),r0(Zt[1],Zt[1],Zt[0],1,-r[0]),t[1]=_.kE(Zt[1]),_.Fv(Zt[1],Zt[1]),r[0]/=t[1],r[1]=_.AK(Zt[0],Zt[2]),r0(Zt[2],Zt[2],Zt[0],1,-r[1]),r[2]=_.AK(Zt[1],Zt[2]),r0(Zt[2],Zt[2],Zt[1],1,-r[2]),t[2]=_.kE(Zt[2]),_.Fv(Zt[2],Zt[2]),r[1]/=t[2],r[2]/=t[2],_.kC(xE,Zt[1],Zt[2]),_.AK(Zt[0],xE)<0)for(var p=0;p<3;p++)t[p]*=-1,Zt[p][0]*=-1,Zt[p][1]*=-1,Zt[p][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+Zt[0][0]-Zt[1][1]-Zt[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-Zt[0][0]+Zt[1][1]-Zt[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-Zt[0][0]-Zt[1][1]+Zt[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+Zt[0][0]+Zt[1][1]+Zt[2][2],0)),Zt[2][1]>Zt[1][2]&&(a[0]=-a[0]),Zt[0][2]>Zt[2][0]&&(a[1]=-a[1]),Zt[1][0]>Zt[0][1]&&(a[2]=-a[2]),!0}function F6(n,e){var t=e[15];if(t===0)return!1;for(var r=1/t,i=0;i<16;i++)n[i]=e[i]*r;return!0}function G6(n,e){n[0][0]=e[0],n[0][1]=e[1],n[0][2]=e[2],n[1][0]=e[4],n[1][1]=e[5],n[1][2]=e[6],n[2][0]=e[8],n[2][1]=e[9],n[2][2]=e[10]}function r0(n,e,t,r,i){n[0]=e[0]*r+t[0]*i,n[1]=e[1]*r+t[1]*i,n[2]=e[2]*r+t[2]*i}var or=function(){function n(){this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return n.isEmpty=function(e){return!e||e.halfExtents[0]===0&&e.halfExtents[1]===0&&e.halfExtents[2]===0},n.prototype.update=function(e,t){nl(this.center,e),nl(this.halfExtents,t),t0(this.min,this.center,this.halfExtents),sf(this.max,this.center,this.halfExtents)},n.prototype.setMinMax=function(e,t){sf(this.center,t,e),mE(this.center,this.center,.5),t0(this.halfExtents,t,e),mE(this.halfExtents,this.halfExtents,.5),nl(this.min,e),nl(this.max,t)},n.prototype.getMin=function(){return this.min},n.prototype.getMax=function(){return this.max},n.prototype.add=function(e){if(!n.isEmpty(e)){if(n.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return}var t=this.center,r=t[0],i=t[1],a=t[2],o=this.halfExtents,s=o[0],l=o[1],c=o[2],u=r-s,h=r+s,f=i-l,d=i+l,p=a-c,v=a+c,g=e.center,m=g[0],x=g[1],S=g[2],T=e.halfExtents,b=T[0],y=T[1],E=T[2],w=m-b,C=m+b,M=x-y,O=x+y,A=S-E,R=S+E;w<u&&(u=w),C>h&&(h=C),M<f&&(f=M),O>d&&(d=O),A<p&&(p=A),R>v&&(v=R),t[0]=(u+h)*.5,t[1]=(f+d)*.5,t[2]=(p+v)*.5,o[0]=(h-u)*.5,o[1]=(d-f)*.5,o[2]=(v-p)*.5,this.min[0]=u,this.min[1]=f,this.min[2]=p,this.max[0]=h,this.max[1]=d,this.max[2]=v}},n.prototype.setFromTransformedAABB=function(e,t){var r=this.center,i=this.halfExtents,a=e.center,o=e.halfExtents,s=t[0],l=t[4],c=t[8],u=t[1],h=t[5],f=t[9],d=t[2],p=t[6],v=t[10],g=Math.abs(s),m=Math.abs(l),x=Math.abs(c),S=Math.abs(u),T=Math.abs(h),b=Math.abs(f),y=Math.abs(d),E=Math.abs(p),w=Math.abs(v);r[0]=t[12]+s*a[0]+l*a[1]+c*a[2],r[1]=t[13]+u*a[0]+h*a[1]+f*a[2],r[2]=t[14]+d*a[0]+p*a[1]+v*a[2],i[0]=g*o[0]+m*o[1]+x*o[2],i[1]=S*o[0]+T*o[1]+b*o[2],i[2]=y*o[0]+E*o[1]+w*o[2],t0(this.min,r,i),sf(this.max,r,i)},n.prototype.intersects=function(e){var t=this.getMax(),r=this.getMin(),i=e.getMax(),a=e.getMin();return r[0]<=i[0]&&t[0]>=a[0]&&r[1]<=i[1]&&t[1]>=a[1]&&r[2]<=i[2]&&t[2]>=a[2]},n.prototype.intersection=function(e){if(!this.intersects(e))return null;var t=new n,r=A6([0,0,0],this.getMin(),e.getMin()),i=N6([0,0,0],this.getMax(),e.getMax());return t.setMinMax(r,i),t},n.prototype.getNegativeFarPoint=function(e){return e.pnVertexFlag===273?nl([0,0,0],this.min):e.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:e.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]},n.prototype.getPositiveFarPoint=function(e){return e.pnVertexFlag===273?nl([0,0,0],this.max):e.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:e.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]},n}(),z6=function(){function n(e,t){this.distance=e||0,this.normal=t||_.al(0,1,0),this.updatePNVertexFlag()}return n.prototype.updatePNVertexFlag=function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)},n.prototype.distanceToPoint=function(e){return _.AK(e,this.normal)-this.distance},n.prototype.normalize=function(){var e=1/_.Zh(this.normal);_.bA(this.normal,this.normal,e),this.distance*=e},n.prototype.intersectsLine=function(e,t,r){var i=this.distanceToPoint(e),a=this.distanceToPoint(t),o=i/(i-a),s=o>=0&&o<=1;return s&&r&&_.t7(r,e,t,o),s},n}(),uo;(function(n){n[n.OUTSIDE=4294967295]="OUTSIDE",n[n.INSIDE=0]="INSIDE",n[n.INDETERMINATE=2147483647]="INDETERMINATE"})(uo||(uo={}));var W6=function(){function n(e){if(this.planes=[],e)this.planes=e;else for(var t=0;t<6;t++)this.planes.push(new z6)}return n.prototype.extractFromVPMatrix=function(e){var t=Ht(e,16),r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],f=t[9],d=t[10],p=t[11],v=t[12],g=t[13],m=t[14],x=t[15];_.t8(this.planes[0].normal,o-r,u-s,p-h),this.planes[0].distance=x-v,_.t8(this.planes[1].normal,o+r,u+s,p+h),this.planes[1].distance=x+v,_.t8(this.planes[2].normal,o+i,u+l,p+f),this.planes[2].distance=x+g,_.t8(this.planes[3].normal,o-i,u-l,p-f),this.planes[3].distance=x-g,_.t8(this.planes[4].normal,o-a,u-c,p-d),this.planes[4].distance=x-m,_.t8(this.planes[5].normal,o+a,u+c,p+d),this.planes[5].distance=x+m,this.planes.forEach(function(S){S.normalize(),S.updatePNVertexFlag()})},n}(),sr=function(){function n(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.copyFrom=function(e){this.x=e.x,this.y=e.y},n}(),ho=function(){function n(e,t,r,i){this.x=e,this.y=t,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=t,this.bottom=t+i}return n.fromRect=function(e){return new n(e.x,e.y,e.width,e.height)},n.applyTransform=function(e,t){var r=fa(e.x,e.y,0,1),i=fa(e.x+e.width,e.y,0,1),a=fa(e.x,e.y+e.height,0,1),o=fa(e.x+e.width,e.y+e.height,0,1),s=an(),l=an(),c=an(),u=an();ln(s,r,t),ln(l,i,t),ln(c,a,t),ln(u,o,t);var h=Math.min(s[0],l[0],c[0],u[0]),f=Math.min(s[1],l[1],c[1],u[1]),d=Math.max(s[0],l[0],c[0],u[0]),p=Math.max(s[1],l[1],c[1],u[1]);return n.fromRect({x:h,y:f,width:d-h,height:p-f})},n.prototype.toJSON=function(){},n}(),on="Method not implemented.",rl="Use document.documentElement instead.",U6="Cannot append a destroyed element.",sn;(function(n){n[n.ORBITING=0]="ORBITING",n[n.EXPLORING=1]="EXPLORING",n[n.TRACKING=2]="TRACKING"})(sn||(sn={}));var dc;(function(n){n[n.DEFAULT=0]="DEFAULT",n[n.ROTATIONAL=1]="ROTATIONAL",n[n.TRANSLATIONAL=2]="TRANSLATIONAL",n[n.CINEMATIC=3]="CINEMATIC"})(dc||(dc={}));var Vr;(function(n){n[n.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",n[n.PERSPECTIVE=1]="PERSPECTIVE"})(Vr||(Vr={}));var bE={UPDATED:"updated"},EE=2e-4,V6=function(){function n(){this.clipSpaceNearZ=el.NEGATIVE_ONE,this.eventEmitter=new et,this.matrix=Q(),this.right=_.al(1,0,0),this.up=_.al(0,1,0),this.forward=_.al(0,0,1),this.position=_.al(0,0,1),this.focalPoint=_.al(0,0,0),this.distanceVector=_.al(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=Q(),this.projectionMatrixInverse=Q(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=sn.EXPLORING,this.trackingMode=dc.DEFAULT,this.projectionMode=Vr.PERSPECTIVE,this.frustum=new W6,this.orthoMatrix=Q()}return n.prototype.isOrtho=function(){return this.projectionMode===Vr.ORTHOGRAPHIC},n.prototype.getProjectionMode=function(){return this.projectionMode},n.prototype.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},n.prototype.getPerspectiveInverse=function(){return this.projectionMatrixInverse},n.prototype.getFrustum=function(){return this.frustum},n.prototype.getPosition=function(){return this.position},n.prototype.getFocalPoint=function(){return this.focalPoint},n.prototype.getDollyingStep=function(){return this.dollyingStep},n.prototype.getNear=function(){return this.near},n.prototype.getFar=function(){return this.far},n.prototype.getZoom=function(){return this.zoom},n.prototype.getOrthoMatrix=function(){return this.orthoMatrix},n.prototype.getView=function(){return this.view},n.prototype.setEnableUpdate=function(e){this.enableUpdate=e},n.prototype.setType=function(e,t){return this.type=e,this.type===sn.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===sn.TRACKING&&t!==void 0&&this.setTrackingMode(t),this},n.prototype.setProjectionMode=function(e){return this.projectionMode=e,this},n.prototype.setTrackingMode=function(e){if(this.type!==sn.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this},n.prototype.setWorldRotation=function(e){return this.rotateWorld=e,this._getAngles(),this},n.prototype.getViewTransform=function(){return Wt(Q(),this.matrix)},n.prototype.getWorldTransform=function(){return this.matrix},n.prototype.jitterProjectionMatrix=function(e,t){var r=ue(Q(),[e,t,0]);this.jitteredProjectionMatrix=Ut(Q(),r,this.projectionMatrix)},n.prototype.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},n.prototype.setMatrix=function(e){return this.matrix=e,this._update(),this},n.prototype.setProjectionMatrix=function(e){this.projectionMatrix=e},n.prototype.setFov=function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this},n.prototype.setAspect=function(e){return this.setPerspective(this.near,this.far,this.fov,e),this},n.prototype.setNear=function(e){return this.projectionMode===Vr.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this},n.prototype.setFar=function(e){return this.projectionMode===Vr.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this},n.prototype.setViewOffset=function(e,t,r,i,a,o){return this.aspect=e/t,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.projectionMode===Vr.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},n.prototype.clearViewOffset=function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Vr.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},n.prototype.setZoom=function(e){return this.zoom=e,this.projectionMode===Vr.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Vr.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},n.prototype.setZoomByViewportPoint=function(e,t){var r=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),i=r.x,a=r.y,o=this.roll;this.rotate(0,0,-o),this.setPosition(i,a),this.setFocalPoint(i,a),this.setZoom(e),this.rotate(0,0,o);var s=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),l=s.x,c=s.y,u=_.al(l-i,c-a,0),h=_.AK(u,this.right)/_.kE(this.right),f=_.AK(u,this.up)/_.kE(this.up),d=Ht(this.getPosition(),2),p=d[0],v=d[1],g=Ht(this.getFocalPoint(),2),m=g[0],x=g[1];return this.setPosition(p-h,v-f),this.setFocalPoint(m-h,x-f),this},n.prototype.setPerspective=function(e,t,r,i){var a;this.projectionMode=Vr.PERSPECTIVE,this.fov=r,this.near=e,this.far=t,this.aspect=i;var o=this.near*Math.tan(Ze(.5*this.fov))/this.zoom,s=2*o,l=this.aspect*s,c=-.5*l;if(!((a=this.view)===null||a===void 0)&&a.enabled){var u=this.view.fullWidth,h=this.view.fullHeight;c+=this.view.offsetX*l/u,o-=this.view.offsetY*s/h,l*=this.view.width/u,s*=this.view.height/h}return D6(this.projectionMatrix,c,c+l,o-s,o,e,this.far,this.clipSpaceNearZ===el.ZERO),Wt(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},n.prototype.setOrthographic=function(e,t,r,i,a,o){var s;this.projectionMode=Vr.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=r,this.bottom=i,this.near=a,this.far=o;var l=(this.rright-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,f=u-l,d=u+l,p=h+c,v=h-c;if(!((s=this.view)===null||s===void 0)&&s.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;f+=g*this.view.offsetX,d=f+g*this.view.width,p-=m*this.view.offsetY,v=p-m*this.view.height}return this.clipSpaceNearZ===el.NEGATIVE_ONE?Dc(this.projectionMatrix,f,d,p,v,a,o):Bc(this.projectionMatrix,f,d,p,v,a,o),Wt(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},n.prototype.setPosition=function(e,t,r){t===void 0&&(t=this.position[1]),r===void 0&&(r=this.position[2]);var i=Ur(e,t,r);return this._setPosition(i),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},n.prototype.setFocalPoint=function(e,t,r){t===void 0&&(t=this.focalPoint[1]),r===void 0&&(r=this.focalPoint[2]);var i=_.al(0,1,0);if(this.focalPoint=Ur(e,t,r),this.trackingMode===dc.CINEMATIC){var a=_.$X(_.Ue(),this.focalPoint,this.position);e=a[0],t=a[1],r=a[2];var o=_.kE(a),s=Di(Math.asin(t/o)),l=90+Di(Math.atan2(r,e)),c=Q();ur(c,c,Ze(l)),_r(c,c,Ze(s)),i=_.fF(_.Ue(),[0,1,0],c)}return Wt(this.matrix,Fc(Q(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},n.prototype.getDistance=function(){return this.distance},n.prototype.getDistanceVector=function(){return this.distanceVector},n.prototype.setDistance=function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<EE&&(this.distance=EE),this.dollyingStep=this.distance/100;var t=_.Ue();e=this.distance;var r=this.forward,i=this.focalPoint;return t[0]=e*r[0]+i[0],t[1]=e*r[1]+i[1],t[2]=e*r[2]+i[2],this._setPosition(t),this.triggerUpdate(),this},n.prototype.setMaxDistance=function(e){return this.maxDistance=e,this},n.prototype.setMinDistance=function(e){return this.minDistance=e,this},n.prototype.setAzimuth=function(e){return this.azimuth=e0(e),this.computeMatrix(),this._getAxes(),this.type===sn.ORBITING||this.type===sn.EXPLORING?this._getPosition():this.type===sn.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getAzimuth=function(){return this.azimuth},n.prototype.setElevation=function(e){return this.elevation=e0(e),this.computeMatrix(),this._getAxes(),this.type===sn.ORBITING||this.type===sn.EXPLORING?this._getPosition():this.type===sn.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getElevation=function(){return this.elevation},n.prototype.setRoll=function(e){return this.roll=e0(e),this.computeMatrix(),this._getAxes(),this.type===sn.ORBITING||this.type===sn.EXPLORING?this._getPosition():this.type===sn.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getRoll=function(){return this.roll},n.prototype._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},n.prototype.computeMatrix=function(){var e=kn(Vt(),[0,0,1],Ze(this.roll));Xt(this.matrix);var t=kn(Vt(),[1,0,0],Ze((this.rotateWorld&&this.type!==sn.TRACKING||this.type===sn.TRACKING?1:-1)*this.elevation)),r=kn(Vt(),[0,1,0],Ze((this.rotateWorld&&this.type!==sn.TRACKING||this.type===sn.TRACKING?1:-1)*this.azimuth)),i=An(Vt(),r,t);i=An(Vt(),i,e);var a=La(Q(),i);this.type===sn.ORBITING||this.type===sn.EXPLORING?(Ee(this.matrix,this.matrix,this.focalPoint),Ut(this.matrix,this.matrix,a),Ee(this.matrix,this.matrix,[0,0,this.distance])):this.type===sn.TRACKING&&(Ee(this.matrix,this.matrix,this.position),Ut(this.matrix,this.matrix,a))},n.prototype._setPosition=function(e,t,r){this.position=Ur(e,t,r);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()},n.prototype._getAxes=function(){_.JG(this.right,Ur(ln(an(),[1,0,0,0],this.matrix))),_.JG(this.up,Ur(ln(an(),[0,1,0,0],this.matrix))),_.JG(this.forward,Ur(ln(an(),[0,0,1,0],this.matrix))),_.Fv(this.right,this.right),_.Fv(this.up,this.up),_.Fv(this.forward,this.forward)},n.prototype._getAngles=function(){var e=this.distanceVector[0],t=this.distanceVector[1],r=this.distanceVector[2],i=_.kE(this.distanceVector);if(i===0){this.elevation=0,this.azimuth=0;return}this.type===sn.TRACKING?(this.elevation=Di(Math.asin(t/i)),this.azimuth=Di(Math.atan2(-e,-r))):this.rotateWorld?(this.elevation=Di(Math.asin(t/i)),this.azimuth=Di(Math.atan2(-e,-r))):(this.elevation=-Di(Math.asin(t/i)),this.azimuth=-Di(Math.atan2(-e,-r)))},n.prototype._getPosition=function(){_.JG(this.position,Ur(ln(an(),[0,0,0,1],this.matrix))),this._getDistance()},n.prototype._getFocalPoint=function(){_.kK(this.distanceVector,[0,0,-this.distance],qi.xO(qi.Ue(),this.matrix)),_.IH(this.focalPoint,this.position,this.distanceVector),this._getDistance()},n.prototype._getDistance=function(){this.distanceVector=_.$X(_.Ue(),this.focalPoint,this.position),this.distance=_.kE(this.distanceVector),this.dollyingStep=this.distance/100},n.prototype._getOrthoMatrix=function(){if(this.projectionMode===Vr.ORTHOGRAPHIC){var e=this.position,t=kn(Vt(),[0,0,1],-this.roll*Math.PI/180);fr(this.orthoMatrix,t,_.al((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),_.al(this.zoom,this.zoom,1),e)}},n.prototype.triggerUpdate=function(){if(this.enableUpdate){var e=this.getViewTransform(),t=Ut(Q(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(t),this.eventEmitter.emit(bE.UPDATED)}},n.prototype.rotate=function(e,t,r){throw new Error(on)},n.prototype.pan=function(e,t){throw new Error(on)},n.prototype.dolly=function(e){throw new Error(on)},n.prototype.createLandmark=function(e,t){throw new Error(on)},n.prototype.gotoLandmark=function(e,t){throw new Error(on)},n.prototype.cancelLandmarkAnimation=function(){throw new Error(on)},n}();function $n(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var t=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=e?e.apply(this,r):r[0],o=t.cache;if(o.has(a))return o.get(a);var s=n.apply(this,r);return t.cache=o.set(a,s)||o,s};return t.cache=new($n.Cache||Map),t}$n.Cache=Map;var Et;(function(n){n[n.kUnknown=0]="kUnknown",n[n.kNumber=1]="kNumber",n[n.kPercentage=2]="kPercentage",n[n.kEms=3]="kEms",n[n.kPixels=4]="kPixels",n[n.kRems=5]="kRems",n[n.kDegrees=6]="kDegrees",n[n.kRadians=7]="kRadians",n[n.kGradians=8]="kGradians",n[n.kTurns=9]="kTurns",n[n.kMilliseconds=10]="kMilliseconds",n[n.kSeconds=11]="kSeconds",n[n.kInteger=12]="kInteger"})(Et||(Et={}));var ui;(function(n){n[n.kUNumber=0]="kUNumber",n[n.kUPercent=1]="kUPercent",n[n.kULength=2]="kULength",n[n.kUAngle=3]="kUAngle",n[n.kUTime=4]="kUTime",n[n.kUOther=5]="kUOther"})(ui||(ui={}));var wE;(function(n){n[n.kAll=0]="kAll",n[n.kNonNegative=1]="kNonNegative",n[n.kInteger=2]="kInteger",n[n.kNonNegativeInteger=3]="kNonNegativeInteger",n[n.kPositiveInteger=4]="kPositiveInteger"})(wE||(wE={}));var i0;(function(n){n[n.kYes=0]="kYes",n[n.kNo=1]="kNo"})(i0||(i0={}));var a0;(function(n){n[n.kYes=0]="kYes",n[n.kNo=1]="kNo"})(a0||(a0={}));var H6=[{name:"em",unit_type:Et.kEms},{name:"px",unit_type:Et.kPixels},{name:"deg",unit_type:Et.kDegrees},{name:"rad",unit_type:Et.kRadians},{name:"grad",unit_type:Et.kGradians},{name:"ms",unit_type:Et.kMilliseconds},{name:"s",unit_type:Et.kSeconds},{name:"rem",unit_type:Et.kRems},{name:"turn",unit_type:Et.kTurns}],fo;(function(n){n[n.kUnknownType=0]="kUnknownType",n[n.kUnparsedType=1]="kUnparsedType",n[n.kKeywordType=2]="kKeywordType",n[n.kUnitType=3]="kUnitType",n[n.kSumType=4]="kSumType",n[n.kProductType=5]="kProductType",n[n.kNegateType=6]="kNegateType",n[n.kInvertType=7]="kInvertType",n[n.kMinType=8]="kMinType",n[n.kMaxType=9]="kMaxType",n[n.kClampType=10]="kClampType",n[n.kTransformType=11]="kTransformType",n[n.kPositionType=12]="kPositionType",n[n.kURLImageType=13]="kURLImageType",n[n.kColorType=14]="kColorType",n[n.kUnsupportedColorType=15]="kUnsupportedColorType"})(fo||(fo={}));var Y6=function(n){return H6.find(function(e){return e.name===n}).unit_type},X6=function(n){return n?n==="number"?Et.kNumber:n==="percent"||n==="%"?Et.kPercentage:Y6(n):Et.kUnknown},j6=function(n){switch(n){case Et.kNumber:case Et.kInteger:return ui.kUNumber;case Et.kPercentage:return ui.kUPercent;case Et.kPixels:return ui.kULength;case Et.kMilliseconds:case Et.kSeconds:return ui.kUTime;case Et.kDegrees:case Et.kRadians:case Et.kGradians:case Et.kTurns:return ui.kUAngle;default:return ui.kUOther}},$6=function(n){switch(n){case ui.kUNumber:return Et.kNumber;case ui.kULength:return Et.kPixels;case ui.kUPercent:return Et.kPercentage;case ui.kUTime:return Et.kSeconds;case ui.kUAngle:return Et.kDegrees;default:return Et.kUnknown}},SE=function(n){var e=1;switch(n){case Et.kPixels:case Et.kDegrees:case Et.kSeconds:break;case Et.kMilliseconds:e=.001;break;case Et.kRadians:e=180/Math.PI;break;case Et.kGradians:e=.9;break;case Et.kTurns:e=360;break}return e},o0=function(n){switch(n){case Et.kNumber:case Et.kInteger:return"";case Et.kPercentage:return"%";case Et.kEms:return"em";case Et.kRems:return"rem";case Et.kPixels:return"px";case Et.kDegrees:return"deg";case Et.kRadians:return"rad";case Et.kGradians:return"grad";case Et.kMilliseconds:return"ms";case Et.kSeconds:return"s";case Et.kTurns:return"turn"}return""},lf=function(){function n(){}return n.isAngle=function(e){return e===Et.kDegrees||e===Et.kRadians||e===Et.kGradians||e===Et.kTurns},n.isLength=function(e){return e>=Et.kEms&&e<Et.kDegrees},n.isRelativeUnit=function(e){return e===Et.kPercentage||e===Et.kEms||e===Et.kRems},n.isTime=function(e){return e===Et.kSeconds||e===Et.kMilliseconds},n.prototype.toString=function(){return this.buildCSSText(i0.kNo,a0.kNo,"")},n.prototype.isNumericValue=function(){return this.getType()>=fo.kUnitType&&this.getType()<=fo.kClampType},n}(),K6=function(n){Me(e,n);function e(t){var r=n.call(this)||this;return r.colorSpace=t,r}return e.prototype.getType=function(){return fo.kColorType},e.prototype.to=function(t){return this},e}(lf),il;(function(n){n[n.Constant=0]="Constant",n[n.LinearGradient=1]="LinearGradient",n[n.RadialGradient=2]="RadialGradient"})(il||(il={}));var cf=function(n){Me(e,n);function e(t,r){var i=n.call(this)||this;return i.type=t,i.value=r,i}return e.prototype.clone=function(){return new e(this.type,this.value)},e.prototype.buildCSSText=function(t,r,i){return i},e.prototype.getType=function(){return fo.kColorType},e}(lf),Hr=function(n){Me(e,n);function e(t){var r=n.call(this)||this;return r.value=t,r}return e.prototype.clone=function(){return new e(this.value)},e.prototype.getType=function(){return fo.kKeywordType},e.prototype.buildCSSText=function(t,r,i){return i+this.value},e}(lf),Z6=$n(function(n){return n===void 0&&(n=""),n.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})}),_E=function(n){return n.split("").map(function(e,t){return e.toUpperCase()===e?"".concat(t!==0?"-":"").concat(e.toLowerCase()):e}).join("")};function q6(n){if(!n)throw new Error}function al(n){return typeof n=="function"}function J6(n){return typeof n=="symbol"}var ZW=function(n){return Object.fromEntries(Object.entries(n).filter(function(e){var t=__read(e,2),r=t[1];return r!==void 0}))},Q6={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign"},src:{alias:"img"}},s0=$n(function(n){var e=Z6(n),t=Q6[e];return e=(t==null?void 0:t.alias)||e,e}),tB=function(n,e){e===void 0&&(e="");var t="";return Number.isFinite(n)?(q6(Number.isNaN(n)),t="NaN"):n>0?t="infinity":t="-infinity",t+=e},l0=function(n){return $6(j6(n))},De=function(n){Me(e,n);function e(t,r){r===void 0&&(r=Et.kNumber);var i=n.call(this)||this,a;return typeof r=="string"?a=X6(r):a=r,i.unit=a,i.value=t,i}return e.prototype.clone=function(){return new e(this.value,this.unit)},e.prototype.equals=function(t){var r=t;return this.value===r.value&&this.unit===r.unit},e.prototype.getType=function(){return fo.kUnitType},e.prototype.convertTo=function(t){if(this.unit===t)return new e(this.value,this.unit);var r=l0(this.unit);if(r!==l0(t)||r===Et.kUnknown)return null;var i=SE(this.unit)/SE(t);return new e(this.value*i,t)},e.prototype.buildCSSText=function(t,r,i){var a;switch(this.unit){case Et.kUnknown:break;case Et.kInteger:a=Number(this.value).toFixed(0);break;case Et.kNumber:case Et.kPercentage:case Et.kEms:case Et.kRems:case Et.kPixels:case Et.kDegrees:case Et.kRadians:case Et.kGradians:case Et.kMilliseconds:case Et.kSeconds:case Et.kTurns:{var o=-999999,s=999999,l=this.value,c=o0(this.unit);if(l<o||l>s){var u=o0(this.unit);!Number.isFinite(l)||Number.isNaN(l)?a=tB(l,u):a=l+(u||"")}else a="".concat(l).concat(c)}}return i+=a,i},e}(lf),En=new De(0,"px");new De(1,"px");var Bi=new De(0,"deg"),c0=function(n){Me(e,n);function e(t,r,i,a,o){a===void 0&&(a=1),o===void 0&&(o=!1);var s=n.call(this,"rgb")||this;return s.r=t,s.g=r,s.b=i,s.alpha=a,s.isNone=o,s}return e.prototype.clone=function(){return new e(this.r,this.g,this.b,this.alpha)},e.prototype.buildCSSText=function(t,r,i){return i+"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")},e}(K6),qe=new Hr("unset"),eB=new Hr("initial"),nB=new Hr("inherit"),u0={"":qe,unset:qe,initial:eB,inherit:nB},h0=function(n){return u0[n]||(u0[n]=new Hr(n)),u0[n]},uf=new c0(0,0,0,0,!0),TE=new c0(0,0,0,0),rB=$n(function(n,e,t,r){return new c0(n,e,t,r)},function(n,e,t,r){return"rgba(".concat(n,",").concat(e,",").concat(t,",").concat(r,")")}),Ue=function(n,e){return e===void 0&&(e=Et.kNumber),new De(n,e)};new De(50,"%");var f0;(function(n){n[n.Standard=0]="Standard"})(f0||(f0={}));var ol;(function(n){n[n.ADDED=0]="ADDED",n[n.REMOVED=1]="REMOVED",n[n.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED"})(ol||(ol={}));var PE={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ho(0,0,0,0)},Tt;(function(n){n.COORDINATE="<coordinate>",n.COLOR="<color>",n.PAINT="<paint>",n.NUMBER="<number>",n.ANGLE="<angle>",n.OPACITY_VALUE="<opacity-value>",n.SHADOW_BLUR="<shadow-blur>",n.LENGTH="<length>",n.PERCENTAGE="<percentage>",n.LENGTH_PERCENTAGE="<length> | <percentage>",n.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",n.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",n.LIST_OF_POINTS="<list-of-points>",n.PATH="<path>",n.FILTER="<filter>",n.Z_INDEX="<z-index>",n.OFFSET_DISTANCE="<offset-distance>",n.DEFINED_PATH="<defined-path>",n.MARKER="<marker>",n.TRANSFORM="<transform>",n.TRANSFORM_ORIGIN="<transform-origin>",n.TEXT="<text>",n.TEXT_TRANSFORM="<text-transform>"})(Tt||(Tt={}));function iB(n){var e=n.type,t=n.value;return e==="hex"?"#".concat(t):e==="literal"?t:e==="rgb"?"rgb(".concat(t.join(","),")"):"rgba(".concat(t.join(","),")")}var aB=function(){var n={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function t(I){throw new Error(e+": "+I)}function r(){var I=i();return e.length>0&&t("Invalid input not EOF"),I}function i(){return S(a)}function a(){return o("linear-gradient",n.linearGradient,l)||o("repeating-linear-gradient",n.repeatingLinearGradient,l)||o("radial-gradient",n.radialGradient,h)||o("repeating-radial-gradient",n.repeatingRadialGradient,h)||o("conic-gradient",n.conicGradient,h)}function o(I,q,J){return s(q,function(wt){var Ft=J();return Ft&&(z(n.comma)||t("Missing comma before color stops")),{type:I,orientation:Ft,colorStops:S(T)}})}function s(I,q){var J=z(I);if(J){z(n.startCall)||t("Missing (");var wt=q(J);return z(n.endCall)||t("Missing )"),wt}}function l(){return c()||u()}function c(){return L("directional",n.sideOrCorner,1)}function u(){return L("angular",n.angleValue,1)}function h(){var I,q=f(),J;return q&&(I=[],I.push(q),J=e,z(n.comma)&&(q=f(),q?I.push(q):e=J)),I}function f(){var I=d()||p();if(I)I.at=g();else{var q=v();if(q){I=q;var J=g();J&&(I.at=J)}else{var wt=m();wt&&(I={type:"default-radial",at:wt})}}return I}function d(){var I=L("shape",/^(circle)/i,0);return I&&(I.style=R()||v()),I}function p(){var I=L("shape",/^(ellipse)/i,0);return I&&(I.style=O()||v()),I}function v(){return L("extent-keyword",n.extentKeywords,1)}function g(){if(L("position",/^at/,0)){var I=m();return I||t("Missing positioning value"),I}}function m(){var I=x();if(I.x||I.y)return{type:"position",value:I}}function x(){return{x:O(),y:O()}}function S(I){var q=I(),J=[];if(q)for(J.push(q);z(n.comma);)q=I(),q?J.push(q):t("One extra comma");return J}function T(){var I=b();return I||t("Expected color definition"),I.length=O(),I}function b(){return E()||C()||w()||y()}function y(){return L("literal",n.literalColor,0)}function E(){return L("hex",n.hexColor,1)}function w(){return s(n.rgbColor,function(){return{type:"rgb",value:S(M)}})}function C(){return s(n.rgbaColor,function(){return{type:"rgba",value:S(M)}})}function M(){return z(n.number)[1]}function O(){return L("%",n.percentageValue,1)||A()||R()}function A(){return L("position-keyword",n.positionKeywords,1)}function R(){return L("px",n.pixelValue,1)||L("em",n.emValue,1)}function L(I,q,J){var wt=z(q);if(wt)return{type:I,value:wt[J]}}function z(I){var q=/^[\n\r\t\s]+/.exec(e);q&&Y(q[0].length);var J=I.exec(e);return J&&Y(J[0].length),J}function Y(I){e=e.substring(I)}return function(I){return e=I,r()}}();function qW(n,e,t,r){var i=Ze(r.value),a=0,o=0,s=a+e/2,l=o+t/2,c=Math.abs(e*Math.cos(i))+Math.abs(t*Math.sin(i)),u=n[0]+s-Math.cos(i)*c/2,h=n[1]+l-Math.sin(i)*c/2,f=n[0]+s+Math.cos(i)*c/2,d=n[1]+l+Math.sin(i)*c/2;return{x1:u,y1:h,x2:f,y2:d}}function JW(n,e,t,r,i,a){var o=r.value,s=i.value;r.unit===Et.kPercentage&&(o=r.value/100*e),i.unit===Et.kPercentage&&(s=i.value/100*t);var l=Math.max(distanceSquareRoot([0,0],[o,s]),distanceSquareRoot([0,t],[o,s]),distanceSquareRoot([e,t],[o,s]),distanceSquareRoot([e,0],[o,s]));return a&&(a instanceof De?l=a.value:a instanceof Hr&&(a.value==="closest-side"?l=Math.min(o,e-o,s,t-s):a.value==="farthest-side"?l=Math.max(o,e-o,s,t-s):a.value==="closest-corner"&&(l=Math.min(distanceSquareRoot([0,0],[o,s]),distanceSquareRoot([0,t],[o,s]),distanceSquareRoot([e,t],[o,s]),distanceSquareRoot([e,0],[o,s]))))),{x:o+n[0],y:s+n[1],r:l}}var oB=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,sB=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,lB=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,ME=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function cB(n){var e,t,r,i=n.length;n[i-1].length=(e=n[i-1].length)!==null&&e!==void 0?e:{type:"%",value:"100"},i>1&&(n[0].length=(t=n[0].length)!==null&&t!==void 0?t:{type:"%",value:"0"});for(var a=0,o=Number(n[0].length.value),s=1;s<i;s++){var l=(r=n[s].length)===null||r===void 0?void 0:r.value;if(!pt(l)&&!pt(o)){for(var c=1;c<s-a;c++)n[a+c].length={type:"%",value:"".concat(o+(Number(l)-o)*c/(s-a))};a=s,o=Number(l)}}}var uB={left:270-90,top:0-90,bottom:180-90,right:90-90,"left top":315-90,"top left":315-90,"left bottom":225-90,"bottom left":225-90,"right top":45-90,"top right":45-90,"right bottom":135-90,"bottom right":135-90},hB=$n(function(n){var e;return n.type==="angular"?e=Number(n.value):e=uB[n.value]||0,Ue(e,"deg")}),fB=$n(function(n){var e=50,t=50,r="%",i="%";if((n==null?void 0:n.type)==="position"){var a=n.value,o=a.x,s=a.y;(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?e=0:o.value==="center"?e=50:o.value==="right"?e=100:o.value==="top"?t=0:o.value==="bottom"&&(t=100)),(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?e=0:s.value==="center"?t=50:s.value==="right"?e=100:s.value==="top"?t=0:s.value==="bottom"&&(t=100)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(r=o==null?void 0:o.type,e=Number(o.value)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(i=s==null?void 0:s.type,t=Number(s.value))}return{cx:Ue(e,r),cy:Ue(t,i)}}),dB=$n(function(n){var e;if(n.indexOf("linear")>-1||n.indexOf("radial")>-1){var t=aB(n);return t.map(function(s){var l=s.type,c=s.orientation,u=s.colorStops;cB(u);var h=u.map(function(S){return{offset:Ue(Number(S.length.value),"%"),color:iB(S)}});if(l==="linear-gradient")return new cf(il.LinearGradient,{angle:c?hB(c):Bi,steps:h});if(l==="radial-gradient"&&(c||(c=[{type:"shape",value:"circle"}]),c[0].type==="shape"&&c[0].value==="circle")){var f=fB(c[0].at),d=f.cx,p=f.cy,v=void 0;if(c[0].style){var g=c[0].style,m=g.type,x=g.value;m==="extent-keyword"?v=h0(x):v=Ue(x,m)}return new cf(il.RadialGradient,{cx:d,cy:p,size:v,steps:h})}})}var r=n[0];if(n[1]==="("||n[2]==="("){if(r==="l"){var i=oB.exec(n);if(i){var a=((e=i[2].match(ME))===null||e===void 0?void 0:e.map(function(s){return s.split(":")}))||[];return[new cf(il.LinearGradient,{angle:Ue(parseFloat(i[1]),"deg"),steps:a.map(function(s){var l=Ht(s,2),c=l[0],u=l[1];return{offset:Ue(Number(c)*100,"%"),color:u}})})]}}else if(r==="r"){var o=pB(n);if(o)if(qt(o))n=o;else return[new cf(il.RadialGradient,o)]}else if(r==="p")return vB(n)}});function pB(n){var e,t=sB.exec(n);if(t){var r=((e=t[4].match(ME))===null||e===void 0?void 0:e.map(function(i){return i.split(":")}))||[];return{cx:Ue(50,"%"),cy:Ue(50,"%"),steps:r.map(function(i){var a=Ht(i,2),o=a[0],s=a[1];return{offset:Ue(Number(o)*100,"%"),color:s}})}}return null}function vB(n){var e=lB.exec(n);if(e){var t=e[1],r=e[2];switch(t){case"a":t="repeat";break;case"x":t="repeat-x";break;case"y":t="repeat-y";break;case"n":t="no-repeat";break;default:t="no-repeat"}return{image:r,repetition:t}}return null}function QW(n){return!!n.type&&!!n.value}function d0(n){return n&&!!n.image}function hf(n){return n&&!pt(n.r)&&!pt(n.g)&&!pt(n.b)}var sl=$n(function(n){if(d0(n))return se({repetition:"repeat"},n);if(pt(n)&&(n=""),n==="transparent")return TE;if(n==="currentColor")n="black";else if(n==="none")return uf;var e=dB(n);if(e)return e;var t=ld.ZP(n),r=[0,0,0,0];return t!==null&&(r[0]=t.r||0,r[1]=t.g||0,r[2]=t.b||0,r[3]=t.opacity),rB.apply(void 0,nn([],Ht(r),!1))});function gB(n,e){if(!(!hf(n)||!hf(e)))return[[Number(n.r),Number(n.g),Number(n.b),Number(n.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var r=t.slice();if(r[3])for(var i=0;i<3;i++)r[i]=Math.round(he(r[i],0,255));return r[3]=he(r[3],0,1),"rgba(".concat(r.join(","),")")}]}function pc(n,e){if(pt(e))return Ue(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(n)>=0)return Ue(Number(e),"px");if("deg".search(n)>=0)return Ue(Number(e),"deg")}var t=[];e=e.replace(n,function(i){return t.push(i),"U"+i});var r="U("+n.source+")";return t.map(function(i){return Ue(Number(e.replace(new RegExp("U"+i,"g"),"").replace(new RegExp(r,"g"),"*0")),i)})[0]}var CE=function(n){return pc(new RegExp("px","g"),n)},mB=$n(CE),yB=function(n){return pc(new RegExp("%","g"),n)};$n(yB);var vc=function(n){return te(n)||isFinite(Number(n))?Ue(Number(n)||0,"px"):pc(new RegExp("px|%|em|rem","g"),n)},ll=$n(vc),p0=function(n){return pc(new RegExp("deg|rad|grad|turn","g"),n)},OE=$n(p0);function xB(n,e,t,r,i){i===void 0&&(i=0);var a="",o=n.value||0,s=e.value||0,l=l0(n.unit),c=n.convertTo(l),u=e.convertTo(l);return c&&u?(o=c.value,s=u.value,a=o0(n.unit)):(De.isLength(n.unit)||De.isLength(e.unit))&&(o=hi(n,i,t),s=hi(e,i,t),a="px"),[o,s,function(h){return r&&(h=Math.max(h,0)),h+a}]}function Yr(n){var e=0;return n.unit===Et.kDegrees?e=n.value:n.unit===Et.kRadians?e=Di(Number(n.value)):n.unit===Et.kTurns&&(e=R6(Number(n.value))),e}function AE(n,e){var t;return Array.isArray(n)?t=n.map(function(r){return Number(r)}):qt(n)?t=n.split(" ").map(function(r){return Number(r)}):te(n)&&(t=[n]),e===2?t.length===1?[t[0],t[0]]:[t[0],t[1]]:t.length===1?[t[0],t[0],t[0],t[0]]:t.length===2?[t[0],t[1],t[0],t[1]]:t.length===3?[t[0],t[1],t[2],t[1]]:[t[0],t[1],t[2],t[3]]}function NE(n){return qt(n)?n.split(" ").map(function(e){return ll(e)}):n.map(function(e){return ll(e.toString())})}function hi(n,e,t,r){if(r===void 0&&(r=!1),n.unit===Et.kPixels)return Number(n.value);if(n.unit===Et.kPercentage&&t){var i=t.nodeName===At.GROUP?t.getLocalBounds():t.getGeometryBounds();return(r?i.min[e]:0)+n.value/100*i.halfExtents[e]*2}return 0}var bB=function(n){return pc(/deg|rad|grad|turn|px|%/g,n)},EB=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function RE(n){if(n===void 0&&(n=""),n=n.toLowerCase().trim(),n==="none")return[];for(var e=/\s*([\w-]+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];if(i=r.index+r[0].length,EB.indexOf(r[1])>-1&&t.push({name:r[1],params:r[2].split(" ").map(function(a){return bB(a)||sl(a)})}),e.lastIndex===n.length)return t}return[]}function kE(n){return n.toString()}var cl=function(n){return typeof n=="number"?Ue(n):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(n)?Ue(Number(n)):Ue(0)},Jo=$n(cl);$n(function(n){return qt(n)?n.split(" ").map(Jo):n.map(Jo)});function v0(n,e){return[n,e,kE]}function g0(n,e){return function(t,r){return[t,r,function(i){return kE(he(i,n,e))}]}}function LE(n,e){if(n.length===e.length)return[n,e,function(t){return t}]}function IE(n){return n.parsedStyle.d.totalLength===0&&(n.parsedStyle.d.totalLength=nd(n.parsedStyle.d.absolutePath)),n.parsedStyle.d.totalLength}function wB(n){return n.parsedStyle.points.totalLength===0&&(n.parsedStyle.points.totalLength=gd(n.parsedStyle.points.points)),n.parsedStyle.points.totalLength}function SB(n){for(var e=0;e<n.length;e++){var t=n[e-1],r=n[e],i=r[0];if(i==="M"&&t){var a=t[0],o=[r[1],r[2]],s=void 0;a==="L"||a==="M"?s=[t[1],t[2]]:(a==="C"||a==="A"||a==="Q")&&(s=[t[t.length-2],t[t.length-1]]),s&&ff(o,s)&&(n.splice(e,1),e--)}}}function _B(n){for(var e=!1,t=n.length,r=0;r<t;r++){var i=n[r],a=i[0];if(a==="C"||a==="A"||a==="Q"){e=!0;break}}return e}function TB(n){for(var e=[],t=[],r=[],i=0;i<n.length;i++){var a=n[i],o=a[0];o==="M"?(r.length&&(t.push(r),r=[]),r.push([a[1],a[2]])):o==="Z"?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]])}return r.length>0&&t.push(r),{polygons:e,polylines:t}}function ff(n,e){return n[0]===e[0]&&n[1]===e[1]}function PB(n,e){for(var t=[],r=[],i=[],a=0;a<n.length;a++){var o=n[a],s=o.currentPoint,l=o.params,c=o.prePoint,u=void 0;switch(o.command){case"Q":u=yd(c[0],c[1],l[1],l[2],l[3],l[4]);break;case"C":u=vd(c[0],c[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;u=dd(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:t.push(s[0]),r.push(s[1]);break}u&&(o.box=u,t.push(u.x,u.x+u.width),r.push(u.y,u.y+u.height)),e&&(o.command==="L"||o.command==="M")&&o.prePoint&&o.nextPoint&&i.push(o)}t=t.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0}),r=r.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0});var f=Fa(t),d=Fa(r),p=Ga(t),v=Ga(r);if(i.length===0)return{x:f,y:d,width:p-f,height:v-d};for(var a=0;a<i.length;a++){var o=i[a],s=o.currentPoint,g=void 0;s[0]===f?(g=df(o,e),f=f-g.xExtra):s[0]===p&&(g=df(o,e),p=p+g.xExtra),s[1]===d?(g=df(o,e),d=d-g.yExtra):s[1]===v&&(g=df(o,e),v=v+g.yExtra)}return{x:f,y:d,width:p-f,height:v-d}}function df(n,e){var t=n.prePoint,r=n.currentPoint,i=n.nextPoint,a=Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2),l=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!l||Math.sin(l)===0||Co(l,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));c=c>Math.PI/2?Math.PI-c:c,u=u>Math.PI/2?Math.PI-u:u;var h={xExtra:Math.cos(l/2-c)*(e/2*(1/Math.sin(l/2)))-e/2||0,yExtra:Math.cos(u-l/2)*(e/2*(1/Math.sin(l/2)))-e/2||0};return h}function DE(n,e){return[e[0]+(e[0]-n[0]),e[1]+(e[1]-n[1])]}var BE=function(n,e){var t=n.x*e.x+n.y*e.y,r=Math.sqrt((Math.pow(n.x,2)+Math.pow(n.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2))),i=n.x*e.y-n.y*e.x<0?-1:1,a=i*Math.acos(t/r);return a},FE=function(n,e,t,r,i,a,o,s){e=Math.abs(e),t=Math.abs(t),r=us(r,360);var l=Ze(r);if(n.x===o.x&&n.y===o.y)return{x:n.x,y:n.y,ellipticalArcAngle:0};if(e===0||t===0)return{x:0,y:0,ellipticalArcAngle:0};var c=(n.x-o.x)/2,u=(n.y-o.y)/2,h={x:Math.cos(l)*c+Math.sin(l)*u,y:-Math.sin(l)*c+Math.cos(l)*u},f=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(t,2);f>1&&(e=Math.sqrt(f)*e,t=Math.sqrt(f)*t);var d=Math.pow(e,2)*Math.pow(t,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(t,2)*Math.pow(h.x,2),p=Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(t,2)*Math.pow(h.x,2),v=d/p;v=v<0?0:v;var g=(i!==a?1:-1)*Math.sqrt(v),m={x:g*(e*h.y/t),y:g*(-(t*h.x)/e)},x={x:Math.cos(l)*m.x-Math.sin(l)*m.y+(n.x+o.x)/2,y:Math.sin(l)*m.x+Math.cos(l)*m.y+(n.y+o.y)/2},S={x:(h.x-m.x)/e,y:(h.y-m.y)/t},T=BE({x:1,y:0},S),b={x:(-h.x-m.x)/e,y:(-h.y-m.y)/t},y=BE(S,b);!a&&y>0?y-=2*Math.PI:a&&y<0&&(y+=2*Math.PI),y%=2*Math.PI;var E=T+y*s,w=e*Math.cos(E),C=t*Math.sin(E),M={x:Math.cos(l)*w-Math.sin(l)*C+x.x,y:Math.sin(l)*w+Math.cos(l)*C+x.y,ellipticalArcStartAngle:T,ellipticalArcEndAngle:T+y,ellipticalArcAngle:E,ellipticalArcCenter:x,resultantRx:e,resultantRy:t};return M};function MB(n){for(var e=[],t=null,r=null,i=null,a=0,o=n.length,s=0;s<o;s++){var l=n[s];r=n[s+1];var c=l[0],u={command:c,prePoint:t,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(c){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=CB(t,l);u.arcParams=h;break}if(c==="Z")t=i,r=n[a+1];else{var f=l.length;t=[l[f-2],l[f-1]]}r&&r[0]==="Z"&&(r=n[a],e[a]&&(e[a].prePoint=t)),u.currentPoint=t,e[a]&&ff(t,e[a].currentPoint)&&(e[a].prePoint=u.prePoint);var d=r?[r[r.length-2],r[r.length-1]]:null;u.nextPoint=d;var p=u.prePoint;if(["L","H","V"].includes(c))u.startTangent=[p[0]-t[0],p[1]-t[1]],u.endTangent=[t[0]-p[0],t[1]-p[1]];else if(c==="Q"){var v=[l[1],l[2]];u.startTangent=[p[0]-v[0],p[1]-v[1]],u.endTangent=[t[0]-v[0],t[1]-v[1]]}else if(c==="T"){var g=e[s-1],v=DE(g.currentPoint,p);g.command==="Q"?(u.command="Q",u.startTangent=[p[0]-v[0],p[1]-v[1]],u.endTangent=[t[0]-v[0],t[1]-v[1]]):(u.command="TL",u.startTangent=[p[0]-t[0],p[1]-t[1]],u.endTangent=[t[0]-p[0],t[1]-p[1]])}else if(c==="C"){var m=[l[1],l[2]],x=[l[3],l[4]];u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]],u.startTangent[0]===0&&u.startTangent[1]===0&&(u.startTangent=[m[0]-x[0],m[1]-x[1]]),u.endTangent[0]===0&&u.endTangent[1]===0&&(u.endTangent=[x[0]-m[0],x[1]-m[1]])}else if(c==="S"){var g=e[s-1],m=DE(g.currentPoint,p),x=[l[1],l[2]];g.command==="C"?(u.command="C",u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]]):(u.command="SQ",u.startTangent=[p[0]-x[0],p[1]-x[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]])}else if(c==="A"){var S=GE(u,0),T=S.x,b=S.y,y=GE(u,1,!1),E=y.x,w=y.y;u.startTangent=[T,b],u.endTangent=[E,w]}e.push(u)}return e}function GE(n,e,t){t===void 0&&(t=!0);var r=n.arcParams,i=r.rx,a=i===void 0?0:i,o=r.ry,s=o===void 0?0:o,l=r.xRotation,c=r.arcFlag,u=r.sweepFlag,h=FE({x:n.prePoint[0],y:n.prePoint[1]},a,s,l,!!c,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},e),f=FE({x:n.prePoint[0],y:n.prePoint[1]},a,s,l,!!c,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},t?e+.005:e-.005),d=f.x-h.x,p=f.y-h.y,v=Math.sqrt(d*d+p*p);return{x:-d/v,y:-p/v}}function pf(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function m0(n,e){return pf(n)*pf(e)?(n[0]*e[0]+n[1]*e[1])/(pf(n)*pf(e)):1}function zE(n,e){return(n[0]*e[1]<n[1]*e[0]?-1:1)*Math.acos(m0(n,e))}function CB(n,e){var t=e[1],r=e[2],i=us(Ze(e[3]),Math.PI*2),a=e[4],o=e[5],s=n[0],l=n[1],c=e[6],u=e[7],h=Math.cos(i)*(s-c)/2+Math.sin(i)*(l-u)/2,f=-1*Math.sin(i)*(s-c)/2+Math.cos(i)*(l-u)/2,d=h*h/(t*t)+f*f/(r*r);d>1&&(t*=Math.sqrt(d),r*=Math.sqrt(d));var p=t*t*(f*f)+r*r*(h*h),v=p?Math.sqrt((t*t*(r*r)-p)/p):1;a===o&&(v*=-1),isNaN(v)&&(v=0);var g=r?v*t*f/r:0,m=t?v*-r*h/t:0,x=(s+c)/2+Math.cos(i)*g-Math.sin(i)*m,S=(l+u)/2+Math.sin(i)*g+Math.cos(i)*m,T=[(h-g)/t,(f-m)/r],b=[(-1*h-g)/t,(-1*f-m)/r],y=zE([1,0],T),E=zE(T,b);return m0(T,b)<=-1&&(E=Math.PI),m0(T,b)>=1&&(E=0),o===0&&E>0&&(E=E-2*Math.PI),o===1&&E<0&&(E=E+2*Math.PI),{cx:x,cy:S,rx:ff(n,[c,u])?0:t,ry:ff(n,[c,u])?0:r,startAngle:y,endAngle:y+E,xRotation:i,arcFlag:a,sweepFlag:o}}function OB(n,e,t){return n.reduce(function(r,i){var a="";if(i[0]==="M"||i[0]==="L"){var o=vec3.fromValues(i[1],i[2],0);t&&vec3.transformMat4(o,o,t),a="".concat(i[0]).concat(o[0],",").concat(o[1])}else if(i[0]==="Z")a=i[0];else if(i[0]==="C"){var s=vec3.fromValues(i[1],i[2],0),l=vec3.fromValues(i[3],i[4],0),c=vec3.fromValues(i[5],i[6],0);t&&(vec3.transformMat4(s,s,t),vec3.transformMat4(l,l,t),vec3.transformMat4(c,c,t)),a="".concat(i[0]).concat(s[0],",").concat(s[1],",").concat(l[0],",").concat(l[1],",").concat(c[0],",").concat(c[1])}else if(i[0]==="A"){var u=vec3.fromValues(i[6],i[7],0);t&&vec3.transformMat4(u,u,t),a="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],",").concat(i[5],",").concat(u[0],",").concat(u[1])}else if(i[0]==="Q"){var s=vec3.fromValues(i[1],i[2],0),l=vec3.fromValues(i[3],i[4],0);t&&(vec3.transformMat4(s,s,t),vec3.transformMat4(l,l,t)),a="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],"}")}return r+=a},"")}function AB(n,e,t,r){return[["M",n,e],["L",t,r]]}function WE(n,e,t,r){var i=(-1+Math.sqrt(2))/3*4,a=n*i,o=e*i,s=t-n,l=t+n,c=r-e,u=r+e;return[["M",s,r],["C",s,r-o,t-a,c,t,c],["C",t+a,c,l,r-o,l,r],["C",l,r+o,t+a,u,t,u],["C",t-a,u,s,r+o,s,r],["Z"]]}function NB(n,e){var t=n.map(function(r,i){return[i===0?"M":"L",r[0],r[1]]});return e&&t.push(["Z"]),t}function RB(n,e,t,r,i){if(i){var a=__read(i,4),o=a[0],s=a[1],l=a[2],c=a[3],u=n>0?1:-1,h=e>0?1:-1,f=u+h!==0?1:0;return[["M",u*o+t,r],["L",n-u*s+t,r],s?["A",s,s,0,0,f,n+t,h*s+r]:null,["L",n+t,e-h*l+r],l?["A",l,l,0,0,f,n+t-u*l,e+r]:null,["L",t+u*c,e+r],c?["A",c,c,0,0,f,t,e+r-h*c]:null,["L",t,h*o+r],o?["A",o,o,0,0,f,u*o+t,r]:null,["Z"]].filter(function(d){return d})}return[["M",t,r],["L",t+n,r],["L",t+n,r+e],["L",t,r+e],["Z"]]}function tU(n,e){e===void 0&&(e=n.getLocalTransform());var t=[];switch(n.nodeName){case At.LINE:var r=n.parsedStyle,i=r.x1,a=i===void 0?0:i,o=r.y1,s=o===void 0?0:o,l=r.x2,c=l===void 0?0:l,u=r.y2,h=u===void 0?0:u;t=AB(a,s,c,h);break;case At.CIRCLE:{var f=n.parsedStyle,d=f.r,p=d===void 0?0:d,v=f.cx,g=v===void 0?0:v,m=f.cy,x=m===void 0?0:m;t=WE(p,p,g,x);break}case At.ELLIPSE:{var S=n.parsedStyle,T=S.rx,b=T===void 0?0:T,y=S.ry,E=y===void 0?0:y,w=S.cx,g=w===void 0?0:w,C=S.cy,x=C===void 0?0:C;t=WE(b,E,g,x);break}case At.POLYLINE:case At.POLYGON:var M=n.parsedStyle.points;t=NB(M.points,n.nodeName===At.POLYGON);break;case At.RECT:var O=n.parsedStyle,A=O.width,R=A===void 0?0:A,L=O.height,z=L===void 0?0:L,Y=O.x,I=Y===void 0?0:Y,q=O.y,J=q===void 0?0:q,wt=O.radius,Ft=wt&&wt.some(function(xe){return xe!==0});t=RB(R,z,I,J,Ft&&wt.map(function(xe){return clamp(xe,0,Math.min(Math.abs(R)/2,Math.abs(z)/2))}));break;case At.PATH:var fe=n.parsedStyle.d.absolutePath;t=__spreadArray([],__read(fe),!1);break}if(t.length)return OB(t,n,e)}function eU(n,e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0);var a=n.map(function(o,s){var l=o[0],c=n[s+1],u=s===0&&(e!==0||t!==0),h=(s===n.length-1||c&&(c[0]==="M"||c[0]==="Z"))&&r!==0&&i!==0;switch(l){case"M":return u?"M ".concat(o[1]+e,",").concat(o[2]+t," L ").concat(o[1],",").concat(o[2]):"M ".concat(o[1],",").concat(o[2]);case"L":return"L ".concat(o[1]+(h?r:0),",").concat(o[2]+(h?i:0));case"Q":return"Q ".concat(o[1]," ").concat(o[2],",").concat(o[3]," ").concat(o[4])+(h?" L ".concat(o[3]+r,",").concat(o[4]+i):"");case"C":return"C ".concat(o[1]," ").concat(o[2],",").concat(o[3]," ").concat(o[4],",").concat(o[5]," ").concat(o[6])+(h?" L ".concat(o[5]+r,",").concat(o[6]+i):"");case"A":return"A ".concat(o[1]," ").concat(o[2]," ").concat(o[3]," ").concat(o[4]," ").concat(o[5]," ").concat(o[6]," ").concat(o[7])+(h?" L ".concat(o[6]+r,",").concat(o[7]+i):"");case"Z":return"Z"}}).join(" ");return~a.indexOf("NaN")?"":a}var UE=function(n){if(n===""||Array.isArray(n)&&n.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=Da(n)}catch(f){e=Da(""),console.error("[g]: Invalid SVG Path definition: ".concat(n))}SB(e);var t=_B(e),r=TB(e),i=r.polygons,a=r.polylines,o=MB(e),s=PB(o,0),l=s.x,c=s.y,u=s.width,h=s.height;return{absolutePath:e,hasArc:t,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(u)?u:0,height:Number.isFinite(h)?h:0}}},kB=$n(UE);function y0(n){return qt(n)?kB(n):UE(n)}function LB(n,e,t){var r=n.curve,i=e.curve;(!r||r.length===0)&&(r=Oo(n.absolutePath,!1),n.curve=r),(!i||i.length===0)&&(i=Oo(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=Uc(r,i));var o=hs(a[0])!==hs(a[1])?id(a[0]):ad(a[0]);return[o,od(a[1],o),function(s){return s}]}function VE(n,e){var t;return qt(n)?t=n.split(" ").map(function(r){var i=Ht(r.split(","),2),a=i[0],o=i[1];return[Number(a),Number(o)]}):t=n,{points:t,totalLength:0,segments:[]}}function IB(n,e){return[n.points,e.points,function(t){return t}]}var dn=null;function Xr(n){return function(e){var t=0;return n.map(function(r){return r===dn?e[t++]:r})}}function Qo(n){return n}var vf={matrix:["NNNNNN",[dn,dn,0,0,dn,dn,0,0,0,0,1,0,dn,dn,0,1],Qo],matrix3d:["NNNNNNNNNNNNNNNN",Qo],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Xr([dn,dn,new De(1)]),Qo],scalex:["N",Xr([dn,new De(1),new De(1)]),Xr([dn,new De(1)])],scaley:["N",Xr([new De(1),dn,new De(1)]),Xr([new De(1),dn])],scalez:["N",Xr([new De(1),new De(1),dn])],scale3d:["NNN",Qo],skew:["Aa",null,Qo],skewx:["A",null,Xr([dn,Bi])],skewy:["A",null,Xr([Bi,dn])],translate:["Tt",Xr([dn,dn,En]),Qo],translatex:["T",Xr([dn,En,En]),Xr([dn,En])],translatey:["T",Xr([En,dn,En]),Xr([En,dn])],translatez:["L",Xr([En,En,dn])],translate3d:["TTL",Qo]};function HE(n){if(n=(n||"none").toLowerCase().trim(),n==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];i=r.index+r[0].length;var a=r[1],o=vf[a];if(!o)return[];var s=r[2].split(","),l=o[0];if(l.length<s.length)return[];for(var c=[],u=0;u<l.length;u++){var h=s[u],f=l[u],d=void 0;if(h?d={A:function(p){return p.trim()==="0"?Bi:OE(p)},N:Jo,T:ll,L:mB}[f.toUpperCase()](h):d={a:Bi,n:c[0],t:En}[f],d===void 0)return[];c.push(d)}if(t.push({t:a,d:c}),e.lastIndex===n.length)return t}return[]}function YE(n){if(n=(n||"none").toLowerCase().trim(),n==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];i=r.index+r[0].length;var a=r[1],o=vf[a];if(!o)return[];var s=r[2].split(","),l=o[0];if(l.length<s.length)return[];for(var c=[],u=0;u<l.length;u++){var h=s[u],f=l[u],d=void 0;if(h?d={A:function(p){return p.trim()==="0"?Bi:p0(p)},N:cl,T:vc,L:CE}[f.toUpperCase()](h):d={a:Bi,n:c[0],t:En}[f],d===void 0)return[];c.push(d)}if(t.push({t:a,d:c}),e.lastIndex===n.length)return t}return[]}function DB(n){var e,t,r,i;switch(n.t){case"rotatex":return i=Ze(Yr(n.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotatey":return i=Ze(Yr(n.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotatez":return i=Ze(Yr(n.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=n.d[0].value,t=n.d[1].value,r=n.d[2].value,i=Ze(Yr(n.d[3]));var a=e*e+t*t+r*r;if(a===0)e=1,t=0,r=0;else if(a!==1){var o=Math.sqrt(a);e/=o,t/=o,r/=o}var s=Math.sin(i/2),l=s*Math.cos(i/2),c=s*s;return[1-2*(t*t+r*r)*c,2*(e*t*c+r*l),2*(e*r*c-t*l),0,2*(e*t*c-r*l),1-2*(e*e+r*r)*c,2*(t*r*c+e*l),0,2*(e*r*c+t*l),2*(t*r*c-e*l),1-2*(e*e+t*t)*c,0,0,0,0,1];case"scale":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scalex":return[n.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,n.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,n.d[0].value,0,0,0,0,1];case"scale3d":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,n.d[2].value,0,0,0,0,1];case"skew":var u=Ze(Yr(n.d[0])),h=Ze(Yr(n.d[1]));return[1,Math.tan(h),0,0,Math.tan(u),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return i=Ze(Yr(n.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return i=Ze(Yr(n.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return e=hi(n.d[0],0,null)||0,t=hi(n.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1];case"translatex":return e=hi(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,0,0,1];case"translatey":return t=hi(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,t,0,1];case"translatez":return r=hi(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r,1];case"translate3d":return e=hi(n.d[0],0,null)||0,t=hi(n.d[1],0,null)||0,r=hi(n.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,r,1];case"perspective":var f=hi(n.d[0],0,null)||0,d=f?-1/f:0;return[1,0,0,0,0,1,0,0,0,0,1,d,0,0,0,1];case"matrix":return[n.d[0].value,n.d[1].value,0,0,n.d[2].value,n.d[3].value,0,0,0,0,1,0,n.d[4].value,n.d[5].value,0,1];case"matrix3d":return n.d.map(function(p){return p.value})}}function BB(n,e){return[n[0]*e[0]+n[4]*e[1]+n[8]*e[2]+n[12]*e[3],n[1]*e[0]+n[5]*e[1]+n[9]*e[2]+n[13]*e[3],n[2]*e[0]+n[6]*e[1]+n[10]*e[2]+n[14]*e[3],n[3]*e[0]+n[7]*e[1]+n[11]*e[2]+n[15]*e[3],n[0]*e[4]+n[4]*e[5]+n[8]*e[6]+n[12]*e[7],n[1]*e[4]+n[5]*e[5]+n[9]*e[6]+n[13]*e[7],n[2]*e[4]+n[6]*e[5]+n[10]*e[6]+n[14]*e[7],n[3]*e[4]+n[7]*e[5]+n[11]*e[6]+n[15]*e[7],n[0]*e[8]+n[4]*e[9]+n[8]*e[10]+n[12]*e[11],n[1]*e[8]+n[5]*e[9]+n[9]*e[10]+n[13]*e[11],n[2]*e[8]+n[6]*e[9]+n[10]*e[10]+n[14]*e[11],n[3]*e[8]+n[7]*e[9]+n[11]*e[10]+n[15]*e[11],n[0]*e[12]+n[4]*e[13]+n[8]*e[14]+n[12]*e[15],n[1]*e[12]+n[5]*e[13]+n[9]*e[14]+n[13]*e[15],n[2]*e[12]+n[6]*e[13]+n[10]*e[14]+n[14]*e[15],n[3]*e[12]+n[7]*e[13]+n[11]*e[14]+n[15]*e[15]]}function FB(n){return n.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:n.map(DB).reduce(BB)}function XE(n){var e=[0,0,0],t=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return B6(FB(n),e,t,r,i,a),[[e,t,r,a,i]]}var GB=function(){function n(r,i){for(var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],o=0;o<4;o++)for(var s=0;s<4;s++)for(var l=0;l<4;l++)a[o][s]+=i[o][l]*r[l][s];return a}function e(r){return r[0][2]==0&&r[0][3]==0&&r[1][2]==0&&r[1][3]==0&&r[2][0]==0&&r[2][1]==0&&r[2][2]==1&&r[2][3]==0&&r[3][2]==0&&r[3][3]==1}function t(r,i,a,o,s){for(var l=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],c=0;c<4;c++)l[c][3]=s[c];for(var c=0;c<3;c++)for(var u=0;u<3;u++)l[3][c]+=r[u]*l[u][c];var h=o[0],f=o[1],d=o[2],p=o[3],v=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];v[0][0]=1-2*(f*f+d*d),v[0][1]=2*(h*f-d*p),v[0][2]=2*(h*d+f*p),v[1][0]=2*(h*f+d*p),v[1][1]=1-2*(h*h+d*d),v[1][2]=2*(f*d-h*p),v[2][0]=2*(h*d-f*p),v[2][1]=2*(f*d+h*p),v[2][2]=1-2*(h*h+f*f),l=n(l,v);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[2]&&(g[2][1]=a[2],l=n(l,g)),a[1]&&(g[2][1]=0,g[2][0]=a[0],l=n(l,g)),a[0]&&(g[2][0]=0,g[1][0]=a[0],l=n(l,g));for(var c=0;c<3;c++)for(var u=0;u<3;u++)l[c][u]*=i[c];return e(l)?[l[0][0],l[0][1],l[1][0],l[1][1],l[3][0],l[3][1]]:l[0].concat(l[1],l[2],l[3])}return t}();function zB(n){return n.toFixed(6).replace(".000000","")}function x0(n,e){var t,r;return n.decompositionPair!==e&&(n.decompositionPair=e,t=XE(n)),e.decompositionPair!==n&&(e.decompositionPair=n,r=XE(e)),t[0]===null||r[0]===null?[[!1],[!0],function(i){return i?e[0].d:n[0].d}]:(t[0].push(0),r[0].push(1),[t,r,function(i){var a=UB(t[0][3],r[0][3],i[5]),o=GB(i[0],i[1],i[2],a,i[4]),s=o.map(zB).join(",");return s}])}function WB(n,e){for(var t=0,r=0;r<n.length;r++)t+=n[r]*e[r];return t}function UB(n,e,t){var r=WB(n,e);r=he(r,-1,1);var i=[];if(r===1)i=n;else for(var a=Math.acos(r),o=Math.sin(t*a)*1/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(n[s]*(Math.cos(t*a)-r*o)+e[s]*o);return i}function b0(n){return n.replace(/[xy]/,"")}function E0(n){return n.replace(/(x|y|z|3d)?$/,"3d")}var VB=function(n,e){return n==="perspective"&&e==="perspective"||(n==="matrix"||n==="matrix3d")&&(e==="matrix"||e==="matrix3d")};function HB(n,e,t){var r=!1;if(!n.length||!e.length){n.length||(r=!0,n=e,e=[]);for(var i=function(y){var E=n[y],w=E.t,C=E.d,M=w.substring(0,5)==="scale"?1:0;e.push({t:w,d:C.map(function(O){return typeof O=="number"?Ue(M):Ue(M,O.unit)})})},a=0;a<n.length;a++)i(a)}var o=[],s=[],l=[];if(n.length!==e.length){var c=x0(n,e);o=[c[0]],s=[c[1]],l=[["matrix",[c[2]]]]}else for(var a=0;a<n.length;a++){var u=n[a].t,h=e[a].t,f=n[a].d,d=e[a].d,p=vf[u],v=vf[h],g=void 0;if(VB(u,h)){var c=x0([n[a]],[e[a]]);o.push(c[0]),s.push(c[1]),l.push(["matrix",[c[2]]]);continue}else if(u===h)g=u;else if(p[2]&&v[2]&&b0(u)===b0(h))g=b0(u),f=p[2](f),d=v[2](d);else if(p[1]&&v[1]&&E0(u)===E0(h))g=E0(u),f=p[1](f),d=v[1](d);else{var c=x0(n,e);o=[c[0]],s=[c[1]],l=[["matrix",[c[2]]]];break}for(var m=[],x=[],S=[],T=0;T<f.length;T++){var c=xB(f[T],d[T],t,!1,T);m[T]=c[0],x[T]=c[1],S.push(c[2])}o.push(m),s.push(x),l.push([g,S])}if(r){var b=o;o=s,s=b}return[o,s,function(y){return y.map(function(E,w){var C=E.map(function(M,O){return l[w][1][O](M)}).join(",");return l[w][0]==="matrix"&&C.split(",").length===16&&(l[w][0]="matrix3d"),l[w][0]==="matrix3d"&&C.split(",").length===6&&(l[w][0]="matrix"),l[w][0]+"("+C+")"}).join(" ")}]}var jE=$n(function(n){if(qt(n)){if(n==="text-anchor")return[Ue(0,"px"),Ue(0,"px")];var e=n.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[ll(gf(e[0])),ll(gf(e[1]))]}else return[Ue(n[0]||0,"px"),Ue(n[1]||0,"px")]}),YB=function(n){if(qt(n)){if(n==="text-anchor")return[Ue(0,"px"),Ue(0,"px")];var e=n.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[vc(gf(e[0])),vc(gf(e[1]))]}else return[Ue(n[0]||0,"px"),Ue(n[1]||0,"px")]};function gf(n){return n==="center"?"50%":n==="left"||n==="top"?"0%":n==="right"||n==="bottom"?"100%":n}var w0=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:Tt.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:Tt.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:Tt.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:Tt.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:Tt.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:Tt.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:Tt.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:Tt.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:Tt.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:Tt.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:Tt.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:Tt.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:Tt.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:Tt.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:Tt.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:Tt.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:Tt.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:Tt.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:Tt.FILTER},{n:"clipPath",syntax:Tt.DEFINED_PATH},{n:"textPath",syntax:Tt.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:Tt.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:Tt.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:Tt.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:Tt.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:Tt.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:Tt.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:Tt.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:Tt.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:Tt.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:Tt.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:Tt.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:Tt.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:Tt.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:Tt.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:Tt.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:Tt.COORDINATE},{n:"y1",int:!0,l:!0,syntax:Tt.COORDINATE},{n:"z1",int:!0,l:!0,syntax:Tt.COORDINATE},{n:"x2",int:!0,l:!0,syntax:Tt.COORDINATE},{n:"y2",int:!0,l:!0,syntax:Tt.COORDINATE},{n:"z2",int:!0,l:!0,syntax:Tt.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:Tt.PATH,p:50},{n:"points",int:!0,l:!0,syntax:Tt.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:Tt.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:Tt.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:Tt.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:Tt.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:Tt.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:Tt.NUMBER,d:function(n){return n===At.PATH||n===At.POLYGON||n===At.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:Tt.MARKER},{n:"markerEnd",syntax:Tt.MARKER},{n:"markerMid",syntax:Tt.MARKER},{n:"markerStartOffset",syntax:Tt.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:Tt.LENGTH,l:!0,int:!0,d:"0"}],$E=w0.filter(function(n){return!!n.l}).map(function(n){return n.n}),ts={},ul=new WeakMap,XB=function(n,e){var t=ul.get(n);return!t||t.length===0?!0:t.includes(e)},jB=function(){function n(e){var t=this;this.runtime=e,w0.forEach(function(r){t.registerMetadata(r)})}return n.prototype.registerMetadata=function(e){nn([e.n],Ht(e.a||[]),!1).forEach(function(t){ts[t]=e})},n.prototype.unregisterMetadata=function(e){delete ts[e]},n.prototype.getPropertySyntax=function(e){return this.runtime.CSSPropertySyntaxFactory[e]},n.prototype.processProperties=function(e,t,r){var i=this;if(r===void 0&&(r={skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0}),this.runtime.enableCSSParsing){var u=r.skipUpdateAttribute,h=r.skipParse,f=r.forceUpdateGeometry,d=r.usedAttributes,p=r.memoize,v=f,g=Object.keys(t);g.forEach(function(m){var x;u||(e.attributes[m]=t[m]),!v&&(!((x=ts[m])===null||x===void 0)&&x.l)&&(v=!0)}),h||g.forEach(function(m){e.computedStyle[m]=i.parseProperty(m,e.attributes[m],e,p)}),d!=null&&d.length&&(g=Array.from(new Set(g.concat(d)))),g.forEach(function(m){m in e.computedStyle&&(e.parsedStyle[m]=i.computeProperty(m,e.computedStyle[m],e,p))}),v&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e)),g.forEach(function(m){m in e.parsedStyle&&i.postProcessProperty(m,e,g)}),this.runtime.enableCSSParsing&&e.children.length&&g.forEach(function(m){m in e.parsedStyle&&i.isPropertyInheritable(m)&&e.children.forEach(function(x){x.internalSetAttribute(m,null,{skipUpdateAttribute:!0,skipParse:!0})})})}else{Object.assign(e.attributes,t);var a=Object.keys(t),o=e.parsedStyle.clipPath,s=e.parsedStyle.offsetPath;e.parsedStyle=Object.assign(e.parsedStyle,t);var l=!!r.forceUpdateGeometry;if(!l){for(var c=0;c<$E.length;c++)if($E[c]in t){l=!0;break}}t.fill&&(e.parsedStyle.fill=sl(t.fill)),t.stroke&&(e.parsedStyle.stroke=sl(t.stroke)),t.shadowColor&&(e.parsedStyle.shadowColor=sl(t.shadowColor)),t.filter&&(e.parsedStyle.filter=RE(t.filter)),pt(t.radius)||(e.parsedStyle.radius=AE(t.radius,4)),pt(t.lineDash)||(e.parsedStyle.lineDash=AE(t.lineDash,2)),t.points&&(e.parsedStyle.points=VE(t.points)),t.d===""&&(e.parsedStyle.d=se({},PE)),t.d&&(e.parsedStyle.d=y0(t.d)),t.textTransform&&this.runtime.CSSPropertySyntaxFactory["<text-transform>"].calculator(null,null,{value:t.textTransform},e,null),yt(t.clipPath)||this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("clipPath",o,t.clipPath,e,this.runtime),t.offsetPath&&this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("offsetPath",s,t.offsetPath,e,this.runtime),t.transform&&(e.parsedStyle.transform=HE(t.transform)),t.transformOrigin&&(e.parsedStyle.transformOrigin=jE(t.transformOrigin)),t.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,t.markerStart,t.markerStart,null,null)),t.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,t.markerEnd,t.markerEnd,null,null)),t.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator("",t.markerMid,t.markerMid,null,null)),pt(t.zIndex)||this.runtime.CSSPropertySyntaxFactory["<z-index>"].postProcessor(e,a),pt(t.offsetDistance)||this.runtime.CSSPropertySyntaxFactory["<offset-distance>"].postProcessor(e,a),t.transform&&this.runtime.CSSPropertySyntaxFactory["<transform>"].postProcessor(e,a),t.transformOrigin&&this.runtime.CSSPropertySyntaxFactory["<transform-origin>"].postProcessor(e,a),l&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e))}},n.prototype.parseProperty=function(e,t,r,i){var a=ts[e],o=t;if((t===""||pt(t))&&(t="unset"),t==="unset"||t==="initial"||t==="inherit")o=h0(t);else if(a){var s=a.k,l=a.syntax,c=l&&this.getPropertySyntax(l);s&&s.indexOf(t)>-1?o=h0(t):c&&(!i&&c.parserUnmemoize?o=c.parserUnmemoize(t,r):c.parser&&(o=c.parser(t,r)))}return o},n.prototype.computeProperty=function(e,t,r,i){var a=ts[e],o=r.id==="g-root",s=t;if(a){var l=a.syntax,c=a.inh,u=a.d;if(t instanceof Hr){var h=t.value;if(h==="unset"&&(c&&!o?h="inherit":h="initial"),h==="initial")pt(u)||(t=this.parseProperty(e,al(u)?u(r.nodeName):u,r,i));else if(h==="inherit"){var f=this.tryToResolveProperty(r,e,{inherited:!0});if(pt(f)){this.addUnresolveProperty(r,e);return}else return f}}var d=l&&this.getPropertySyntax(l);if(d&&d.calculator){var p=r.parsedStyle[e];s=d.calculator(e,p,t,r,this.runtime)}else t instanceof Hr?s=t.value:s=t}return s},n.prototype.postProcessProperty=function(e,t,r){var i=ts[e];if(i&&i.syntax){var a=i.syntax&&this.getPropertySyntax(i.syntax),o=a;o&&o.postProcessor&&o.postProcessor(t,r)}},n.prototype.addUnresolveProperty=function(e,t){var r=ul.get(e);r||(ul.set(e,[]),r=ul.get(e)),r.indexOf(t)===-1&&r.push(t)},n.prototype.tryToResolveProperty=function(e,t,r){r===void 0&&(r={});var i=r.inherited;if(i&&e.parentElement&&XB(e.parentElement,t)){var a=e.parentElement.parsedStyle[t];return a==="unset"||a==="initial"||a==="inherit"?void 0:a}},n.prototype.recalc=function(e){var t=ul.get(e);if(t&&t.length){var r={};t.forEach(function(i){r[i]=e.attributes[i]}),this.processProperties(e,r),ul.delete(e)}},n.prototype.updateGeometry=function(e){var t=e.nodeName,r=this.runtime.geometryUpdaterFactory[t];if(r){var i=e.geometry;i.contentBounds||(i.contentBounds=new or),i.renderBounds||(i.renderBounds=new or);var a=e.parsedStyle,o=r.update(a,e),s=o.cx,l=s===void 0?0:s,c=o.cy,u=c===void 0?0:c,h=o.cz,f=h===void 0?0:h,d=o.hwidth,p=d===void 0?0:d,v=o.hheight,g=v===void 0?0:v,m=o.hdepth,x=m===void 0?0:m,S=[Math.abs(p),Math.abs(g),x],T=a,b=T.stroke,y=T.lineWidth,E=y===void 0?1:y,w=T.increasedLineWidthForHitTesting,C=w===void 0?0:w,M=T.shadowType,O=M===void 0?"outer":M,A=T.shadowColor,R=T.filter,L=R===void 0?[]:R,z=T.transformOrigin,Y=[l,u,f];i.contentBounds.update(Y,S);var I=t===At.POLYLINE||t===At.POLYGON||t===At.PATH?Math.SQRT2:.5,q=b&&!b.isNone;if(q){var J=((E||0)+(C||0))*I;S[0]+=J,S[1]+=J}if(i.renderBounds.update(Y,S),A&&O&&O!=="inner"){var wt=i.renderBounds,Ft=wt.min,fe=wt.max,xe=a,Sr=xe.shadowBlur,jr=xe.shadowOffsetX,zn=xe.shadowOffsetY,rn=Sr||0,On=jr||0,di=zn||0,cr=Ft[0]-rn+On,$r=fe[0]+rn+On,xo=Ft[1]-rn+di,Pc=fe[1]+rn+di;Ft[0]=Math.min(Ft[0],cr),fe[0]=Math.max(fe[0],$r),Ft[1]=Math.min(Ft[1],xo),fe[1]=Math.max(fe[1],Pc),i.renderBounds.setMinMax(Ft,fe)}L.forEach(function(wo){var So=wo.name,Kr=wo.params;if(So==="blur"){var _o=Kr[0].value;i.renderBounds.update(i.renderBounds.center,sf(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[_o,_o,0]))}else if(So==="drop-shadow"){var To=Kr[0].value,Po=Kr[1].value,Zr=Kr[2].value,Mo=i.renderBounds,pn=Mo.min,vn=Mo.max,Oc=pn[0]-Zr+To,Ac=vn[0]+Zr+To,Nc=pn[1]-Zr+Po,Rc=vn[1]+Zr+Po;pn[0]=Math.min(pn[0],Oc),vn[0]=Math.max(vn[0],Ac),pn[1]=Math.min(pn[1],Nc),vn[1]=Math.max(vn[1],Rc),i.renderBounds.setMinMax(pn,vn)}}),e.geometry.dirty=!1;var Mc=p<0,Cc=g<0,bo=(Mc?-1:1)*(z?hi(z[0],0,e,!0):0),Eo=(Cc?-1:1)*(z?hi(z[1],1,e,!0):0);(bo||Eo)&&e.setOrigin(bo,Eo)}},n.prototype.updateSizeAttenuation=function(e,t){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/t,e.nodeName===At.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/t)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===At.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR))},n.prototype.isPropertyInheritable=function(e){var t=ts[e];return t?t.inh:!1},n}(),$B=function(){function n(){this.parser=OE,this.parserUnmemoize=p0,this.parserWithCSSDisabled=null,this.mixer=v0}return n.prototype.calculator=function(e,t,r,i){return Yr(r)},n}(),KB=function(){function n(){}return n.prototype.calculator=function(e,t,r,i,a){return r instanceof Hr&&(r=null),a.sceneGraphService.updateDisplayObjectDependency(e,t,r,i),e==="clipPath"&&i.forEach(function(o){o.childNodes.length===0&&a.sceneGraphService.dirtifyToRoot(o)}),r},n}(),ZB=function(){function n(){this.parser=sl,this.parserWithCSSDisabled=sl,this.mixer=gB}return n.prototype.calculator=function(e,t,r,i){return r instanceof Hr?r.value==="none"?uf:TE:r},n}(),qB=function(){function n(){this.parser=RE}return n.prototype.calculator=function(e,t,r){return r instanceof Hr?[]:r},n}();function KE(n){var e=n.parsedStyle.fontSize;return pt(e)?null:e}var S0=function(){function n(){this.parser=ll,this.parserUnmemoize=vc,this.parserWithCSSDisabled=null,this.mixer=v0}return n.prototype.calculator=function(e,t,r,i,a){var o;if(te(r))return r;if(De.isRelativeUnit(r.unit)){var s=a.styleValueRegistry;if(r.unit===Et.kPercentage)return 0;if(r.unit===Et.kEms){if(i.parentNode){var l=KE(i.parentNode);if(l)return l*=r.value,l;s.addUnresolveProperty(i,e)}else s.addUnresolveProperty(i,e);return 0}else if(r.unit===Et.kRems){if(!((o=i==null?void 0:i.ownerDocument)===null||o===void 0)&&o.documentElement){var l=KE(i.ownerDocument.documentElement);if(l)return l*=r.value,l;s.addUnresolveProperty(i,e)}else s.addUnresolveProperty(i,e);return 0}}else return r.value},n}(),JB=function(){function n(){this.mixer=LE}return n.prototype.parser=function(e){var t=NE(te(e)?[e]:e),r;return t.length===1?r=[t[0],t[0]]:r=[t[0],t[1]],r},n.prototype.calculator=function(e,t,r){return r.map(function(i){return i.value})},n}(),QB=function(){function n(){this.mixer=LE}return n.prototype.parser=function(e){var t=NE(te(e)?[e]:e),r;return t.length===1?r=[t[0],t[0],t[0],t[0]]:t.length===2?r=[t[0],t[1],t[0],t[1]]:t.length===3?r=[t[0],t[1],t[2],t[1]]:r=[t[0],t[1],t[2],t[3]],r},n.prototype.calculator=function(e,t,r){return r.map(function(i){return i.value})},n}(),t4=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){r instanceof Hr&&(r=null);var a=r==null?void 0:r.cloneNode(!0);return a&&(a.style.isMarker=!0),a},n}(),e4=function(){function n(){this.mixer=v0,this.parser=Jo,this.parserUnmemoize=cl,this.parserWithCSSDisabled=null}return n.prototype.calculator=function(e,t,r){return r.value},n}(),n4=function(){function n(){this.parser=Jo,this.parserUnmemoize=cl,this.parserWithCSSDisabled=null,this.mixer=g0(0,1)}return n.prototype.calculator=function(e,t,r){return r.value},n.prototype.postProcessor=function(e){var t=e.parsedStyle,r=t.offsetPath,i=t.offsetDistance;if(r){var a=r.nodeName;if(a===At.LINE||a===At.PATH||a===At.POLYLINE){var o=r.getPoint(i);o&&e.setLocalPosition(o.x,o.y)}}},n}(),r4=function(){function n(){this.parser=Jo,this.parserUnmemoize=cl,this.parserWithCSSDisabled=null,this.mixer=g0(0,1)}return n.prototype.calculator=function(e,t,r){return r.value},n}(),i4=function(){function n(){this.parser=y0,this.parserWithCSSDisabled=y0,this.mixer=LB}return n.prototype.calculator=function(e,t,r){return r instanceof Hr&&r.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ho(0,0,0,0)}:r},n}(),a4=function(){function n(){this.parser=VE,this.mixer=IB}return n}(),o4=function(n){Me(e,n);function e(){var t=n.apply(this,nn([],Ht(arguments),!1))||this;return t.mixer=g0(0,1/0),t}return e}(S0),s4=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){return r instanceof Hr?r.value==="unset"?"":r.value:"".concat(r)},n.prototype.postProcessor=function(e){e.nodeValue="".concat(e.parsedStyle.text)||""},n}(),l4=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){var a=i.getAttribute("text");if(a){var o=a;r.value==="capitalize"?o=a.charAt(0).toUpperCase()+a.slice(1):r.value==="lowercase"?o=a.toLowerCase():r.value==="uppercase"&&(o=a.toUpperCase()),i.parsedStyle.text=o}return r.value},n}(),_0={},c4=0;function u4(n,e){if(n){var t=typeof n=="string"?n:n.id||c4++;_0[t]&&_0[t].destroy(),_0[t]=e}}var T0=typeof window!="undefined"&&typeof window.document!="undefined";function h4(n){return!!n.getAttribute}function f4(n,e){for(var t=0,r=n.length;t<r;){var i=t+r>>>1;ZE(n[i],e)<0?t=i+1:r=i}return t}function ZE(n,e){var t=Number(n.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(t===r){var i=n.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(n)-a.indexOf(e)}}return t-r}function d4(n){var e,t=n;do{var r=(e=t.parsedStyle)===null||e===void 0?void 0:e.clipPath;if(r)return t;t=t.parentElement}while(t!==null);return null}var qE="px";function nU(n,e,t){T0&&n.style&&(n.style.width=e+qE,n.style.height=t+qE)}function JE(n,e){if(T0)return document.defaultView.getComputedStyle(n,null).getPropertyValue(e)}function p4(n){var e=JE(n,"width");return e==="auto"?n.offsetWidth:parseFloat(e)}function v4(n){var e=JE(n,"height");return e==="auto"?n.offsetHeight:parseFloat(e)}var g4=1,m4={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},P0=typeof performance=="object"&&performance.now?performance:Date;function rU(n,e,t){n===void 0&&(n="auto");var r=!1,i=!1,a=!!e&&!e.isNone,o=!!t&&!t.isNone;return n==="visiblepainted"||n==="painted"||n==="auto"?(r=a,i=o):n==="visiblefill"||n==="fill"?r=!0:n==="visiblestroke"||n==="stroke"?i=!0:(n==="visible"||n==="all")&&(r=!0,i=!0),[r,i]}var y4=1,x4=function(){return y4++},ca=typeof self=="object"&&self.self==self?self:typeof D.g=="object"&&D.g.global==D.g?D.g:{},b4=Date.now(),E4=function(){return ca.performance&&typeof ca.performance.now=="function"?ca.performance.now():Date.now()-b4},gc={},QE=Date.now(),w4=function(n){if(typeof n!="function")throw new TypeError(n+" is not a function");var e=Date.now(),t=e-QE,r=t>16?0:16-t,i=x4();return gc[i]=n,Object.keys(gc).length>1||setTimeout(function(){QE=e;var a=gc;gc={},Object.keys(a).forEach(function(o){return a[o](E4())})},r),i},S4=function(n){delete gc[n]},_4=["","webkit","moz","ms","o"],t2=function(n){return typeof n!="string"?w4:n===""?ca.requestAnimationFrame:ca[n+"RequestAnimationFrame"]},T4=function(n){return typeof n!="string"?S4:n===""?ca.cancelAnimationFrame:ca[n+"CancelAnimationFrame"]||ca[n+"CancelRequestAnimationFrame"]},P4=function(n,e){for(var t=0;n[t]!==void 0;){if(e(n[t]))return n[t];t=t+1}},e2=P4(_4,function(n){return!!t2(n)}),M0=t2(e2),n2=T4(e2);ca.requestAnimationFrame=M0,ca.cancelAnimationFrame=n2;var M4=function(){function n(){this.callbacks=[]}return n.prototype.getCallbacksNum=function(){return this.callbacks.length},n.prototype.tapPromise=function(e,t){this.callbacks.push(t)},n.prototype.promise=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Promise.all(this.callbacks.map(function(r){return r.apply(void 0,nn([],Ht(e),!1))}))},n}(),C4=function(){function n(){this.callbacks=[]}return n.prototype.tapPromise=function(e,t){this.callbacks.push(t)},n.prototype.promise=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return af(this,void 0,void 0,function(){var r,i,a,o;return of(this,function(s){switch(s.label){case 0:return this.callbacks.length?[4,(o=this.callbacks)[0].apply(o,nn([],Ht(e),!1))]:[3,6];case 1:r=s.sent(),i=0,s.label=2;case 2:return i<this.callbacks.length-1?(a=this.callbacks[i],[4,a(r)]):[3,5];case 3:r=s.sent(),s.label=4;case 4:return i++,[3,2];case 5:return[2,r];case 6:return[2,null]}})})},n}(),br=function(){function n(){this.callbacks=[]}return n.prototype.tap=function(e,t){this.callbacks.push(t)},n.prototype.call=function(){var e=arguments;this.callbacks.forEach(function(t){t.apply(void 0,e)})},n}(),C0=function(){function n(){this.callbacks=[]}return n.prototype.tap=function(e,t){this.callbacks.push(t)},n.prototype.call=function(){if(this.callbacks.length){for(var e=arguments,t=this.callbacks[0].apply(void 0,e),r=0;r<this.callbacks.length-1;r++){var i=this.callbacks[r];t=i(t)}return t}return null},n}(),O4=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],A4=/([\"\'])[^\'\"]+\1/;function N4(n){for(var e=n.fontSize,t=e===void 0?16:e,r=n.fontFamily,i=r===void 0?"sans-serif":r,a=n.fontStyle,o=a===void 0?"normal":a,s=n.fontVariant,l=s===void 0?"normal":s,c=n.fontWeight,u=c===void 0?"normal":c,h=te(t)&&"".concat(t,"px")||"16px",f=i.split(","),d=f.length-1;d>=0;d--){var p=f[d].trim();!A4.test(p)&&O4.indexOf(p)<0&&(p='"'.concat(p,'"')),f[d]=p}return"".concat(o," ").concat(l," ").concat(u," ").concat(h," ").concat(f.join(","))}function O0(n,e,t){return Xt(n),n[4]=Math.tan(e),n[1]=Math.tan(t),n}var mc=1e-5,R4=Q(),Cn=Q();function k4(n,e){if(n.length){var t=Xt(R4);n.forEach(function(r){var i=r.t,a=r.d;if(i==="scale"){var o=(a==null?void 0:a.map(function(m){return Math.max(m.value,mc)}))||[1,1];Oe(Cn,[o[0],o[1],1])}else if(i==="scalex"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,mc)}))||[1];Oe(Cn,[o[0],1,1])}else if(i==="scaley"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,mc)}))||[1];Oe(Cn,[1,o[0],1])}else if(i==="scalez"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,mc)}))||[1];Oe(Cn,[1,1,o[0]])}else if(i==="scale3d"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,mc)}))||[1,1,1];Oe(Cn,[o[0],o[1],o[2]])}else if(i==="translate"){var s=a||[En,En];ue(Cn,[s[0].value,s[1].value,0])}else if(i==="translatex"){var s=a||[En];ue(Cn,[s[0].value,0,0])}else if(i==="translatey"){var s=a||[En];ue(Cn,[0,s[0].value,0])}else if(i==="translatez"){var s=a||[En];ue(Cn,[0,0,s[0].value])}else if(i==="translate3d"){var s=a||[En,En,En];ue(Cn,[s[0].value,s[1].value,s[2].value])}else if(i==="rotate"){var l=a||[Bi];qr(Cn,Ze(Yr(l[0])))}else if(i==="rotatex"){var l=a||[Bi];ie(Cn,Ze(Yr(l[0])))}else if(i==="rotatey"){var l=a||[Bi];Xe(Cn,Ze(Yr(l[0])))}else if(i==="rotatez"){var l=a||[Bi];qr(Cn,Ze(Yr(l[0])))}else if(i==="rotate3d"){var l=a||[En,En,En,Bi];Tr(Cn,Ze(Yr(l[3])),[l[0].value,l[1].value,l[2].value])}else if(i==="skew"){var c=(a==null?void 0:a.map(function(m){return m.value}))||[0,0];O0(Cn,Ze(c[0]),Ze(c[1]))}else if(i==="skewx"){var c=(a==null?void 0:a.map(function(x){return x.value}))||[0];O0(Cn,Ze(c[0]),0)}else if(i==="skewy"){var c=(a==null?void 0:a.map(function(x){return x.value}))||[0];O0(Cn,0,Ze(c[0]))}else if(i==="matrix"){var u=Ht(a.map(function(m){return m.value}),6),h=u[0],f=u[1],d=u[2],p=u[3],v=u[4],g=u[5];re(Cn,h,f,0,0,d,p,0,0,0,0,1,0,v,g,0,1)}else i==="matrix3d"&&re.apply(G,nn([Cn],Ht(a.map(function(m){return m.value})),!1));Gc(t,t,Cn)}),e.setLocalTransform(t)}else e.resetLocalTransform();return e.getLocalTransform()}var L4=function(){function n(){this.parser=HE,this.parserUnmemoize=YE,this.parserWithCSSDisabled=YE,this.mixer=HB}return n.prototype.calculator=function(e,t,r,i){return r instanceof Hr?[]:r},n.prototype.postProcessor=function(e){var t=e.parsedStyle.transform;k4(t,e)},n}(),I4=function(){function n(){this.parser=jE,this.parserUnmemoize=YB}return n.prototype.postProcessor=function(e){var t=e.parsedStyle.transformOrigin;t[0].unit===Et.kPixels&&t[1].unit===Et.kPixels?e.setOrigin(t[0].value,t[1].value):e.getGeometryBounds()},n}(),D4=function(){function n(){this.parser=Jo,this.parserUnmemoize=cl}return n.prototype.calculator=function(e,t,r,i){return r.value},n.prototype.postProcessor=function(e){if(e.parentNode){var t=e.parentNode,r=t.renderable,i=t.sortable;r&&(r.dirty=!0),i&&(i.dirty=!0,i.dirtyReason=ol.Z_INDEX_CHANGED)}},n}(),B4=function(){function n(){}return n.prototype.update=function(e,t){var r=e.cx,i=r===void 0?0:r,a=e.cy,o=a===void 0?0:a,s=e.r,l=s===void 0?0:s;return{cx:i,cy:o,hwidth:l,hheight:l}},n}(),F4=function(){function n(){}return n.prototype.update=function(e,t){var r=e.cx,i=r===void 0?0:r,a=e.cy,o=a===void 0?0:a,s=e.rx,l=s===void 0?0:s,c=e.ry,u=c===void 0?0:c;return{cx:i,cy:o,hwidth:l,hheight:u}},n}(),G4=function(){function n(){}return n.prototype.update=function(e){var t=e.x1,r=e.y1,i=e.x2,a=e.y2,o=Math.min(t,i),s=Math.max(t,i),l=Math.min(r,a),c=Math.max(r,a),u=s-o,h=c-l,f=u/2,d=h/2;return{cx:o+f,cy:l+d,hwidth:f,hheight:d}},n}(),z4=function(){function n(){}return n.prototype.update=function(e){var t=e.d,r=t.rect,i=r.x,a=r.y,o=r.width,s=r.height,l=o/2,c=s/2;return{cx:i+l,cy:a+c,hwidth:l,hheight:c}},n}(),W4=function(){function n(){}return n.prototype.update=function(e){if(e.points&&tr(e.points.points)){var t=e.points.points,r=Math.min.apply(Math,nn([],Ht(t.map(function(h){return h[0]})),!1)),i=Math.max.apply(Math,nn([],Ht(t.map(function(h){return h[0]})),!1)),a=Math.min.apply(Math,nn([],Ht(t.map(function(h){return h[1]})),!1)),o=Math.max.apply(Math,nn([],Ht(t.map(function(h){return h[1]})),!1)),s=i-r,l=o-a,c=s/2,u=l/2;return{cx:r+c,cy:a+u,hwidth:c,hheight:u}}return{cx:0,cy:0,hwidth:0,hheight:0}},n}(),U4=function(){function n(){}return n.prototype.update=function(e,t){var r=e.x,i=r===void 0?0:r,a=e.y,o=a===void 0?0:a,s=e.src,l=e.width,c=l===void 0?0:l,u=e.height,h=u===void 0?0:u,f=c,d=h;return s&&!qt(s)&&(f||(f=s.width,e.width=f),d||(d=s.height,e.height=d)),{cx:i+f/2,cy:o+d/2,hwidth:f/2,hheight:d/2}},n}(),V4=function(){function n(e){this.globalRuntime=e}return n.prototype.isReadyToMeasure=function(e,t){var r=e.text,i=e.textAlign,a=e.textBaseline,o=e.fontSize,s=e.fontStyle,l=e.fontWeight,c=e.fontVariant,u=e.lineWidth;return st.enableCSSParsing?r&&o&&s&&l&&c&&i&&a&&!pt(u):r},n.prototype.update=function(e,t){var r,i,a=e.text,o=e.textAlign,s=o===void 0?"start":o,l=e.lineWidth,c=l===void 0?1:l,u=e.textBaseline,h=u===void 0?"alphabetic":u,f=e.dx,d=f===void 0?0:f,p=e.dy,v=p===void 0?0:p,g=e.x,m=g===void 0?0:g,x=e.y,S=x===void 0?0:x;if(!this.isReadyToMeasure(e,t))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var T=(((i=(r=t==null?void 0:t.ownerDocument)===null||r===void 0?void 0:r.defaultView)===null||i===void 0?void 0:i.getConfig())||{}).offscreenCanvas,b=this.globalRuntime.textService.measureText(a,e,T);e.metrics=b;var y=b.width,E=b.height,w=b.lineHeight,C=b.fontProperties,M=y/2,O=E/2,A=m+M;s==="center"||s==="middle"?A+=c/2-M:(s==="right"||s==="end")&&(A+=c-M*2);var R=S-O;return h==="middle"?R+=O:h==="top"||h==="hanging"?R+=O*2:h==="alphabetic"?R+=this.globalRuntime.enableCSSParsing?w-C.ascent:0:(h==="bottom"||h==="ideographic")&&(R+=0),d&&(A+=d),v&&(R+=v),{cx:A,cy:R,hwidth:M,hheight:O}},n}(),H4=function(){function n(){}return n.prototype.update=function(e,t){return{cx:0,cy:0,hwidth:0,hheight:0}},n}();function Y4(n){return!!n.type}var A0=function(){function n(e){this.eventPhase=n.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new sr,this.page=new sr,this.canvas=new sr,this.viewport=new sr,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}return Object.defineProperty(n.prototype,"name",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layerX",{get:function(){return this.layer.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layerY",{get:function(){return this.layer.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageX",{get:function(){return this.page.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageY",{get:function(){return this.page.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"x",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasX",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasY",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewportX",{get:function(){return this.viewport.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewportY",{get:function(){return this.viewport.y},enumerable:!1,configurable:!0}),n.prototype.composedPath=function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},Object.defineProperty(n.prototype,"propagationPath",{get:function(){return this.composedPath()},enumerable:!1,configurable:!0}),n.prototype.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},n.prototype.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},n.prototype.stopPropagation=function(){this.propagationStopped=!0},n.prototype.initEvent=function(){},n.prototype.initUIEvent=function(){},n.prototype.clone=function(){throw new Error(on)},n}(),r2=function(n){Me(e,n);function e(){var t=n.apply(this,nn([],Ht(arguments),!1))||this;return t.client=new sr,t.movement=new sr,t.offset=new sr,t.global=new sr,t.screen=new sr,t}return Object.defineProperty(e.prototype,"clientX",{get:function(){return this.client.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientY",{get:function(){return this.client.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementX",{get:function(){return this.movement.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementY",{get:function(){return this.movement.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetX",{get:function(){return this.offset.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetY",{get:function(){return this.offset.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalX",{get:function(){return this.global.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalY",{get:function(){return this.global.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenX",{get:function(){return this.screen.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenY",{get:function(){return this.screen.y},enumerable:!1,configurable:!0}),e.prototype.getModifierState=function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)},e.prototype.initMouseEvent=function(){throw new Error(on)},e}(A0),N0=function(n){Me(e,n);function e(){var t=n.apply(this,nn([],Ht(arguments),!1))||this;return t.width=0,t.height=0,t.isPrimary=!1,t}return e.prototype.getCoalescedEvents=function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]},e.prototype.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},e.prototype.clone=function(){return this.manager.clonePointerEvent(this)},e}(r2),R0=function(n){Me(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.clone=function(){return this.manager.cloneWheelEvent(this)},e}(r2),Er=function(n){Me(e,n);function e(t,r){var i=n.call(this,null)||this;return i.type=t,i.detail=r,Object.assign(i,r),i}return e}(A0),i2=":",a2=function(){function n(){this.emitter=new et}return n.prototype.on=function(e,t,r){return this.addEventListener(e,t,r),this},n.prototype.addEventListener=function(e,t,r){var i=za(r)&&r||Ye(r)&&r.capture,a=Ye(r)&&r.once,o=al(t)?void 0:t,s=!1,l="";if(e.indexOf(i2)>-1){var c=Ht(e.split(i2),2),u=c[0],h=c[1];e=h,l=u,s=!0}if(e=i?"".concat(e,"capture"):e,t=al(t)?t:t.handleEvent,s){var f=t;t=function(){for(var d,p=[],v=0;v<arguments.length;v++)p[v]=arguments[v];((d=p[0].target)===null||d===void 0?void 0:d.name)===l&&f.apply(void 0,nn([],Ht(p),!1))}}return a?this.emitter.once(e,t,o):this.emitter.on(e,t,o),this},n.prototype.off=function(e,t,r){return e?this.removeEventListener(e,t,r):this.removeAllEventListeners(),this},n.prototype.removeAllEventListeners=function(){this.emitter.removeAllListeners()},n.prototype.removeEventListener=function(e,t,r){var i=za(r)&&r||Ye(r)&&r.capture,a=al(t)?void 0:t;return e=i?"".concat(e,"capture"):e,t=al(t)?t:t==null?void 0:t.handleEvent,this.emitter.off(e,t,a),this},n.prototype.emit=function(e,t){this.dispatchEvent(new Er(e,t))},n.prototype.dispatchEvent=function(e,t){var r,i;if(t===void 0&&(t=!1),!Y4(e))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var a;if(this.document?a=this:this.defaultView?a=this.defaultView:a=(r=this.ownerDocument)===null||r===void 0?void 0:r.defaultView,a){if(e.manager=a.getEventService()||null,!e.manager)return!1;e.defaultPrevented=!1,e.path=[],t||(e.target=this),(i=e.manager)===null||i===void 0||i.dispatchEvent(e,e.type,t)}return!e.defaultPrevented},n}(),Kn=function(n){Me(e,n);function e(){var t=n.call(this)||this;return t.shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return e.isNode=function(t){return!!t.childNodes},Object.defineProperty(e.prototype,"textContent",{get:function(){var t,r,i="";this.nodeName===At.TEXT&&(i+=this.style.text);try{for(var a=sa(this.childNodes),o=a.next();!o.done;o=a.next()){var s=o.value;s.nodeName===At.TEXT?i+=s.nodeValue:i+=s.textContent}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return i},set:function(t){var r=this;this.childNodes.slice().forEach(function(i){r.removeChild(i)}),this.nodeName===At.TEXT&&(this.style.text="".concat(t))},enumerable:!1,configurable:!0}),e.prototype.getRootNode=function(t){return t===void 0&&(t={}),this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this},e.prototype.hasChildNodes=function(){return this.childNodes.length>0},e.prototype.isDefaultNamespace=function(t){throw new Error(on)},e.prototype.lookupNamespaceURI=function(t){throw new Error(on)},e.prototype.lookupPrefix=function(t){throw new Error(on)},e.prototype.normalize=function(){throw new Error(on)},e.prototype.isEqualNode=function(t){return this===t},e.prototype.isSameNode=function(t){return this.isEqualNode(t)},Object.defineProperty(e.prototype,"parent",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.childNodes.length>0?this.childNodes[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null},enumerable:!1,configurable:!0}),e.prototype.compareDocumentPosition=function(t){var r;if(t===this)return 0;for(var i=t,a=this,o=[i],s=[a];(r=i.parentNode)!==null&&r!==void 0?r:a.parentNode;)i=i.parentNode?(o.push(i.parentNode),i.parentNode):i,a=a.parentNode?(s.push(a.parentNode),a.parentNode):a;if(i!==a)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var l=o.length>s.length?o:s,c=l===o?s:o;if(l[l.length-c.length]===c[0])return l===o?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=l.length-c.length,h=c.length-1;h>=0;h--){var f=c[h],d=l[u+h];if(d!==f){var p=f.parentNode.childNodes;return p.indexOf(f)<p.indexOf(d)?c===o?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:l===o?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING},e.prototype.contain=function(t){return this.contains(t)},e.prototype.contains=function(t){for(var r=t;r&&this!==r;)r=r.parentNode;return!!r},e.prototype.getAncestor=function(t){for(var r=this;t>0&&r;)r=r.parentNode,t--;return r},e.prototype.forEach=function(t,r){r===void 0&&(r=!1),t(this)||(r?this.childNodes.slice():this.childNodes).forEach(function(i){i.forEach(t)})},e.DOCUMENT_POSITION_DISCONNECTED=1,e.DOCUMENT_POSITION_PRECEDING=2,e.DOCUMENT_POSITION_FOLLOWING=4,e.DOCUMENT_POSITION_CONTAINS=8,e.DOCUMENT_POSITION_CONTAINED_BY=16,e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,e}(a2),X4=2048,j4=function(){function n(e,t){var r=this;this.globalRuntime=e,this.context=t,this.emitter=new et,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=Q(),this.tmpVec3=_.Ue(),this.onPointerDown=function(i){var a=r.createPointerEvent(i);if(r.dispatchEvent(a,"pointerdown"),a.pointerType==="touch")r.dispatchEvent(a,"touchstart");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var o=a.button===2;r.dispatchEvent(a,o?"rightdown":"mousedown")}var s=r.trackingData(i.pointerId);s.pressTargetsByButton[i.button]=a.composedPath(),r.freeEvent(a)},this.onPointerUp=function(i){var a,o=P0.now(),s=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(s,"pointerup"),s.pointerType==="touch")r.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.dispatchEvent(s,l?"rightup":"mouseup")}var c=r.trackingData(i.pointerId),u=r.findMountedTarget(c.pressTargetsByButton[i.button]),h=u;if(u&&!s.composedPath().includes(u)){for(var f=u;f&&!s.composedPath().includes(f);){if(s.currentTarget=f,r.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")r.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.notifyTarget(s,l?"rightupoutside":"mouseupoutside")}Kn.isNode(f)&&(f=f.parentNode)}delete c.pressTargetsByButton[i.button],h=f}if(h){var d=r.clonePointerEvent(s,"click");d.target=h,d.path=[],c.clicksByButton[i.button]||(c.clicksByButton[i.button]={clickCount:0,target:d.target,timeStamp:o});var p=r.context.renderingContext.root.ownerDocument.defaultView,v=c.clicksByButton[i.button];v.target===d.target&&o-v.timeStamp<p.dblClickSpeed?++v.clickCount:v.clickCount=1,v.target=d.target,v.timeStamp=o,d.detail=v.clickCount,!((a=s.detail)===null||a===void 0)&&a.preventClick||(!r.context.config.useNativeClickEvent&&(d.pointerType==="mouse"||d.pointerType==="touch")&&r.dispatchEvent(d,"click"),r.dispatchEvent(d,"pointertap")),r.freeEvent(d)}r.freeEvent(s)},this.onPointerMove=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),o=a.pointerType==="mouse"||a.pointerType==="pen",s=r.trackingData(i.pointerId),l=r.findMountedTarget(s.overTargets);if(s.overTargets&&l!==a.target){var c=i.type==="mousemove"?"mouseout":"pointerout",u=r.createPointerEvent(i,c,l||void 0);if(r.dispatchEvent(u,"pointerout"),o&&r.dispatchEvent(u,"mouseout"),!a.composedPath().includes(l)){var h=r.createPointerEvent(i,"pointerleave",l||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!a.composedPath().includes(h.target);)h.currentTarget=h.target,r.notifyTarget(h),o&&r.notifyTarget(h,"mouseleave"),Kn.isNode(h.target)&&(h.target=h.target.parentNode);r.freeEvent(h)}r.freeEvent(u)}if(l!==a.target){var f=i.type==="mousemove"?"mouseover":"pointerover",d=r.clonePointerEvent(a,f);r.dispatchEvent(d,"pointerover"),o&&r.dispatchEvent(d,"mouseover");for(var p=l&&Kn.isNode(l)&&l.parentNode;p&&p!==(Kn.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&p!==a.target;)p=p.parentNode;var v=!p||p===(Kn.isNode(r.rootTarget)&&r.rootTarget.parentNode);if(v){var g=r.clonePointerEvent(a,"pointerenter");for(g.eventPhase=g.AT_TARGET;g.target&&g.target!==l&&g.target!==(Kn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)g.currentTarget=g.target,r.notifyTarget(g),o&&r.notifyTarget(g,"mouseenter"),Kn.isNode(g.target)&&(g.target=g.target.parentNode);r.freeEvent(g)}r.freeEvent(d)}r.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&r.dispatchEvent(a,"touchmove"),o&&(r.dispatchEvent(a,"mousemove"),r.cursor=r.getCursor(a.target)),s.overTargets=a.composedPath(),r.freeEvent(a)},this.onPointerOut=function(i){var a=r.trackingData(i.pointerId);if(a.overTargets){var o=i.pointerType==="mouse"||i.pointerType==="pen",s=r.findMountedTarget(a.overTargets),l=r.createPointerEvent(i,"pointerout",s||void 0);r.dispatchEvent(l),o&&r.dispatchEvent(l,"mouseout");var c=r.createPointerEvent(i,"pointerleave",s||void 0);for(c.eventPhase=c.AT_TARGET;c.target&&c.target!==(Kn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)c.currentTarget=c.target,r.notifyTarget(c),o&&r.notifyTarget(c,"mouseleave"),Kn.isNode(c.target)&&(c.target=c.target.parentNode);a.overTargets=null,r.freeEvent(l),r.freeEvent(c)}r.cursor=null},this.onPointerOver=function(i){var a=r.trackingData(i.pointerId),o=r.createPointerEvent(i),s=o.pointerType==="mouse"||o.pointerType==="pen";r.dispatchEvent(o,"pointerover"),s&&r.dispatchEvent(o,"mouseover"),o.pointerType==="mouse"&&(r.cursor=r.getCursor(o.target));var l=r.clonePointerEvent(o,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(Kn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)l.currentTarget=l.target,r.notifyTarget(l),s&&r.notifyTarget(l,"mouseenter"),Kn.isNode(l.target)&&(l.target=l.target.parentNode);a.overTargets=o.composedPath(),r.freeEvent(o),r.freeEvent(l)},this.onPointerUpOutside=function(i){var a=r.trackingData(i.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[i.button]),s=r.createPointerEvent(i);if(o){for(var l=o;l;)s.currentTarget=l,r.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"||(s.pointerType==="mouse"||s.pointerType==="pen")&&r.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),Kn.isNode(l)&&(l=l.parentNode);delete a.pressTargetsByButton[i.button]}r.freeEvent(s)},this.onWheel=function(i){var a=r.createWheelEvent(i);r.dispatchEvent(a),r.freeEvent(a)},this.onClick=function(i){if(r.context.config.useNativeClickEvent){var a=r.createPointerEvent(i);r.dispatchEvent(a),r.freeEvent(a)}},this.onPointerCancel=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(a),r.freeEvent(a)}}return n.prototype.init=function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)},n.prototype.destroy=function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()},n.prototype.getScale=function(){var e=this.context.contextService.getBoundingClientRect(),t=1,r=1,i=this.context.contextService.getDomElement();if(i&&e){var a=i.offsetWidth,o=i.offsetHeight;a&&o&&(t=e.width/a,r=e.height/o)}return{scaleX:t,scaleY:r,bbox:e}},n.prototype.client2Viewport=function(e){var t=this.getScale(),r=t.scaleX,i=t.scaleY,a=t.bbox;return new sr((e.x-((a==null?void 0:a.left)||0))/r,(e.y-((a==null?void 0:a.top)||0))/i)},n.prototype.viewport2Client=function(e){var t=this.getScale(),r=t.scaleX,i=t.scaleY,a=t.bbox;return new sr((e.x+((a==null?void 0:a.left)||0))*r,(e.y+((a==null?void 0:a.top)||0))*i)},n.prototype.viewport2Canvas=function(e){var t=e.x,r=e.y,i=this.rootTarget.defaultView,a=i.getCamera(),o=this.context.config,s=o.width,l=o.height,c=a.getPerspectiveInverse(),u=a.getWorldTransform(),h=Ut(this.tmpMatrix,u,c),f=_.t8(this.tmpVec3,t/s*2-1,(1-r/l)*2-1,0);return _.fF(f,f,h),new sr(f[0],f[1])},n.prototype.canvas2Viewport=function(e){var t=this.rootTarget.defaultView,r=t.getCamera(),i=r.getPerspective(),a=r.getViewTransform(),o=Ut(this.tmpMatrix,i,a),s=_.t8(this.tmpVec3,e.x,e.y,0);_.fF(this.tmpVec3,this.tmpVec3,o);var l=this.context.config,c=l.width,u=l.height;return new sr((s[0]+1)/2*c,(1-(s[1]+1)/2)*u)},n.prototype.setPickHandler=function(e){this.pickHandler=e},n.prototype.addEventMapping=function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(r,i){return r.priority-i.priority})},n.prototype.mapEvent=function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var r=0,i=t.length;r<i;r++)t[r].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type))}},n.prototype.dispatchEvent=function(e,t,r){if(!r)e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t);else{e.eventPhase=e.AT_TARGET;var i=this.rootTarget.defaultView||null;e.currentTarget=i,this.notifyListeners(e,t)}this.emitter.emit(t||e.type,e)},n.prototype.propagate=function(e,t){if(e.target){var r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var i=r.length-1;i>=1;i--)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){var a=r.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var i=a+1;i<r.length;i++)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}},n.prototype.propagationPath=function(e){var t=[e],r=this.rootTarget.defaultView||null;if(r&&r===e)return t.unshift(r.document),t;for(var i=0;i<X4&&e!==this.rootTarget;i++)Kn.isNode(e)&&e.parentNode&&(t.push(e.parentNode),e=e.parentNode);return r&&t.push(r),t},n.prototype.hitTest=function(e){var t=e.viewportX,r=e.viewportY,i=this.context.config,a=i.width,o=i.height,s=i.disableHitTesting;return t<0||r<0||t>a||r>o?null:!s&&this.pickHandler(e)||this.rootTarget||null},n.prototype.isNativeEventFromCanvas=function(e,t){var r=t==null?void 0:t.target;if(r!=null&&r.shadowRoot&&(r=t.composedPath()[0]),r){if(r===e)return!0;if(e&&e.contains)return e.contains(r)}return t!=null&&t.composedPath?t.composedPath().indexOf(e)>-1:!1},n.prototype.getExistedHTML=function(e){var t,r;if(e.nativeEvent.composedPath)try{for(var i=sa(e.nativeEvent.composedPath()),a=i.next();!a.done;a=i.next()){var o=a.value,s=this.nativeHTMLMap.get(o);if(s)return s}}catch(l){t={error:l}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return null},n.prototype.pickTarget=function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY})},n.prototype.createPointerEvent=function(e,t,r,i){var a=this.allocateEvent(N0);this.copyPointerData(e,a),this.copyMouseData(e,a),this.copyData(e,a),a.nativeEvent=e.nativeEvent,a.originalEvent=e;var o=this.getExistedHTML(a),s=this.context.contextService.getDomElement();return a.target=r!=null?r:o||this.isNativeEventFromCanvas(s,a.nativeEvent)&&this.pickTarget(a)||i,typeof t=="string"&&(a.type=t),a},n.prototype.createWheelEvent=function(e){var t=this.allocateEvent(R0);this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e;var r=this.getExistedHTML(t),i=this.context.contextService.getDomElement();return t.target=r||this.isNativeEventFromCanvas(i,t.nativeEvent)&&this.pickTarget(t),t},n.prototype.trackingData=function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]},n.prototype.cloneWheelEvent=function(e){var t=this.allocateEvent(R0);return t.nativeEvent=e.nativeEvent,t.originalEvent=e.originalEvent,this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.target=e.target,t.path=e.composedPath().slice(),t.type=e.type,t},n.prototype.clonePointerEvent=function(e,t){var r=this.allocateEvent(N0);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=t!=null?t:r.type,r},n.prototype.copyPointerData=function(e,t){t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist},n.prototype.copyMouseData=function(e,t){t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.client.copyFrom(e.client),t.movement.copyFrom(e.movement),t.canvas.copyFrom(e.canvas),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global),t.offset.copyFrom(e.offset)},n.prototype.copyWheelData=function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ},n.prototype.copyData=function(e,t){t.isTrusted=e.isTrusted,t.timeStamp=P0.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.page.copyFrom(e.page),t.viewport.copyFrom(e.viewport)},n.prototype.allocateEvent=function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t},n.prototype.freeEvent=function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)},n.prototype.notifyTarget=function(e,t){t=t!=null?t:e.type;var r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)},n.prototype.notifyListeners=function(e,t){var r=e.currentTarget.emitter,i=r._events[t];if(i)if("fn"in i)i.once&&r.removeListener(t,i.fn,void 0,!0),i.fn.call(e.currentTarget||i.context,e);else for(var a=0;a<i.length&&!e.propagationImmediatelyStopped;a++)i[a].once&&r.removeListener(t,i[a].fn,void 0,!0),i[a].fn.call(e.currentTarget||i[a].context,e)},n.prototype.findMountedTarget=function(e){if(!e)return null;for(var t=e[e.length-1],r=e.length-2;r>=0;r--){var i=e[r];if(i===this.rootTarget||Kn.isNode(i)&&i.parentNode===t)t=e[r];else break}return t},n.prototype.getCursor=function(e){for(var t=e;t;){var r=h4(t)&&t.getAttribute("cursor");if(r)return r;t=Kn.isNode(t)&&t.parentNode}},n}(),$4=function(){function n(){}return n.prototype.getOrCreateCanvas=function(e,t){if(this.canvas)return this.canvas;if(e||st.offscreenCanvas)this.canvas=e||st.offscreenCanvas,this.context=this.canvas.getContext("2d",se({willReadFrequently:!0},t));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",se({willReadFrequently:!0},t)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",se({willReadFrequently:!0},t))}return this.canvas.width=10,this.canvas.height=10,this.canvas},n.prototype.getOrCreateContext=function(e,t){return this.context?this.context:(this.getOrCreateCanvas(e,t),this.context)},n}(),es;(function(n){n[n.CAMERA_CHANGED=0]="CAMERA_CHANGED",n[n.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",n[n.NONE=2]="NONE"})(es||(es={}));var K4=function(){function n(e,t){this.globalRuntime=e,this.context=t,this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new br,initAsync:new M4,dirtycheck:new C0,cull:new C0,beginFrame:new br,beforeRender:new br,render:new br,afterRender:new br,endFrame:new br,destroy:new br,pick:new C4,pickSync:new C0,pointerDown:new br,pointerUp:new br,pointerMove:new br,pointerOut:new br,pointerOver:new br,pointerWheel:new br,pointerCancel:new br,click:new br}}return n.prototype.init=function(e){var t=this,r=se(se({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(i){i.apply(r,t.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){t.inited=!0,e()})},n.prototype.getStats=function(){return this.stats},n.prototype.disableDirtyRectangleRendering=function(){var e=this.context.config.renderer,t=e.getConfig().enableDirtyRectangleRendering;return!t||this.context.renderingContext.renderReasons.has(es.CAMERA_CHANGED)},n.prototype.render=function(e,t,r){var i=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var a=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=a.renderReasons.size===1&&a.renderReasons.has(es.CAMERA_CHANGED),s=!e.disableRenderHooks||!(e.disableRenderHooks&&o);s&&this.renderDisplayObject(a.root,e,a),this.hooks.beginFrame.call(t),s&&a.renderListCurrentFrame.forEach(function(l){i.hooks.beforeRender.call(l),i.hooks.render.call(l),i.hooks.afterRender.call(l)}),this.hooks.endFrame.call(t),a.renderListCurrentFrame=[],a.renderReasons.clear(),r()}},n.prototype.renderDisplayObject=function(e,t,r){var i=this,a=t.renderer.getConfig(),o=a.enableDirtyCheck,s=a.enableCulling;this.globalRuntime.enableCSSParsing&&this.globalRuntime.styleValueRegistry.recalc(e);var l=e.renderable,c=o?l.dirty||r.dirtyRectangleRenderingDisabled?e:null:e;if(c){var u=s?this.hooks.cull.call(c,this.context.camera):c;u&&(this.stats.rendered++,r.renderListCurrentFrame.push(u))}e.renderable.dirty=!1,e.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var h=e.sortable;h.dirty&&(this.sort(e,h),h.dirty=!1,h.dirtyChildren=[],h.dirtyReason=void 0),(h.sorted||e.childNodes).forEach(function(f){i.renderDisplayObject(f,t,r)})},n.prototype.sort=function(e,t){t.sorted&&t.dirtyReason!==ol.Z_INDEX_CHANGED?t.dirtyChildren.forEach(function(r){var i=e.childNodes.indexOf(r);if(i===-1){var a=t.sorted.indexOf(r);a>=0&&t.sorted.splice(a,1)}else if(t.sorted.length===0)t.sorted.push(r);else{var o=f4(t.sorted,r);t.sorted.splice(o,0,r)}}):t.sorted=e.childNodes.slice().sort(ZE)},n.prototype.destroy=function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()},n.prototype.dirtify=function(){this.context.renderingContext.renderReasons.add(es.DISPLAY_OBJECT_CHANGED)},n}(),Z4=/\[\s*(.*)=(.*)\s*\]/,q4=function(){function n(){}return n.prototype.selectOne=function(e,t){var r=this;if(e.startsWith("."))return t.find(function(s){return((s==null?void 0:s.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.find(function(s){return s.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,o=i.value;return a?t.find(function(s){return t!==s&&(a==="name"?s.name===o:r.attributeToString(s,a)===o)}):null}else return t.find(function(s){return t!==s&&s.nodeName===e})},n.prototype.selectAll=function(e,t){var r=this;if(e.startsWith("."))return t.findAll(function(s){return t!==s&&((s==null?void 0:s.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.findAll(function(s){return t!==s&&s.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,o=i.value;return a?t.findAll(function(s){return t!==s&&(a==="name"?s.name===o:r.attributeToString(s,a)===o)}):[]}else return t.findAll(function(s){return t!==s&&s.nodeName===e})},n.prototype.is=function(e,t){if(e.startsWith("."))return t.className===this.getIdOrClassname(e);if(e.startsWith("#"))return t.id===this.getIdOrClassname(e);if(e.startsWith("[")){var r=this.getAttribute(e),i=r.name,a=r.value;return i==="name"?t.name===a:this.attributeToString(t,i)===a}else return t.nodeName===e},n.prototype.getIdOrClassname=function(e){return e.substring(1)},n.prototype.getAttribute=function(e){var t=e.match(Z4),r="",i="";return t&&t.length>2&&(r=t[1].replace(/"/g,""),i=t[2].replace(/"/g,"")),{name:r,value:i}},n.prototype.attributeToString=function(e,t){if(!e.getAttribute)return"";var r=e.getAttribute(t);return pt(r)?"":r.toString?r.toString():""},n}(),ns=function(n){Me(e,n);function e(t,r,i,a,o,s,l,c){var u=n.call(this,null)||this;return u.relatedNode=r,u.prevValue=i,u.newValue=a,u.attrName=o,u.attrChange=s,u.prevParsedValue=l,u.newParsedValue=c,u.type=t,u}return e.ADDITION=2,e.MODIFICATION=1,e.REMOVAL=3,e}(A0),Ve;(function(n){n.REPARENT="reparent",n.DESTROY="destroy",n.ATTR_MODIFIED="DOMAttrModified",n.INSERTED="DOMNodeInserted",n.REMOVED="removed",n.MOUNTED="DOMNodeInsertedIntoDocument",n.UNMOUNTED="DOMNodeRemovedFromDocument",n.BOUNDS_CHANGED="bounds-changed",n.CULLED="culled"})(Ve||(Ve={}));function o2(n){var e=n.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}var J4=new ns(Ve.REPARENT,null,"","","",0,"",""),Q4=function(){function n(e){var t=this;this.runtime=e,this.pendingEvents=[],this.boundsChangedEvent=new Er(Ve.BOUNDS_CHANGED),this.rotate=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=_.al(a,o,s));var c=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)t.rotateLocal(i,a);else{var u=Vt();yi(u,a[0],a[1],a[2]);var h=t.getRotation(i),f=t.getRotation(i.parentNode);xi(r,f),da(r,r),An(u,r,u),An(c.localRotation,u,h),Ia(c.localRotation,c.localRotation),l&&t.dirtifyLocal(i,c)}}}(),this.rotateLocal=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=_.al(a,o,s));var c=i.transformable;yi(r,a[0],a[1],a[2]),ss(c.localRotation,c.localRotation,r),l&&t.dirtifyLocal(i,c)}}(),this.setEulerAngles=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=_.al(a,o,s));var c=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)t.setLocalEulerAngles(i,a);else{yi(c.localRotation,a[0],a[1],a[2]);var u=t.getRotation(i.parentNode);xi(r,da(Vt(),u)),ss(c.localRotation,c.localRotation,r),l&&t.dirtifyLocal(i,c)}}}(),this.translateLocal=function(){return function(r,i,a,o,s){a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=!0),typeof i=="number"&&(i=_.al(i,a,o));var l=r.transformable;_.fS(i,_.Ue())||(_.VC(i,i,l.localRotation),_.IH(l.localPosition,l.localPosition,i),s&&t.dirtifyLocal(r,l))}}(),this.setPosition=function(){var r=Q(),i=_.Ue();return function(a,o,s){s===void 0&&(s=!0);var l=a.transformable;if(i[0]=o[0],i[1]=o[1],i[2]=o[2]||0,!_.fS(t.getPosition(a),i)){if(_.JG(l.position,i),a.parentNode===null||!a.parentNode.transformable)_.JG(l.localPosition,i);else{var c=a.parentNode.transformable;kt(r,c.worldTransform),Wt(r,r),_.fF(l.localPosition,i,r)}s&&t.dirtifyLocal(a,l)}}}(),this.setLocalPosition=function(){var r=_.Ue();return function(i,a,o){o===void 0&&(o=!0);var s=i.transformable;r[0]=a[0],r[1]=a[1],r[2]=a[2]||0,!_.fS(s.localPosition,r)&&(_.JG(s.localPosition,r),o&&t.dirtifyLocal(i,s))}}(),this.translate=function(){var r=_.Ue(),i=_.Ue(),a=_.Ue();return function(o,s,l,c,u){l===void 0&&(l=0),c===void 0&&(c=0),u===void 0&&(u=!0),typeof s=="number"&&(s=_.t8(i,s,l,c)),!_.fS(s,r)&&(_.IH(a,t.getPosition(o),s),t.setPosition(o,a,u))}}(),this.setRotation=function(){var r=Vt();return function(i,a,o,s,l,c){c===void 0&&(c=!0);var u=i.transformable;if(typeof a=="number"&&(a=pa(a,o,s,l)),i.parentNode===null||!i.parentNode.transformable)t.setLocalRotation(i,a);else{var h=t.getRotation(i.parentNode);xi(r,h),da(r,r),An(u.localRotation,r,a),Ia(u.localRotation,u.localRotation),c&&t.dirtifyLocal(i,u)}}},this.displayObjectDependencyMap=new WeakMap,this.calcLocalTransform=function(){var r=Q(),i=_.Ue(),a=pa(0,0,0,1);return function(o){var s=o.localSkew[0]!==0||o.localSkew[1]!==0;if(s){if(fr(o.localTransform,o.localRotation,o.localPosition,_.al(1,1,1),o.origin),o.localSkew[0]!==0||o.localSkew[1]!==0){var l=Xt(r);l[4]=Math.tan(o.localSkew[0]),l[1]=Math.tan(o.localSkew[1]),Ut(o.localTransform,o.localTransform,l)}var c=fr(r,a,i,o.localScale,o.origin);Ut(o.localTransform,o.localTransform,c)}else fr(o.localTransform,o.localRotation,o.localPosition,o.localScale,o.origin)}}()}return n.prototype.matches=function(e,t){return this.runtime.sceneGraphSelector.is(e,t)},n.prototype.querySelector=function(e,t){return this.runtime.sceneGraphSelector.selectOne(e,t)},n.prototype.querySelectorAll=function(e,t){return this.runtime.sceneGraphSelector.selectAll(e,t)},n.prototype.attach=function(e,t,r){var i,a=!1;e.parentNode&&(a=e.parentNode!==t,this.detach(e)),e.parentNode=t,pt(r)?e.parentNode.childNodes.push(e):e.parentNode.childNodes.splice(r,0,e);var o=t.sortable;(!((i=o==null?void 0:o.sorted)===null||i===void 0)&&i.length||e.parsedStyle.zIndex)&&(o.dirtyChildren.indexOf(e)===-1&&o.dirtyChildren.push(e),o.dirty=!0,o.dirtyReason=ol.ADDED);var s=e.transformable;s&&this.dirtifyWorld(e,s),s.frozen&&this.unfreezeParentToRoot(e),a&&e.dispatchEvent(J4)},n.prototype.detach=function(e){var t,r;if(e.parentNode){var i=e.transformable,a=e.parentNode.sortable;(!((t=a==null?void 0:a.sorted)===null||t===void 0)&&t.length||!((r=e.style)===null||r===void 0)&&r.zIndex)&&(a.dirtyChildren.indexOf(e)===-1&&a.dirtyChildren.push(e),a.dirty=!0,a.dirtyReason=ol.REMOVED);var o=e.parentNode.childNodes.indexOf(e);o>-1&&e.parentNode.childNodes.splice(o,1),i&&this.dirtifyWorld(e,i),e.parentNode=null}},n.prototype.getOrigin=function(e){return e.getGeometryBounds(),e.transformable.origin},n.prototype.setOrigin=function(e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=0),typeof t=="number"&&(t=[t,r,i]);var a=e.transformable;if(!(t[0]===a.origin[0]&&t[1]===a.origin[1]&&t[2]===a.origin[2])){var o=a.origin;o[0]=t[0],o[1]=t[1],o[2]=t[2]||0,this.dirtifyLocal(e,a)}},n.prototype.setLocalEulerAngles=function(e,t,r,i,a){r===void 0&&(r=0),i===void 0&&(i=0),a===void 0&&(a=!0),typeof t=="number"&&(t=_.al(t,r,i));var o=e.transformable;yi(o.localRotation,t[0],t[1],t[2]),a&&this.dirtifyLocal(e,o)},n.prototype.scaleLocal=function(e,t,r){r===void 0&&(r=!0);var i=e.transformable;_.Jp(i.localScale,i.localScale,_.al(t[0],t[1],t[2]||1)),r&&this.dirtifyLocal(e,i)},n.prototype.setLocalScale=function(e,t,r){r===void 0&&(r=!0);var i=e.transformable,a=_.al(t[0],t[1],t[2]||i.localScale[2]);_.fS(a,i.localScale)||(_.JG(i.localScale,a),r&&this.dirtifyLocal(e,i))},n.prototype.setLocalRotation=function(e,t,r,i,a,o){o===void 0&&(o=!0),typeof t=="number"&&(t=pa(t,r,i,a));var s=e.transformable;xi(s.localRotation,t),o&&this.dirtifyLocal(e,s)},n.prototype.setLocalSkew=function(e,t,r){typeof t=="number"&&(t=va.al(t,r));var i=e.transformable;va.JG(i.localSkew,t),this.dirtifyLocal(e,i)},n.prototype.dirtifyLocal=function(e,t){t.localDirtyFlag||(t.localDirtyFlag=!0,t.dirtyFlag||this.dirtifyWorld(e,t))},n.prototype.dirtifyWorld=function(e,t){t.dirtyFlag||this.unfreezeParentToRoot(e),this.dirtifyWorldInternal(e,t),this.dirtifyToRoot(e,!0)},n.prototype.triggerPendingEvents=function(){var e=this,t=new Set,r=function(i,a){i.isConnected&&!t.has(i.entity)&&(e.boundsChangedEvent.detail=a,e.boundsChangedEvent.target=i,i.isMutationObserved?i.dispatchEvent(e.boundsChangedEvent):i.ownerDocument.defaultView.dispatchEvent(e.boundsChangedEvent,!0),t.add(i.entity))};this.pendingEvents.forEach(function(i){var a=Ht(i,2),o=a[0],s=a[1];s.affectChildren?o.forEach(function(l){r(l,s)}):r(o,s)}),this.clearPendingEvents(),t.clear()},n.prototype.clearPendingEvents=function(){this.pendingEvents=[]},n.prototype.dirtifyToRoot=function(e,t){t===void 0&&(t=!1);var r=e;for(r.renderable&&(r.renderable.dirty=!0);r;)o2(r),r=r.parentNode;t&&e.forEach(function(i){o2(i)}),this.informDependentDisplayObjects(e),this.pendingEvents.push([e,{affectChildren:t}])},n.prototype.updateDisplayObjectDependency=function(e,t,r,i){if(t&&t!==r){var a=this.displayObjectDependencyMap.get(t);if(a&&a[e]){var o=a[e].indexOf(i);a[e].splice(o,1)}}if(r){var s=this.displayObjectDependencyMap.get(r);s||(this.displayObjectDependencyMap.set(r,{}),s=this.displayObjectDependencyMap.get(r)),s[e]||(s[e]=[]),s[e].push(i)}},n.prototype.informDependentDisplayObjects=function(e){var t=this,r=this.displayObjectDependencyMap.get(e);r&&Object.keys(r).forEach(function(i){r[i].forEach(function(a){t.dirtifyToRoot(a,!0),a.dispatchEvent(new ns(Ve.ATTR_MODIFIED,a,t,t,i,ns.MODIFICATION,t,t)),a.isCustomElement&&a.isConnected&&a.attributeChangedCallback&&a.attributeChangedCallback(i,t,t)})})},n.prototype.getPosition=function(e){var t=e.transformable;return Qn(t.position,this.getWorldTransform(e,t))},n.prototype.getRotation=function(e){var t=e.transformable;return _n(t.rotation,this.getWorldTransform(e,t))},n.prototype.getScale=function(e){var t=e.transformable;return He(t.scaling,this.getWorldTransform(e,t))},n.prototype.getWorldTransform=function(e,t){return t===void 0&&(t=e.transformable),!t.localDirtyFlag&&!t.dirtyFlag||(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.sync(e,t)),t.worldTransform},n.prototype.getLocalPosition=function(e){return e.transformable.localPosition},n.prototype.getLocalRotation=function(e){return e.transformable.localRotation},n.prototype.getLocalScale=function(e){return e.transformable.localScale},n.prototype.getLocalSkew=function(e){return e.transformable.localSkew},n.prototype.getLocalTransform=function(e){var t=e.transformable;return t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.localTransform},n.prototype.setLocalTransform=function(e,t){var r=Qn(_.Ue(),t),i=_n(Vt(),t),a=He(_.Ue(),t);this.setLocalScale(e,a,!1),this.setLocalPosition(e,r,!1),this.setLocalRotation(e,i,void 0,void 0,void 0,!1),this.dirtifyLocal(e,e.transformable)},n.prototype.resetLocalTransform=function(e){this.setLocalScale(e,[1,1,1]),this.setLocalPosition(e,[0,0,0]),this.setLocalEulerAngles(e,[0,0,0]),this.setLocalSkew(e,[0,0])},n.prototype.getTransformedGeometryBounds=function(e,t,r){t===void 0&&(t=!1);var i=this.getGeometryBounds(e,t);if(or.isEmpty(i))return null;var a=r||new or;return a.setFromTransformedAABB(i,this.getWorldTransform(e)),a},n.prototype.getGeometryBounds=function(e,t){t===void 0&&(t=!1);var r=e.geometry;r.dirty&&st.styleValueRegistry.updateGeometry(e);var i=t?r.renderBounds:r.contentBounds||null;return i||new or},n.prototype.getBounds=function(e,t){var r=this;t===void 0&&(t=!1);var i=e.renderable;if(!i.boundsDirty&&!t&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&t&&i.renderBounds)return i.renderBounds;var a=t?i.renderBounds:i.bounds,o=this.getTransformedGeometryBounds(e,t,a),s=e.childNodes;if(s.forEach(function(u){var h=r.getBounds(u,t);h&&(o?o.add(h):(o=a||new or,o.update(h.center,h.halfExtents)))}),o||(o=new or),t){var l=d4(e);if(l){var c=l.parsedStyle.clipPath.getBounds(t);o?c&&(o=c.intersection(o)):o.update(c.center,c.halfExtents)}}return t?(i.renderBounds=o,i.renderBoundsDirty=!1):(i.bounds=o,i.boundsDirty=!1),o},n.prototype.getLocalBounds=function(e){if(e.parentNode){var t=Q();e.parentNode.transformable&&(t=Wt(Q(),this.getWorldTransform(e.parentNode)));var r=this.getBounds(e);if(!or.isEmpty(r)){var i=new or;return i.setFromTransformedAABB(r,t),i}}return this.getBounds(e)},n.prototype.getBoundingClientRect=function(e){var t,r,i,a=this.getGeometryBounds(e);or.isEmpty(a)||(i=new or,i.setFromTransformedAABB(a,this.getWorldTransform(e)));var o=(r=(t=e.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect();if(i){var s=Ht(i.getMin(),2),l=s[0],c=s[1],u=Ht(i.getMax(),2),h=u[0],f=u[1];return new ho(l+((o==null?void 0:o.left)||0),c+((o==null?void 0:o.top)||0),h-l,f-c)}return new ho((o==null?void 0:o.left)||0,(o==null?void 0:o.top)||0,0,0)},n.prototype.dirtifyWorldInternal=function(e,t){var r=this;if(!t.dirtyFlag){t.dirtyFlag=!0,t.frozen=!1,e.childNodes.forEach(function(a){var o=a.transformable;o.dirtyFlag||r.dirtifyWorldInternal(a,o)});var i=e.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0)}},n.prototype.syncHierarchy=function(e){var t=e.transformable;if(!t.frozen){t.frozen=!0,(t.localDirtyFlag||t.dirtyFlag)&&this.sync(e,t);for(var r=e.childNodes,i=0;i<r.length;i++)this.syncHierarchy(r[i])}},n.prototype.sync=function(e,t){if(t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.dirtyFlag){var r=e.parentNode,i=r&&r.transformable;r===null||!i?kt(t.worldTransform,t.localTransform):Ut(t.worldTransform,i.worldTransform,t.localTransform),t.dirtyFlag=!1}},n.prototype.unfreezeParentToRoot=function(e){for(var t=e.parentNode;t;){var r=t.transformable;r&&(r.frozen=!1),t=t.parentNode}},n}(),rs={MetricsString:"|\xC9q\xC5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},s2=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,tF=/[!%),.:;?\]}'""]/,eF=/[$('"]/,nF=/[!),.:;?\]}'""]/,rF=/[([{'"]/,iF=/[)\]'"?!:;,.]/,aF=/[(['"...]/,oF=/[!%),.:;?\]}'"]/,sF=/[$([{'"#]/,lF=new RegExp("".concat(tF.source,"|").concat(nF.source,"|").concat(iF.source,"|").concat(oF.source)),cF=new RegExp("".concat(eF.source,"|").concat(rF.source,"|").concat(aF.source,"|").concat(sF.source)),uF=function(){function n(e){var t=this;this.runtime=e,this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(r,i){return t.isBreakingSpace(i)?!1:!!(r&&(cF.exec(i)||lF.exec(r)))},this.trimByKinsokuShorui=function(r){var i=nn([],Ht(r),!1),a=i[i.length-2];if(!a)return r;var o=a[a.length-1];return i[i.length-2]=a.slice(0,-1),i[i.length-1]=o+i[i.length-1],i}}return n.prototype.measureFont=function(e,t){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var r={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(t),a=this.runtime.offscreenCanvasCreator.getOrCreateContext(t,{willReadFrequently:!0});a.font=e;var o=rs.MetricsString+rs.BaselineSymbol,s=Math.ceil(a.measureText(o).width),l=Math.ceil(a.measureText(rs.BaselineSymbol).width),c=rs.HeightMultiplier*l;l=l*rs.BaselineMultiplier|0,i.width=s,i.height=c,a.fillStyle="#f00",a.fillRect(0,0,s,c),a.font=e,a.textBaseline="alphabetic",a.fillStyle="#000",a.fillText(o,0,l);var u=a.getImageData(0,0,s||1,c||1).data,h=u.length,f=s*4,d=0,p=0,v=!1;for(d=0;d<l;++d){for(var g=0;g<f;g+=4)if(u[p+g]!==255){v=!0;break}if(!v)p+=f;else break}for(r.ascent=l-d,p=h-f,v=!1,d=c;d>l;--d){for(var g=0;g<f;g+=4)if(u[p+g]!==255){v=!0;break}if(!v)p-=f;else break}return r.descent=d-l,r.fontSize=r.ascent+r.descent,this.fontMetricsCache[e]=r,r},n.prototype.measureText=function(e,t,r){var i=t.fontSize,a=i===void 0?16:i,o=t.wordWrap,s=o===void 0?!1:o,l=t.lineHeight,c=t.lineWidth,u=c===void 0?1:c,h=t.textBaseline,f=h===void 0?"alphabetic":h,d=t.textAlign,p=d===void 0?"start":d,v=t.letterSpacing,g=v===void 0?0:v,m=t.textPath;t.textPathSide,t.textPathStartOffset;var x=t.leading,S=x===void 0?0:x,T=N4(t),b=this.measureFont(T,r);b.fontSize===0&&(b.fontSize=a,b.ascent=a);var y=this.runtime.offscreenCanvasCreator.getOrCreateContext(r);y.font=T,t.isOverflowing=!1;var E=s?this.wordWrap(e,t,r):e,w=E.split(/(?:\r\n|\r|\n)/),C=new Array(w.length),M=0;if(m){m.getTotalLength();for(var O=0;O<w.length;O++)var A=y.measureText(w[O]).width+(w[O].length-1)*g}else{for(var O=0;O<w.length;O++){var R=y.measureText(w[O]).width+(w[O].length-1)*g;C[O]=R,M=Math.max(M,R)}var A=M+u,L=l||b.fontSize+u,z=Math.max(L,b.fontSize+u)+(w.length-1)*(L+S);L+=S;var Y=0;return f==="middle"?Y=-z/2:f==="bottom"||f==="alphabetic"||f==="ideographic"?Y=-z:(f==="top"||f==="hanging")&&(Y=0),{font:T,width:A,height:z,lines:w,lineWidths:C,lineHeight:L,maxLineWidth:M,fontProperties:b,lineMetrics:C.map(function(q,J){var wt=0;return p==="center"||p==="middle"?wt-=q/2:(p==="right"||p==="end")&&(wt-=q),new ho(wt-u/2,Y+J*L,q+u,L)})}}},n.prototype.setGraphemeOnPath=function(){},n.prototype.wordWrap=function(e,t,r){var i=this,a=t.wordWrapWidth,o=a===void 0?0:a,s=t.letterSpacing,l=s===void 0?0:s,c=t.maxLines,u=c===void 0?1/0:c,h=t.textOverflow,f=this.runtime.offscreenCanvasCreator.getOrCreateContext(r),d=o+l,p="";h==="ellipsis"?p="...":h&&h!=="clip"&&(p=h);for(var v=[],g=0,m=0,x={},S=function(Y){return i.getFromCache(Y,l,x,f)},T=Array.from(p).reduce(function(Y,I){return Y+S(I)},0),b=Array.from(e),y=0;y<b.length;y++){var E=b[y],w=e[y-1],C=e[y+1],M=S(E);if(this.isNewline(E)){if(g++,g>=u){t.isOverflowing=!0;break}m=0,v[g]="";continue}if(m>0&&m+M>d){if(g+1>=u){if(t.isOverflowing=!0,T>0&&T<=d){for(var O=v[g].length,A=0,R=O,L=0;L<O;L++){var z=S(v[g][L]);if(A+z+T>d){R=L;break}A+=z}v[g]=(v[g]||"").slice(0,R)+p}break}if(g++,m=0,v[g]="",this.isBreakingSpace(E))continue;this.canBreakInLastChar(E)||(v=this.trimToBreakable(v),m=this.sumTextWidthByCache(v[g]||"",x)),this.shouldBreakByKinsokuShorui(E,C)&&(v=this.trimByKinsokuShorui(v),m+=S(w||""))}m+=M,v[g]=(v[g]||"")+E}return v.join(`
`)},n.prototype.isBreakingSpace=function(e){return typeof e!="string"?!1:rs.BreakingSpaces.indexOf(e.charCodeAt(0))>=0},n.prototype.isNewline=function(e){return typeof e!="string"?!1:rs.Newlines.indexOf(e.charCodeAt(0))>=0},n.prototype.trimToBreakable=function(e){var t=nn([],Ht(e),!1),r=t[t.length-2],i=this.findBreakableIndex(r);if(i===-1||!r)return t;var a=r.slice(i,i+1),o=this.isBreakingSpace(a),s=i+1,l=i+(o?0:1);return t[t.length-1]+=r.slice(s,r.length),t[t.length-2]=r.slice(0,l),t},n.prototype.canBreakInLastChar=function(e){return!(e&&s2.test(e))},n.prototype.sumTextWidthByCache=function(e,t){return e.split("").reduce(function(r,i){if(!t[i])throw Error("cannot count the word without cache");return r+t[i]},0)},n.prototype.findBreakableIndex=function(e){for(var t=e.length-1;t>=0;t--)if(!s2.test(e[t]))return t;return-1},n.prototype.getFromCache=function(e,t,r,i){var a=r[e];if(typeof a!="number"){var o=e.length*t;a=i.measureText(e).width+o,r[e]=a}return a},n}(),st={},hF=function(){var n,e=new U4,t=new W4;return n={},n[At.CIRCLE]=new B4,n[At.ELLIPSE]=new F4,n[At.RECT]=e,n[At.IMAGE]=e,n[At.GROUP]=new H4,n[At.LINE]=new G4,n[At.TEXT]=new V4(st),n[At.POLYLINE]=t,n[At.POLYGON]=t,n[At.PATH]=new z4,n[At.HTML]=null,n[At.MESH]=null,n}(),fF=function(){var n,e=new ZB,t=new S0;return n={},n[Tt.PERCENTAGE]=null,n[Tt.NUMBER]=new e4,n[Tt.ANGLE]=new $B,n[Tt.DEFINED_PATH]=new KB,n[Tt.PAINT]=e,n[Tt.COLOR]=e,n[Tt.FILTER]=new qB,n[Tt.LENGTH]=t,n[Tt.LENGTH_PERCENTAGE]=t,n[Tt.LENGTH_PERCENTAGE_12]=new JB,n[Tt.LENGTH_PERCENTAGE_14]=new QB,n[Tt.COORDINATE]=new S0,n[Tt.OFFSET_DISTANCE]=new n4,n[Tt.OPACITY_VALUE]=new r4,n[Tt.PATH]=new i4,n[Tt.LIST_OF_POINTS]=new a4,n[Tt.SHADOW_BLUR]=new o4,n[Tt.TEXT]=new s4,n[Tt.TEXT_TRANSFORM]=new l4,n[Tt.TRANSFORM]=new L4,n[Tt.TRANSFORM_ORIGIN]=new I4,n[Tt.Z_INDEX]=new D4,n[Tt.MARKER]=new t4,n}(),dF=function(){return typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:{}};st.CameraContribution=V6,st.AnimationTimeline=null,st.EasingFunction=null,st.offscreenCanvasCreator=new $4,st.sceneGraphSelector=new q4,st.sceneGraphService=new Q4(st),st.textService=new uF(st),st.geometryUpdaterFactory=hF,st.CSSPropertySyntaxFactory=fF,st.styleValueRegistry=new jB(st),st.layoutRegistry=null,st.globalThis=dF(),st.enableCSSParsing=!1,st.enableDataset=!1,st.enableStyleSyntax=!0,st.enableAttributeDashCased=!1,st.enableSizeAttenuation=!1;var l2=0;function iU(){l2=0}var c2=new ns(Ve.INSERTED,null,"","","",0,"",""),u2=new ns(Ve.REMOVED,null,"","","",0,"",""),pF=new Er(Ve.DESTROY),vF=function(n){Me(e,n);function e(){var t=n.call(this)||this;return t.entity=l2++,t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.cullable={strategy:f0.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle=st.enableCSSParsing?{opacity:qe,fillOpacity:qe,strokeOpacity:qe,fill:qe,stroke:qe,transform:qe,transformOrigin:qe,visibility:qe,pointerEvents:qe,lineWidth:qe,lineCap:qe,lineJoin:qe,increasedLineWidthForHitTesting:qe,fontSize:qe,fontFamily:qe,fontStyle:qe,fontWeight:qe,fontVariant:qe,textAlign:qe,textBaseline:qe,textTransform:qe,zIndex:qe,filter:qe,shadowType:qe}:null,t.parsedStyle={},t.attributes={},t}return Object.defineProperty(e.prototype,"className",{get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"classList",{get:function(){return this.className.split(" ").filter(function(t){return t!==""})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagName",{get:function(){return this.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(t){throw new Error(on)},e.prototype.appendChild=function(t,r){var i;if(t.destroyed)throw new Error(U6);return st.sceneGraphService.attach(t,this,r),!((i=this.ownerDocument)===null||i===void 0)&&i.defaultView&&this.ownerDocument.defaultView.mountChildren(t),this.isMutationObserved&&(c2.relatedNode=this,t.dispatchEvent(c2)),t},e.prototype.insertBefore=function(t,r){if(!r)this.appendChild(t);else{t.parentElement&&t.parentElement.removeChild(t);var i=this.childNodes.indexOf(r);i===-1?this.appendChild(t):this.appendChild(t,i)}return t},e.prototype.replaceChild=function(t,r){var i=this.childNodes.indexOf(r);return this.removeChild(r),this.appendChild(t,i),r},e.prototype.removeChild=function(t){var r;return u2.relatedNode=this,t.dispatchEvent(u2),!((r=t.ownerDocument)===null||r===void 0)&&r.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),st.sceneGraphService.detach(t),t},e.prototype.removeChildren=function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];this.removeChild(r)}},e.prototype.destroyChildren=function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];r.childNodes.length&&r.destroyChildren(),r.destroy()}},e.prototype.matches=function(t){return st.sceneGraphService.matches(t,this)},e.prototype.getElementById=function(t){return st.sceneGraphService.querySelector("#".concat(t),this)},e.prototype.getElementsByName=function(t){return st.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)},e.prototype.getElementsByClassName=function(t){return st.sceneGraphService.querySelectorAll(".".concat(t),this)},e.prototype.getElementsByTagName=function(t){return st.sceneGraphService.querySelectorAll(t,this)},e.prototype.querySelector=function(t){return st.sceneGraphService.querySelector(t,this)},e.prototype.querySelectorAll=function(t){return st.sceneGraphService.querySelectorAll(t,this)},e.prototype.closest=function(t){var r=this;do{if(st.sceneGraphService.matches(t,r))return r;r=r.parentElement}while(r!==null);return null},e.prototype.find=function(t){var r=this,i=null;return this.forEach(function(a){return a!==r&&t(a)?(i=a,!0):!1}),i},e.prototype.findAll=function(t){var r=this,i=[];return this.forEach(function(a){a!==r&&t(a)&&i.push(a)}),i},e.prototype.after=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this);r.forEach(function(o,s){var l;return(l=t.parentNode)===null||l===void 0?void 0:l.appendChild(o,a+s+1)})}},e.prototype.before=function(){for(var t,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this),o=Ht(r),s=o[0],l=o.slice(1);this.parentNode.appendChild(s,a),(t=s).after.apply(t,nn([],Ht(l),!1))}},e.prototype.replaceWith=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.after.apply(this,nn([],Ht(t),!1)),this.remove()},e.prototype.append=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(a){return t.appendChild(a)})},e.prototype.prepend=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(a,o){return t.appendChild(a,o)})},e.prototype.replaceChildren=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,nn([],Ht(t),!1))},e.prototype.remove=function(){return this.parentNode?this.parentNode.removeChild(this):this},e.prototype.destroy=function(){this.dispatchEvent(pF),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0},e.prototype.getGeometryBounds=function(){return st.sceneGraphService.getGeometryBounds(this)},e.prototype.getRenderBounds=function(){return st.sceneGraphService.getBounds(this,!0)},e.prototype.getBounds=function(){return st.sceneGraphService.getBounds(this)},e.prototype.getLocalBounds=function(){return st.sceneGraphService.getLocalBounds(this)},e.prototype.getBoundingClientRect=function(){return st.sceneGraphService.getBoundingClientRect(this)},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},e.prototype.getAttributeNames=function(){return Object.keys(this.attributes)},e.prototype.getAttribute=function(t){if(J6(t))return st.enableCSSParsing?null:void 0;var r=this.attributes[t];if(r===void 0){if(st.enableAttributeDashCased){var i=s0(t);r=this.attributes[i]}return st.enableCSSParsing&&pt(r)?null:r}else return r},e.prototype.hasAttribute=function(t){return this.getAttributeNames().includes(t)},e.prototype.hasAttributes=function(){return!!this.getAttributeNames().length},e.prototype.removeAttribute=function(t){this.setAttribute(t,null),delete this.attributes[t]},e.prototype.setAttribute=function(t,r,i,a){this.attributes[t]=r},e.prototype.getAttributeNS=function(t,r){throw new Error(on)},e.prototype.getAttributeNode=function(t){throw new Error(on)},e.prototype.getAttributeNodeNS=function(t,r){throw new Error(on)},e.prototype.hasAttributeNS=function(t,r){throw new Error(on)},e.prototype.removeAttributeNS=function(t,r){throw new Error(on)},e.prototype.removeAttributeNode=function(t){throw new Error(on)},e.prototype.setAttributeNS=function(t,r,i){throw new Error(on)},e.prototype.setAttributeNode=function(t){throw new Error(on)},e.prototype.setAttributeNodeNS=function(t){throw new Error(on)},e.prototype.toggleAttribute=function(t,r){throw new Error(on)},e}(Kn);function Je(n){return!!(n!=null&&n.nodeName)}var h2=st.globalThis.Proxy?st.globalThis.Proxy:function(){},Ra=new ns(Ve.ATTR_MODIFIED,null,null,null,null,ns.MODIFICATION,null,null),gF={opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",zIndex:"",filter:"",shadowType:""},mF={fill:uf,stroke:uf,transform:[],zIndex:0,filter:[],shadowType:"outer",miterLimit:10},yF=["opacity","fillOpacity","strokeOpacity","transformOrigin","visibility","pointerEvents","lineWidth","lineCap","lineJoin","increasedLineWidthForHitTesting"],xF=nn(nn([],Ht(yF),!1),["fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform"],!1),f2="data-",Fi=function(n){Me(e,n);function e(t){var r=n.call(this)||this;return r.isCustomElement=!1,r.isMutationObserved=!1,r.activeAnimations=[],r.config=t,r.id=r.config.id||"",r.name=r.config.name||"",(r.config.className||r.config.class)&&(r.className=r.config.className||r.config.class),r.nodeName=r.config.type||At.GROUP,st.enableCSSParsing?(Object.assign(r.attributes,gF),Object.assign(r.parsedStyle,mF,r.config.initialParsedStyle)):r.config.initialParsedStyle&&Object.assign(r.parsedStyle,r.config.initialParsedStyle),r.initAttributes(r.config.style),st.enableDataset&&(r.dataset=new h2({},{get:function(i,a){var o="".concat(f2).concat(_E(a));return i[o]!==void 0?i[o]:r.getAttribute(o)},set:function(i,a,o){return r.setAttribute("".concat(f2).concat(_E(a)),o),!0}})),st.enableStyleSyntax&&(r.style=new h2({setProperty:function(i,a){r.setAttribute(i,a)},getPropertyValue:function(i){return r.getAttribute(i)},removeProperty:function(i){r.removeAttribute(i)},item:function(){return""}},{get:function(i,a){return i[a]!==void 0?i[a]:r.getAttribute(a)},set:function(i,a,o){return r.setAttribute(a,o),!0}})),r}return e.prototype.destroy=function(){n.prototype.destroy.call(this),this.getAnimations().forEach(function(t){t.cancel()})},e.prototype.cloneNode=function(t,r){var i=se({},this.attributes);for(var a in i){var o=i[a];Je(o)&&a!=="clipPath"&&a!=="offsetPath"&&a!=="textPath"&&(i[a]=o.cloneNode(t)),r&&(i[a]=r(a,o))}var s=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:i});return s.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(l){if(!l.style.isMarker){var c=l.cloneNode(t);s.appendChild(c)}}),s},e.prototype.initAttributes=function(t){t===void 0&&(t={});var r=this.renderable,i={forceUpdateGeometry:!0};st.enableCSSParsing&&(i.usedAttributes=xF);var a=t;if(st.enableAttributeDashCased){a={};for(var o in t){var s=s0(o);a[s]=t[o]}}st.styleValueRegistry.processProperties(this,a,i),r.dirty=!0},e.prototype.setAttribute=function(t,r,i,a){i===void 0&&(i=!1),a===void 0&&(a=!0),st.enableAttributeDashCased&&(t=s0(t)),!yt(r)&&(i||r!==this.attributes[t])&&(this.internalSetAttribute(t,r,{memoize:a}),n.prototype.setAttribute.call(this,t,r))},e.prototype.internalSetAttribute=function(t,r,i){var a;i===void 0&&(i={});var o=this.renderable,s=this.attributes[t],l=this.parsedStyle[t];st.styleValueRegistry.processProperties(this,(a={},a[t]=r,a),i),o.dirty=!0;var c=this.parsedStyle[t];this.isConnected&&(Ra.relatedNode=this,Ra.prevValue=s,Ra.newValue=r,Ra.attrName=t,Ra.prevParsedValue=l,Ra.newParsedValue=c,this.isMutationObserved?this.dispatchEvent(Ra):(Ra.target=this,this.ownerDocument.defaultView.dispatchEvent(Ra,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&this.attributeChangedCallback&&this.attributeChangedCallback(t,s,r,l,c)},e.prototype.getBBox=function(){var t=this.getBounds(),r=Ht(t.getMin(),2),i=r[0],a=r[1],o=Ht(t.getMax(),2),s=o[0],l=o[1];return new ho(i,a,s-i,l-a)},e.prototype.setOrigin=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),st.sceneGraphService.setOrigin(this,Ur(t,r,i)),this},e.prototype.getOrigin=function(){return st.sceneGraphService.getOrigin(this)},e.prototype.setPosition=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),st.sceneGraphService.setPosition(this,Ur(t,r,i)),this},e.prototype.setLocalPosition=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),st.sceneGraphService.setLocalPosition(this,Ur(t,r,i)),this},e.prototype.translate=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),st.sceneGraphService.translate(this,Ur(t,r,i)),this},e.prototype.translateLocal=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),st.sceneGraphService.translateLocal(this,Ur(t,r,i)),this},e.prototype.getPosition=function(){return st.sceneGraphService.getPosition(this)},e.prototype.getLocalPosition=function(){return st.sceneGraphService.getLocalPosition(this)},e.prototype.scale=function(t,r,i){return this.scaleLocal(t,r,i)},e.prototype.scaleLocal=function(t,r,i){return typeof t=="number"&&(r=r||t,i=i||t,t=Ur(t,r,i)),st.sceneGraphService.scaleLocal(this,t),this},e.prototype.setLocalScale=function(t,r,i){return typeof t=="number"&&(r=r||t,i=i||t,t=Ur(t,r,i)),st.sceneGraphService.setLocalScale(this,t),this},e.prototype.getLocalScale=function(){return st.sceneGraphService.getLocalScale(this)},e.prototype.getScale=function(){return st.sceneGraphService.getScale(this)},e.prototype.getEulerAngles=function(){var t=Ht(n0(_.Ue(),st.sceneGraphService.getWorldTransform(this)),3),r=t[2];return Di(r)},e.prototype.getLocalEulerAngles=function(){var t=Ht(n0(_.Ue(),st.sceneGraphService.getLocalRotation(this)),3),r=t[2];return Di(r)},e.prototype.setEulerAngles=function(t){return st.sceneGraphService.setEulerAngles(this,0,0,t),this},e.prototype.setLocalEulerAngles=function(t){return st.sceneGraphService.setLocalEulerAngles(this,0,0,t),this},e.prototype.rotateLocal=function(t,r,i){return pt(r)&&pt(i)?st.sceneGraphService.rotateLocal(this,0,0,t):st.sceneGraphService.rotateLocal(this,t,r,i),this},e.prototype.rotate=function(t,r,i){return pt(r)&&pt(i)?st.sceneGraphService.rotate(this,0,0,t):st.sceneGraphService.rotate(this,t,r,i),this},e.prototype.setRotation=function(t,r,i,a){return st.sceneGraphService.setRotation(this,t,r,i,a),this},e.prototype.setLocalRotation=function(t,r,i,a){return st.sceneGraphService.setLocalRotation(this,t,r,i,a),this},e.prototype.setLocalSkew=function(t,r){return st.sceneGraphService.setLocalSkew(this,t,r),this},e.prototype.getRotation=function(){return st.sceneGraphService.getRotation(this)},e.prototype.getLocalRotation=function(){return st.sceneGraphService.getLocalRotation(this)},e.prototype.getLocalSkew=function(){return st.sceneGraphService.getLocalSkew(this)},e.prototype.getLocalTransform=function(){return st.sceneGraphService.getLocalTransform(this)},e.prototype.getWorldTransform=function(){return st.sceneGraphService.getWorldTransform(this)},e.prototype.setLocalTransform=function(t){return st.sceneGraphService.setLocalTransform(this,t),this},e.prototype.resetLocalTransform=function(){st.sceneGraphService.resetLocalTransform(this)},e.prototype.getAnimations=function(){return this.activeAnimations},e.prototype.animate=function(t,r){var i,a=(i=this.ownerDocument)===null||i===void 0?void 0:i.timeline;return a?a.play(this,t,r):null},e.prototype.isVisible=function(){var t,r;return st.enableCSSParsing?((t=this.parsedStyle)===null||t===void 0?void 0:t.visibility)==="visible":((r=this.parsedStyle)===null||r===void 0?void 0:r.visibility)!=="hidden"},Object.defineProperty(e.prototype,"interactive",{get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"},enumerable:!1,configurable:!0}),e.prototype.isInteractive=function(){var t;return((t=this.parsedStyle)===null||t===void 0?void 0:t.pointerEvents)!=="none"},e.prototype.isCulled=function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)},e.prototype.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,nn([],Ht(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})),!1))+1),this},e.prototype.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,nn([],Ht(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})),!1))-1),this},e.prototype.getConfig=function(){return this.config},e.prototype.attr=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=Ht(r,2),o=a[0],s=a[1];return o?Ye(o)?(Object.keys(o).forEach(function(l){t.setAttribute(l,o[l])}),this):r.length===2?(this.setAttribute(o,s),this):this.attributes[o]:this.attributes},e.prototype.getMatrix=function(t){var r=t||this.getWorldTransform(),i=Ht(Qn(_.Ue(),r),2),a=i[0],o=i[1],s=Ht(He(_.Ue(),r),2),l=s[0],c=s[1],u=_n(Vt(),r),h=Ht(n0(_.Ue(),u),3),f=h[0],d=h[2];return I6(f||d,a,o,l,c)},e.prototype.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},e.prototype.setMatrix=function(t){var r=Ht(yE(t),5),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];this.setEulerAngles(l).setPosition(i,a).setLocalScale(o,s)},e.prototype.setLocalMatrix=function(t){var r=Ht(yE(t),5),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];this.setLocalEulerAngles(l).setLocalPosition(i,a).setLocalScale(o,s)},e.prototype.show=function(){st.enableCSSParsing?this.style.visibility="visible":this.forEach(function(t){t.style.visibility="visible"})},e.prototype.hide=function(){st.enableCSSParsing?this.style.visibility="hidden":this.forEach(function(t){t.style.visibility="hidden"})},e.prototype.getCount=function(){return this.childElementCount},e.prototype.getParent=function(){return this.parentElement},e.prototype.getChildren=function(){return this.children},e.prototype.getFirst=function(){return this.firstElementChild},e.prototype.getLast=function(){return this.lastElementChild},e.prototype.getChildByIndex=function(t){return this.children[t]||null},e.prototype.add=function(t,r){return this.appendChild(t,r)},e.prototype.set=function(t,r){this.config[t]=r},e.prototype.get=function(t){return this.config[t]},e.prototype.moveTo=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(t,r,i),this},e.prototype.move=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(t,r,i),this},e.prototype.setZIndex=function(t){return this.style.zIndex=t,this},e}(vF),bF=function(n){Me(e,n);function e(t){return t===void 0&&(t={}),n.call(this,se({type:At.CIRCLE},t))||this}return e}(Fi),aU=function(n){Me(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=co(t,["style"]);return r=n.call(this,se({style:st.enableCSSParsing?se({},i):se({},i)},a))||this,r.isCustomElement=!0,r}return e}(Fi),EF=function(n){Me(e,n);function e(t){return t===void 0&&(t={}),n.call(this,se({type:At.ELLIPSE},t))||this}return e}(Fi),k0=function(n){Me(e,n);function e(t){return t===void 0&&(t={}),n.call(this,se({type:At.GROUP},t))||this}return e}(Fi),wF=function(n){Me(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=co(t,["style"]);return r=n.call(this,se({type:At.HTML,style:st.enableCSSParsing?se({x:"",y:"",width:"auto",height:"auto",innerHTML:""},i):se({},i)},a))||this,r.cullable.enable=!1,r}return e.prototype.getDomElement=function(){return this.parsedStyle.$el},e.prototype.getBoundingClientRect=function(){if(this.parsedStyle.$el){var t=this.ownerDocument.defaultView.getCamera().getOrthoMatrix(),r=this.parsedStyle.$el.getBoundingClientRect();return ho.applyTransform(r,Wt(Q(),t))}else{var i=this.parsedStyle,a=i.x,o=i.y,s=i.width,l=i.height;return new ho(a,o,s,l)}},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.getBounds=function(){var t,r,i=this.getBoundingClientRect(),a=(r=(t=this.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect(),o=new or,s=i.left-((a==null?void 0:a.left)||0),l=i.top-((a==null?void 0:a.top)||0);return o.setMinMax([s,l,0],[s+i.width,l+i.height,0]),o},e.prototype.getLocalBounds=function(){if(this.parentNode){var t=Wt(Q(),this.parentNode.getWorldTransform()),r=this.getBounds();if(!or.isEmpty(r)){var i=new or;return i.setFromTransformedAABB(r,t),i}}return this.getBounds()},e}(Fi),SF=function(n){Me(e,n);function e(t){return t===void 0&&(t={}),n.call(this,se({type:At.IMAGE},t))||this}return e}(Fi),_F=function(n){Me(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=co(t,["style"]);r=n.call(this,se({type:At.LINE,style:se({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},a))||this,r.markerStartAngle=0,r.markerEndAngle=0;var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd;return s&&Je(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),l&&Je(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="x1"||t==="y1"||t==="x2"||t==="y2"||t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&Je(a)&&(this.markerStartAngle=0,a.remove()),o&&Je(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"&&(a&&Je(a)&&(this.markerEndAngle=0,a.remove()),o&&Je(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1)))},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=r.x1,c=r.x2,u=r.y1,h=r.y2,f=t?i:a;if(!(!f||!Je(f))){var d=0,p,v,g,m,x,S;t?(g=l,m=u,p=c-l,v=h-u,x=o||0,S=this.markerStartAngle):(g=c,m=h,p=l-c,v=u-h,x=s||0,S=this.markerEndAngle),d=Math.atan2(v,p),f.setLocalEulerAngles(d*180/Math.PI+S),f.setLocalPosition(g+Math.cos(d)*x,m+Math.sin(d)*x)}},e.prototype.getPoint=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle,a=i.x1,o=i.y1,s=i.x2,l=i.y2,c=Cr(a,o,s,l,t),u=c.x,h=c.y,f=_.fF(_.Ue(),_.al(u,h,0),r?this.getWorldTransform():this.getLocalTransform());return new sr(f[0],f[1])},e.prototype.getPointAtLength=function(t,r){return r===void 0&&(r=!1),this.getPoint(t/this.getTotalLength(),r)},e.prototype.getTotalLength=function(){var t=this.parsedStyle,r=t.x1,i=t.y1,a=t.x2,o=t.y2;return fs(r,i,a,o)},e}(Fi),TF=function(n){Me(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=co(t,["style"]);r=n.call(this,se({type:At.PATH,style:st.enableCSSParsing?se({d:"",miterLimit:""},i):se({},i),initialParsedStyle:st.enableCSSParsing?null:{miterLimit:4,d:se({},PE)}},a))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd,c=o.markerMid;return s&&Je(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),c&&Je(c)&&r.placeMarkerMid(c),l&&Je(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&Je(a)&&(this.markerStartAngle=0,a.remove()),o&&Je(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"?(a&&Je(a)&&(this.markerEndAngle=0,a.remove()),o&&Je(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(o)},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=t?i:a;if(!(!l||!Je(l))){var c=0,u,h,f,d,p,v;if(t){var g=Ht(this.getStartTangent(),2),m=g[0],x=g[1];f=x[0],d=x[1],u=m[0]-x[0],h=m[1]-x[1],p=o||0,v=this.markerStartAngle}else{var S=Ht(this.getEndTangent(),2),m=S[0],x=S[1];f=x[0],d=x[1],u=m[0]-x[0],h=m[1]-x[1],p=s||0,v=this.markerEndAngle}c=Math.atan2(h,u),l.setLocalEulerAngles(c*180/Math.PI+v),l.setLocalPosition(f+Math.cos(c)*p,d+Math.sin(c)*p)}},e.prototype.placeMarkerMid=function(t){var r=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(c){c.remove()}),t&&Je(t))for(var i=1;i<r.length-1;i++){var a=Ht(r[i].currentPoint,2),o=a[0],s=a[1],l=i===1?t:t.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(o,s)}},e.prototype.getTotalLength=function(){return IE(this)},e.prototype.getPointAtLength=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle.d.absolutePath,a=sd(i,t),o=a.x,s=a.y,l=_.fF(_.Ue(),_.al(o,s,0),r?this.getWorldTransform():this.getLocalTransform());return new sr(l[0],l[1])},e.prototype.getPoint=function(t,r){return r===void 0&&(r=!1),this.getPointAtLength(t*IE(this),r)},e.prototype.getStartTangent=function(){var t=this.parsedStyle.d.segments,r=[];if(t.length>1){var i=t[0].currentPoint,a=t[1].currentPoint,o=t[1].startTangent;r=[],o?(r.push([i[0]-o[0],i[1]-o[1]]),r.push([i[0],i[1]])):(r.push([a[0],a[1]]),r.push([i[0],i[1]]))}return r},e.prototype.getEndTangent=function(){var t=this.parsedStyle.d.segments,r=t.length,i=[];if(r>1){var a=t[r-2].currentPoint,o=t[r-1].currentPoint,s=t[r-1].endTangent;i=[],s?(i.push([o[0]-s[0],o[1]-s[1]]),i.push([o[0],o[1]])):(i.push([a[0],a[1]]),i.push([o[0],o[1]]))}return i},e}(Fi),d2=function(n){Me(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=co(t,["style"]);r=n.call(this,se({type:At.POLYGON,style:st.enableCSSParsing?se({points:"",miterLimit:"",isClosed:!0},i):se({},i),initialParsedStyle:st.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},a))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd,c=o.markerMid;return s&&Je(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),c&&Je(c)&&r.placeMarkerMid(c),l&&Je(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&Je(a)&&(this.markerStartAngle=0,a.remove()),o&&Je(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"?(a&&Je(a)&&(this.markerEndAngle=0,a.remove()),o&&Je(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(o)},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=r.points,c=(l||{}).points,u=t?i:a;if(!(!u||!Je(u)||!c)){var h=0,f,d,p,v,g,m;if(p=c[0][0],v=c[0][1],t)f=c[1][0]-c[0][0],d=c[1][1]-c[0][1],g=o||0,m=this.markerStartAngle;else{var x=c.length;this.parsedStyle.isClosed?(f=c[x-1][0]-c[0][0],d=c[x-1][1]-c[0][1]):(p=c[x-1][0],v=c[x-1][1],f=c[x-2][0]-c[x-1][0],d=c[x-2][1]-c[x-1][1]),g=s||0,m=this.markerEndAngle}h=Math.atan2(d,f),u.setLocalEulerAngles(h*180/Math.PI+m),u.setLocalPosition(p+Math.cos(h)*g,v+Math.sin(h)*g)}},e.prototype.placeMarkerMid=function(t){var r=this.parsedStyle.points,i=(r||{}).points;if(this.markerMidList.forEach(function(c){c.remove()}),this.markerMidList=[],t&&Je(t)&&i)for(var a=1;a<(this.parsedStyle.isClosed?i.length:i.length-1);a++){var o=i[a][0],s=i[a][1],l=a===1?t:t.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(o,s)}},e}(Fi),PF=function(n){Me(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=co(t,["style"]);return n.call(this,se({type:At.POLYLINE,style:st.enableCSSParsing?se({points:"",miterLimit:"",isClosed:!1},r):se({},r),initialParsedStyle:st.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i))||this}return e.prototype.getTotalLength=function(){return wB(this)},e.prototype.getPointAtLength=function(t,r){return r===void 0&&(r=!1),this.getPoint(t/this.getTotalLength(),r)},e.prototype.getPoint=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var a=[],o=0,s,l,c=this.getTotalLength();i.forEach(function(g,m){i[m+1]&&(s=[0,0],s[0]=o/c,l=fs(g[0],g[1],i[m+1][0],i[m+1][1]),o+=l,s[1]=o/c,a.push(s))}),this.parsedStyle.points.segments=a}var u=0,h=0;this.parsedStyle.points.segments.forEach(function(g,m){t>=g[0]&&t<=g[1]&&(u=(t-g[0])/(g[1]-g[0]),h=m)});var f=Cr(i[h][0],i[h][1],i[h+1][0],i[h+1][1],u),d=f.x,p=f.y,v=_.fF(_.Ue(),_.al(d,p,0),r?this.getWorldTransform():this.getLocalTransform());return new sr(v[0],v[1])},e.prototype.getStartTangent=function(){var t=this.parsedStyle.points.points,r=[];return r.push([t[1][0],t[1][1]]),r.push([t[0][0],t[0][1]]),r},e.prototype.getEndTangent=function(){var t=this.parsedStyle.points.points,r=t.length-1,i=[];return i.push([t[r-1][0],t[r-1][1]]),i.push([t[r][0],t[r][1]]),i},e}(d2),MF=function(n){Me(e,n);function e(t){return t===void 0&&(t={}),n.call(this,se({type:At.RECT},t))||this}return e}(Fi),p2=function(n){Me(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=co(t,["style"]);return n.call(this,se({type:At.TEXT,style:st.enableCSSParsing?se({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:"",lineHeight:"",miterLimit:"",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},r):se({fill:"black"},r)},i))||this}return e.prototype.getComputedTextLength=function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.maxLineWidth)||0},e.prototype.getLineBoundingRects=function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.lineMetrics)||[]},e.prototype.isOverflowing=function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing},e}(Fi),CF=function(){function n(){this.registry={},this.define(At.CIRCLE,bF),this.define(At.ELLIPSE,EF),this.define(At.RECT,MF),this.define(At.IMAGE,SF),this.define(At.LINE,_F),this.define(At.GROUP,k0),this.define(At.PATH,TF),this.define(At.POLYGON,d2),this.define(At.POLYLINE,PF),this.define(At.TEXT,p2),this.define(At.HTML,wF)}return n.prototype.define=function(e,t){this.registry[e]=t},n.prototype.get=function(e){return this.registry[e]},n}(),oU={number:function(n){return new De(n)},percent:function(n){return new De(n,"%")},px:function(n){return new De(n,"px")},em:function(n){return new De(n,"em")},rem:function(n){return new De(n,"rem")},deg:function(n){return new De(n,"deg")},grad:function(n){return new De(n,"grad")},rad:function(n){return new De(n,"rad")},turn:function(n){return new De(n,"turn")},s:function(n){return new De(n,"s")},ms:function(n){return new De(n,"ms")},registerProperty:function(n){var e=n.name,t=n.inherits,r=n.interpolable,i=n.initialValue,a=n.syntax;st.styleValueRegistry.registerMetadata({n:e,inh:t,int:r,d:i,syntax:a})},registerLayout:function(n,e){st.layoutRegistry.registerLayout(n,e)}},OF=function(n){Me(e,n);function e(){var t=n.call(this)||this;t.defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new st.AnimationTimeline(t)}catch(i){}var r={};return w0.forEach(function(i){var a=i.n,o=i.inh,s=i.d;o&&s&&(r[a]=al(s)?s(At.GROUP):s)}),t.documentElement=new k0({id:"g-root",style:r}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),e.prototype.createElement=function(t,r){if(t==="svg")return this.documentElement;var i=this.defaultView.customElements.get(t);i||(console.warn("Unsupported tagName: ",t),i=t==="tspan"?p2:k0);var a=new i(r);return a.ownerDocument=this,a},e.prototype.createElementNS=function(t,r,i){return this.createElement(r,i)},e.prototype.cloneNode=function(t){throw new Error(on)},e.prototype.destroy=function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(t){}},e.prototype.elementsFromBBox=function(t,r,i,a){var o=this.defaultView.context.rBushRoot,s=o.search({minX:t,minY:r,maxX:i,maxY:a}),l=[];return s.forEach(function(c){var u=c.displayObject,h=u.parsedStyle.pointerEvents,f=h===void 0?"auto":h,d=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(f);(!d||d&&u.isVisible())&&!u.isCulled()&&u.isInteractive()&&l.push(u)}),l.sort(function(c,u){return u.sortable.renderOrder-c.sortable.renderOrder}),l},e.prototype.elementFromPointSync=function(t,r){var i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height;if(a<0||o<0||a>l||o>c)return null;var u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]}).picked;return d&&d[0]||this.documentElement},e.prototype.elementFromPoint=function(t,r){return af(this,void 0,void 0,function(){var i,a,o,s,l,c,u,h,f,d;return of(this,function(p){switch(p.label){case 0:return i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height,a<0||o<0||a>l||o>c?[2,null]:(u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]})]);case 1:return d=p.sent().picked,[2,d&&d[0]||this.documentElement]}})})},e.prototype.elementsFromPointSync=function(t,r){var i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height;if(a<0||o<0||a>l||o>c)return[];var u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]}).picked;return d[d.length-1]!==this.documentElement&&d.push(this.documentElement),d},e.prototype.elementsFromPoint=function(t,r){return af(this,void 0,void 0,function(){var i,a,o,s,l,c,u,h,f,d;return of(this,function(p){switch(p.label){case 0:return i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height,a<0||o<0||a>l||o>c?[2,[]]:(u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]})]);case 1:return d=p.sent().picked,d[d.length-1]!==this.documentElement&&d.push(this.documentElement),[2,d]}})})},e.prototype.appendChild=function(t,r){throw new Error(rl)},e.prototype.insertBefore=function(t,r){throw new Error(rl)},e.prototype.removeChild=function(t,r){throw new Error(rl)},e.prototype.replaceChild=function(t,r,i){throw new Error(rl)},e.prototype.append=function(){throw new Error(rl)},e.prototype.prepend=function(){throw new Error(rl)},e.prototype.getElementById=function(t){return this.documentElement.getElementById(t)},e.prototype.getElementsByName=function(t){return this.documentElement.getElementsByName(t)},e.prototype.getElementsByTagName=function(t){return this.documentElement.getElementsByTagName(t)},e.prototype.getElementsByClassName=function(t){return this.documentElement.getElementsByClassName(t)},e.prototype.querySelector=function(t){return this.documentElement.querySelector(t)},e.prototype.querySelectorAll=function(t){return this.documentElement.querySelectorAll(t)},e.prototype.find=function(t){return this.documentElement.find(t)},e.prototype.findAll=function(t){return this.documentElement.findAll(t)},e}(Kn),AF=function(){function n(e){this.strategies=e}return n.prototype.apply=function(e){var t=e.camera,r=e.renderingService,i=e.renderingContext,a=this.strategies;r.hooks.cull.tap(n.tag,function(o){if(o){var s=o.cullable;return a.length===0?s.visible=i.unculledEntities.indexOf(o.entity)>-1:s.visible=a.every(function(l){return l.isVisible(t,o)}),!o.isCulled()&&o.isVisible()?o:(o.dispatchEvent(new Er(Ve.CULLED)),null)}return o}),r.hooks.afterRender.tap(n.tag,function(o){o.cullable.visibilityPlaneMask=-1})},n.tag="Culling",n}(),NF=function(){function n(){var e=this;this.autoPreventDefault=!1,this.rootPointerEvent=new N0(null),this.rootWheelEvent=new R0(null),this.onPointerMove=function(t){var r,i,a,o,s=(o=(a=e.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||o===void 0?void 0:o.defaultView;if(!(s.supportsTouchEvents&&t.pointerType==="touch")){var l=e.normalizeToPointerEvent(t,s);try{for(var c=sa(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=e.bootstrapEvent(e.rootPointerEvent,h,s,t);e.context.eventService.mapEvent(f)}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var r,i,a,o,s=(o=(a=e.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||o===void 0?void 0:o.defaultView,l=e.normalizeToPointerEvent(t,s);try{for(var c=sa(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=e.bootstrapEvent(e.rootPointerEvent,h,s,t);e.context.eventService.mapEvent(f)}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}}return n.prototype.apply=function(e){var t=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(a){var o=t.context.renderingService.hooks.pickSync.call({position:a,picked:[],topmost:!0}).picked;return o[0]||null}),r.hooks.pointerWheel.tap(n.tag,function(a){var o=t.normalizeWheelEvent(a);t.context.eventService.mapEvent(o)}),r.hooks.pointerDown.tap(n.tag,function(a){var o,s;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var l=t.normalizeToPointerEvent(a,i);if(t.autoPreventDefault&&l[0].isNormalized){var c=a.cancelable||!("cancelable"in a);c&&a.preventDefault()}try{for(var u=sa(l),h=u.next();!h.done;h=u.next()){var f=h.value,d=t.bootstrapEvent(t.rootPointerEvent,f,i,a);t.context.eventService.mapEvent(d)}}catch(p){o={error:p}}finally{try{h&&!h.done&&(s=u.return)&&s.call(u)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerUp.tap(n.tag,function(a){var o,s;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var l=t.context.contextService.getDomElement(),c=t.context.eventService.isNativeEventFromCanvas(l,a),u=c?"":"outside",h=t.normalizeToPointerEvent(a,i);try{for(var f=sa(h),d=f.next();!d.done;d=f.next()){var p=d.value,v=t.bootstrapEvent(t.rootPointerEvent,p,i,a);v.type+=u,t.context.eventService.mapEvent(v)}}catch(g){o={error:g}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerMove.tap(n.tag,this.onPointerMove),r.hooks.pointerOver.tap(n.tag,this.onPointerMove),r.hooks.pointerOut.tap(n.tag,this.onPointerMove),r.hooks.click.tap(n.tag,this.onClick),r.hooks.pointerCancel.tap(n.tag,function(a){var o,s,l=t.normalizeToPointerEvent(a,i);try{for(var c=sa(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=t.bootstrapEvent(t.rootPointerEvent,h,i,a);t.context.eventService.mapEvent(f)}}catch(d){o={error:d}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)})},n.prototype.bootstrapEvent=function(e,t,r,i){e.view=r,e.originalEvent=null,e.nativeEvent=i,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);var a=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),o=a.x,s=a.y;e.viewport.x=o,e.viewport.y=s;var l=this.context.eventService.viewport2Canvas(e.viewport),c=l.x,u=l.y;return e.canvas.x=c,e.canvas.y=u,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=i.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=m4[e.type]||e.type),e},n.prototype.normalizeWheelEvent=function(e){var t=this.rootWheelEvent;this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;var r=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),i=r.x,a=r.y;t.viewport.x=i,t.viewport.y=a;var o=this.context.eventService.viewport2Canvas(t.viewport),s=o.x,l=o.y;return t.canvas.x=s,t.canvas.y=l,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.nativeEvent=e,t.type=e.type,t},n.prototype.transferMouseData=function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=P0.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null},n.prototype.setCursor=function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default")},n.prototype.normalizeToPointerEvent=function(e,t){var r=[];if(t.isTouchEvent(e))for(var i=0;i<e.changedTouches.length;i++){var a=e.changedTouches[i];yt(a.button)&&(a.button=0),yt(a.buttons)&&(a.buttons=1),yt(a.isPrimary)&&(a.isPrimary=e.touches.length===1&&e.type==="touchstart"),yt(a.width)&&(a.width=a.radiusX||1),yt(a.height)&&(a.height=a.radiusY||1),yt(a.tiltX)&&(a.tiltX=0),yt(a.tiltY)&&(a.tiltY=0),yt(a.pointerType)&&(a.pointerType="touch"),yt(a.pointerId)&&(a.pointerId=a.identifier||0),yt(a.pressure)&&(a.pressure=a.force||.5),yt(a.twist)&&(a.twist=0),yt(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,a.type=e.type,r.push(a)}else if(t.isMouseEvent(e)){var o=e;yt(o.isPrimary)&&(o.isPrimary=!0),yt(o.width)&&(o.width=1),yt(o.height)&&(o.height=1),yt(o.tiltX)&&(o.tiltX=0),yt(o.tiltY)&&(o.tiltY=0),yt(o.pointerType)&&(o.pointerType="mouse"),yt(o.pointerId)&&(o.pointerId=g4),yt(o.pressure)&&(o.pressure=.5),yt(o.twist)&&(o.twist=0),yt(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,r.push(o)}else r.push(e);return r},n.tag="Event",n}(),RF=[At.CIRCLE,At.ELLIPSE,At.IMAGE,At.RECT,At.LINE,At.POLYLINE,At.POLYGON,At.TEXT,At.PATH,At.HTML],kF=function(){function n(){}return n.prototype.isVisible=function(e,t){var r,i,a=t.cullable;if(!a.enable)return!0;var o=t.getRenderBounds();if(or.isEmpty(o))return!1;var s=e.getFrustum(),l=(i=(r=t.parentNode)===null||r===void 0?void 0:r.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return a.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,o,l||uo.INDETERMINATE,s.planes),a.visible=a.visibilityPlaneMask!==uo.OUTSIDE,a.visible},n.prototype.computeVisibilityWithPlaneMask=function(e,t,r,i){if(r===uo.OUTSIDE||r===uo.INSIDE)return r;for(var a=uo.INSIDE,o=RF.indexOf(e.nodeName)>-1,s=0,l=i.length;s<l;++s){var c=1<<s;if(r&c&&!(o&&(s===4||s===5))){var u=i[s],h=u.normal,f=u.distance;if(_.AK(h,t.getPositiveFarPoint(i[s]))+f<0)return uo.OUTSIDE;_.AK(h,t.getNegativeFarPoint(i[s]))+f<0&&(a|=c)}}return a},n}(),LF=function(){function n(){this.toSync=new Set,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return n.prototype.apply=function(e){var t=this,r,i=e.renderingService,a=e.renderingContext,o=e.rBushRoot,s=a.root.ownerDocument.defaultView;this.rBush=o;var l=function(d){var p=d.target;p.renderable.dirty=!0,i.dirtify()},c=function(d){var p=d.detail.affectChildren,v=d.target;p&&v.forEach(function(m){t.toSync.add(m)});for(var g=v;g;)g.renderable&&t.toSync.add(g),g=g.parentElement;i.dirtify()},u=function(d){var p=d.target;st.enableSizeAttenuation&&st.styleValueRegistry.updateSizeAttenuation(p,s.getCamera().getZoom()),st.enableCSSParsing&&st.styleValueRegistry.recalc(p),st.sceneGraphService.dirtifyToRoot(p),i.dirtify()},h=function(d){var p=d.target,v=p.rBushNode;v.aabb&&t.rBush.remove(v.aabb),t.toSync.delete(p),st.sceneGraphService.dirtifyToRoot(p),i.dirtify()};i.hooks.init.tap(n.tag,function(){s.addEventListener(Ve.MOUNTED,u),s.addEventListener(Ve.UNMOUNTED,h),s.addEventListener(Ve.ATTR_MODIFIED,l),s.addEventListener(Ve.BOUNDS_CHANGED,c)}),i.hooks.destroy.tap(n.tag,function(){s.removeEventListener(Ve.MOUNTED,u),s.removeEventListener(Ve.UNMOUNTED,h),s.removeEventListener(Ve.ATTR_MODIFIED,l),s.removeEventListener(Ve.BOUNDS_CHANGED,c),t.toSync.clear()});var f=(r=st.globalThis.requestIdleCallback)!==null&&r!==void 0?r:M0.bind(st.globalThis);i.hooks.endFrame.tap(n.tag,function(){t.isFirstTimeRendering?(t.isFirstTimeRendering=!1,t.syncing=!0,f(function(){t.syncRTree(!0),t.isFirstTimeRenderingFinished=!0})):t.syncRTree()})},n.prototype.syncRTree=function(e){var t=this;if(e===void 0&&(e=!1),!(!e&&(this.syncing||this.toSync.size===0))){this.syncing=!0;var r=[];Array.from(this.toSync).filter(function(i){return i.isConnected}).forEach(function(i){var a=i.rBushNode;a&&a.aabb&&t.rBush.remove(a.aabb);var o=i.getRenderBounds();if(o){var s=i.renderable;e&&(s.dirtyRenderBounds||(s.dirtyRenderBounds=new or),s.dirtyRenderBounds.update(o.center,o.halfExtents));var l=Ht(o.getMin(),2),c=l[0],u=l[1],h=Ht(o.getMax(),2),f=h[0],d=h[1];a.aabb||(a.aabb={}),a.aabb.displayObject=i,a.aabb.minX=c,a.aabb.minY=u,a.aabb.maxX=f,a.aabb.maxY=d}a.aabb&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.minX)&&!isNaN(a.aabb.minY)&&r.push(a.aabb)}),this.rBush.load(r),r.length=0,this.toSync.clear(),this.syncing=!1}},n.tag="Prepare",n}();function sU(n){return!!n.document}var fi;(function(n){n.READY="ready",n.BEFORE_RENDER="beforerender",n.RERENDER="rerender",n.AFTER_RENDER="afterrender",n.BEFORE_DESTROY="beforedestroy",n.AFTER_DESTROY="afterdestroy",n.RESIZE="resize",n.DIRTY_RECTANGLE="dirtyrectangle",n.RENDERER_CHANGED="rendererchanged"})(fi||(fi={}));var v2=500,IF=.1,DF=1e3,L0=new Er(Ve.MOUNTED),I0=new Er(Ve.UNMOUNTED),g2=new Er(fi.BEFORE_RENDER),BF=new Er(fi.RERENDER),m2=new Er(fi.AFTER_RENDER),lU=function(n){Me(e,n);function e(t){var r=n.call(this)||this;r.Element=Fi,r.inited=!1,r.context={},r.document=new OF,r.document.defaultView=r,r.customElements=new CF;var i=t.container,a=t.canvas,o=t.offscreenCanvas,s=t.width,l=t.height,c=t.devicePixelRatio,u=t.renderer,h=t.background,f=t.cursor,d=t.document,p=t.requestAnimationFrame,v=t.cancelAnimationFrame,g=t.createImage,m=t.supportsPointerEvents,x=t.supportsTouchEvents,S=t.supportsCSSTransform,T=t.supportsMutipleCanvasesInOneContainer,b=t.useNativeClickEvent,y=t.alwaysTriggerPointerEventOnCanvas,E=t.isTouchEvent,w=t.isMouseEvent,C=t.dblClickSpeed;T||u4(i,r);var M=s,O=l,A=c;return a&&(A=c||T0&&window.devicePixelRatio||1,A=A>=1?Math.ceil(A):1,M=s||p4(a)||a.width/A,O=l||v4(a)||a.height/A),o&&(st.offscreenCanvas=o),r.devicePixelRatio=A,r.requestAnimationFrame=p!=null?p:M0.bind(st.globalThis),r.cancelAnimationFrame=v!=null?v:n2.bind(st.globalThis),r.supportsTouchEvents=x!=null?x:"ontouchstart"in st.globalThis,r.supportsPointerEvents=m!=null?m:!!st.globalThis.PointerEvent,r.isTouchEvent=E!=null?E:function(R){return r.supportsTouchEvents&&R instanceof st.globalThis.TouchEvent},r.isMouseEvent=w!=null?w:function(R){return!st.globalThis.MouseEvent||R instanceof st.globalThis.MouseEvent&&(!r.supportsPointerEvents||!(R instanceof st.globalThis.PointerEvent))},r.dblClickSpeed=C!=null?C:200,r.initRenderingContext({container:i,canvas:a,width:M,height:O,renderer:u,offscreenCanvas:o,devicePixelRatio:A,cursor:f||"default",background:h||"transparent",createImage:g,document:d,supportsCSSTransform:S,useNativeClickEvent:b,alwaysTriggerPointerEventOnCanvas:y}),r.initDefaultCamera(M,O,u.clipSpaceNearZ),r.initRenderer(u,!0),r}return e.prototype.initRenderingContext=function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}},e.prototype.initDefaultCamera=function(t,r,i){var a=this,o=new st.CameraContribution;o.clipSpaceNearZ=i,o.setType(sn.EXPLORING,dc.DEFAULT).setPosition(t/2,r/2,v2).setFocalPoint(t/2,r/2,0).setOrthographic(t/-2,t/2,r/2,r/-2,IF,DF),o.canvas=this,o.eventEmitter.on(bE.UPDATED,function(){a.context.renderingContext.renderReasons.add(es.CAMERA_CHANGED),st.enableSizeAttenuation&&a.getConfig().renderer.getConfig().enableSizeAttenuation&&a.updateSizeAttenuation()}),this.context.camera=o},e.prototype.updateSizeAttenuation=function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach(function(r){st.styleValueRegistry.updateSizeAttenuation(r,t)})},e.prototype.getConfig=function(){return this.context.config},e.prototype.getRoot=function(){return this.document.documentElement},e.prototype.getCamera=function(){return this.context.camera},e.prototype.getContextService=function(){return this.context.contextService},e.prototype.getEventService=function(){return this.context.eventService},e.prototype.getRenderingService=function(){return this.context.renderingService},e.prototype.getRenderingContext=function(){return this.context.renderingContext},e.prototype.getStats=function(){return this.getRenderingService().getStats()},Object.defineProperty(e.prototype,"ready",{get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise(function(r){t.resolveReadyPromise=function(){r(t)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t,r){if(t===void 0&&(t=!0),r===void 0&&(r=!1),r||this.dispatchEvent(new Er(fi.BEFORE_DESTROY)),this.frameId){var i=this.getConfig().cancelAnimationFrame||cancelAnimationFrame;i(this.frameId)}var a=this.getRoot();this.unmountChildren(a),t&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),t&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),r||this.dispatchEvent(new Er(fi.AFTER_DESTROY))},e.prototype.changeSize=function(t,r){this.resize(t,r)},e.prototype.resize=function(t,r){var i=this.context.config;i.width=t,i.height=r,this.getContextService().resize(t,r);var a=this.context.camera,o=a.getProjectionMode();a.setPosition(t/2,r/2,v2).setFocalPoint(t/2,r/2,0),o===Vr.ORTHOGRAPHIC?a.setOrthographic(t/-2,t/2,r/2,r/-2,a.getNear(),a.getFar()):a.setAspect(t/r),this.dispatchEvent(new Er(fi.RESIZE,{width:t,height:r}))},e.prototype.appendChild=function(t,r){return this.document.documentElement.appendChild(t,r)},e.prototype.insertBefore=function(t,r){return this.document.documentElement.insertBefore(t,r)},e.prototype.removeChild=function(t){return this.document.documentElement.removeChild(t)},e.prototype.removeChildren=function(){this.document.documentElement.removeChildren()},e.prototype.destroyChildren=function(){this.document.documentElement.destroyChildren()},e.prototype.render=function(t){var r=this;t&&(g2.detail=t,m2.detail=t),this.dispatchEvent(g2);var i=this.getRenderingService();i.render(this.getConfig(),t,function(){r.dispatchEvent(BF)}),this.dispatchEvent(m2)},e.prototype.run=function(){var t=this,r=function(i,a){t.render(a),t.frameId=t.requestAnimationFrame(r)};r()},e.prototype.initRenderer=function(t,r){var i=this;if(r===void 0&&(r=!1),!t)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new C6,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new NF,new LF,new AF([new kF])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService(se(se({},st),this.context)),this.context.renderingService=new K4(st,this.context),this.context.eventService=new j4(st,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,r,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(t,r)})},e.prototype.initRenderingService=function(t,r,i){var a=this;r===void 0&&(r=!1),i===void 0&&(i=!1),this.context.renderingService.init(function(){a.inited=!0,r?i?a.requestAnimationFrame(function(){a.dispatchEvent(new Er(fi.READY))}):a.dispatchEvent(new Er(fi.READY)):a.dispatchEvent(new Er(fi.RENDERER_CHANGED)),a.readyPromise&&a.resolveReadyPromise(),r||a.getRoot().forEach(function(o){var s=o.renderable;s&&(s.renderBoundsDirty=!0,s.boundsDirty=!0,s.dirty=!0)}),a.mountChildren(a.getRoot()),t.getConfig().enableAutoRendering&&a.run()})},e.prototype.loadRendererContainerModule=function(t){var r=this,i=t.getPlugins();i.forEach(function(a){a.context=r.context,a.init(st)})},e.prototype.setRenderer=function(t){var r=this.getConfig();if(r.renderer!==t){var i=r.renderer;r.renderer=t,this.destroy(!1,!0),nn([],Ht(i==null?void 0:i.getPlugins()),!1).reverse().forEach(function(a){a.destroy(st)}),this.initRenderer(t)}},e.prototype.setCursor=function(t){var r=this.getConfig();r.cursor=t,this.getContextService().applyCursorStyle(t)},e.prototype.unmountChildren=function(t){var r=this;t.childNodes.forEach(function(i){r.unmountChildren(i)}),this.inited&&(t.isMutationObserved?t.dispatchEvent(I0):(I0.target=t,this.dispatchEvent(I0,!0)),t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1),t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()},e.prototype.mountChildren=function(t){var r=this;this.inited?t.isConnected||(t.ownerDocument=this.document,t.isConnected=!0,t.isMutationObserved?t.dispatchEvent(L0):(L0.target=t,this.dispatchEvent(L0,!0))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName),t.childNodes.forEach(function(i){r.mountChildren(i)}),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()},e.prototype.client2Viewport=function(t){return this.getEventService().client2Viewport(t)},e.prototype.viewport2Client=function(t){return this.getEventService().viewport2Client(t)},e.prototype.viewport2Canvas=function(t){return this.getEventService().viewport2Canvas(t)},e.prototype.canvas2Viewport=function(t){return this.getEventService().canvas2Viewport(t)},e.prototype.getPointByClient=function(t,r){return this.client2Viewport({x:t,y:r})},e.prototype.getClientByPoint=function(t,r){return this.viewport2Client({x:t,y:r})},e}(a2),FF="g-canvas-camera",GF=function(){function n(){this.displayObjectHTMLElementMap=new WeakMap}return n.prototype.joinTransformMatrix=function(e){return"matrix(".concat([e[0],e[1],e[4],e[5],e[12],e[13]].join(","),")")},n.prototype.apply=function(e,t){var r=this,i=e.camera,a=e.renderingContext,o=e.renderingService;this.context=e;var s=a.root.ownerDocument.defaultView,l=s.context.eventService.nativeHTMLMap,c=function(v,g){g.style.transform=r.joinTransformMatrix(v.getWorldTransform())},u=function(v){var g=v.target;if(g.nodeName===At.HTML){r.$camera||(r.$camera=r.createCamera(i));var m=r.getOrCreateEl(g);if(r.$camera.appendChild(m),t.enableCSSParsing){var x=g.ownerDocument.documentElement.attributes;Object.keys(x).forEach(function(S){m.style[S]=x[S]})}Object.keys(g.attributes).forEach(function(S){r.updateAttribute(S,g)}),c(g,m),l.set(m,g)}},h=function(v){var g=v.target;if(g.nodeName===At.HTML&&r.$camera){var m=r.getOrCreateEl(g);m&&(m.remove(),l.delete(m))}},f=function(v){var g=v.target;if(g.nodeName===At.HTML){var m=v.attrName;r.updateAttribute(m,g)}},d=function(v){var g=v.target;if(g.nodeName===At.HTML){var m=r.getOrCreateEl(g);c(g,m)}},p=function(){if(r.$camera){var v=r.context.config,g=v.width,m=v.height;r.$camera.style.width="".concat(g||0,"px"),r.$camera.style.height="".concat(m||0,"px")}};o.hooks.init.tap(n.tag,function(){s.addEventListener(fi.RESIZE,p),s.addEventListener(Ve.MOUNTED,u),s.addEventListener(Ve.UNMOUNTED,h),s.addEventListener(Ve.ATTR_MODIFIED,f),s.addEventListener(Ve.BOUNDS_CHANGED,d)}),o.hooks.endFrame.tap(n.tag,function(){r.$camera&&a.renderReasons.has(es.CAMERA_CHANGED)&&(r.$camera.style.transform=r.joinTransformMatrix(i.getOrthoMatrix()))}),o.hooks.destroy.tap(n.tag,function(){r.$camera&&r.$camera.remove(),s.removeEventListener(fi.RESIZE,p),s.removeEventListener(Ve.MOUNTED,u),s.removeEventListener(Ve.UNMOUNTED,h),s.removeEventListener(Ve.ATTR_MODIFIED,f),s.removeEventListener(Ve.BOUNDS_CHANGED,d)})},n.prototype.createCamera=function(e){var t=this.context.config,r=t.document,i=t.width,a=t.height,o=this.context.contextService.getDomElement(),s=o.parentNode;if(s){var l=FF,c=s.querySelector("#"+l);if(!c){var u=(r||document).createElement("div");u.style.overflow="hidden",u.style.pointerEvents="none",u.style.position="absolute",u.style.left="0px",u.style.top="0px",u.style.width="".concat(i||0,"px"),u.style.height="".concat(a||0,"px");var h=(r||document).createElement("div");c=h,h.id=l,h.style.position="absolute",h.style.left="".concat(o.offsetLeft||0,"px"),h.style.top="".concat(o.offsetTop||0,"px"),h.style.transformOrigin="left top",h.style.transform=this.joinTransformMatrix(e.getOrthoMatrix()),h.style.pointerEvents="none",h.style.width="100%",h.style.height="100%",u.appendChild(h),s.appendChild(u)}return c}return null},n.prototype.getOrCreateEl=function(e){var t=this.context.config.document,r=this.displayObjectHTMLElementMap.get(e);return r||(r=(t||document).createElement("div"),e.parsedStyle.$el=r,this.displayObjectHTMLElementMap.set(e,r),e.id&&(r.id=e.id),e.name&&r.setAttribute("name",e.name),e.className&&(r.className=e.className),r.style.position="absolute",r.style["will-change"]="transform",r.style.transform=this.joinTransformMatrix(e.getWorldTransform())),r},n.prototype.updateAttribute=function(e,t){var r=this.getOrCreateEl(t);switch(e){case"innerHTML":var i=t.parsedStyle.innerHTML;qt(i)?r.innerHTML=i:(r.innerHTML="",r.appendChild(i));break;case"x":r.style.left="".concat(t.parsedStyle.x,"px");break;case"y":r.style.top="".concat(t.parsedStyle.y,"px");break;case"transformOrigin":var a=t.parsedStyle.transformOrigin;r.style["transform-origin"]="".concat(a[0].value," ").concat(a[1].value);break;case"width":if(this.context.enableCSSParsing){var o=t.computedStyleMap().get("width");r.style.width=o.toString()}else{var o=t.parsedStyle.width;r.style.width=te(o)?"".concat(o,"px"):o.toString()}break;case"height":if(this.context.enableCSSParsing){var s=t.computedStyleMap().get("height");r.style.height=s.toString()}else{var s=t.parsedStyle.height;r.style.height=te(s)?"".concat(s,"px"):s.toString()}break;case"zIndex":var l=t.parsedStyle.zIndex;r.style["z-index"]="".concat(l);break;case"visibility":var c=t.parsedStyle.visibility;r.style.visibility=c;break;case"pointerEvents":var u=t.parsedStyle.pointerEvents,h=u===void 0?"auto":u;r.style.pointerEvents=h;break;case"opacity":var f=t.parsedStyle.opacity;r.style.opacity="".concat(f);break;case"fill":var d=t.parsedStyle.fill,p="";hf(d)?d.isNone?p="transparent":p=t.getAttribute("fill"):Array.isArray(d)?p=t.getAttribute("fill"):d0(d),r.style.background=p;break;case"stroke":var v=t.parsedStyle.stroke,g="";hf(v)?v.isNone?g="transparent":g=t.getAttribute("stroke"):Array.isArray(v)?g=t.getAttribute("stroke"):d0(v),r.style["border-color"]=g,r.style["border-style"]="solid";break;case"lineWidth":var m=t.parsedStyle.lineWidth;r.style["border-width"]="".concat(m||0,"px");break;case"lineDash":r.style["border-style"]="dashed";break;case"filter":var x=t.style.filter;r.style.filter=x;break;default:!pt(t.style[e])&&t.style[e]!==""&&(r.style[e]=t.style[e])}},n.tag="HTMLRendering",n}(),zF=function(n){Me(e,n);function e(){var t=n.apply(this,nn([],Ht(arguments),!1))||this;return t.name="html-renderer",t}return e.prototype.init=function(){this.addRenderingPlugin(new GF)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(O6),WF=function(){function n(e){this.canvasConfig=e,this.imageCache={},this.gradientCache={},this.patternCache={}}return n.prototype.getImageSync=function(e,t){return this.imageCache[e]?t&&t(this.imageCache[e]):this.getOrCreateImage(e).then(function(r){t&&t(r)}),this.imageCache[e]},n.prototype.getOrCreateImage=function(e){var t=this;if(this.imageCache[e])return Promise.resolve(this.imageCache[e]);var r=this.canvasConfig.createImage;return new Promise(function(i,a){var o;r?o=r(e):Tl&&(o=new window.Image),o&&(o.onload=function(){t.imageCache[e]=o,i(o)},o.onerror=function(s){a(s)},o.crossOrigin="Anonymous",o.src=e)})},n.prototype.getOrCreatePatternSync=function(e,t,r,i,a,o){var s=this.generatePatternKey(e);if(s&&this.patternCache[s])return this.patternCache[s];var l=e.image,c=e.repetition,u=e.transform,h,f=!1;qt(l)?h=this.getImageSync(l,o):r?(h=r,f=!0):h=l;var d=h&&t.createPattern(h,c);if(d){var p=void 0;u?p=wy(Fd(u),new ei({})):p=Xt(Q()),f&&vi(p,p,[1/i,1/i,1]),d.setTransform({a:p[0],b:p[1],c:p[4],d:p[5],e:p[12]+a[0],f:p[13]+a[1]})}return s&&d&&(this.patternCache[s]=d),d},n.prototype.getOrCreateGradient=function(e,t){var r=this.generateGradientKey(e),i=e.type,a=e.steps,o=e.min,s=e.width,l=e.height,c=e.angle,u=e.cx,h=e.cy,f=e.size;if(this.gradientCache[r])return this.gradientCache[r];var d=null;if(i===Qi.LinearGradient){var p=kT(o,s,l,c),v=p.x1,g=p.y1,m=p.x2,x=p.y2;d=t.createLinearGradient(v,g,m,x)}else if(i===Qi.RadialGradient){var S=LT(o,s,l,u,h,f),T=S.x,b=S.y,y=S.r;d=t.createRadialGradient(T,b,0,T,b,y)}return d&&(a.forEach(function(E){var w=E.offset,C=E.color;w.unit===xt.kPercentage&&(d==null||d.addColorStop(w.value/100,C.toString()))}),this.gradientCache[r]=d),this.gradientCache[r]},n.prototype.generateGradientKey=function(e){var t=e.type,r=e.min,i=e.width,a=e.height,o=e.steps,s=e.angle,l=e.cx,c=e.cy,u=e.size;return"gradient-".concat(t,"-").concat((s==null?void 0:s.toString())||0,"-").concat((l==null?void 0:l.toString())||0,"-").concat((c==null?void 0:c.toString())||0,"-").concat((u==null?void 0:u.toString())||0,"-").concat(r[0],"-").concat(r[1],"-").concat(i,"-").concat(a,"-").concat(o.map(function(h){var f=h.offset,d=h.color;return"".concat(f).concat(d)}).join("-"))},n.prototype.generatePatternKey=function(e){var t=e.image,r=e.repetition;if(qt(t))return"pattern-".concat(t,"-").concat(r);if(t.nodeName==="rect")return"pattern-".concat(t.entity,"-").concat(r)},n}(),UF=function(){function n(){}return n.prototype.apply=function(e){var t=e.renderingService,r=e.renderingContext,i=e.imagePool,a=r.root.ownerDocument.defaultView,o=function(c,u,h){var f=c.parsedStyle,d=f.width,p=f.height;d&&!p?c.setAttribute("height",h/u*d):!d&&p&&c.setAttribute("width",u/h*p)},s=function(c){var u=c.target,h=u.nodeName,f=u.attributes;if(h===ct.IMAGE){var d=f.src,p=f.keepAspectRatio;qt(d)&&i.getImageSync(d,function(v){var g=v.width,m=v.height;p&&o(u,g,m),u.renderable.dirty=!0,t.dirtify()})}},l=function(c){var u=c.target,h=c.attrName,f=c.newValue;u.nodeName===ct.IMAGE&&h==="src"&&qt(f)&&i.getOrCreateImage(f).then(function(d){var p=d.width,v=d.height;u.attributes.keepAspectRatio&&o(u,p,v),u.renderable.dirty=!0,t.dirtify()})};t.hooks.init.tap(n.tag,function(){a.addEventListener(oe.MOUNTED,s),a.addEventListener(oe.ATTR_MODIFIED,l)}),t.hooks.destroy.tap(n.tag,function(){a.removeEventListener(oe.MOUNTED,s),a.removeEventListener(oe.ATTR_MODIFIED,l)})},n.tag="LoadImage",n}(),VF=function(n){B(e,n);function e(){var t=n.apply(this,K([],P(arguments),!1))||this;return t.name="image-loader",t}return e.prototype.init=function(){this.context.imagePool=new WF(this.context.config),this.addRenderingPlugin(new UF)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(No),HF=function(){function n(e){this.renderingContext=e.renderingContext,this.canvasConfig=e.config}return n.prototype.init=function(){var e=this.canvasConfig,t=e.container,r=e.canvas;if(r)this.$canvas=r,t&&r.parentElement!==t&&t.appendChild(r),this.$container=r.parentElement,this.canvasConfig.container=this.$container;else if(t&&(this.$container=qt(t)?document.getElementById(t):t,this.$container)){var i=document.createElement("canvas");this.$container.appendChild(i),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=i}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)},n.prototype.getContext=function(){return this.context},n.prototype.getDomElement=function(){return this.$canvas},n.prototype.getDPR=function(){return this.dpr},n.prototype.getBoundingClientRect=function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()},n.prototype.destroy=function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)},n.prototype.resize=function(e,t){var r=this.canvasConfig.devicePixelRatio,i=r||Tl&&window.devicePixelRatio||1;i=i>=1?Math.ceil(i):1,this.dpr=i,this.$canvas&&(this.$canvas.width=this.dpr*e,this.$canvas.height=this.dpr*t,UP(this.$canvas,e,t)),this.renderingContext.renderReasons.add(Io.CAMERA_CHANGED)},n.prototype.applyCursorStyle=function(e){this.$container&&this.$container.style&&(this.$container.style.cursor=e)},n.prototype.toDataURL=function(e){return e===void 0&&(e={}),j(this,void 0,void 0,function(){var t,r;return mt(this,function(i){return t=e.type,r=e.encoderOptions,[2,this.context.canvas.toDataURL(t,r)]})})},n}(),YF=function(n){B(e,n);function e(){var t=n.apply(this,K([],P(arguments),!1))||this;return t.name="canvas-context-register",t}return e.prototype.init=function(){this.context.ContextService=HF},e.prototype.destroy=function(){delete this.context.ContextService},e}(No),mf=function(n){B(e,n);function e(t){var r=n.call(this,t)||this;return r.registerPlugin(new YF),r.registerPlugin(new VF),r.registerPlugin(new DD),r.registerPlugin(new a6),r.registerPlugin(new s6),r.registerPlugin(new e6),r.registerPlugin(new zF),r}return e}(rT),y2=function(n,e,t){var r,i,a,o,s=0;t||(t={});var l=function(){s=t.leading===!1?0:Date.now(),r=null,o=n.apply(i,a),r||(i=a=null)},c=function(){var u=Date.now();!s&&t.leading===!1&&(s=u);var h=e-(u-s);return i=this,a=arguments,h<=0||h>e?(r&&(clearTimeout(r),r=null),s=u,o=n.apply(i,a),r||(i=a=null)):!r&&t.trailing!==!1&&(r=setTimeout(l,h)),o};return c.cancel=function(){clearTimeout(r),s=0,r=i=a=null},c};const tm=class extends mr{constructor(t,r){super(t,Object.assign({},tm.defaultOptions,r));k(this,"canvas");k(this,"onDraw",t=>{var r;(r=t==null?void 0:t.data)!=null&&r.render||this.onRender()});k(this,"onRender",y2(()=>{this.renderMinimap(),this.renderMask()},32,{leading:!0}));k(this,"shapes",new Map);k(this,"container");k(this,"landmarkMap",new Map);k(this,"mask",null);k(this,"isMaskDragging",!1);k(this,"onMaskDragStart",t=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(t.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))});k(this,"onMaskDrag",t=>{if(!this.mask||!this.isMaskDragging)return;const{size:[r,i]}=this.options,{movementX:a,movementY:o}=t,{left:s,top:l,width:c,height:u}=this.mask.style,[,,h,f]=this.maskBBox;let d=parseInt(s)+a,p=parseInt(l)+o,v=parseInt(c),g=parseInt(u);d<0&&(d=0),p<0&&(p=0),d+v>r&&(d=vo(r-v,0)),p+g>i&&(p=vo(i-g,0)),v<h&&(a>0?(d=vo(d-a,0),v=po(v+a,r)):a<0&&(v=po(v-a,r))),g<f&&(o>0?(p=vo(p-o,0),g=po(g+o,i)):o<0&&(g=po(g-o,i))),Object.assign(this.mask.style,{left:d+"px",top:p+"px",width:v+"px",height:g+"px"});const m=parseInt(s)-d,x=parseInt(l)-p;if(m===0&&x===0)return;const S=this.context.canvas.getCamera().getZoom(),T=this.canvas.getCamera().getZoom(),b=S/T;this.context.graph.translateBy([m*b,x*b],!1)});k(this,"onMaskDragEnd",t=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(t.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))});k(this,"onTransform",y2(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}));this.bindEvents()}bindEvents(){const{graph:t}=this.context;t.on(Mt.AFTER_DRAW,this.onDraw),t.on(Mt.AFTER_RENDER,this.onRender),t.on(Mt.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:t}=this.context;t.off(Mt.AFTER_DRAW,this.onDraw),t.off(Mt.AFTER_RENDER,this.onRender),t.off(Mt.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){const t=this.getElements(),r=this.initCanvas();this.setShapes(r,t)}getElements(){const{filter:t}=this.options,{model:r}=this.context,i=r.getData();if(!t)return i;const{nodes:a,edges:o,combos:s}=i;return{nodes:a.filter(l=>t(it(l),"node")),edges:o.filter(l=>t(it(l),"edge")),combos:s.filter(l=>t(it(l),"combo"))}}setShapes(t,r){const{nodes:i,edges:a,combos:o}=r,{shape:s}=this.options,{element:l}=this.context;if(s==="key"){const u=new Set,h=f=>{const d=it(f);u.add(d);const p=l.getElement(d);if(!p)return;const v=p.getShape("key"),g=this.shapes.get(d)||v.cloneNode();g.setPosition(v.getPosition()),p.style.zIndex&&(g.style.zIndex=p.style.zIndex),g.id=p.id,this.shapes.has(d)?Object.entries(v.attributes).forEach(([m,x])=>{g.style[m]!==x&&(g.style[m]=x)}):(t.appendChild(g),this.shapes.set(d,g))};a.forEach(h),o.forEach(h),i.forEach(h),this.shapes.forEach((f,d)=>{u.has(d)||(t.removeChild(f),this.shapes.delete(d))});return}const c=(u,h)=>{const d=l.getElement(u).getPosition();return h.setPosition(d),h};t.removeChildren(),a.forEach(u=>t.appendChild(s(it(u),"edge"))),o.forEach(u=>{t.appendChild(c(it(u),s(it(u),"combo")))}),i.forEach(u=>{t.appendChild(c(it(u),s(it(u),"node")))})}calculatePosition(){const{position:t,size:[r,i]}=this.options,{canvas:a}=this.context,[o,s]=a.getSize(),[l,c]=d1(t);return[l*(o-r),c*(s-i)]}createContainer(){const{container:t,className:r,size:[i,a],containerStyle:o}=this.options;if(t)return typeof t=="string"?document.querySelector(t):t;const s=document.createElement("div");s.classList.add("g6-minimap"),r&&s.classList.add(r);const[l,c]=this.calculatePosition();return Object.assign(s.style,at({position:"absolute",left:l+"px",top:c+"px",width:i+"px",height:a+"px"},o)),this.context.canvas.getContainer().appendChild(s)}initCanvas(){const{renderer:t,size:[r,i]}=this.options;if(this.canvas)this.canvas.resize(r,i),t&&this.canvas.setRenderer(t);else{const a=document.createElement("div"),o=this.createContainer();this.container=o,o.appendChild(a),this.canvas=new iu({width:r,height:i,container:a,renderer:t||new mf})}return this.setCamera(),this.canvas}createLandmark(t,r,i){const a=`${t.join(",")}-${r.join(",")}-${i}`;if(this.landmarkMap.has(a))return this.landmarkMap.get(a);const s=this.canvas.getCamera().createLandmark(a,{position:t,focalPoint:r,zoom:i});return this.landmarkMap.set(a,s),s}setCamera(){var y;const{canvas:t}=this.context,r=(y=this.canvas)==null?void 0:y.getCamera();if(!r)return;const{size:[i,a],padding:o}=this.options,[s,l,c,u]=Os(o),{min:h,max:f,center:d}=t.getBounds("elements"),p=f[0]-h[0],v=f[1]-h[1],g=i-u-l,m=a-s-c,x=g/p,S=m/v,T=Math.min(x,S),b=this.createLandmark(d,d,T);r.gotoLandmark(b,0)}get maskBBox(){const{canvas:t}=this.context,r=t.getSize(),i=t.getCanvasByViewport([0,0]),a=t.getCanvasByViewport(r),o=this.canvas.canvas2Viewport(Fo(i)),s=this.canvas.canvas2Viewport(Fo(a)),l=s.x-o.x,c=s.y-o.y;return[o.x,o.y,l,c]}calculateMaskBBox(){const{size:[t,r]}=this.options;let[i,a,o,s]=this.maskBBox;return i<0&&(o=po(o+i,t),i=0),a<0&&(s=po(s+a,r),a=0),i+o>t&&(o=vo(t-i,0)),a+s>r&&(s=vo(r-a,0)),[po(i,t),po(a,r),vo(o,0),vo(s,0)]}renderMask(){const{maskStyle:t}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart)),this.container.appendChild(this.mask),Object.assign(this.mask.style,_e(at({},t),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;const[t,r,i,a]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:r+"px",left:t+"px",width:i+"px",height:a+"px"})}destroy(){var t;this.unbindEvents(),this.canvas.destroy(),(t=this.mask)==null||t.remove(),super.destroy()}};let yf=tm;k(yf,"defaultOptions",{size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"}});const po=(n,e)=>Math.min(n,e),vo=(n,e)=>Math.max(n,e),D0={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"},em=class extends mr{constructor(t,r){super(t,Object.assign({},em.defaultOptions,r));k(this,"horizontalLine");k(this,"verticalLine");k(this,"initSnapline",()=>{const t=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=t.appendChild(new nu({style:at(at({},D0),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=t.appendChild(new nu({style:at(at({},D0),this.options.verticalLineStyle)})))});k(this,"isHorizontalSticking",!1);k(this,"isVerticalSticking",!1);k(this,"enableStick",!0);k(this,"autoSnapToLine",(t,r,i)=>Ct(this,null,function*(){const{verticalX:a,horizontalY:o}=i,{tolerance:s}=this.options,{min:[l,c],max:[u,h],center:[f,d]}=r;let p=0,v=0;a!==null&&(lr(u,a)<s&&(p=a-u),lr(l,a)<s&&(p=a-l),lr(f,a)<s&&(p=a-f),p!==0&&(this.isVerticalSticking=!0)),o!==null&&(lr(h,o)<s&&(v=o-h),lr(c,o)<s&&(v=o-c),lr(d,o)<s&&(v=o-d),v!==0&&(this.isHorizontalSticking=!0)),(p!==0||v!==0)&&(yield this.context.graph.translateElementBy({[t]:[p,v]},!1))}));k(this,"enableSnap",t=>{const{target:r}=t,i=.5;if(this.isHorizontalSticking||this.isVerticalSticking){const[a,o]=this.getDelta(t);if(this.isHorizontalSticking&&this.isVerticalSticking&&Math.abs(a)<=i&&Math.abs(o)<=i)return this.context.graph.translateElementBy({[r.id]:[-a,-o]},!1),!1;if(this.isHorizontalSticking&&Math.abs(o)<=i)return this.context.graph.translateElementBy({[r.id]:[0,-o]},!1),!1;if(this.isVerticalSticking&&Math.abs(a)<=i)return this.context.graph.translateElementBy({[r.id]:[-a,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick});k(this,"calcSnaplineMetadata",(t,r)=>{const{tolerance:i,shape:a}=this.options,{min:[o,s],max:[l,c],center:[u,h]}=r;let f=null,d=null,p=null,v=null,g=null,m=null;return this.getNodes().some(x=>{if(un(t.id,x.id))return!1;const S=x2(x,a).getRenderBounds(),{min:[T,b],max:[y,E],center:[w,C]}=S;return f===null&&(lr(w,u)<i?f=w:lr(T,o)<i||lr(T,l)<i?f=T:(lr(y,l)<i||lr(y,o)<i)&&(f=y),f!==null&&(d=Math.min(b,s),p=Math.max(E,c))),v===null&&(lr(C,h)<i?v=C:lr(b,s)<i||lr(b,c)<i?v=b:(lr(E,c)<i||lr(E,s)<i)&&(v=E),v!==null&&(g=Math.min(T,o),m=Math.max(y,l))),f!==null&&v!==null}),{verticalX:f,verticalMinY:d,verticalMaxY:p,horizontalY:v,horizontalMinX:g,horizontalMaxX:m}});k(this,"onDragStart",()=>{this.initSnapline()});k(this,"onDrag",t=>Ct(this,null,function*(){const{target:r}=t;if(this.options.autoSnap&&!this.enableSnap(t))return;const i=x2(r,this.options.shape).getRenderBounds(),a=this.calcSnaplineMetadata(r,i);this.hideSnapline(),(a.verticalX!==null||a.horizontalY!==null)&&this.updateSnapline(a),this.options.autoSnap&&(yield this.autoSnapToLine(r.id,i,a))}));k(this,"onDragEnd",()=>{this.hideSnapline()});this.bindEvents()}getNodes(){var a;const{filter:t}=this.options,i=(((a=this.context.element)==null?void 0:a.getNodes())||[]).filter(o=>{var s;return uN(o)&&((s=this.context.viewport)==null?void 0:s.isInViewport(o.getRenderBounds()))});return t?i.filter(o=>t(o)):i}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(t){const{lineWidth:r}=this.options[`${t}LineStyle`];return+(r||D0.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(t){const{verticalX:r,verticalMinY:i,verticalMaxY:a,horizontalY:o,horizontalMinX:s,horizontalMaxX:l}=t,[c,u]=this.context.canvas.getSize(),{offset:h}=this.options;o!==null?Object.assign(this.horizontalLine.style,{x1:h===1/0?0:s-h,y1:o,x2:h===1/0?c:l+h,y2:o,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",r!==null?Object.assign(this.verticalLine.style,{x1:r,y1:h===1/0?0:i-h,x2:r,y2:h===1/0?u:a+h,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(t){const r=this.context.graph.getZoom();return As([t.dx,t.dy],r)}bindEvents(){return Ct(this,null,function*(){const{graph:t}=this.context;t.on(Ti.DRAG_START,this.onDragStart),t.on(Ti.DRAG,this.onDrag),t.on(Ti.DRAG_END,this.onDragEnd)})}unbindEvents(){const{graph:t}=this.context;t.off(Ti.DRAG_START,this.onDragStart),t.off(Ti.DRAG,this.onDrag),t.off(Ti.DRAG_END,this.onDragEnd)}destroyElements(){var t,r;(t=this.horizontalLine)==null||t.destroy(),(r=this.verticalLine)==null||r.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}};let xf=em;k(xf,"defaultOptions",{tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0});const lr=(n,e)=>Math.abs(n-e),x2=(n,e)=>typeof e=="function"?e(n):n.getShape(e);var b2=null,XF=null;function bf(n){return n instanceof Date?n:new Date(n)}function jF(n){for(var e=__read(n,2),t=e[0],r=e[1],i=b2.indexOf(t),a=b2.indexOf(r),o="",s=i;s<=a;s+=1)if(o+=XF[s],s<a){var l="-";s===2?l=" ":s>2&&(l=":"),o+=l}return o}function wr(n,e){var t={YYYY:n.getFullYear(),MM:n.getMonth()+1,DD:n.getDate(),HH:n.getHours(),mm:n.getMinutes(),ss:n.getSeconds()},r=e;return Object.keys(t).forEach(function(i){var a=t[i];r=r.replace(i,i==="YYYY"?"".concat(a):"".concat(a).padStart(2,"0"))}),r}function cU(n,e){return bf(n).getTime()-bf(e).getTime()}function uU(n,e){var t=__read([bf(n),bf(e)],2),r=t[0],i=t[1];return r.getFullYear()!==i.getFullYear()?"year":r.getMonth()!==i.getMonth()?"month":r.getDay()!==i.getDay()?"day":r.getHours()!==i.getHours()?"hour":r.getMinutes()!==i.getMinutes()?"minute":"second"}function hU(n,e){var t=new Date(n),r={year:function(i){i.setMonth(0),i.setHours(0,0,0,0)},month:function(i){i.setDate(1),i.setHours(0,0,0,0)},day:function(i){return i.setHours(0,0,0,0)},hour:function(i){return i.setMinutes(0,0,0)},minute:function(i){return i.setSeconds(0,0)},second:function(i){return i.setMilliseconds(0)}};return r[e](t),wr(t,jF(["year",e]))}function $F(n,e){if(n.length<=e)return n;for(var t=Math.floor(n.length/e),r=[],i=0;i<n.length;i+=t)r.push(n[i]);return r}var B0={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new kh({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]},fU=Pi({},B0,{style:{type:"arc"}}),dU=Pi({},B0,{style:{}}),Be=ji({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis");function ka(n,e){return[n[0]*e,n[1]*e]}function yc(n,e){return[n[0]+e[0],n[1]+e[1]]}function F0(n,e){return[n[0]-e[0],n[1]-e[1]]}function is(n,e){return[Math.min(n[0],e[0]),Math.min(n[1],e[1])]}function as(n,e){return[Math.max(n[0],e[0]),Math.max(n[1],e[1])]}function xc(n,e){return Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2))}function E2(n){if(n[0]===0&&n[1]===0)return[0,0];var e=Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2));return[n[0]/e,n[1]/e]}function pU(n,e,t){var r=__read(n,2),i=r[0],a=r[1],o=__read(e,2),s=o[0],l=o[1],c=i-s,u=a-l,h=Math.sin(t),f=Math.cos(t);return[c*f-u*h+s,c*h+u*f+l]}function KF(n,e){return e?[n[1],-n[0]]:[-n[1],n[0]]}function hl(n){return n*Math.PI/180}function w2(n){return Number((n*180/Math.PI).toPrecision(5))}function Ef(n,e){return n.style.opacity||(n.style.opacity=1),$i(n,{opacity:0},e)}var ZF=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function qF(n){return ZF.includes(n)}function S2(n){var e={};for(var t in n)qF(t)&&(e[t]=n[t]);return e}var fl=ji({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function _2(n){return n.reduce(function(e,t,r){return e.push(K([r===0?"M":"L"],P(t),!1)),e},[])}function JF(n,e,t){var r=e.connect,i=r===void 0?"line":r,a=e.center;if(i==="line")return _2(n);if(!a)return[];var o=xc(n[0],a),s=t?0:1;return n.reduce(function(l,c,u){return u===0?l.push(K(["M"],P(c),!1)):l.push(K(["A",o,o,0,0,s],P(c),!1)),l},[])}function G0(n,e,t){return e.type==="surround"?JF(n,e,t):_2(n)}function QF(n,e,t){var r=t.type,i=t.connect,a=t.center,o=t.closed,s=o?[["Z"]]:[],l=P([G0(n,t),G0(e.slice().reverse(),t,!0)],2),c=l[0],u=l[1],h=P([n[0],e.slice(-1)[0]],2),f=h[0],d=h[1],p=function(x,S){return[c,x,u,S,s].flat()};if(i==="line"||r==="surround")return p([K(["L"],P(d),!1)],[K(["L"],P(f),!1)]);if(!a)throw new Error("Arc grid need to specified center");var v=P([xc(d,a),xc(f,a)],2),g=v[0],m=v[1];return p([K(["A",g,g,0,0,1],P(d),!1),K(["L"],P(d),!1)],[K(["A",m,m,0,0,0],P(f),!1),K(["L"],P(f),!1)])}function t5(n,e,t,r){var i=t.animate,a=t.isBillboard,o=e.map(function(s,l){return{id:s.id||"grid-line-".concat(l),d:G0(s.points,t)}});return n.selectAll(fl.line.class).data(o,function(s){return s.id}).join(function(s){return s.append("path").each(function(l,c){var u=Li(S2(N({d:l.d},r)),[l,c,o]);this.attr(N({class:fl.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:a},u))})},function(s){return s.transition(function(l,c){var u=Li(S2(N({d:l.d},r)),[l,c,o]);return $i(this,u,i.update)})},function(s){return s.transition(function(){var l=this,c=Ef(this,i.exit);return tl(c,function(){return l.remove()}),c})}).transitions()}function e5(n,e,t){var r=t.animate,i=t.connect,a=t.areaFill;if(e.length<2||!a||!i)return[];for(var o=Array.isArray(a)?a:[a,"transparent"],s=function(p){return o[p%o.length]},l=[],c=0;c<e.length-1;c++){var u=P([e[c].points,e[c+1].points],2),h=u[0],f=u[1],d=QF(h,f,t);l.push({d,fill:s(c)})}return n.selectAll(fl.region.class).data(l,function(p,v){return v}).join(function(p){return p.append("path").each(function(v,g){var m=Li(v,[v,g,l]);this.attr(m)}).attr("className",fl.region.name)},function(p){return p.transition(function(v,g){var m=Li(v,[v,g,l]);return $i(this,m,r.update)})},function(p){return p.transition(function(){var v=this,g=Ef(this,r.exit);return tl(g,function(){return v.remove()}),g})}).transitions()}function n5(n){var e=n.data,t=e===void 0?[]:e,r=n.closed;return r?t.map(function(i){var a=i.points,o=P(a,1),s=o[0];return N(N({},i),{points:K(K([],P(a),!1),[s],!1)})}):t}var r5=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r){var i=t.type,a=t.center,o=t.areaFill,s=t.closed,l=V(t,["type","center","areaFill","closed"]),c=n5(t),u=Lt(r).maybeAppendByClassName(fl.lineGroup,"g"),h=Lt(r).maybeAppendByClassName(fl.regionGroup,"g"),f=t5(u,c,t,l),d=e5(h,c,t);return K(K([],P(f),!1),P(d),!1)},e}(bn),i5=function(n,e){return function(t){return n*(1-t)+e*t}};function a5(n,e){var t=e?e.length:0,r=n?Math.min(t,n.length):0;return function(i){var a=new Array(r),o=new Array(t),s=0;for(s=0;s<r;++s)a[s]=z0(n[s],e[s]);for(;s<t;++s)o[s]=e[s];for(s=0;s<r;++s)o[s]=a[s](i);return o}}function o5(n,e){n===void 0&&(n={}),e===void 0&&(e={});var t={},r={};return Object.entries(e).forEach(function(i){var a=P(i,2),o=a[0],s=a[1];o in n?t[o]=z0(n[o],s):r[o]=s}),function(i){return Object.entries(t).forEach(function(a){var o=P(a,2),s=o[0],l=o[1];return r[s]=l(i)}),r}}function z0(n,e){return typeof n=="number"&&typeof e=="number"?i5(n,e):Array.isArray(n)&&Array.isArray(e)?a5(n,e):typeof n=="object"&&typeof e=="object"?o5(n,e):function(t){return n}}function s5(n,e,t,r){if(!r)return n.attr("__keyframe_data__",t),null;var i=r.duration,a=i===void 0?0:i,o=z0(e,t),s=Math.ceil(+a/16),l=new Array(s).fill(0).map(function(c,u,h){return{__keyframe_data__:o(u/(h.length-1))}});return n.animate(l,N({fill:"both"},r))}function T2(n,e){var t={},r=Array.isArray(e)?e:[e];for(var i in n)r.includes(i)||(t[i]=n[i]);return t}function P2(n,e){return Object.fromEntries(Object.entries(n).map(function(t){var r=P(t,2),i=r[0],a=r[1];return[i,Li(a,e)]}))}function vU(n){if(n.type==="linear"){var e=n.startPos,t=n.endPos;return __spreadArray(__spreadArray([],__read(e),!1),__read(t),!1)}var r=n.startAngle,i=n.endAngle,a=n.center,o=n.radius;return __spreadArray(__spreadArray([r,i],__read(a),!1),[o],!1)}function W0(n,e){return e&&jt(e)?n.filter(e):n}function M2(n,e){var t=e.startAngle,r=e.endAngle;return(r-t)*n+t}function wf(n,e){if(e.type==="linear"){var t=P(e.startPos,2),r=t[0],i=t[1],a=P(e.endPos,2),o=a[0],s=a[1],l=P([o-r,s-i],2),c=l[0],u=l[1];return E2([c,u])}var h=hl(M2(n,e));return[-Math.sin(h),Math.cos(h)]}function U0(n,e,t){var r=wf(n,t);return KF(r,e!=="positive")}function bc(n,e){return U0(n,e.labelDirection,e)}function l5(n,e){var t=P(e.startPos,2),r=t[0],i=t[1],a=P(e.endPos,2),o=a[0],s=a[1],l=P([o-r,s-i],2),c=l[0],u=l[1];return[r+c*n,i+u*n]}function c5(n,e){var t=e.radius,r=P(e.center,2),i=r[0],a=r[1],o=hl(M2(n,e));return[i+t*Math.cos(o),a+t*Math.sin(o)]}function Sf(n,e){return e.type==="linear"?l5(n,e):c5(n,e)}function C2(n){return wf(0,n)[1]===0}function O2(n){return wf(0,n)[0]===0}function A2(n,e){return e-n===360}function N2(n,e,t,r,i){var a=e-n,o=P([i,i],2),s=o[0],l=o[1],c=P([hl(n),hl(e)],2),u=c[0],h=c[1],f=function(M){return[t+i*Math.cos(M),r+i*Math.sin(M)]},d=P(f(u),2),p=d[0],v=d[1],g=P(f(h),2),m=g[0],x=g[1];if(A2(n,e)){var S=(h+u)/2,T=P(f(S),2),b=T[0],y=T[1];return[["M",p,v],["A",s,l,0,1,0,b,y],["A",s,l,0,1,0,m,x]]}var E=a>180?1:0,w=n>e?0:1,C=!1;return C?"M".concat(t,",").concat(r,",L").concat(p,",").concat(v,",A").concat(s,",").concat(l,",0,").concat(E,",").concat(w,",").concat(m,",").concat(x,",L").concat(t,",").concat(r):"M".concat(p,",").concat(v,",A").concat(s,",").concat(l,",0,").concat(E,",").concat(w,",").concat(m,",").concat(x)}function u5(n){var e=n.attributes,t=e.startAngle,r=e.endAngle,i=e.center,a=e.radius;return K(K([t,r],P(i),!1),[a],!1)}function h5(n,e,t,r){var i=e.startAngle,a=e.endAngle,o=e.center,s=e.radius;return n.selectAll(Be.line.class).data([{d:N2.apply(void 0,K(K([i,a],P(o),!1),[s],!1))}],function(l,c){return c}).join(function(l){return l.append("path").attr("className",Be.line.name).styles(e).styles({d:function(c){return c.d}})},function(l){return l.transition(function(){var c=this,u=s5(this,u5(this),K(K([i,a],P(o),!1),[s],!1),r.update);if(u){var h=function(){var f=gr(c.attributes,"__keyframe_data__");c.style.d=N2.apply(void 0,K([],P(f),!1))};u.onframe=h,u.onfinish=h}return u}).styles(e)},function(l){return l.remove()}).styles(t).transitions()}function f5(n,e){var t=e.truncRange,r=e.truncShape,i=e.lineExtension}function d5(n,e,t){t===void 0&&(t=[0,0]);var r=P([n,e,t],3),i=P(r[0],2),a=i[0],o=i[1],s=P(r[1],2),l=s[0],c=s[1],u=P(r[2],2),h=u[0],f=u[1],d=P([l-a,c-o],2),p=d[0],v=d[1],g=Math.sqrt(Math.pow(p,2)+Math.pow(v,2)),m=P([-h/g,f/g],2),x=m[0],S=m[1];return[x*p,x*v,S*p,S*v]}function R2(n){var e=P(n,2),t=P(e[0],2),r=t[0],i=t[1],a=P(e[1],2),o=a[0],s=a[1];return{x1:r,y1:i,x2:o,y2:s}}function p5(n,e,t,r){var i=e.showTrunc,a=e.startPos,o=e.endPos,s=e.truncRange,l=e.lineExtension,c=P([a,o],2),u=P(c[0],2),h=u[0],f=u[1],d=P(c[1],2),p=d[0],v=d[1],g=P(l?d5(a,o,l):new Array(4).fill(0),4),m=g[0],x=g[1],S=g[2],T=g[3],b=function(q){return n.selectAll(Be.line.class).data(q,function(J,wt){return wt}).join(function(J){return J.append("line").attr("className",function(wt){return"".concat(Be.line.name," ").concat(wt.className)}).styles(t).transition(function(wt){return $i(this,R2(wt.line),!1)})},function(J){return J.styles(t).transition(function(wt){var Ft=wt.line;return $i(this,R2(Ft),r.update)})},function(J){return J.remove()}).transitions()};if(!i||!s)return b([{line:[[h+m,f+x],[p+S,v+T]],className:Be.line.name}]);var y=P(s,2),E=y[0],w=y[1],C=p-h,M=v-f,O=P([h+C*E,f+M*E],2),A=O[0],R=O[1],L=P([h+C*w,f+M*w],2),z=L[0],Y=L[1],I=b([{line:[[h+m,f+x],[A,R]],className:Be.lineFirst.name},{line:[[z,Y],[p+S,v+T]],className:Be.lineSecond.name}]);return f5(n,e),I}function v5(n,e,t,r){var i=t.showArrow,a=t.showTrunc,o=t.lineArrow,s=t.lineArrowOffset,l=t.lineArrowSize,c;if(e==="arc"?c=n.select(Be.line.class):a?c=n.select(Be.lineSecond.class):c=n.select(Be.line.class),!i||!o||t.type==="arc"&&A2(t.startAngle,t.endAngle)){var u=c.node();u&&(u.style.markerEnd=void 0);return}var h=Na(o);h.attr(r),Xv(h,l,!0),c.style("markerEnd",h).style("markerEndOffset",-s)}function g5(n,e,t){var r=e.type,i,a=ee(e,"line");return r==="linear"?i=p5(n,e,T2(a,"arrow"),t):i=h5(n,e,T2(a,"arrow"),t),v5(n,r,e,a),i}function m5(n,e){return U0(n,e.gridDirection,e)}function k2(n){var e=n.type,t=n.gridCenter;return e==="linear"?t:t||n.center}function y5(n,e){var t=e.gridLength;return n.map(function(r,i){var a=r.value,o=P(Sf(a,e),2),s=o[0],l=o[1],c=P(ka(m5(a,e),t),2),u=c[0],h=c[1];return{id:i,points:[[s,l],[s+u,l+h]]}})}function x5(n,e){var t=e.gridControlAngles,r=k2(e);if(!r)throw new Error("grid center is not provide");if(n.length<2)throw new Error("Invalid grid data");if(!t||t.length===0)throw new Error("Invalid gridControlAngles");var i=P(r,2),a=i[0],o=i[1];return n.map(function(s,l){var c=s.value,u=P(Sf(c,e),2),h=u[0],f=u[1],d=P([h-a,f-o],2),p=d[0],v=d[1],g=[];return t.forEach(function(m){var x=hl(m),S=P([Math.cos(x),Math.sin(x)],2),T=S[0],b=S[1],y=p*T-v*b+a,E=p*b+v*T+o;g.push([y,E])}),{points:g,id:l}})}function b5(n,e,t,r){var i=ee(t,"grid"),a=i.type,o=i.areaFill,s=k2(t),l=W0(e,t.gridFilter),c=a==="segment"?y5(l,t):x5(l,t),u=N(N({},i),{center:s,areaFill:jt(o)?l.map(function(h,f){return Li(o,[h,f,l])}):o,animate:r,data:c});return n.selectAll(Be.grid.class).data([1]).join(function(h){return h.append(function(){return new r5({style:u})}).attr("className",Be.grid.name)},function(h){return h.transition(function(){return this.update(u)})},function(h){return h.remove()}).transitions()}function Zn(n,e,t,r,i){return r===void 0&&(r=!0),i===void 0&&(i=!1),r&&n===e||i&&n===t?!0:n>e&&n<t}function E5(n,e,t,r){t===void 0&&(t=2),r===void 0&&(r="top"),oE(n,{wordWrap:!0,wordWrapWidth:e,maxLines:t,textBaseline:r})}function w5(n,e,t){var r=n.getBBox(),i=r.width,a=r.height,o=P([e,t].map(function(c,u){var h;return c.includes("%")?parseFloat(((h=c.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||h===void 0?void 0:h[0])||"0")/100*(u===0?i:a):c}),2),s=o[0],l=o[1];return[s,l]}function L2(n,e){if(e)try{var t=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,r=e.replace(t,function(i,a,o){return"translate(".concat(w5(n,a,o),")")});n.attr("transform",r)}catch(i){}}var I2=function(n){return n!==void 0&&n!=null&&!Number.isNaN(n)},V0=function(){function n(e,t,r,i){this.set(e,t,r,i)}return Object.defineProperty(n.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),n.prototype.rotatedPoints=function(e,t,r){var i=this,a=i.x1,o=i.y1,s=i.x2,l=i.y2,c=Math.cos(e),u=Math.sin(e),h=t-t*c+r*u,f=r-t*u-r*c,d=[[c*a-u*l+h,u*a+c*l+f],[c*s-u*l+h,u*s+c*l+f],[c*a-u*o+h,u*a+c*o+f],[c*s-u*o+h,u*s+c*o+f]];return d},n.prototype.set=function(e,t,r,i){return r<e?(this.x2=e,this.x1=r):(this.x1=e,this.x2=r),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},n.prototype.defined=function(e){return this[e]!==Number.MAX_VALUE&&this[e]!==-Number.MAX_VALUE},n}();function _f(n,e){var t=n.getEulerAngles()||0;n.setEulerAngles(0);var r=n.getBounds(),i=P(r.min,2),a=i[0],o=i[1],s=P(r.max,2),l=s[0],c=s[1],u=n.getBBox(),h=u.width,f=u.height,d=f,p=0,v=0,g=a,m=o,x=aE(n);if(x){d-=1.5;var S=x.style.textAlign,T=x.style.textBaseline;S==="center"?g=(a+l)/2:(S==="right"||S==="end")&&(g=l),T==="middle"?m=(o+c)/2:T==="bottom"&&(m=c)}var b=P(Mn(e),4),y=b[0],E=y===void 0?0:y,w=b[1],C=w===void 0?0:w,M=b[2],O=M===void 0?E:M,A=b[3],R=A===void 0?C:A,L=new V0((p+=a)-R,(v+=o)-E,p+h+C,v+d+O);return n.setEulerAngles(t),L.rotatedPoints(hl(t),g,m)}function Ec(n,e){return e[0]<=Math.max(n[0][0],n[1][0])&&e[0]<=Math.min(n[0][0],n[1][0])&&e[1]<=Math.max(n[0][1],n[1][1])&&e[1]<=Math.min(n[0][1],n[1][1])}function wc(n,e,t){var r=(e[1]-n[1])*(t[0]-e[0])-(e[0]-n[0])*(t[1]-e[1]);return r===0?0:r<0?2:1}function S5(n,e){var t=wc(n[0],n[1],e[0]),r=wc(n[0],n[1],e[1]),i=wc(e[0],e[1],n[0]),a=wc(e[0],e[1],n[1]);return!!(t!==r&&i!==a||t===0&&Ec(n,e[0])||r===0&&Ec(n,e[1])||i===0&&Ec(e,n[0])||a===0&&Ec(e,n[1]))}function _5(n,e){var t=n.length;if(t<3)return!1;var r=[e,[9999,e[1]]],i=0,a=0;do{var o=[n[a],n[(a+1)%t]];if(S5(o,r)){if(wc(o[0],e,o[1])===0)return Ec(o,e);i++}a=(a+1)%t}while(a!==0);return!!(i&1)}function T5(n,e){return e.every(function(t){return _5(n,t)})}function P5(n,e,t){var r=n.x1,i=n.x2,a=n.y1,o=n.y2,s=[[r,a],[i,a],[i,o],[r,o]],l=_f(e,t);return T5(s,l)}function D2(n,e){var t=P(n,4),r=t[0],i=t[1],a=t[2],o=t[3],s=P(e,4),l=s[0],c=s[1],u=s[2],h=s[3],f=a-r,d=o-i,p=u-l,v=h-c,g=f*v-p*d;if(g===0)return!1;var m=g>0,x=r-l,S=i-c,T=f*S-d*x;if(T<0===m)return!1;var b=p*S-v*x;return!(b<0===m||T>g===m||b>g===m)}function B2(n,e){var t=[[n[0],n[1],n[2],n[3]],[n[2],n[3],n[4],n[5]],[n[4],n[5],n[6],n[7]],[n[6],n[7],n[0],n[1]]];return t.some(function(r){return D2(e,r)})}var gU={lineToLine:D2,intersectBoxLine:B2,getBounds:_f};function M5(n,e,t){var r,i,a=_f(n,t).flat(1),o=_f(e,t).flat(1),s=[[a[0],a[1],a[2],a[3]],[a[0],a[1],a[4],a[5]],[a[4],a[5],a[6],a[7]],[a[2],a[3],a[6],a[7]]];try{for(var l=vt(s),c=l.next();!c.done;c=l.next()){var u=c.value;if(B2(o,u))return!0}}catch(h){r={error:h}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return!1}function C5(n,e){var t=n.type,r=n.labelDirection,i=n.crossSize;if(!i)return!1;if(t==="arc"){var a=n.center,o=n.radius,s=P(a,2),l=s[0],c=s[1],u=r==="negative"?0:i,h=-o-u,f=o+u,d=P(Mn(e),4),p=d[0],v=d[1],g=d[2],m=d[3];return new V0(l+h-m,c+h-p,l+f+v,c+f+g)}var x=P(n.startPos,2),S=x[0],T=x[1],b=P(n.endPos,2),y=b[0],E=b[1],w=P(O2(n)?[-e,0,e,0]:[0,e,0,-e],4),C=w[0],M=w[1],O=w[2],A=w[3],R=bc(0,n),L=ka(R,i),z=new V0(S,T,y,E);return z.x1+=A,z.y1+=C,z.x2+=M+L[0],z.y2+=O+L[1],z}function Tf(n,e,t){var r,i,a=e.crossPadding,o=new Set,s=null,l=C5(e,a),c=function(p){return l?P5(l,p):!0},u=function(p,v){return!p||!p.firstChild?!0:!M5(p.firstChild,v.firstChild,Mn(t))};try{for(var h=vt(n),f=h.next();!f.done;f=h.next()){var d=f.value;c(d)?!s||u(s,d)?s=d:(o.add(s),o.add(d)):o.add(d)}}catch(p){r={error:p}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}return Array.from(o)}function H0(n,e){return e===void 0&&(e={}),pt(n)?0:typeof n=="number"?n:Math.floor(SD(n,e))}function O5(n,e,t,r){if(!(n.length<=1)){var i=e.suffix,a=i===void 0?"...":i,o=e.minLength,s=e.maxLength,l=s===void 0?1/0:s,c=e.step,u=c===void 0?" ":c,h=e.margin,f=h===void 0?[0,0,0,0]:h,d=iE(r.getTextShape(n[0])),p=H0(u,d),v=o?H0(o,d):p,g=H0(l,d);(pt(g)||g===1/0)&&(g=Math.max.apply(null,n.map(function(L){return L.getBBox().width})));for(var m=n.slice(),x=P(f,4),S=x[0],T=S===void 0?0:S,b=x[1],y=b===void 0?0:b,E=x[2],w=E===void 0?T:E,C=x[3],M=C===void 0?y:C,O=function(L){if(m.forEach(function(z){r.ellipsis(r.getTextShape(z),L,a)}),m=Tf(n,t,f),m.length<1)return{value:void 0}},A=g;A>v+p;A-=p){var R=O(A);if(typeof R=="object")return R.value}}}var A5={parity:function(n,e){var t=e.seq,r=t===void 0?2:t;return n.filter(function(i,a){return a%r?(Xi(i),!1):!0})}},N5=function(n){return n.filter(I2)};function R5(n,e,t,r){var i=n.length,a=e.keepHeader,o=e.keepTail;if(!(i<=1||i===2&&a&&o)){var s=A5.parity,l=function(S){return S.forEach(r.show),S},c=2,u=n.slice(),h=n.slice(),f=Math.min.apply(Math,K([1],P(n.map(function(S){return S.getBBox().width})),!1));if(t.type==="linear"&&(C2(t)||O2(t))){var d=rE(n[0]).left,p=rE(n[i-1]).right,v=Math.abs(p-d)||1;c=Math.max(Math.floor(i*f/v),c)}var g,m;for(a&&(g=u.splice(0,1)[0]),o&&(m=u.splice(-1,1)[0],u.reverse()),l(u);c<n.length&&Tf(N5(m?K(K([m],P(h),!1),[g],!1):K([g],P(h),!1)),t,e==null?void 0:e.margin).length;){if(m&&!g&&c%2===0){var x=u.splice(0,1);x.forEach(r.hide)}else if(m&&g){var x=u.splice(0,1);x.forEach(r.hide)}h=s(l(u),{seq:c}),c++}}}function k5(n,e,t,r){var i,a,o=e.optionalAngles,s=o===void 0?[0,45,90]:o,l=e.margin,c=e.recoverWhenFailed,u=c===void 0?!0:c,h=n.map(function(m){return m.getLocalEulerAngles()}),f=function(){return Tf(n,t,l).length<1},d=function(m){return n.forEach(function(x,S){var T=Array.isArray(m)?m[S]:m;r.rotate(x,+T)})};try{for(var p=vt(s),v=p.next();!v.done;v=p.next()){var g=v.value;if(d(g),f())return}}catch(m){i={error:m}}finally{try{v&&!v.done&&(a=p.return)&&a.call(p)}finally{if(i)throw i.error}}u&&d(h)}function L5(n){var e=n.type,t=n.labelDirection;return e==="linear"&&C2(n)?t==="negative"?"bottom":"top":"middle"}function I5(n,e,t,r){var i=e.wordWrapWidth,a=i===void 0?50:i,o=e.maxLines,s=o===void 0?3:o,l=e.recoverWhenFailed,c=l===void 0?!0:l,u=e.margin,h=u===void 0?[0,0,0,0]:u,f=n.map(function(x){return x.attr("maxLines")||1}),d=Math.min.apply(Math,K([],P(f),!1)),p=function(){return Tf(n,t,h).length<1},v=L5(t),g=function(x){return n.forEach(function(S,T){var b=Array.isArray(x)?x[T]:x;r.wrap(S,a,b,v)})};if(!(d>s)){for(var m=d;m<=s;m++)if(g(m),p())return;c&&g(f)}}var D5=new Map([["hide",R5],["rotate",k5],["ellipsis",O5],["wrap",I5]]);function B5(n,e,t){return e.labelOverlap.length<1?!1:t==="hide"?!AI(n[0]):t==="rotate"?!n.some(function(r){var i;return!!(!((i=r.attr("transform"))===null||i===void 0)&&i.includes("rotate"))}):t==="ellipsis"||t==="wrap"?n.filter(function(r){return r.querySelector("text")}).length>1:!0}function F5(n,e,t){var r=e.labelOverlap,i=r===void 0?[]:r;i.length&&i.forEach(function(a){var o=a.type,s=D5.get(o);B5(n,e,o)&&(s==null||s(n,a,e,t))})}function G5(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=function(r){return r==="positive"?-1:1};return n.reduce(function(r,i){return r*t(i)},1)}function F2(n){for(var e=n;e<0;)e+=360;return Math.round(e%360)}function Y0(n,e){var t=P(n,2),r=t[0],i=t[1],a=P(e,2),o=a[0],s=a[1],l=P([r*o+i*s,r*s-i*o],2),c=l[0],u=l[1];return Math.atan2(u,c)}function z5(n){var e=(n+360)%180;return Zn(e,-90,90)||(e+=180),e}function W5(n,e,t){var r,i=t.labelAlign,a=(r=e.style.transform)===null||r===void 0?void 0:r.includes("rotate");if(a)return e.getLocalEulerAngles();var o=0,s=bc(n.value,t),l=wf(n.value,t);return i==="horizontal"?0:(i==="perpendicular"?o=Y0([1,0],s):o=Y0([l[0]<0?-1:1,0],l),z5(w2(o)))}function G2(n,e,t){var r=t.type,i=t.labelAlign,a=bc(n,t),o=F2(e),s=F2(w2(Y0([1,0],a))),l="center",c="middle";return r==="linear"?[90,270].includes(s)&&o===0?(l="center",c=a[1]===1?"top":"bottom"):!(s%180)&&[90,270].includes(o)?l="center":s===0?(Zn(o,0,90,!1,!0)||Zn(o,0,90)||Zn(o,270,360))&&(l="start"):s===90?Zn(o,0,90,!1,!0)?l="start":(Zn(o,90,180)||Zn(o,270,360))&&(l="end"):s===270?Zn(o,0,90,!1,!0)?l="end":(Zn(o,90,180)||Zn(o,270,360))&&(l="start"):s===180&&(o===90?l="start":(Zn(o,0,90)||Zn(o,270,360))&&(l="end")):i==="parallel"?Zn(s,0,180,!0)?c="top":c="bottom":i==="horizontal"?Zn(s,90,270,!1)?l="end":(Zn(s,270,360,!1)||Zn(s,0,90))&&(l="start"):i==="perpendicular"&&(Zn(s,90,270)?l="end":l="start"),{textAlign:l,textBaseline:c}}function U5(n,e,t){e.setLocalEulerAngles(n);var r=e.__data__.value,i=G2(r,n,t),a=e.querySelector(Be.labelItem.class);a&&W2(a,i)}function z2(n,e,t){var r=t.showTick,i=t.tickLength,a=t.tickDirection,o=t.labelDirection,s=t.labelSpacing,l=e.indexOf(n),c=Li(s,[n,l,e]),u=P([bc(n.value,t),G5(o,a)],2),h=u[0],f=u[1],d=f===1?Li(r?i:0,[n,l,e]):0,p=P(yc(ka(h,c+d),Sf(n.value,t)),2),v=p[0],g=p[1];return{x:v,y:g}}function V5(n,e,t,r){var i=r.labelFormatter,a=jt(i)?function(){return Na(Li(i,[n,e,t,bc(n.value,r)]))}:function(){return Na(n.label||"")};return a}function W2(n,e){n.nodeName==="text"&&n.attr(e)}function U2(n){F5(this.node().childNodes,n,{hide:Xi,show:lc,rotate:function(e,t){U5(+t,e,n)},ellipsis:function(e,t,r){e&&Kv(e,t||1/0,r)},wrap:function(e,t,r){e&&E5(e,t,r)},getTextShape:function(e){return e.querySelector("text")}})}function V2(n,e,t,r,i){var a=t.indexOf(e),o=Lt(n).append(V5(e,a,t,i)).attr("className",Be.labelItem.name).node(),s=P(Aa(P2(r,[e,a,t])),2),l=s[0],c=s[1],u=c.transform,h=V(c,["transform"]);L2(o,u);var f=W5(e,o,i);return o.getLocalEulerAngles()||o.setLocalEulerAngles(f),W2(o,N(N({},G2(e.value,f,i)),l)),n.attr(h),o}function H5(n,e,t,r){var i=W0(e,t.labelFilter),a=ee(t,"label");return n.selectAll(Be.label.class).data(i,function(o,s){return s}).join(function(o){return o.append("g").attr("className",Be.label.name).transition(function(s){V2(this,s,e,a,t);var l=z2(s,e,t),c=l.x,u=l.y;return this.style.transform="translate(".concat(c,", ").concat(u,")"),null}).call(function(){U2.call(n,t)})},function(o){return o.transition(function(s){var l=this.querySelector(Be.labelItem.class),c=V2(this,s,e,a,t),u=jI(l,c,r.update),h=z2(s,e,t),f=h.x,d=h.y,p=$i(this,{transform:"translate(".concat(f,", ").concat(d,")")},r.update);return K(K([],P(u),!1),[p],!1)}).call(function(s){var l=gr(s,"_transitions").flat().filter(I2);YI(l,function(){U2.call(n,t)})})},function(o){return o.transition(function(){var s=this,l=Ef(this.childNodes[0],r.exit);return tl(l,function(){return Lt(s).remove()}),l})}).transitions()}function H2(n,e){return U0(n,e.tickDirection,e)}function Y5(n,e){var t=P(n,2),r=t[0],i=t[1];return[[0,0],[r*e,i*e]]}function X5(n,e,t,r,i){var a=i.tickLength,o=P(Y5(r,Li(a,[n,e,t])),2),s=P(o[0],2),l=s[0],c=s[1],u=P(o[1],2),h=u[0],f=u[1];return{x1:l,x2:h,y1:c,y2:f}}function j5(n,e,t,r,i){var a=i.tickFormatter,o=H2(e.value,i),s="line";return jt(a)&&(s=function(){return Li(a,[e,t,r,o])}),n.append(s).attr("className",Be.tickItem.name)}function $5(n,e,t,r,i,a,o){var s=H2(n.value,a),l=X5(n,e,t,s,a),c=l.x1,u=l.x2,h=l.y1,f=l.y2,d=P(Aa(P2(o,[n,e,t,s])),2),p=d[0],v=d[1];r.node().nodeName==="line"&&r.styles(N({x1:c,x2:u,y1:h,y2:f},p)),i.attr(v),r.styles(p)}function Y2(n,e,t,r,i,a){var o=j5(Lt(this),n,e,t,r);$5(n,e,t,o,this,r,i);var s=P(Sf(n.value,r),2),l=s[0],c=s[1];return $i(this,{transform:"translate(".concat(l,", ").concat(c,")")},a)}function K5(n,e,t,r){var i=W0(e,t.tickFilter),a=ee(t,"tick");return n.selectAll(Be.tick.class).data(i,function(o){return o.id||o.label}).join(function(o){return o.append("g").attr("className",Be.tick.name).transition(function(s,l){return Y2.call(this,s,l,i,t,a,!1)})},function(o){return o.transition(function(s,l){return this.removeChildren(),Y2.call(this,s,l,i,t,a,r.update)})},function(o){return o.transition(function(){var s=this,l=Ef(this.childNodes[0],r.exit);return tl(l,function(){return s.remove()}),l})}).transitions()}function Z5(n,e,t){var r=t.titlePosition,i=r===void 0?"lb":r,a=t.titleSpacing,o=Jh(i),s=n.node().getLocalBounds(),l=P(s.min,2),c=l[0],u=l[1],h=P(s.halfExtents,2),f=h[0],d=h[1],p=P(e.node().getLocalBounds().halfExtents,2),v=p[0],g=p[1],m=P([c+f,u+d],2),x=m[0],S=m[1],T=P(Mn(a),4),b=T[0],y=T[1],E=T[2],w=T[3];if(["start","end"].includes(i)&&t.type==="linear"){var C=t.startPos,M=t.endPos,O=P(i==="start"?[C,M]:[M,C],2),A=O[0],R=O[1],L=E2([-R[0]+A[0],-R[1]+A[1]]),z=P(ka(L,b),2),Y=z[0],I=z[1];return{x:A[0]+Y,y:A[1]+I}}return o.includes("t")&&(S-=d+g+b),o.includes("r")&&(x+=f+v+y),o.includes("l")&&(x-=f+v+w),o.includes("b")&&(S+=d+g+E),{x,y:S}}function q5(n,e,t){var r=n.getGeometryBounds().halfExtents,i=r[1]*2;if(e==="vertical"){if(t==="left")return"rotate(-90) translate(0, ".concat(i/2,")");if(t==="right")return"rotate(-90) translate(0, -".concat(i/2,")")}return""}function X2(n,e,t,r,i){var a=ee(r,"title"),o=P(Aa(a),2),s=o[0],l=o[1],c=l.transform,u=l.transformOrigin,h=V(l,["transform","transformOrigin"]);e.styles(h);var f=c||q5(n.node(),s.direction,s.position);n.styles(N(N({},s),{transformOrigin:u})),L2(n.node(),f);var d=Z5(Lt(t._offscreen||t.querySelector(Be.mainGroup.class)),e,r),p=d.x,v=d.y,g=$i(e.node(),{transform:"translate(".concat(p,", ").concat(v,")")},i);return g}function J5(n,e,t,r){var i=t.titleText;return n.selectAll(Be.title.class).data([{title:i}].filter(function(a){return!!a.title}),function(a,o){return a.title}).join(function(a){return a.append(function(){return Na(i)}).attr("className",Be.title.name).transition(function(){return X2(Lt(this),n,e,t,r.enter)})},function(a){return a.transition(function(){return X2(Lt(this),n,e,t,r.update)})},function(a){return a.remove()}).transitions()}function j2(n,e,t,r){var i=n.showLine,a=n.showTick,o=n.showLabel,s=e.maybeAppendByClassName(Be.lineGroup,"g"),l=li(i,s,function(d){return g5(d,n,r)})||[],c=e.maybeAppendByClassName(Be.tickGroup,"g"),u=li(a,c,function(d){return K5(d,t,n,r)})||[],h=e.maybeAppendByClassName(Be.labelGroup,"g"),f=li(o,h,function(d){return H5(d,t,n,r)})||[];return K(K(K([],P(l),!1),P(u),!1),P(f),!1).filter(function(d){return!!d})}var Q5=function(n){B(e,n);function e(t){return n.call(this,t,B0)||this}return e.prototype.render=function(t,r,i){var a=this,o=t.titleText,s=t.data,l=t.animate,c=t.showTitle,u=t.showGrid,h=t.dataThreshold,f=t.truncRange,d=$F(s,h).filter(function(b){var y=b.value;return!(f&&y>f[0]&&y<f[1])}),p=Kb(i===void 0?l:i),v=Lt(r).maybeAppendByClassName(Be.gridGroup,"g"),g=li(u,v,function(b){return b5(b,d,t,p)})||[],m=Lt(r).maybeAppendByClassName(Be.mainGroup,"g");o&&(!this.initialized&&p.enter||this.initialized&&p.update)&&j2(t,Lt(this.offscreenGroup),d,Kb(!1));var x=j2(t,Lt(m.node()),d,p),S=Lt(r).maybeAppendByClassName(Be.titleGroup,"g"),T=li(c,S,function(b){return J5(b,a,t,p)})||[];return K(K(K([],P(g),!1),P(x),!1),P(T),!1).flat().filter(function(b){return!!b})},e}(bn);function $2(n){var e=n.canvas,t=n.touches,r=n.offsetX,i=n.offsetY;if(e){var a=e.x,o=e.y;return[a,o]}if(t){var s=t[0],l=s.clientX,c=s.clientY;return[l,c]}return r&&i?[r,i]:[0,0]}function X0(n,e){return+n.toPrecision(e)}function mU(n){return n.toLocaleString()}function yU(n){return n.toExponential()}function xU(n,e){return e===void 0&&(e=0),Math.abs(n)<1e3?String(n):"".concat(X0(n/1e3,e).toLocaleString(),"K")}var bU=function(n,e,t){return n<0&&Number.isFinite(n)?e:t},EU=function(n,e,t){return n>0&&Number.isFinite(n)?e:t},wU=function(n,e){return n*e},SU=function(n,e){return n/2+(e||0)/2},j0=function(n){return n};class K2{constructor(e){this.options=Pi({},this.getDefaultOptions()),this.update(e)}getOptions(){return this.options}update(e={}){this.options=Pi({},this.options,e),this.rescale(e)}rescale(e){}}function $0(n,e){return e-n?t=>(t-n)/(e-n):t=>.5}function Pf(n,...e){return e.reduce((t,r)=>i=>t(r(i)),n)}function tG(n,e,t,r,i){let a=t||0,o=r||n.length;const s=i||(l=>l);for(;a<o;){const l=Math.floor((a+o)/2);s(n[l])>e?o=l:a=l+1}return a}var eG=D(19818),nG=D.n(eG);function K0(n,e,t){let r=t;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?n+(e-n)*6*r:r<1/2?e:r<2/3?n+(e-n)*(2/3-r)*6:n}function rG(n){const e=n[0]/360,t=n[1]/100,r=n[2]/100,i=n[3];if(t===0)return[r*255,r*255,r*255,i];const a=r<.5?r*(1+t):r+t-r*t,o=2*r-a,s=K0(o,a,e+1/3),l=K0(o,a,e),c=K0(o,a,e-1/3);return[s*255,l*255,c*255,i]}function Z2(n){const e=nG().get(n);if(!e)return null;const{model:t,value:r}=e;return t==="rgb"?r:t==="hsl"?rG(r):null}const Mf=(n,e)=>t=>n*(1-t)+e*t,iG=(n,e)=>{const t=Z2(n),r=Z2(e);return t===null||r===null?t?()=>n:()=>e:i=>{const a=new Array(4);for(let u=0;u<4;u+=1){const h=t[u],f=r[u];a[u]=h*(1-i)+f*i}const[o,s,l,c]=a;return`rgba(${Math.round(o)}, ${Math.round(s)}, ${Math.round(l)}, ${c})`}},aG=(n,e)=>typeof n=="number"&&typeof e=="number"?Mf(n,e):typeof n=="string"&&typeof e=="string"?iG(n,e):()=>n,oG=(n,e)=>{const t=Mf(n,e);return r=>Math.round(t(r))};var sG=function(n){return n===null},lG=sG;function q2(n){return!yt(n)&&!lG(n)&&!Number.isNaN(n)}const Z0=Math.sqrt(50),q0=Math.sqrt(10),J0=Math.sqrt(2);function Cf(n,e,t){const r=(e-n)/Math.max(0,t),i=Math.floor(Math.log(r)/Math.LN10),a=r/pi(10,i);return i>=0?(a>=Z0?10:a>=q0?5:a>=J0?2:1)*pi(10,i):-pi(10,-i)/(a>=Z0?10:a>=q0?5:a>=J0?2:1)}function _U(n,e,t){const r=Math.abs(e-n)/Math.max(0,t);let i=pi(10,Math.floor(Math.log(r)/Math.LN10));const a=r/i;return a>=Z0?i*=10:a>=q0?i*=5:a>=J0&&(i*=2),e<n?-i:i}const cG=(n,e,t=5)=>{const r=[n,e];let i=0,a=r.length-1,o=r[i],s=r[a],l;return s<o&&([o,s]=[s,o],[i,a]=[a,i]),l=Cf(o,s,t),l>0?(o=Math.floor(o/l)*l,s=Math.ceil(s/l)*l,l=Cf(o,s,t)):l<0&&(o=Math.ceil(o*l)/l,s=Math.floor(s*l)/l,l=Cf(o,s,t)),l>0?(r[i]=Math.floor(o/l)*l,r[a]=Math.ceil(s/l)*l):l<0&&(r[i]=Math.ceil(o*l)/l,r[a]=Math.floor(s*l)/l),r};function uG(n,e){const t=e<n?e:n,r=n>e?n:e;return i=>Math.min(Math.max(t,i),r)}const hG=(n,e,t)=>{const[r,i]=n,[a,o]=e;let s,l;return r<i?(s=$0(r,i),l=t(a,o)):(s=$0(i,r),l=t(o,a)),Pf(l,s)},fG=(n,e,t)=>{const r=Math.min(n.length,e.length)-1,i=new Array(r),a=new Array(r),o=n[0]>n[r],s=o?[...n].reverse():n,l=o?[...e].reverse():e;for(let c=0;c<r;c+=1)i[c]=$0(s[c],s[c+1]),a[c]=t(l[c],l[c+1]);return c=>{const u=tG(n,c,1,r)-1,h=i[u],f=a[u];return Pf(f,h)(c)}},J2=(n,e,t,r)=>(Math.min(n.length,e.length)>2?fG:hG)(n,e,r?oG:t);class dG extends K2{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:Mf,tickCount:5}}map(e){return q2(e)?this.output(e):this.options.unknown}invert(e){return q2(e)?this.input(e):this.options.unknown}nice(){if(!this.options.nice)return;const[e,t,r,...i]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(e,t,r,...i)}getTicks(){const{tickMethod:e}=this.options,[t,r,i,...a]=this.getTickMethodOptions();return e(t,r,i,...a)}getTickMethodOptions(){const{domain:e,tickCount:t}=this.options,r=e[0],i=e[e.length-1];return[r,i,t]}chooseNice(){return cG}rescale(){this.nice();const[e,t]=this.chooseTransforms();this.composeOutput(e,this.chooseClamp(e)),this.composeInput(e,t,this.chooseClamp(t))}chooseClamp(e){const{clamp:t,range:r}=this.options,i=this.options.domain.map(e),a=Math.min(i.length,r.length);return t?uG(i[0],i[a-1]):j0}composeOutput(e,t){const{domain:r,range:i,round:a,interpolate:o}=this.options,s=J2(r.map(e),i,o,a);this.output=Pf(s,t,e)}composeInput(e,t,r){const{domain:i,range:a}=this.options,o=J2(a,i.map(e),Mf);this.input=Pf(t,r,o)}}const pG=(n,e,t)=>{let r,i,a=n,o=e;if(a===o&&t>0)return[a];let s=Cf(a,o,t);if(s===0||!Number.isFinite(s))return[];if(s>0){a=Math.ceil(a/s),o=Math.floor(o/s),i=new Array(r=Math.ceil(o-a+1));for(let l=0;l<r;l+=1)i[l]=(a+l)*s}else{s=-s,a=Math.ceil(a*s),o=Math.floor(o*s),i=new Array(r=Math.ceil(o-a+1));for(let l=0;l<r;l+=1)i[l]=(a+l)/s}return i};class Sc extends dG{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:aG,tickMethod:pG,tickCount:5}}chooseTransforms(){return[j0,j0]}clone(){return new Sc(this.options)}}function Q2({map:n,initKey:e},t){const r=e(t);return n.has(r)?n.get(r):t}function vG({map:n,initKey:e},t){const r=e(t);return n.has(r)?n.get(r):(n.set(r,t),t)}function gG({map:n,initKey:e},t){const r=e(t);return n.has(r)&&(t=n.get(r),n.delete(r)),t}function mG(n){return typeof n=="object"?n.valueOf():n}class tw extends Map{constructor(e){if(super(),this.map=new Map,this.initKey=mG,e!==null)for(const[t,r]of e)this.set(t,r)}get(e){return super.get(Q2({map:this.map,initKey:this.initKey},e))}has(e){return super.has(Q2({map:this.map,initKey:this.initKey},e))}set(e,t){return super.set(vG({map:this.map,initKey:this.initKey},e),t)}delete(e){return super.delete(gG({map:this.map,initKey:this.initKey},e))}}const Q0=Symbol("defaultUnknown");function ew(n,e,t){for(let r=0;r<e.length;r+=1)n.has(e[r])||n.set(t(e[r]),r)}function nw(n){const{value:e,from:t,to:r,mapper:i,notFoundReturn:a}=n;let o=i.get(e);if(o===void 0){if(a!==Q0)return a;o=t.push(e)-1,i.set(e,o)}return r[o%r.length]}function rw(n){return n instanceof Date?e=>`${e}`:typeof n=="object"?e=>JSON.stringify(e):e=>e}class tg extends K2{getDefaultOptions(){return{domain:[],range:[],unknown:Q0}}constructor(e){super(e)}map(e){return this.domainIndexMap.size===0&&ew(this.domainIndexMap,this.getDomain(),this.domainKey),nw({value:this.domainKey(e),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(e){return this.rangeIndexMap.size===0&&ew(this.rangeIndexMap,this.getRange(),this.rangeKey),nw({value:this.rangeKey(e),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(e){const[t]=this.options.domain,[r]=this.options.range;if(this.domainKey=rw(t),this.rangeKey=rw(r),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!e||e.range)&&this.rangeIndexMap.clear(),(!e||e.domain||e.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new tg(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:e,compare:t}=this.options;return this.sortedDomain=t?[...e].sort(t):e,this.sortedDomain}}function yG(n){const e=Math.min(...n);return n.map(t=>t/e)}function xG(n,e){const t=n.length,r=e-t;return r>0?[...n,...new Array(r).fill(1)]:r<0?n.slice(0,e):n}function bG(n){return Math.round(n*1e12)/1e12}function EG(n){const{domain:e,range:t,paddingOuter:r,paddingInner:i,flex:a,round:o,align:s}=n,l=e.length,c=xG(a,l),[u,h]=t,f=h-u,d=2/l*r+1-1/l*i,p=f/d,v=p*i/l,g=p-l*v,m=yG(c),x=m.reduce((A,R)=>A+R),S=g/x,T=new tw(e.map((A,R)=>{const L=m[R]*S;return[A,o?Math.floor(L):L]})),b=new tw(e.map((A,R)=>{const z=m[R]*S+v;return[A,o?Math.floor(z):z]})),y=Array.from(b.values()).reduce((A,R)=>A+R),w=(f-(y-y/l*i))*s,C=u+w;let M=o?Math.round(C):C;const O=new Array(l);for(let A=0;A<l;A+=1){O[A]=bG(M);const R=e[A];M+=b.get(R)}return{valueBandWidth:T,valueStep:b,adjustedRange:O}}function wG(n){var e;const{domain:t}=n,r=t.length;if(r===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((e=n.flex)===null||e===void 0)&&e.length))return EG(n);const{range:a,paddingOuter:o,paddingInner:s,round:l,align:c}=n;let u,h,f=a[0];const p=a[1]-f,v=o*2,g=r-s;u=p/Math.max(1,v+g),l&&(u=Math.floor(u)),f+=(p-u*(r-s))*c,h=u*(1-s),l&&(f=Math.round(f),h=Math.round(h));const m=new Array(r).fill(0).map((x,S)=>f+S*u);return{valueStep:u,valueBandWidth:h,adjustedRange:m}}class eg extends tg{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:Q0,flex:[]}}constructor(e){super(e)}clone(){return new eg(this.options)}getStep(e){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:e===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(e)}getBandWidth(e){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:e===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(e)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:e,paddingInner:t}=this.options;return e>0?e:t}getPaddingOuter(){const{padding:e,paddingOuter:t}=this.options;return e>0?e:t}rescale(){super.rescale();const{align:e,domain:t,range:r,round:i,flex:a}=this.options,{adjustedRange:o,valueBandWidth:s,valueStep:l}=wG({align:e,range:r,round:i,flex:a,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:t});this.valueStep=l,this.valueBandWidth=s,this.adjustedRange=o}}var SG=function(n){B(e,n);function e(t){var r=this,i=t.style,a=V(t,["style"]);return r=n.call(this,Pi({},{type:"column"},N({style:i},a)))||this,r.columnsGroup=new jn({name:"columns"}),r.appendChild(r.columnsGroup),r.render(),r}return e.prototype.render=function(){var t=this.attributes,r=t.columns,i=t.x,a=t.y;this.columnsGroup.style.transform="translate(".concat(i,", ").concat(a,")"),Lt(this.columnsGroup).selectAll(".column").data(r.flat()).join(function(o){return o.append("rect").attr("className","column").each(function(s){this.attr(s)})},function(o){return o.each(function(s){this.attr(s)})},function(o){return o.remove()})},e.prototype.update=function(t){this.attr(Fn({},this.attributes,t)),this.render()},e.prototype.clear=function(){this.removeChildren()},e}(Wr),_G=function(n){B(e,n);function e(t){var r=this,i=t.style,a=V(t,["style"]);return r=n.call(this,Pi({},{type:"lines"},N({style:i},a)))||this,r.linesGroup=r.appendChild(new jn),r.areasGroup=r.appendChild(new jn),r.render(),r}return e.prototype.render=function(){var t=this.attributes,r=t.lines,i=t.areas,a=t.x,o=t.y;this.style.transform="translate(".concat(a,", ").concat(o,")"),r&&this.renderLines(r),i&&this.renderAreas(i)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(t){this.attr(Fn({},this.attributes,t)),this.render()},e.prototype.renderLines=function(t){Lt(this.linesGroup).selectAll(".line").data(t).join(function(r){return r.append("path").attr("className","line").each(function(i){this.attr(i)})},function(r){return r.each(function(i){this.attr(i)})},function(r){return r.remove()})},e.prototype.renderAreas=function(t){Lt(this.linesGroup).selectAll(".area").data(t).join(function(r){return r.append("path").attr("className","area").each(function(i){this.attr(i)})},function(r){return r.each(function(i){this.style(i)})},function(r){return r.remove()})},e}(Wr);function TG(n,e,t,r){var i,a=[],o=!!r,s,l,c=[1/0,1/0],u=[-1/0,-1/0],h,f,d;if(o){i=P(r,2),c=i[0],u=i[1];for(var p=0,v=n.length;p<v;p+=1){var g=n[p];c=is(c,g),u=as(u,g)}}for(var p=0,m=n.length;p<m;p+=1){var g=n[p];if(p===0&&!t)d=g;else if(p===m-1&&!t)f=g,a.push(d),a.push(f);else{var x=[p?p-1:m-1,p-1][t?0:1];s=n[x],l=n[t?(p+1)%m:p+1];var S=[0,0];S=F0(l,s),S=ka(S,e);var T=xc(g,s),b=xc(g,l),y=T+b;y!==0&&(T/=y,b/=y);var E=ka(S,-T),w=ka(S,b);f=yc(g,E),h=yc(g,w),h=is(h,as(l,g)),h=as(h,is(l,g)),E=F0(h,g),E=ka(E,-T/b),f=yc(g,E),f=is(f,as(s,g)),f=as(f,is(s,g)),w=F0(g,f),w=ka(w,b/T),h=yc(g,w),o&&(f=as(f,c),f=is(f,u),h=as(h,c),h=is(h,u)),a.push(d),a.push(f),d=h}}return t&&a.push(a.shift()),a}function PG(n,e,t){var r;e===void 0&&(e=!1),t===void 0&&(t=[[0,0],[1,1]]);for(var i=!!e,a=[],o=0,s=n.length;o<s;o+=2)a.push([n[o],n[o+1]]);for(var l=TG(a,.4,i,t),c=a.length,u=[],h,f,d,o=0;o<c-1;o+=1)h=l[o*2],f=l[o*2+1],d=a[o+1],u.push(["C",h[0],h[1],f[0],f[1],d[0],d[1]]);return i&&(h=l[c],f=l[c+1],r=P(a,1),d=r[0],u.push(["C",h[0],h[1],f[0],f[1],d[0],d[1]])),u}function MG(n,e){var t,r=e.x,i=e.y,a=P(i.getOptions().range||[0,0],2),o=a[0],s=a[1];return s>o&&(t=P([o,s],2),s=t[0],o=t[1]),n.map(function(l){var c=l.map(function(u,h){return[r.map(h),he(i.map(u),s,o)]});return c})}function _c(n,e){e===void 0&&(e=!1);var t=e?n.length-1:0,r=n.map(function(i,a){return K([a===t?"M":"L"],P(i),!1)});return e?r.reverse():r}function Of(n,e){if(e===void 0&&(e=!1),n.length<=2)return _c(n);for(var t=[],r=n.length,i=0;i<r;i+=1){var a=e?n[r-i-1]:n[i];un(a,t.slice(-2))||t.push.apply(t,K([],P(a),!1))}var o=PG(t,!1);return e?o.unshift(K(["M"],P(n[r-1]),!1)):o.unshift(K(["M"],P(n[0]),!1)),o}function ng(n,e,t){var r=_u(n);return r.push(["L",e,t],["L",0,t],["Z"]),r}function CG(n,e,t,r){return n.map(function(i){return ng(e?Of(i):_c(i),t,r)})}function OG(n,e,t){for(var r=[],i=n.length-1;i>=0;i-=1){var a=n[i],o=_c(a),s=void 0;if(i===0)s=ng(o,e,t);else{var l=n[i-1],c=_c(l,!0);c[0][0]="L",s=K(K(K([],P(o),!1),P(c),!1),[["Z"]],!1)}r.push(s)}return r}function AG(n,e,t){for(var r=[],i=n.length-1;i>=0;i-=1){var a=n[i],o=Of(a),s=void 0;if(i===0)s=ng(o,e,t);else{var l=n[i-1],c=Of(l,!0),u=a[0];c[0][0]="L",s=K(K(K([],P(o),!1),P(c),!1),[K(["M"],P(u),!1),["Z"]],!1)}r.push(s)}return r}var NG=function(n,e){if(tr(n)){for(var t,r=1/0,i=0;i<n.length;i++){var a=n[i],o=jt(e)?e(a):a[e];o<r&&(t=a,r=o)}return t}},RG=function(n,e){if(tr(n)){for(var t,r=-1/0,i=0;i<n.length;i++){var a=n[i],o=jt(e)?e(a):a[e];o>r&&(t=a,r=o)}return t}};function iw(n){return n.length===0?[0,0]:[Fa(NG(n,function(e){return Fa(e)||0})),Ga(RG(n,function(e){return Ga(e)||0}))]}function aw(n){for(var e=_u(n),t=e[0].length,r=P([Array(t).fill(0),Array(t).fill(0)],2),i=r[0],a=r[1],o=0;o<e.length;o+=1)for(var s=e[o],l=0;l<t;l+=1)s[l]>=0?(s[l]+=i[l],i[l]=s[l]):(s[l]+=a[l],a[l]=s[l]);return e}var kG=function(n){B(e,n);function e(t){return n.call(this,t,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(e.prototype,"rawData",{get:function(){var t=this.attributes.data;if(!t||(t==null?void 0:t.length)===0)return[[]];var r=_u(t);return te(r[0])?[r]:r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?aw(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var t=this.scales.y,r=P(t.getOptions().domain||[0,0],2),i=r[0],a=r[1];return a<0?t.map(a):t.map(i<0?0:i)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerShape",{get:function(){var t=this.attributes,r=t.width,i=t.height;return{width:r,height:i}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesStyle",{get:function(){var t=this,r=this.attributes,i=r.type,a=r.isStack,o=r.smooth;if(i!=="line")throw new Error("linesStyle can only be used in line type");var s=ee(this.attributes,"area"),l=ee(this.attributes,"line"),c=this.containerShape.width,u=this.data;if(u[0].length===0)return{lines:[],areas:[]};var h=this.scales,f=h.x,d=h.y,p=MG(u,{type:"line",x:f,y:d}),v=[];if(s){var g=this.baseline;a?v=o?AG(p,c,g):OG(p,c,g):v=CG(p,o,c,g)}return{lines:p.map(function(m,x){return N({stroke:t.getColor(x),d:o?Of(m):_c(m)},l)}),areas:v.map(function(m,x){return N({d:m,fill:t.getColor(x)},s)})}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsStyle",{get:function(){var t=this,r=ee(this.attributes,"column"),i=this.attributes,a=i.isStack,o=i.type,s=i.scale;if(o!=="column")throw new Error("columnsStyle can only be used in column type");var l=this.containerShape.height,c=this.rawData;if(!c)return{columns:[]};a&&(c=aw(c));var u=this.createScales(c),h=u.x,f=u.y,d=P(iw(c),2),p=d[0],v=d[1],g=new Sc({domain:[0,v-(p>0?0:p)],range:[0,l*s]}),m=h.getBandWidth(),x=this.rawData;return{columns:c.map(function(S,T){return S.map(function(b,y){var E=m/c.length,w=function(){return{x:h.map(y)+E*T,y:b>=0?f.map(b):f.map(0),width:E,height:g.map(Math.abs(b))}},C=function(){return{x:h.map(y),y:f.map(b),width:m,height:g.map(x[T][y])}};return N(N({fill:t.getColor(T)},r),a?C():w())})})}},enumerable:!1,configurable:!0}),e.prototype.render=function(t,r){FI(r,".container","rect").attr("className","container").node();var i=t.type,a=t.x,o=t.y,s="spark".concat(i),l=N({x:a,y:o},i==="line"?this.linesStyle:this.columnsStyle);Lt(r).selectAll(".spark").data([i]).join(function(c){return c.append(function(u){return u==="line"?new _G({className:s,style:l}):new SG({className:s,style:l})}).attr("className","spark ".concat(s))},function(c){return c.update(l)},function(c){return c.remove()})},e.prototype.getColor=function(t){var r=this.attributes.color;return tr(r)?r[t%r.length]:jt(r)?r.call(null,t):r},e.prototype.createScales=function(t){var r,i,a=this.attributes,o=a.type,s=a.scale,l=a.range,c=l===void 0?[]:l,u=a.spacing,h=this.containerShape,f=h.width,d=h.height,p=P(iw(t),2),v=p[0],g=p[1],m=new Sc({domain:[(r=c[0])!==null&&r!==void 0?r:v,(i=c[1])!==null&&i!==void 0?i:g],range:[d,d*(1-s)]});return o==="line"?{type:o,x:new Sc({domain:[0,t[0].length-1],range:[0,f]}),y:m}:{type:o,x:new eg({domain:t[0].map(function(x,S){return S}),range:[0,f],paddingInner:u,paddingOuter:u/2,align:.5}),y:m}},e.tag="sparkline",e}(bn),ow={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},sw={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},lw={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},ua=ji({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),go=ji({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),LG=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r){var i=t.x,a=t.y,o=t.size,s=o===void 0?10:o,l=t.radius,c=l===void 0?s/4:l,u=t.orientation,h=V(t,["x","y","size","radius","orientation"]),f=s,d=f*2.4,p=Lt(r).maybeAppendByClassName(go.iconRect,"rect").styles(N(N({},h),{width:f,height:d,radius:c,x:i-f/2,y:a-d/2,transformOrigin:"center"})),v=i+1/3*f-f/2,g=i+2/3*f-f/2,m=a+1/4*d-d/2,x=a+3/4*d-d/2;p.maybeAppendByClassName("".concat(go.iconLine,"-1"),"line").styles(N({x1:v,x2:v,y1:m,y2:x},h)),p.maybeAppendByClassName("".concat(go.iconLine,"-2"),"line").styles(N({x1:g,x2:g,y1:m,y2:x},h)),u==="vertical"&&(p.node().style.transform="rotate(90)")},e}(bn),IG=function(n){B(e,n);function e(t){return n.call(this,t,lw)||this}return e.prototype.renderLabel=function(t){var r=this,i=this.attributes,a=i.x,o=i.y,s=i.showLabel,l=ee(this.attributes,"label"),c=l.x,u=c===void 0?0:c,h=l.y,f=h===void 0?0:h,d=l.transform,p=l.transformOrigin,v=V(l,["x","y","transform","transformOrigin"]),g=P(Aa(v,[]),2),m=g[0],x=g[1],S=Lt(t).maybeAppendByClassName(go.labelGroup,"g").styles(x),T=N(N({},sw),m),b=T.text,y=V(T,["text"]);li(!!s,S,function(E){r.label=E.maybeAppendByClassName(go.label,"text").styles(N(N({},y),{x:a+u,y:o+f,transform:d,transformOrigin:p,text:"".concat(b)})),r.label.on("mousedown",function(w){w.stopPropagation()}),r.label.on("touchstart",function(w){w.stopPropagation()})})},e.prototype.renderIcon=function(t){var r=this.attributes,i=r.x,a=r.y,o=r.orientation,s=r.type,l=N(N({x:i,y:a,orientation:o},ow),ee(this.attributes,"icon")),c=this.attributes.iconShape,u=c===void 0?function(){return new LG({style:l})}:c,h=Lt(t).maybeAppendByClassName(go.iconGroup,"g");h.selectAll(go.icon.class).data([u]).join(function(f){return f.append(typeof u=="string"?u:function(){return u(s)}).attr("className",go.icon.name)},function(f){return f.update(l)},function(f){return f.remove()})},e.prototype.render=function(t,r){this.renderIcon(r),this.renderLabel(r)},e}(bn),DG=function(n){B(e,n);function e(t){var r=n.call(this,t,N(N(N({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(i){return i.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},Qs(lw,"handle")),Qs(ow,"handleIcon")),Qs(sw,"handleLabel")))||this;return r.range=[0,1],r.onDragStart=function(i){return function(a){a.stopPropagation(),r.target=i,r.prevPos=r.getOrientVal($2(a));var o=r.availableSpace,s=o.x,l=o.y,c=r.getBBox(),u=c.x,h=c.y;r.selectionStartPos=r.getRatio(r.prevPos-r.getOrientVal([s,l])-r.getOrientVal([+u,+h])),r.selectionWidth=0,document.addEventListener("pointermove",r.onDragging),document.addEventListener("pointerup",r.onDragEnd)}},r.onDragging=function(i){var a=r.attributes,o=a.slidable,s=a.brushable,l=a.type;i.stopPropagation();var c=r.getOrientVal($2(i)),u=c-r.prevPos;if(u){var h=r.getRatio(u);switch(r.target){case"start":o&&r.setValuesOffset(h);break;case"end":o&&r.setValuesOffset(0,h);break;case"selection":o&&r.setValuesOffset(h,h);break;case"track":if(!s)return;r.selectionWidth+=h,l==="range"?r.innerSetValues([r.selectionStartPos,r.selectionStartPos+r.selectionWidth].sort(),!0):r.innerSetValues([0,r.selectionStartPos+r.selectionWidth],!0);break;default:break}r.prevPos=c}},r.onDragEnd=function(){document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointerup",r.onDragEnd),r.target="",r.updateHandlesPosition(!1)},r.onValueChange=function(i){var a=r.attributes,o=a.onChange,s=a.type,l=s==="range"?i:i[1],c=s==="range"?r.getValues():r.getValues()[1],u=new Ln("valuechange",{detail:{oldValue:l,value:c}});r.dispatchEvent(u),o==null||o(c)},r.selectionStartPos=0,r.selectionWidth=0,r.prevPos=0,r.target="",r}return Object.defineProperty(e.prototype,"values",{get:function(){return this.attributes.values},set:function(t){this.attributes.values=this.clampValues(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineStyle",{get:function(){var t=this.attributes.orientation;if(t!=="horizontal")return null;var r=ee(this.attributes,"sparkline");return N(N({zIndex:0},this.availableSpace),r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t=this.attributes,r=t.trackLength,i=t.trackSize,a=P(this.getOrientVal([[r,i],[i,r]]),2),o=a[0],s=a[1];return{width:o,height:s}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,r=t.x,i=t.y,a=t.padding,o=P(Mn(a),4),s=o[0],l=o[1],c=o[2],u=o[3],h=this.shape,f=h.width,d=h.height;return{x:u,y:s,width:f-(u+l),height:d-(s+c)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(t,r){t===void 0&&(t=[0,0]),r===void 0&&(r=!1),this.attributes.values=t;var i=r===!1?!1:this.attributes.animate;this.updateSelectionArea(i),this.updateHandlesPosition(i)},e.prototype.updateSelectionArea=function(t){var r=this.calcSelectionArea();this.foregroundGroup.selectAll(ua.selection.class).each(function(i,a){$i(this,r[a],t)})},e.prototype.updateHandlesPosition=function(t){this.attributes.showHandle&&(this.startHandle&&$i(this.startHandle,this.getHandleStyle("start"),t),this.endHandle&&$i(this.endHandle,this.getHandleStyle("end"),t))},e.prototype.innerSetValues=function(t,r){t===void 0&&(t=[0,0]),r===void 0&&(r=!1);var i=this.values,a=this.clampValues(t);this.attributes.values=a,this.setValues(a),r&&this.onValueChange(i)},e.prototype.renderTrack=function(t){var r=this.attributes,i=r.x,a=r.y,o=ee(this.attributes,"track");this.trackShape=Lt(t).maybeAppendByClassName(ua.track,"rect").styles(N(N({x:i,y:a},this.shape),o))},e.prototype.renderBrushArea=function(t){var r=this.attributes,i=r.x,a=r.y,o=r.brushable;this.brushArea=Lt(t).maybeAppendByClassName(ua.brushArea,"rect").styles(N({x:i,y:a,fill:"transparent",cursor:o?"crosshair":"default"},this.shape))},e.prototype.renderSparkline=function(t){var r=this,i=this.attributes,a=i.x,o=i.y,s=i.orientation,l=Lt(t).maybeAppendByClassName(ua.sparklineGroup,"g");li(s==="horizontal",l,function(c){var u=N(N({},r.sparklineStyle),{x:a,y:o});c.maybeAppendByClassName(ua.sparkline,function(){return new kG({style:u})}).update(u)})},e.prototype.renderHandles=function(){var t=this,r,i=this.attributes,a=i.showHandle,o=i.type,s=o==="range"?["start","end"]:["end"],l=a?s:[],c=this;(r=this.foregroundGroup)===null||r===void 0||r.selectAll(ua.handle.class).data(l.map(function(u){return{type:u}}),function(u){return u.type}).join(function(u){return u.append(function(h){var f=h.type;return new IG({style:t.getHandleStyle(f)})}).each(function(h){var f=h.type;this.attr("class","".concat(ua.handle.name," ").concat(f,"-handle"));var d="".concat(f,"Handle");c[d]=this,this.addEventListener("pointerdown",c.onDragStart(f))})},function(u){return u.each(function(h){var f=h.type;this.update(c.getHandleStyle(f))})},function(u){return u.each(function(h){var f=h.type,d="".concat(f,"Handle");c[d]=void 0}).remove()})},e.prototype.renderSelection=function(t){var r=this.attributes,i=r.x,a=r.y,o=r.type,s=r.selectionType;this.foregroundGroup=Lt(t).maybeAppendByClassName(ua.foreground,"g");var l=ee(this.attributes,"selection"),c=function(h){return h.style("visibility",function(f){return f.show?"visible":"hidden"}).style("cursor",function(f){return s==="select"?"grab":s==="invert"?"crosshair":"default"}).styles(N(N({},l),{transform:"translate(".concat(i,", ").concat(a,")")}))},u=this;this.foregroundGroup.selectAll(ua.selection.class).data(o==="value"?[]:this.calcSelectionArea().map(function(h,f){return{style:N({},h),index:f,show:s==="select"?f===1:f!==1}}),function(h){return h.index}).join(function(h){return h.append("rect").attr("className",ua.selection.name).call(c).each(function(f,d){var p=this;d===1?(u.selectionShape=Lt(this),this.on("pointerdown",function(v){p.attr("cursor","grabbing"),u.onDragStart("selection")(v)}),u.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),u.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),u.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){p.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){p.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){p.attr("cursor","pointer")})):this.on("pointerdown",u.onDragStart("track"))})},function(h){return h.call(c)},function(h){return h.remove()}),this.updateSelectionArea(!1),this.renderHandles()},e.prototype.render=function(t,r){this.renderTrack(r),this.renderSparkline(r),this.renderBrushArea(r),this.renderSelection(r)},e.prototype.clampValues=function(t,r){var i;r===void 0&&(r=4);var a=P(this.range,2),o=a[0],s=a[1],l=P(this.getValues().map(function(g){return X0(g,r)}),2),c=l[0],u=l[1],h=Array.isArray(t)?t:[c,t!=null?t:u],f=P((h||[c,u]).map(function(g){return X0(g,r)}),2),d=f[0],p=f[1];if(this.attributes.type==="value")return[0,he(p,o,s)];d>p&&(i=P([p,d],2),d=i[0],p=i[1]);var v=p-d;return v>s-o?[o,s]:d<o?c===o&&u===p?[o,p]:[o,v+o]:p>s?u===s&&c===d?[d,s]:[s-v,s]:[d,p]},e.prototype.calcSelectionArea=function(t){var r=P(this.clampValues(t),2),i=r[0],a=r[1],o=this.availableSpace,s=o.x,l=o.y,c=o.width,u=o.height;return this.getOrientVal([[{y:l,height:u,x:s,width:i*c},{y:l,height:u,x:i*c+s,width:(a-i)*c},{y:l,height:u,x:a*c,width:(1-a)*c}],[{x:s,width:c,y:l,height:i*u},{x:s,width:c,y:i*u+l,height:(a-i)*u},{x:s,width:c,y:a*u,height:(1-a)*u}]])},e.prototype.calcHandlePosition=function(t){var r=this.attributes.handleIconOffset,i=this.availableSpace,a=i.x,o=i.y,s=i.width,l=i.height,c=P(this.clampValues(),2),u=c[0],h=c[1],f=t==="start"?-r:r,d=(t==="start"?u:h)*this.getOrientVal([s,l])+f;return{x:a+this.getOrientVal([d,s/2]),y:o+this.getOrientVal([l/2,d])}},e.prototype.inferTextStyle=function(t){var r=this.attributes.orientation;return r==="horizontal"?{}:t==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:t==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},e.prototype.calcHandleText=function(t){var r,i=this.attributes,a=i.type,o=i.orientation,s=i.formatter,l=i.autoFitLabel,c=ee(this.attributes,"handle"),u=ee(c,"label"),h=c.spacing,f=this.getHandleSize(),d=this.clampValues(),p=t==="start"?d[0]:d[1],v=s(p),g=new Hv({style:N(N(N({},u),this.inferTextStyle(t)),{text:v})}),m=g.getBBox(),x=m.width,S=m.height;if(g.destroy(),!l){if(a==="value")return{text:v,x:0,y:-S-h};var T=h+f+(o==="horizontal"?x/2:0);return r={text:v},r[o==="horizontal"?"x":"y"]=t==="start"?-T:T,r}var b=0,y=0,E=this.availableSpace,w=E.width,C=E.height,M=this.calcSelectionArea()[1],O=M.x,A=M.y,R=M.width,L=M.height,z=h+f;if(o==="horizontal"){var Y=z+x/2;if(t==="start"){var I=O-z-x;b=I>0?-Y:Y}else{var q=w-O-R-z>x;b=q?Y:-Y}}else{var J=z,wt=S+z;t==="start"?y=A-f>S?-wt:J:y=C-(A+L)-f>S?wt:-J}return{x:b,y,text:v}},e.prototype.getHandleLabelStyle=function(t){var r=ee(this.attributes,"handleLabel");return N(N(N({},r),this.calcHandleText(t)),this.inferTextStyle(t))},e.prototype.getHandleIconStyle=function(){var t=this.attributes.handleIconShape,r=ee(this.attributes,"handleIcon"),i=this.getOrientVal(["ew-resize","ns-resize"]),a=this.getHandleSize();return N({cursor:i,shape:t,size:a},r)},e.prototype.getHandleStyle=function(t){var r=this.attributes,i=r.x,a=r.y,o=r.showLabel,s=r.showLabelOnInteraction,l=r.orientation,c=this.calcHandlePosition(t),u=c.x,h=c.y,f=this.calcHandleText(t),d=o;return!o&&s&&(this.target?d=!0:d=!1),N(N(N({},Qs(this.getHandleIconStyle(),"icon")),Qs(N(N({},this.getHandleLabelStyle(t)),f),"label")),{transform:"translate(".concat(u+i,", ").concat(h+a,")"),orientation:l,showLabel:d,type:t,zIndex:3})},e.prototype.getHandleSize=function(){var t=this.attributes,r=t.handleIconSize,i=t.width,a=t.height;return r||Math.floor((this.getOrientVal([+a,+i])+4)/2.4)},e.prototype.getOrientVal=function(t){var r=P(t,2),i=r[0],a=r[1],o=this.attributes.orientation;return o==="horizontal"?i:a},e.prototype.setValuesOffset=function(t,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var a=this.attributes.type,o=P(this.getValues(),2),s=o[0],l=o[1],c=a==="range"?t:0,u=[s+c,l+r].sort();i?this.setValues(u):this.innerSetValues(u,!0)},e.prototype.getRatio=function(t){var r=this.availableSpace,i=r.width,a=r.height;return t/this.getOrientVal([i,a])},e.prototype.dispatchCustomEvent=function(t,r,i){var a=this;t.on(r,function(o){o.stopPropagation(),a.dispatchEvent(new Ln(i,{detail:o}))})},e.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var t=this.brushArea;this.dispatchCustomEvent(t,"click","trackClick"),this.dispatchCustomEvent(t,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(t,"pointerleave","trackMouseleave"),t.on("pointerdown",this.onDragStart("track"))},e.prototype.onScroll=function(t){var r=this.attributes.scrollable;if(r){var i=t.deltaX,a=t.deltaY,o=a||i,s=this.getRatio(o);this.setValuesOffset(s,s,!0)}},e.tag="slider",e}(bn),BG={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(n){return n.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},rg=ji({background:"background",labelGroup:"label-group",label:"label"},"indicator"),FG=function(n){B(e,n);function e(t){var r=n.call(this,t,BG)||this;return r.point=[0,0],r.group=r.appendChild(new jn({})),r.isMutationObserved=!0,r}return e.prototype.renderBackground=function(){if(this.label){var t=this.attributes,r=t.position,i=t.padding,a=P(Mn(i),4),o=a[0],s=a[1],l=a[2],c=a[3],u=this.label.node().getLocalBounds(),h=u.min,f=u.max,d=new fn(h[0]-c,h[1]-o,f[0]+s-h[0]+c,f[1]+l-h[1]+o),p=this.getPath(r,d),v=ee(this.attributes,"background");this.background=Lt(this.group).maybeAppendByClassName(rg.background,"path").styles(N(N({},v),{d:p})),this.group.appendChild(this.label.node())}},e.prototype.renderLabel=function(){var t=this.attributes,r=t.formatter,i=t.labelText,a=ee(this.attributes,"label"),o=P(Aa(a),2),s=o[0],l=o[1],c=s.text,u=V(s,["text"]);if(this.label=Lt(this.group).maybeAppendByClassName(rg.labelGroup,"g").styles(l),!!i){var h=this.label.maybeAppendByClassName(rg.label,function(){return Na(r(i))}).style("text",r(i).toString());h.selectAll("text").styles(u)}},e.prototype.adjustLayout=function(){var t=P(this.point,2),r=t[0],i=t[1],a=this.attributes,o=a.x,s=a.y;this.group.attr("transform","translate(".concat(o-r,", ").concat(s-i,")"))},e.prototype.getPath=function(t,r){var i=this.attributes.radius,a=r.x,o=r.y,s=r.width,l=r.height,c=[["M",a+i,o],["L",a+s-i,o],["A",i,i,0,0,1,a+s,o+i],["L",a+s,o+l-i],["A",i,i,0,0,1,a+s-i,o+l],["L",a+i,o+l],["A",i,i,0,0,1,a,o+l-i],["L",a,o+i],["A",i,i,0,0,1,a+i,o],["Z"]],u={top:4,right:6,bottom:0,left:2},h=u[t],f=this.createCorner([c[h].slice(-2),c[h+1].slice(-2)]);return c.splice.apply(c,K([h+1,1],P(f),!1)),c[0][0]="M",c},e.prototype.createCorner=function(t,r){r===void 0&&(r=10);var i=.8,a=xD.apply(void 0,K([],P(t),!1)),o=P(t,2),s=P(o[0],2),l=s[0],c=s[1],u=P(o[1],2),h=u[0],f=u[1],d=P(a?[h-l,[l,h]]:[f-c,[c,f]],2),p=d[0],v=P(d[1],2),g=v[0],m=v[1],x=p/2,S=p/Math.abs(p),T=r*S,b=T/2,y=T*Math.sqrt(3)/2*i,E=P([g,g+x-b,g+x,g+x+b,m],5),w=E[0],C=E[1],M=E[2],O=E[3],A=E[4];return a?(this.point=[M,c-y],[["L",w,c],["L",C,c],["L",M,c-y],["L",O,c],["L",A,c]]):(this.point=[l+y,M],[["L",l,w],["L",l,C],["L",l+y,M],["L",l,O],["L",l,A]])},e.prototype.applyVisibility=function(){var t=this.attributes.visibility;t==="hidden"?Xi(this):lc(this)},e.prototype.bindEvents=function(){this.label.on(pe.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},e}(bn),GG=function(n){B(e,n);function e(t){var r=n.call(this,Fn({},e.defaultOptions,t))||this;return r.hoverColor="#f5f5f5",r.selectedColor="#e6f7ff",r.background=r.appendChild(new Ko({})),r.label=r.background.appendChild(new jn({})),r}return Object.defineProperty(e.prototype,"padding",{get:function(){return Mn(this.style.padding)},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(){var t=this.style,r=t.label,i=t.value,a=ee(this.attributes,"label");Lt(this.label).maybeAppend(".label",function(){return Na(r)}).attr("className","label").styles(a),this.label.attr("__data__",i)},e.prototype.renderBackground=function(){var t=this.label.getBBox(),r=P(this.padding,4),i=r[0],a=r[1],o=r[2],s=r[3],l=t.width,c=t.height,u=l+s+a,h=c+i+o,f=ee(this.attributes,"background"),d=this.style,p=d.width,v=p===void 0?0:p,g=d.height,m=g===void 0?0:g,x=d.selected;this.background.attr(N(N({},f),{width:Math.max(u,v),height:Math.max(h,m),fill:x?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(s,", ").concat((h-c)/2,")")})},e.prototype.render=function(){this.renderLabel(),this.renderBackground()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("pointerenter",function(){t.style.selected||t.background.attr("fill",t.hoverColor)}),this.addEventListener("pointerleave",function(){t.style.selected||t.background.attr("fill",t.style.backgroundFill)});var r=this;this.addEventListener("click",function(){var i=t.style,a=i.label,o=i.value,s=i.onClick;s==null||s(o,{label:a,value:o},r)})},e.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},e}(bn),zG=function(n){B(e,n);function e(t){var r,i,a=n.call(this,Fn({},e.defaultOptions,t))||this;a.currentValue=(r=e.defaultOptions.style)===null||r===void 0?void 0:r.defaultValue,a.isPointerInSelect=!1,a.select=a.appendChild(new Ko({className:"select",style:{cursor:"pointer",width:0,height:0}})),a.dropdown=a.appendChild(new Ko({className:"dropdown"}));var o=a.style.defaultValue;return o&&(!((i=a.style.options)===null||i===void 0)&&i.some(function(s){return s.value===o}))&&(a.currentValue=o),a}return e.prototype.setValue=function(t){this.currentValue=t,this.render()},e.prototype.getValue=function(){return this.currentValue},Object.defineProperty(e.prototype,"dropdownPadding",{get:function(){return Mn(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),e.prototype.renderSelect=function(){var t=this,r,i=this.style,a=i.x,o=i.y,s=i.width,l=i.height,c=i.bordered,u=i.showDropdownIcon,h=ee(this.attributes,"select"),f=ee(this.attributes,"placeholder");this.select.attr(N(N({x:a,y:o,width:s,height:l},h),{fill:"#fff",strokeWidth:c?1:0}));var d=this.dropdownPadding,p=10;u&&Lt(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(a+s-p-d[1]-d[3],", ").concat(o+l/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var v=(r=this.style.options)===null||r===void 0?void 0:r.find(function(S){return S.value===t.currentValue}),g=N({x:a+d[3]},f);Lt(this.select).selectAll(".placeholder").data(v?[]:[1]).join(function(S){return S.append("text").attr("className","placeholder").styles(g).style("y",function(){var T=this.getBBox();return o+(l-T.height)/2})},function(S){return S.styles(g)},function(S){return S.remove()});var m=ee(this.attributes,"optionLabel"),x=N({x:a+d[3]},m);Lt(this.select).selectAll(".value").data(v?[v]:[]).join(function(S){return S.append(function(T){return Na(T.label)}).attr("className","value").styles(x).style("y",function(){var T=this.getBBox();return o+(l-T.height)/2})},function(S){return S.styles(x)},function(S){return S.remove()})},e.prototype.renderDropdown=function(){var t=this,r,i,a=this.style,o=a.x,s=a.y,l=a.width,c=a.height,u=a.options,h=a.onSelect,f=a.open,d=ee(this.attributes,"dropdown"),p=ee(this.attributes,"option"),v=this.dropdownPadding;Lt(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(u,function(x){return x.value}).join(function(x){return x.append(function(S){return new GG({className:"dropdown-item",style:N(N(N({},S),p),{width:l-v[1]-v[3],selected:S.value===t.currentValue,onClick:function(T,b,y){t.setValue(T),h==null||h(T,b,y),t.dispatchEvent(new Ln("change",{detail:{value:T,option:b,item:y}})),Xi(t.dropdown)}})})}).each(function(S,T){var b,y=(b=this.parentNode)===null||b===void 0?void 0:b.children,E=y.reduce(function(w,C,M){return M<T&&(w+=C.getBBox().height),w},0);this.attr("transform","translate(".concat(v[3],", ").concat(v[0]+E,")"))})},function(x){return x.update(function(S){return{selected:S.value===t.currentValue}})},function(x){return x.remove()});var g=(i=(r=this.dropdown.getElementsByClassName("dropdown-container"))===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.getBBox(),m=d.spacing;this.dropdown.attr(N({transform:"translate(".concat(o,", ").concat(s+c+m,")"),width:g.width+v[1]+v[3],height:g.height+v[0]+v[2]},d)),!f&&Xi(this.dropdown)},e.prototype.render=function(){this.renderSelect(),this.renderDropdown()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("click",function(r){r.stopPropagation()}),this.select.addEventListener("click",function(){t.dropdown.style.visibility==="visible"?Xi(t.dropdown):lc(t.dropdown)}),this.addEventListener("pointerenter",function(){t.isPointerInSelect=!0}),this.addEventListener("pointerleave",function(){t.isPointerInSelect=!1}),document==null||document.addEventListener("click",function(){t.isPointerInSelect||Xi(t.dropdown)})},e.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"\u8BF7\u9009\u62E9",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},e}(bn),Zi=function(n){B(e,n);function e(t){var r=n.call(this,Fn({},{style:{backgroundOpacity:e.backgroundOpacities.default}},e.defaultOptions,t))||this;return r.showBackground=!0,r.background=r.appendChild(new Ko({})),r.icon=r.appendChild(new jn({})),r}return Object.defineProperty(e.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return Mn(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconSize",{get:function(){var t=this.attributes.size,r=P(this.padding,4),i=r[0],a=r[1],o=r[2],s=r[3];return Math.max(t-Math.max(s+a,i+o),this.lineWidth*2+1)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.attributes,r=t.x,i=t.y,a=t.size,o=a/2,s=ee(this.attributes,"background");this.background.attr(N({x:r-o,y:i-o,width:a,height:a},s))},e.prototype.showIndicator=function(){if(this.label){var t=this.attributes.size,r=this.background.getBBox(),i=r.x,a=r.y;this.indicator.update({x:i+t/2,y:a-5,labelText:this.label,visibility:"visible"})}},e.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},e.prototype.connectedCallback=function(){var t;n.prototype.connectedCallback.call(this);var r=this.attributes.size,i=this.background.getBBox(),a=i.x,o=i.y,s=(t=this.ownerDocument)===null||t===void 0?void 0:t.defaultView;s&&(this.indicator=s.appendChild(new FG({style:{x:a+r/2,y:o-r/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},e.prototype.disconnectedCallback=function(){this.indicator.destroy()},e.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},e.prototype.bindEvents=function(){var t=this,r=this.attributes.onClick;if(this.addEventListener("click",function(){r==null||r(t)}),this.showBackground){var i=function(){return t.background.attr({opacity:e.backgroundOpacities.default})},a=function(){return t.background.attr({opacity:e.backgroundOpacities.hover})},o=function(){return t.background.attr({opacity:e.backgroundOpacities.active})};this.addEventListener("pointerenter",function(){a(),t.showIndicator()}),this.addEventListener("pointerleave",function(){i(),t.hideIndicator()}),this.addEventListener("pointerdown",function(){o()}),this.addEventListener("pointerup",function(){i()})}},e.tag="IconBase",e.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},e.backgroundOpacities={default:0,hover:.8,active:1},e}(bn),Tc=function(n,e){return e===void 0&&(e="#565758"),new kh({style:{fill:e,d:"M ".concat(n,",").concat(n," L -").concat(n,",0 L ").concat(n,",-").concat(n," Z"),transformOrigin:"center"}})},WG=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.arcPath=function(t,r,i){var a=P([i,i],2),o=a[0],s=a[1],l=function(v){return[t+i*Math.cos(v),r+i*Math.sin(v)]},c=P(l(-5/4*Math.PI),2),u=c[0],h=c[1],f=P(l(1/4*Math.PI),2),d=f[0],p=f[1];return"M".concat(u,",").concat(h,",A").concat(o,",").concat(s,",0,1,1,").concat(d,",").concat(p)},Object.defineProperty(e.prototype,"label",{get:function(){return"\u91CD\u7F6E"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this.iconSize,s=this.lineWidth,l=s+.5;Lt(this.icon).maybeAppend(".reset","path").styles({stroke:a,lineWidth:s,d:this.arcPath(r,i,o/2-s),markerStart:Tc(l,a)})},e}(Zi),UG=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u5FEB\u9000"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this.iconSize,s=o/2,l=o/2/Math.pow(3,.5),c=[[r,i],[r,i-l],[r-s,i],[r,i+l],[r,i],[r+s,i-l],[r+s,i+l],[r,i]];Lt(this.icon).maybeAppend(".backward","polygon").styles({points:c,fill:a})},e}(Zi),VG=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u5FEB\u8FDB"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this.iconSize,s=o/2,l=o/2/Math.pow(3,.5),c=[[r,i],[r,i-l],[r+s,i],[r,i+l],[r,i],[r-s,i-l],[r-s,i+l],[r,i]];Lt(this.icon).maybeAppend(".forward","polygon").styles({points:c,fill:a})},e}(Zi),HG=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u64AD\u653E"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this.iconSize,s=o/3*Math.pow(3,.5)*.8,l=[[r+s,i],[r-s/2,i-o/2*.8],[r-s/2,i+o/2*.8],[r+s,i]];Lt(this.icon).maybeAppend(".play","polygon").styles({points:l,fill:a})},e}(Zi),YG=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u6682\u505C"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this.iconSize,s=o/3,l=[[r-s,i-o/2],[r-s,i+o/2],[r-s/2,i+o/2],[r-s/2,i-o/2],[r-s,i-o/2],[r+s/2,i-o/2],[r+s/2,i+o/2],[r+s,i+o/2],[r+s,i-o/2]];Lt(this.icon).maybeAppend(".pause","polygon").styles({points:l,fill:a})},e}(Zi),XG=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u8303\u56F4\u65F6\u95F4"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this,s=o.iconSize,l=o.lineWidth,c=l;Lt(this.icon).maybeAppend(".left-line","line").styles({x1:r-s/2,y1:i-s/2,x2:r-s/2,y2:i+s/2,stroke:a,lineWidth:l}),Lt(this.icon).maybeAppend(".right-line","line").styles({x1:r+s/2,y1:i-s/2,x2:r+s/2,y2:i+s/2,stroke:a,lineWidth:l}),Lt(this.icon).maybeAppend(".left-arrow","line").styles({x1:r,y1:i,x2:r-s/2+c*2,y2:i,stroke:a,lineWidth:l,markerEnd:Tc(l*2,a)}),Lt(this.icon).maybeAppend(".right-arrow","line").styles({x1:r,y1:i,x2:r+s/2-c*2,y2:i,stroke:a,lineWidth:l,markerEnd:Tc(l*2,a)})},e}(Zi),jG=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u5355\u4E00\u65F6\u95F4"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this,s=o.iconSize,l=o.lineWidth;Lt(this.icon).maybeAppend(".line","line").styles({x1:r,y1:i-s/2,x2:r,y2:i+s/2,stroke:a,lineWidth:l});var c=l;Lt(this.icon).maybeAppend(".left-arrow","line").styles({x1:r-s/2-c*2,y1:i,x2:r-c*2,y2:i,stroke:a,lineWidth:l,markerEnd:Tc(l*2,a)}),Lt(this.icon).maybeAppend(".right-arrow","line").styles({x1:r+s/2+c*2,y1:i,x2:r+c*2,y2:i,stroke:a,lineWidth:l,markerEnd:Tc(l*2,a)})},e}(Zi),cw=function(n){return[[-n/2,-n/2],[-n/2,n/2],[n/2,n/2]]},$G=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u6298\u7EBF\u56FE"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this,s=o.iconSize,l=o.lineWidth,c=l,u=(s-c*2-l)/4,h=(s-c*2-l)/2,f=P([r-s/2+c,i+s/2-c*2],2),d=f[0],p=f[1];Lt(this.icon).maybeAppend(".coordinate","polyline").styles({points:cw(s).map(function(v){var g=P(v,2),m=g[0],x=g[1];return[m+r,x+i]}),stroke:a,lineWidth:l}),Lt(this.icon).maybeAppend(".line","polyline").styles({points:[[d,p],[d+u,p-h],[d+u*2,p],[d+u*4,p-h*2]],stroke:a,lineWidth:l})},e}(Zi),KG=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u6761\u5F62\u56FE"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.data,r=this.attributes,i=r.x,a=r.y,o=r.color,s=this,l=s.iconSize,c=s.lineWidth,u=c,h=(l-u)/t.length,f=(l-u*2)/4,d=P([i-l/2+u*2,a+l/2-u],2),p=d[0],v=d[1];Lt(this.icon).maybeAppend(".coordinate","polyline").styles({points:cw(l).map(function(g){var m=P(g,2),x=m[0],S=m[1];return[x+i,S+a]}),stroke:o,lineWidth:c}),Lt(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map(function(g,m){return{value:g,index:m}})).join(function(g){return g.append("line").attr("className","column").style("x1",function(m){var x=m.index;return p+h*x}).style("y1",v).style("x2",function(m){var x=m.index;return p+h*x}).style("y2",function(m){var x=m.value;return v-f*x}).styles({y1:v,stroke:o,lineWidth:c})})},e}(Zi),ZG=function(n){B(e,n);function e(t){var r=n.call(this,Fn({},{style:{color:"#d8d9d9"}},t))||this;return r.showBackground=!1,r}return e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this,s=o.iconSize,l=o.lineWidth;Lt(this.icon).maybeAppend(".split","line").styles({x1:r,y1:i-s/2,x2:r,y2:i+s/2,stroke:a,lineWidth:l})},e}(Zi),ig=function(n){B(e,n);function e(){var t=n.apply(this,K([],P(arguments),!1))||this;return t.showBackground=!1,t}return Object.defineProperty(e.prototype,"padding",{get:function(){return Mn(0)},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.iconSize,r=this.attributes,i=r.x,a=r.y,o=r.speed,s=o===void 0?1:o,l=Xp(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),c=he(t,20,1/0),u=20,h=N(N({},l),{x:i-c/2,y:a-u/2,width:c,height:u,defaultValue:s,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:t/5,placeholderFontSize:t/2,optionPadding:0,optionLabelFontSize:t/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});Lt(this.icon).maybeAppend(".speed",function(){return new zG({style:h})}).attr("className","speed").each(function(){this.update(h)})},e.tag="SpeedSelect",e}(Zi),ag=function(n){B(e,n);function e(t){var r=n.call(this,t)||this;return r.icon=r.appendChild(new jn({})),r.currentType=r.attributes.type,r}return e.prototype.getType=function(){return this.currentType},e.prototype.render=function(){var t=this,r=this.attributes,i=r.onChange,a=V(r,["onChange"]);Lt(this.icon).selectAll(".icon").data([this.currentType]).join(function(o){return o.append(function(s){var l,c=(l=t.toggles.find(function(u){var h=P(u,1),f=h[0];return f===s}))===null||l===void 0?void 0:l[1];if(!c)throw new Error("Invalid type: ".concat(s));return new c({})}).attr("className","icon").styles(a,!1).update({})},function(o){return o.styles({restStyles:a}).update({})},function(o){return o.remove()})},e.prototype.bindEvents=function(){var t=this,r=this.attributes.onChange;this.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation();var a=(t.toggles.findIndex(function(s){var l=P(s,1),c=l[0];return c===t.currentType})+1)%t.toggles.length,o=t.toggles[a][0];r==null||r(t.currentType),t.currentType=o,t.render()})},e.tag="ToggleIcon",e}(bn),og=function(n){B(e,n);function e(t){var r=n.call(this,Fn({},{style:{type:"play"}},t))||this;return r.toggles=[["play",HG],["pause",YG]],r}return e}(ag),sg=function(n){B(e,n);function e(t){var r=n.call(this,Fn({},{style:{type:"range"}},t))||this;return r.toggles=[["range",XG],["value",jG]],r}return e}(ag),lg=function(n){B(e,n);function e(t){var r=n.call(this,Fn({},{style:{type:"column"}},t))||this;return r.toggles=[["line",$G],["column",KG]],r}return e}(ag),qG={reset:WG,speed:ig,backward:UG,playPause:og,forward:VG,selectionType:sg,chartType:lg,split:ZG},JG=function(n){B(e,n);function e(t){var r=n.call(this,Fn({},e.defaultOptions,t))||this;return r.background=r.appendChild(new Ko({})),r.functions=r.appendChild(new jn({})),r}return Object.defineProperty(e.prototype,"padding",{get:function(){return Mn(this.attributes.padding)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.style,r=t.x,i=t.y,a=t.width,o=t.height,s=ee(this.attributes,"background");this.background.attr(N({x:r,y:i,width:a,height:o},s))},e.prototype.renderFunctions=function(){var t=this,r,i=this.attributes,a=i.functions,o=i.iconSize,s=i.iconSpacing,l=i.x,c=i.y,u=i.width,h=i.height,f=i.align,d=P(this.padding,4),p=d[1],v=d[3],g=a.reduce(function(S,T){return S.length&&T.length?S.concat.apply(S,K(["split"],P(T),!1)):S.concat.apply(S,K([],P(T),!1))},[]),m=g.length*(o+s)-s,x={left:v+o/2,center:(u-m)/2+o/2,right:u-m-v-p+o/2}[f]||0;(r=this.speedSelect)===null||r===void 0||r.destroy(),this.functions.removeChildren(),g.forEach(function(S,T){var b,y=qG[S],E={x:l+T*(o+s)+x,y:c+h/2,size:o};if(y===ig?(E.speed=t.attributes.speed,E.onSelect=function(C){return t.handleFunctionChange(S,{value:C})}):[og,sg,lg].includes(y)?(E.onChange=function(C){return t.handleFunctionChange(S,{value:C})},y===og&&(E.type=t.attributes.state==="play"?"pause":"play"),y===sg&&(E.type=t.attributes.selectionType==="range"?"value":"range"),y===lg&&(E.type=t.attributes.chartType==="line"?"column":"line")):E.onClick=function(){return t.handleFunctionChange(S,{value:S})},y===ig){var w=(b=t.ownerDocument)===null||b===void 0?void 0:b.defaultView;w&&(t.speedSelect=new y({style:N(N({},E),{zIndex:100})}),w.appendChild(t.speedSelect))}else t.functions.appendChild(new y({style:E}))})},e.prototype.disconnectedCallback=function(){var t;n.prototype.disconnectedCallback.call(this),(t=this.speedSelect)===null||t===void 0||t.destroy()},e.prototype.render=function(){this.renderBackground(),this.renderFunctions()},e.prototype.handleFunctionChange=function(t,r){var i=this.attributes.onChange;i==null||i(t,r)},e.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},e}(bn),QG=function(n){B(e,n);function e(t){var r=n.call(this,Fn({},e.defaultOptions,t))||this;return r.bindEvents(),r}return e.prototype.bindEvents=function(){var t=this;this.addEventListener("mouseenter",function(){t.attr("lineWidth",Math.ceil(+(t.style.r||0)/2))}),this.addEventListener("mouseleave",function(){t.attr("lineWidth",0)})},e.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},e}(Rh),t9=function(n){B(e,n);function e(t){return n.call(this,Fn({},e.defaultOptions,t))||this}return e.prototype.renderBackground=function(){var t=this.attributes,r=t.x,i=t.y,a=t.width,o=t.height,s=ee(this.attributes,"background");Lt(this).maybeAppend("background","rect").attr("className","background").styles(N({x:r-a/2,y:i-o/2,width:a,height:o},s))},e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.iconSize,o=ee(this.attributes,"icon"),s=1,l=a/2;Lt(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles(N({x1:r-s,y1:i-l,x2:r-s,y2:i+l},o)),Lt(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles(N({x1:r+s,y1:i-l,x2:r+s,y2:i+l},o))},e.prototype.renderBorder=function(){var t=this.attributes,r=t.x,i=t.y,a=t.width,o=t.height,s=t.type,l=ee(this.attributes,"border"),c=s==="start"?+a/2:-a/2;Lt(this).maybeAppend("border","line").attr("className","border").styles(N({x1:c+r,y1:i-o/2,x2:c+r,y2:i+o/2},l))},e.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},e.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},e}(bn);function e9(n,e){return typeof n=="number"?uw(n):n9(n,e)}function n9(n,e){var t=new Date(n);switch(e){case"half-hour":case"hour":case"four-hour":return[0,6,12,18].includes(t.getHours())&&t.getMinutes()===0?wr(t,`HH:mm
YYYY-MM-DD`):wr(t,"HH:mm");case"half-day":return t.getHours()<12?`AM
`.concat(wr(t,"YYYY-MM-DD")):"PM";case"day":return[1,10,20].includes(t.getDate())?wr(t,`DD
YYYY-MM`):wr(t,"DD");case"week":return t.getDate()<=7?wr(t,`DD
YYYY-MM`):wr(t,"DD");case"month":return[0,6].includes(t.getMonth())?wr(t,`MM\u6708
YYYY`):wr(t,"MM\u6708");case"season":return[0].includes(t.getMonth())?wr(t,`MM\u6708
YYYY`):wr(t,"MM\u6708");case"year":return wr(t,"YYYY");default:return wr(t,"YYYY-MM-DD HH:mm")}}function uw(n){var e=String(Math.floor(n/3600)).padStart(2,"0"),t=String(Math.floor(n%3600/60)).padStart(2,"0"),r=String(Math.floor(n%60)).padStart(2,"0");return n<3600?"".concat(t,":").concat(r):"".concat(e,":").concat(t,":").concat(r)}var r9=function(n){B(e,n);function e(t){var r=n.call(this,Fn({},e.defaultOptions,t))||this;r.axis=r.appendChild(new Q5({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),r.timeline=r.appendChild(new DG({style:{onChange:function(h){r.handleSliderChange(h)}}})),r.controller=r.appendChild(new JG({})),r.states={},r.handleSliderChange=function(h){var f=function(){var d=r.states.values;return Array.isArray(d)?K([],P(d),!1):d}();r.setBySliderValues(h),r.dispatchOnChange(f)};var i=r.attributes,a=i.selectionType,o=i.chartType,s=i.speed,l=i.state,c=i.playMode,u=i.values;return r.states={chartType:o,playMode:c,selectionType:a,speed:s,state:l},r.setByTimebarValues(u),r}return Object.defineProperty(e.prototype,"data",{get:function(){var t=this.attributes.data,r=function(i,a){return i.time<a.time?-1:i.time>a.time?1:0};return t.sort(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){var t=this.attributes,r=t.x,i=t.y,a=t.width,o=t.height,s=t.type,l=t.controllerHeight,c=he(+o-l,0,+o),u=new fn(r,i+ +o-l,+a,l),h,f=0;s==="chart"?(f=35,h=new fn(r,i+c-f,+a,f)):h=new fn;var d=s==="time"?10:c,p=new fn(r,i+(s==="time"?c:c-d),+a,d-f);return{axisBBox:h,controllerBBox:u,timelineBBox:p}},enumerable:!1,configurable:!0}),e.prototype.setBySliderValues=function(t){var r,i,a=this.data,o=P(Array.isArray(t)?t:[0,t],2),s=o[0],l=o[1],c=a.length,u=a[Math.floor(s*c)],h=a[Math.ceil(l*c)-(Array.isArray(t)?0:1)];this.states.values=[(r=u==null?void 0:u.time)!==null&&r!==void 0?r:a[0].time,(i=h==null?void 0:h.time)!==null&&i!==void 0?i:1/0]},e.prototype.setByTimebarValues=function(t){var r,i,a,o=this.data,s=P(Array.isArray(t)?t:[void 0,t],2),l=s[0],c=s[1],u=o.find(function(f){var d=f.time;return d===l}),h=o.find(function(f){var d=f.time;return d===c});this.states.values=[(r=u==null?void 0:u.time)!==null&&r!==void 0?r:(i=o[0])===null||i===void 0?void 0:i.time,(a=h==null?void 0:h.time)!==null&&a!==void 0?a:1/0]},e.prototype.setByIndex=function(t){var r,i,a,o,s=this.data,l=P(t,2),c=l[0],u=l[1];this.states.values=[(i=(r=s[c])===null||r===void 0?void 0:r.time)!==null&&i!==void 0?i:s[0].time,(o=(a=this.data[u])===null||a===void 0?void 0:a.time)!==null&&o!==void 0?o:1/0]},Object.defineProperty(e.prototype,"sliderValues",{get:function(){var t=this.states,r=t.values,i=t.selectionType,a=P(Array.isArray(r)?r:[void 0,r],2),o=a[0],s=a[1],l=this.data,c=l.length,u=i==="value",h=function(){var d=l.findIndex(function(p){var v=p.time;return v===o});return u?0:d>-1?d/c:0},f=function(){if(s===1/0)return 1;var d=l.findIndex(function(p){var v=p.time;return v===s});return d>-1?d/c:u?.5:1};return[h(),f()]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this.states,r=t.values,i=t.selectionType,a=P(Array.isArray(r)?r:[this.data[0].time,r],2),o=a[0],s=a[1];return i==="value"?s:[o,s]},enumerable:!1,configurable:!0}),e.prototype.getDatumByRatio=function(t){var r=this.data,i=r.length,a=Math.floor(t*(i-1));return r[a]},Object.defineProperty(e.prototype,"chartHandleIconShape",{get:function(){var t=this.states.selectionType,r=this.space.timelineBBox.height;return t==="range"?function(i){return new t9({style:{type:i,height:r,iconSize:r/6}})}:function(){return new Av({style:{x1:0,y1:-r/2,x2:0,y2:r/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),e.prototype.getChartStyle=function(t){var r=this,i=t.x,a=t.y,o=t.width,s=t.height,l=this.states,c=l.selectionType,u=l.chartType,h=this.data,f=this.attributes,d=f.type,p=f.labelFormatter,v=ee(this.attributes,"chart"),g=v.type,m=V(v,["type"]),x=c==="range";if(d==="time")return N({handleIconShape:function(){return new QG({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:x?-15:0,autoFitLabel:x,handleSpacing:x?-15:0,trackFill:"#edeeef",trackLength:o,trackOpacity:.5,trackRadius:s/2,trackSize:s/2,type:c,values:this.sliderValues,formatter:function(b){if(p)return p(b);var y=r.getDatumByRatio(b).time;return typeof y=="number"?uw(y):wr(y,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(i,", ").concat(a,")"),zIndex:1},m);var S=c==="range"?5:0,T=h.map(function(b){var y=b.value;return y});return N({handleIconOffset:S,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:T,sparklineType:u,sparklineScale:.8,trackLength:o,trackSize:s,type:c,values:this.sliderValues,transform:"translate(".concat(i,", ").concat(a,")"),zIndex:1},m)},e.prototype.renderChart=function(t){t===void 0&&(t=this.space.timelineBBox),this.timeline.update(this.getChartStyle(t))},e.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},e.prototype.getAxisStyle=function(t){var r=this.data,i=this.attributes,a=i.interval,o=i.labelFormatter,s=ee(this.attributes,"axis"),l=t.x,c=t.y,u=t.width,h=K(K([],P(r),!1),[{time:0}],!1).map(function(d,p,v){var g=d.time;return{label:"".concat(g),value:p/(v.length-1),time:g}}),f=N({startPos:[l,c],endPos:[l+u,c],data:h,labelFilter:function(d,p){return p<h.length-1},labelFormatter:function(d){var p=d.time;return o?o(p):e9(p,a)}},s);return f},e.prototype.renderAxis=function(t){t===void 0&&(t=this.space.axisBBox);var r=this.attributes.type;r==="chart"&&this.axis.update(this.getAxisStyle(t))},e.prototype.renderController=function(t){t===void 0&&(t=this.space.controllerBBox);var r=this.attributes.type,i=this.states,a=i.state,o=i.speed,s=i.selectionType,l=i.chartType,c=ee(this.attributes,"controller"),u=this,h=N(N(N({},t),{iconSize:20,speed:o,state:a,selectionType:s,chartType:l,onChange:function(f,d){var p=d.value;switch(f){case"reset":u.internalReset();break;case"speed":u.handleSpeedChange(p);break;case"backward":u.internalBackward();break;case"playPause":p==="play"?u.internalPlay():u.internalPause();break;case"forward":u.internalForward();break;case"selectionType":u.handleSelectionTypeChange(p);break;case"chartType":u.handleChartTypeChange(p);break;default:break}}}),c);r==="time"&&(h.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(h)},e.prototype.dispatchOnChange=function(t){var r=this.data,i=this.attributes.onChange,a=this.states,o=a.values,s=a.selectionType,l=P(o,2),c=l[0],u=l[1],h=u===1/0?r.at(-1).time:u,f=s==="range"?[c,h]:h,d=function(p,v){return Array.isArray(p)?Array.isArray(v)?p[0]===v[0]&&(p[1]===v[1]||p[1]===1/0||v[1]===1/0):!1:Array.isArray(v)?!1:p===v};(!t||!d(t,f))&&(i==null||i(s==="range"?[c,h]:h))},e.prototype.internalReset=function(t){var r,i,a=this.states.selectionType;this.internalPause(),this.setBySliderValues(a==="range"?[0,1]:[0,0]),this.renderController(),this.updateSelection(),t||((i=(r=this.attributes)===null||r===void 0?void 0:r.onReset)===null||i===void 0||i.call(r),this.dispatchOnChange())},e.prototype.reset=function(){this.internalReset()},e.prototype.moveSelection=function(t,r){var i=this.data,a=i.length,o=this.states,s=o.values,l=o.selectionType,c=o.playMode,u=P(s,2),h=u[0],f=u[1],d=i.findIndex(function(S){var T=S.time;return T===h}),p=i.findIndex(function(S){var T=S.time;return T===f});p===-1&&(p=a);var v=t==="backward"?-1:1,g;l==="range"?c==="acc"?(g=[d,p+v],v===-1&&d===p&&(g=[d,a])):g=[d+v,p+v]:g=[d,p+v];var m=function(S){var T=P(S.sort(function(w,C){return w-C}),2),b=T[0],y=T[1],E=function(w){return he(w,0,a)};return y>a?l==="value"?[0,0]:c==="acc"?[E(b),E(b)]:[0,E(y-b)]:b<0?c==="acc"?[0,E(y)]:[E(b+a-y),a]:[E(b),E(y)]},x=m(g);return this.setByIndex(x),this.updateSelection(),x},e.prototype.internalBackward=function(t){var r,i,a=this.moveSelection("backward",t);return t||((i=(r=this.attributes)===null||r===void 0?void 0:r.onBackward)===null||i===void 0||i.call(r),this.dispatchOnChange()),a},e.prototype.backward=function(){this.internalBackward()},e.prototype.internalPlay=function(t){var r=this,i,a,o=this.data,s=this.attributes.loop,l=this.states.speed,c=l===void 0?1:l;this.playInterval=window.setInterval(function(){var u=r.internalForward();u[1]===o.length&&!s&&(r.internalPause(),r.renderController())},1e3/c),this.states.state="play",!t&&((a=(i=this.attributes)===null||i===void 0?void 0:i.onPlay)===null||a===void 0||a.call(i))},e.prototype.play=function(){this.internalPlay()},e.prototype.internalPause=function(t){var r,i;clearInterval(this.playInterval),this.states.state="pause",!t&&((i=(r=this.attributes)===null||r===void 0?void 0:r.onPause)===null||i===void 0||i.call(r))},e.prototype.pause=function(){this.internalPause()},e.prototype.internalForward=function(t){var r,i,a=this.moveSelection("forward",t);return t||((i=(r=this.attributes)===null||r===void 0?void 0:r.onForward)===null||i===void 0||i.call(r),this.dispatchOnChange()),a},e.prototype.forward=function(){this.internalForward()},e.prototype.handleSpeedChange=function(t){var r,i;this.states.speed=t;var a=this.states.state;a==="play"&&(this.internalPause(!0),this.internalPlay(!0)),(i=(r=this.attributes)===null||r===void 0?void 0:r.onSpeedChange)===null||i===void 0||i.call(r,t)},e.prototype.handleSelectionTypeChange=function(t){var r,i;this.states.selectionType=t,this.renderChart(),(i=(r=this.attributes)===null||r===void 0?void 0:r.onSelectionTypeChange)===null||i===void 0||i.call(r,t)},e.prototype.handleChartTypeChange=function(t){var r,i;this.states.chartType=t,this.renderChart(),(i=(r=this.attributes)===null||r===void 0?void 0:r.onChartTypeChange)===null||i===void 0||i.call(r,t)},e.prototype.render=function(){var t=this.space,r=t.axisBBox,i=t.controllerBBox,a=t.timelineBBox;this.renderController(i),this.renderAxis(r),this.renderChart(a),this.states.state==="play"&&this.internalPlay()},e.prototype.destroy=function(){n.prototype.destroy.call(this),this.internalPause(!0)},e.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},e}(bn),i9=function(n){return ls(n,"Date")},a9=i9;const o9=["timestamp","time","date","datetime"],nm=class extends mr{constructor(t,r){super(t,Object.assign({},nm.defaultOptions,r));k(this,"timebar");k(this,"canvas");k(this,"wrapper");k(this,"originalData");this.backup(),this.upsertTimebar()}get padding(){return Os(this.options.padding)}play(){var t;(t=this.timebar)==null||t.play()}pause(){var t;(t=this.timebar)==null||t.pause()}forward(){var t;(t=this.timebar)==null||t.forward()}backward(){var t;(t=this.timebar)==null||t.backward()}reset(){var t;(t=this.timebar)==null||t.reset()}update(t){super.update(t),this.backup(),Object.keys(t).forEach(r=>{switch(r){case"position":this.upsertWrapper();break;default:this.upsertTimebar();break}})}backup(){this.originalData=hw(this.context.graph.getData())}upsertTimebar(){const{canvas:t}=this.context,p=this.options,{onChange:r,timebarType:i,data:a,x:o,y:s,width:l,height:c,mode:u}=p,h=Ce(p,["onChange","timebarType","data","x","y","width","height","mode"]),f=t.getSize(),[d]=this.padding;this.upsertCanvas().ready.then(()=>{var g;const v=_e(at({x:f[0]/2-l/2,y:d,onChange:m=>{const x=(tr(m)?m:[m,m]).map(S=>a9(S)?S.getTime():S);this.options.mode==="modify"?this.filterElements(x):this.hiddenElements(x),r==null||r(x)}},h),{data:a.map(m=>te(m)?{time:m,value:0}:m),width:l,height:c,type:i});this.timebar?this.timebar.update(v):(this.timebar=new r9({style:v}),(g=this.canvas)==null||g.appendChild(this.timebar))})}upsertWrapper(){var o;if(!this.wrapper){const s=document.createElement("div");s.style.position="absolute",this.wrapper=s}const{x:t,y:r,className:i,position:a}=this.options;return i&&(this.wrapper.className=i),te(t)||te(r)?Object.assign(this.wrapper.style,{left:`${t!=null?t:0}px`,top:`${r!=null?r:0}px`}):Object.assign(this.wrapper.style,{[a==="top"?"bottom":"top"]:"unset",[a==="top"?"top":"bottom"]:"0px"}),(o=this.context.canvas.getContainer())==null||o.appendChild(this.wrapper),this.wrapper}upsertCanvas(){var s,l;const t=this.upsertWrapper();if(this.canvas)return this.canvas;const{height:r}=this.options,[i]=this.context.canvas.getSize(),[a,,o]=this.padding;return this.canvas=new iu({container:t,width:i,height:r+a+o,renderer:((l=(s=this.context.options).renderer)==null?void 0:l.call(s,"main"))||new mf,supportsMutipleCanvasesInOneContainer:!0}),this.canvas}filterElements(t){return Ct(this,null,function*(){var c;if(!this.originalData)return;const{elementTypes:r,getTime:i}=this.options,{graph:a,element:o}=this.context,s=hw(this.originalData);r.forEach(u=>{const h=`${u}s`;s[h]=(this.originalData[h]||[]).filter(f=>{const d=i(f);return!!fw(d,t)})});const l=[...s.nodes,...s.combos].map(u=>it(u));s.edges=s.edges.filter(u=>{const h=u.source,f=u.target;return l.includes(h)&&l.includes(f)}),a.setData(s),yield(c=o.draw({animation:!1,silence:!0}))==null?void 0:c.finished})}hiddenElements(t){const{graph:r}=this.context,{elementTypes:i,getTime:a}=this.options,o=[],s=[];i.forEach(l=>{var h;const c=`${l}s`;(((h=this.originalData)==null?void 0:h[c])||[]).forEach(f=>{const d=it(f),p=a(f);fw(p,t)?s.push(d):o.push(d)})}),r.hideElement(o,!1),r.showElement(s,!1)}destroy(){var r,i,a;const{graph:t}=this.context;this.originalData&&t.setData(at({},this.originalData)),(r=this.timebar)==null||r.destroy(),(i=this.canvas)==null||i.destroy(),(a=this.wrapper)==null||a.remove(),this.originalData=void 0,this.wrapper=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}};let Af=nm;k(Af,"defaultOptions",{position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:t=>s9(t,o9,void 0),loop:!1});const hw=n=>{const{nodes:e=[],edges:t=[],combos:r=[]}=n;return{nodes:[...e],edges:[...t],combos:[...r]}},fw=(n,e)=>{if(te(e))return n===e;const[t,r]=e;return n>=t&&n<=r},s9=(n,e,t)=>{var r;for(let i=0;i<e.length;i++){const a=e[i],o=(r=n.data)==null?void 0:r[a];if(o)return o}return t};function l9(n){const e={top:"unset",right:"unset",bottom:"unset",left:"unset"};return n.split("-").forEach(r=>{e[r]="8px"}),e.flexDirection=n.startsWith("top")||n.startsWith("bottom")?"row":"column",e}const c9=`
  .g6-toolbar {
    position: absolute;
    z-index: 100;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    opacity: 0.65;
  }
  .g6-toolbar .g6-toolbar-item {
    display: inline-block;
    width: 16px;
    height: 16px;
    padding: 4px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .g6-toolbar .g6-toolbar-item:hover {
    background-color: #f0f0f0;
  }

  .g6-toolbar .g6-toolbar-item svg {
    display: inline-block;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
`,u9=`
  <svg>
    <symbol id="zoom-in" viewBox="64 64 896 896">
      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="zoom-out" viewBox="64 64 896 896">
      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="edit" viewBox="64 64 896 896">
      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>
    </symbol>
    <symbol id="delete" viewBox="64 64 896 896">
      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>
    </symbol>
    <symbol id="redo" viewBox="64 64 896 896">
      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>
    </symbol>
    <symbol id="undo" viewBox="64 64 896 896">
      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>
    </symbol>
    <symbol id="export" viewBox="64 64 896 896">
      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>
    </symbol>
    <symbol id="auto-fit" viewBox="64 64 896 896">
      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>
      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>
    </symbol>
    <symbol id="reset" viewBox="64 64 896 896">
      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>
    </symbol>
    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">
      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>
    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">
      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>
  </svg>
`,Yf=class extends mr{constructor(t,r){super(t,Object.assign({},Yf.defaultOptions,r));k(this,"$element",ql("toolbar",!1));k(this,"onToolbarItemClick",t=>{const{onClick:r}=this.options;if(t.target instanceof Element&&t.target.className.includes("g6-toolbar-item")){const i=t.target.getAttribute("value");r==null||r(i,t.target)}});const i=this.context.canvas.getContainer();this.$element.style.display="flex",i.appendChild(this.$element),jp("g6-toolbar-css","style",{},c9,document.head),jp("g6-toolbar-svgicon","div",{display:"none"},u9),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(r)}update(t){return Ct(this,null,function*(){$f(Yf.prototype,this,"update").call(this,t);const{className:r,position:i,style:a}=this.options;this.$element.className=`g6-toolbar ${r||""}`,Object.assign(this.$element.style,a,l9(i)),this.$element.innerHTML=yield this.getDOMContent()})}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return Ct(this,null,function*(){return(yield this.options.getItems()).map(r=>`
          <div class="g6-toolbar-item" value="${r.value}">
            <svg aria-hidden="true" focusable="false">
              <use xlink:href="#${r.id}"></use>
            </svg>
          </div>`).join("")})}};let Nf=Yf;k(Nf,"defaultOptions",{position:"top-left"});function cg(n){var e=document.createElement("div");e.innerHTML=n;var t=e.childNodes[0];return t&&e.contains(t)&&e.removeChild(t),t}function h9(n,e){return!n||!e?n:n.replace(/\\?\{([^{}]+)\}/g,function(t,r){return t.charAt(0)==="\\"?t.slice(1):e[r]===void 0?"":e[r]})}var f9=h9,dw=function(n,e){if(e==null){n.innerHTML="";return}n.replaceChildren?Array.isArray(e)?n.replaceChildren.apply(n,K([],P(e),!1)):n.replaceChildren(e):(n.innerHTML="",Array.isArray(e)?e.forEach(function(t){return n.appendChild(t)}):n.appendChild(e))};function ug(n){return n===void 0&&(n=""),{CONTAINER:"".concat(n,"tooltip"),TITLE:"".concat(n,"tooltip-title"),LIST:"".concat(n,"tooltip-list"),LIST_ITEM:"".concat(n,"tooltip-list-item"),NAME:"".concat(n,"tooltip-list-item-name"),MARKER:"".concat(n,"tooltip-list-item-marker"),NAME_LABEL:"".concat(n,"tooltip-list-item-name-label"),VALUE:"".concat(n,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(n,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(n,"tooltip-crosshair-y")}}var pw={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function d9(n){var e;n===void 0&&(n="");var t=ug(n);return e={},e[".".concat(t.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},e[".".concat(t.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},e[".".concat(t.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},e[".".concat(t.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},e[".".concat(t.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},e[".".concat(t.NAME)]={display:"flex","align-items":"center","max-width":"216px"},e[".".concat(t.NAME_LABEL)]=N({flex:1},pw),e[".".concat(t.VALUE)]=N({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},pw),e[".".concat(t.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e[".".concat(t.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e}var p9=function(n){B(e,n);function e(t){var r=this,i,a,o=(a=(i=t.style)===null||i===void 0?void 0:i.template)===null||a===void 0?void 0:a.prefixCls,s=ug(o);return r=n.call(this,t,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(s.CONTAINER,'"></div>'),title:'<div class="'.concat(s.TITLE,'"></div>'),item:'<li class="'.concat(s.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(s.NAME,`">
          <span class="`).concat(s.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(s.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(s.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:d9(o)})||this,r.timestamp=-1,r.prevCustomContentKey=r.attributes.contentKey,r.initShape(),r.render(r.attributes,r),r}return Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"elementSize",{get:function(){var t=this.element.offsetWidth,r=this.element.offsetHeight;return{width:t,height:r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var t=this.attributes,r=t.data,i=t.template;return r.map(function(a,o){var s=a.name,l=s===void 0?"":s,c=a.color,u=c===void 0?"black":c,h=a.index,f=V(a,["name","color","index"]),d=N({name:l,color:u,index:h!=null?h:o},f);return cg(f9(i.item,d))})},enumerable:!1,configurable:!0}),e.prototype.render=function(t,r){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.destroy=function(){var t;(t=this.element)===null||t===void 0||t.remove(),n.prototype.destroy.call(this)},e.prototype.show=function(t,r){var i=this;if(t!==void 0&&r!==void 0){var a=this.element.style.visibility==="hidden",o=function(){i.attributes.x=t!=null?t:i.attributes.x,i.attributes.y=r!=null?r:i.attributes.y,i.updatePosition()};a?this.closeTransition(o):o()}this.element.style.visibility="visible"},e.prototype.hide=function(t,r){t===void 0&&(t=0),r===void 0&&(r=0);var i=this.attributes.enterable;i&&this.isCursorEntered(t,r)||(this.element.style.visibility="hidden")},e.prototype.initShape=function(){var t=this.attributes.template;this.element=cg(t.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var t=this.attributes.content;t&&(typeof t=="string"?this.element.innerHTML=t:dw(this.element,t))}},e.prototype.renderHTMLTooltipElement=function(){var t,r,i=this.attributes,a=i.template,o=i.title,s=i.enterable,l=i.style,c=i.content,u=ug(a.prefixCls),h=this.element;if(this.element.style.pointerEvents=s?"auto":"none",c)this.renderCustomContent();else{o?(h.innerHTML=a.title,h.getElementsByClassName(u.TITLE)[0].innerHTML=o):(r=(t=h.getElementsByClassName(u.TITLE))===null||t===void 0?void 0:t[0])===null||r===void 0||r.remove();var f=this.HTMLTooltipItemsElements,d=document.createElement("ul");d.className=u.LIST,dw(d,f);var p=this.element.querySelector(".".concat(u.LIST));p?p.replaceWith(d):h.appendChild(d)}LI(h,l)},e.prototype.getRelativeOffsetFromCursor=function(t){var r=this.attributes,i=r.position,a=r.offset,o=t||i,s=o.split("-"),l={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},c=this.elementSize,u=c.width,h=c.height,f=[-u/2,-h/2];return s.forEach(function(d){var p=P(f,2),v=p[0],g=p[1],m=P(l[d],2),x=m[0],S=m[1];f=[v+(u/2+a[0])*x,g+(h/2+a[1])*S]}),f},e.prototype.setOffsetPosition=function(t){var r=P(t,2),i=r[0],a=r[1],o=this.attributes,s=o.x,l=s===void 0?0:s,c=o.y,u=c===void 0?0:c,h=o.container,f=h.x,d=h.y;this.element.style.left="".concat(+l+f+i,"px"),this.element.style.top="".concat(+u+d+a,"px")},e.prototype.updatePosition=function(){var t=this.attributes.showDelay,r=t===void 0?60:t,i=Date.now();this.timestamp>0&&i-this.timestamp<r||(this.timestamp=i,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},e.prototype.autoPosition=function(t){var r=P(t,2),i=r[0],a=r[1],o=this.attributes,s=o.x,l=o.y,c=o.bounding,u=o.position;if(!c)return[i,a];var h=this.element,f=h.offsetWidth,d=h.offsetHeight,p=P([+s+i,+l+a],2),v=p[0],g=p[1],m={left:"right",right:"left",top:"bottom",bottom:"top"},x=c.x,S=c.y,T=c.width,b=c.height,y={left:v<x,right:v+f>x+T,top:g<S,bottom:g+d>S+b},E=[];u.split("-").forEach(function(C){y[C]?E.push(m[C]):E.push(C)});var w=E.join("-");return this.getRelativeOffsetFromCursor(w)},e.prototype.isCursorEntered=function(t,r){if(this.element){var i=this.element.getBoundingClientRect(),a=i.x,o=i.y,s=i.width,l=i.height;return new fn(a,o,s,l).isPointIn(t,r)}return!1},e.prototype.closeTransition=function(t){var r=this,i=this.element.style.transition;this.element.style.transition="none",t(),setTimeout(function(){r.element.style.transition=i},10)},e.tag="tooltip",e}(bn);const rm=class extends mr{constructor(t,r){super(t,Object.assign({},rm.defaultOptions,r));k(this,"currentTarget",null);k(this,"tooltipElement",null);k(this,"container",null);k(this,"isEnable",t=>{const{enable:r}=this.options;return typeof r=="function"?r(t):r});k(this,"onClick",t=>{const{target:{id:r}}=t;this.currentTarget===r?(this.currentTarget=null,this.hide(t)):(this.currentTarget=r,this.show(t))});k(this,"onPointerMove",t=>{const{target:r}=t;!this.currentTarget||r.id===this.currentTarget||this.show(t)});k(this,"onPointerLeave",t=>{this.hide(t),this.currentTarget=null});k(this,"onCanvasMove",t=>{this.hide(t),this.currentTarget=null});k(this,"onPointerEnter",t=>{this.show(t)});k(this,"showById",t=>{const r={target:{id:t}};this.show(r)});k(this,"getElementData",(t,r)=>{const{model:i}=this.context;switch(r){case"node":return i.getNodeData([t]);case"edge":return i.getEdgeData([t]);case"combo":return i.getComboData([t]);default:return[]}});k(this,"show",t=>{const{client:r,target:{id:i}}=t;if(Vp(t.target)||!this.tooltipElement||!this.isEnable(t))return;const a=this.context.graph.getElementType(i),{getContent:o,title:s}=this.options;this.currentTarget=i;const l=this.getElementData(i,a);let c,u;if(r)c=r.x,u=r.y;else{const f=gr(l,"0.style",{x:0,y:0});c=f.x,u=f.y}let h={};if(o)h.content=o(t,l);else{const f=this.context.graph.getElementRenderStyle(i),d=a==="node"?f.fill:f.stroke;h={title:s||a,data:l.map(p=>({name:"ID",value:p.id||`${p.source} -> ${p.target}`,color:d}))}}this.tooltipElement.update(at({x:c,y:u,style:{".tooltip":{visibility:"visible"}}},h))});k(this,"hide",t=>{var a;if(!t){(a=this.tooltipElement)==null||a.hide();return}if(!this.tooltipElement||!this.isEnable(t))return;const{client:{x:r,y:i}}=t;this.tooltipElement.hide(r,i)});k(this,"initTooltip",()=>{var x;const{canvas:t}=this.context,{center:r}=t.getBounds(),i=t.getContainer(),{top:a,left:o}=i.getBoundingClientRect(),{style:s,position:l,enterable:c,container:u={x:-o,y:-a},title:h,offset:f}=this.options,[d,p]=r,[v,g]=t.getSize(),m=new p9({className:"tooltip",style:{x:d,y:p,container:u,title:h,bounding:{x:0,y:0,width:v,height:g},position:l,enterable:c,offset:f,style:s}});return(x=this.container)==null||x.appendChild(m.HTMLTooltipElement),m});this.render(),this.bindEvents()}getEvents(){return this.options.trigger==="click"?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerenter":this.onPointerEnter,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerenter":this.onPointerEnter,"edge:pointermove":this.onPointerMove,"combo:pointerenter":this.onPointerEnter,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(t){var r;this.unbindEvents(),super.update(t),this.tooltipElement&&((r=this.container)==null||r.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){const{canvas:t}=this.context,r=t.getContainer();r&&(this.container=r,this.tooltipElement=this.initTooltip())}unbindEvents(){const{graph:t}=this.context,r=this.getEvents();Object.keys(r).forEach(i=>{t.off(i,r[i])})}bindEvents(){const{graph:t}=this.context,r=this.getEvents();Object.keys(r).forEach(i=>{t.on(i,r[i])})}destroy(){var t;this.unbindEvents(),this.tooltipElement&&((t=this.container)==null||t.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}};let Rf=rm;k(Rf,"defaultOptions",{trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}});let dl;function vw(n,e){return dl||(dl=document.createElement("canvas")),dl.width=n,dl.height=e,dl.getContext("2d").clearRect(0,0,n,e),dl}function v9(n,e,t,r){return Ct(this,null,function*(){const i=vw(n,e),a=i.getContext("2d"),{rotate:o,opacity:s,textFill:l,textFontSize:c,textFontFamily:u,textFontVariant:h,textFontWeight:f,textAlign:d,textBaseline:p}=r;return a.textAlign=d,a.textBaseline=p,a.translate(n/2,e/2),a.font=`${c}px ${u} ${h} ${f}`,o&&a.rotate(o),s&&(a.globalAlpha=s),l&&(a.fillStyle=l,a.fillText(`${t}`,0,0)),i.toDataURL()})}function g9(n,e,t,r){return Ct(this,null,function*(){const i=vw(n,e),a=i.getContext("2d"),{rotate:o,opacity:s}=r;o&&a.rotate(o),s&&(a.globalAlpha=s);const l=new Image;return l.crossOrigin="anonymous",l.src=t,new Promise(c=>{l.onload=function(){const u=n>l.width?(n-l.width)/2:0,h=e>l.height?(e-l.height)/2:0;a.drawImage(l,0,0,l.width,l.height,u,h,n-u*2,e-h*2),c(i.toDataURL())}})})}const Xf=class extends mr{constructor(t,r){super(t,Object.assign({},Xf.defaultOptions,r));k(this,"$element",ql("watermark"));this.context.canvas.getContainer().appendChild(this.$element),this.update(r)}update(t){return Ct(this,null,function*(){$f(Xf.prototype,this,"update").call(this,t);const c=this.options,{width:r,height:i,text:a,imageURL:o}=c,s=Ce(c,["width","height","text","imageURL"]);Object.keys(s).forEach(u=>{u.startsWith("background")&&(this.$element.style[u]=t[u])});const l=o?yield g9(r,i,o,s):yield v9(r,i,a,s);this.$element.style.backgroundImage=`url(${l})`})}destroy(){super.destroy(),this.$element.remove()}};let kf=Xf;k(kf,"defaultOptions",{width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"});const m9=["#7E92B5","#F4664A","#FFBE3A"],y9={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},x9={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function gw(n){const{bgColor:e,textColor:t,nodeColor:r,nodeColorDisabled:i,nodeStroke:a,nodeHaloStrokeOpacityActive:o=.15,nodeHaloStrokeOpacitySelected:s=.25,nodeOpacityDisabled:l=.06,nodeIconOpacityInactive:c=.85,nodeOpacityInactive:u=.25,nodeBadgePalette:h=m9,nodePaletteOptions:f=y9,edgeColor:d,edgeColorDisabled:p,edgePaletteOptions:v=x9,comboColor:g,comboColorDisabled:m,comboStroke:x,comboStrokeDisabled:S,edgeColorInactive:T}=n;return{background:e,node:{palette:f,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:h,fill:r,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:t,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:r,portLineWidth:1,portStroke:a,portStrokeOpacity:.65,size:32,stroke:a,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:s,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:a},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:o},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:a,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:u,donutOpacity:u,fillOpacity:u,iconOpacity:c,labelFill:t,labelFillOpacity:u,strokeOpacity:u},disabled:{badgeBackgroundOpacity:.25,donutOpacity:l,fill:i,fillOpacity:l,iconFill:i,iconOpacity:.25,labelFill:t,labelFillOpacity:.25,strokeOpacity:l}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:v,style:{badgeBackgroundFill:d,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:t,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:d,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:T,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:p,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:g,halo:!1,haloLineWidth:12,haloStroke:x,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:t,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:x},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:m,fillOpacity:.25,labelOpacity:.25,stroke:S,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}const b9=gw({bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:{type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"}),E9=gw({bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"});class pl extends mp{beforeDraw(e,t){return e}}class w9 extends pl{beforeDraw(e){const{model:t}=this.context,r=e.add.combos,i=a=>{const o=[];return a.forEach((s,l)=>{const u=t.getAncestorsData(l,"combo").map(h=>it(h)).reverse();o.push([l,s,u.length])}),new Map(o.sort(([,,s],[,,l])=>l-s).map(([s,l])=>[s,l]))};return e.add.combos=i(r),e.update.combos=i(e.update.combos),e}}function mo(n,e,t,r,i){const a=it(r),o=`${t}s`,s=i?r:n.add[o].get(a)||n.update[o].get(a)||n.remove[o].get(a)||r;Object.entries(n).forEach(([l,c])=>{e===l?c[o].set(a,s):c[o].delete(a)})}class S9 extends pl{beforeDraw(e,t){if(t.stage==="visibility")return e;const{model:r}=this.context,{add:i,update:a}=e,o=[...e.update.combos.entries(),...e.add.combos.entries()];for(;o.length;){const[s,l]=o.pop();if(ri(l)){const c=r.getDescendantsData(s),u=c.map(it),{internal:h,external:f}=X1(u,d=>r.getRelatedEdgesData(d));c.forEach(d=>{const p=it(d),v=o.findIndex(([m])=>m===p);v!==-1&&o.splice(v,1);const g=r.getElementType(p);mo(e,"remove",g,d)}),h.forEach(d=>mo(e,"remove","edge",d)),f.forEach(d=>{var g;const p=it(d);((g=this.context.element)==null?void 0:g.getElement(p))?a.edges.set(p,d):i.edges.set(p,d)})}else{const c=r.getChildrenData(s),u=c.map(it),{edges:h}=X1(u,f=>r.getRelatedEdgesData(f));[...c,...h].forEach(f=>{var g;const d=it(f),p=r.getElementType(d);((g=this.context.element)==null?void 0:g.getElement(d))?mo(e,"update",p,f):mo(e,"add",p,f),p==="combo"&&o.push([d,f])})}}return e}}const mw=(n,e,t,r)=>{const i=`${t}s`,a=it(r);!n.add[i].has(a)&&!n.update[i].has(a)&&n[e][i].set(it(r),r)};class _9 extends pl{getElement(e){return this.context.element.getElement(e)}handleExpand(e,t){if(mw(t,"add","node",e),ri(e))return;const r=it(e);mw(t,"add","node",e),this.context.model.getRelatedEdgesData(r,"out").forEach(o=>{mo(t,"add","edge",o)}),this.context.model.getChildrenData(r).forEach(o=>{this.handleExpand(o,t)})}beforeDraw(e){const{graph:t,model:r}=this.context,{add:{nodes:i,edges:a},update:{nodes:o}}=e,s=new Map,l=new Map;i.forEach((u,h)=>{ri(u)&&s.set(h,u)}),a.forEach(u=>{if(t.getElementType(u.source)!=="node")return;const h=t.getNodeData(u.source);ri(h)&&s.set(u.source,h)}),o.forEach((u,h)=>{const f=this.getElement(h);if(!f)return;const d=f.attributes.collapsed;ri(u)?d||s.set(h,u):d&&l.set(h,u)});const c=new Set;return s.forEach((u,h)=>{r.getDescendantsData(h).forEach(d=>{const p=it(d);if(c.has(p))return;mo(e,"remove","node",d),r.getRelatedEdgesData(p).forEach(g=>{mo(e,"remove","edge",g)}),c.add(p)})}),l.forEach((u,h)=>{if(r.getAncestorsData(h,$a).some(ri)){mo(e,"remove","node",u);return}this.handleExpand(u,e)}),e}}function yw(n,e,t,r=!1){const i=hp[n][e];!r&&i?i!==t&&Lr.warn(`The extension ${e} of ${n} has been registered before.`):Object.assign(hp[n],{[e]:t})}class Lf{constructor(e){k(this,"type");this.type=e}}class Gn extends Lf{constructor(t,r){super(t);k(this,"data");this.data=r}}class Gi extends Lf{constructor(t,r,i,a){super(t);k(this,"animationType");k(this,"animation");k(this,"data");this.animationType=r,this.animation=i,this.data=a}}class vl extends Lf{constructor(t,r,i){super(t);k(this,"elementType");k(this,"data");this.elementType=r,this.data=i}}class If extends Lf{constructor(t,r){super(t);k(this,"data");this.data=r}}function qn(n,e){n.emit(e.type,e)}function T9(n){if(!n)return null;if(n instanceof Ly)return{type:"canvas",element:n};let e=n;for(;e;){if($l(e))return{type:"node",element:e};if(Q1(e))return{type:"edge",element:e};if(Fp(e))return{type:"combo",element:e};e=e.parentElement}return null}class P9{constructor(e){k(this,"context");k(this,"tasks",[]);k(this,"animations",new Set);this.context=e}getTasks(){const e=[...this.tasks];return this.tasks=[],e}add(e,t){this.tasks.push([e,t])}animate(e,t,r){var o,s,l;(o=t==null?void 0:t.before)==null||o.call(t);const i=this.getTasks().map(([c,u])=>{var g,m,x;const{element:h,elementType:f,stage:d}=c,p=sO(this.context.options,f,d,e);(g=u==null?void 0:u.before)==null||g.call(u);const v=fO(h,this.inferStyle(c,r),p);return v?((m=u==null?void 0:u.beforeAnimate)==null||m.call(u,v),v.finished.then(()=>{var S,T;(S=u==null?void 0:u.afterAnimate)==null||S.call(u,v),(T=u==null?void 0:u.after)==null||T.call(u),this.animations.delete(v)})):(x=u==null?void 0:u.after)==null||x.call(u),v}).filter(Boolean);i.forEach(c=>this.animations.add(c));const a=fp(i);return a?((s=t==null?void 0:t.beforeAnimate)==null||s.call(t,a),a.finished.then(()=>{var c,u;(c=t==null?void 0:t.afterAnimate)==null||c.call(t,a),(u=t==null?void 0:t.after)==null||u.call(t),this.release()})):(l=t==null?void 0:t.after)==null||l.call(t),a}inferStyle(e,t){const{element:r,elementType:i,stage:a,originalStyle:o,modifiedStyle:s}=e,l=at({},o),c=at({},s),u=()=>{var h;return(h=ku(r,"opacity"))!=null?h:Su("opacity")};if(a==="enter")Object.assign(l,{opacity:0});else if(a==="exit")Object.assign(c,{opacity:0});else if(a==="show")Object.assign(l,{opacity:0}),Object.assign(c,{opacity:u()});else if(a==="hide")Object.assign(l,{opacity:u()}),Object.assign(c,{opacity:0});else if(a==="collapse"){const{collapse:h}=t||{},{target:f,descendants:d,position:p}=h;if(i==="node"){if(d.includes(r.id)){const[v,g,m]=p;Object.assign(c,{x:v,y:g,z:m})}}else if(i==="combo"){if(r.id===f||d.includes(r.id)){const[v,g]=p;Object.assign(c,{x:v,y:g,childrenNode:l.childrenNode})}}else i==="edge"&&Object.assign(c,{sourceNode:l.sourceNode,targetNode:l.targetNode})}else if(a==="expand"){const{expand:h}=t||{},{target:f,descendants:d,position:p}=h;if(i==="node"){if(r.id===f||d.includes(r.id)){const[v,g,m]=p;Object.assign(l,{x:v,y:g,z:m})}}else if(i==="combo"){if(r.id===f||d.includes(r.id)){const[v,g,m]=p;Object.assign(l,{x:v,y:g,z:m,childrenNode:c.childrenNode})}}else i==="edge"&&Object.assign(l,{sourceNode:c.sourceNode,targetNode:c.targetNode})}return[l,c]}stop(){this.animations.forEach(e=>e.cancel())}clear(){this.tasks=[]}release(){var r,i;const{canvas:e}=this.context,t=(i=(r=e.document)==null?void 0:r.timeline)==null?void 0:i.animationsWithPromises;t&&(e.document.timeline.animationsWithPromises=t.filter(a=>a.playState!=="finished"))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class M9{constructor(e){k(this,"context");k(this,"batchCount",0);this.context=e}emit(e){const{graph:t}=this.context;t.emit(e.type,e)}startBatch(e=!0){this.batchCount++,this.batchCount===1&&this.emit(new Gn(Mt.BATCH_START,{initiate:e}))}endBatch(){this.batchCount--,this.batchCount===0&&this.emit(new Gn(Mt.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class C9 extends gp{constructor(t){super(t);k(this,"currentTarget",null);k(this,"currentTargetType",null);k(this,"category","behavior");k(this,"forwardCanvasEvents",t=>{const{target:r}=t,i=T9(r);if(!i)return;const{graph:a,canvas:o}=this.context,{type:s,element:l}=i;if("destroyed"in l&&(Vp(l)||l.destroyed))return;const{type:c,detail:u,button:h}=t,f=_e(at({},t),{target:l,targetType:s,originalTarget:r});c===ht.POINTER_MOVE&&(this.currentTarget!==l&&(this.currentTarget&&a.emit(`${this.currentTargetType}:${ht.POINTER_LEAVE}`,_e(at({},f),{type:ht.POINTER_LEAVE,target:this.currentTarget})),l&&(Object.assign(f,{type:ht.POINTER_ENTER}),a.emit(`${s}:${ht.POINTER_ENTER}`,f))),this.currentTarget=l,this.currentTargetType=s),c===ht.CLICK&&h===2||(a.emit(`${s}:${c}`,f),a.emit(c,f)),c===ht.CLICK&&u===2&&(Object.assign(f,{type:ht.DBLCLICK}),a.emit(`${s}:${ht.DBLCLICK}`,f),a.emit(ht.DBLCLICK,f)),c===ht.POINTER_DOWN&&h===2&&(Object.assign(f,{type:ht.CONTEXT_MENU,preventDefault:()=>{var d;(d=o.getContainer())==null||d.addEventListener(ht.CONTEXT_MENU,p=>p.preventDefault(),{once:!0})}}),a.emit(`${s}:${ht.CONTEXT_MENU}`,f),a.emit(ht.CONTEXT_MENU,f))});k(this,"forwardContainerEvents",t=>{this.context.graph.emit(t.type,t)});this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(t){this.setExtensions(t)}forwardEvents(){const t=this.context.canvas.getContainer();t&&[_s.KEY_DOWN,_s.KEY_UP].forEach(i=>{t.addEventListener(i,this.forwardContainerEvents)});const r=this.context.canvas.document;r&&[ht.CLICK,ht.DBLCLICK,ht.POINTER_OVER,ht.POINTER_LEAVE,ht.POINTER_ENTER,ht.POINTER_MOVE,ht.POINTER_OUT,ht.POINTER_DOWN,ht.POINTER_UP,ht.CONTEXT_MENU,ht.DRAG_START,ht.DRAG,ht.DRAG_END,ht.DRAG_ENTER,ht.DRAG_OVER,ht.DRAG_LEAVE,ht.DROP,ht.WHEEL].forEach(i=>{r.addEventListener(i,this.forwardCanvasEvents)})}destroy(){const t=this.context.canvas.getContainer();t&&[_s.KEY_DOWN,_s.KEY_UP].forEach(r=>{t.removeEventListener(r,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}var O9=function(){function n(e){this.dragndropPluginOptions=e}return n.prototype.apply=function(e){var t=this,r=e.renderingService,i=e.renderingContext,a=i.root.ownerDocument,o=a.defaultView,s=function(l){var c=l.target,u=c===a,h=u&&t.dragndropPluginOptions.isDocumentDraggable?a:c.closest&&c.closest("[draggable=true]");if(h){var f=!1,d=l.timeStamp,p=[l.clientX,l.clientY],v=null,g=[l.clientX,l.clientY],m=function(S){return j(t,void 0,void 0,function(){var T,b,y,E,w,C;return mt(this,function(M){switch(M.label){case 0:if(!f){if(T=S.timeStamp-d,b=Pr([S.clientX,S.clientY],p),T<=this.dragndropPluginOptions.dragstartTimeThreshold||b<=this.dragndropPluginOptions.dragstartDistanceThreshold)return[2];S.type="dragstart",h.dispatchEvent(S),f=!0}return S.type="drag",S.dx=S.clientX-g[0],S.dy=S.clientY-g[1],h.dispatchEvent(S),g=[S.clientX,S.clientY],u?[3,2]:(y=this.dragndropPluginOptions.overlap==="pointer"?[S.canvasX,S.canvasY]:c.getBounds().center,[4,a.elementsFromPoint(y[0],y[1])]);case 1:E=M.sent(),w=E[E.indexOf(c)+1],C=(w==null?void 0:w.closest("[droppable=true]"))||(this.dragndropPluginOptions.isDocumentDroppable?a:null),v!==C&&(v&&(S.type="dragleave",S.target=v,v.dispatchEvent(S)),C&&(S.type="dragenter",S.target=C,C.dispatchEvent(S)),v=C,v&&(S.type="dragover",S.target=v,v.dispatchEvent(S))),M.label=2;case 2:return[2]}})})};o.addEventListener("pointermove",m);var x=function(S){if(f){S.detail={preventClick:!0};var T=S.clone();v&&(T.type="drop",T.target=v,v.dispatchEvent(T)),T.type="dragend",h.dispatchEvent(T),f=!1}o.removeEventListener("pointermove",m)};c.addEventListener("pointerup",x,{once:!0}),c.addEventListener("pointerupoutside",x,{once:!0})}};r.hooks.init.tap(n.tag,function(){o.addEventListener("pointerdown",s)}),r.hooks.destroy.tap(n.tag,function(){o.removeEventListener("pointerdown",s)})},n.tag="Dragndrop",n}(),A9=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=n.call(this)||this;return r.options=t,r.name="dragndrop",r}return e.prototype.init=function(){this.addRenderingPlugin(new O9(N({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e.prototype.setOptions=function(t){Object.assign(this.plugins[0].dragndropPluginOptions,t)},e}(No);const xw=["background","main","label","transient"];class bw{constructor(e){k(this,"extends");k(this,"config");this.config=e;const l=e,{renderer:t,background:r,cursor:i}=l,a=Ce(l,["renderer","background","cursor"]),o=Ew(t),s=Object.fromEntries(xw.map(c=>{const u=new iu(_e(at({},a),{supportsMutipleCanvasesInOneContainer:!0,renderer:o[c],background:c==="background"?r:void 0}));return[c,u]}));ww(s),this.extends={config:e,renderer:t,renderers:o,layers:s}}getConfig(){return this.config}getLayer(e="main"){return this.extends.layers[e]}getLayers(){return this.extends.layers}getRenderer(e){return this.extends.renderers[e]}getCamera(e="main"){return this.getLayer(e).getCamera()}getRoot(e="main"){return this.getLayer(e).getRoot()}getContextService(e="main"){return this.getLayer(e).getContextService()}setCursor(e){this.config.cursor=e,this.getLayer().setCursor(e)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,e])=>e.ready))}resize(e,t){Object.assign(this.extends.config,{width:e,height:t}),Object.values(this.getLayers()).forEach(r=>{const i=r.getCamera(),a=i.getPosition(),o=i.getFocalPoint();r.resize(e,t),i.setPosition(a),i.setFocalPoint(o)})}getBounds(e){return Il(Object.values(this.getLayers()).map(t=>e?t.getRoot().childNodes.find(i=>i.classList.includes(e)):t.getRoot()).filter(t=>(t==null?void 0:t.childNodes.length)>0).map(t=>t.getBounds()))}getContainer(){const e=this.extends.config.container;return typeof e=="string"?document.getElementById(e):e}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(e,t){var i;const r=((i=e.style)==null?void 0:i.$layer)||"main";return this.getLayer(r).appendChild(e,t)}setRenderer(e){if(e===this.extends.renderer)return;const t=Ew(e);this.extends.renderers=t,Object.entries(t).forEach(([r,i])=>this.getLayer(r).setRenderer(i)),ww(this.getLayers())}getCanvasByViewport(e){return Ir(this.getLayer().viewport2Canvas(Fo(e)))}getViewportByCanvas(e){return Ir(this.getLayer().canvas2Viewport(Fo(e)))}getViewportByClient(e){return Ir(this.getLayer().client2Viewport(Fo(e)))}getClientByViewport(e){return Ir(this.getLayer().viewport2Client(Fo(e)))}getClientByCanvas(e){return this.getClientByViewport(this.getViewportByCanvas(e))}getCanvasByClient(e){const t=this.getLayer(),r=t.client2Viewport(Fo(e));return Ir(t.viewport2Canvas(r))}toDataURL(){return Ct(this,arguments,function*(e={}){const t=window.devicePixelRatio||1,m=e,{mode:r="viewport"}=m,i=Ce(m,["mode"]);let[a,o,s,l]=[0,0,0,0];if(r==="viewport")[s,l]=this.getSize();else if(r==="overall"){const x=this.getBounds(),S=Ka(x);[a,o]=x.min,[s,l]=S}const c=cg('<div id="virtual-image"></div>'),u=new iu({width:s,height:l,renderer:new mf,devicePixelRatio:t,container:c,background:this.extends.config.background});yield u.ready,u.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),u.appendChild(this.getRoot().cloneNode(!0));const h=this.getLayer("label").getRoot().cloneNode(!0),f=u.viewport2Canvas({x:0,y:0}),d=this.getCanvasByViewport([0,0]);h.translate([d[0]-f.x,d[1]-f.y]),h.scale(1/this.getCamera().getZoom()),u.appendChild(h),u.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));const p=this.getCamera(),v=u.getCamera();if(r==="viewport")v.setZoom(p.getZoom()),v.setPosition(p.getPosition()),v.setFocalPoint(p.getFocalPoint());else if(r==="overall"){const[x,S,T]=v.getPosition(),[b,y,E]=v.getFocalPoint();v.setPosition([x+a,S+o,T]),v.setFocalPoint([b+a,y+o,E])}const g=u.getContextService();return new Promise(x=>{u.addEventListener(ni.RERENDER,()=>Ct(this,null,function*(){yield new Promise(T=>setTimeout(T,300));const S=yield g.toDataURL(i);x(S)}))})})}destroy(){Object.values(this.getLayers()).forEach(e=>{e.getCamera().cancelLandmarkAnimation(),e.destroy()})}}function Ew(n){return Object.fromEntries(xw.map(e=>{const t=(n==null?void 0:n(e))||new mf;return e==="main"?t.registerPlugin(new A9({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):t.unregisterPlugin(t.getPlugin("dom-interaction")),[e,t]}))}function ww(n){Object.entries(n).forEach(([e,t])=>{const r=t.getContextService().getDomElement();r.style.position="absolute",r.style.outline="none",r.tabIndex=1,e!=="main"&&(r.style.pointerEvents="none")})}function N9(n,e){e===void 0&&(e=new Map);var t=[];if(Array.isArray(n))for(var r=0,i=n.length;r<i;r++){var a=n[r];e.has(a)||(t.push(a),e.set(a,!0))}return t}function yo(n,e){const c=n,{data:t,style:r}=c,i=Ce(c,["data","style"]),u=e,{data:a,style:o}=u,s=Ce(u,["data","style"]),l=at(at({},i),s);return(t||a)&&Object.assign(l,{data:at(at({},t),a)}),(r||o)&&Object.assign(l,{style:at(at({},r),o)}),l}function hg(n){const a=n,{data:e,style:t}=a,i=Ce(a,["data","style"]);return e&&(i.data=at({},e)),t&&(i.style=at({},t)),i}function CU(n){return!get(n,["nodes","length"])&&!get(n,["edges","length"])&&!get(n,["combos","length"])}function fg(n){const o=n,{id:e=it(n),style:t,data:r}=o,i=Ce(o,["id","style","data"]),a=_e(at({},n),{style:at({},t),data:at({},r)});return xO(n)?at({id:e,data:a},i):{id:e,data:a}}function Jn(n){return n.data}function R9(n){if(n.hasTreeStructure($a))return;n.attachTreeStructure($a);const e=n.getAllEdges();for(const t of e){const{source:r,target:i}=t;n.setParent(i,r,$a)}}class k9{constructor(){k(this,"model");k(this,"latestRemovedComboIds",new Set);k(this,"comboIds",new Set);k(this,"changes",[]);k(this,"batchCount",0);k(this,"isTraceless",!1);k(this,"enableUpdateNodeLikeHierarchy",!0);this.model=new Hp.k}pushChange(e){if(this.isTraceless)return;const{type:t}=e;if(t===Qe.NodeUpdated||t===Qe.EdgeUpdated||t===Qe.ComboUpdated){const{value:r,original:i}=e;this.changes.push({value:hg(r),original:hg(i),type:t})}else this.changes.push({value:hg(e.value),type:t})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(e){this.batchCount++,this.model.batch(e),this.batchCount--}silence(e){this.isTraceless=!0,e(),this.isTraceless=!1}isCombo(e){return this.comboIds.has(e)||this.latestRemovedComboIds.has(e)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(e){return this.model.getAllNodes().reduce((t,r)=>{const i=Jn(r);return this.isCombo(it(i))||(e===void 0||e.includes(it(i)))&&t.push(i),t},[])}getEdgeDatum(e){return Jn(this.model.getEdge(e))}getEdgeData(e){return this.model.getAllEdges().reduce((t,r)=>{const i=Jn(r);return(e===void 0||e.includes(it(i)))&&t.push(i),t},[])}getComboData(e){return this.model.getAllNodes().reduce((t,r)=>{const i=Jn(r);return this.isCombo(it(i))&&(e===void 0||e.includes(it(i)))&&t.push(i),t},[])}getAncestorsData(e,t){const{model:r}=this;return!r.hasNode(e)||!r.hasTreeStructure(t)?[]:r.getAncestors(e,t).map(Jn)}getDescendantsData(e){const t=this.getElementDataById(e),r=[];return Rs(t,i=>{i!==t&&r.push(i)},i=>this.getChildrenData(it(i)),"TB"),r}getParentData(e,t){const{model:r}=this;if(!t){Lr.warn("The hierarchy structure key is not specified");return}if(!r.hasNode(e)||!r.hasTreeStructure(t))return;const i=r.getParent(e,t);return i?Jn(i):void 0}getChildrenData(e){const t=this.getElementType(e)==="node"?$a:tn,{model:r}=this;return!r.hasNode(e)||!r.hasTreeStructure(t)?[]:r.getChildren(e,t).map(Jn)}getElementsDataByType(e){return e==="node"?this.getNodeData():e==="edge"?this.getEdgeData():e==="combo"?this.getComboData():[]}getElementDataById(e){return this.getElementType(e)==="edge"?this.getEdgeDatum(e):this.getNodeLikeDatum(e)}getNodeLikeDatum(e){const t=this.model.getNode(e);return Jn(t)}getNodeLikeData(e){return this.model.getAllNodes().reduce((t,r)=>{const i=Jn(r);return e?e.includes(it(i))&&t.push(i):t.push(i),t},[])}getElementDataByState(e,t){return this.getElementsDataByType(e).filter(i=>{var a;return(a=i.states)==null?void 0:a.includes(t)})}getElementState(e){var t;return((t=this.getElementDataById(e))==null?void 0:t.states)||[]}hasNode(e){return this.model.hasNode(e)&&!this.isCombo(e)}hasEdge(e){return this.model.hasEdge(e)}hasCombo(e){return this.model.hasNode(e)&&this.isCombo(e)}getRelatedEdgesData(e,t="both"){return this.model.getRelatedEdges(e,t).map(Jn)}getNeighborNodesData(e){return this.model.getNeighbors(e).map(Jn)}setData(e){const{nodes:t=[],edges:r=[],combos:i=[]}=e,{nodes:a,edges:o,combos:s}=this.getData(),l=Ms(a,t,h=>it(h)),c=Ms(o,r,h=>it(h)),u=Ms(s,i,h=>it(h));this.batch(()=>{this.addData({nodes:l.enter,edges:c.enter,combos:u.enter}),this.updateData({nodes:l.update,edges:c.update,combos:u.update}),this.removeData({nodes:l.exit.map(it),edges:c.exit.map(it),combos:u.exit.map(it)})})}addData(e){const{nodes:t,edges:r,combos:i}=e;this.batch(()=>{this.addComboData(i),this.addNodeData(t),this.addEdgeData(r)})}addNodeData(e=[]){e.length&&(this.model.addNodes(e.map(t=>(this.pushChange({value:t,type:Qe.NodeAdded}),fg(t)))),this.updateNodeLikeHierarchy(e))}addEdgeData(e=[]){e.length&&this.model.addEdges(e.map(t=>(this.pushChange({value:t,type:Qe.EdgeAdded}),fg(t))))}addComboData(e=[]){if(!e.length)return;const{model:t}=this;t.hasTreeStructure(tn)||t.attachTreeStructure(tn),t.addNodes(e.map(r=>(this.comboIds.add(it(r)),this.pushChange({value:r,type:Qe.ComboAdded}),fg(r)))),this.updateNodeLikeHierarchy(e)}addChildrenData(e,t){const r=this.getNodeLikeDatum(e),i=t.map(it);this.addNodeData(t),this.updateNodeData([{id:e,children:[...r.children||[],...i]}]),this.addEdgeData(i.map(a=>({source:e,target:a})))}updateNodeLikeHierarchy(e){if(!this.enableUpdateNodeLikeHierarchy)return;const{model:t}=this;e.forEach(r=>{const i=it(r);t.attachTreeStructure(tn),this.setParent(i,pp(r),tn);const a=r.children;if(a!==void 0){t.attachTreeStructure($a);const o=a.filter(s=>t.hasNode(s));o.forEach(s=>this.setParent(s,i,$a)),o.length!==a.length&&this.updateNodeData([{id:i,children:o}])}})}preventUpdateNodeLikeHierarchy(e){this.enableUpdateNodeLikeHierarchy=!1,e(),this.enableUpdateNodeLikeHierarchy=!0}updateData(e){const{nodes:t,edges:r,combos:i}=e;this.batch(()=>{this.updateNodeData(t),this.updateComboData(i),this.updateEdgeData(r)})}updateNodeData(e=[]){if(!e.length)return;const{model:t}=this;this.batch(()=>{const r=[];e.forEach(i=>{const a=it(i),o=Jn(t.getNode(a));if(un(o,i))return;const s=yo(o,i);this.pushChange({value:s,original:o,type:Qe.NodeUpdated}),t.mergeNodeData(a,s),r.push(s)}),this.updateNodeLikeHierarchy(r)})}refreshData(){const{nodes:e,edges:t,combos:r}=this.getData();e.forEach(i=>{this.pushChange({value:i,original:i,type:Qe.NodeUpdated})}),t.forEach(i=>{this.pushChange({value:i,original:i,type:Qe.EdgeUpdated})}),r.forEach(i=>{this.pushChange({value:i,original:i,type:Qe.ComboUpdated})})}syncNodeDatum(e){const{model:t}=this,r=it(e),i=Jn(t.getNode(r)),a=yo(i,e);t.mergeNodeData(r,a)}updateEdgeData(e=[]){if(!e.length)return;const{model:t}=this;this.batch(()=>{e.forEach(r=>{const i=it(r),a=Jn(t.getEdge(i));if(un(a,r))return;r.source&&a.source!==r.source&&t.updateEdgeSource(i,r.source),r.target&&a.target!==r.target&&t.updateEdgeTarget(i,r.target);const o=yo(a,r);this.pushChange({value:o,original:a,type:Qe.EdgeUpdated}),t.mergeEdgeData(i,o)})})}updateComboData(e=[]){if(!e.length)return;const{model:t}=this;t.batch(()=>{const r=[];e.forEach(i=>{const a=it(i),o=Jn(t.getNode(a));if(un(o,i))return;const s=yo(o,i);this.pushChange({value:s,original:o,type:Qe.ComboUpdated}),t.mergeNodeData(a,s),r.push(s)}),this.updateNodeLikeHierarchy(r)})}setParent(e,t,r,i=!0){if(e===t)return;const a=pp(this.getNodeLikeDatum(e));if(a!==t&&r===tn){const o={id:e,combo:t};this.isCombo(e)?this.syncComboDatum(o):this.syncNodeDatum(o)}this.model.setParent(e,t,r),i&&r===tn&&N9([a,t]).forEach(o=>{o!==void 0&&this.refreshComboData(o)})}refreshComboData(e){const t=this.getComboData([e])[0],r=this.getAncestorsData(e,tn);t&&this.pushChange({value:t,original:t,type:Qe.ComboUpdated}),r.forEach(i=>{this.pushChange({value:i,original:i,type:Qe.ComboUpdated})})}syncComboDatum(e){const{model:t}=this,r=it(e);if(!t.hasNode(r))return;const i=Jn(t.getNode(r)),a=yo(i,e);t.mergeNodeData(r,a)}getElementPosition(e){const t=this.getElementDataById(e);return Ui(t)}translateNodeLikeBy(e,t){this.isCombo(e)?this.translateComboBy(e,t):this.translateNodeBy(e,t)}translateNodeLikeTo(e,t){this.isCombo(e)?this.translateComboTo(e,t):this.translateNodeTo(e,t)}translateNodeBy(e,t){const r=this.getElementPosition(e),i=ge(r,[...t,0].slice(0,3));this.translateNodeTo(e,i)}translateNodeTo(e,t){const[r=0,i=0,a=0]=t;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:e,style:{x:r,y:i,z:a}}])})}translateComboBy(e,t){const[r=0,i=0,a=0]=t;if([r,i,a].some(isNaN)||[r,i,a].every(s=>s===0))return;const o=this.getComboData([e])[0];o&&Rs(o,s=>{const l=it(s),[c,u,h]=Ui(s),f=yo(s,{style:{x:c+r,y:u+i,z:h+a}});this.pushChange({value:f,original:s,type:this.isCombo(l)?Qe.ComboUpdated:Qe.NodeUpdated}),this.model.mergeNodeData(l,f)},s=>this.getChildrenData(it(s)),"BT")}translateComboTo(e,t){var d;if(t.some(isNaN))return;const[r=0,i=0,a=0]=t,o=(d=this.getComboData([e]))==null?void 0:d[0];if(!o)return;const[s,l,c]=Ui(o),u=r-s,h=i-l,f=a-c;Rs(o,p=>{const v=it(p),[g,m,x]=Ui(p),S=yo(p,{style:{x:g+u,y:m+h,z:x+f}});this.pushChange({value:S,original:p,type:this.isCombo(v)?Qe.ComboUpdated:Qe.NodeUpdated}),this.model.mergeNodeData(v,S)},p=>this.getChildrenData(it(p)),"BT")}removeData(e){const{nodes:t,edges:r,combos:i}=e;this.batch(()=>{this.removeEdgeData(r),this.removeNodeData(t),this.removeComboData(i),this.latestRemovedComboIds=new Set(i)})}removeNodeData(e=[]){e.length&&this.batch(()=>{e.forEach(t=>{this.removeEdgeData(this.getRelatedEdgesData(t).map(it)),this.pushChange({value:this.getNodeData([t])[0],type:Qe.NodeRemoved}),this.removeNodeLikeHierarchy(t)}),this.model.removeNodes(e)})}removeEdgeData(e=[]){e.length&&(e.forEach(t=>this.pushChange({value:this.getEdgeData([t])[0],type:Qe.EdgeRemoved})),this.model.removeEdges(e))}removeComboData(e=[]){e.length&&this.batch(()=>{e.forEach(t=>{this.pushChange({value:this.getComboData([t])[0],type:Qe.ComboRemoved}),this.removeNodeLikeHierarchy(t),this.comboIds.delete(t)}),this.model.removeNodes(e)})}removeNodeLikeHierarchy(e){if(this.model.hasTreeStructure(tn)){const t=pp(this.getNodeLikeDatum(e));this.setParent(e,void 0,tn,!1),this.model.getChildren(e,tn).forEach(r=>{const i=Jn(r),a=it(i);this.setParent(it(i),t,tn,!1);const o=yo(i,{id:it(i),combo:t});this.pushChange({value:o,original:i,type:this.isCombo(a)?Qe.ComboUpdated:Qe.NodeUpdated}),this.model.mergeNodeData(it(i),o)}),yt(t)||this.refreshComboData(t)}}getElementType(e){if(this.model.hasNode(e))return this.isCombo(e)?"combo":"node";if(this.model.hasEdge(e))return"edge";throw new Error(Ea(`Unknown element type of id: ${e}`))}destroy(){const{model:e}=this,t=e.getAllNodes(),r=e.getAllEdges();e.removeEdges(r.map(i=>i.id)),e.removeNodes(t.map(i=>i.id)),this.context={}}}class L9{constructor(e){k(this,"context");k(this,"container");k(this,"elementMap",{});k(this,"shapeTypeMap",{});k(this,"paletteStyle",{});k(this,"defaultStyle",{});k(this,"stateStyle",{});k(this,"visibilityCache",new WeakMap);this.context=e}init(){if(!this.container){const{canvas:e}=this.context;this.container=e.appendChild(new Ol({className:"elements"}))}}emit(e,t){t.silence||qn(this.context.graph,e)}forEachElementData(e){Go.forEach(t=>{const r=this.context.model.getElementsDataByType(t);e(t,r)})}getElementType(e,t){var o;const{options:r,graph:i}=this.context,a=((o=r[e])==null?void 0:o.type)||t.type;return a?typeof a=="string"?a:a.call(i,t):e==="edge"?"line":"circle"}getTheme(e){return r1(this.context.options)[e]||{}}getThemeStyle(e){return this.getTheme(e).style||{}}getThemeStateStyle(e,t){const{state:r={}}=this.getTheme(e);return Object.assign({},...t.map(i=>r[i]||{}))}computePaletteStyle(){const{options:e}=this.context;this.paletteStyle={},this.forEachElementData((t,r)=>{var a,o;const i=Object.assign({},O1((a=this.getTheme(t))==null?void 0:a.palette),O1((o=e[t])==null?void 0:o.palette));i!=null&&i.field&&Object.assign(this.paletteStyle,HO(r,i))})}getPaletteStyle(e,t){const r=this.paletteStyle[t];return r?e==="edge"?{stroke:r}:{fill:r}:{}}computeElementDefaultStyle(e,t){var a;const{options:r}=this.context,i=((a=r[e])==null?void 0:a.style)||{};this.defaultStyle[it(t.datum)]=_1(i,t)}computeElementsDefaultStyle(e){const{graph:t}=this.context;this.forEachElementData((r,i)=>{const a=i.length;for(let o=0;o<a;o++){const s=i[o];(e===void 0||e.includes(it(s)))&&this.computeElementDefaultStyle(r,{datum:s,graph:t})}})}getDefaultStyle(e){return this.defaultStyle[e]||{}}getElementState(e){try{const{model:t}=this.context;return t.getElementState(e)}catch(t){return[]}}getElementStateStyle(e,t,r){var o,s;const{options:i}=this.context,a=((s=(o=i[e])==null?void 0:o.state)==null?void 0:s[t])||{};return _1(a,r)}computeElementStatesStyle(e,t,r){this.stateStyle[it(r.datum)]=Object.assign({},...t.map(i=>this.getElementStateStyle(e,i,r)))}computeElementsStatesStyle(e){const{graph:t}=this.context;this.forEachElementData((r,i)=>{const a=i.length;for(let o=0;o<a;o++){const s=i[o];if(e===void 0||e.includes(it(s))){const l=this.getElementState(it(s));this.computeElementStatesStyle(r,l,{datum:s,graph:t})}}})}getStateStyle(e){return this.stateStyle[e]||{}}computeStyle(e,t){e&&["translate","zIndex"].includes(e)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(t),this.computeElementsStatesStyle(t))}getElement(e){return this.elementMap[e]}getElementZIndex(e){var r;const t=this.getElement(e);return t&&(r=t.style.zIndex)!=null?r:0}getNodes(){return this.context.model.getNodeData().map(({id:e})=>this.elementMap[e])}getEdges(){return this.context.model.getEdgeData().map(e=>this.elementMap[it(e)])}getCombos(){return this.context.model.getComboData().map(({id:e})=>this.elementMap[e])}getElementComputedStyle(e,t){const r=it(t),i=this.getThemeStyle(e),a=this.getPaletteStyle(e,r),o=t.style||{},s=this.getDefaultStyle(r),l=this.getThemeStateStyle(e,this.getElementState(r)),c=this.getStateStyle(r),u=Object.assign({},i,a,o,s,l,c);if(e==="combo"){const h=this.context.model.getChildrenData(r),d=!!u.collapsed?[]:h.map(it).filter(p=>this.getElement(p));Object.assign(u,{childrenNode:d,childrenData:h})}return u}draw(e={animation:!0}){this.init();const t=this.computeChangesAndDrawData(e);if(!t)return null;const{dataChanges:r,drawData:i}=t;this.markDestroyElement(i),this.computeStyle(e.stage);const{add:a,update:o,remove:s}=i;this.destroyElements(s,e),this.createElements(a,e),this.updateElements(o,e);const{animation:l,silence:c}=e,{type:u="draw"}=e,h=u==="render";return this.context.animation.animate(l,c?{}:{before:()=>this.emit(new Gn(Mt.BEFORE_DRAW,{dataChanges:r,animation:l,render:h}),e),beforeAnimate:f=>this.emit(new Gi(Mt.BEFORE_ANIMATE,kr.DRAW,f,i),e),afterAnimate:f=>this.emit(new Gi(Mt.AFTER_ANIMATE,kr.DRAW,f,i),e),after:()=>this.emit(new Gn(Mt.AFTER_DRAW,{dataChanges:r,animation:l,render:h}),e)})}computeChangesAndDrawData(e){const{model:t}=this.context,r=t.getChanges(),i=Qp(r);if(i.length===0)return null;const{NodeAdded:a=[],NodeUpdated:o=[],NodeRemoved:s=[],EdgeAdded:l=[],EdgeUpdated:c=[],EdgeRemoved:u=[],ComboAdded:h=[],ComboUpdated:f=[],ComboRemoved:d=[]}=Mp(i,m=>m.type),p=m=>new Map(m.map(x=>{const S=x.value;return[it(S),S]})),v={add:{nodes:p(a),edges:p(l),combos:p(h)},update:{nodes:p(o),edges:p(c),combos:p(f)},remove:{nodes:p(s),edges:p(u),combos:p(d)}},g=this.transformData(v,e);return t.clearChanges(),{dataChanges:r,drawData:g}}transformData(e,t){const r=this.context.transform.getTransformInstance();return Object.values(r).reduce((i,a)=>a.beforeDraw(i,t),e)}createElement(e,t,r){var h;const i=it(t);if(this.getElement(i))return;const o=this.getElementType(e,t),s=this.getElementComputedStyle(e,t),l=ba(e,o);if(!l)return Lr.warn(`The element ${o} of ${e} is not registered.`);this.emit(new vl(Mt.BEFORE_ELEMENT_CREATE,e,t),r);const c=this.container.appendChild(new l({id:i,style:at({context:this.context},s)}));this.shapeTypeMap[i]=o,this.elementMap[i]=c;const{stage:u="enter"}=r;(h=this.context.animation)==null||h.add({element:c,elementType:e,stage:u,originalStyle:at({},c.attributes),modifiedStyle:at(at({},c.attributes),s)},{after:()=>{var f;this.emit(new vl(Mt.AFTER_ELEMENT_CREATE,e,t),r),(f=c.onCreate)==null||f.call(c)}})}createElements(e,t){const{nodes:r,edges:i,combos:a}=e;[["node",r],["combo",a],["edge",i]].forEach(([s,l])=>{l.forEach(c=>this.createElement(s,c,t))})}updateElement(e,t,r){var u;const i=it(t),a=this.getElement(i);if(!a)return()=>null;this.emit(new vl(Mt.BEFORE_ELEMENT_UPDATE,e,t),r);const o=this.getElementType(e,t),s=this.getElementComputedStyle(e,t);this.shapeTypeMap[i]!==o&&(a.destroy(),delete this.shapeTypeMap[i],delete this.elementMap[i],this.createElement(e,t,{animation:!1,silence:!0}));const{stage:l="update"}=r,c=l!=="visibility"?l:s.visibility==="hidden"?"hide":"show";c==="hide"&&delete s.visibility,(u=this.context.animation)==null||u.add({element:a,elementType:e,stage:c,originalStyle:at({},a.attributes),modifiedStyle:at(at({},a.attributes),s)},{before:()=>{const h=this.elementMap[i];l!=="collapse"&&Up(h,s),l==="visibility"&&(P1(h,"opacity")||T1(h,"opacity"),this.visibilityCache.set(h,c==="show"?"visible":"hidden"),c==="show"&&Vl(h,"visible"))},after:()=>{var f;const h=this.elementMap[i];l==="collapse"&&Up(h,s),c==="hide"&&Vl(h,this.visibilityCache.get(h)),this.emit(new vl(Mt.AFTER_ELEMENT_UPDATE,e,t),r),(f=h.onUpdate)==null||f.call(h)}})}updateElements(e,t){const{nodes:r,edges:i,combos:a}=e;[["node",r],["combo",a],["edge",i]].forEach(([s,l])=>{l.forEach(c=>this.updateElement(s,c,t))})}markDestroyElement(e){Object.values(e.remove).forEach(t=>{t.forEach(r=>{const i=it(r),a=this.getElement(i);a&&fN(a)})})}destroyElement(e,t,r){var s;const{stage:i="exit"}=r,a=it(t),o=this.elementMap[a];if(!o)return()=>null;this.emit(new vl(Mt.BEFORE_ELEMENT_DESTROY,e,t),r),(s=this.context.animation)==null||s.add({element:o,elementType:e,stage:i,originalStyle:at({},o.attributes),modifiedStyle:at({},o.attributes)},{after:()=>{var l;this.clearElement(a),o.destroy(),(l=o.onDestroy)==null||l.call(o),this.emit(new vl(Mt.AFTER_ELEMENT_DESTROY,e,t),r)}})}destroyElements(e,t){const{nodes:r,edges:i,combos:a}=e;[["combo",a],["edge",i],["node",r]].forEach(([s,l])=>{l.forEach(c=>this.destroyElement(s,c,t))})}clearElement(e){delete this.paletteStyle[e],delete this.defaultStyle[e],delete this.stateStyle[e],delete this.elementMap[e],delete this.shapeTypeMap[e]}collapseNode(e,t){return Ct(this,null,function*(){var f;const{model:r,layout:i}=this.context,a=this.computeChangesAndDrawData({stage:"collapse",animation:t});this.markDestroyElement(a.drawData);const o=yield i.simulate();r.updateData(o);const{drawData:s}=this.computeChangesAndDrawData({stage:"collapse",animation:t}),{add:l,remove:c,update:u}=s;this.markDestroyElement(s);const h={animation:t,stage:"collapse",data:s};this.destroyElements(c,h),this.createElements(l,h),this.updateElements(u,h),yield(f=this.context.animation.animate(t,{beforeAnimate:d=>this.emit(new Gi(Mt.BEFORE_ANIMATE,kr.COLLAPSE,d,s),h),afterAnimate:d=>this.emit(new Gi(Mt.AFTER_ANIMATE,kr.COLLAPSE,d,s),h)},{collapse:{target:e,descendants:Array.from(c.nodes).map(([,d])=>it(d)),position:Ui(u.nodes.get(e))}}))==null?void 0:f.finished})}expandNode(e,t){return Ct(this,null,function*(){var h;const{model:r,layout:i}=this.context;if(!r.getAncestorsData(e,tn).every(f=>ri(f)))return;const a=Ui(r.getNodeData([e])[0]),{drawData:{add:o}}=this.computeChangesAndDrawData({stage:"collapse",animation:t});this.createElements(o,{animation:!1,stage:"expand"}),this.context.animation.clear();const s=yield i.simulate();r.updateData(s),this.computeStyle("expand");const{drawData:l}=this.computeChangesAndDrawData({stage:"collapse",animation:t}),{update:c}=l,u={animation:t,stage:"expand",data:l};o.edges.forEach(f=>{const d=it(f);c.edges.has(d)||c.edges.set(d,f)}),this.updateElements(c,u),yield(h=this.context.animation.animate(t,{beforeAnimate:f=>this.emit(new Gi(Mt.BEFORE_ANIMATE,kr.EXPAND,f,l),u),afterAnimate:f=>this.emit(new Gi(Mt.AFTER_ANIMATE,kr.EXPAND,f,l),u)},{expand:{target:e,descendants:Array.from(o.nodes).map(([,f])=>it(f)),position:a}}))==null?void 0:h.finished})}collapseCombo(e,t){return Ct(this,null,function*(){var d;const{model:r,element:i}=this.context;if(r.getAncestorsData(e,tn).some(p=>ri(p)))return;const a=i.getElement(e),o=a.getComboPosition(_e(at({},a.attributes),{collapsed:!0})),{dataChanges:s,drawData:l}=this.computeChangesAndDrawData({stage:"collapse",animation:t});this.markDestroyElement(l);const{update:c,remove:u}=l,h={animation:t,stage:"collapse",data:l};this.destroyElements(u,h),this.updateElements(c,h);const f=p=>Array.from(p).map(([,v])=>it(v));yield(d=this.context.animation.animate(t,{before:()=>this.emit(new Gn(Mt.BEFORE_DRAW,{dataChanges:s,animation:t}),h),beforeAnimate:p=>this.emit(new Gi(Mt.BEFORE_ANIMATE,kr.COLLAPSE,p,l),h),afterAnimate:p=>this.emit(new Gi(Mt.AFTER_ANIMATE,kr.COLLAPSE,p,l),h),after:()=>this.emit(new Gn(Mt.AFTER_DRAW,{dataChanges:s,animation:t}),h)},{collapse:{target:e,descendants:[...f(u.nodes),...f(u.combos)],position:o}}))==null?void 0:d.finished})}expandCombo(e,t){return Ct(this,null,function*(){var h;const{model:r}=this.context,i=Ui(r.getComboData([e])[0]);this.computeStyle("expand");const{dataChanges:a,drawData:o}=this.computeChangesAndDrawData({stage:"expand",animation:t}),{add:s,update:l}=o,c={animation:t,stage:"expand",data:o};this.createElements(s,c),this.updateElements(l,c);const u=f=>Array.from(f).map(([,d])=>it(d));yield(h=this.context.animation.animate(t,{before:()=>this.emit(new Gn(Mt.BEFORE_DRAW,{dataChanges:a,animation:t}),c),beforeAnimate:f=>this.emit(new Gi(Mt.BEFORE_ANIMATE,kr.EXPAND,f,o),c),afterAnimate:f=>this.emit(new Gi(Mt.AFTER_ANIMATE,kr.EXPAND,f,o),c),after:()=>this.emit(new Gn(Mt.AFTER_DRAW,{dataChanges:a,animation:t}),c)},{expand:{target:e,descendants:[...u(s.nodes),...u(s.combos)],position:i}}))==null?void 0:h.finished})}getFrontZIndex(e){const{model:t}=this.context,r=t.getElementType(e),i=t.getElementDataById(e),a=t.getData();if(Object.assign(a,{[`${r}s`]:a[`${r}s`].filter(o=>it(o)!==e)}),r==="combo"&&!ri(i)){const o=t.getAncestorsData(e,tn).map(it);a.nodes=a.nodes.filter(s=>!o.includes(it(s))),a.combos=a.combos.filter(s=>!o.includes(it(s))),a.edges=a.edges.filter(({source:s,target:l})=>o.includes(s)&&o.includes(l))}return Math.max(0,...Object.values(a).flat().map(o=>{const s=it(o);return this.getElementZIndex(s)}))+1}destroy(){this.container.destroy(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={},this.context={}}}var Sw=D(97582),I9=D(38027);const _w=Symbol("Comlink.proxy"),D9=Symbol("Comlink.endpoint"),Tw=Symbol("Comlink.releaseProxy"),dg=Symbol("Comlink.finalizer"),Df=Symbol("Comlink.thrown"),Pw=n=>typeof n=="object"&&n!==null||typeof n=="function",B9={canHandle:n=>Pw(n)&&n[_w],serialize(n){const{port1:e,port2:t}=new MessageChannel;return Cw(n,e),[t,[t]]},deserialize(n){return n.start(),Aw(n)}},F9={canHandle:n=>Pw(n)&&Df in n,serialize({value:n}){let e;return n instanceof Error?e={isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:e={isError:!1,value:n},[e,[]]},deserialize(n){throw n.isError?Object.assign(new Error(n.value.message),n.value):n.value}},Mw=new Map([["proxy",B9],["throw",F9]]);function G9(n,e){for(const t of n)if(e===t||t==="*"||t instanceof RegExp&&t.test(e))return!0;return!1}function Cw(n,e=globalThis,t=["*"]){e.addEventListener("message",function r(i){if(!i||!i.data)return;if(!G9(t,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}const{id:a,type:o,path:s}=Object.assign({path:[]},i.data),l=(i.data.argumentList||[]).map(os);let c;try{const u=s.slice(0,-1).reduce((f,d)=>f[d],n),h=s.reduce((f,d)=>f[d],n);switch(o){case"GET":c=h;break;case"SET":u[s.slice(-1)[0]]=os(i.data.value),c=!0;break;case"APPLY":c=h.apply(u,l);break;case"CONSTRUCT":{const f=new h(...l);c=Y9(f)}break;case"ENDPOINT":{const{port1:f,port2:d}=new MessageChannel;Cw(n,d),c=H9(f,[f])}break;case"RELEASE":c=void 0;break;default:return}}catch(u){c={value:u,[Df]:0}}Promise.resolve(c).catch(u=>({value:u,[Df]:0})).then(u=>{const[h,f]=zf(u);e.postMessage(Object.assign(Object.assign({},h),{id:a}),f),o==="RELEASE"&&(e.removeEventListener("message",r),Ow(e),dg in n&&typeof n[dg]=="function"&&n[dg]())}).catch(u=>{const[h,f]=zf({value:new TypeError("Unserializable return value"),[Df]:0});e.postMessage(Object.assign(Object.assign({},h),{id:a}),f)})}),e.start&&e.start()}function z9(n){return n.constructor.name==="MessagePort"}function Ow(n){z9(n)&&n.close()}function Aw(n,e){return pg(n,[],e)}function Bf(n){if(n)throw new Error("Proxy has been released and is not useable")}function Nw(n){return gl(n,{type:"RELEASE"}).then(()=>{Ow(n)})}const Ff=new WeakMap,Gf="FinalizationRegistry"in globalThis&&new FinalizationRegistry(n=>{const e=(Ff.get(n)||0)-1;Ff.set(n,e),e===0&&Nw(n)});function W9(n,e){const t=(Ff.get(e)||0)+1;Ff.set(e,t),Gf&&Gf.register(n,e,n)}function U9(n){Gf&&Gf.unregister(n)}function pg(n,e=[],t=function(){}){let r=!1;const i=new Proxy(t,{get(a,o){if(Bf(r),o===Tw)return()=>{U9(i),Nw(n),r=!0};if(o==="then"){if(e.length===0)return{then:()=>i};const s=gl(n,{type:"GET",path:e.map(l=>l.toString())}).then(os);return s.then.bind(s)}return pg(n,[...e,o])},set(a,o,s){Bf(r);const[l,c]=zf(s);return gl(n,{type:"SET",path:[...e,o].map(u=>u.toString()),value:l},c).then(os)},apply(a,o,s){Bf(r);const l=e[e.length-1];if(l===D9)return gl(n,{type:"ENDPOINT"}).then(os);if(l==="bind")return pg(n,e.slice(0,-1));const[c,u]=Rw(s);return gl(n,{type:"APPLY",path:e.map(h=>h.toString()),argumentList:c},u).then(os)},construct(a,o){Bf(r);const[s,l]=Rw(o);return gl(n,{type:"CONSTRUCT",path:e.map(c=>c.toString()),argumentList:s},l).then(os)}});return W9(i,n),i}function V9(n){return Array.prototype.concat.apply([],n)}function Rw(n){const e=n.map(zf);return[e.map(t=>t[0]),V9(e.map(t=>t[1]))]}const kw=new WeakMap;function H9(n,e){return kw.set(n,e),n}function Y9(n){return Object.assign(n,{[_w]:!0})}function OU(n,e=globalThis,t="*"){return{postMessage:(r,i)=>n.postMessage(r,t,i),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e)}}function zf(n){for(const[e,t]of Mw)if(t.canHandle(n)){const[r,i]=t.serialize(n);return[{type:"HANDLER",name:e,value:r},i]}return[{type:"RAW",value:n},kw.get(n)||[]]}function os(n){switch(n.type){case"HANDLER":return Mw.get(n.name).deserialize(n.value);case"RAW":return n.value}}function gl(n,e,t){return new Promise(r=>{const i=X9();n.addEventListener("message",function a(o){!o.data||!o.data.id||o.data.id!==i||(n.removeEventListener("message",a),r(o.data))}),n.start&&n.start(),n.postMessage(Object.assign({id:i},e),t)})}function X9(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}class j9 extends Jp.Z{constructor(e,t,r){super(),this.graph=e,this.layout=t,this.options=r,this.spawnWorker()}spawnWorker(){this.proxy=Aw(new Worker(new URL(D.p+D.u(3197),D.b),{type:void 0})),this.running&&(this.running=!1,this.execute())}execute(){var e;return(0,Sw.mG)(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;const t=this.layout.options,{onTick:r}=t,i=(0,Sw._T)(t,["onTick"]),a={};Object.keys(i).forEach(c=>{(0,I9.Z)(i[c])||(a[c]=i[c])});const o={layout:{id:this.layout.id,options:a,iterations:(e=this.options)===null||e===void 0?void 0:e.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},s=new Float32Array([0]),[l]=yield this.proxy.calculateLayout(o,[s]);return l})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[Tw]()}isRunning(){return this.running}}var Lw=D(10779);class $9{constructor(e){k(this,"context");k(this,"supervisor");k(this,"instance");k(this,"instances",[]);k(this,"animationResult");this.context=e}get presetOptions(){return{animation:!!i1(this.context.options,!0)}}get options(){const{options:e}=this.context;return e.layout}getLayoutInstance(){return this.instances}layout(){return Ct(this,null,function*(){if(!this.options)return;const e=Array.isArray(this.options)?this.options:[this.options],{graph:t}=this.context;qn(t,new Gn(Mt.BEFORE_LAYOUT));for(const r of e){const i=e.indexOf(r),a=this.getLayoutData(r),o=at(at({},this.presetOptions),r);qn(t,new Gn(Mt.BEFORE_STAGE_LAYOUT,{options:o,index:i}));const s=yield this.stepLayout(a,o,i);qn(t,new Gn(Mt.AFTER_STAGE_LAYOUT,{options:o,index:i})),r.animation||this.updateElementPosition(s,!1)}qn(t,new Gn(Mt.AFTER_LAYOUT))})}simulate(){return Ct(this,null,function*(){if(!this.options)return{};const e=Array.isArray(this.options)?this.options:[this.options];let t={};for(const r of e){const i=e.indexOf(r),a=this.getLayoutData(r);t=yield this.stepLayout(a,_e(at(at({},this.presetOptions),r),{animation:!1}),i)}return t})}stepLayout(e,t,r){return Ct(this,null,function*(){return gN(t)?yield this.treeLayout(e,t,r):yield this.graphLayout(e,t,r)})}graphLayout(e,t,r){return Ct(this,null,function*(){const{animation:i,enableWorker:a,iterations:o=300}=t,s=this.initGraphLayout(t);if(!s)return{};if(this.instances[r]=s,this.instance=s,a){const c=s;return this.supervisor=new j9(c.graphData2LayoutModel(e),c.instance,{iterations:o}),Ju(yield this.supervisor.execute())}if((0,Lw.h)(s))return i?yield s.execute(e,{onTick:c=>{this.updateElementPosition(c,!1)}}):(s.execute(e),s.stop(),s.tick(o));const l=yield s.execute(e);return i&&this.updateElementPosition(l,i),l})}treeLayout(e,t,r){return Ct(this,null,function*(){const{type:i,animation:a}=t,o=ba("layout",i);if(!o)return{};const{nodes:s=[],edges:l=[]}=e,c=new Hp.k({nodes:s.map(p=>({id:it(p),data:p.data||{}})),edges:l.map(p=>({id:it(p),source:p.source,target:p.target,data:p.data||{}}))});R9(c);const u={nodes:[],edges:[]},h={nodes:[],edges:[]};c.getRoots($a).forEach(p=>{Rs(p,S=>{S.children=c.getSuccessors(S.id)},S=>c.getSuccessors(S.id),"TB");const v=o(p,t),{x:g,y:m,z:x=0}=v;Rs(v,S=>{const{id:T,x:b,y,z:E=0}=S;u.nodes.push({id:T,style:{x:g,y:m,z:x}}),h.nodes.push({id:T,style:{x:b,y,z:E}})},S=>S.children,"TB")});const d=this.inferTreeLayoutOffset(h);return Iw(h,d),a&&(Iw(u,d),this.updateElementPosition(u,!1),this.updateElementPosition(h,a)),h})}inferTreeLayoutOffset(e){var p;let[t,r]=[1/0,-1/0],[i,a]=[1/0,-1/0];(p=e.nodes)==null||p.forEach(v=>{const{x:g=0,y:m=0}=v.style||{};t=Math.min(t,g),r=Math.max(r,g),i=Math.min(i,m),a=Math.max(a,m)});const{canvas:o}=this.context,s=o.getSize(),[l,c]=o.getCanvasByViewport([0,0]),[u,h]=o.getCanvasByViewport(s);if(t>=l&&r<=u&&i>=c&&a<=h)return[0,0];const f=(l+u)/2,d=(c+h)/2;return[f-(t+r)/2,d-(i+a)/2]}stopLayout(){this.instance&&(0,Lw.h)(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(e){const{nodeFilter:t=()=>!0}=e,{nodes:r,edges:i,combos:a}=this.context.model.getData(),o=u=>this.context.element.getElement(u),s=r.filter(u=>{const h=it(u),f=o(h);return!f||Vp(f)?!1:t(u)}),l=new Map(s.map(u=>[it(u),u])),c=i.filter(u=>{const{source:h,target:f}=u;return!(!l.has(h)||!l.has(f))});return{nodes:s,edges:c,combos:a}}initGraphLayout(e){var x;const{element:t,viewport:r}=this.context,m=e,{type:i,enableWorker:a,animation:o,iterations:s}=m,l=Ce(m,["type","enableWorker","animation","iterations"]),[c,u]=r.getCanvasSize(),h=[c/2,u/2],f=(x=e==null?void 0:e.nodeSize)!=null?x:S=>{const T=t==null?void 0:t.getElement(S.id),{size:b}=(T==null?void 0:T.attributes)||{};return Math.max(...Pa(b))},d=ba("layout",i);if(!d)return Lr.warn(`The layout of ${i} is not registered.`);const p=Object.getPrototypeOf(d.prototype)===ix.prototype?d:mN(d,this.context),v=new p(this.context),g={nodeSize:f,width:c,height:u,center:h};switch(v.id){case"d3-force":case"d3-force-3d":Object.assign(g,{center:{x:c/2,y:u/2,z:0}});break;default:break}return Pi(v.options,g,l),v}updateElementPosition(e,t){const{model:r,element:i}=this.context;return i?(r.updateData(e),i.draw({animation:t,silence:!0})):null}destroy(){var e;this.stopLayout(),this.context={},(e=this.supervisor)==null||e.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}const Iw=(n,e)=>{var i;const[t,r]=e;(i=n.nodes)==null||i.forEach(a=>{if(a.style){const{x:o=0,y:s=0}=a.style;a.style.x=o+t,a.style.y=s+r}else a.style={x:t,y:r}})};class K9 extends gp{constructor(t){super(t);k(this,"category","plugin");this.setPlugins(this.context.options.plugins||[])}setPlugins(t){this.setExtensions(t)}getPluginInstance(t){const r=this.extensionMap[t];if(r)return r;Lr.warn(`Cannot find the plugin ${t}, will try to find it by type.`);const i=this.extensions.find(a=>a.type===t);if(i)return this.extensionMap[i.key]}}const Wf=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class Z9 extends gp{constructor(t){super(t);k(this,"category","transform");this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(t){this.setExtensions([...Wf.slice(0,Wf.length-1),...t,Wf[Wf.length-1]])}getTransformInstance(t){return t?this.extensionMap[t]:this.extensionMap}}class q9{constructor(e){k(this,"context");k(this,"landmarkCounter",0);k(this,"transformResolver");this.context=e;const[t,r]=this.paddingOffset,{zoom:i,rotation:a,x:o=t,y:s=r}=e.options;this.transform({mode:"absolute",scale:i,translate:[o,s],rotate:a},!1)}get padding(){return Os(this.context.options.padding)}get paddingOffset(){const[e,t,r,i]=this.padding,[a,o,s]=[(i-t)/2,(e-r)/2,0];return[a,o,s]}get camera(){const{canvas:e}=this.context;return new Proxy(e.getCamera(),{get:(t,r)=>{const a=Object.entries(e.getLayers()).filter(([s])=>!["main"].includes(s)).map(([,s])=>s.getCamera()),o=t[r];if(typeof o=="function")return(...s)=>{const l=o.apply(t,s);return a.forEach(c=>{c[r].apply(c,s)}),l}}})}createLandmark(e){return this.camera.createLandmark(`landmark-${this.landmarkCounter++}`,e)}getAnimation(e){const t=i1(this.context.options,e);return t?Lp(at({},t),["easing","duration"]):!1}getCanvasSize(){const{canvas:e}=this.context,{width:t=0,height:r=0}=e.getConfig();return[t,r]}getCanvasCenter(){const{canvas:e}=this.context,{width:t=0,height:r=0}=e.getConfig();return[t/2,r/2,0]}getViewportCenter(){const[e,t]=this.camera.getPosition();return[e,t,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(e){const{camera:t}=this,{mode:r,translate:i=[]}=e,a=this.getZoom(),o=t.getPosition(),s=t.getFocalPoint(),[l,c]=this.getCanvasCenter(),[u=0,h=0,f=0]=i,d=As([-u,-h,-f],a);return r==="relative"?{position:ge(o,d),focalPoint:ge(s,d)}:{position:ge([l,c,o[2]],d),focalPoint:ge([l,c,s[2]],d)}}getRotateOptions(e){const{mode:t,rotate:r=0}=e;return{roll:t==="relative"?this.camera.getRoll()+r:r}}getZoomOptions(e){const{zoomRange:t}=this.context.options,r=this.camera.getZoom(),{mode:i,scale:a=1}=e;return he(i==="relative"?r*a:a,...t)}transform(e,t){return Ct(this,null,function*(){const{graph:r}=this.context,{translate:i,rotate:a,scale:o,origin:s}=e;this.cancelAnimation();const l=this.getAnimation(t);if(qn(r,new If(Mt.BEFORE_TRANSFORM,e)),!a&&o&&!i&&s&&!l){this.camera.setZoomByViewportPoint(this.getZoomOptions(e),s),qn(r,new If(Mt.AFTER_TRANSFORM,e));return}const c={};if(i&&Object.assign(c,this.getTranslateOptions(e)),te(a)&&Object.assign(c,this.getRotateOptions(e)),te(o)&&Object.assign(c,{zoom:this.getZoomOptions(e)}),l)return qn(r,new Gi(Mt.BEFORE_ANIMATE,kr.TRANSFORM,null,e)),new Promise(u=>{this.transformResolver=u,this.camera.gotoLandmark(this.createLandmark(c),_e(at({},l),{onfinish:()=>{qn(r,new Gi(Mt.AFTER_ANIMATE,kr.TRANSFORM,null,e)),qn(r,new If(Mt.AFTER_TRANSFORM,e)),this.transformResolver=void 0,u()}}))});this.camera.gotoLandmark(this.createLandmark(c),{duration:0}),qn(r,new If(Mt.AFTER_TRANSFORM,e))})}fitView(e,t){return Ct(this,null,function*(){const[r,i,a,o]=this.padding,{when:s="always",direction:l="both"}=e||{},[c,u]=this.context.canvas.getSize(),h=c-o-i,f=u-r-a,d=this.context.canvas.getBounds(),p=this.getBBoxInViewport(d),[v,g]=Ka(p),m=l==="x"&&v>=h||l==="y"&&g>=f||l==="both"&&v>=h&&g>=f;if(s==="overflow"&&!m)return yield this.fitCenter(t);const x=h/v,S=f/g,T=l==="x"?x:l==="y"?S:Math.min(x,S),b=this.getAnimation(t);yield this.transform({mode:"relative",scale:T,translate:ge(Nn(this.getCanvasCenter(),this.getBBoxInViewport(d).center),As(this.paddingOffset,T))},b)})}fitCenter(e){return Ct(this,null,function*(){const t=this.context.canvas.getBounds();yield this.focus(t,e)})}focusElements(e,t){return Ct(this,null,function*(){const{element:r}=this.context;if(!r)return;const i=Il(e.map(a=>r.getElement(a).getRenderBounds()));yield this.focus(i,t)})}focus(e,t){return Ct(this,null,function*(){const r=this.context.graph.getViewportByCanvas(e.center),i=this.getCanvasCenter(),a=Nn(i,r);yield this.transform({mode:"relative",translate:ge(a,this.paddingOffset)},t)})}getBBoxInViewport(e){const{min:t,max:r}=e,{graph:i}=this.context,[a,o]=i.getViewportByCanvas(t),[s,l]=i.getViewportByCanvas(r),c=new Fe;return c.setMinMax([a,o,0],[s,l,0]),c}isInViewport(e){const{graph:t}=this.context,r=this.getCanvasSize(),[i,a]=t.getCanvasByViewport([0,0]),[o,s]=t.getCanvasByViewport(r),l=new Fe;return l.setMinMax([i,a,0],[o,s,0]),Cs(e)?wa(e,l):l.intersects(e)}cancelAnimation(){var e,t;(e=this.camera.landmarks)!=null&&e.length&&this.camera.cancelLandmarkAnimation(),(t=this.transformResolver)==null||t.call(this)}}const im=class extends Jp.Z{constructor(t){super();k(this,"options");k(this,"destroyed",!1);k(this,"context",{model:new k9});k(this,"isCollapsingExpanding",!1);k(this,"onResize",Zu(()=>{this.resize()},300));this.options=Object.assign({},im.defaultOptions,t),this.setOptions(this.options),this.context.graph=this,this.options.autoResize&&window.addEventListener("resize",this.onResize)}getOptions(){return this.options}setOptions(t){var g,m,x;const{behaviors:r,combo:i,data:a,edge:o,height:s,layout:l,node:c,plugins:u,theme:h,transforms:f,width:d,cursor:p,renderer:v}=t;if(v){const S=this.context.canvas;S&&(this.emit(Mt.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),S.setRenderer(v),this.emit(Mt.AFTER_RENDERER_CHANGE,{renderer:v}))}Object.assign(this.options,t),p&&((g=this.context.canvas)==null||g.setCursor(p)),r&&this.setBehaviors(r),i&&this.setCombo(i),a&&this.setData(a),o&&this.setEdge(o),l&&this.setLayout(l),c&&this.setNode(c),h&&this.setTheme(h),u&&this.setPlugins(u),f&&this.setTransforms(f),(te(d)||te(s))&&this.setSize((m=d!=null?d:this.options.width)!=null?m:0,(x=s!=null?s:this.options.height)!=null?x:0)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(t,r){var i;Object.assign(this.options,{width:t,height:r}),(i=this.context.canvas)==null||i.resize(t,r)}setZoomRange(t){this.options.zoomRange=t}getZoomRange(){return this.options.zoomRange}setNode(t){this.options.node=t,this.context.model.refreshData()}setEdge(t){this.options.edge=t,this.context.model.refreshData()}setCombo(t){this.options.combo=t,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(t){this.options.theme=jt(t)?t(this.getTheme()):t}setLayout(t){this.options.layout=jt(t)?t(this.getLayout()):t}getLayout(){return this.options.layout}setBehaviors(t){var r;this.options.behaviors=jt(t)?t(this.getBehaviors()):t,(r=this.context.behavior)==null||r.setBehaviors(this.options.behaviors)}updateBehavior(t){this.setBehaviors(r=>r.map(i=>typeof i=="object"&&i.key===t.key?at(at({},i),t):i))}getBehaviors(){return this.options.behaviors||[]}setPlugins(t){var r;this.options.plugins=jt(t)?t(this.getPlugins()):t,(r=this.context.plugin)==null||r.setPlugins(this.options.plugins)}updatePlugin(t){this.setPlugins(r=>r.map(i=>typeof i=="object"&&i.key===t.key?at(at({},i),t):i))}getPlugins(){return this.options.plugins||[]}getPluginInstance(t){return this.context.plugin.getPluginInstance(t)}setTransforms(t){var r;this.options.transforms=jt(t)?t(this.getTransforms()):t,(r=this.context.transform)==null||r.setTransforms(this.options.transforms)}updateTransform(t){this.setTransforms(r=>r.map(i=>typeof i=="object"&&i.key===t.key?at(at({},i),t):i)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(t){return Array.isArray(t)?t.map(r=>this.context.model.getElementDataById(r)):this.context.model.getElementDataById(t)}getNodeData(t){var r;return t===void 0?this.context.model.getNodeData():Array.isArray(t)?this.context.model.getNodeData(t):(r=this.context.model.getNodeData([t]))==null?void 0:r[0]}getEdgeData(t){var r;return t===void 0?this.context.model.getEdgeData():Array.isArray(t)?this.context.model.getEdgeData(t):(r=this.context.model.getEdgeData([t]))==null?void 0:r[0]}getComboData(t){var r;return t===void 0?this.context.model.getComboData():Array.isArray(t)?this.context.model.getComboData(t):(r=this.context.model.getComboData([t]))==null?void 0:r[0]}setData(t){this.context.model.setData(jt(t)?t(this.getData()):t)}addData(t){this.context.model.addData(jt(t)?t(this.getData()):t)}addNodeData(t){this.context.model.addNodeData(jt(t)?t(this.getNodeData()):t)}addEdgeData(t){this.context.model.addEdgeData(jt(t)?t(this.getEdgeData()):t)}addComboData(t){this.context.model.addComboData(jt(t)?t(this.getComboData()):t)}addChildrenData(t,r){this.context.model.addChildrenData(t,r)}updateData(t){this.context.model.updateData(jt(t)?t(this.getData()):t)}updateNodeData(t){this.context.model.updateNodeData(jt(t)?t(this.getNodeData()):t)}updateEdgeData(t){this.context.model.updateEdgeData(jt(t)?t(this.getEdgeData()):t)}updateComboData(t){this.context.model.updateComboData(jt(t)?t(this.getComboData()):t)}removeData(t){this.context.model.removeData(jt(t)?t(this.getData()):t)}removeNodeData(t){this.context.model.removeNodeData(jt(t)?t(this.getNodeData()):t)}removeEdgeData(t){this.context.model.removeEdgeData(jt(t)?t(this.getEdgeData()):t)}removeComboData(t){this.context.model.removeComboData(jt(t)?t(this.getComboData()):t)}getElementType(t){return this.context.model.getElementType(t)}getRelatedEdgesData(t,r="both"){return this.context.model.getRelatedEdgesData(t,r)}getNeighborNodesData(t){return this.context.model.getNeighborNodesData(t)}getAncestorsData(t,r){return this.context.model.getAncestorsData(t,r)}getParentData(t,r){return this.context.model.getParentData(t,r)}getChildrenData(t){return this.context.model.getChildrenData(t)}getElementDataByState(t,r){return this.context.model.getElementDataByState(t,r)}initCanvas(){return Ct(this,null,function*(){if(this.context.canvas)return yield this.context.canvas.ready;const{container:t="container",width:r,height:i,renderer:a,cursor:o,background:s}=this.options;if(t instanceof bw)this.context.canvas=t,o&&t.setCursor(o),yield t.ready;else{const l=qt(t)?document.getElementById(t):t,c=ox(l);this.emit(Mt.BEFORE_CANVAS_INIT,{container:l,width:r,height:i});const u=new bw({container:l,width:r||c[0],height:i||c[1],background:s,renderer:a,cursor:o});this.context.canvas=u,yield u.ready,this.emit(Mt.AFTER_CANVAS_INIT,{canvas:u})}})}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new M9(this.context)),this.context.plugin||(this.context.plugin=new K9(this.context)),this.context.viewport||(this.context.viewport=new q9(this.context)),this.context.transform||(this.context.transform=new Z9(this.context)),this.context.element||(this.context.element=new L9(this.context)),this.context.animation||(this.context.animation=new P9(this.context)),this.context.layout||(this.context.layout=new $9(this.context)),this.context.behavior||(this.context.behavior=new C9(this.context))}prepare(){return Ct(this,null,function*(){if(yield Promise.resolve(),this.destroyed)throw new Error(Ea("The graph instance has been destroyed"));yield this.initCanvas(),this.initRuntime()})}render(){return Ct(this,null,function*(){yield this.prepare(),qn(this,new Gn(Mt.BEFORE_RENDER));const t=this.context.element.draw({type:"render"});yield Promise.all([t==null?void 0:t.finished,this.context.layout.layout()]),yield this.autoFit(),qn(this,new Gn(Mt.AFTER_RENDER))})}draw(){return Ct(this,null,function*(){var t;yield this.prepare(),yield(t=this.context.element.draw())==null?void 0:t.finished})}layout(){return Ct(this,null,function*(){yield this.context.layout.layout()})}stopLayout(){this.context.layout.stopLayout()}clear(){return Ct(this,null,function*(){this.context.model.setData({}),yield this.draw()})}destroy(){qn(this,new Gn(Mt.BEFORE_DESTROY));const{layout:t,animation:r,element:i,model:a,canvas:o,behavior:s,plugin:l}=this.context;l==null||l.destroy(),s==null||s.destroy(),t==null||t.destroy(),r==null||r.destroy(),i==null||i.destroy(),a.destroy(),o==null||o.destroy(),this.options={},this.context={},this.off(),window.removeEventListener("resize",this.onResize),this.destroyed=!0,qn(this,new Gn(Mt.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(t,r){const i=!t||!r?ox(this.context.canvas.getContainer()):[t,r];un(i,this.getSize())||(qn(this,new Gn(Mt.BEFORE_SIZE_CHANGE,{size:i})),this.context.canvas.resize(...i),qn(this,new Gn(Mt.AFTER_SIZE_CHANGE,{size:i})))}fitView(t,r){return Ct(this,null,function*(){var i;yield(i=this.context.viewport)==null?void 0:i.fitView(t,r)})}fitCenter(t){return Ct(this,null,function*(){var r;yield(r=this.context.viewport)==null?void 0:r.fitCenter(t)})}autoFit(){return Ct(this,null,function*(){const{autoFit:t}=this.context.options;if(t)if(qt(t))t==="view"?yield this.fitView():t==="center"&&(yield this.fitCenter());else{const{type:r,animation:i}=t;r==="view"?yield this.fitView(t.options,i):r==="center"&&(yield this.fitCenter(i))}})}focusElement(t,r){return Ct(this,null,function*(){var i;yield(i=this.context.viewport)==null?void 0:i.focusElements(Array.isArray(t)?t:[t],r)})}zoomBy(t,r,i){return Ct(this,null,function*(){yield this.context.viewport.transform({mode:"relative",scale:t,origin:i},r)})}zoomTo(t,r,i){return Ct(this,null,function*(){this.context.viewport.transform({mode:"absolute",scale:t,origin:i},r)})}getZoom(){return this.context.viewport.getZoom()}rotateBy(t,r,i){return Ct(this,null,function*(){yield this.context.viewport.transform({mode:"relative",rotate:t,origin:i},r)})}rotateTo(t,r,i){return Ct(this,null,function*(){yield this.context.viewport.transform({mode:"absolute",rotate:t,origin:i},r)})}getRotation(){return this.context.viewport.getRotation()}translateBy(t,r){return Ct(this,null,function*(){yield this.context.viewport.transform({mode:"relative",translate:t},r)})}translateTo(t,r){return Ct(this,null,function*(){yield this.context.viewport.transform({mode:"absolute",translate:t},r)})}getPosition(){return Nn([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(t,r,i=!0){return Ct(this,null,function*(){var s;const[a,o]=Ye(t)?[t,r!=null?r:!0]:[{[t]:r},i];Object.entries(a).forEach(([l,c])=>this.context.model.translateNodeLikeBy(l,c)),yield(s=this.context.element.draw({animation:o,stage:"translate"}))==null?void 0:s.finished})}translateElementTo(t,r,i=!0){return Ct(this,null,function*(){var s;const[a,o]=Ye(t)?[t,r!=null?r:!0]:[{[t]:r},i];Object.entries(a).forEach(([l,c])=>this.context.model.translateNodeLikeTo(l,c)),yield(s=this.context.element.draw({animation:o,stage:"translate"}))==null?void 0:s.finished})}getElementPosition(t){return this.context.model.getElementPosition(t)}getElementRenderStyle(t){return Xp(this.context.element.getElement(t).attributes,["context"])}setElementVisibility(t,r,i=!0){return Ct(this,null,function*(){var u;const[a,o]=Ye(t)?[t,r!=null?r:!0]:[{[t]:r},i],s={nodes:[],edges:[],combos:[]};Object.entries(a).forEach(([h,f])=>{const d=this.getElementType(h);s[`${d}s`].push({id:h,style:{visibility:f}})});const{model:l,element:c}=this.context;l.preventUpdateNodeLikeHierarchy(()=>{l.updateData(s)}),yield(u=c.draw({animation:o,stage:"visibility"}))==null?void 0:u.finished})}showElement(t,r){return Ct(this,null,function*(){const i=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(i.map(a=>[a,"visible"])),r)})}hideElement(t,r){return Ct(this,null,function*(){const i=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(i.map(a=>[a,"hidden"])),r)})}getElementVisibility(t){var i,a;const r=this.context.element.getElement(t);return(a=(i=r==null?void 0:r.style)==null?void 0:i.visibility)!=null?a:"visible"}setElementZIndex(t,r){return Ct(this,null,function*(){var l;const i={nodes:[],edges:[],combos:[]},a=Ye(t)?t:{[t]:r};Object.entries(a).forEach(([c,u])=>{const h=this.getElementType(c);i[`${h}s`].push({id:c,style:{zIndex:u}})});const{model:o,element:s}=this.context;o.preventUpdateNodeLikeHierarchy(()=>o.updateData(i)),yield(l=s.draw({animation:!1,stage:"zIndex"}))==null?void 0:l.finished})}frontElement(t){return Ct(this,null,function*(){const r=Array.isArray(t)?t:[t],{model:i,element:a}=this.context,o={};r.map(s=>{const l=a.getFrontZIndex(s);if(i.getElementType(s)==="combo"){const u=i.getAncestorsData(s,tn).at(-1)||this.getComboData(s),h=[u,...i.getDescendantsData(it(u))],f=l-a.getElementZIndex(s);h.forEach(d=>{o[it(d)]=this.getElementZIndex(it(d))+f})}else o[s]=l}),yield this.setElementZIndex(o)})}getElementZIndex(t){var a,o,s;const{model:r,element:i}=this.context;return(s=(o=(a=r.getElementDataById(t))==null?void 0:a.style)==null?void 0:o.zIndex)!=null?s:i.getElementZIndex(t)}setElementState(t,r,i=!0){return Ct(this,null,function*(){var c;const[a,o]=Ye(t)?[t,r!=null?r:!0]:[{[t]:r},i],s=u=>u?Array.isArray(u)?u:[u]:[],l={nodes:[],edges:[],combos:[]};Object.entries(a).forEach(([u,h])=>{const f=this.getElementType(u);l[`${f}s`].push({id:u,states:s(h)})}),this.updateData(l),yield(c=this.context.element.draw({animation:o}))==null?void 0:c.finished})}getElementState(t){return this.context.model.getElementState(t)}getElementRenderBounds(t){return this.context.element.getElement(t).getRenderBounds()}collapseElement(t,r=!0){return Ct(this,null,function*(){const{model:i,element:a}=this.context;if(ri(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;const o=i.getElementType(t);yield this.frontElement(t),this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!0),o==="node"?yield a.collapseNode(t,r):o==="combo"&&(yield a.collapseCombo(t,r)),this.isCollapsingExpanding=!1})}expandElement(t,r=!0){return Ct(this,null,function*(){const{model:i,element:a}=this.context;if(!ri(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;const o=i.getElementType(t);this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!1),o==="node"?yield a.expandNode(t,r):o==="combo"&&(yield a.expandCombo(t,r)),this.isCollapsingExpanding=!1})}setElementCollapsibility(t,r){const i=this.getElementType(t);i==="node"?this.updateNodeData([{id:t,style:{collapsed:r}}]):i==="combo"&&this.updateComboData([{id:t,style:{collapsed:r}}])}toDataURL(){return Ct(this,arguments,function*(t={}){return this.context.canvas.toDataURL(t)})}getCanvasByViewport(t){return this.context.canvas.getCanvasByViewport(t)}getViewportByCanvas(t){return this.context.canvas.getViewportByCanvas(t)}getClientByCanvas(t){return this.context.canvas.getClientByCanvas(t)}getCanvasByClient(t){return this.context.canvas.getCanvasByClient(t)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(t,r,i){return super.on(t,r,i)}once(t,r){return super.once(t,r)}off(t,r){return super.off(t,r)}};let Uf=im;k(Uf,"defaultOptions",{autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]});class J9 extends pl{beforeDraw(e){const{add:t,update:r}=e,{model:i}=this.context;return[...t.edges.entries(),...r.edges.entries()].forEach(([,a])=>{Dw(i,a)}),e}}const Dw=(n,e)=>{const{source:t,target:r}=e,i=n.getElementDataById(t),a=n.getElementDataById(r),o=j1(i,h=>n.getParentData(h,tn)),s=j1(a,h=>n.getParentData(h,tn)),l=it(o),c=it(s),u={sourceNode:l,targetNode:c};return e.style?Object.assign(e.style,u):e.style=u,e},Q9="quadratic",Bw=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"],am=class extends pl{constructor(t,r){super(t,Object.assign({},am.defaultOptions,r));k(this,"cacheMergeStyle",new Map);k(this,"getAffectedParallelEdges",t=>{const{add:{edges:r},update:{nodes:i,edges:a,combos:o},remove:{edges:s}}=t,{model:l}=this.context,c=new Map,u=(d,p)=>{l.getRelatedEdgesData(p).forEach(g=>!c.has(it(g))&&c.set(it(g),g))};i.forEach(u),o.forEach(u);const h=d=>{const p=l.getEdgeData().map(g=>Dw(l,g));t8(d,p,!0).forEach(g=>!c.has(it(g))&&c.set(it(g),g))};if(s.size&&s.forEach(h),r.size&&r.forEach(h),a.size){const d=mx(Qp(l.getChanges())).update.edges;a.forEach(p=>{var g;h(p);const v=(g=d.find(m=>it(m.value)===it(p)))==null?void 0:g.original;v&&!vg(p,v)&&h(v)})}Cp(this.options.edges)||c.forEach((d,p)=>!this.options.edges.includes(p)&&c.delete(p));const f=l.getEdgeData().map(it);return new Map([...c].sort((d,p)=>f.indexOf(d[0])-f.indexOf(p[0])))});k(this,"applyBundlingStyle",(t,r,i)=>{const{edgeMap:a,reverses:o}=Fw(r);a.forEach(s=>{s.forEach((l,c,u)=>{var p;const f=Object.assign(l,{type:Q9,style:(()=>{const v=u.length,g={};if(l.source===l.target){const m=Bw.length;g.loopPlacement=Bw[c%m],g.loopDist=Math.floor(c/m)*i+50}else if(v===1)g.curveOffset=0;else{const m=(c%2===0?1:-1)*(o[`${l.source}|${l.target}|${c}`]?-1:1);g.curveOffset=v%2===1?m*Math.ceil(c/2)*i*2:m*(Math.floor(c/2)*i*2+i)}return Object.assign({},l.style,g)})()});((p=this.context.element)==null?void 0:p.getElement(it(l)))?Ll(t,"update","edge",f,!0):Ll(t,"add","edge",f,!0)})})});k(this,"resetEdgeStyle",t=>{const r=t.style||{},i=this.cacheMergeStyle.get(it(t))||{};return Object.keys(i).forEach(a=>{un(r[a],i[a])&&(t[a]?r[a]=t[a]:delete r[a])}),Object.assign(t,{style:r})});k(this,"applyMergingStyle",(t,r)=>{const{edgeMap:i,reverses:a}=Fw(r);i.forEach(o=>{var l;if(o.length===1){const c=o[0],u=(l=this.context.element)==null?void 0:l.getElement(it(c));Ll(t,u?"update":"add","edge",this.resetEdgeStyle(c),!0);return}const s=o.map(({source:c,target:u,style:h={}},f)=>{const{startArrow:d,endArrow:p}=h,v={},[g,m]=a[`${c}|${u}|${f}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return za(d)&&(v[g]=d),za(p)&&(v[m]=p),v}).reduce((c,u)=>at(at({},c),u),{});o.forEach((c,u,h)=>{var f;if(u===0){const d=Object.assign({},jt(this.options.style)?this.options.style(h):this.options.style,{childrenData:h});this.cacheMergeStyle.set(it(c),d);const p=_e(at({},c),{type:"line",style:at(at({},s),d)}),v=(f=this.context.element)==null?void 0:f.getElement(it(c));Ll(t,v?"update":"add","edge",p,!0)}else Ll(t,"remove","edge",c)})})})}beforeDraw(t){const r=this.getAffectedParallelEdges(t);return r.size===0||(this.options.mode==="bundle"?this.applyBundlingStyle(t,r,this.options.distance):this.applyMergingStyle(t,r)),t}};let Vf=am;k(Vf,"defaultOptions",{mode:"bundle",edges:void 0,distance:15});const Fw=n=>{const e=new Map,t=new Set,r={};for(const[i,a]of n){if(t.has(i))continue;const{source:o,target:s}=a,l=`${o}-${s}`;e.has(l)||e.set(l,[]),e.get(l).push(a),t.add(i);for(const[c,u]of n)t.has(c)||vg(a,u)&&(e.get(l).push(u),t.add(c),o===u.target&&s===u.source&&(r[`${u.source}|${u.target}|${e.get(l).length-1}`]=!0))}return{edgeMap:e,reverses:r}},t8=(n,e,t)=>e.filter(r=>(t||it(r)!==it(n))&&vg(r,n)),vg=(n,e)=>{const{sourceNode:t,targetNode:r}=n.style||{},{sourceNode:i,targetNode:a}=e.style||{};return t===i&&r===a||t===a&&r===i};class e8 extends pl{beforeDraw(e,t){const{stage:r}=t;if(r==="visibility")return e;const{model:i}=this.context,{update:{nodes:a,edges:o,combos:s}}=e,l=(c,u)=>{i.getRelatedEdgesData(u).forEach(f=>!o.has(it(f))&&o.set(it(f),f))};return a.forEach(l),s.forEach(l),e}}const n8={animation:{"combo-collapse":c1,"combo-expand":mO,"node-collapse":s1,"node-expand":vO,"path-in":l1,"path-out":gO,fade:dO,translate:pO},behavior:{"brush-select":Gl,"click-select":Nu,"collapse-expand":Xu,"create-edge":Ku,"drag-canvas":qu,"drag-element-force":yN,"drag-element":Zl,"fix-element-size":Qu,"focus-element":th,"hover-activate":eh,"lasso-select":xN,"optimize-viewport-transform":nh,"scroll-canvas":rh,"zoom-canvas":ih},combo:{circle:yA,rect:xA},edge:{cubic:Wo,line:jl,polyline:Hu,quadratic:Yu,"cubic-horizontal":Uu,"cubic-vertical":Vu},layout:{"antv-dagre":bN.b,"combo-combined":wN.u,"compact-box":ah.compactBox,"force-atlas2":PN.E,circular:EN.S,concentric:SN.W,"d3-force":_N.j,dagre:TN.V,dendrogram:ah.dendrogram,force:MN.y,fruchterman:CN.O,grid:ON.M,indented:ah.indented,mds:AN.A,mindmap:ah.mindmap,radial:NN.D,random:RN._},node:{circle:Bs,diamond:lA,ellipse:Bu,hexagon:fA,html:Fu,image:Gu,rect:vA,star:gA,donut:Iu,triangle:zu},palette:{spectral:kN,tableau:LN,oranges:IN,greens:DN,blues:BN},theme:{dark:b9,light:E9},plugin:{"bubble-sets":vh,"edge-filter-lens":mh,"grid-line":xh,background:oh,contextmenu:gh,fullscreen:yh,history:bh,hull:Eh,legend:tf,minimap:yf,snapline:xf,timebar:Af,toolbar:Nf,tooltip:Rf,watermark:kf},transform:{"update-related-edges":e8,"arrange-draw-order":w9,"collapse-expand-combo":S9,"collapse-expand-node":_9,"process-parallel-edges":Vf,"get-edge-actual-ends":J9},shape:{circle:Cl,ellipse:Zd,group:Ol,html:qd,image:Ap,line:nu,path:Xa,polygon:ru,polyline:ky,rect:ea,text:Al,label:Qa,badge:Ls}};function r8(){Object.entries(n8).forEach(([n,e])=>{Object.entries(e).forEach(([t,r])=>{yw(n,t,r)})})}nt.enableCSSParsing=!1,r8();const AU={css:"//at.alicdn.com/t/a/font_470089_8hnbbf8n4u8.css",js:"//at.alicdn.com/t/a/font_470089_8hnbbf8n4u8.js"}},81746:function(Ot){(function(D,G){Ot.exports=G()})(typeof self!="undefined"?self:this,function(){return function(ft){var D={};function G(lt){if(D[lt])return D[lt].exports;var Z=D[lt]={i:lt,l:!1,exports:{}};return ft[lt].call(Z.exports,Z,Z.exports,G),Z.l=!0,Z.exports}return G.m=ft,G.c=D,G.d=function(lt,Z,B){G.o(lt,Z)||Object.defineProperty(lt,Z,{configurable:!1,enumerable:!0,get:B})},G.n=function(lt){var Z=lt&&lt.__esModule?function(){return lt.default}:function(){return lt};return G.d(Z,"a",Z),Z},G.o=function(lt,Z){return Object.prototype.hasOwnProperty.call(lt,Z)},G.p="",G(G.s=5)}([function(ft,D){function G(lt,Z,B,N){return N===void 0&&(N="height"),B==="center"?(lt[N]+Z[N])/2:lt.height}ft.exports={assign:Object.assign,getHeight:G}},function(ft,D,G){var lt=G(3),Z=function(){function B(V,W){W===void 0&&(W={});var X=this;X.options=W,X.rootNode=lt(V,W)}var N=B.prototype;return N.execute=function(){throw new Error("please override this method")},B}();ft.exports=Z},function(ft,D,G){var lt=G(4),Z=["LR","RL","TB","BT","H","V"],B=["LR","RL","H"],N=function(X){return B.indexOf(X)>-1},V=Z[0];ft.exports=function(W,X,F){var H=X.direction||V;if(X.isHorizontal=N(H),H&&Z.indexOf(H)===-1)throw new TypeError("Invalid direction: "+H);if(H===Z[0])F(W,X);else if(H===Z[1])F(W,X),W.right2left();else if(H===Z[2])F(W,X);else if(H===Z[3])F(W,X),W.bottom2top();else if(H===Z[4]||H===Z[5]){var U=lt(W,X),$=U.left,dt=U.right;F($,X),F(dt,X),X.isHorizontal?$.right2left():$.bottom2top(),dt.translate($.x-dt.x,$.y-dt.y),W.x=$.x,W.y=dt.y;var j=W.getBoundingBox();X.isHorizontal?j.top<0&&W.translate(0,-j.top):j.left<0&&W.translate(-j.left,0)}var mt=X.fixedRoot;return mt===void 0&&(mt=!0),mt&&W.translate(-(W.x+W.width/2+W.hgap),-(W.y+W.height/2+W.vgap)),W}},function(ft,D,G){var lt=G(0),Z=18,B=Z*2,N=Z,V={getId:function(H){return H.id||H.name},getPreH:function(H){return H.preH||0},getPreV:function(H){return H.preV||0},getHGap:function(H){return H.hgap||N},getVGap:function(H){return H.vgap||N},getChildren:function(H){return H.children},getHeight:function(H){return H.height||B},getWidth:function(H){var U=H.label||" ";return H.width||U.split("").length*Z}};function W(F,H){var U=this;if(U.vgap=U.hgap=0,F instanceof W)return F;U.data=F;var $=H.getHGap(F),dt=H.getVGap(F);return U.preH=H.getPreH(F),U.preV=H.getPreV(F),U.width=H.getWidth(F),U.height=H.getHeight(F),U.width+=U.preH,U.height+=U.preV,U.id=H.getId(F),U.x=U.y=0,U.depth=0,U.children||(U.children=[]),U.addGap($,dt),U}lt.assign(W.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(H,U){var $=this;$.hgap+=H,$.vgap+=U,$.width+=2*H,$.height+=2*U},eachNode:function(H){for(var U=this,$=[U],dt;dt=$.shift();)H(dt),$=dt.children.concat($)},DFTraverse:function(H){this.eachNode(H)},BFTraverse:function(H){for(var U=this,$=[U],dt;dt=$.shift();)H(dt),$=$.concat(dt.children)},getBoundingBox:function(){var H={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(U){H.left=Math.min(H.left,U.x),H.top=Math.min(H.top,U.y),H.width=Math.max(H.width,U.x+U.width),H.height=Math.max(H.height,U.y+U.height)}),H},translate:function(H,U){H===void 0&&(H=0),U===void 0&&(U=0),this.eachNode(function($){$.x+=H,$.y+=U,$.x+=$.preH,$.y+=$.preV})},right2left:function(){var H=this,U=H.getBoundingBox();H.eachNode(function($){$.x=$.x-($.x-U.left)*2-$.width}),H.translate(U.width,0)},bottom2top:function(){var H=this,U=H.getBoundingBox();H.eachNode(function($){$.y=$.y-($.y-U.top)*2-$.height}),H.translate(0,U.height)}});function X(F,H,U){H===void 0&&(H={}),H=lt.assign({},V,H);var $=new W(F,H),dt=[$],j;if(!U&&!F.collapsed){for(;j=dt.shift();)if(!j.data.collapsed){var mt=H.getChildren(j.data),Pt=mt?mt.length:0;if(j.children=new Array(Pt),mt&&Pt)for(var tt=0;tt<Pt;tt++){var vt=new W(mt[tt],H);j.children[tt]=vt,dt.push(vt),vt.parent=j,vt.depth=j.depth+1}}}return $}ft.exports=X},function(ft,D,G){var lt=G(3);ft.exports=function(Z,B){for(var N=lt(Z.data,B,!0),V=lt(Z.data,B,!0),W=Z.children.length,X=Math.round(W/2),F=B.getSide||function(dt,j){return j<X?"right":"left"},H=0;H<W;H++){var U=Z.children[H],$=F(U,H);$==="right"?V.children.push(U):N.children.push(U)}return N.eachNode(function(dt){dt.isRoot()||(dt.side="left")}),V.eachNode(function(dt){dt.isRoot()||(dt.side="right")}),{left:N,right:V}}},function(ft,D,G){var lt={compactBox:G(6),dendrogram:G(8),indented:G(10),mindmap:G(12)};ft.exports=lt},function(ft,D,G){function lt(U,$){U.prototype=Object.create($.prototype),U.prototype.constructor=U,Z(U,$)}function Z(U,$){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(j,mt){return j.__proto__=mt,j},Z(U,$)}var B=G(1),N=G(7),V=G(2),W=G(0),X=function(U){function $(){return U.apply(this,arguments)||this}lt($,U);var dt=$.prototype;return dt.execute=function(){var mt=this;return V(mt.rootNode,mt.options,N)},$}(B),F={};function H(U,$){return $=W.assign({},F,$),new X(U,$).execute()}ft.exports=H},function(ft,D){function G(W,X,F,H){H===void 0&&(H=[]);var U=this;U.w=W||0,U.h=X||0,U.y=F||0,U.x=0,U.c=H||[],U.cs=H.length,U.prelim=0,U.mod=0,U.shift=0,U.change=0,U.tl=null,U.tr=null,U.el=null,U.er=null,U.msel=0,U.mser=0}G.fromNode=function(W,X){if(!W)return null;var F=[];return W.children.forEach(function(H){F.push(G.fromNode(H,X))}),X?new G(W.height,W.width,W.x,F):new G(W.width,W.height,W.y,F)};function lt(W,X,F){F?W.y+=X:W.x+=X,W.children.forEach(function(H){lt(H,X,F)})}function Z(W,X){var F=X?W.y:W.x;return W.children.forEach(function(H){F=Math.min(Z(H,X),F)}),F}function B(W,X){var F=Z(W,X);lt(W,-F,X)}function N(W,X,F){F?X.y=W.x:X.x=W.x,W.c.forEach(function(H,U){N(H,X.children[U],F)})}function V(W,X,F){F===void 0&&(F=0),X?(W.x=F,F+=W.width):(W.y=F,F+=W.height),W.children.forEach(function(H){V(H,X,F)})}ft.exports=function(W,X){X===void 0&&(X={});var F=X.isHorizontal;function H(ot){if(ot.cs===0){U(ot);return}H(ot.c[0]);for(var Gt=ve(Pt(ot.c[0].el),0,null),zt=1;zt<ot.cs;++zt){H(ot.c[zt]);var Nt=Pt(ot.c[zt].er);$(ot,zt,Gt),Gt=ve(Nt,zt,Gt)}P(ot),U(ot)}function U(ot){ot.cs===0?(ot.el=ot,ot.er=ot,ot.msel=ot.mser=0):(ot.el=ot.c[0].el,ot.msel=ot.c[0].msel,ot.er=ot.c[ot.cs-1].er,ot.mser=ot.c[ot.cs-1].mser)}function $(ot,Gt,zt){for(var Nt=ot.c[Gt-1],ye=Nt.mod,le=ot.c[Gt],In=le.mod;Nt!==null&&le!==null;){Pt(Nt)>zt.low&&(zt=zt.nxt);var gt=ye+Nt.prelim+Nt.w-(In+le.prelim);gt>0&&(In+=gt,dt(ot,Gt,zt.index,gt));var de=Pt(Nt),be=Pt(le);de<=be&&(Nt=mt(Nt),Nt!==null&&(ye+=Nt.mod)),de>=be&&(le=j(le),le!==null&&(In+=le.mod))}!Nt&&le?tt(ot,Gt,le,In):Nt&&!le&&vt(ot,Gt,Nt,ye)}function dt(ot,Gt,zt,Nt){ot.c[Gt].mod+=Nt,ot.c[Gt].msel+=Nt,ot.c[Gt].mser+=Nt,ne(ot,Gt,zt,Nt)}function j(ot){return ot.cs===0?ot.tl:ot.c[0]}function mt(ot){return ot.cs===0?ot.tr:ot.c[ot.cs-1]}function Pt(ot){return ot.y+ot.h}function tt(ot,Gt,zt,Nt){var ye=ot.c[0].el;ye.tl=zt;var le=Nt-zt.mod-ot.c[0].msel;ye.mod+=le,ye.prelim-=le,ot.c[0].el=ot.c[Gt].el,ot.c[0].msel=ot.c[Gt].msel}function vt(ot,Gt,zt,Nt){var ye=ot.c[Gt].er;ye.tr=zt;var le=Nt-zt.mod-ot.c[Gt].mser;ye.mod+=le,ye.prelim-=le,ot.c[Gt].er=ot.c[Gt-1].er,ot.c[Gt].mser=ot.c[Gt-1].mser}function P(ot){ot.prelim=(ot.c[0].prelim+ot.c[0].mod+ot.c[ot.cs-1].mod+ot.c[ot.cs-1].prelim+ot.c[ot.cs-1].w)/2-ot.w/2}function Jt(ot,Gt){Gt+=ot.mod,ot.x=ot.prelim+Gt,K(ot);for(var zt=0;zt<ot.cs;zt++)Jt(ot.c[zt],Gt)}function ne(ot,Gt,zt,Nt){if(zt!==Gt-1){var ye=Gt-zt;ot.c[zt+1].shift+=Nt/ye,ot.c[Gt].shift-=Nt/ye,ot.c[Gt].change-=Nt-Nt/ye}}function K(ot){for(var Gt=0,zt=0,Nt=0;Nt<ot.cs;Nt++)Gt+=ot.c[Nt].shift,zt+=Gt+ot.c[Nt].change,ot.c[Nt].mod+=zt}function ve(ot,Gt,zt){for(;zt!==null&&ot>=zt.low;)zt=zt.nxt;return{low:ot,index:Gt,nxt:zt}}V(W,F);var ce=G.fromNode(W,F);return H(ce),Jt(ce,0),N(ce,W,F),B(W,F),W}},function(ft,D,G){function lt(U,$){U.prototype=Object.create($.prototype),U.prototype.constructor=U,Z(U,$)}function Z(U,$){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(j,mt){return j.__proto__=mt,j},Z(U,$)}var B=G(1),N=G(9),V=G(2),W=G(0),X=function(U){function $(){return U.apply(this,arguments)||this}lt($,U);var dt=$.prototype;return dt.execute=function(){var mt=this;return mt.rootNode.width=0,V(mt.rootNode,mt.options,N)},$}(B),F={};function H(U,$){return $=W.assign({},F,$),new X(U,$).execute()}ft.exports=H},function(ft,D,G){var lt=G(0);function Z(V,W){V===void 0&&(V=0),W===void 0&&(W=[]);var X=this;X.x=X.y=0,X.leftChild=X.rightChild=null,X.height=0,X.children=W}var B={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function N(V,W,X){X?(W.x=V.x,W.y=V.y):(W.x=V.y,W.y=V.x),V.children.forEach(function(F,H){N(F,W.children[H],X)})}ft.exports=function(V,W){W===void 0&&(W={}),W=lt.assign({},B,W);var X=0;function F(j){if(!j)return null;j.width=0,j.depth&&j.depth>X&&(X=j.depth);var mt=j.children,Pt=mt.length,tt=new Z(j.height,[]);return mt.forEach(function(vt,P){var Jt=F(vt);tt.children.push(Jt),P===0&&(tt.leftChild=Jt),P===Pt-1&&(tt.rightChild=Jt)}),tt.originNode=j,tt.isLeaf=j.isLeaf(),tt}function H(j){if(j.isLeaf||j.children.length===0)j.drawingDepth=X;else{var mt=j.children.map(function(tt){return H(tt)}),Pt=Math.min.apply(null,mt);j.drawingDepth=Pt-1}return j.drawingDepth}var U;function $(j){j.x=j.drawingDepth*W.rankSep,j.isLeaf?(j.y=0,U&&(j.y=U.y+U.height+W.nodeSep,j.originNode.parent!==U.originNode.parent&&(j.y+=W.subTreeSep)),U=j):(j.children.forEach(function(mt){$(mt)}),j.y=(j.leftChild.y+j.rightChild.y)/2)}var dt=F(V);return H(dt),$(dt),N(dt,V,W.isHorizontal),V}},function(ft,D,G){function lt(dt,j){dt.prototype=Object.create(j.prototype),dt.prototype.constructor=dt,Z(dt,j)}function Z(dt,j){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Pt,tt){return Pt.__proto__=tt,Pt},Z(dt,j)}var B=G(1),N=G(11),V=G(4),W=G(0),X=["LR","RL","H"],F=X[0],H=function(dt){function j(){return dt.apply(this,arguments)||this}lt(j,dt);var mt=j.prototype;return mt.execute=function(){var tt=this,vt=tt.options,P=tt.rootNode;vt.isHorizontal=!0;var Jt=vt.indent,ne=Jt===void 0?20:Jt,K=vt.dropCap,ve=K===void 0?!0:K,ce=vt.direction,ot=ce===void 0?F:ce,Gt=vt.align;if(ot&&X.indexOf(ot)===-1)throw new TypeError("Invalid direction: "+ot);if(ot===X[0])N(P,ne,ve,Gt);else if(ot===X[1])N(P,ne,ve,Gt),P.right2left();else if(ot===X[2]){var zt=V(P,vt),Nt=zt.left,ye=zt.right;N(Nt,ne,ve,Gt),Nt.right2left(),N(ye,ne,ve,Gt);var le=Nt.getBoundingBox();ye.translate(le.width,0),P.x=ye.x-P.width/2}return P},j}(B),U={};function $(dt,j){return j=W.assign({},U,j),new H(dt,j).execute()}ft.exports=$},function(ft,D,G){var lt=G(0);function Z(B,N,V,W,X){var F=typeof V=="function"?V(B):V*B.depth;if(!W)try{if(B.id===B.parent.children[0].id){B.x+=F,B.y=N?N.y:0;return}}catch($){}if(B.x+=F,N){if(B.y=N.y+lt.getHeight(N,B,X),N.parent&&B.parent.id!==N.parent.id){var H=N.parent,U=H.y+lt.getHeight(H,B,X);B.y=U>B.y?U:B.y}}else B.y=0}ft.exports=function(B,N,V,W){var X=null;B.eachNode(function(F){Z(F,X,N,V,W),X=F})}},function(ft,D,G){function lt(U,$){U.prototype=Object.create($.prototype),U.prototype.constructor=U,Z(U,$)}function Z(U,$){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(j,mt){return j.__proto__=mt,j},Z(U,$)}var B=G(1),N=G(13),V=G(2),W=G(0),X=function(U){function $(){return U.apply(this,arguments)||this}lt($,U);var dt=$.prototype;return dt.execute=function(){var mt=this;return V(mt.rootNode,mt.options,N)},$}(B),F={};function H(U,$){return $=W.assign({},F,$),new X(U,$).execute()}ft.exports=H},function(ft,D,G){var lt=G(0);function Z(V,W){var X=0;return V.children.length?V.children.forEach(function(F){X+=Z(F,W)}):X=V.height,V._subTreeSep=W.getSubTreeSep(V.data),V.totalHeight=Math.max(V.height,X)+2*V._subTreeSep,V.totalHeight}function B(V){var W=V.children,X=W.length;if(X){W.forEach(function(j){B(j)});var F=W[0],H=W[X-1],U=H.y-F.y+H.height,$=0;if(W.forEach(function(j){$+=j.totalHeight}),U>V.height)V.y=F.y+U/2-V.height/2;else if(W.length!==1||V.height>$){var dt=V.y+(V.height-U)/2-F.y;W.forEach(function(j){j.translate(0,dt)})}else V.y=(F.y+F.height/2+H.y+H.height/2)/2-V.height/2}}var N={getSubTreeSep:function(){return 0}};ft.exports=function(V,W){W===void 0&&(W={}),W=lt.assign({},N,W),V.parent={x:0,width:0,height:0,y:0},V.BFTraverse(function(X){X.x=X.parent.x+X.parent.width}),V.parent=null,Z(V,W),V.startY=0,V.y=V.totalHeight/2-V.height/2,V.eachNode(function(X){var F=X.children,H=F.length;if(H){var U=F[0];if(U.startY=X.startY+X._subTreeSep,H===1)U.y=X.y+X.height/2-U.height/2;else{U.y=U.startY+U.totalHeight/2-U.height/2;for(var $=1;$<H;$++){var dt=F[$];dt.startY=F[$-1].startY+F[$-1].totalHeight,dt.y=dt.startY+dt.totalHeight/2-dt.height/2}}}}),B(V)}}])})},69760:function(Ot,ft,D){"use strict";D.d(ft,{Z:function(){return X},w:function(){return B}});var G=D(67294),lt=D(97937),Z=D(64217);function B(F){if(F)return{closable:F.closable,closeIcon:F.closeIcon}}function N(F){const{closable:H,closeIcon:U}=F||{};return G.useMemo(()=>{if(!H&&(H===!1||U===!1||U===null))return!1;if(H===void 0&&U===void 0)return null;let $={closeIcon:typeof U!="boolean"&&U!==null?U:void 0};return H&&typeof H=="object"&&($=Object.assign(Object.assign({},$),H)),$},[H,U])}function V(){const F={};for(var H=arguments.length,U=new Array(H),$=0;$<H;$++)U[$]=arguments[$];return U.forEach(dt=>{dt&&Object.keys(dt).forEach(j=>{dt[j]!==void 0&&(F[j]=dt[j])})}),F}const W={};function X(F,H){let U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:W;const $=N(F),dt=N(H),j=G.useMemo(()=>Object.assign({closeIcon:G.createElement(lt.Z,null)},U),[U]),mt=G.useMemo(()=>$===!1?!1:$?V(j,dt,$):dt===!1?!1:dt?V(j,dt):j.closable?j:!1,[$,dt,j]);return G.useMemo(()=>{if(mt===!1)return[!1,null];const{closeIconRender:Pt}=j,{closeIcon:tt}=mt;let vt=tt;if(vt!=null){Pt&&(vt=Pt(tt));const P=(0,Z.Z)(mt,!0);Object.keys(P).length&&(vt=G.isValidElement(vt)?G.cloneElement(vt,P):G.createElement("span",Object.assign({},P),vt))}return[!0,vt]},[mt,j])}},38925:function(Ot,ft,D){"use strict";D.d(ft,{Z:function(){return ae}});var G=D(67294),lt=D(89739),Z=D(4340),B=D(97937),N=D(21640),V=D(78860),W=D(93967),X=D.n(W),F=D(82225),H=D(42550),U=D(64217),$=D(96159),dt=D(53124),j=D(54548),mt=D(14747),Pt=D(91945);const tt=(It,Dt,et,_,ut)=>({background:It,border:`${(0,j.bf)(_.lineWidth)} ${_.lineType} ${Dt}`,[`${ut}-icon`]:{color:et}}),vt=It=>{const{componentCls:Dt,motionDurationSlow:et,marginXS:_,marginSM:ut,fontSize:Q,fontSizeLG:Bt,lineHeight:kt,borderRadiusLG:Qt,motionEaseInOutCirc:re,withDescriptionIconSize:Xt,colorText:Te,colorTextHeading:Wt,withDescriptionPadding:wn,defaultPadding:Pe}=It;return{[Dt]:Object.assign(Object.assign({},(0,mt.Wf)(It)),{position:"relative",display:"flex",alignItems:"center",padding:Pe,wordWrap:"break-word",borderRadius:Qt,[`&${Dt}-rtl`]:{direction:"rtl"},[`${Dt}-content`]:{flex:1,minWidth:0},[`${Dt}-icon`]:{marginInlineEnd:_,lineHeight:0},["&-description"]:{display:"none",fontSize:Q,lineHeight:kt},"&-message":{color:Wt},[`&${Dt}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${et} ${re}, opacity ${et} ${re},
        padding-top ${et} ${re}, padding-bottom ${et} ${re},
        margin-bottom ${et} ${re}`},[`&${Dt}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${Dt}-with-description`]:{alignItems:"flex-start",padding:wn,[`${Dt}-icon`]:{marginInlineEnd:ut,fontSize:Xt,lineHeight:0},[`${Dt}-message`]:{display:"block",marginBottom:_,color:Wt,fontSize:Bt},[`${Dt}-description`]:{display:"block",color:Te}},[`${Dt}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},P=It=>{const{componentCls:Dt,colorSuccess:et,colorSuccessBorder:_,colorSuccessBg:ut,colorWarning:Q,colorWarningBorder:Bt,colorWarningBg:kt,colorError:Qt,colorErrorBorder:re,colorErrorBg:Xt,colorInfo:Te,colorInfoBorder:Wt,colorInfoBg:wn}=It;return{[Dt]:{"&-success":tt(ut,_,et,It,Dt),"&-info":tt(wn,Wt,Te,It,Dt),"&-warning":tt(kt,Bt,Q,It,Dt),"&-error":Object.assign(Object.assign({},tt(Xt,re,Qt,It,Dt)),{[`${Dt}-description > pre`]:{margin:0,padding:0}})}}},Jt=It=>{const{componentCls:Dt,iconCls:et,motionDurationMid:_,marginXS:ut,fontSizeIcon:Q,colorIcon:Bt,colorIconHover:kt}=It;return{[Dt]:{["&-action"]:{marginInlineStart:ut},[`${Dt}-close-icon`]:{marginInlineStart:ut,padding:0,overflow:"hidden",fontSize:Q,lineHeight:(0,j.bf)(Q),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${et}-close`]:{color:Bt,transition:`color ${_}`,"&:hover":{color:kt}}},"&-close-text":{color:Bt,transition:`color ${_}`,"&:hover":{color:kt}}}}},ne=It=>({withDescriptionIconSize:It.fontSizeHeading3,defaultPadding:`${It.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${It.paddingMD}px ${It.paddingContentHorizontalLG}px`});var K=(0,Pt.I$)("Alert",It=>[vt(It),P(It),Jt(It)],ne),ve=function(It,Dt){var et={};for(var _ in It)Object.prototype.hasOwnProperty.call(It,_)&&Dt.indexOf(_)<0&&(et[_]=It[_]);if(It!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ut=0,_=Object.getOwnPropertySymbols(It);ut<_.length;ut++)Dt.indexOf(_[ut])<0&&Object.prototype.propertyIsEnumerable.call(It,_[ut])&&(et[_[ut]]=It[_[ut]]);return et};const ce={success:lt.Z,info:V.Z,error:Z.Z,warning:N.Z},ot=It=>{const{icon:Dt,prefixCls:et,type:_}=It,ut=ce[_]||null;return Dt?(0,$.wm)(Dt,G.createElement("span",{className:`${et}-icon`},Dt),()=>({className:X()(`${et}-icon`,{[Dt.props.className]:Dt.props.className})})):G.createElement(ut,{className:`${et}-icon`})},Gt=It=>{const{isClosable:Dt,prefixCls:et,closeIcon:_,handleClose:ut,ariaProps:Q}=It,Bt=_===!0||_===void 0?G.createElement(B.Z,null):_;return Dt?G.createElement("button",Object.assign({type:"button",onClick:ut,className:`${et}-close-icon`,tabIndex:0},Q),Bt):null};var Nt=G.forwardRef((It,Dt)=>{const{description:et,prefixCls:_,message:ut,banner:Q,className:Bt,rootClassName:kt,style:Qt,onMouseEnter:re,onMouseLeave:Xt,onClick:Te,afterClose:Wt,showIcon:wn,closable:Pe,closeText:Ut,closeIcon:Ee,action:vi,id:Sn}=It,_r=ve(It,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action","id"]),[ur,hr]=G.useState(!1),ue=G.useRef(null);G.useImperativeHandle(Dt,()=>({nativeElement:ue.current}));const{getPrefixCls:Oe,direction:Tr,alert:ie}=G.useContext(dt.E_),Xe=Oe("alert",_),[qr,ha,gi]=K(Xe),Qn=dr=>{var mi;hr(!0),(mi=It.onClose)===null||mi===void 0||mi.call(It,dr)},He=G.useMemo(()=>It.type!==void 0?It.type:Q?"warning":"info",[It.type,Q]),_n=G.useMemo(()=>typeof Pe=="object"&&Pe.closeIcon||Ut?!0:typeof Pe=="boolean"?Pe:Ee!==!1&&Ee!==null&&Ee!==void 0?!0:!!(ie!=null&&ie.closable),[Ut,Ee,Pe,ie==null?void 0:ie.closable]),zi=Q&&wn===void 0?!0:wn,fr=X()(Xe,`${Xe}-${He}`,{[`${Xe}-with-description`]:!!et,[`${Xe}-no-icon`]:!zi,[`${Xe}-banner`]:!!Q,[`${Xe}-rtl`]:Tr==="rtl"},ie==null?void 0:ie.className,Bt,kt,gi,ha),La=(0,U.Z)(_r,{aria:!0,data:!0}),Kf=G.useMemo(()=>{var dr,mi;return typeof Pe=="object"&&Pe.closeIcon?Pe.closeIcon:Ut||(Ee!==void 0?Ee:typeof(ie==null?void 0:ie.closable)=="object"&&(!((dr=ie==null?void 0:ie.closable)===null||dr===void 0)&&dr.closeIcon)?(mi=ie==null?void 0:ie.closable)===null||mi===void 0?void 0:mi.closeIcon:ie==null?void 0:ie.closeIcon)},[Ee,Pe,Ut,ie==null?void 0:ie.closeIcon]),kc=G.useMemo(()=>{const dr=Pe!=null?Pe:ie==null?void 0:ie.closable;if(typeof dr=="object"){const{closeIcon:mi}=dr;return ve(dr,["closeIcon"])}return{}},[Pe,ie==null?void 0:ie.closable]);return qr(G.createElement(F.ZP,{visible:!ur,motionName:`${Xe}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:dr=>({maxHeight:dr.offsetHeight}),onLeaveEnd:Wt},(dr,mi)=>{let{className:Lc,style:Ic}=dr;return G.createElement("div",Object.assign({id:Sn,ref:(0,H.sQ)(ue,mi),"data-show":!ur,className:X()(fr,Lc),style:Object.assign(Object.assign(Object.assign({},ie==null?void 0:ie.style),Qt),Ic),onMouseEnter:re,onMouseLeave:Xt,onClick:Te,role:"alert"},La),zi?G.createElement(ot,{description:et,icon:It.icon,prefixCls:Xe,type:He}):null,G.createElement("div",{className:`${Xe}-content`},ut?G.createElement("div",{className:`${Xe}-message`},ut):null,et?G.createElement("div",{className:`${Xe}-description`},et):null),vi?G.createElement("div",{className:`${Xe}-action`},vi):null,G.createElement(Gt,{isClosable:_n,prefixCls:Xe,closeIcon:Kf,handleClose:Qn,ariaProps:kc}))}))}),ye=D(15671),le=D(43144),In=D(53640),gt=D(60136),be=function(It){function Dt(){var et;return(0,ye.Z)(this,Dt),et=(0,In.Z)(this,Dt,arguments),et.state={error:void 0,info:{componentStack:""}},et}return(0,gt.Z)(Dt,It),(0,le.Z)(Dt,[{key:"componentDidCatch",value:function(_,ut){this.setState({error:_,info:ut})}},{key:"render",value:function(){const{message:_,description:ut,id:Q,children:Bt}=this.props,{error:kt,info:Qt}=this.state,re=Qt&&Qt.componentStack?Qt.componentStack:null,Xt=typeof _=="undefined"?(kt||"").toString():_,Te=typeof ut=="undefined"?re:ut;return kt?G.createElement(Nt,{id:Q,type:"error",message:Xt,description:G.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},Te)}):Bt}}])}(G.Component);const Yt=Nt;Yt.ErrorBoundary=be;var ae=Yt},26412:function(Ot,ft,D){"use strict";D.d(ft,{Z:function(){return Dt}});var G=D(67294),lt=D(93967),Z=D.n(lt),B=D(74443),N=D(53124),V=D(98675),W=D(25378),F={xxl:3,xl:3,lg:3,md:3,sm:2,xs:1},U=G.createContext({}),$=D(50344),dt=function(et,_){var ut={};for(var Q in et)Object.prototype.hasOwnProperty.call(et,Q)&&_.indexOf(Q)<0&&(ut[Q]=et[Q]);if(et!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Bt=0,Q=Object.getOwnPropertySymbols(et);Bt<Q.length;Bt++)_.indexOf(Q[Bt])<0&&Object.prototype.propertyIsEnumerable.call(et,Q[Bt])&&(ut[Q[Bt]]=et[Q[Bt]]);return ut};const j=et=>(0,$.Z)(et).map(_=>Object.assign(Object.assign({},_==null?void 0:_.props),{key:_.key}));function mt(et,_,ut){const Q=G.useMemo(()=>_||j(ut),[_,ut]);return G.useMemo(()=>Q.map(kt=>{var{span:Qt}=kt,re=dt(kt,["span"]);return Object.assign(Object.assign({},re),{span:typeof Qt=="number"?Qt:(0,B.m9)(et,Qt)})}),[Q,et])}function Pt(et,_,ut){let Q=et,Bt=!1;return(ut===void 0||ut>_)&&(Q=Object.assign(Object.assign({},et),{span:_}),Bt=ut!==void 0),[Q,Bt]}function tt(et,_){const ut=[];let Q=[],Bt=_,kt=!1;return et.filter(Qt=>Qt).forEach((Qt,re)=>{const Xt=Qt==null?void 0:Qt.span,Te=Xt||1;if(re===et.length-1){const[Wt,wn]=Pt(Qt,Bt,Xt);kt=kt||wn,Q.push(Wt),ut.push(Q);return}if(Te<Bt)Bt-=Te,Q.push(Qt);else{const[Wt,wn]=Pt(Qt,Bt,Te);kt=kt||wn,Q.push(Wt),ut.push(Q),Bt=_,Q=[]}}),[ut,kt]}var P=(et,_)=>{const[ut,Q]=(0,G.useMemo)(()=>tt(_,et),[_,et]);return ut},ne=et=>{let{children:_}=et;return _};function K(et){return et!=null}var ce=et=>{const{itemPrefixCls:_,component:ut,span:Q,className:Bt,style:kt,labelStyle:Qt,contentStyle:re,bordered:Xt,label:Te,content:Wt,colon:wn,type:Pe}=et,Ut=ut;return Xt?G.createElement(Ut,{className:Z()({[`${_}-item-label`]:Pe==="label",[`${_}-item-content`]:Pe==="content"},Bt),style:kt,colSpan:Q},K(Te)&&G.createElement("span",{style:Qt},Te),K(Wt)&&G.createElement("span",{style:re},Wt)):G.createElement(Ut,{className:Z()(`${_}-item`,Bt),style:kt,colSpan:Q},G.createElement("div",{className:`${_}-item-container`},(Te||Te===0)&&G.createElement("span",{className:Z()(`${_}-item-label`,{[`${_}-item-no-colon`]:!wn}),style:Qt},Te),(Wt||Wt===0)&&G.createElement("span",{className:Z()(`${_}-item-content`),style:re},Wt)))};function ot(et,_,ut){let{colon:Q,prefixCls:Bt,bordered:kt}=_,{component:Qt,type:re,showLabel:Xt,showContent:Te,labelStyle:Wt,contentStyle:wn}=ut;return et.map((Pe,Ut)=>{let{label:Ee,children:vi,prefixCls:Sn=Bt,className:_r,style:ur,labelStyle:hr,contentStyle:ue,span:Oe=1,key:Tr}=Pe;return typeof Qt=="string"?G.createElement(ce,{key:`${re}-${Tr||Ut}`,className:_r,style:ur,labelStyle:Object.assign(Object.assign({},Wt),hr),contentStyle:Object.assign(Object.assign({},wn),ue),span:Oe,colon:Q,component:Qt,itemPrefixCls:Sn,bordered:kt,label:Xt?Ee:null,content:Te?vi:null,type:re}):[G.createElement(ce,{key:`label-${Tr||Ut}`,className:_r,style:Object.assign(Object.assign(Object.assign({},Wt),ur),hr),span:1,colon:Q,component:Qt[0],itemPrefixCls:Sn,bordered:kt,label:Ee,type:"label"}),G.createElement(ce,{key:`content-${Tr||Ut}`,className:_r,style:Object.assign(Object.assign(Object.assign({},wn),ur),ue),span:Oe*2-1,component:Qt[1],itemPrefixCls:Sn,bordered:kt,content:vi,type:"content"})]})}var zt=et=>{const _=G.useContext(U),{prefixCls:ut,vertical:Q,row:Bt,index:kt,bordered:Qt}=et;return Q?G.createElement(G.Fragment,null,G.createElement("tr",{key:`label-${kt}`,className:`${ut}-row`},ot(Bt,et,Object.assign({component:"th",type:"label",showLabel:!0},_))),G.createElement("tr",{key:`content-${kt}`,className:`${ut}-row`},ot(Bt,et,Object.assign({component:"td",type:"content",showContent:!0},_)))):G.createElement("tr",{key:kt,className:`${ut}-row`},ot(Bt,et,Object.assign({component:Qt?["th","td"]:"td",type:"item",showLabel:!0,showContent:!0},_)))},Nt=D(54548),ye=D(14747),le=D(91945),In=D(45503);const gt=et=>{const{componentCls:_,labelBg:ut}=et;return{[`&${_}-bordered`]:{[`> ${_}-view`]:{border:`${(0,Nt.bf)(et.lineWidth)} ${et.lineType} ${et.colorSplit}`,"> table":{tableLayout:"auto"},[`${_}-row`]:{borderBottom:`${(0,Nt.bf)(et.lineWidth)} ${et.lineType} ${et.colorSplit}`,"&:last-child":{borderBottom:"none"},[`> ${_}-item-label, > ${_}-item-content`]:{padding:`${(0,Nt.bf)(et.padding)} ${(0,Nt.bf)(et.paddingLG)}`,borderInlineEnd:`${(0,Nt.bf)(et.lineWidth)} ${et.lineType} ${et.colorSplit}`,"&:last-child":{borderInlineEnd:"none"}},[`> ${_}-item-label`]:{color:et.colorTextSecondary,backgroundColor:ut,"&::after":{display:"none"}}}},[`&${_}-middle`]:{[`${_}-row`]:{[`> ${_}-item-label, > ${_}-item-content`]:{padding:`${(0,Nt.bf)(et.paddingSM)} ${(0,Nt.bf)(et.paddingLG)}`}}},[`&${_}-small`]:{[`${_}-row`]:{[`> ${_}-item-label, > ${_}-item-content`]:{padding:`${(0,Nt.bf)(et.paddingXS)} ${(0,Nt.bf)(et.padding)}`}}}}}},de=et=>{const{componentCls:_,extraColor:ut,itemPaddingBottom:Q,colonMarginRight:Bt,colonMarginLeft:kt,titleMarginBottom:Qt}=et;return{[_]:Object.assign(Object.assign(Object.assign({},(0,ye.Wf)(et)),gt(et)),{["&-rtl"]:{direction:"rtl"},[`${_}-header`]:{display:"flex",alignItems:"center",marginBottom:Qt},[`${_}-title`]:Object.assign(Object.assign({},ye.vS),{flex:"auto",color:et.titleColor,fontWeight:et.fontWeightStrong,fontSize:et.fontSizeLG,lineHeight:et.lineHeightLG}),[`${_}-extra`]:{marginInlineStart:"auto",color:ut,fontSize:et.fontSize},[`${_}-view`]:{width:"100%",borderRadius:et.borderRadiusLG,table:{width:"100%",tableLayout:"fixed",borderCollapse:"collapse"}},[`${_}-row`]:{"> th, > td":{paddingBottom:Q},"&:last-child":{borderBottom:"none"}},[`${_}-item-label`]:{color:et.colorTextTertiary,fontWeight:"normal",fontSize:et.fontSize,lineHeight:et.lineHeight,textAlign:"start","&::after":{content:'":"',position:"relative",top:-.5,marginInline:`${(0,Nt.bf)(kt)} ${(0,Nt.bf)(Bt)}`},[`&${_}-item-no-colon::after`]:{content:'""'}},[`${_}-item-no-label`]:{"&::after":{margin:0,content:'""'}},[`${_}-item-content`]:{display:"table-cell",flex:1,color:et.contentColor,fontSize:et.fontSize,lineHeight:et.lineHeight,wordBreak:"break-word",overflowWrap:"break-word"},[`${_}-item`]:{paddingBottom:0,verticalAlign:"top","&-container":{display:"flex",[`${_}-item-label`]:{display:"inline-flex",alignItems:"baseline"},[`${_}-item-content`]:{display:"inline-flex",alignItems:"baseline"}}},"&-middle":{[`${_}-row`]:{"> th, > td":{paddingBottom:et.paddingSM}}},"&-small":{[`${_}-row`]:{"> th, > td":{paddingBottom:et.paddingXS}}}})}},be=et=>({labelBg:et.colorFillAlter,titleColor:et.colorText,titleMarginBottom:et.fontSizeSM*et.lineHeightSM,itemPaddingBottom:et.padding,colonMarginRight:et.marginXS,colonMarginLeft:et.marginXXS/2,contentColor:et.colorText,extraColor:et.colorText});var Yt=(0,le.I$)("Descriptions",et=>{const _=(0,In.TS)(et,{});return de(_)},be),ae=function(et,_){var ut={};for(var Q in et)Object.prototype.hasOwnProperty.call(et,Q)&&_.indexOf(Q)<0&&(ut[Q]=et[Q]);if(et!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Bt=0,Q=Object.getOwnPropertySymbols(et);Bt<Q.length;Bt++)_.indexOf(Q[Bt])<0&&Object.prototype.propertyIsEnumerable.call(et,Q[Bt])&&(ut[Q[Bt]]=et[Q[Bt]]);return ut};const It=et=>{const{prefixCls:_,title:ut,extra:Q,column:Bt,colon:kt=!0,bordered:Qt,layout:re,children:Xt,className:Te,rootClassName:Wt,style:wn,size:Pe,labelStyle:Ut,contentStyle:Ee,items:vi}=et,Sn=ae(et,["prefixCls","title","extra","column","colon","bordered","layout","children","className","rootClassName","style","size","labelStyle","contentStyle","items"]),{getPrefixCls:_r,direction:ur,descriptions:hr}=G.useContext(N.E_),ue=_r("descriptions",_),Oe=(0,W.Z)(),Tr=G.useMemo(()=>{var _n;return typeof Bt=="number"?Bt:(_n=(0,B.m9)(Oe,Object.assign(Object.assign({},F),Bt)))!==null&&_n!==void 0?_n:3},[Oe,Bt]),ie=mt(Oe,vi,Xt),Xe=(0,V.Z)(Pe),qr=P(Tr,ie),[ha,gi,Qn]=Yt(ue),He=G.useMemo(()=>({labelStyle:Ut,contentStyle:Ee}),[Ut,Ee]);return ha(G.createElement(U.Provider,{value:He},G.createElement("div",Object.assign({className:Z()(ue,hr==null?void 0:hr.className,{[`${ue}-${Xe}`]:Xe&&Xe!=="default",[`${ue}-bordered`]:!!Qt,[`${ue}-rtl`]:ur==="rtl"},Te,Wt,gi,Qn),style:Object.assign(Object.assign({},hr==null?void 0:hr.style),wn)},Sn),(ut||Q)&&G.createElement("div",{className:`${ue}-header`},ut&&G.createElement("div",{className:`${ue}-title`},ut),Q&&G.createElement("div",{className:`${ue}-extra`},Q)),G.createElement("div",{className:`${ue}-view`},G.createElement("table",null,G.createElement("tbody",null,qr.map((_n,zi)=>G.createElement(zt,{key:zi,index:zi,colon:kt,prefixCls:ue,vertical:re==="vertical",bordered:Qt,row:_n}))))))))};It.Item=ne;var Dt=It},66309:function(Ot,ft,D){"use strict";D.d(ft,{Z:function(){return In}});var G=D(67294),lt=D(93967),Z=D.n(lt),B=D(98423),N=D(98787),V=D(69760),W=D(96159),X=D(45353),F=D(53124),H=D(54548),U=D(10274),$=D(14747),dt=D(45503),j=D(91945);const mt=gt=>{const{paddingXXS:de,lineWidth:be,tagPaddingHorizontal:Yt,componentCls:ae,calc:It}=gt,Dt=It(Yt).sub(be).equal(),et=It(de).sub(be).equal();return{[ae]:Object.assign(Object.assign({},(0,$.Wf)(gt)),{display:"inline-block",height:"auto",marginInlineEnd:gt.marginXS,paddingInline:Dt,fontSize:gt.tagFontSize,lineHeight:gt.tagLineHeight,whiteSpace:"nowrap",background:gt.defaultBg,border:`${(0,H.bf)(gt.lineWidth)} ${gt.lineType} ${gt.colorBorder}`,borderRadius:gt.borderRadiusSM,opacity:1,transition:`all ${gt.motionDurationMid}`,textAlign:"start",position:"relative",[`&${ae}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:gt.defaultColor},[`${ae}-close-icon`]:{marginInlineStart:et,fontSize:gt.tagIconSize,color:gt.colorTextDescription,cursor:"pointer",transition:`all ${gt.motionDurationMid}`,"&:hover":{color:gt.colorTextHeading}},[`&${ae}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${gt.iconCls}-close, ${gt.iconCls}-close:hover`]:{color:gt.colorTextLightSolid}},["&-checkable"]:{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${ae}-checkable-checked):hover`]:{color:gt.colorPrimary,backgroundColor:gt.colorFillSecondary},"&:active, &-checked":{color:gt.colorTextLightSolid},"&-checked":{backgroundColor:gt.colorPrimary,"&:hover":{backgroundColor:gt.colorPrimaryHover}},"&:active":{backgroundColor:gt.colorPrimaryActive}},["&-hidden"]:{display:"none"},[`> ${gt.iconCls} + span, > span + ${gt.iconCls}`]:{marginInlineStart:Dt}}),[`${ae}-borderless`]:{borderColor:"transparent",background:gt.tagBorderlessBg}}},Pt=gt=>{const{lineWidth:de,fontSizeIcon:be,calc:Yt}=gt,ae=gt.fontSizeSM;return(0,dt.TS)(gt,{tagFontSize:ae,tagLineHeight:(0,H.bf)(Yt(gt.lineHeightSM).mul(ae).equal()),tagIconSize:Yt(be).sub(Yt(de).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:gt.defaultBg})},tt=gt=>({defaultBg:new U.C(gt.colorFillQuaternary).onBackground(gt.colorBgContainer).toHexString(),defaultColor:gt.colorText});var vt=(0,j.I$)("Tag",gt=>{const de=Pt(gt);return mt(de)},tt),P=function(gt,de){var be={};for(var Yt in gt)Object.prototype.hasOwnProperty.call(gt,Yt)&&de.indexOf(Yt)<0&&(be[Yt]=gt[Yt]);if(gt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ae=0,Yt=Object.getOwnPropertySymbols(gt);ae<Yt.length;ae++)de.indexOf(Yt[ae])<0&&Object.prototype.propertyIsEnumerable.call(gt,Yt[ae])&&(be[Yt[ae]]=gt[Yt[ae]]);return be},ne=G.forwardRef((gt,de)=>{const{prefixCls:be,style:Yt,className:ae,checked:It,onChange:Dt,onClick:et}=gt,_=P(gt,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:ut,tag:Q}=G.useContext(F.E_),Bt=Wt=>{Dt==null||Dt(!It),et==null||et(Wt)},kt=ut("tag",be),[Qt,re,Xt]=vt(kt),Te=Z()(kt,`${kt}-checkable`,{[`${kt}-checkable-checked`]:It},Q==null?void 0:Q.className,ae,re,Xt);return Qt(G.createElement("span",Object.assign({},_,{ref:de,style:Object.assign(Object.assign({},Yt),Q==null?void 0:Q.style),className:Te,onClick:Bt})))}),K=D(98719);const ve=gt=>(0,K.Z)(gt,(de,be)=>{let{textColor:Yt,lightBorderColor:ae,lightColor:It,darkColor:Dt}=be;return{[`${gt.componentCls}${gt.componentCls}-${de}`]:{color:Yt,background:It,borderColor:ae,"&-inverse":{color:gt.colorTextLightSolid,background:Dt,borderColor:Dt},[`&${gt.componentCls}-borderless`]:{borderColor:"transparent"}}}});var ce=(0,j.bk)(["Tag","preset"],gt=>{const de=Pt(gt);return ve(de)},tt);function ot(gt){return typeof gt!="string"?gt:gt.charAt(0).toUpperCase()+gt.slice(1)}const Gt=(gt,de,be)=>{const Yt=ot(be);return{[`${gt.componentCls}${gt.componentCls}-${de}`]:{color:gt[`color${be}`],background:gt[`color${Yt}Bg`],borderColor:gt[`color${Yt}Border`],[`&${gt.componentCls}-borderless`]:{borderColor:"transparent"}}}};var zt=(0,j.bk)(["Tag","status"],gt=>{const de=Pt(gt);return[Gt(de,"success","Success"),Gt(de,"processing","Info"),Gt(de,"error","Error"),Gt(de,"warning","Warning")]},tt),Nt=function(gt,de){var be={};for(var Yt in gt)Object.prototype.hasOwnProperty.call(gt,Yt)&&de.indexOf(Yt)<0&&(be[Yt]=gt[Yt]);if(gt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ae=0,Yt=Object.getOwnPropertySymbols(gt);ae<Yt.length;ae++)de.indexOf(Yt[ae])<0&&Object.prototype.propertyIsEnumerable.call(gt,Yt[ae])&&(be[Yt[ae]]=gt[Yt[ae]]);return be};const le=G.forwardRef((gt,de)=>{const{prefixCls:be,className:Yt,rootClassName:ae,style:It,children:Dt,icon:et,color:_,onClose:ut,bordered:Q=!0,visible:Bt}=gt,kt=Nt(gt,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:Qt,direction:re,tag:Xt}=G.useContext(F.E_),[Te,Wt]=G.useState(!0),wn=(0,B.Z)(kt,["closeIcon","closable"]);G.useEffect(()=>{Bt!==void 0&&Wt(Bt)},[Bt]);const Pe=(0,N.o2)(_),Ut=(0,N.yT)(_),Ee=Pe||Ut,vi=Object.assign(Object.assign({backgroundColor:_&&!Ee?_:void 0},Xt==null?void 0:Xt.style),It),Sn=Qt("tag",be),[_r,ur,hr]=vt(Sn),ue=Z()(Sn,Xt==null?void 0:Xt.className,{[`${Sn}-${_}`]:Ee,[`${Sn}-has-color`]:_&&!Ee,[`${Sn}-hidden`]:!Te,[`${Sn}-rtl`]:re==="rtl",[`${Sn}-borderless`]:!Q},Yt,ae,ur,hr),Oe=gi=>{gi.stopPropagation(),ut==null||ut(gi),!gi.defaultPrevented&&Wt(!1)},[,Tr]=(0,V.Z)((0,V.w)(gt),(0,V.w)(Xt),{closable:!1,closeIconRender:gi=>{const Qn=G.createElement("span",{className:`${Sn}-close-icon`,onClick:Oe},gi);return(0,W.wm)(gi,Qn,He=>({onClick:_n=>{var zi;(zi=He==null?void 0:He.onClick)===null||zi===void 0||zi.call(He,_n),Oe(_n)},className:Z()(He==null?void 0:He.className,`${Sn}-close-icon`)}))}}),ie=typeof kt.onClick=="function"||Dt&&Dt.type==="a",Xe=et||null,qr=Xe?G.createElement(G.Fragment,null,Xe,Dt&&G.createElement("span",null,Dt)):Dt,ha=G.createElement("span",Object.assign({},wn,{ref:de,className:ue,style:vi}),qr,Tr,Pe&&G.createElement(ce,{key:"preset",prefixCls:Sn}),Ut&&G.createElement(zt,{key:"status",prefixCls:Sn}));return _r(ie?G.createElement(X.Z,{component:"Tag"},ha):ha)});le.CheckableTag=ne;var In=le},8874:function(Ot){"use strict";Ot.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},19818:function(Ot,ft,D){var G=D(8874),lt=D(86851),Z=Object.hasOwnProperty,B=Object.create(null);for(var N in G)Z.call(G,N)&&(B[G[N]]=N);var V=Ot.exports={to:{},get:{}};V.get=function(F){var H=F.substring(0,3).toLowerCase(),U,$;switch(H){case"hsl":U=V.get.hsl(F),$="hsl";break;case"hwb":U=V.get.hwb(F),$="hwb";break;default:U=V.get.rgb(F),$="rgb";break}return U?{model:$,value:U}:null},V.get.rgb=function(F){if(!F)return null;var H=/^#([a-f0-9]{3,4})$/i,U=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,$=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,dt=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,j=/^(\w+)$/,mt=[0,0,0,1],Pt,tt,vt;if(Pt=F.match(U)){for(vt=Pt[2],Pt=Pt[1],tt=0;tt<3;tt++){var P=tt*2;mt[tt]=parseInt(Pt.slice(P,P+2),16)}vt&&(mt[3]=parseInt(vt,16)/255)}else if(Pt=F.match(H)){for(Pt=Pt[1],vt=Pt[3],tt=0;tt<3;tt++)mt[tt]=parseInt(Pt[tt]+Pt[tt],16);vt&&(mt[3]=parseInt(vt+vt,16)/255)}else if(Pt=F.match($)){for(tt=0;tt<3;tt++)mt[tt]=parseInt(Pt[tt+1],0);Pt[4]&&(Pt[5]?mt[3]=parseFloat(Pt[4])*.01:mt[3]=parseFloat(Pt[4]))}else if(Pt=F.match(dt)){for(tt=0;tt<3;tt++)mt[tt]=Math.round(parseFloat(Pt[tt+1])*2.55);Pt[4]&&(Pt[5]?mt[3]=parseFloat(Pt[4])*.01:mt[3]=parseFloat(Pt[4]))}else return(Pt=F.match(j))?Pt[1]==="transparent"?[0,0,0,0]:Z.call(G,Pt[1])?(mt=G[Pt[1]],mt[3]=1,mt):null:null;for(tt=0;tt<3;tt++)mt[tt]=W(mt[tt],0,255);return mt[3]=W(mt[3],0,1),mt},V.get.hsl=function(F){if(!F)return null;var H=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,U=F.match(H);if(U){var $=parseFloat(U[4]),dt=(parseFloat(U[1])%360+360)%360,j=W(parseFloat(U[2]),0,100),mt=W(parseFloat(U[3]),0,100),Pt=W(isNaN($)?1:$,0,1);return[dt,j,mt,Pt]}return null},V.get.hwb=function(F){if(!F)return null;var H=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,U=F.match(H);if(U){var $=parseFloat(U[4]),dt=(parseFloat(U[1])%360+360)%360,j=W(parseFloat(U[2]),0,100),mt=W(parseFloat(U[3]),0,100),Pt=W(isNaN($)?1:$,0,1);return[dt,j,mt,Pt]}return null},V.to.hex=function(){var F=lt(arguments);return"#"+X(F[0])+X(F[1])+X(F[2])+(F[3]<1?X(Math.round(F[3]*255)):"")},V.to.rgb=function(){var F=lt(arguments);return F.length<4||F[3]===1?"rgb("+Math.round(F[0])+", "+Math.round(F[1])+", "+Math.round(F[2])+")":"rgba("+Math.round(F[0])+", "+Math.round(F[1])+", "+Math.round(F[2])+", "+F[3]+")"},V.to.rgb.percent=function(){var F=lt(arguments),H=Math.round(F[0]/255*100),U=Math.round(F[1]/255*100),$=Math.round(F[2]/255*100);return F.length<4||F[3]===1?"rgb("+H+"%, "+U+"%, "+$+"%)":"rgba("+H+"%, "+U+"%, "+$+"%, "+F[3]+")"},V.to.hsl=function(){var F=lt(arguments);return F.length<4||F[3]===1?"hsl("+F[0]+", "+F[1]+"%, "+F[2]+"%)":"hsla("+F[0]+", "+F[1]+"%, "+F[2]+"%, "+F[3]+")"},V.to.hwb=function(){var F=lt(arguments),H="";return F.length>=4&&F[3]!==1&&(H=", "+F[3]),"hwb("+F[0]+", "+F[1]+"%, "+F[2]+"%"+H+")"},V.to.keyword=function(F){return B[F.slice(0,3)]};function W(F,H,U){return Math.min(Math.max(H,F),U)}function X(F){var H=Math.round(F).toString(16).toUpperCase();return H.length<2?"0"+H:H}},26729:function(Ot){"use strict";var ft=Object.prototype.hasOwnProperty,D="~";function G(){}Object.create&&(G.prototype=Object.create(null),new G().__proto__||(D=!1));function lt(V,W,X){this.fn=V,this.context=W,this.once=X||!1}function Z(V,W,X,F,H){if(typeof X!="function")throw new TypeError("The listener must be a function");var U=new lt(X,F||V,H),$=D?D+W:W;return V._events[$]?V._events[$].fn?V._events[$]=[V._events[$],U]:V._events[$].push(U):(V._events[$]=U,V._eventsCount++),V}function B(V,W){--V._eventsCount===0?V._events=new G:delete V._events[W]}function N(){this._events=new G,this._eventsCount=0}N.prototype.eventNames=function(){var W=[],X,F;if(this._eventsCount===0)return W;for(F in X=this._events)ft.call(X,F)&&W.push(D?F.slice(1):F);return Object.getOwnPropertySymbols?W.concat(Object.getOwnPropertySymbols(X)):W},N.prototype.listeners=function(W){var X=D?D+W:W,F=this._events[X];if(!F)return[];if(F.fn)return[F.fn];for(var H=0,U=F.length,$=new Array(U);H<U;H++)$[H]=F[H].fn;return $},N.prototype.listenerCount=function(W){var X=D?D+W:W,F=this._events[X];return F?F.fn?1:F.length:0},N.prototype.emit=function(W,X,F,H,U,$){var dt=D?D+W:W;if(!this._events[dt])return!1;var j=this._events[dt],mt=arguments.length,Pt,tt;if(j.fn){switch(j.once&&this.removeListener(W,j.fn,void 0,!0),mt){case 1:return j.fn.call(j.context),!0;case 2:return j.fn.call(j.context,X),!0;case 3:return j.fn.call(j.context,X,F),!0;case 4:return j.fn.call(j.context,X,F,H),!0;case 5:return j.fn.call(j.context,X,F,H,U),!0;case 6:return j.fn.call(j.context,X,F,H,U,$),!0}for(tt=1,Pt=new Array(mt-1);tt<mt;tt++)Pt[tt-1]=arguments[tt];j.fn.apply(j.context,Pt)}else{var vt=j.length,P;for(tt=0;tt<vt;tt++)switch(j[tt].once&&this.removeListener(W,j[tt].fn,void 0,!0),mt){case 1:j[tt].fn.call(j[tt].context);break;case 2:j[tt].fn.call(j[tt].context,X);break;case 3:j[tt].fn.call(j[tt].context,X,F);break;case 4:j[tt].fn.call(j[tt].context,X,F,H);break;default:if(!Pt)for(P=1,Pt=new Array(mt-1);P<mt;P++)Pt[P-1]=arguments[P];j[tt].fn.apply(j[tt].context,Pt)}}return!0},N.prototype.on=function(W,X,F){return Z(this,W,X,F,!1)},N.prototype.once=function(W,X,F){return Z(this,W,X,F,!0)},N.prototype.removeListener=function(W,X,F,H){var U=D?D+W:W;if(!this._events[U])return this;if(!X)return B(this,U),this;var $=this._events[U];if($.fn)$.fn===X&&(!H||$.once)&&(!F||$.context===F)&&B(this,U);else{for(var dt=0,j=[],mt=$.length;dt<mt;dt++)($[dt].fn!==X||H&&!$[dt].once||F&&$[dt].context!==F)&&j.push($[dt]);j.length?this._events[U]=j.length===1?j[0]:j:B(this,U)}return this},N.prototype.removeAllListeners=function(W){var X;return W?(X=D?D+W:W,this._events[X]&&B(this,X)):(this._events=new G,this._eventsCount=0),this},N.prototype.off=N.prototype.removeListener,N.prototype.addListener=N.prototype.on,N.prefixed=D,N.EventEmitter=N,Ot.exports=N},80817:function(Ot){function ft(Z,B,N){return(B[0]-Z[0])*(N[1]-Z[1])-(B[1]-Z[1])*(N[0]-Z[0])}function D(Z){const B=[];for(let N=0;N<Z.length;N++){for(;B.length>=2&&ft(B[B.length-2],B[B.length-1],Z[N])<=0;)B.pop();B.push(Z[N])}return B.pop(),B}function G(Z){const B=Z.reverse(),N=[];for(let V=0;V<B.length;V++){for(;N.length>=2&&ft(N[N.length-2],N[N.length-1],B[V])<=0;)N.pop();N.push(B[V])}return N.pop(),N}function lt(Z){const B=D(Z),V=G(Z).concat(B);return V.push(Z[0]),V}Ot.exports=lt},63652:function(Ot){Ot.exports={toXy:function(ft,D){return D===void 0?ft.slice():ft.map(function(G){return new Function("pt","return [pt"+D[0]+",pt"+D[1]+"];")(G)})},fromXy:function(ft,D){return D===void 0?ft.slice():ft.map(function(G){return new Function("pt","const o = {}; o"+D[0]+"= pt[0]; o"+D[1]+"= pt[1]; return o;")(G)})}}},58867:function(Ot){function ft(G,lt){this._cells=[],this._cellSize=lt,this._reverseCellSize=1/lt;for(let Z=0;Z<G.length;Z++){const B=G[Z],N=this.coordToCellNum(B[0]),V=this.coordToCellNum(B[1]);if(this._cells[N])this._cells[N][V]?this._cells[N][V].push(B):this._cells[N][V]=[B];else{const W=[];W[V]=[B],this._cells[N]=W}}}ft.prototype={cellPoints:function(G,lt){return this._cells[G]!==void 0&&this._cells[G][lt]!==void 0?this._cells[G][lt]:[]},rangePoints:function(G){const lt=this.coordToCellNum(G[0]),Z=this.coordToCellNum(G[1]),B=this.coordToCellNum(G[2]),N=this.coordToCellNum(G[3]),V=[];for(let W=lt;W<=B;W++)for(let X=Z;X<=N;X++)for(let F=0;F<this.cellPoints(W,X).length;F++)V.push(this.cellPoints(W,X)[F]);return V},removePoint:function(G){const lt=this.coordToCellNum(G[0]),Z=this.coordToCellNum(G[1]),B=this._cells[lt][Z];let N;for(let V=0;V<B.length;V++)if(B[V][0]===G[0]&&B[V][1]===G[1]){N=V;break}return B.splice(N,1),B},trunc:Math.trunc||function(G){return G-G%1},coordToCellNum:function(G){return this.trunc(G*this._reverseCellSize)},extendBbox:function(G,lt){return[G[0]-lt*this._cellSize,G[1]-lt*this._cellSize,G[2]+lt*this._cellSize,G[3]+lt*this._cellSize]}};function D(G,lt){return new ft(G,lt)}Ot.exports=D},1344:function(Ot,ft,D){"use strict";const G=D(77444),lt=D(58867),Z=D(63652),B=D(80817);function N(tt){const vt=[tt[0]];let P=tt[0];for(let Jt=1;Jt<tt.length;Jt++){const ne=tt[Jt];(P[0]!==ne[0]||P[1]!==ne[1])&&vt.push(ne),P=ne}return vt}function V(tt){return tt.sort(function(vt,P){return vt[0]-P[0]||vt[1]-P[1]})}function W(tt,vt){return Math.pow(vt[0]-tt[0],2)+Math.pow(vt[1]-tt[1],2)}function X(tt,vt,P){const Jt=[vt[0]-tt[0],vt[1]-tt[1]],ne=[P[0]-tt[0],P[1]-tt[1]],K=W(tt,vt),ve=W(tt,P);return(Jt[0]*ne[0]+Jt[1]*ne[1])/Math.sqrt(K*ve)}function F(tt,vt){for(let P=0;P<vt.length-1;P++){const Jt=[vt[P],vt[P+1]];if(!(tt[0][0]===Jt[0][0]&&tt[0][1]===Jt[0][1]||tt[0][0]===Jt[1][0]&&tt[0][1]===Jt[1][1])&&G(tt,Jt))return!0}return!1}function H(tt){let vt=1/0,P=1/0,Jt=-1/0,ne=-1/0;for(let K=tt.length-1;K>=0;K--)tt[K][0]<vt&&(vt=tt[K][0]),tt[K][1]<P&&(P=tt[K][1]),tt[K][0]>Jt&&(Jt=tt[K][0]),tt[K][1]>ne&&(ne=tt[K][1]);return[Jt-vt,ne-P]}function U(tt){return[Math.min(tt[0][0],tt[1][0]),Math.min(tt[0][1],tt[1][1]),Math.max(tt[0][0],tt[1][0]),Math.max(tt[0][1],tt[1][1])]}function $(tt,vt,P){let Jt=null,ne=mt,K=mt,ve,ce;for(let ot=0;ot<vt.length;ot++)ve=X(tt[0],tt[1],vt[ot]),ce=X(tt[1],tt[0],vt[ot]),ve>ne&&ce>K&&!F([tt[0],vt[ot]],P)&&!F([tt[1],vt[ot]],P)&&(ne=ve,K=ce,Jt=vt[ot]);return Jt}function dt(tt,vt,P,Jt,ne){let K=!1;for(let ve=0;ve<tt.length-1;ve++){const ce=[tt[ve],tt[ve+1]],ot=ce[0][0]+","+ce[0][1]+","+ce[1][0]+","+ce[1][1];if(W(ce[0],ce[1])<vt||ne.has(ot))continue;let Gt=0,zt=U(ce),Nt,ye,le;do zt=Jt.extendBbox(zt,Gt),Nt=zt[2]-zt[0],ye=zt[3]-zt[1],le=$(ce,Jt.rangePoints(zt),tt),Gt++;while(le===null&&(P[0]>Nt||P[1]>ye));Nt>=P[0]&&ye>=P[1]&&ne.add(ot),le!==null&&(tt.splice(ve+1,0,le),Jt.removePoint(le),K=!0)}return K?dt(tt,vt,P,Jt,ne):tt}function j(tt,vt,P){let Jt=vt||20;const ne=N(V(Z.toXy(tt,P)));if(ne.length<4){const Nt=ne.concat([ne[0]]);return P?Z.fromXy(Nt,P):Nt}const K=H(ne),ve=[K[0]*Pt,K[1]*Pt],ce=B(ne),ot=ne.filter(function(Nt){return ce.indexOf(Nt)<0}),Gt=Math.ceil(1/(ne.length/(K[0]*K[1]))),zt=dt(ce,Math.pow(Jt,2),ve,lt(ot,Gt),new Set);return P?Z.fromXy(zt,P):zt}const mt=Math.cos(90/(180/Math.PI)),Pt=.6;Ot.exports=j},77444:function(Ot){function ft(G,lt,Z,B,N,V){const W=(V-lt)*(Z-G)-(B-lt)*(N-G);return W>0?!0:!(W<0)}function D(G,lt){const Z=G[0][0],B=G[0][1],N=G[1][0],V=G[1][1],W=lt[0][0],X=lt[0][1],F=lt[1][0],H=lt[1][1];return ft(Z,B,W,X,F,H)!==ft(N,V,W,X,F,H)&&ft(Z,B,N,V,W,X)!==ft(Z,B,N,V,F,H)}Ot.exports=D},35171:function(Ot){Ot.exports=function(D){return!D||typeof D=="string"?!1:D instanceof Array||Array.isArray(D)||D.length>=0&&(D.splice instanceof Function||Object.getOwnPropertyDescriptor(D,D.length-1)&&D.constructor.name!=="String")}},97005:function(Ot,ft,D){var G;function lt(W){if(!W||typeof window=="undefined")return;const X=document.createElement("style");return X.setAttribute("type","text/css"),X.innerHTML=W,document.head.appendChild(X),W}G={value:!0};var Z=D(67294);function B(W){return W&&typeof W=="object"&&"default"in W?W:{default:W}}var N=B(Z);lt(`.rfm-marquee-container {
  overflow-x: hidden;
  display: flex;
  flex-direction: row;
  position: relative;
  width: var(--width);
  transform: var(--transform);
}
.rfm-marquee-container:hover div {
  animation-play-state: var(--pause-on-hover);
}
.rfm-marquee-container:active div {
  animation-play-state: var(--pause-on-click);
}

.rfm-overlay {
  position: absolute;
  width: 100%;
  height: 100%;
}
.rfm-overlay::before, .rfm-overlay::after {
  background: linear-gradient(to right, var(--gradient-color), rgba(255, 255, 255, 0));
  content: "";
  height: 100%;
  position: absolute;
  width: var(--gradient-width);
  z-index: 2;
  pointer-events: none;
  touch-action: none;
}
.rfm-overlay::after {
  right: 0;
  top: 0;
  transform: rotateZ(180deg);
}
.rfm-overlay::before {
  left: 0;
  top: 0;
}

.rfm-marquee {
  flex: 0 0 auto;
  min-width: var(--min-width);
  z-index: 1;
  display: flex;
  flex-direction: row;
  align-items: center;
  animation: scroll var(--duration) linear var(--delay) var(--iteration-count);
  animation-play-state: var(--play);
  animation-delay: var(--delay);
  animation-direction: var(--direction);
}
@keyframes scroll {
  0% {
    transform: translateX(0%);
  }
  100% {
    transform: translateX(-100%);
  }
}

.rfm-initial-child-container {
  flex: 0 0 auto;
  display: flex;
  min-width: auto;
  flex-direction: row;
  align-items: center;
}

.rfm-child {
  transform: var(--transform);
}`);const V=Z.forwardRef(function({style:X={},className:F="",autoFill:H=!1,play:U=!0,pauseOnHover:$=!1,pauseOnClick:dt=!1,direction:j="left",speed:mt=50,delay:Pt=0,loop:tt=0,gradient:vt=!1,gradientColor:P="white",gradientWidth:Jt=200,onFinish:ne,onCycleComplete:K,onMount:ve,children:ce},ot){const[Gt,zt]=Z.useState(0),[Nt,ye]=Z.useState(0),[le,In]=Z.useState(1),[gt,de]=Z.useState(!1),be=Z.useRef(null),Yt=ot||be,ae=Z.useRef(null),It=Z.useCallback(()=>{if(ae.current&&Yt.current){const kt=Yt.current.getBoundingClientRect(),Qt=ae.current.getBoundingClientRect();let re=kt.width,Xt=Qt.width;(j==="up"||j==="down")&&(re=kt.height,Xt=Qt.height),In(H&&re&&Xt&&Xt<re?Math.ceil(re/Xt):1),zt(re),ye(Xt)}},[H,Yt,j]);Z.useEffect(()=>{if(gt&&(It(),ae.current&&Yt.current)){const kt=new ResizeObserver(()=>It());return kt.observe(Yt.current),kt.observe(ae.current),()=>{kt&&kt.disconnect()}}},[It,Yt,gt]),Z.useEffect(()=>{It()},[It,ce]),Z.useEffect(()=>{de(!0)},[]),Z.useEffect(()=>{typeof ve=="function"&&ve()},[]);const Dt=Z.useMemo(()=>H?Nt*le/mt:Nt<Gt?Gt/mt:Nt/mt,[H,Gt,Nt,le,mt]),et=Z.useMemo(()=>Object.assign(Object.assign({},X),{["--pause-on-hover"]:!U||$?"paused":"running",["--pause-on-click"]:!U||$&&!dt||dt?"paused":"running",["--width"]:j==="up"||j==="down"?"100vh":"100%",["--transform"]:j==="up"?"rotate(-90deg)":j==="down"?"rotate(90deg)":"none"}),[X,U,$,dt,j]),_=Z.useMemo(()=>({["--gradient-color"]:P,["--gradient-width"]:typeof Jt=="number"?`${Jt}px`:Jt}),[P,Jt]),ut=Z.useMemo(()=>({["--play"]:U?"running":"paused",["--direction"]:j==="left"?"normal":"reverse",["--duration"]:`${Dt}s`,["--delay"]:`${Pt}s`,["--iteration-count"]:tt?`${tt}`:"infinite",["--min-width"]:H?"auto":"100%"}),[U,j,Dt,Pt,tt,H]),Q=Z.useMemo(()=>({["--transform"]:j==="up"?"rotate(90deg)":j==="down"?"rotate(-90deg)":"none"}),[j]),Bt=Z.useCallback(kt=>[...Array(Number.isFinite(kt)&&kt>=0?kt:0)].map((Qt,re)=>N.default.createElement(Z.Fragment,{key:re},Z.Children.map(ce,Xt=>N.default.createElement("div",{style:Q,className:"rfm-child"},Xt)))),[Q,ce]);return gt?N.default.createElement("div",{ref:Yt,style:et,className:"rfm-marquee-container "+F},vt&&N.default.createElement("div",{style:_,className:"rfm-overlay"}),N.default.createElement("div",{className:"rfm-marquee",style:ut,onAnimationIteration:K,onAnimationEnd:ne},N.default.createElement("div",{className:"rfm-initial-child-container",ref:ae},Z.Children.map(ce,kt=>N.default.createElement("div",{style:Q,className:"rfm-child"},kt))),Bt(le-1)),N.default.createElement("div",{className:"rfm-marquee",style:ut},Bt(le))):null});ft.Z=V},86851:function(Ot,ft,D){"use strict";var G=D(35171),lt=Array.prototype.concat,Z=Array.prototype.slice,B=Ot.exports=function(V){for(var W=[],X=0,F=V.length;X<F;X++){var H=V[X];G(H)?W=lt.call(W,Z.call(H)):W.push(H)}return W};B.wrap=function(N){return function(){return N(B(arguments))}}},96446:function(Ot,ft,D){var G=D(37923);function lt(Z){if(Array.isArray(Z))return G(Z)}Ot.exports=lt,Ot.exports.__esModule=!0,Ot.exports.default=Ot.exports},96936:function(Ot){function ft(D){if(typeof Symbol!="undefined"&&D[Symbol.iterator]!=null||D["@@iterator"]!=null)return Array.from(D)}Ot.exports=ft,Ot.exports.__esModule=!0,Ot.exports.default=Ot.exports},88619:function(Ot){function ft(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}Ot.exports=ft,Ot.exports.__esModule=!0,Ot.exports.default=Ot.exports},19632:function(Ot,ft,D){var G=D(96446),lt=D(96936),Z=D(96263),B=D(88619);function N(V){return G(V)||lt(V)||Z(V)||B()}Ot.exports=N,Ot.exports.__esModule=!0,Ot.exports.default=Ot.exports}}]);
}());