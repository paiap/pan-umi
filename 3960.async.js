!(function(){var _z=Object.defineProperty,Sz=Object.defineProperties;var Tz=Object.getOwnPropertyDescriptors;var od=Object.getOwnPropertySymbols,Pz=Object.getPrototypeOf,x_=Object.prototype.hasOwnProperty,b_=Object.prototype.propertyIsEnumerable,Mz=Reflect.get;var gi=Math.pow,ym=(Ct,ft,D)=>ft in Ct?_z(Ct,ft,{enumerable:!0,configurable:!0,writable:!0,value:D}):Ct[ft]=D,at=(Ct,ft)=>{for(var D in ft||(ft={}))x_.call(ft,D)&&ym(Ct,D,ft[D]);if(od)for(var D of od(ft))b_.call(ft,D)&&ym(Ct,D,ft[D]);return Ct},Se=(Ct,ft)=>Sz(Ct,Tz(ft));var Ce=(Ct,ft)=>{var D={};for(var G in Ct)x_.call(Ct,G)&&ft.indexOf(G)<0&&(D[G]=Ct[G]);if(Ct!=null&&od)for(var G of od(Ct))ft.indexOf(G)<0&&b_.call(Ct,G)&&(D[G]=Ct[G]);return D};var k=(Ct,ft,D)=>(ym(Ct,typeof ft!="symbol"?ft+"":ft,D),D);var sd=(Ct,ft,D)=>Mz(Pz(Ct),D,ft);var Pt=(Ct,ft,D)=>new Promise((G,lt)=>{var q=V=>{try{N(D.next(V))}catch(W){lt(W)}},B=V=>{try{N(D.throw(V))}catch(W){lt(W)}},N=V=>V.done?G(V.value):Promise.resolve(V.value).then(q,B);N((D=D.apply(Ct,ft)).next())});(self.webpackChunkpanan=self.webpackChunkpanan||[]).push([[3960],{89739:function(Ct,ft,D){"use strict";D.d(ft,{Z:function(){return X}});var G=D(87462),lt=D(67294),q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"},B=q,N=D(84089),V=function(H,U){return lt.createElement(N.Z,(0,G.Z)({},H,{ref:U,icon:B}))},W=lt.forwardRef(V),X=W},4340:function(Ct,ft,D){"use strict";D.d(ft,{Z:function(){return X}});var G=D(87462),lt=D(67294),q={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"},B=q,N=D(84089),V=function(H,U){return lt.createElement(N.Z,(0,G.Z)({},H,{ref:U,icon:B}))},W=lt.forwardRef(V),X=W},21640:function(Ct,ft,D){"use strict";D.d(ft,{Z:function(){return X}});var G=D(87462),lt=D(67294),q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"},B=q,N=D(84089),V=function(H,U){return lt.createElement(N.Z,(0,G.Z)({},H,{ref:U,icon:B}))},W=lt.forwardRef(V),X=W},78860:function(Ct,ft,D){"use strict";D.d(ft,{Z:function(){return X}});var G=D(87462),lt=D(67294),q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm32 664c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V456c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272zm-32-344a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"info-circle",theme:"filled"},B=q,N=D(84089),V=function(H,U){return lt.createElement(N.Z,(0,G.Z)({},H,{ref:U,icon:B}))},W=lt.forwardRef(V),X=W},19976:function(Ct,ft,D){"use strict";D.d(ft,{Ll:function(){return zo},MD:function(){return Ms},kJ:function(){return ed},x1:function(){return ql},z2:function(){return Jw}});var G={};D.r(G),D.d(G,{add:function(){return S_},adjoint:function(){return Mn},clone:function(){return Ft},copy:function(){return kt},create:function(){return Q},determinant:function(){return Pe},equals:function(){return C_},exactEquals:function(){return M_},frob:function(){return __},fromQuat:function(){return Fa},fromQuat2:function(){return yi},fromRotation:function(){return Or},fromRotationTranslation:function(){return pa},fromRotationTranslationScale:function(){return Ui},fromRotationTranslationScaleOrigin:function(){return mr},fromScaling:function(){return Ae},fromTranslation:function(){return ce},fromValues:function(){return Jt},fromXRotation:function(){return re},fromYRotation:function(){return je},fromZRotation:function(){return ti},frustum:function(){return ld},getRotation:function(){return An},getScaling:function(){return Ye},getTranslation:function(){return ir},identity:function(){return Xt},invert:function(){return Wt},lookAt:function(){return Hc},mul:function(){return Yc},multiply:function(){return Ut},multiplyScalar:function(){return T_},multiplyScalarAndAdd:function(){return P_},ortho:function(){return Uc},orthoNO:function(){return Wc},orthoZO:function(){return Vc},perspective:function(){return yr},perspectiveFromFieldOfView:function(){return zc},perspectiveNO:function(){return Gc},perspectiveZO:function(){return xi},rotate:function(){return Cn},rotateX:function(){return Ar},rotateY:function(){return vr},rotateZ:function(){return gr},scale:function(){return mi},set:function(){return ne},str:function(){return w_},sub:function(){return A_},subtract:function(){return xm},targetTo:function(){return E_},translate:function(){return Ee},transpose:function(){return Te}});var lt={};D.r(lt),D.d(lt,{circle:function(){return EN},diamond:function(){return wN},rect:function(){return SN},simple:function(){return PN},triangle:function(){return hx},triangleRect:function(){return TN},vee:function(){return _N}});var q=function(n,e){return q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},q(n,e)};function B(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");q(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var N=function(){return N=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},N.apply(this,arguments)};function V(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function W(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(o=n[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function X(n,e){return function(t,r){e(t,r,n)}}function F(n,e,t,r,i,a){function o(m){if(m!==void 0&&typeof m!="function")throw new TypeError("Function expected");return m}for(var s=r.kind,l=s==="getter"?"get":s==="setter"?"set":"value",c=!e&&n?r.static?n:n.prototype:null,u=e||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),h,f=!1,d=t.length-1;d>=0;d--){var p={};for(var v in r)p[v]=v==="access"?{}:r[v];for(var v in r.access)p.access[v]=r.access[v];p.addInitializer=function(m){if(f)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(m||null))};var g=(0,t[d])(s==="accessor"?{get:u.get,set:u.set}:u[l],p);if(s==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(h=o(g.get))&&(u.get=h),(h=o(g.set))&&(u.set=h),(h=o(g.init))&&i.unshift(h)}else(h=o(g))&&(s==="field"?i.unshift(h):u[l]=h)}c&&Object.defineProperty(c,r.name,u),f=!0}function H(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0}function U(n){return typeof n=="symbol"?n:"".concat(n)}function $(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function dt(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function j(n,e,t,r){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):i(u.value).then(s,l)}c((r=r.apply(n,e||[])).next())})}function gt(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(r=1,i&&(a=c[0]&2?i.return:c[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,c[1])).done)return a;switch(i=0,a&&(c=[c[0]&2,a.value]),c[0]){case 0:case 1:a=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){t.label=c[1];break}if(c[0]===6&&t.label<a[1]){t.label=a[1],a=c;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(c);break}a[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],i=0}finally{r=a=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var St=Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]};function tt(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&St(e,n,t)}function pt(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function C(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function qt(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(C(arguments[e]));return n}function ee(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function K(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function pe(n){return this instanceof pe?(this.v=n,this):new pe(n)}function le(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,a=[];return i={},s("next"),s("throw"),s("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(d){return function(p){return Promise.resolve(p).then(d,h)}}function s(d,p){r[d]&&(i[d]=function(v){return new Promise(function(g,m){a.push([d,v,g,m])>1||l(d,v)})},p&&(i[d]=p(i[d])))}function l(d,p){try{c(r[d](p))}catch(v){f(a[0][3],v)}}function c(d){d.value instanceof pe?Promise.resolve(d.value.v).then(u,h):f(a[0][2],d)}function u(d){l("next",d)}function h(d){l("throw",d)}function f(d,p){d(p),a.shift(),a.length&&l(a[0][0],a[0][1])}}function ot(n){var e,t;return e={},r("next"),r("throw",function(i){throw i}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(i,a){e[i]=n[i]?function(o){return(t=!t)?{value:pe(n[i](o)),done:!1}:a?a(o):o}:a}}function Gt(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof pt=="function"?pt(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(s,l){o=n[a](o),i(s,l,o.done,o.value)})}}function i(a,o,s,l){Promise.resolve(l).then(function(c){a({value:c,done:s})},o)}}function zt(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var Ot=Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e};function xe(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&St(e,n,t);return Ot(e,n),e}function se(n){return n&&n.__esModule?n:{default:n}}function Gn(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function vt(n,e,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t}function he(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function be(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var Yt=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function ie(n){function e(r){n.error=n.hasError?new Yt(r,n.error,"An error was suppressed during disposal."):r,n.hasError=!0}function t(){for(;n.stack.length;){var r=n.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(t,function(a){return e(a),t()})}catch(a){e(a)}}if(n.hasError)throw n.error}return t()}var Dt={__extends:B,__assign:N,__rest:V,__decorate:W,__param:X,__metadata:dt,__awaiter:j,__generator:gt,__createBinding:St,__exportStar:tt,__values:pt,__read:C,__spread:qt,__spreadArrays:ee,__spreadArray:K,__await:pe,__asyncGenerator:le,__asyncDelegator:ot,__asyncValues:Gt,__makeTemplateObject:zt,__importStar:xe,__importDefault:se,__classPrivateFieldGet:Gn,__classPrivateFieldSet:vt,__classPrivateFieldIn:he,__addDisposableResource:be,__disposeResources:ie},Bt=D(26729),et=Bt,T=D(77160),ut=D(49685);function Q(){var n=new ut.WT(16);return ut.WT!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n}function Ft(n){var e=new ut.WT(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e}function kt(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function Jt(n,e,t,r,i,a,o,s,l,c,u,h,f,d,p,v){var g=new ut.WT(16);return g[0]=n,g[1]=e,g[2]=t,g[3]=r,g[4]=i,g[5]=a,g[6]=o,g[7]=s,g[8]=l,g[9]=c,g[10]=u,g[11]=h,g[12]=f,g[13]=d,g[14]=p,g[15]=v,g}function ne(n,e,t,r,i,a,o,s,l,c,u,h,f,d,p,v,g){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n[4]=a,n[5]=o,n[6]=s,n[7]=l,n[8]=c,n[9]=u,n[10]=h,n[11]=f,n[12]=d,n[13]=p,n[14]=v,n[15]=g,n}function Xt(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Te(n,e){if(n===e){var t=e[1],r=e[2],i=e[3],a=e[6],o=e[7],s=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=r,n[9]=a,n[11]=e[14],n[12]=i,n[13]=o,n[14]=s}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15];return n}function Wt(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],d=e[11],p=e[12],v=e[13],g=e[14],m=e[15],x=t*s-r*o,_=t*l-i*o,S=t*c-a*o,b=r*l-i*s,y=r*c-a*s,E=i*c-a*l,w=u*v-h*p,M=u*g-f*p,P=u*m-d*p,A=h*g-f*v,O=h*m-d*v,R=f*m-d*g,L=x*R-_*O+S*A+b*P-y*M+E*w;return L?(L=1/L,n[0]=(s*R-l*O+c*A)*L,n[1]=(i*O-r*R-a*A)*L,n[2]=(v*E-g*y+m*b)*L,n[3]=(f*y-h*E-d*b)*L,n[4]=(l*P-o*R-c*M)*L,n[5]=(t*R-i*P+a*M)*L,n[6]=(g*S-p*E-m*_)*L,n[7]=(u*E-f*S+d*_)*L,n[8]=(o*O-s*P+c*w)*L,n[9]=(r*P-t*O-a*w)*L,n[10]=(p*y-v*S+m*x)*L,n[11]=(h*S-u*y-d*x)*L,n[12]=(s*M-o*A-l*w)*L,n[13]=(t*A-r*M+i*w)*L,n[14]=(v*_-p*b-g*x)*L,n[15]=(u*b-h*_+f*x)*L,n):null}function Mn(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],d=e[11],p=e[12],v=e[13],g=e[14],m=e[15];return n[0]=s*(f*m-d*g)-h*(l*m-c*g)+v*(l*d-c*f),n[1]=-(r*(f*m-d*g)-h*(i*m-a*g)+v*(i*d-a*f)),n[2]=r*(l*m-c*g)-s*(i*m-a*g)+v*(i*c-a*l),n[3]=-(r*(l*d-c*f)-s*(i*d-a*f)+h*(i*c-a*l)),n[4]=-(o*(f*m-d*g)-u*(l*m-c*g)+p*(l*d-c*f)),n[5]=t*(f*m-d*g)-u*(i*m-a*g)+p*(i*d-a*f),n[6]=-(t*(l*m-c*g)-o*(i*m-a*g)+p*(i*c-a*l)),n[7]=t*(l*d-c*f)-o*(i*d-a*f)+u*(i*c-a*l),n[8]=o*(h*m-d*v)-u*(s*m-c*v)+p*(s*d-c*h),n[9]=-(t*(h*m-d*v)-u*(r*m-a*v)+p*(r*d-a*h)),n[10]=t*(s*m-c*v)-o*(r*m-a*v)+p*(r*c-a*s),n[11]=-(t*(s*d-c*h)-o*(r*d-a*h)+u*(r*c-a*s)),n[12]=-(o*(h*g-f*v)-u*(s*g-l*v)+p*(s*f-l*h)),n[13]=t*(h*g-f*v)-u*(r*g-i*v)+p*(r*f-i*h),n[14]=-(t*(s*g-l*v)-o*(r*g-i*v)+p*(r*l-i*s)),n[15]=t*(s*f-l*h)-o*(r*f-i*h)+u*(r*l-i*s),n}function Pe(n){var e=n[0],t=n[1],r=n[2],i=n[3],a=n[4],o=n[5],s=n[6],l=n[7],c=n[8],u=n[9],h=n[10],f=n[11],d=n[12],p=n[13],v=n[14],g=n[15],m=e*o-t*a,x=e*s-r*a,_=e*l-i*a,S=t*s-r*o,b=t*l-i*o,y=r*l-i*s,E=c*p-u*d,w=c*v-h*d,M=c*g-f*d,P=u*v-h*p,A=u*g-f*p,O=h*g-f*v;return m*O-x*A+_*P+S*M-b*w+y*E}function Ut(n,e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],d=e[10],p=e[11],v=e[12],g=e[13],m=e[14],x=e[15],_=t[0],S=t[1],b=t[2],y=t[3];return n[0]=_*r+S*s+b*h+y*v,n[1]=_*i+S*l+b*f+y*g,n[2]=_*a+S*c+b*d+y*m,n[3]=_*o+S*u+b*p+y*x,_=t[4],S=t[5],b=t[6],y=t[7],n[4]=_*r+S*s+b*h+y*v,n[5]=_*i+S*l+b*f+y*g,n[6]=_*a+S*c+b*d+y*m,n[7]=_*o+S*u+b*p+y*x,_=t[8],S=t[9],b=t[10],y=t[11],n[8]=_*r+S*s+b*h+y*v,n[9]=_*i+S*l+b*f+y*g,n[10]=_*a+S*c+b*d+y*m,n[11]=_*o+S*u+b*p+y*x,_=t[12],S=t[13],b=t[14],y=t[15],n[12]=_*r+S*s+b*h+y*v,n[13]=_*i+S*l+b*f+y*g,n[14]=_*a+S*c+b*d+y*m,n[15]=_*o+S*u+b*p+y*x,n}function Ee(n,e,t){var r=t[0],i=t[1],a=t[2],o,s,l,c,u,h,f,d,p,v,g,m;return e===n?(n[12]=e[0]*r+e[4]*i+e[8]*a+e[12],n[13]=e[1]*r+e[5]*i+e[9]*a+e[13],n[14]=e[2]*r+e[6]*i+e[10]*a+e[14],n[15]=e[3]*r+e[7]*i+e[11]*a+e[15]):(o=e[0],s=e[1],l=e[2],c=e[3],u=e[4],h=e[5],f=e[6],d=e[7],p=e[8],v=e[9],g=e[10],m=e[11],n[0]=o,n[1]=s,n[2]=l,n[3]=c,n[4]=u,n[5]=h,n[6]=f,n[7]=d,n[8]=p,n[9]=v,n[10]=g,n[11]=m,n[12]=o*r+u*i+p*a+e[12],n[13]=s*r+h*i+v*a+e[13],n[14]=l*r+f*i+g*a+e[14],n[15]=c*r+d*i+m*a+e[15]),n}function mi(n,e,t){var r=t[0],i=t[1],a=t[2];return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7]*i,n[8]=e[8]*a,n[9]=e[9]*a,n[10]=e[10]*a,n[11]=e[11]*a,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function Cn(n,e,t,r){var i=r[0],a=r[1],o=r[2],s=Math.hypot(i,a,o),l,c,u,h,f,d,p,v,g,m,x,_,S,b,y,E,w,M,P,A,O,R,L,z;return s<ut.Ib?null:(s=1/s,i*=s,a*=s,o*=s,l=Math.sin(t),c=Math.cos(t),u=1-c,h=e[0],f=e[1],d=e[2],p=e[3],v=e[4],g=e[5],m=e[6],x=e[7],_=e[8],S=e[9],b=e[10],y=e[11],E=i*i*u+c,w=a*i*u+o*l,M=o*i*u-a*l,P=i*a*u-o*l,A=a*a*u+c,O=o*a*u+i*l,R=i*o*u+a*l,L=a*o*u-i*l,z=o*o*u+c,n[0]=h*E+v*w+_*M,n[1]=f*E+g*w+S*M,n[2]=d*E+m*w+b*M,n[3]=p*E+x*w+y*M,n[4]=h*P+v*A+_*O,n[5]=f*P+g*A+S*O,n[6]=d*P+m*A+b*O,n[7]=p*P+x*A+y*O,n[8]=h*R+v*L+_*z,n[9]=f*R+g*L+S*z,n[10]=d*R+m*L+b*z,n[11]=p*R+x*L+y*z,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n)}function Ar(n,e,t){var r=Math.sin(t),i=Math.cos(t),a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],f=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=a*i+c*r,n[5]=o*i+u*r,n[6]=s*i+h*r,n[7]=l*i+f*r,n[8]=c*i-a*r,n[9]=u*i-o*r,n[10]=h*i-s*r,n[11]=f*i-l*r,n}function vr(n,e,t){var r=Math.sin(t),i=Math.cos(t),a=e[0],o=e[1],s=e[2],l=e[3],c=e[8],u=e[9],h=e[10],f=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=a*i-c*r,n[1]=o*i-u*r,n[2]=s*i-h*r,n[3]=l*i-f*r,n[8]=a*r+c*i,n[9]=o*r+u*i,n[10]=s*r+h*i,n[11]=l*r+f*i,n}function gr(n,e,t){var r=Math.sin(t),i=Math.cos(t),a=e[0],o=e[1],s=e[2],l=e[3],c=e[4],u=e[5],h=e[6],f=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=a*i+c*r,n[1]=o*i+u*r,n[2]=s*i+h*r,n[3]=l*i+f*r,n[4]=c*i-a*r,n[5]=u*i-o*r,n[6]=h*i-s*r,n[7]=f*i-l*r,n}function ce(n,e){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n}function Ae(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Or(n,e,t){var r=t[0],i=t[1],a=t[2],o=Math.hypot(r,i,a),s,l,c;return o<ut.Ib?null:(o=1/o,r*=o,i*=o,a*=o,s=Math.sin(e),l=Math.cos(e),c=1-l,n[0]=r*r*c+l,n[1]=i*r*c+a*s,n[2]=a*r*c-i*s,n[3]=0,n[4]=r*i*c-a*s,n[5]=i*i*c+l,n[6]=a*i*c+r*s,n[7]=0,n[8]=r*a*c+i*s,n[9]=i*a*c-r*s,n[10]=a*a*c+l,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}function re(n,e){var t=Math.sin(e),r=Math.cos(e);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=r,n[6]=t,n[7]=0,n[8]=0,n[9]=-t,n[10]=r,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function je(n,e){var t=Math.sin(e),r=Math.cos(e);return n[0]=r,n[1]=0,n[2]=-t,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=t,n[9]=0,n[10]=r,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function ti(n,e){var t=Math.sin(e),r=Math.cos(e);return n[0]=r,n[1]=t,n[2]=0,n[3]=0,n[4]=-t,n[5]=r,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function pa(n,e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=r+r,l=i+i,c=a+a,u=r*s,h=r*l,f=r*c,d=i*l,p=i*c,v=a*c,g=o*s,m=o*l,x=o*c;return n[0]=1-(d+v),n[1]=h+x,n[2]=f-m,n[3]=0,n[4]=h-x,n[5]=1-(u+v),n[6]=p+g,n[7]=0,n[8]=f+m,n[9]=p-g,n[10]=1-(u+d),n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n}function yi(n,e){var t=new ut.WT(3),r=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=r*r+i*i+a*a+o*o;return h>0?(t[0]=(s*o+u*r+l*a-c*i)*2/h,t[1]=(l*o+u*i+c*r-s*a)*2/h,t[2]=(c*o+u*a+s*i-l*r)*2/h):(t[0]=(s*o+u*r+l*a-c*i)*2,t[1]=(l*o+u*i+c*r-s*a)*2,t[2]=(c*o+u*a+s*i-l*r)*2),pa(n,e,t),n}function ir(n,e){return n[0]=e[12],n[1]=e[13],n[2]=e[14],n}function Ye(n,e){var t=e[0],r=e[1],i=e[2],a=e[4],o=e[5],s=e[6],l=e[8],c=e[9],u=e[10];return n[0]=Math.hypot(t,r,i),n[1]=Math.hypot(a,o,s),n[2]=Math.hypot(l,c,u),n}function An(n,e){var t=new ut.WT(3);Ye(t,e);var r=1/t[0],i=1/t[1],a=1/t[2],o=e[0]*r,s=e[1]*i,l=e[2]*a,c=e[4]*r,u=e[5]*i,h=e[6]*a,f=e[8]*r,d=e[9]*i,p=e[10]*a,v=o+u+p,g=0;return v>0?(g=Math.sqrt(v+1)*2,n[3]=.25*g,n[0]=(h-d)/g,n[1]=(f-l)/g,n[2]=(s-c)/g):o>u&&o>p?(g=Math.sqrt(1+o-u-p)*2,n[3]=(h-d)/g,n[0]=.25*g,n[1]=(s+c)/g,n[2]=(f+l)/g):u>p?(g=Math.sqrt(1+u-o-p)*2,n[3]=(f-l)/g,n[0]=(s+c)/g,n[1]=.25*g,n[2]=(h+d)/g):(g=Math.sqrt(1+p-o-u)*2,n[3]=(s-c)/g,n[0]=(f+l)/g,n[1]=(h+d)/g,n[2]=.25*g),n}function Ui(n,e,t,r){var i=e[0],a=e[1],o=e[2],s=e[3],l=i+i,c=a+a,u=o+o,h=i*l,f=i*c,d=i*u,p=a*c,v=a*u,g=o*u,m=s*l,x=s*c,_=s*u,S=r[0],b=r[1],y=r[2];return n[0]=(1-(p+g))*S,n[1]=(f+_)*S,n[2]=(d-x)*S,n[3]=0,n[4]=(f-_)*b,n[5]=(1-(h+g))*b,n[6]=(v+m)*b,n[7]=0,n[8]=(d+x)*y,n[9]=(v-m)*y,n[10]=(1-(h+p))*y,n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n}function mr(n,e,t,r,i){var a=e[0],o=e[1],s=e[2],l=e[3],c=a+a,u=o+o,h=s+s,f=a*c,d=a*u,p=a*h,v=o*u,g=o*h,m=s*h,x=l*c,_=l*u,S=l*h,b=r[0],y=r[1],E=r[2],w=i[0],M=i[1],P=i[2],A=(1-(v+m))*b,O=(d+S)*b,R=(p-_)*b,L=(d-S)*y,z=(1-(f+m))*y,Y=(g+x)*y,I=(p+_)*E,Z=(g-x)*E,J=(1-(f+v))*E;return n[0]=A,n[1]=O,n[2]=R,n[3]=0,n[4]=L,n[5]=z,n[6]=Y,n[7]=0,n[8]=I,n[9]=Z,n[10]=J,n[11]=0,n[12]=t[0]+w-(A*w+L*M+I*P),n[13]=t[1]+M-(O*w+z*M+Z*P),n[14]=t[2]+P-(R*w+Y*M+J*P),n[15]=1,n}function Fa(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=t+t,s=r+r,l=i+i,c=t*o,u=r*o,h=r*s,f=i*o,d=i*s,p=i*l,v=a*o,g=a*s,m=a*l;return n[0]=1-h-p,n[1]=u+m,n[2]=f-g,n[3]=0,n[4]=u-m,n[5]=1-c-p,n[6]=d+v,n[7]=0,n[8]=f+g,n[9]=d-v,n[10]=1-c-h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function ld(n,e,t,r,i,a,o){var s=1/(t-e),l=1/(i-r),c=1/(a-o);return n[0]=a*2*s,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a*2*l,n[6]=0,n[7]=0,n[8]=(t+e)*s,n[9]=(i+r)*l,n[10]=(o+a)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*a*2*c,n[15]=0,n}function Gc(n,e,t,r,i){var a=1/Math.tan(e/2),o;return n[0]=a/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,i!=null&&i!==1/0?(o=1/(r-i),n[10]=(i+r)*o,n[14]=2*i*r*o):(n[10]=-1,n[14]=-2*r),n}var yr=Gc;function xi(n,e,t,r,i){var a=1/Math.tan(e/2),o;return n[0]=a/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,i!=null&&i!==1/0?(o=1/(r-i),n[10]=i*o,n[14]=i*r*o):(n[10]=-1,n[14]=-r),n}function zc(n,e,t,r){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+s),c=2/(i+a);return n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=-((o-s)*l*.5),n[9]=(i-a)*c*.5,n[10]=r/(t-r),n[11]=-1,n[12]=0,n[13]=0,n[14]=r*t/(t-r),n[15]=0,n}function Wc(n,e,t,r,i,a,o){var s=1/(e-t),l=1/(r-i),c=1/(a-o);return n[0]=-2*s,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*s,n[13]=(i+r)*l,n[14]=(o+a)*c,n[15]=1,n}var Uc=Wc;function Vc(n,e,t,r,i,a,o){var s=1/(e-t),l=1/(r-i),c=1/(a-o);return n[0]=-2*s,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=c,n[11]=0,n[12]=(e+t)*s,n[13]=(i+r)*l,n[14]=a*c,n[15]=1,n}function Hc(n,e,t,r){var i,a,o,s,l,c,u,h,f,d,p=e[0],v=e[1],g=e[2],m=r[0],x=r[1],_=r[2],S=t[0],b=t[1],y=t[2];return Math.abs(p-S)<ut.Ib&&Math.abs(v-b)<ut.Ib&&Math.abs(g-y)<ut.Ib?Xt(n):(u=p-S,h=v-b,f=g-y,d=1/Math.hypot(u,h,f),u*=d,h*=d,f*=d,i=x*f-_*h,a=_*u-m*f,o=m*h-x*u,d=Math.hypot(i,a,o),d?(d=1/d,i*=d,a*=d,o*=d):(i=0,a=0,o=0),s=h*o-f*a,l=f*i-u*o,c=u*a-h*i,d=Math.hypot(s,l,c),d?(d=1/d,s*=d,l*=d,c*=d):(s=0,l=0,c=0),n[0]=i,n[1]=s,n[2]=u,n[3]=0,n[4]=a,n[5]=l,n[6]=h,n[7]=0,n[8]=o,n[9]=c,n[10]=f,n[11]=0,n[12]=-(i*p+a*v+o*g),n[13]=-(s*p+l*v+c*g),n[14]=-(u*p+h*v+f*g),n[15]=1,n)}function E_(n,e,t,r){var i=e[0],a=e[1],o=e[2],s=r[0],l=r[1],c=r[2],u=i-t[0],h=a-t[1],f=o-t[2],d=u*u+h*h+f*f;d>0&&(d=1/Math.sqrt(d),u*=d,h*=d,f*=d);var p=l*f-c*h,v=c*u-s*f,g=s*h-l*u;return d=p*p+v*v+g*g,d>0&&(d=1/Math.sqrt(d),p*=d,v*=d,g*=d),n[0]=p,n[1]=v,n[2]=g,n[3]=0,n[4]=h*g-f*v,n[5]=f*p-u*g,n[6]=u*v-h*p,n[7]=0,n[8]=u,n[9]=h,n[10]=f,n[11]=0,n[12]=i,n[13]=a,n[14]=o,n[15]=1,n}function w_(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"}function __(n){return Math.hypot(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])}function S_(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n}function xm(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n}function T_(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n}function P_(n,e,t,r){return n[0]=e[0]+t[0]*r,n[1]=e[1]+t[1]*r,n[2]=e[2]+t[2]*r,n[3]=e[3]+t[3]*r,n[4]=e[4]+t[4]*r,n[5]=e[5]+t[5]*r,n[6]=e[6]+t[6]*r,n[7]=e[7]+t[7]*r,n[8]=e[8]+t[8]*r,n[9]=e[9]+t[9]*r,n[10]=e[10]+t[10]*r,n[11]=e[11]+t[11]*r,n[12]=e[12]+t[12]*r,n[13]=e[13]+t[13]*r,n[14]=e[14]+t[14]*r,n[15]=e[15]+t[15]*r,n}function M_(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]&&n[4]===e[4]&&n[5]===e[5]&&n[6]===e[6]&&n[7]===e[7]&&n[8]===e[8]&&n[9]===e[9]&&n[10]===e[10]&&n[11]===e[11]&&n[12]===e[12]&&n[13]===e[13]&&n[14]===e[14]&&n[15]===e[15]}function C_(n,e){var t=n[0],r=n[1],i=n[2],a=n[3],o=n[4],s=n[5],l=n[6],c=n[7],u=n[8],h=n[9],f=n[10],d=n[11],p=n[12],v=n[13],g=n[14],m=n[15],x=e[0],_=e[1],S=e[2],b=e[3],y=e[4],E=e[5],w=e[6],M=e[7],P=e[8],A=e[9],O=e[10],R=e[11],L=e[12],z=e[13],Y=e[14],I=e[15];return Math.abs(t-x)<=ut.Ib*Math.max(1,Math.abs(t),Math.abs(x))&&Math.abs(r-_)<=ut.Ib*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(i-S)<=ut.Ib*Math.max(1,Math.abs(i),Math.abs(S))&&Math.abs(a-b)<=ut.Ib*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-y)<=ut.Ib*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(s-E)<=ut.Ib*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(l-w)<=ut.Ib*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(c-M)<=ut.Ib*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(u-P)<=ut.Ib*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(h-A)<=ut.Ib*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(f-O)<=ut.Ib*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(d-R)<=ut.Ib*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(p-L)<=ut.Ib*Math.max(1,Math.abs(p),Math.abs(L))&&Math.abs(v-z)<=ut.Ib*Math.max(1,Math.abs(v),Math.abs(z))&&Math.abs(g-Y)<=ut.Ib*Math.max(1,Math.abs(g),Math.abs(Y))&&Math.abs(m-I)<=ut.Ib*Math.max(1,Math.abs(m),Math.abs(I))}var Yc=Ut,A_=xm,Qi=D(35600);function on(){var n=new ut.WT(4);return ut.WT!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function O_(n){var e=new ut.WT(4);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}function va(n,e,t,r){var i=new ut.WT(4);return i[0]=n,i[1]=e,i[2]=t,i[3]=r,i}function N_(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}function R_(n,e,t,r,i){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function k_(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n}function Cz(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n}function Az(n,e,t){return n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n[3]=e[3]*t[3],n}function Oz(n,e,t){return n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n[3]=e[3]/t[3],n}function Nz(n,e){return n[0]=Math.ceil(e[0]),n[1]=Math.ceil(e[1]),n[2]=Math.ceil(e[2]),n[3]=Math.ceil(e[3]),n}function Rz(n,e){return n[0]=Math.floor(e[0]),n[1]=Math.floor(e[1]),n[2]=Math.floor(e[2]),n[3]=Math.floor(e[3]),n}function kz(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n[3]=Math.min(e[3],t[3]),n}function Lz(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n[3]=Math.max(e[3],t[3]),n}function Iz(n,e){return n[0]=Math.round(e[0]),n[1]=Math.round(e[1]),n[2]=Math.round(e[2]),n[3]=Math.round(e[3]),n}function L_(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function Dz(n,e,t,r){return n[0]=e[0]+t[0]*r,n[1]=e[1]+t[1]*r,n[2]=e[2]+t[2]*r,n[3]=e[3]+t[3]*r,n}function Bz(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=e[2]-n[2],a=e[3]-n[3];return Math.hypot(t,r,i,a)}function Fz(n,e){var t=e[0]-n[0],r=e[1]-n[1],i=e[2]-n[2],a=e[3]-n[3];return t*t+r*r+i*i+a*a}function I_(n){var e=n[0],t=n[1],r=n[2],i=n[3];return Math.hypot(e,t,r,i)}function D_(n){var e=n[0],t=n[1],r=n[2],i=n[3];return e*e+t*t+r*r+i*i}function Gz(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=-e[3],n}function zz(n,e){return n[0]=1/e[0],n[1]=1/e[1],n[2]=1/e[2],n[3]=1/e[3],n}function B_(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=t*t+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=r*o,n[2]=i*o,n[3]=a*o,n}function F_(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]}function Wz(n,e,t,r){var i=t[0]*r[1]-t[1]*r[0],a=t[0]*r[2]-t[2]*r[0],o=t[0]*r[3]-t[3]*r[0],s=t[1]*r[2]-t[2]*r[1],l=t[1]*r[3]-t[3]*r[1],c=t[2]*r[3]-t[3]*r[2],u=e[0],h=e[1],f=e[2],d=e[3];return n[0]=h*c-f*l+d*s,n[1]=-(u*c)+f*o-d*a,n[2]=u*l-h*o+d*i,n[3]=-(u*s)+h*a-f*i,n}function G_(n,e,t,r){var i=e[0],a=e[1],o=e[2],s=e[3];return n[0]=i+r*(t[0]-i),n[1]=a+r*(t[1]-a),n[2]=o+r*(t[2]-o),n[3]=s+r*(t[3]-s),n}function Uz(n,e){e=e||1;var t,r,i,a,o,s;do t=glMatrix.RANDOM()*2-1,r=glMatrix.RANDOM()*2-1,o=t*t+r*r;while(o>=1);do i=glMatrix.RANDOM()*2-1,a=glMatrix.RANDOM()*2-1,s=i*i+a*a;while(s>=1);var l=Math.sqrt((1-o)/s);return n[0]=e*t,n[1]=e*r,n[2]=e*i*l,n[3]=e*a*l,n}function fn(n,e,t){var r=e[0],i=e[1],a=e[2],o=e[3];return n[0]=t[0]*r+t[4]*i+t[8]*a+t[12]*o,n[1]=t[1]*r+t[5]*i+t[9]*a+t[13]*o,n[2]=t[2]*r+t[6]*i+t[10]*a+t[14]*o,n[3]=t[3]*r+t[7]*i+t[11]*a+t[15]*o,n}function Vz(n,e,t){var r=e[0],i=e[1],a=e[2],o=t[0],s=t[1],l=t[2],c=t[3],u=c*r+s*a-l*i,h=c*i+l*r-o*a,f=c*a+o*i-s*r,d=-o*r-s*i-l*a;return n[0]=u*c+d*-o+h*-l-f*-s,n[1]=h*c+d*-s+f*-o-u*-l,n[2]=f*c+d*-l+u*-s-h*-o,n[3]=e[3],n}function Hz(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n}function Yz(n){return"vec4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"}function z_(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]}function W_(n,e){var t=n[0],r=n[1],i=n[2],a=n[3],o=e[0],s=e[1],l=e[2],c=e[3];return Math.abs(t-o)<=ut.Ib*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(r-s)<=ut.Ib*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-l)<=ut.Ib*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-c)<=ut.Ib*Math.max(1,Math.abs(a),Math.abs(c))}var Xz=null,jz=null,$z=null,Kz=null,Zz=null,qz=null,Jz=null,Qz=function(){var n=on();return function(e,t,r,i,a,o){var s,l;for(t||(t=4),r||(r=0),i?l=Math.min(i*t+r,e.length):l=e.length,s=r;s<l;s+=t)n[0]=e[s],n[1]=e[s+1],n[2]=e[s+2],n[3]=e[s+3],a(n,n,o),e[s]=n[0],e[s+1]=n[1],e[s+2]=n[2],e[s+3]=n[3];return e}}();function Vt(){var n=new ut.WT(4);return ut.WT!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function tW(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function Bn(n,e,t){t=t*.5;var r=Math.sin(t);return n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=Math.cos(t),n}function eW(n,e){var t=Math.acos(e[3])*2,r=Math.sin(t/2);return r>glMatrix.EPSILON?(n[0]=e[0]/r,n[1]=e[1]/r,n[2]=e[2]/r):(n[0]=1,n[1]=0,n[2]=0),t}function nW(n,e){var t=X_(n,e);return Math.acos(2*t*t-1)}function Ln(n,e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=t[0],l=t[1],c=t[2],u=t[3];return n[0]=r*u+o*s+i*c-a*l,n[1]=i*u+o*l+a*s-r*c,n[2]=a*u+o*c+r*l-i*s,n[3]=o*u-r*s-i*l-a*c,n}function rW(n,e,t){t*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(t),l=Math.cos(t);return n[0]=r*l+o*s,n[1]=i*l+a*s,n[2]=a*l-i*s,n[3]=o*l-r*s,n}function iW(n,e,t){t*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(t),l=Math.cos(t);return n[0]=r*l-a*s,n[1]=i*l+o*s,n[2]=a*l+r*s,n[3]=o*l-i*s,n}function aW(n,e,t){t*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(t),l=Math.cos(t);return n[0]=r*l+i*s,n[1]=i*l-r*s,n[2]=a*l+o*s,n[3]=o*l-a*s,n}function oW(n,e){var t=e[0],r=e[1],i=e[2];return n[0]=t,n[1]=r,n[2]=i,n[3]=Math.sqrt(Math.abs(1-t*t-r*r-i*i)),n}function U_(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=Math.sqrt(t*t+r*r+i*i),s=Math.exp(a),l=o>0?s*Math.sin(o)/o:0;return n[0]=t*l,n[1]=r*l,n[2]=i*l,n[3]=s*Math.cos(o),n}function V_(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=Math.sqrt(t*t+r*r+i*i),s=o>0?Math.atan2(o,a)/o:0;return n[0]=t*s,n[1]=r*s,n[2]=i*s,n[3]=.5*Math.log(t*t+r*r+i*i+a*a),n}function sW(n,e,t){return V_(n,e),Y_(n,n,t),U_(n,n),n}function cd(n,e,t,r){var i=e[0],a=e[1],o=e[2],s=e[3],l=t[0],c=t[1],u=t[2],h=t[3],f,d,p,v,g;return d=i*l+a*c+o*u+s*h,d<0&&(d=-d,l=-l,c=-c,u=-u,h=-h),1-d>ut.Ib?(f=Math.acos(d),p=Math.sin(f),v=Math.sin((1-r)*f)/p,g=Math.sin(r*f)/p):(v=1-r,g=r),n[0]=v*i+g*l,n[1]=v*a+g*c,n[2]=v*o+g*u,n[3]=v*s+g*h,n}function lW(n){var e=glMatrix.RANDOM(),t=glMatrix.RANDOM(),r=glMatrix.RANDOM(),i=Math.sqrt(1-e),a=Math.sqrt(e);return n[0]=i*Math.sin(2*Math.PI*t),n[1]=i*Math.cos(2*Math.PI*t),n[2]=a*Math.sin(2*Math.PI*r),n[3]=a*Math.cos(2*Math.PI*r),n}function ga(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=t*t+r*r+i*i+a*a,s=o?1/o:0;return n[0]=-t*s,n[1]=-r*s,n[2]=-i*s,n[3]=a*s,n}function cW(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n}function H_(n,e){var t=e[0]+e[4]+e[8],r;if(t>0)r=Math.sqrt(t+1),n[3]=.5*r,r=.5/r,n[0]=(e[5]-e[7])*r,n[1]=(e[6]-e[2])*r,n[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[a*3+a]-e[o*3+o]+1),n[i]=.5*r,r=.5/r,n[3]=(e[a*3+o]-e[o*3+a])*r,n[a]=(e[a*3+i]+e[i*3+a])*r,n[o]=(e[o*3+i]+e[i*3+o])*r}return n}function bi(n,e,t,r){var i=.5*Math.PI/180;e*=i,t*=i,r*=i;var a=Math.sin(e),o=Math.cos(e),s=Math.sin(t),l=Math.cos(t),c=Math.sin(r),u=Math.cos(r);return n[0]=a*l*u-o*s*c,n[1]=o*s*u+a*l*c,n[2]=o*l*c-a*s*u,n[3]=o*l*u+a*s*c,n}function uW(n){return"quat("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"}var hW=O_,ma=va,Ei=N_,fW=R_,dW=k_,os=Ln,Y_=L_,X_=F_,pW=G_,vW=I_,gW=null,mW=D_,yW=null,Ga=B_,xW=z_,bW=W_,EW=function(){var n=T.Ue(),e=T.al(1,0,0),t=T.al(0,1,0);return function(r,i,a){var o=T.AK(i,a);return o<-.999999?(T.kC(n,e,i),T.Zh(n)<1e-6&&T.kC(n,t,i),T.Fv(n,n),Bn(r,n,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(T.kC(n,i,a),r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=1+o,Ga(r,r))}}(),wW=function(){var n=Vt(),e=Vt();return function(t,r,i,a,o,s){return cd(n,r,o,s),cd(e,i,a,s),cd(t,n,e,2*s*(1-s)),t}}(),_W=function(){var n=Qi.Ue();return function(e,t,r,i){return n[0]=r[0],n[3]=r[1],n[6]=r[2],n[1]=i[0],n[4]=i[1],n[7]=i[2],n[2]=-t[0],n[5]=-t[1],n[8]=-t[2],Ga(e,H_(e,n))}}(),ya=D(31437),j_={}.toString,$_=function(n,e){return j_.call(n)==="[object "+e+"]"},ss=$_,K_=function(n){return ss(n,"Number")},fe=K_;function Nr(n,e){return Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1]))}var Z_=function(n){return n==null},Mt=Z_,ue=function(n){return ss(n,"String")},q_=function(n,e,t){return n<e?e:n>t?t:n},me=q_,ud=function(n,e){return ud=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},ud(n,e)};function J_(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ud(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var xa=function(){return xa=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},xa.apply(this,arguments)};function Q_(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function tS(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(o=n[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function eS(n,e){return function(t,r){e(t,r,n)}}function SW(n,e,t,r,i,a){function o(m){if(m!==void 0&&typeof m!="function")throw new TypeError("Function expected");return m}for(var s=r.kind,l=s==="getter"?"get":s==="setter"?"set":"value",c=!e&&n?r.static?n:n.prototype:null,u=e||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),h,f=!1,d=t.length-1;d>=0;d--){var p={};for(var v in r)p[v]=v==="access"?{}:r[v];for(var v in r.access)p.access[v]=r.access[v];p.addInitializer=function(m){if(f)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(m||null))};var g=(0,t[d])(s==="accessor"?{get:u.get,set:u.set}:u[l],p);if(s==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(h=o(g.get))&&(u.get=h),(h=o(g.set))&&(u.set=h),(h=o(g.init))&&i.unshift(h)}else(h=o(g))&&(s==="field"?i.unshift(h):u[l]=h)}c&&Object.defineProperty(c,r.name,u),f=!0}function TW(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0}function PW(n){return typeof n=="symbol"?n:"".concat(n)}function MW(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function nS(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function rS(n,e,t,r){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):i(u.value).then(s,l)}c((r=r.apply(n,e||[])).next())})}function iS(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(r=1,i&&(a=c[0]&2?i.return:c[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,c[1])).done)return a;switch(i=0,a&&(c=[c[0]&2,a.value]),c[0]){case 0:case 1:a=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){t.label=c[1];break}if(c[0]===6&&t.label<a[1]){t.label=a[1],a=c;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(c);break}a[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],i=0}finally{r=a=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var hd=Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]};function aS(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&hd(e,n,t)}function fd(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function bm(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function oS(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(bm(arguments[e]));return n}function sS(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function dd(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function bl(n){return this instanceof bl?(this.v=n,this):new bl(n)}function lS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,a=[];return i={},s("next"),s("throw"),s("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(d){return function(p){return Promise.resolve(p).then(d,h)}}function s(d,p){r[d]&&(i[d]=function(v){return new Promise(function(g,m){a.push([d,v,g,m])>1||l(d,v)})},p&&(i[d]=p(i[d])))}function l(d,p){try{c(r[d](p))}catch(v){f(a[0][3],v)}}function c(d){d.value instanceof bl?Promise.resolve(d.value.v).then(u,h):f(a[0][2],d)}function u(d){l("next",d)}function h(d){l("throw",d)}function f(d,p){d(p),a.shift(),a.length&&l(a[0][0],a[0][1])}}function cS(n){var e,t;return e={},r("next"),r("throw",function(i){throw i}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(i,a){e[i]=n[i]?function(o){return(t=!t)?{value:bl(n[i](o)),done:!1}:a?a(o):o}:a}}function uS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof fd=="function"?fd(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(s,l){o=n[a](o),i(s,l,o.done,o.value)})}}function i(a,o,s,l){Promise.resolve(l).then(function(c){a({value:c,done:s})},o)}}function hS(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var fS=Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e};function dS(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&hd(e,n,t);return fS(e,n),e}function pS(n){return n&&n.__esModule?n:{default:n}}function vS(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function gS(n,e,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t}function mS(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function yS(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var xS=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function bS(n){function e(r){n.error=n.hasError?new xS(r,n.error,"An error was suppressed during disposal."):r,n.hasError=!0}function t(){for(;n.stack.length;){var r=n.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(t,function(a){return e(a),t()})}catch(a){e(a)}}if(n.hasError)throw n.error}return t()}var CW={__extends:J_,__assign:xa,__rest:Q_,__decorate:tS,__param:eS,__metadata:nS,__awaiter:rS,__generator:iS,__createBinding:hd,__exportStar:aS,__values:fd,__read:bm,__spread:oS,__spreadArrays:sS,__spreadArray:dd,__await:bl,__asyncGenerator:lS,__asyncDelegator:cS,__asyncValues:uS,__makeTemplateObject:hS,__importStar:dS,__importDefault:pS,__classPrivateFieldGet:vS,__classPrivateFieldSet:gS,__classPrivateFieldIn:mS,__addDisposableResource:yS,__disposeResources:bS},El={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function Em(n){return Array.isArray(n)&&n.every(function(e){var t=e[0].toLowerCase();return El[t]===e.length-1&&"achlmqstvz".includes(t)})}function wm(n){return Em(n)&&n.every(function(e){var t=e[0];return t===t.toUpperCase()})}function _m(n){return wm(n)&&n.every(function(e){var t=e[0];return"ACLMQZ".includes(t)})}var Sm={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function Tm(n){for(var e=n.pathValue[n.segmentStart],t=e.toLowerCase(),r=n.data;r.length>=El[t]&&(t==="m"&&r.length>2?(n.segments.push([e].concat(r.splice(0,2))),t="l",e=e==="m"?"l":"L"):n.segments.push([e].concat(r.splice(0,El[t]))),!!El[t]););}function ES(n){var e=n.index,t=n.pathValue,r=t.charCodeAt(e);if(r===48){n.param=0,n.index+=1;return}if(r===49){n.param=1,n.index+=1;return}n.err='[path-util]: invalid Arc flag "'+t[e]+'", expecting 0 or 1 at index '+e}function wS(n){return n>=48&&n<=57||n===43||n===45||n===46}function ls(n){return n>=48&&n<=57}function _S(n){var e=n.max,t=n.pathValue,r=n.index,i=r,a=!1,o=!1,s=!1,l=!1,c;if(i>=e){n.err="[path-util]: Invalid path value at index "+i+', "pathValue" is missing param';return}if(c=t.charCodeAt(i),(c===43||c===45)&&(i+=1,c=t.charCodeAt(i)),!ls(c)&&c!==46){n.err="[path-util]: Invalid path value at index "+i+', "'+t[i]+'" is not a number';return}if(c!==46){if(a=c===48,i+=1,c=t.charCodeAt(i),a&&i<e&&c&&ls(c)){n.err="[path-util]: Invalid path value at index "+r+', "'+t[r]+'" illegal number';return}for(;i<e&&ls(t.charCodeAt(i));)i+=1,o=!0;c=t.charCodeAt(i)}if(c===46){for(l=!0,i+=1;ls(t.charCodeAt(i));)i+=1,s=!0;c=t.charCodeAt(i)}if(c===101||c===69){if(l&&!o&&!s){n.err="[path-util]: Invalid path value at index "+i+', "'+t[i]+'" invalid float exponent';return}if(i+=1,c=t.charCodeAt(i),(c===43||c===45)&&(i+=1),i<e&&ls(t.charCodeAt(i)))for(;i<e&&ls(t.charCodeAt(i));)i+=1;else{n.err="[path-util]: Invalid path value at index "+i+', "'+t[i]+'" invalid integer exponent';return}}n.index=i,n.param=+n.pathValue.slice(r,i)}function SS(n){var e=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return n===10||n===13||n===8232||n===8233||n===32||n===9||n===11||n===12||n===160||n>=5760&&e.includes(n)}function Xc(n){for(var e=n.pathValue,t=n.max;n.index<t&&SS(e.charCodeAt(n.index));)n.index+=1}function TS(n){switch(n|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function PS(n){return(n|32)===97}function MS(n){var e=n.max,t=n.pathValue,r=n.index,i=t.charCodeAt(r),a=El[t[r].toLowerCase()];if(n.segmentStart=r,!TS(i)){n.err='[path-util]: Invalid path value "'+t[r]+'" is not a path command';return}if(n.index+=1,Xc(n),n.data=[],!a){Tm(n);return}for(;;){for(var o=a;o>0;o-=1){if(PS(i)&&(o===3||o===4)?ES(n):_S(n),n.err.length)return;n.data.push(n.param),Xc(n),n.index<e&&t.charCodeAt(n.index)===44&&(n.index+=1,Xc(n))}if(n.index>=n.max||!wS(t.charCodeAt(n.index)))break}Tm(n)}var CS=function(){function n(e){this.pathValue=e,this.segments=[],this.max=e.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return n}();function AS(n){if(Em(n))return[].concat(n);var e=new CS(n);for(Xc(e);e.index<e.max&&!e.err.length;)MS(e);return e.err?e.err:e.segments}function OS(n){if(wm(n))return[].concat(n);var e=AS(n),t=0,r=0,i=0,a=0;return e.map(function(o){var s=o.slice(1).map(Number),l=o[0],c=l.toUpperCase();if(l==="M")return t=s[0],r=s[1],i=t,a=r,["M",t,r];var u;if(l!==c)switch(c){case"A":u=[c,s[0],s[1],s[2],s[3],s[4],s[5]+t,s[6]+r];break;case"V":u=[c,s[0]+r];break;case"H":u=[c,s[0]+t];break;default:{var h=s.map(function(d,p){return d+(p%2?r:t)});u=[c].concat(h)}}else u=[c].concat(s);var f=u.length;switch(c){case"Z":t=i,r=a;break;case"H":t=u[1];break;case"V":r=u[1];break;default:t=u[f-2],r=u[f-1],c==="M"&&(i=t,a=r)}return u})}function NS(n,e){var t=n[0],r=e.x1,i=e.y1,a=e.x2,o=e.y2,s=n.slice(1).map(Number),l=n;if("TQ".includes(t)||(e.qx=null,e.qy=null),t==="H")l=["L",n[1],i];else if(t==="V")l=["L",r,n[1]];else if(t==="S"){var c=r*2-a,u=i*2-o;e.x1=c,e.y1=u,l=["C",c,u].concat(s)}else if(t==="T"){var h=r*2-e.qx,f=i*2-e.qy;e.qx=h,e.qy=f,l=["Q",h,f].concat(s)}else if(t==="Q"){var d=s[0],p=s[1];e.qx=d,e.qy=p}return l}function cs(n){if(_m(n))return[].concat(n);for(var e=OS(n),t=xa({},Sm),r=0;r<e.length;r+=1){e[r]=NS(e[r],t);var i=e[r],a=i.length;t.x1=+i[a-2],t.y1=+i[a-1],t.x2=+i[a-4]||t.x1,t.y2=+i[a-3]||t.y1}return e}function za(n,e,t){var r=n[0],i=n[1],a=e[0],o=e[1];return[r+(a-r)*t,i+(o-i)*t]}function pd(n,e,t,r,i){var a=Nr([n,e],[t,r]),o={x:0,y:0};if(typeof i=="number")if(i<=0)o={x:n,y:e};else if(i>=a)o={x:t,y:r};else{var s=za([n,e],[t,r],i/a),l=s[0],c=s[1];o={x:l,y:c}}return{length:a,point:o,min:{x:Math.min(n,t),y:Math.min(e,r)},max:{x:Math.max(n,t),y:Math.max(e,r)}}}function Pm(n,e){var t=n.x,r=n.y,i=e.x,a=e.y,o=t*i+r*a,s=Math.sqrt((Math.pow(t,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(a,2))),l=t*a-r*i<0?-1:1,c=l*Math.acos(o/s);return c}function RS(n,e,t,r,i,a,o,s,l,c){var u=Math.abs,h=Math.sin,f=Math.cos,d=Math.sqrt,p=Math.PI,v=u(t),g=u(r),m=(i%360+360)%360,x=m*(p/180);if(n===s&&e===l)return{x:n,y:e};if(v===0||g===0)return pd(n,e,s,l,c).point;var _=(n-s)/2,S=(e-l)/2,b={x:f(x)*_+h(x)*S,y:-h(x)*_+f(x)*S},y=Math.pow(b.x,2)/Math.pow(v,2)+Math.pow(b.y,2)/Math.pow(g,2);y>1&&(v*=d(y),g*=d(y));var E=Math.pow(v,2)*Math.pow(g,2)-Math.pow(v,2)*Math.pow(b.y,2)-Math.pow(g,2)*Math.pow(b.x,2),w=Math.pow(v,2)*Math.pow(b.y,2)+Math.pow(g,2)*Math.pow(b.x,2),M=E/w;M=M<0?0:M;var P=(a!==o?1:-1)*d(M),A={x:P*(v*b.y/g),y:P*(-(g*b.x)/v)},O={x:f(x)*A.x-h(x)*A.y+(n+s)/2,y:h(x)*A.x+f(x)*A.y+(e+l)/2},R={x:(b.x-A.x)/v,y:(b.y-A.y)/g},L=Pm({x:1,y:0},R),z={x:(-b.x-A.x)/v,y:(-b.y-A.y)/g},Y=Pm(R,z);!o&&Y>0?Y-=2*p:o&&Y<0&&(Y+=2*p),Y%=2*p;var I=L+Y*c,Z=v*f(I),J=g*h(I),mt={x:f(x)*Z-h(x)*J+O.x,y:h(x)*Z+f(x)*J+O.y};return mt}function kS(n,e,t,r,i,a,o,s,l,c,u){var h,f=u.bbox,d=f===void 0?!0:f,p=u.length,v=p===void 0?!0:p,g=u.sampleSize,m=g===void 0?30:g,x=typeof c=="number",_=n,S=e,b=0,y=[_,S,b],E=[_,S],w=0,M={x:0,y:0},P=[{x:_,y:S}];x&&c<=0&&(M={x:_,y:S});for(var A=0;A<=m;A+=1){if(w=A/m,h=RS(n,e,t,r,i,a,o,s,l,w),_=h.x,S=h.y,d&&P.push({x:_,y:S}),v&&(b+=Nr(E,[_,S])),E=[_,S],x&&b>=c&&c>y[2]){var O=(b-c)/(b-y[2]);M={x:E[0]*(1-O)+y[0]*O,y:E[1]*(1-O)+y[1]*O}}y=[_,S,b]}return x&&c>=b&&(M={x:s,y:l}),{length:b,point:M,min:{x:Math.min.apply(null,P.map(function(R){return R.x})),y:Math.min.apply(null,P.map(function(R){return R.y}))},max:{x:Math.max.apply(null,P.map(function(R){return R.x})),y:Math.max.apply(null,P.map(function(R){return R.y}))}}}function LS(n,e,t,r,i,a,o,s,l){var c=1-l;return{x:Math.pow(c,3)*n+3*Math.pow(c,2)*l*t+3*c*Math.pow(l,2)*i+Math.pow(l,3)*o,y:Math.pow(c,3)*e+3*Math.pow(c,2)*l*r+3*c*Math.pow(l,2)*a+Math.pow(l,3)*s}}function Mm(n,e,t,r,i,a,o,s,l,c){var u,h=c.bbox,f=h===void 0?!0:h,d=c.length,p=d===void 0?!0:d,v=c.sampleSize,g=v===void 0?10:v,m=typeof l=="number",x=n,_=e,S=0,b=[x,_,S],y=[x,_],E=0,w={x:0,y:0},M=[{x,y:_}];m&&l<=0&&(w={x,y:_});for(var P=0;P<=g;P+=1){if(E=P/g,u=LS(n,e,t,r,i,a,o,s,E),x=u.x,_=u.y,f&&M.push({x,y:_}),p&&(S+=Nr(y,[x,_])),y=[x,_],m&&S>=l&&l>b[2]){var A=(S-l)/(S-b[2]);w={x:y[0]*(1-A)+b[0]*A,y:y[1]*(1-A)+b[1]*A}}b=[x,_,S]}return m&&l>=S&&(w={x:o,y:s}),{length:S,point:w,min:{x:Math.min.apply(null,M.map(function(O){return O.x})),y:Math.min.apply(null,M.map(function(O){return O.y}))},max:{x:Math.max.apply(null,M.map(function(O){return O.x})),y:Math.max.apply(null,M.map(function(O){return O.y}))}}}function IS(n,e,t,r,i,a,o){var s=1-o;return{x:Math.pow(s,2)*n+2*s*o*t+Math.pow(o,2)*i,y:Math.pow(s,2)*e+2*s*o*r+Math.pow(o,2)*a}}function DS(n,e,t,r,i,a,o,s){var l,c=s.bbox,u=c===void 0?!0:c,h=s.length,f=h===void 0?!0:h,d=s.sampleSize,p=d===void 0?10:d,v=typeof o=="number",g=n,m=e,x=0,_=[g,m,x],S=[g,m],b=0,y={x:0,y:0},E=[{x:g,y:m}];v&&o<=0&&(y={x:g,y:m});for(var w=0;w<=p;w+=1){if(b=w/p,l=IS(n,e,t,r,i,a,b),g=l.x,m=l.y,u&&E.push({x:g,y:m}),f&&(x+=Nr(S,[g,m])),S=[g,m],v&&x>=o&&o>_[2]){var M=(x-o)/(x-_[2]);y={x:S[0]*(1-M)+_[0]*M,y:S[1]*(1-M)+_[1]*M}}_=[g,m,x]}return v&&o>=x&&(y={x:i,y:a}),{length:x,point:y,min:{x:Math.min.apply(null,E.map(function(P){return P.x})),y:Math.min.apply(null,E.map(function(P){return P.y}))},max:{x:Math.max.apply(null,E.map(function(P){return P.x})),y:Math.max.apply(null,E.map(function(P){return P.y}))}}}function Cm(n,e,t){for(var r,i,a,o,s,l,c=cs(n),u=typeof e=="number",h,f=[],d,p=0,v=0,g=0,m=0,x,_=[],S=[],b=0,y={x:0,y:0},E=y,w=y,M=y,P=0,A=0,O=c.length;A<O;A+=1)x=c[A],d=x[0],h=d==="M",f=h?f:[p,v].concat(x.slice(1)),h?(g=x[1],m=x[2],y={x:g,y:m},E=y,b=0,u&&e<.001&&(M=y)):d==="L"?(r=pd(f[0],f[1],f[2],f[3],(e||0)-P),b=r.length,y=r.min,E=r.max,w=r.point):d==="A"?(i=kS(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],(e||0)-P,t||{}),b=i.length,y=i.min,E=i.max,w=i.point):d==="C"?(a=Mm(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],(e||0)-P,t||{}),b=a.length,y=a.min,E=a.max,w=a.point):d==="Q"?(o=DS(f[0],f[1],f[2],f[3],f[4],f[5],(e||0)-P,t||{}),b=o.length,y=o.min,E=o.max,w=o.point):d==="Z"&&(f=[p,v,g,m],s=pd(f[0],f[1],f[2],f[3],(e||0)-P),b=s.length,y=s.min,E=s.max,w=s.point),u&&P<e&&P+b>=e&&(M=w),S.push(E),_.push(y),P+=b,l=d!=="Z"?x.slice(-2):[g,m],p=l[0],v=l[1];return u&&e>=P&&(M={x:p,y:v}),{length:P,point:M,min:{x:Math.min.apply(null,_.map(function(R){return R.x})),y:Math.min.apply(null,_.map(function(R){return R.y}))},max:{x:Math.max.apply(null,S.map(function(R){return R.x})),y:Math.max.apply(null,S.map(function(R){return R.y}))}}}function Am(n,e){return Cm(n,void 0,xa(xa({},e),{bbox:!1,length:!0})).length}var xr=function(n){return Array.isArray?Array.isArray(n):ss(n,"Array")},us=function(n){if(xr(n))return n.reduce(function(e,t){return Math.min(e,t)},n[0])},hs=function(n){if(xr(n))return n.reduce(function(e,t){return Math.max(e,t)},n[0])},BS=1e-5;function fs(n,e,t){return t===void 0&&(t=BS),Math.abs(n-e)<t}var FS=function(n,e){return(n%e+e)%e},jc=FS;function GS(n,e,t){if(n[t].length>7){n[t].shift();for(var r=n[t],i=t;r.length;)e[t]="A",n.splice(i+=1,0,["C"].concat(r.splice(0,6)));n.splice(t,1)}}function zS(n){return _m(n)&&n.every(function(e){var t=e[0];return"MC".includes(t)})}function $c(n,e,t){var r=n*Math.cos(t)-e*Math.sin(t),i=n*Math.sin(t)+e*Math.cos(t);return{x:r,y:i}}function vd(n,e,t,r,i,a,o,s,l,c){var u=n,h=e,f=t,d=r,p=s,v=l,g=Math.PI*120/180,m=Math.PI/180*(+i||0),x=[],_,S,b,y,E;if(c)S=c[0],b=c[1],y=c[2],E=c[3];else{_=$c(u,h,-m),u=_.x,h=_.y,_=$c(p,v,-m),p=_.x,v=_.y;var w=(u-p)/2,M=(h-v)/2,P=w*w/(f*f)+M*M/(d*d);P>1&&(P=Math.sqrt(P),f*=P,d*=P);var A=f*f,O=d*d,R=(a===o?-1:1)*Math.sqrt(Math.abs((A*O-A*M*M-O*w*w)/(A*M*M+O*w*w)));y=R*f*M/d+(u+p)/2,E=R*-d*w/f+(h+v)/2,S=Math.asin(((h-E)/d*Math.pow(10,9)>>0)/Math.pow(10,9)),b=Math.asin(((v-E)/d*Math.pow(10,9)>>0)/Math.pow(10,9)),S=u<y?Math.PI-S:S,b=p<y?Math.PI-b:b,S<0&&(S=Math.PI*2+S),b<0&&(b=Math.PI*2+b),o&&S>b&&(S-=Math.PI*2),!o&&b>S&&(b-=Math.PI*2)}var L=b-S;if(Math.abs(L)>g){var z=b,Y=p,I=v;b=S+g*(o&&b>S?1:-1),p=y+f*Math.cos(b),v=E+d*Math.sin(b),x=vd(p,v,f,d,i,0,o,Y,I,[b,z,y,E])}L=b-S;var Z=Math.cos(S),J=Math.sin(S),mt=Math.cos(b),It=Math.sin(b),ae=Math.tan(L/4),ve=4/3*f*ae,Hn=4/3*d*ae,rr=[u,h],rn=[u+ve*J,h-Hn*Z],He=[p+ve*It,v-Hn*mt],hn=[p,v];if(rn[0]=2*rr[0]-rn[0],rn[1]=2*rr[1]-rn[1],c)return rn.concat(He,hn,x);x=rn.concat(He,hn,x);for(var dr=[],an=0,pr=x.length;an<pr;an+=1)dr[an]=an%2?$c(x[an-1],x[an],m).y:$c(x[an],x[an+1],m).x;return dr}function WS(n,e,t,r,i,a){var o=.3333333333333333,s=2/3;return[o*n+s*t,o*e+s*r,o*i+s*t,o*a+s*r,i,a]}var Om=function(n,e,t,r){var i=.5,a=za([n,e],[t,r],i);return dd(dd([],a,!0),[t,r,t,r],!1)};function US(n,e){var t=n[0],r=n.slice(1).map(Number),i=r[0],a=r[1],o,s=e.x1,l=e.y1,c=e.x,u=e.y;switch("TQ".includes(t)||(e.qx=null,e.qy=null),t){case"M":return e.x=i,e.y=a,n;case"A":return o=[s,l].concat(r),["C"].concat(vd(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9]));case"Q":return e.qx=i,e.qy=a,o=[s,l].concat(r),["C"].concat(WS(o[0],o[1],o[2],o[3],o[4],o[5]));case"L":return["C"].concat(Om(s,l,i,a));case"Z":return s===c&&l===u?["C",s,l,c,u,c,u]:["C"].concat(Om(s,l,c,u));default:}return n}function wl(n,e){if(e===void 0&&(e=!1),zS(n)){var t=[].concat(n);return e?[t,[]]:t}for(var r=cs(n),i=xa({},Sm),a=[],o="",s=r.length,l,c,u=[],h=0;h<s;h+=1){r[h]&&(o=r[h][0]),a[h]=o;var f=US(r[h],i);r[h]=f,GS(r,a,h),s=r.length,o==="Z"&&u.push(h),l=r[h],c=l.length,i.x1=+l[c-2],i.y1=+l[c-1],i.x2=+l[c-4]||i.x1,i.y2=+l[c-3]||i.y1}return e?[r,u]:r}function VS(n,e){e===void 0&&(e=.5);var t=n.slice(0,2),r=n.slice(2,4),i=n.slice(4,6),a=n.slice(6,8),o=za(t,r,e),s=za(r,i,e),l=za(i,a,e),c=za(o,s,e),u=za(s,l,e),h=za(c,u,e);return[["C"].concat(o,c,h),["C"].concat(u,l,a)]}function Nm(n){return n.map(function(e,t,r){var i=t&&r[t-1].slice(-2).concat(e.slice(1)),a=t?Mm(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0,o;return t?o=a?VS(i):[e,e]:o=[e],{s:e,ss:o,l:a}})}function gd(n,e,t){var r=Nm(n),i=Nm(e),a=r.length,o=i.length,s=r.filter(function(g){return g.l}).length,l=i.filter(function(g){return g.l}).length,c=r.filter(function(g){return g.l}).reduce(function(g,m){var x=m.l;return g+x},0)/s||0,u=i.filter(function(g){return g.l}).reduce(function(g,m){var x=m.l;return g+x},0)/l||0,h=t||Math.max(a,o),f=[c,u],d=[h-a,h-o],p=0,v=[r,i].map(function(g,m){return g.l===h?g.map(function(x){return x.s}):g.map(function(x,_){return p=_&&d[m]&&x.l>=f[m],d[m]-=p?1:0,p?x.ss:[x.s]}).flat()});return v[0].length===v[1].length?v:gd(v[0],v[1],h)}function HS(n,e,t,r,i,a,o,s){return 3*((s-e)*(t+i)-(o-n)*(r+a)+r*(n-i)-t*(e-a)+s*(i+n/3)-o*(a+e/3))/20}function YS(n){var e=0,t=0,r=0;return wl(n).map(function(i){var a;switch(i[0]){case"M":return e=i[1],t=i[2],0;default:var o=i.slice(1),s=o[0],l=o[1],c=o[2],u=o[3],h=o[4],f=o[5];return r=HS(e,t,s,l,c,u,h,f),a=i.slice(-2),e=a[0],t=a[1],r}}).reduce(function(i,a){return i+a},0)}function Kc(n){return YS(n)>=0}function Rm(n){var e=n.slice(1).map(function(t,r,i){return r?i[r-1].slice(-2).concat(t.slice(1)):n[0].slice(1).concat(t.slice(1))}).map(function(t){return t.map(function(r,i){return t[t.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(e[0].slice(0,2))].concat(e.map(function(t){return["C"].concat(t.slice(2))}))}function km(n){return n.map(function(e){return Array.isArray(e)?[].concat(e):e})}function XS(n){var e=n.length,t=e-1;return n.map(function(r,i){return n.map(function(a,o){var s=i+o,l;return o===0||n[s]&&n[s][0]==="M"?(l=n[s],["M"].concat(l.slice(-2))):(s>=e&&(s-=t),n[s])})})}function Lm(n,e){var t=n.length-1,r=[],i=0,a=0,o=XS(n);return o.forEach(function(s,l){n.slice(1).forEach(function(c,u){a+=Nr(n[(l+u)%t].slice(-2),e[u%t].slice(-2))}),r[l]=a,a=0}),i=r.indexOf(Math.min.apply(null,r)),o[i]}var jS=function(n){return n===void 0},Nt=jS,$S=function(n){return ss(n,"Boolean")},ds=$S,dn=function(n){var e=typeof n;return n!==null&&e==="object"||e==="function"};function Im(n,e,t){return Cm(n,e,xa(xa({},t),{bbox:!1,length:!0})).point}var md=D(93951),yd=function(n,e){return yd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},yd(n,e)};function KS(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");yd(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var xd=function(){return xd=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},xd.apply(this,arguments)};function ZS(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function qS(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(o=n[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function JS(n,e){return function(t,r){e(t,r,n)}}function AW(n,e,t,r,i,a){function o(m){if(m!==void 0&&typeof m!="function")throw new TypeError("Function expected");return m}for(var s=r.kind,l=s==="getter"?"get":s==="setter"?"set":"value",c=!e&&n?r.static?n:n.prototype:null,u=e||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),h,f=!1,d=t.length-1;d>=0;d--){var p={};for(var v in r)p[v]=v==="access"?{}:r[v];for(var v in r.access)p.access[v]=r.access[v];p.addInitializer=function(m){if(f)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(m||null))};var g=(0,t[d])(s==="accessor"?{get:u.get,set:u.set}:u[l],p);if(s==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(h=o(g.get))&&(u.get=h),(h=o(g.set))&&(u.set=h),(h=o(g.init))&&i.unshift(h)}else(h=o(g))&&(s==="field"?i.unshift(h):u[l]=h)}c&&Object.defineProperty(c,r.name,u),f=!0}function OW(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0}function NW(n){return typeof n=="symbol"?n:"".concat(n)}function RW(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function QS(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function tT(n,e,t,r){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):i(u.value).then(s,l)}c((r=r.apply(n,e||[])).next())})}function eT(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(r=1,i&&(a=c[0]&2?i.return:c[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,c[1])).done)return a;switch(i=0,a&&(c=[c[0]&2,a.value]),c[0]){case 0:case 1:a=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){t.label=c[1];break}if(c[0]===6&&t.label<a[1]){t.label=a[1],a=c;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(c);break}a[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],i=0}finally{r=a=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var bd=Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]};function nT(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&bd(e,n,t)}function Ed(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Rr(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function rT(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Rr(arguments[e]));return n}function iT(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function ei(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function _l(n){return this instanceof _l?(this.v=n,this):new _l(n)}function aT(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,a=[];return i={},s("next"),s("throw"),s("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(d){return function(p){return Promise.resolve(p).then(d,h)}}function s(d,p){r[d]&&(i[d]=function(v){return new Promise(function(g,m){a.push([d,v,g,m])>1||l(d,v)})},p&&(i[d]=p(i[d])))}function l(d,p){try{c(r[d](p))}catch(v){f(a[0][3],v)}}function c(d){d.value instanceof _l?Promise.resolve(d.value.v).then(u,h):f(a[0][2],d)}function u(d){l("next",d)}function h(d){l("throw",d)}function f(d,p){d(p),a.shift(),a.length&&l(a[0][0],a[0][1])}}function oT(n){var e,t;return e={},r("next"),r("throw",function(i){throw i}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(i,a){e[i]=n[i]?function(o){return(t=!t)?{value:_l(n[i](o)),done:!1}:a?a(o):o}:a}}function sT(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Ed=="function"?Ed(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(s,l){o=n[a](o),i(s,l,o.done,o.value)})}}function i(a,o,s,l){Promise.resolve(l).then(function(c){a({value:c,done:s})},o)}}function lT(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var cT=Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e};function uT(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&bd(e,n,t);return cT(e,n),e}function hT(n){return n&&n.__esModule?n:{default:n}}function fT(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function dT(n,e,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t}function pT(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function vT(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var gT=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function mT(n){function e(r){n.error=n.hasError?new gT(r,n.error,"An error was suppressed during disposal."):r,n.hasError=!0}function t(){for(;n.stack.length;){var r=n.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(t,function(a){return e(a),t()})}catch(a){e(a)}}if(n.hasError)throw n.error}return t()}var kW={__extends:KS,__assign:xd,__rest:ZS,__decorate:qS,__param:JS,__metadata:QS,__awaiter:tT,__generator:eT,__createBinding:bd,__exportStar:nT,__values:Ed,__read:Rr,__spread:rT,__spreadArrays:iT,__spreadArray:ei,__await:_l,__asyncGenerator:aT,__asyncDelegator:oT,__asyncValues:sT,__makeTemplateObject:lT,__importStar:uT,__importDefault:hT,__classPrivateFieldGet:fT,__classPrivateFieldSet:dT,__classPrivateFieldIn:pT,__addDisposableResource:vT,__disposeResources:mT};function ar(n,e,t,r){var i=n-t,a=e-r;return Math.sqrt(i*i+a*a)}function Zc(n,e){var t=Math.min.apply(Math,ei([],Rr(n),!1)),r=Math.min.apply(Math,ei([],Rr(e),!1)),i=Math.max.apply(Math,ei([],Rr(n),!1)),a=Math.max.apply(Math,ei([],Rr(e),!1));return{x:t,y:r,width:i-t,height:a-r}}function Dm(n){return(n+Math.PI*2)%(Math.PI*2)}function Bm(n,e){var t=Math.abs(n);return e>0?t:t*-1}function yT(n,e,t,r,i,a){var o=t,s=r;if(o===0||s===0)return{x:n,y:e};for(var l=i-n,c=a-e,u=Math.abs(l),h=Math.abs(c),f=o*o,d=s*s,p=Math.PI/4,v=0,g=0,m=0;m<4;m++){v=o*Math.cos(p),g=s*Math.sin(p);var x=(f-d)*Math.pow(Math.cos(p),3)/o,_=(d-f)*Math.pow(Math.sin(p),3)/s,S=v-x,b=g-_,y=u-x,E=h-_,w=Math.hypot(b,S),M=Math.hypot(E,y),P=w*Math.asin((S*E-b*y)/(w*M)),A=P/Math.sqrt(f+d-v*v-g*g);p+=A,p=Math.min(Math.PI/2,Math.max(0,p))}return{x:n+Bm(v,l),y:e+Bm(g,c)}}function xT(n,e,t,r,i,a,o,s){return-1*t*Math.cos(i)*Math.sin(s)-r*Math.sin(i)*Math.cos(s)}function bT(n,e,t,r,i,a,o,s){return-1*t*Math.sin(i)*Math.sin(s)+r*Math.cos(i)*Math.cos(s)}function ET(n,e,t){return Math.atan(-e/n*Math.tan(t))}function wT(n,e,t){return Math.atan(e/(n*Math.tan(t)))}function _T(n,e,t,r,i,a){return t*Math.cos(i)*Math.cos(a)-r*Math.sin(i)*Math.sin(a)+n}function ST(n,e,t,r,i,a){return t*Math.sin(i)*Math.cos(a)+r*Math.cos(i)*Math.sin(a)+e}function TT(n,e,t,r){var i=Math.atan2(r*n,t*e);return(i+Math.PI*2)%(Math.PI*2)}function Fm(n,e,t){return{x:n*Math.cos(t),y:e*Math.sin(t)}}function Gm(n,e,t){var r=Math.cos(t),i=Math.sin(t);return[n*r-e*i,n*i+e*r]}function wd(n,e,t,r,i,a,o){for(var s=ET(t,r,i),l=1/0,c=-1/0,u=[a,o],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var f=s+h;a<o?a<f&&f<o&&u.push(f):o<f&&f<a&&u.push(f)}for(var h=0;h<u.length;h++){var d=_T(n,e,t,r,i,u[h]);d<l&&(l=d),d>c&&(c=d)}for(var p=wT(t,r,i),v=1/0,g=-1/0,m=[a,o],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var x=p+h;a<o?a<x&&x<o&&m.push(x):o<x&&x<a&&m.push(x)}for(var h=0;h<m.length;h++){var _=ST(n,e,t,r,i,m[h]);_<v&&(v=_),_>g&&(g=_)}return{x:l,y:v,width:c-l,height:g-v}}function LW(n,e,t,r,i,a,o,s,l){var c=Gm(s-n,l-e,-i),u=__read(c,2),h=u[0],f=u[1],d=yT(0,0,t,r,h,f),p=TT(t,r,d.x,d.y);p<a?d=Fm(t,r,a):p>o&&(d=Fm(t,r,o));var v=Gm(d.x,d.y,i);return{x:v[0]+n,y:v[1]+e}}function IW(n,e,t,r,i,a,o,s){var l=(o-a)*s+a,c=xT(n,e,t,r,i,a,o,l),u=bT(n,e,t,r,i,a,o,l);return Dm(Math.atan2(u,c))}var PT=1e-4;function zm(n,e,t,r,i,a){var o=-1,s=1/0,l=[t,r],c=20;a&&a>200&&(c=a/10);for(var u=1/c,h=u/10,f=0;f<=c;f++){var d=f*u,p=[i.apply(void 0,ei([],Rr(n.concat([d])),!1)),i.apply(void 0,ei([],Rr(e.concat([d])),!1))],v=ar(l[0],l[1],p[0],p[1]);v<s&&(o=d,s=v)}if(o===0)return{x:n[0],y:e[0]};if(o===1){var g=n.length;return{x:n[g-1],y:e[g-1]}}s=1/0;for(var f=0;f<32&&!(h<PT);f++){var m=o-h,x=o+h,p=[i.apply(void 0,ei([],Rr(n.concat([m])),!1)),i.apply(void 0,ei([],Rr(e.concat([m])),!1))],v=ar(l[0],l[1],p[0],p[1]);if(m>=0&&v<s)o=m,s=v;else{var _=[i.apply(void 0,ei([],Rr(n.concat([x])),!1)),i.apply(void 0,ei([],Rr(e.concat([x])),!1))],S=ar(l[0],l[1],_[0],_[1]);x<=1&&S<s?(o=x,s=S):h*=.5}}return{x:i.apply(void 0,ei([],Rr(n.concat([o])),!1)),y:i.apply(void 0,ei([],Rr(e.concat([o])),!1))}}function MT(n,e){for(var t=0,r=n.length,i=0;i<r;i++){var a=n[i],o=e[i],s=n[(i+1)%r],l=e[(i+1)%r];t+=ar(a,o,s,l)}return t/2}function DW(n,e,t,r){return Zc([n,t],[e,r])}function ps(n,e,t,r){return ar(n,e,t,r)}function kr(n,e,t,r,i){return{x:(1-i)*n+i*t,y:(1-i)*e+i*r}}function CT(n,e,t,r,i,a){var o=(t-n)*(i-n)+(r-e)*(a-e);if(o<0)return ar(n,e,i,a);var s=(t-n)*(t-n)+(r-e)*(r-e);return o>s?ar(t,r,i,a):Wm(n,e,t,r,i,a)}function Wm(n,e,t,r,i,a){var o=[t-n,r-e];if(ya.I6(o,[0,0]))return Math.sqrt((i-n)*(i-n)+(a-e)*(a-e));var s=[-o[1],o[0]];ya.Fv(s,s);var l=[i-n,a-e];return Math.abs(ya.AK(l,s))}function BW(n,e,t,r){return Math.atan2(r-e,t-n)}function Ao(n,e,t,r,i){var a=1-i;return a*a*a*n+3*e*i*a*a+3*t*i*i*a+r*i*i*i}function Um(n,e,t,r,i){var a=1-i;return 3*(a*a*(e-n)+2*a*i*(t-e)+i*i*(r-t))}function Vm(n,e,t,r){var i=-3*n+9*e-9*t+3*r,a=6*n-12*e+6*t,o=3*e-3*n,s=[],l,c,u;if(fs(i,0))fs(a,0)||(l=-o/a,l>=0&&l<=1&&s.push(l));else{var h=a*a-4*i*o;fs(h,0)?s.push(-a/(2*i)):h>0&&(u=Math.sqrt(h),l=(-a+u)/(2*i),c=(-a-u)/(2*i),l>=0&&l<=1&&s.push(l),c>=0&&c<=1&&s.push(c))}return s}function AT(n,e,t,r,i,a,o,s,l){var c=Ao(n,t,i,o,l),u=Ao(e,r,a,s,l),h=kr(n,e,t,r,l),f=kr(t,r,i,a,l),d=kr(i,a,o,s,l),p=kr(h.x,h.y,f.x,f.y,l),v=kr(f.x,f.y,d.x,d.y,l);return[[n,e,h.x,h.y,p.x,p.y,c,u],[c,u,v.x,v.y,d.x,d.y,o,s]]}function _d(n,e,t,r,i,a,o,s,l){if(l===0)return MT([n,t,i,o],[e,r,a,s]);var c=AT(n,e,t,r,i,a,o,s,.5),u=__spreadArray(__spreadArray([],__read(c[0]),!1),[l-1],!1),h=__spreadArray(__spreadArray([],__read(c[1]),!1),[l-1],!1);return _d.apply(void 0,__spreadArray([],__read(u),!1))+_d.apply(void 0,__spreadArray([],__read(h),!1))}function Sd(n,e,t,r,i,a,o,s){for(var l=[n,o],c=[e,s],u=Vm(n,t,i,o),h=Vm(e,r,a,s),f=0;f<u.length;f++)l.push(Ao(n,t,i,o,u[f]));for(var f=0;f<h.length;f++)c.push(Ao(e,r,a,s,h[f]));return Zc(l,c)}function FW(n,e,t,r,i,a,o,s){return _d(n,e,t,r,i,a,o,s,3)}function OT(n,e,t,r,i,a,o,s,l,c,u){return zm([n,t,i,o],[e,r,a,s],l,c,Ao,u)}function Hm(n,e,t,r,i,a,o,s,l,c,u){var h=OT(n,e,t,r,i,a,o,s,l,c,u);return ar(h.x,h.y,l,c)}function GW(n,e,t,r,i,a,o,s,l){return{x:Ao(n,t,i,o,l),y:Ao(e,r,a,s,l)}}function zW(n,e,t,r,i,a,o,s,l){var c=Um(n,t,i,o,l),u=Um(e,r,a,s,l);return Dm(Math.atan2(u,c))}function Ym(n){for(var e=0,t=[],r=0;r<n.length-1;r++){var i=n[r],a=n[r+1],o=ar(i[0],i[1],a[0],a[1]),s={from:i,to:a,length:o};t.push(s),e+=o}return{segments:t,totalLength:e}}function Xm(n){if(n.length<2)return 0;for(var e=0,t=0;t<n.length-1;t++){var r=n[t],i=n[t+1];e+=ar(r[0],r[1],i[0],i[1])}return e}function jm(n,e){if(e>1||e<0||n.length<2)return null;var t=Ym(n),r=t.segments,i=t.totalLength;if(i===0)return{x:n[0][0],y:n[0][1]};for(var a=0,o=null,s=0;s<r.length;s++){var l=r[s],c=l.from,u=l.to,h=l.length/i;if(e>=a&&e<=a+h){var f=(e-a)/h;o=kr(c[0],c[1],u[0],u[1],f);break}a+=h}return o}function $m(n,e){if(e>1||e<0||n.length<2)return 0;for(var t=Ym(n),r=t.segments,i=t.totalLength,a=0,o=0,s=0;s<r.length;s++){var l=r[s],c=l.from,u=l.to,h=l.length/i;if(e>=a&&e<=a+h){o=Math.atan2(u[1]-c[1],u[0]-c[0]);break}a+=h}return o}function Km(n,e,t){for(var r=1/0,i=0;i<n.length-1;i++){var a=n[i],o=n[i+1],s=CT(a[0],a[1],o[0],o[1],e,t);s<r&&(r=s)}return r}function NT(n){for(var e=[],t=[],r=0;r<n.length;r++){var i=n[r];e.push(i[0]),t.push(i[1])}return Zc(e,t)}function Td(n){return Xm(n)}function WW(n,e){return jm(n,e)}function UW(n,e,t){return Km(n,e,t)}function VW(n,e){return $m(n,e)}function qc(n){var e=n.slice(0);return n.length&&e.push(n[0]),e}function HW(n){return NT(n)}function YW(n){return Xm(qc(n))}function XW(n,e){return jm(qc(n),e)}function jW(n,e,t){return Km(qc(n),e,t)}function $W(n,e){return $m(qc(n),e)}function Sl(n,e,t,r){var i=1-r;return i*i*n+2*r*i*e+r*r*t}function Zm(n,e,t){var r=n+t-2*e;if(fs(r,0))return[.5];var i=(n-e)/r;return i<=1&&i>=0?[i]:[]}function RT(n,e,t,r,i,a,o){var s=Sl(n,t,i,o),l=Sl(e,r,a,o),c=kr(n,e,t,r,o),u=kr(t,r,i,a,o);return[[n,e,c.x,c.y,s,l],[s,l,u.x,u.y,i,a]]}function Pd(n,e,t,r,i,a,o){if(o===0)return(ar(n,e,t,r)+ar(t,r,i,a)+ar(n,e,i,a))/2;var s=RT(n,e,t,r,i,a,.5),l=s[0],c=s[1];return l.push(o-1),c.push(o-1),Pd.apply(void 0,__spreadArray([],__read(l),!1))+Pd.apply(void 0,__spreadArray([],__read(c),!1))}function Md(n,e,t,r,i,a){var o=Zm(n,t,i)[0],s=Zm(e,r,a)[0],l=[n,i],c=[e,a];return o!==void 0&&l.push(Sl(n,t,i,o)),s!==void 0&&c.push(Sl(e,r,a,s)),Zc(l,c)}function KW(n,e,t,r,i,a){return Pd(n,e,t,r,i,a,3)}function kT(n,e,t,r,i,a,o,s){return zm([n,t,i],[e,r,a],o,s,Sl)}function LT(n,e,t,r,i,a,o,s){var l=kT(n,e,t,r,i,a,o,s);return ar(l.x,l.y,o,s)}var IT=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:typeof self!="undefined"?self:{},qm={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(IT,function(){function t(b,y,E,w,M){r(b,y,E||0,w||b.length-1,M||a)}function r(b,y,E,w,M){for(;w>E;){if(w-E>600){var P=w-E+1,A=y-E+1,O=Math.log(P),R=.5*Math.exp(2*O/3),L=.5*Math.sqrt(O*R*(P-R)/P)*(A-P/2<0?-1:1),z=Math.max(E,Math.floor(y-A*R/P+L)),Y=Math.min(w,Math.floor(y+(P-A)*R/P+L));r(b,y,z,Y,M)}var I=b[y],Z=E,J=w;for(i(b,E,y),M(b[w],I)>0&&i(b,E,w);Z<J;){for(i(b,Z,J),Z++,J--;M(b[Z],I)<0;)Z++;for(;M(b[J],I)>0;)J--}M(b[E],I)===0?i(b,E,J):(J++,i(b,J,w)),J<=y&&(E=J+1),y<=J&&(w=J-1)}}function i(b,y,E){var w=b[y];b[y]=b[E],b[E]=w}function a(b,y){return b<y?-1:b>y?1:0}var o=function(y){y===void 0&&(y=9),this._maxEntries=Math.max(4,y),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(y){var E=this.data,w=[];if(!x(y,E))return w;for(var M=this.toBBox,P=[];E;){for(var A=0;A<E.children.length;A++){var O=E.children[A],R=E.leaf?M(O):O;x(y,R)&&(E.leaf?w.push(O):m(y,R)?this._all(O,w):P.push(O))}E=P.pop()}return w},o.prototype.collides=function(y){var E=this.data;if(!x(y,E))return!1;for(var w=[];E;){for(var M=0;M<E.children.length;M++){var P=E.children[M],A=E.leaf?this.toBBox(P):P;if(x(y,A)){if(E.leaf||m(y,A))return!0;w.push(P)}}E=w.pop()}return!1},o.prototype.load=function(y){if(!(y&&y.length))return this;if(y.length<this._minEntries){for(var E=0;E<y.length;E++)this.insert(y[E]);return this}var w=this._build(y.slice(),0,y.length-1,0);if(!this.data.children.length)this.data=w;else if(this.data.height===w.height)this._splitRoot(this.data,w);else{if(this.data.height<w.height){var M=this.data;this.data=w,w=M}this._insert(w,this.data.height-w.height-1,!0)}return this},o.prototype.insert=function(y){return y&&this._insert(y,this.data.height-1),this},o.prototype.clear=function(){return this.data=_([]),this},o.prototype.remove=function(y,E){if(!y)return this;for(var w=this.data,M=this.toBBox(y),P=[],A=[],O,R,L;w||P.length;){if(w||(w=P.pop(),R=P[P.length-1],O=A.pop(),L=!0),w.leaf){var z=s(y,w.children,E);if(z!==-1)return w.children.splice(z,1),P.push(w),this._condense(P),this}!L&&!w.leaf&&m(w,M)?(P.push(w),A.push(O),O=0,R=w,w=w.children[0]):R?(O++,w=R.children[O],L=!1):w=null}return this},o.prototype.toBBox=function(y){return y},o.prototype.compareMinX=function(y,E){return y.minX-E.minX},o.prototype.compareMinY=function(y,E){return y.minY-E.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(y){return this.data=y,this},o.prototype._all=function(y,E){for(var w=[];y;)y.leaf?E.push.apply(E,y.children):w.push.apply(w,y.children),y=w.pop();return E},o.prototype._build=function(y,E,w,M){var P=w-E+1,A=this._maxEntries,O;if(P<=A)return O=_(y.slice(E,w+1)),l(O,this.toBBox),O;M||(M=Math.ceil(Math.log(P)/Math.log(A)),A=Math.ceil(P/Math.pow(A,M-1))),O=_([]),O.leaf=!1,O.height=M;var R=Math.ceil(P/A),L=R*Math.ceil(Math.sqrt(A));S(y,E,w,L,this.compareMinX);for(var z=E;z<=w;z+=L){var Y=Math.min(z+L-1,w);S(y,z,Y,R,this.compareMinY);for(var I=z;I<=Y;I+=R){var Z=Math.min(I+R-1,Y);O.children.push(this._build(y,I,Z,M-1))}}return l(O,this.toBBox),O},o.prototype._chooseSubtree=function(y,E,w,M){for(;M.push(E),!(E.leaf||M.length-1===w);){for(var P=1/0,A=1/0,O=void 0,R=0;R<E.children.length;R++){var L=E.children[R],z=d(L),Y=v(y,L)-z;Y<A?(A=Y,P=z<P?z:P,O=L):Y===A&&z<P&&(P=z,O=L)}E=O||E.children[0]}return E},o.prototype._insert=function(y,E,w){var M=w?y:this.toBBox(y),P=[],A=this._chooseSubtree(M,this.data,E,P);for(A.children.push(y),u(A,M);E>=0&&P[E].children.length>this._maxEntries;)this._split(P,E),E--;this._adjustParentBBoxes(M,P,E)},o.prototype._split=function(y,E){var w=y[E],M=w.children.length,P=this._minEntries;this._chooseSplitAxis(w,P,M);var A=this._chooseSplitIndex(w,P,M),O=_(w.children.splice(A,w.children.length-A));O.height=w.height,O.leaf=w.leaf,l(w,this.toBBox),l(O,this.toBBox),E?y[E-1].children.push(O):this._splitRoot(w,O)},o.prototype._splitRoot=function(y,E){this.data=_([y,E]),this.data.height=y.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(y,E,w){for(var M,P=1/0,A=1/0,O=E;O<=w-E;O++){var R=c(y,0,O,this.toBBox),L=c(y,O,w,this.toBBox),z=g(R,L),Y=d(R)+d(L);z<P?(P=z,M=O,A=Y<A?Y:A):z===P&&Y<A&&(A=Y,M=O)}return M||w-E},o.prototype._chooseSplitAxis=function(y,E,w){var M=y.leaf?this.compareMinX:h,P=y.leaf?this.compareMinY:f,A=this._allDistMargin(y,E,w,M),O=this._allDistMargin(y,E,w,P);A<O&&y.children.sort(M)},o.prototype._allDistMargin=function(y,E,w,M){y.children.sort(M);for(var P=this.toBBox,A=c(y,0,E,P),O=c(y,w-E,w,P),R=p(A)+p(O),L=E;L<w-E;L++){var z=y.children[L];u(A,y.leaf?P(z):z),R+=p(A)}for(var Y=w-E-1;Y>=E;Y--){var I=y.children[Y];u(O,y.leaf?P(I):I),R+=p(O)}return R},o.prototype._adjustParentBBoxes=function(y,E,w){for(var M=w;M>=0;M--)u(E[M],y)},o.prototype._condense=function(y){for(var E=y.length-1,w=void 0;E>=0;E--)y[E].children.length===0?E>0?(w=y[E-1].children,w.splice(w.indexOf(y[E]),1)):this.clear():l(y[E],this.toBBox)};function s(b,y,E){if(!E)return y.indexOf(b);for(var w=0;w<y.length;w++)if(E(b,y[w]))return w;return-1}function l(b,y){c(b,0,b.children.length,y,b)}function c(b,y,E,w,M){M||(M=_(null)),M.minX=1/0,M.minY=1/0,M.maxX=-1/0,M.maxY=-1/0;for(var P=y;P<E;P++){var A=b.children[P];u(M,b.leaf?w(A):A)}return M}function u(b,y){return b.minX=Math.min(b.minX,y.minX),b.minY=Math.min(b.minY,y.minY),b.maxX=Math.max(b.maxX,y.maxX),b.maxY=Math.max(b.maxY,y.maxY),b}function h(b,y){return b.minX-y.minX}function f(b,y){return b.minY-y.minY}function d(b){return(b.maxX-b.minX)*(b.maxY-b.minY)}function p(b){return b.maxX-b.minX+(b.maxY-b.minY)}function v(b,y){return(Math.max(y.maxX,b.maxX)-Math.min(y.minX,b.minX))*(Math.max(y.maxY,b.maxY)-Math.min(y.minY,b.minY))}function g(b,y){var E=Math.max(b.minX,y.minX),w=Math.max(b.minY,y.minY),M=Math.min(b.maxX,y.maxX),P=Math.min(b.maxY,y.maxY);return Math.max(0,M-E)*Math.max(0,P-w)}function m(b,y){return b.minX<=y.minX&&b.minY<=y.minY&&y.maxX<=b.maxX&&y.maxY<=b.maxY}function x(b,y){return y.minX<=b.maxX&&y.minY<=b.maxY&&y.maxX>=b.minX&&y.maxY>=b.minY}function _(b){return{children:b,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function S(b,y,E,w,M){for(var P=[y,E];P.length;)if(E=P.pop(),y=P.pop(),!(E-y<=w)){var A=y+Math.ceil((E-y)/w/2)*w;t(b,A,y,E,M),P.push(y,A,A,E)}}return o})})(qm);var DT=qm.exports,ct;(function(n){n.GROUP="g",n.CIRCLE="circle",n.ELLIPSE="ellipse",n.IMAGE="image",n.RECT="rect",n.LINE="line",n.POLYLINE="polyline",n.POLYGON="polygon",n.TEXT="text",n.PATH="path",n.HTML="html",n.MESH="mesh"})(ct||(ct={}));var vs;(function(n){n[n.ZERO=0]="ZERO",n[n.NEGATIVE_ONE=1]="NEGATIVE_ONE"})(vs||(vs={}));var Oo=function(){function n(){this.plugins=[]}return n.prototype.addRenderingPlugin=function(e){this.plugins.push(e),this.context.renderingPlugins.push(e)},n.prototype.removeAllRenderingPlugins=function(){var e=this;this.plugins.forEach(function(t){var r=e.context.renderingPlugins.indexOf(t);r>=0&&e.context.renderingPlugins.splice(r,1)})},n}(),BT=function(){function n(e){this.clipSpaceNearZ=vs.NEGATIVE_ONE,this.plugins=[],this.config=N({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0},e)}return n.prototype.registerPlugin=function(e){var t=this.plugins.findIndex(function(r){return r===e});t===-1&&this.plugins.push(e)},n.prototype.unregisterPlugin=function(e){var t=this.plugins.findIndex(function(r){return r===e});t>-1&&this.plugins.splice(t,1)},n.prototype.getPlugins=function(){return this.plugins},n.prototype.getPlugin=function(e){return this.plugins.find(function(t){return t.name===e})},n.prototype.getConfig=function(){return this.config},n.prototype.setConfig=function(e){Object.assign(this.config,e)},n}();function gs(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function Cd(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function Jc(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function Jm(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function FT(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n}function GT(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n}function ms(n){return n===void 0?0:n>360||n<-360?n%360:n}function br(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=0),Array.isArray(n)&&n.length===3?T.d9(n):fe(n)?T.al(n,e,t):T.al(n[0],n[1]||e,n[2]||t)}function Oe(n){return n*(Math.PI/180)}function wi(n){return n*(180/Math.PI)}function ZW(n){return n=n%400,n<0&&(n+=400),n/400*360}function qW(n){return n/360}function zT(n){return 360*n}function WT(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=t*t,s=r*r,l=i*i,c=a*a,u=o+s+l+c,h=t*a-r*i;return h>.499995*u?(n[0]=Math.PI/2,n[1]=2*Math.atan2(r,t),n[2]=0):h<-.499995*u?(n[0]=-Math.PI/2,n[1]=2*Math.atan2(r,t),n[2]=0):(n[0]=Math.asin(2*(t*i-a*r)),n[1]=Math.atan2(2*(t*a+r*i),1-2*(l+c)),n[2]=Math.atan2(2*(t*r+i*a),1-2*(s+l))),n}function UT(n,e){var t,r,i=Math.PI*.5,a=C(Ye(T.Ue(),e),3),o=a[0],s=a[1],l=a[2],c=Math.asin(-e[2]/o);return c<i?c>-i?(t=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,t=-Math.atan2(e[4]/s,e[5]/s)):(r=0,t=Math.atan2(e[4]/s,e[5]/s)),n[0]=t,n[1]=c,n[2]=r,n}function Ad(n,e){return e.length===16?UT(n,e):WT(n,e)}function VT(n,e,t,r,i){var a=Math.cos(n),o=Math.sin(n);return Qi.al(r*a,i*o,0,-r*o,i*a,0,e,t,1)}function HT(n,e,t,r,i,a,o,s){s===void 0&&(s=!1);var l=2*a/(t-e),c=2*a/(r-i),u=(t+e)/(t-e),h=(r+i)/(r-i),f,d;return s?(f=-o/(o-a),d=-o*a/(o-a)):(f=-(o+a)/(o-a),d=-2*o*a/(o-a)),n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=u,n[9]=h,n[10]=f,n[11]=-1,n[12]=0,n[13]=0,n[14]=d,n[15]=0,n}function Qm(n){var e=n[0],t=n[1],r=n[3],i=n[4],a=Math.sqrt(e*e+t*t),o=Math.sqrt(r*r+i*i),s=e*i-t*r;s<0&&(e<i?a=-a:o=-o),a&&(e*=1/a,t*=1/a),o&&(r*=1/o,i*=1/o);var l=Math.atan2(t,e),c=wi(l);return[n[6],n[7],a,o,c]}var ta=Q(),Vi=Q(),Tl=on(),$t=[T.Ue(),T.Ue(),T.Ue()],ty=T.Ue();function YT(n,e,t,r,i,a){if(!XT(ta,n)||(kt(Vi,ta),Vi[3]=0,Vi[7]=0,Vi[11]=0,Vi[15]=1,Math.abs(Pe(Vi))<1e-8))return!1;var o=ta[3],s=ta[7],l=ta[11],c=ta[12],u=ta[13],h=ta[14],f=ta[15];if(o!==0||s!==0||l!==0){Tl[0]=o,Tl[1]=s,Tl[2]=l,Tl[3]=f;var d=Wt(Vi,Vi);if(!d)return!1;Te(Vi,Vi),fn(i,Tl,Vi)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=c,e[1]=u,e[2]=h,jT($t,ta),t[0]=T.kE($t[0]),T.Fv($t[0],$t[0]),r[0]=T.AK($t[0],$t[1]),Od($t[1],$t[1],$t[0],1,-r[0]),t[1]=T.kE($t[1]),T.Fv($t[1],$t[1]),r[0]/=t[1],r[1]=T.AK($t[0],$t[2]),Od($t[2],$t[2],$t[0],1,-r[1]),r[2]=T.AK($t[1],$t[2]),Od($t[2],$t[2],$t[1],1,-r[2]),t[2]=T.kE($t[2]),T.Fv($t[2],$t[2]),r[1]/=t[2],r[2]/=t[2],T.kC(ty,$t[1],$t[2]),T.AK($t[0],ty)<0)for(var p=0;p<3;p++)t[p]*=-1,$t[p][0]*=-1,$t[p][1]*=-1,$t[p][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+$t[0][0]-$t[1][1]-$t[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-$t[0][0]+$t[1][1]-$t[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-$t[0][0]-$t[1][1]+$t[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+$t[0][0]+$t[1][1]+$t[2][2],0)),$t[2][1]>$t[1][2]&&(a[0]=-a[0]),$t[0][2]>$t[2][0]&&(a[1]=-a[1]),$t[1][0]>$t[0][1]&&(a[2]=-a[2]),!0}function XT(n,e){var t=e[15];if(t===0)return!1;for(var r=1/t,i=0;i<16;i++)n[i]=e[i]*r;return!0}function jT(n,e){n[0][0]=e[0],n[0][1]=e[1],n[0][2]=e[2],n[1][0]=e[4],n[1][1]=e[5],n[1][2]=e[6],n[2][0]=e[8],n[2][1]=e[9],n[2][2]=e[10]}function Od(n,e,t,r,i){n[0]=e[0]*r+t[0]*i,n[1]=e[1]*r+t[1]*i,n[2]=e[2]*r+t[2]*i}var Fe=function(){function n(){this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return n.isEmpty=function(e){return!e||e.halfExtents[0]===0&&e.halfExtents[1]===0&&e.halfExtents[2]===0},n.prototype.update=function(e,t){gs(this.center,e),gs(this.halfExtents,t),Cd(this.min,this.center,this.halfExtents),Jc(this.max,this.center,this.halfExtents)},n.prototype.setMinMax=function(e,t){Jc(this.center,t,e),Jm(this.center,this.center,.5),Cd(this.halfExtents,t,e),Jm(this.halfExtents,this.halfExtents,.5),gs(this.min,e),gs(this.max,t)},n.prototype.getMin=function(){return this.min},n.prototype.getMax=function(){return this.max},n.prototype.add=function(e){if(!n.isEmpty(e)){if(n.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return}var t=this.center,r=t[0],i=t[1],a=t[2],o=this.halfExtents,s=o[0],l=o[1],c=o[2],u=r-s,h=r+s,f=i-l,d=i+l,p=a-c,v=a+c,g=e.center,m=g[0],x=g[1],_=g[2],S=e.halfExtents,b=S[0],y=S[1],E=S[2],w=m-b,M=m+b,P=x-y,A=x+y,O=_-E,R=_+E;w<u&&(u=w),M>h&&(h=M),P<f&&(f=P),A>d&&(d=A),O<p&&(p=O),R>v&&(v=R),t[0]=(u+h)*.5,t[1]=(f+d)*.5,t[2]=(p+v)*.5,o[0]=(h-u)*.5,o[1]=(d-f)*.5,o[2]=(v-p)*.5,this.min[0]=u,this.min[1]=f,this.min[2]=p,this.max[0]=h,this.max[1]=d,this.max[2]=v}},n.prototype.setFromTransformedAABB=function(e,t){var r=this.center,i=this.halfExtents,a=e.center,o=e.halfExtents,s=t[0],l=t[4],c=t[8],u=t[1],h=t[5],f=t[9],d=t[2],p=t[6],v=t[10],g=Math.abs(s),m=Math.abs(l),x=Math.abs(c),_=Math.abs(u),S=Math.abs(h),b=Math.abs(f),y=Math.abs(d),E=Math.abs(p),w=Math.abs(v);r[0]=t[12]+s*a[0]+l*a[1]+c*a[2],r[1]=t[13]+u*a[0]+h*a[1]+f*a[2],r[2]=t[14]+d*a[0]+p*a[1]+v*a[2],i[0]=g*o[0]+m*o[1]+x*o[2],i[1]=_*o[0]+S*o[1]+b*o[2],i[2]=y*o[0]+E*o[1]+w*o[2],Cd(this.min,r,i),Jc(this.max,r,i)},n.prototype.intersects=function(e){var t=this.getMax(),r=this.getMin(),i=e.getMax(),a=e.getMin();return r[0]<=i[0]&&t[0]>=a[0]&&r[1]<=i[1]&&t[1]>=a[1]&&r[2]<=i[2]&&t[2]>=a[2]},n.prototype.intersection=function(e){if(!this.intersects(e))return null;var t=new n,r=FT([0,0,0],this.getMin(),e.getMin()),i=GT([0,0,0],this.getMax(),e.getMax());return t.setMinMax(r,i),t},n.prototype.getNegativeFarPoint=function(e){return e.pnVertexFlag===273?gs([0,0,0],this.min):e.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:e.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]},n.prototype.getPositiveFarPoint=function(e){return e.pnVertexFlag===273?gs([0,0,0],this.max):e.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:e.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]},n}(),$T=function(){function n(e,t){this.distance=e||0,this.normal=t||T.al(0,1,0),this.updatePNVertexFlag()}return n.prototype.updatePNVertexFlag=function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)},n.prototype.distanceToPoint=function(e){return T.AK(e,this.normal)-this.distance},n.prototype.normalize=function(){var e=1/T.Zh(this.normal);T.bA(this.normal,this.normal,e),this.distance*=e},n.prototype.intersectsLine=function(e,t,r){var i=this.distanceToPoint(e),a=this.distanceToPoint(t),o=i/(i-a),s=o>=0&&o<=1;return s&&r&&T.t7(r,e,t,o),s},n}(),Wa;(function(n){n[n.OUTSIDE=4294967295]="OUTSIDE",n[n.INSIDE=0]="INSIDE",n[n.INDETERMINATE=2147483647]="INDETERMINATE"})(Wa||(Wa={}));var KT=function(){function n(e){if(this.planes=[],e)this.planes=e;else for(var t=0;t<6;t++)this.planes.push(new $T)}return n.prototype.extractFromVPMatrix=function(e){var t=C(e,16),r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],f=t[9],d=t[10],p=t[11],v=t[12],g=t[13],m=t[14],x=t[15];T.t8(this.planes[0].normal,o-r,u-s,p-h),this.planes[0].distance=x-v,T.t8(this.planes[1].normal,o+r,u+s,p+h),this.planes[1].distance=x+v,T.t8(this.planes[2].normal,o+i,u+l,p+f),this.planes[2].distance=x+g,T.t8(this.planes[3].normal,o-i,u-l,p-f),this.planes[3].distance=x-g,T.t8(this.planes[4].normal,o-a,u-c,p-d),this.planes[4].distance=x-m,T.t8(this.planes[5].normal,o+a,u+c,p+d),this.planes[5].distance=x+m,this.planes.forEach(function(_){_.normalize(),_.updatePNVertexFlag()})},n}(),Yn=function(){function n(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.copyFrom=function(e){this.x=e.x,this.y=e.y},n}(),Ua=function(){function n(e,t,r,i){this.x=e,this.y=t,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=t,this.bottom=t+i}return n.fromRect=function(e){return new n(e.x,e.y,e.width,e.height)},n.applyTransform=function(e,t){var r=va(e.x,e.y,0,1),i=va(e.x+e.width,e.y,0,1),a=va(e.x,e.y+e.height,0,1),o=va(e.x+e.width,e.y+e.height,0,1),s=on(),l=on(),c=on(),u=on();fn(s,r,t),fn(l,i,t),fn(c,a,t),fn(u,o,t);var h=Math.min(s[0],l[0],c[0],u[0]),f=Math.min(s[1],l[1],c[1],u[1]),d=Math.max(s[0],l[0],c[0],u[0]),p=Math.max(s[1],l[1],c[1],u[1]);return n.fromRect({x:h,y:f,width:d-h,height:p-f})},n.prototype.toJSON=function(){},n}(),Ne="Method not implemented.",ys="Use document.documentElement instead.",ZT="Cannot append a destroyed element.",we;(function(n){n[n.ORBITING=0]="ORBITING",n[n.EXPLORING=1]="EXPLORING",n[n.TRACKING=2]="TRACKING"})(we||(we={}));var Pl;(function(n){n[n.DEFAULT=0]="DEFAULT",n[n.ROTATIONAL=1]="ROTATIONAL",n[n.TRANSLATIONAL=2]="TRANSLATIONAL",n[n.CINEMATIC=3]="CINEMATIC"})(Pl||(Pl={}));var Lr;(function(n){n[n.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",n[n.PERSPECTIVE=1]="PERSPECTIVE"})(Lr||(Lr={}));var ey={UPDATED:"updated"},ny=2e-4,ry=function(){function n(){this.clipSpaceNearZ=vs.NEGATIVE_ONE,this.eventEmitter=new et,this.matrix=Q(),this.right=T.al(1,0,0),this.up=T.al(0,1,0),this.forward=T.al(0,0,1),this.position=T.al(0,0,1),this.focalPoint=T.al(0,0,0),this.distanceVector=T.al(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=Q(),this.projectionMatrixInverse=Q(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=we.EXPLORING,this.trackingMode=Pl.DEFAULT,this.projectionMode=Lr.PERSPECTIVE,this.frustum=new KT,this.orthoMatrix=Q()}return n.prototype.isOrtho=function(){return this.projectionMode===Lr.ORTHOGRAPHIC},n.prototype.getProjectionMode=function(){return this.projectionMode},n.prototype.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},n.prototype.getPerspectiveInverse=function(){return this.projectionMatrixInverse},n.prototype.getFrustum=function(){return this.frustum},n.prototype.getPosition=function(){return this.position},n.prototype.getFocalPoint=function(){return this.focalPoint},n.prototype.getDollyingStep=function(){return this.dollyingStep},n.prototype.getNear=function(){return this.near},n.prototype.getFar=function(){return this.far},n.prototype.getZoom=function(){return this.zoom},n.prototype.getOrthoMatrix=function(){return this.orthoMatrix},n.prototype.getView=function(){return this.view},n.prototype.setEnableUpdate=function(e){this.enableUpdate=e},n.prototype.setType=function(e,t){return this.type=e,this.type===we.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===we.TRACKING&&t!==void 0&&this.setTrackingMode(t),this},n.prototype.setProjectionMode=function(e){return this.projectionMode=e,this},n.prototype.setTrackingMode=function(e){if(this.type!==we.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this},n.prototype.setWorldRotation=function(e){return this.rotateWorld=e,this._getAngles(),this},n.prototype.getViewTransform=function(){return Wt(Q(),this.matrix)},n.prototype.getWorldTransform=function(){return this.matrix},n.prototype.jitterProjectionMatrix=function(e,t){var r=ce(Q(),[e,t,0]);this.jitteredProjectionMatrix=Ut(Q(),r,this.projectionMatrix)},n.prototype.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},n.prototype.setMatrix=function(e){return this.matrix=e,this._update(),this},n.prototype.setProjectionMatrix=function(e){this.projectionMatrix=e},n.prototype.setFov=function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this},n.prototype.setAspect=function(e){return this.setPerspective(this.near,this.far,this.fov,e),this},n.prototype.setNear=function(e){return this.projectionMode===Lr.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this},n.prototype.setFar=function(e){return this.projectionMode===Lr.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this},n.prototype.setViewOffset=function(e,t,r,i,a,o){return this.aspect=e/t,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.projectionMode===Lr.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},n.prototype.clearViewOffset=function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Lr.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},n.prototype.setZoom=function(e){return this.zoom=e,this.projectionMode===Lr.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Lr.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},n.prototype.setZoomByViewportPoint=function(e,t){var r=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),i=r.x,a=r.y,o=this.roll;this.rotate(0,0,-o),this.setPosition(i,a),this.setFocalPoint(i,a),this.setZoom(e),this.rotate(0,0,o);var s=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),l=s.x,c=s.y,u=T.al(l-i,c-a,0),h=T.AK(u,this.right)/T.kE(this.right),f=T.AK(u,this.up)/T.kE(this.up),d=C(this.getPosition(),2),p=d[0],v=d[1],g=C(this.getFocalPoint(),2),m=g[0],x=g[1];return this.setPosition(p-h,v-f),this.setFocalPoint(m-h,x-f),this},n.prototype.setPerspective=function(e,t,r,i){var a;this.projectionMode=Lr.PERSPECTIVE,this.fov=r,this.near=e,this.far=t,this.aspect=i;var o=this.near*Math.tan(Oe(.5*this.fov))/this.zoom,s=2*o,l=this.aspect*s,c=-.5*l;if(!((a=this.view)===null||a===void 0)&&a.enabled){var u=this.view.fullWidth,h=this.view.fullHeight;c+=this.view.offsetX*l/u,o-=this.view.offsetY*s/h,l*=this.view.width/u,s*=this.view.height/h}return HT(this.projectionMatrix,c,c+l,o-s,o,e,this.far,this.clipSpaceNearZ===vs.ZERO),Wt(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},n.prototype.setOrthographic=function(e,t,r,i,a,o){var s;this.projectionMode=Lr.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=r,this.bottom=i,this.near=a,this.far=o;var l=(this.rright-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,f=u-l,d=u+l,p=h+c,v=h-c;if(!((s=this.view)===null||s===void 0)&&s.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;f+=g*this.view.offsetX,d=f+g*this.view.width,p-=m*this.view.offsetY,v=p-m*this.view.height}return this.clipSpaceNearZ===vs.NEGATIVE_ONE?Uc(this.projectionMatrix,f,d,p,v,a,o):Vc(this.projectionMatrix,f,d,p,v,a,o),Wt(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},n.prototype.setPosition=function(e,t,r){t===void 0&&(t=this.position[1]),r===void 0&&(r=this.position[2]);var i=br(e,t,r);return this._setPosition(i),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},n.prototype.setFocalPoint=function(e,t,r){t===void 0&&(t=this.focalPoint[1]),r===void 0&&(r=this.focalPoint[2]);var i=T.al(0,1,0);if(this.focalPoint=br(e,t,r),this.trackingMode===Pl.CINEMATIC){var a=T.$X(T.Ue(),this.focalPoint,this.position);e=a[0],t=a[1],r=a[2];var o=T.kE(a),s=wi(Math.asin(t/o)),l=90+wi(Math.atan2(r,e)),c=Q();vr(c,c,Oe(l)),Ar(c,c,Oe(s)),i=T.fF(T.Ue(),[0,1,0],c)}return Wt(this.matrix,Hc(Q(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},n.prototype.getDistance=function(){return this.distance},n.prototype.getDistanceVector=function(){return this.distanceVector},n.prototype.setDistance=function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<ny&&(this.distance=ny),this.dollyingStep=this.distance/100;var t=T.Ue();e=this.distance;var r=this.forward,i=this.focalPoint;return t[0]=e*r[0]+i[0],t[1]=e*r[1]+i[1],t[2]=e*r[2]+i[2],this._setPosition(t),this.triggerUpdate(),this},n.prototype.setMaxDistance=function(e){return this.maxDistance=e,this},n.prototype.setMinDistance=function(e){return this.minDistance=e,this},n.prototype.setAzimuth=function(e){return this.azimuth=ms(e),this.computeMatrix(),this._getAxes(),this.type===we.ORBITING||this.type===we.EXPLORING?this._getPosition():this.type===we.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getAzimuth=function(){return this.azimuth},n.prototype.setElevation=function(e){return this.elevation=ms(e),this.computeMatrix(),this._getAxes(),this.type===we.ORBITING||this.type===we.EXPLORING?this._getPosition():this.type===we.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getElevation=function(){return this.elevation},n.prototype.setRoll=function(e){return this.roll=ms(e),this.computeMatrix(),this._getAxes(),this.type===we.ORBITING||this.type===we.EXPLORING?this._getPosition():this.type===we.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getRoll=function(){return this.roll},n.prototype._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},n.prototype.computeMatrix=function(){var e=Bn(Vt(),[0,0,1],Oe(this.roll));Xt(this.matrix);var t=Bn(Vt(),[1,0,0],Oe((this.rotateWorld&&this.type!==we.TRACKING||this.type===we.TRACKING?1:-1)*this.elevation)),r=Bn(Vt(),[0,1,0],Oe((this.rotateWorld&&this.type!==we.TRACKING||this.type===we.TRACKING?1:-1)*this.azimuth)),i=Ln(Vt(),r,t);i=Ln(Vt(),i,e);var a=Fa(Q(),i);this.type===we.ORBITING||this.type===we.EXPLORING?(Ee(this.matrix,this.matrix,this.focalPoint),Ut(this.matrix,this.matrix,a),Ee(this.matrix,this.matrix,[0,0,this.distance])):this.type===we.TRACKING&&(Ee(this.matrix,this.matrix,this.position),Ut(this.matrix,this.matrix,a))},n.prototype._setPosition=function(e,t,r){this.position=br(e,t,r);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()},n.prototype._getAxes=function(){T.JG(this.right,br(fn(on(),[1,0,0,0],this.matrix))),T.JG(this.up,br(fn(on(),[0,1,0,0],this.matrix))),T.JG(this.forward,br(fn(on(),[0,0,1,0],this.matrix))),T.Fv(this.right,this.right),T.Fv(this.up,this.up),T.Fv(this.forward,this.forward)},n.prototype._getAngles=function(){var e=this.distanceVector[0],t=this.distanceVector[1],r=this.distanceVector[2],i=T.kE(this.distanceVector);if(i===0){this.elevation=0,this.azimuth=0;return}this.type===we.TRACKING?(this.elevation=wi(Math.asin(t/i)),this.azimuth=wi(Math.atan2(-e,-r))):this.rotateWorld?(this.elevation=wi(Math.asin(t/i)),this.azimuth=wi(Math.atan2(-e,-r))):(this.elevation=-wi(Math.asin(t/i)),this.azimuth=-wi(Math.atan2(-e,-r)))},n.prototype._getPosition=function(){T.JG(this.position,br(fn(on(),[0,0,0,1],this.matrix))),this._getDistance()},n.prototype._getFocalPoint=function(){T.kK(this.distanceVector,[0,0,-this.distance],Qi.xO(Qi.Ue(),this.matrix)),T.IH(this.focalPoint,this.position,this.distanceVector),this._getDistance()},n.prototype._getDistance=function(){this.distanceVector=T.$X(T.Ue(),this.focalPoint,this.position),this.distance=T.kE(this.distanceVector),this.dollyingStep=this.distance/100},n.prototype._getOrthoMatrix=function(){if(this.projectionMode===Lr.ORTHOGRAPHIC){var e=this.position,t=Bn(Vt(),[0,0,1],-this.roll*Math.PI/180);mr(this.orthoMatrix,t,T.al((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),T.al(this.zoom,this.zoom,1),e)}},n.prototype.triggerUpdate=function(){if(this.enableUpdate){var e=this.getViewTransform(),t=Ut(Q(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(t),this.eventEmitter.emit(ey.UPDATED)}},n.prototype.rotate=function(e,t,r){throw new Error(Ne)},n.prototype.pan=function(e,t){throw new Error(Ne)},n.prototype.dolly=function(e){throw new Error(Ne)},n.prototype.createLandmark=function(e,t){throw new Error(Ne)},n.prototype.gotoLandmark=function(e,t){throw new Error(Ne)},n.prototype.cancelLandmarkAnimation=function(){throw new Error(Ne)},n}();function Xn(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var t=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=e?e.apply(this,r):r[0],o=t.cache;if(o.has(a))return o.get(a);var s=n.apply(this,r);return t.cache=o.set(a,s)||o,s};return t.cache=new(Xn.Cache||Map),t}Xn.Cache=Map;var yt;(function(n){n[n.kUnknown=0]="kUnknown",n[n.kNumber=1]="kNumber",n[n.kPercentage=2]="kPercentage",n[n.kEms=3]="kEms",n[n.kPixels=4]="kPixels",n[n.kRems=5]="kRems",n[n.kDegrees=6]="kDegrees",n[n.kRadians=7]="kRadians",n[n.kGradians=8]="kGradians",n[n.kTurns=9]="kTurns",n[n.kMilliseconds=10]="kMilliseconds",n[n.kSeconds=11]="kSeconds",n[n.kInteger=12]="kInteger"})(yt||(yt={}));var ni;(function(n){n[n.kUNumber=0]="kUNumber",n[n.kUPercent=1]="kUPercent",n[n.kULength=2]="kULength",n[n.kUAngle=3]="kUAngle",n[n.kUTime=4]="kUTime",n[n.kUOther=5]="kUOther"})(ni||(ni={}));var iy;(function(n){n[n.kAll=0]="kAll",n[n.kNonNegative=1]="kNonNegative",n[n.kInteger=2]="kInteger",n[n.kNonNegativeInteger=3]="kNonNegativeInteger",n[n.kPositiveInteger=4]="kPositiveInteger"})(iy||(iy={}));var Nd;(function(n){n[n.kYes=0]="kYes",n[n.kNo=1]="kNo"})(Nd||(Nd={}));var Rd;(function(n){n[n.kYes=0]="kYes",n[n.kNo=1]="kNo"})(Rd||(Rd={}));var qT=[{name:"em",unit_type:yt.kEms},{name:"px",unit_type:yt.kPixels},{name:"deg",unit_type:yt.kDegrees},{name:"rad",unit_type:yt.kRadians},{name:"grad",unit_type:yt.kGradians},{name:"ms",unit_type:yt.kMilliseconds},{name:"s",unit_type:yt.kSeconds},{name:"rem",unit_type:yt.kRems},{name:"turn",unit_type:yt.kTurns}],Va;(function(n){n[n.kUnknownType=0]="kUnknownType",n[n.kUnparsedType=1]="kUnparsedType",n[n.kKeywordType=2]="kKeywordType",n[n.kUnitType=3]="kUnitType",n[n.kSumType=4]="kSumType",n[n.kProductType=5]="kProductType",n[n.kNegateType=6]="kNegateType",n[n.kInvertType=7]="kInvertType",n[n.kMinType=8]="kMinType",n[n.kMaxType=9]="kMaxType",n[n.kClampType=10]="kClampType",n[n.kTransformType=11]="kTransformType",n[n.kPositionType=12]="kPositionType",n[n.kURLImageType=13]="kURLImageType",n[n.kColorType=14]="kColorType",n[n.kUnsupportedColorType=15]="kUnsupportedColorType"})(Va||(Va={}));var JT=function(n){return qT.find(function(e){return e.name===n}).unit_type},QT=function(n){return n?n==="number"?yt.kNumber:n==="percent"||n==="%"?yt.kPercentage:JT(n):yt.kUnknown},tP=function(n){switch(n){case yt.kNumber:case yt.kInteger:return ni.kUNumber;case yt.kPercentage:return ni.kUPercent;case yt.kPixels:return ni.kULength;case yt.kMilliseconds:case yt.kSeconds:return ni.kUTime;case yt.kDegrees:case yt.kRadians:case yt.kGradians:case yt.kTurns:return ni.kUAngle;default:return ni.kUOther}},eP=function(n){switch(n){case ni.kUNumber:return yt.kNumber;case ni.kULength:return yt.kPixels;case ni.kUPercent:return yt.kPercentage;case ni.kUTime:return yt.kSeconds;case ni.kUAngle:return yt.kDegrees;default:return yt.kUnknown}},ay=function(n){var e=1;switch(n){case yt.kPixels:case yt.kDegrees:case yt.kSeconds:break;case yt.kMilliseconds:e=.001;break;case yt.kRadians:e=180/Math.PI;break;case yt.kGradians:e=.9;break;case yt.kTurns:e=360;break}return e},kd=function(n){switch(n){case yt.kNumber:case yt.kInteger:return"";case yt.kPercentage:return"%";case yt.kEms:return"em";case yt.kRems:return"rem";case yt.kPixels:return"px";case yt.kDegrees:return"deg";case yt.kRadians:return"rad";case yt.kGradians:return"grad";case yt.kMilliseconds:return"ms";case yt.kSeconds:return"s";case yt.kTurns:return"turn"}return""},Qc=function(){function n(){}return n.isAngle=function(e){return e===yt.kDegrees||e===yt.kRadians||e===yt.kGradians||e===yt.kTurns},n.isLength=function(e){return e>=yt.kEms&&e<yt.kDegrees},n.isRelativeUnit=function(e){return e===yt.kPercentage||e===yt.kEms||e===yt.kRems},n.isTime=function(e){return e===yt.kSeconds||e===yt.kMilliseconds},n.prototype.toString=function(){return this.buildCSSText(Nd.kNo,Rd.kNo,"")},n.prototype.isNumericValue=function(){return this.getType()>=Va.kUnitType&&this.getType()<=Va.kClampType},n}(),nP=function(n){B(e,n);function e(t){var r=n.call(this)||this;return r.colorSpace=t,r}return e.prototype.getType=function(){return Va.kColorType},e.prototype.to=function(t){return this},e}(Qc),ea;(function(n){n[n.Constant=0]="Constant",n[n.LinearGradient=1]="LinearGradient",n[n.RadialGradient=2]="RadialGradient"})(ea||(ea={}));var tu=function(n){B(e,n);function e(t,r){var i=n.call(this)||this;return i.type=t,i.value=r,i}return e.prototype.clone=function(){return new e(this.type,this.value)},e.prototype.buildCSSText=function(t,r,i){return i},e.prototype.getType=function(){return Va.kColorType},e}(Qc),Ir=function(n){B(e,n);function e(t){var r=n.call(this)||this;return r.value=t,r}return e.prototype.clone=function(){return new e(this.value)},e.prototype.getType=function(){return Va.kKeywordType},e.prototype.buildCSSText=function(t,r,i){return i+this.value},e}(Qc),rP=Xn(function(n){return n===void 0&&(n=""),n.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})}),oy=function(n){return n.split("").map(function(e,t){return e.toUpperCase()===e?"".concat(t!==0?"-":"").concat(e.toLowerCase()):e}).join("")};function iP(n){if(!n)throw new Error}function xs(n){return typeof n=="function"}function aP(n){return typeof n=="symbol"}var JW=function(n){return Object.fromEntries(Object.entries(n).filter(function(e){var t=__read(e,2),r=t[1];return r!==void 0}))},oP={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign"},src:{alias:"img"}},Ld=Xn(function(n){var e=rP(n),t=oP[e];return e=(t==null?void 0:t.alias)||e,e}),sP=function(n,e){e===void 0&&(e="");var t="";return Number.isFinite(n)?(iP(Number.isNaN(n)),t="NaN"):n>0?t="infinity":t="-infinity",t+=e},Id=function(n){return eP(tP(n))},Re=function(n){B(e,n);function e(t,r){r===void 0&&(r=yt.kNumber);var i=n.call(this)||this,a;return typeof r=="string"?a=QT(r):a=r,i.unit=a,i.value=t,i}return e.prototype.clone=function(){return new e(this.value,this.unit)},e.prototype.equals=function(t){var r=t;return this.value===r.value&&this.unit===r.unit},e.prototype.getType=function(){return Va.kUnitType},e.prototype.convertTo=function(t){if(this.unit===t)return new e(this.value,this.unit);var r=Id(this.unit);if(r!==Id(t)||r===yt.kUnknown)return null;var i=ay(this.unit)/ay(t);return new e(this.value*i,t)},e.prototype.buildCSSText=function(t,r,i){var a;switch(this.unit){case yt.kUnknown:break;case yt.kInteger:a=Number(this.value).toFixed(0);break;case yt.kNumber:case yt.kPercentage:case yt.kEms:case yt.kRems:case yt.kPixels:case yt.kDegrees:case yt.kRadians:case yt.kGradians:case yt.kMilliseconds:case yt.kSeconds:case yt.kTurns:{var o=-999999,s=999999,l=this.value,c=kd(this.unit);if(l<o||l>s){var u=kd(this.unit);!Number.isFinite(l)||Number.isNaN(l)?a=sP(l,u):a=l+(u||"")}else a="".concat(l).concat(c)}}return i+=a,i},e}(Qc),En=new Re(0,"px");new Re(1,"px");var _i=new Re(0,"deg"),Dd=function(n){B(e,n);function e(t,r,i,a,o){a===void 0&&(a=1),o===void 0&&(o=!1);var s=n.call(this,"rgb")||this;return s.r=t,s.g=r,s.b=i,s.alpha=a,s.isNone=o,s}return e.prototype.clone=function(){return new e(this.r,this.g,this.b,this.alpha)},e.prototype.buildCSSText=function(t,r,i){return i+"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")},e}(nP),$e=new Ir("unset"),lP=new Ir("initial"),cP=new Ir("inherit"),Bd={"":$e,unset:$e,initial:lP,inherit:cP},Fd=function(n){return Bd[n]||(Bd[n]=new Ir(n)),Bd[n]},eu=new Dd(0,0,0,0,!0),sy=new Dd(0,0,0,0),uP=Xn(function(n,e,t,r){return new Dd(n,e,t,r)},function(n,e,t,r){return"rgba(".concat(n,",").concat(e,",").concat(t,",").concat(r,")")}),Ge=function(n,e){return e===void 0&&(e=yt.kNumber),new Re(n,e)};new Re(50,"%");var Gd;(function(n){n[n.Standard=0]="Standard"})(Gd||(Gd={}));var bs;(function(n){n[n.ADDED=0]="ADDED",n[n.REMOVED=1]="REMOVED",n[n.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED"})(bs||(bs={}));var ly={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Ua(0,0,0,0)},Et;(function(n){n.COORDINATE="<coordinate>",n.COLOR="<color>",n.PAINT="<paint>",n.NUMBER="<number>",n.ANGLE="<angle>",n.OPACITY_VALUE="<opacity-value>",n.SHADOW_BLUR="<shadow-blur>",n.LENGTH="<length>",n.PERCENTAGE="<percentage>",n.LENGTH_PERCENTAGE="<length> | <percentage>",n.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",n.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",n.LIST_OF_POINTS="<list-of-points>",n.PATH="<path>",n.FILTER="<filter>",n.Z_INDEX="<z-index>",n.OFFSET_DISTANCE="<offset-distance>",n.DEFINED_PATH="<defined-path>",n.MARKER="<marker>",n.TRANSFORM="<transform>",n.TRANSFORM_ORIGIN="<transform-origin>",n.TEXT="<text>",n.TEXT_TRANSFORM="<text-transform>"})(Et||(Et={}));function hP(n){var e=n.type,t=n.value;return e==="hex"?"#".concat(t):e==="literal"?t:e==="rgb"?"rgb(".concat(t.join(","),")"):"rgba(".concat(t.join(","),")")}var fP=function(){var n={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function t(I){throw new Error(e+": "+I)}function r(){var I=i();return e.length>0&&t("Invalid input not EOF"),I}function i(){return _(a)}function a(){return o("linear-gradient",n.linearGradient,l)||o("repeating-linear-gradient",n.repeatingLinearGradient,l)||o("radial-gradient",n.radialGradient,h)||o("repeating-radial-gradient",n.repeatingRadialGradient,h)||o("conic-gradient",n.conicGradient,h)}function o(I,Z,J){return s(Z,function(mt){var It=J();return It&&(z(n.comma)||t("Missing comma before color stops")),{type:I,orientation:It,colorStops:_(S)}})}function s(I,Z){var J=z(I);if(J){z(n.startCall)||t("Missing (");var mt=Z(J);return z(n.endCall)||t("Missing )"),mt}}function l(){return c()||u()}function c(){return L("directional",n.sideOrCorner,1)}function u(){return L("angular",n.angleValue,1)}function h(){var I,Z=f(),J;return Z&&(I=[],I.push(Z),J=e,z(n.comma)&&(Z=f(),Z?I.push(Z):e=J)),I}function f(){var I=d()||p();if(I)I.at=g();else{var Z=v();if(Z){I=Z;var J=g();J&&(I.at=J)}else{var mt=m();mt&&(I={type:"default-radial",at:mt})}}return I}function d(){var I=L("shape",/^(circle)/i,0);return I&&(I.style=R()||v()),I}function p(){var I=L("shape",/^(ellipse)/i,0);return I&&(I.style=A()||v()),I}function v(){return L("extent-keyword",n.extentKeywords,1)}function g(){if(L("position",/^at/,0)){var I=m();return I||t("Missing positioning value"),I}}function m(){var I=x();if(I.x||I.y)return{type:"position",value:I}}function x(){return{x:A(),y:A()}}function _(I){var Z=I(),J=[];if(Z)for(J.push(Z);z(n.comma);)Z=I(),Z?J.push(Z):t("One extra comma");return J}function S(){var I=b();return I||t("Expected color definition"),I.length=A(),I}function b(){return E()||M()||w()||y()}function y(){return L("literal",n.literalColor,0)}function E(){return L("hex",n.hexColor,1)}function w(){return s(n.rgbColor,function(){return{type:"rgb",value:_(P)}})}function M(){return s(n.rgbaColor,function(){return{type:"rgba",value:_(P)}})}function P(){return z(n.number)[1]}function A(){return L("%",n.percentageValue,1)||O()||R()}function O(){return L("position-keyword",n.positionKeywords,1)}function R(){return L("px",n.pixelValue,1)||L("em",n.emValue,1)}function L(I,Z,J){var mt=z(Z);if(mt)return{type:I,value:mt[J]}}function z(I){var Z=/^[\n\r\t\s]+/.exec(e);Z&&Y(Z[0].length);var J=I.exec(e);return J&&Y(J[0].length),J}function Y(I){e=e.substring(I)}return function(I){return e=I,r()}}();function dP(n,e,t,r){var i=Oe(r.value),a=0,o=0,s=a+e/2,l=o+t/2,c=Math.abs(e*Math.cos(i))+Math.abs(t*Math.sin(i)),u=n[0]+s-Math.cos(i)*c/2,h=n[1]+l-Math.sin(i)*c/2,f=n[0]+s+Math.cos(i)*c/2,d=n[1]+l+Math.sin(i)*c/2;return{x1:u,y1:h,x2:f,y2:d}}function pP(n,e,t,r,i,a){var o=r.value,s=i.value;r.unit===yt.kPercentage&&(o=r.value/100*e),i.unit===yt.kPercentage&&(s=i.value/100*t);var l=Math.max(Nr([0,0],[o,s]),Nr([0,t],[o,s]),Nr([e,t],[o,s]),Nr([e,0],[o,s]));return a&&(a instanceof Re?l=a.value:a instanceof Ir&&(a.value==="closest-side"?l=Math.min(o,e-o,s,t-s):a.value==="farthest-side"?l=Math.max(o,e-o,s,t-s):a.value==="closest-corner"&&(l=Math.min(Nr([0,0],[o,s]),Nr([0,t],[o,s]),Nr([e,t],[o,s]),Nr([e,0],[o,s]))))),{x:o+n[0],y:s+n[1],r:l}}var vP=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,gP=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,mP=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,cy=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function yP(n){var e,t,r,i=n.length;n[i-1].length=(e=n[i-1].length)!==null&&e!==void 0?e:{type:"%",value:"100"},i>1&&(n[0].length=(t=n[0].length)!==null&&t!==void 0?t:{type:"%",value:"0"});for(var a=0,o=Number(n[0].length.value),s=1;s<i;s++){var l=(r=n[s].length)===null||r===void 0?void 0:r.value;if(!Mt(l)&&!Mt(o)){for(var c=1;c<s-a;c++)n[a+c].length={type:"%",value:"".concat(o+(Number(l)-o)*c/(s-a))};a=s,o=Number(l)}}}var xP={left:270-90,top:0-90,bottom:180-90,right:90-90,"left top":315-90,"top left":315-90,"left bottom":225-90,"bottom left":225-90,"right top":45-90,"top right":45-90,"right bottom":135-90,"bottom right":135-90},bP=Xn(function(n){var e;return n.type==="angular"?e=Number(n.value):e=xP[n.value]||0,Ge(e,"deg")}),EP=Xn(function(n){var e=50,t=50,r="%",i="%";if((n==null?void 0:n.type)==="position"){var a=n.value,o=a.x,s=a.y;(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?e=0:o.value==="center"?e=50:o.value==="right"?e=100:o.value==="top"?t=0:o.value==="bottom"&&(t=100)),(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?e=0:s.value==="center"?t=50:s.value==="right"?e=100:s.value==="top"?t=0:s.value==="bottom"&&(t=100)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(r=o==null?void 0:o.type,e=Number(o.value)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(i=s==null?void 0:s.type,t=Number(s.value))}return{cx:Ge(e,r),cy:Ge(t,i)}}),wP=Xn(function(n){var e;if(n.indexOf("linear")>-1||n.indexOf("radial")>-1){var t=fP(n);return t.map(function(s){var l=s.type,c=s.orientation,u=s.colorStops;yP(u);var h=u.map(function(_){return{offset:Ge(Number(_.length.value),"%"),color:hP(_)}});if(l==="linear-gradient")return new tu(ea.LinearGradient,{angle:c?bP(c):_i,steps:h});if(l==="radial-gradient"&&(c||(c=[{type:"shape",value:"circle"}]),c[0].type==="shape"&&c[0].value==="circle")){var f=EP(c[0].at),d=f.cx,p=f.cy,v=void 0;if(c[0].style){var g=c[0].style,m=g.type,x=g.value;m==="extent-keyword"?v=Fd(x):v=Ge(x,m)}return new tu(ea.RadialGradient,{cx:d,cy:p,size:v,steps:h})}})}var r=n[0];if(n[1]==="("||n[2]==="("){if(r==="l"){var i=vP.exec(n);if(i){var a=((e=i[2].match(cy))===null||e===void 0?void 0:e.map(function(s){return s.split(":")}))||[];return[new tu(ea.LinearGradient,{angle:Ge(parseFloat(i[1]),"deg"),steps:a.map(function(s){var l=C(s,2),c=l[0],u=l[1];return{offset:Ge(Number(c)*100,"%"),color:u}})})]}}else if(r==="r"){var o=_P(n);if(o)if(ue(o))n=o;else return[new tu(ea.RadialGradient,o)]}else if(r==="p")return SP(n)}});function _P(n){var e,t=gP.exec(n);if(t){var r=((e=t[4].match(cy))===null||e===void 0?void 0:e.map(function(i){return i.split(":")}))||[];return{cx:Ge(50,"%"),cy:Ge(50,"%"),steps:r.map(function(i){var a=C(i,2),o=a[0],s=a[1];return{offset:Ge(Number(o)*100,"%"),color:s}})}}return null}function SP(n){var e=mP.exec(n);if(e){var t=e[1],r=e[2];switch(t){case"a":t="repeat";break;case"x":t="repeat-x";break;case"y":t="repeat-y";break;case"n":t="no-repeat";break;default:t="no-repeat"}return{image:r,repetition:t}}return null}function QW(n){return!!n.type&&!!n.value}function zd(n){return n&&!!n.image}function uy(n){return n&&!Mt(n.r)&&!Mt(n.g)&&!Mt(n.b)}var Es=Xn(function(n){if(zd(n))return N({repetition:"repeat"},n);if(Mt(n)&&(n=""),n==="transparent")return sy;if(n==="currentColor")n="black";else if(n==="none")return eu;var e=wP(n);if(e)return e;var t=md.ZP(n),r=[0,0,0,0];return t!==null&&(r[0]=t.r||0,r[1]=t.g||0,r[2]=t.b||0,r[3]=t.opacity),uP.apply(void 0,K([],C(r),!1))});function TP(n,e){if(!(!uy(n)||!uy(e)))return[[Number(n.r),Number(n.g),Number(n.b),Number(n.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var r=t.slice();if(r[3])for(var i=0;i<3;i++)r[i]=Math.round(me(r[i],0,255));return r[3]=me(r[3],0,1),"rgba(".concat(r.join(","),")")}]}function Ml(n,e){if(Mt(e))return Ge(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(n)>=0)return Ge(Number(e),"px");if("deg".search(n)>=0)return Ge(Number(e),"deg")}var t=[];e=e.replace(n,function(i){return t.push(i),"U"+i});var r="U("+n.source+")";return t.map(function(i){return Ge(Number(e.replace(new RegExp("U"+i,"g"),"").replace(new RegExp(r,"g"),"*0")),i)})[0]}var hy=function(n){return Ml(new RegExp("px","g"),n)},PP=Xn(hy),MP=function(n){return Ml(new RegExp("%","g"),n)};Xn(MP);var Cl=function(n){return fe(n)||isFinite(Number(n))?Ge(Number(n)||0,"px"):Ml(new RegExp("px|%|em|rem","g"),n)},ws=Xn(Cl),Wd=function(n){return Ml(new RegExp("deg|rad|grad|turn","g"),n)},fy=Xn(Wd);function CP(n,e,t,r,i){i===void 0&&(i=0);var a="",o=n.value||0,s=e.value||0,l=Id(n.unit),c=n.convertTo(l),u=e.convertTo(l);return c&&u?(o=c.value,s=u.value,a=kd(n.unit)):(Re.isLength(n.unit)||Re.isLength(e.unit))&&(o=ri(n,i,t),s=ri(e,i,t),a="px"),[o,s,function(h){return r&&(h=Math.max(h,0)),h+a}]}function Dr(n){var e=0;return n.unit===yt.kDegrees?e=n.value:n.unit===yt.kRadians?e=wi(Number(n.value)):n.unit===yt.kTurns&&(e=zT(Number(n.value))),e}function dy(n,e){var t;return Array.isArray(n)?t=n.map(function(r){return Number(r)}):ue(n)?t=n.split(" ").map(function(r){return Number(r)}):fe(n)&&(t=[n]),e===2?t.length===1?[t[0],t[0]]:[t[0],t[1]]:t.length===1?[t[0],t[0],t[0],t[0]]:t.length===2?[t[0],t[1],t[0],t[1]]:t.length===3?[t[0],t[1],t[2],t[1]]:[t[0],t[1],t[2],t[3]]}function py(n){return ue(n)?n.split(" ").map(function(e){return ws(e)}):n.map(function(e){return ws(e.toString())})}function ri(n,e,t,r){if(r===void 0&&(r=!1),n.unit===yt.kPixels)return Number(n.value);if(n.unit===yt.kPercentage&&t){var i=t.nodeName===ct.GROUP?t.getLocalBounds():t.getGeometryBounds();return(r?i.min[e]:0)+n.value/100*i.halfExtents[e]*2}return 0}var AP=function(n){return Ml(/deg|rad|grad|turn|px|%/g,n)},OP=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function vy(n){if(n===void 0&&(n=""),n=n.toLowerCase().trim(),n==="none")return[];for(var e=/\s*([\w-]+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];if(i=r.index+r[0].length,OP.indexOf(r[1])>-1&&t.push({name:r[1],params:r[2].split(" ").map(function(a){return AP(a)||Es(a)})}),e.lastIndex===n.length)return t}return[]}function gy(n){return n.toString()}var _s=function(n){return typeof n=="number"?Ge(n):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(n)?Ge(Number(n)):Ge(0)},No=Xn(_s);Xn(function(n){return ue(n)?n.split(" ").map(No):n.map(No)});function Ud(n,e){return[n,e,gy]}function Vd(n,e){return function(t,r){return[t,r,function(i){return gy(me(i,n,e))}]}}function my(n,e){if(n.length===e.length)return[n,e,function(t){return t}]}function Hd(n){return n.parsedStyle.d.totalLength===0&&(n.parsedStyle.d.totalLength=Am(n.parsedStyle.d.absolutePath)),n.parsedStyle.d.totalLength}function NP(n){return n.parsedStyle.points.totalLength===0&&(n.parsedStyle.points.totalLength=Td(n.parsedStyle.points.points)),n.parsedStyle.points.totalLength}function RP(n){for(var e=0;e<n.length;e++){var t=n[e-1],r=n[e],i=r[0];if(i==="M"&&t){var a=t[0],o=[r[1],r[2]],s=void 0;a==="L"||a==="M"?s=[t[1],t[2]]:(a==="C"||a==="A"||a==="Q")&&(s=[t[t.length-2],t[t.length-1]]),s&&nu(o,s)&&(n.splice(e,1),e--)}}}function kP(n){for(var e=!1,t=n.length,r=0;r<t;r++){var i=n[r],a=i[0];if(a==="C"||a==="A"||a==="Q"){e=!0;break}}return e}function LP(n){for(var e=[],t=[],r=[],i=0;i<n.length;i++){var a=n[i],o=a[0];o==="M"?(r.length&&(t.push(r),r=[]),r.push([a[1],a[2]])):o==="Z"?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]])}return r.length>0&&t.push(r),{polygons:e,polylines:t}}function nu(n,e){return n[0]===e[0]&&n[1]===e[1]}function IP(n,e){for(var t=[],r=[],i=[],a=0;a<n.length;a++){var o=n[a],s=o.currentPoint,l=o.params,c=o.prePoint,u=void 0;switch(o.command){case"Q":u=Md(c[0],c[1],l[1],l[2],l[3],l[4]);break;case"C":u=Sd(c[0],c[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;u=wd(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:t.push(s[0]),r.push(s[1]);break}u&&(o.box=u,t.push(u.x,u.x+u.width),r.push(u.y,u.y+u.height)),e&&(o.command==="L"||o.command==="M")&&o.prePoint&&o.nextPoint&&i.push(o)}t=t.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0}),r=r.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0});var f=us(t),d=us(r),p=hs(t),v=hs(r);if(i.length===0)return{x:f,y:d,width:p-f,height:v-d};for(var a=0;a<i.length;a++){var o=i[a],s=o.currentPoint,g=void 0;s[0]===f?(g=ru(o,e),f=f-g.xExtra):s[0]===p&&(g=ru(o,e),p=p+g.xExtra),s[1]===d?(g=ru(o,e),d=d-g.yExtra):s[1]===v&&(g=ru(o,e),v=v+g.yExtra)}return{x:f,y:d,width:p-f,height:v-d}}function ru(n,e){var t=n.prePoint,r=n.currentPoint,i=n.nextPoint,a=Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2),l=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!l||Math.sin(l)===0||fs(l,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));c=c>Math.PI/2?Math.PI-c:c,u=u>Math.PI/2?Math.PI-u:u;var h={xExtra:Math.cos(l/2-c)*(e/2*(1/Math.sin(l/2)))-e/2||0,yExtra:Math.cos(u-l/2)*(e/2*(1/Math.sin(l/2)))-e/2||0};return h}function yy(n,e){return[e[0]+(e[0]-n[0]),e[1]+(e[1]-n[1])]}var xy=function(n,e){var t=n.x*e.x+n.y*e.y,r=Math.sqrt((Math.pow(n.x,2)+Math.pow(n.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2))),i=n.x*e.y-n.y*e.x<0?-1:1,a=i*Math.acos(t/r);return a},by=function(n,e,t,r,i,a,o,s){e=Math.abs(e),t=Math.abs(t),r=jc(r,360);var l=Oe(r);if(n.x===o.x&&n.y===o.y)return{x:n.x,y:n.y,ellipticalArcAngle:0};if(e===0||t===0)return{x:0,y:0,ellipticalArcAngle:0};var c=(n.x-o.x)/2,u=(n.y-o.y)/2,h={x:Math.cos(l)*c+Math.sin(l)*u,y:-Math.sin(l)*c+Math.cos(l)*u},f=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(t,2);f>1&&(e=Math.sqrt(f)*e,t=Math.sqrt(f)*t);var d=Math.pow(e,2)*Math.pow(t,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(t,2)*Math.pow(h.x,2),p=Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(t,2)*Math.pow(h.x,2),v=d/p;v=v<0?0:v;var g=(i!==a?1:-1)*Math.sqrt(v),m={x:g*(e*h.y/t),y:g*(-(t*h.x)/e)},x={x:Math.cos(l)*m.x-Math.sin(l)*m.y+(n.x+o.x)/2,y:Math.sin(l)*m.x+Math.cos(l)*m.y+(n.y+o.y)/2},_={x:(h.x-m.x)/e,y:(h.y-m.y)/t},S=xy({x:1,y:0},_),b={x:(-h.x-m.x)/e,y:(-h.y-m.y)/t},y=xy(_,b);!a&&y>0?y-=2*Math.PI:a&&y<0&&(y+=2*Math.PI),y%=2*Math.PI;var E=S+y*s,w=e*Math.cos(E),M=t*Math.sin(E),P={x:Math.cos(l)*w-Math.sin(l)*M+x.x,y:Math.sin(l)*w+Math.cos(l)*M+x.y,ellipticalArcStartAngle:S,ellipticalArcEndAngle:S+y,ellipticalArcAngle:E,ellipticalArcCenter:x,resultantRx:e,resultantRy:t};return P};function DP(n){for(var e=[],t=null,r=null,i=null,a=0,o=n.length,s=0;s<o;s++){var l=n[s];r=n[s+1];var c=l[0],u={command:c,prePoint:t,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(c){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=BP(t,l);u.arcParams=h;break}if(c==="Z")t=i,r=n[a+1];else{var f=l.length;t=[l[f-2],l[f-1]]}r&&r[0]==="Z"&&(r=n[a],e[a]&&(e[a].prePoint=t)),u.currentPoint=t,e[a]&&nu(t,e[a].currentPoint)&&(e[a].prePoint=u.prePoint);var d=r?[r[r.length-2],r[r.length-1]]:null;u.nextPoint=d;var p=u.prePoint;if(["L","H","V"].includes(c))u.startTangent=[p[0]-t[0],p[1]-t[1]],u.endTangent=[t[0]-p[0],t[1]-p[1]];else if(c==="Q"){var v=[l[1],l[2]];u.startTangent=[p[0]-v[0],p[1]-v[1]],u.endTangent=[t[0]-v[0],t[1]-v[1]]}else if(c==="T"){var g=e[s-1],v=yy(g.currentPoint,p);g.command==="Q"?(u.command="Q",u.startTangent=[p[0]-v[0],p[1]-v[1]],u.endTangent=[t[0]-v[0],t[1]-v[1]]):(u.command="TL",u.startTangent=[p[0]-t[0],p[1]-t[1]],u.endTangent=[t[0]-p[0],t[1]-p[1]])}else if(c==="C"){var m=[l[1],l[2]],x=[l[3],l[4]];u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]],u.startTangent[0]===0&&u.startTangent[1]===0&&(u.startTangent=[m[0]-x[0],m[1]-x[1]]),u.endTangent[0]===0&&u.endTangent[1]===0&&(u.endTangent=[x[0]-m[0],x[1]-m[1]])}else if(c==="S"){var g=e[s-1],m=yy(g.currentPoint,p),x=[l[1],l[2]];g.command==="C"?(u.command="C",u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]]):(u.command="SQ",u.startTangent=[p[0]-x[0],p[1]-x[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]])}else if(c==="A"){var _=Ey(u,0),S=_.x,b=_.y,y=Ey(u,1,!1),E=y.x,w=y.y;u.startTangent=[S,b],u.endTangent=[E,w]}e.push(u)}return e}function Ey(n,e,t){t===void 0&&(t=!0);var r=n.arcParams,i=r.rx,a=i===void 0?0:i,o=r.ry,s=o===void 0?0:o,l=r.xRotation,c=r.arcFlag,u=r.sweepFlag,h=by({x:n.prePoint[0],y:n.prePoint[1]},a,s,l,!!c,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},e),f=by({x:n.prePoint[0],y:n.prePoint[1]},a,s,l,!!c,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},t?e+.005:e-.005),d=f.x-h.x,p=f.y-h.y,v=Math.sqrt(d*d+p*p);return{x:-d/v,y:-p/v}}function iu(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Yd(n,e){return iu(n)*iu(e)?(n[0]*e[0]+n[1]*e[1])/(iu(n)*iu(e)):1}function wy(n,e){return(n[0]*e[1]<n[1]*e[0]?-1:1)*Math.acos(Yd(n,e))}function BP(n,e){var t=e[1],r=e[2],i=jc(Oe(e[3]),Math.PI*2),a=e[4],o=e[5],s=n[0],l=n[1],c=e[6],u=e[7],h=Math.cos(i)*(s-c)/2+Math.sin(i)*(l-u)/2,f=-1*Math.sin(i)*(s-c)/2+Math.cos(i)*(l-u)/2,d=h*h/(t*t)+f*f/(r*r);d>1&&(t*=Math.sqrt(d),r*=Math.sqrt(d));var p=t*t*(f*f)+r*r*(h*h),v=p?Math.sqrt((t*t*(r*r)-p)/p):1;a===o&&(v*=-1),isNaN(v)&&(v=0);var g=r?v*t*f/r:0,m=t?v*-r*h/t:0,x=(s+c)/2+Math.cos(i)*g-Math.sin(i)*m,_=(l+u)/2+Math.sin(i)*g+Math.cos(i)*m,S=[(h-g)/t,(f-m)/r],b=[(-1*h-g)/t,(-1*f-m)/r],y=wy([1,0],S),E=wy(S,b);return Yd(S,b)<=-1&&(E=Math.PI),Yd(S,b)>=1&&(E=0),o===0&&E>0&&(E=E-2*Math.PI),o===1&&E<0&&(E=E+2*Math.PI),{cx:x,cy:_,rx:nu(n,[c,u])?0:t,ry:nu(n,[c,u])?0:r,startAngle:y,endAngle:y+E,xRotation:i,arcFlag:a,sweepFlag:o}}function FP(n,e,t){return n.reduce(function(r,i){var a="";if(i[0]==="M"||i[0]==="L"){var o=vec3.fromValues(i[1],i[2],0);t&&vec3.transformMat4(o,o,t),a="".concat(i[0]).concat(o[0],",").concat(o[1])}else if(i[0]==="Z")a=i[0];else if(i[0]==="C"){var s=vec3.fromValues(i[1],i[2],0),l=vec3.fromValues(i[3],i[4],0),c=vec3.fromValues(i[5],i[6],0);t&&(vec3.transformMat4(s,s,t),vec3.transformMat4(l,l,t),vec3.transformMat4(c,c,t)),a="".concat(i[0]).concat(s[0],",").concat(s[1],",").concat(l[0],",").concat(l[1],",").concat(c[0],",").concat(c[1])}else if(i[0]==="A"){var u=vec3.fromValues(i[6],i[7],0);t&&vec3.transformMat4(u,u,t),a="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],",").concat(i[5],",").concat(u[0],",").concat(u[1])}else if(i[0]==="Q"){var s=vec3.fromValues(i[1],i[2],0),l=vec3.fromValues(i[3],i[4],0);t&&(vec3.transformMat4(s,s,t),vec3.transformMat4(l,l,t)),a="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],"}")}return r+=a},"")}function GP(n,e,t,r){return[["M",n,e],["L",t,r]]}function _y(n,e,t,r){var i=(-1+Math.sqrt(2))/3*4,a=n*i,o=e*i,s=t-n,l=t+n,c=r-e,u=r+e;return[["M",s,r],["C",s,r-o,t-a,c,t,c],["C",t+a,c,l,r-o,l,r],["C",l,r+o,t+a,u,t,u],["C",t-a,u,s,r+o,s,r],["Z"]]}function zP(n,e){var t=n.map(function(r,i){return[i===0?"M":"L",r[0],r[1]]});return e&&t.push(["Z"]),t}function WP(n,e,t,r,i){if(i){var a=__read(i,4),o=a[0],s=a[1],l=a[2],c=a[3],u=n>0?1:-1,h=e>0?1:-1,f=u+h!==0?1:0;return[["M",u*o+t,r],["L",n-u*s+t,r],s?["A",s,s,0,0,f,n+t,h*s+r]:null,["L",n+t,e-h*l+r],l?["A",l,l,0,0,f,n+t-u*l,e+r]:null,["L",t+u*c,e+r],c?["A",c,c,0,0,f,t,e+r-h*c]:null,["L",t,h*o+r],o?["A",o,o,0,0,f,u*o+t,r]:null,["Z"]].filter(function(d){return d})}return[["M",t,r],["L",t+n,r],["L",t+n,r+e],["L",t,r+e],["Z"]]}function tU(n,e){e===void 0&&(e=n.getLocalTransform());var t=[];switch(n.nodeName){case ct.LINE:var r=n.parsedStyle,i=r.x1,a=i===void 0?0:i,o=r.y1,s=o===void 0?0:o,l=r.x2,c=l===void 0?0:l,u=r.y2,h=u===void 0?0:u;t=GP(a,s,c,h);break;case ct.CIRCLE:{var f=n.parsedStyle,d=f.r,p=d===void 0?0:d,v=f.cx,g=v===void 0?0:v,m=f.cy,x=m===void 0?0:m;t=_y(p,p,g,x);break}case ct.ELLIPSE:{var _=n.parsedStyle,S=_.rx,b=S===void 0?0:S,y=_.ry,E=y===void 0?0:y,w=_.cx,g=w===void 0?0:w,M=_.cy,x=M===void 0?0:M;t=_y(b,E,g,x);break}case ct.POLYLINE:case ct.POLYGON:var P=n.parsedStyle.points;t=zP(P.points,n.nodeName===ct.POLYGON);break;case ct.RECT:var A=n.parsedStyle,O=A.width,R=O===void 0?0:O,L=A.height,z=L===void 0?0:L,Y=A.x,I=Y===void 0?0:Y,Z=A.y,J=Z===void 0?0:Z,mt=A.radius,It=mt&&mt.some(function(ve){return ve!==0});t=WP(R,z,I,J,It&&mt.map(function(ve){return clamp(ve,0,Math.min(Math.abs(R)/2,Math.abs(z)/2))}));break;case ct.PATH:var ae=n.parsedStyle.d.absolutePath;t=__spreadArray([],__read(ae),!1);break}if(t.length)return FP(t,n,e)}function eU(n,e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0);var a=n.map(function(o,s){var l=o[0],c=n[s+1],u=s===0&&(e!==0||t!==0),h=(s===n.length-1||c&&(c[0]==="M"||c[0]==="Z"))&&r!==0&&i!==0;switch(l){case"M":return u?"M ".concat(o[1]+e,",").concat(o[2]+t," L ").concat(o[1],",").concat(o[2]):"M ".concat(o[1],",").concat(o[2]);case"L":return"L ".concat(o[1]+(h?r:0),",").concat(o[2]+(h?i:0));case"Q":return"Q ".concat(o[1]," ").concat(o[2],",").concat(o[3]," ").concat(o[4])+(h?" L ".concat(o[3]+r,",").concat(o[4]+i):"");case"C":return"C ".concat(o[1]," ").concat(o[2],",").concat(o[3]," ").concat(o[4],",").concat(o[5]," ").concat(o[6])+(h?" L ".concat(o[5]+r,",").concat(o[6]+i):"");case"A":return"A ".concat(o[1]," ").concat(o[2]," ").concat(o[3]," ").concat(o[4]," ").concat(o[5]," ").concat(o[6]," ").concat(o[7])+(h?" L ".concat(o[6]+r,",").concat(o[7]+i):"");case"Z":return"Z"}}).join(" ");return~a.indexOf("NaN")?"":a}var Sy=function(n){if(n===""||Array.isArray(n)&&n.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=cs(n)}catch(f){e=cs(""),console.error("[g]: Invalid SVG Path definition: ".concat(n))}RP(e);var t=kP(e),r=LP(e),i=r.polygons,a=r.polylines,o=DP(e),s=IP(o,0),l=s.x,c=s.y,u=s.width,h=s.height;return{absolutePath:e,hasArc:t,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(u)?u:0,height:Number.isFinite(h)?h:0}}},UP=Xn(Sy);function Xd(n){return ue(n)?UP(n):Sy(n)}function VP(n,e,t){var r=n.curve,i=e.curve;(!r||r.length===0)&&(r=wl(n.absolutePath,!1),n.curve=r),(!i||i.length===0)&&(i=wl(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=gd(r,i));var o=Kc(a[0])!==Kc(a[1])?Rm(a[0]):km(a[0]);return[o,Lm(a[1],o),function(s){return s}]}function Ty(n,e){var t;return ue(n)?t=n.split(" ").map(function(r){var i=C(r.split(","),2),a=i[0],o=i[1];return[Number(a),Number(o)]}):t=n,{points:t,totalLength:0,segments:[]}}function HP(n,e){return[n.points,e.points,function(t){return t}]}var pn=null;function Br(n){return function(e){var t=0;return n.map(function(r){return r===pn?e[t++]:r})}}function Ro(n){return n}var au={matrix:["NNNNNN",[pn,pn,0,0,pn,pn,0,0,0,0,1,0,pn,pn,0,1],Ro],matrix3d:["NNNNNNNNNNNNNNNN",Ro],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Br([pn,pn,new Re(1)]),Ro],scalex:["N",Br([pn,new Re(1),new Re(1)]),Br([pn,new Re(1)])],scaley:["N",Br([new Re(1),pn,new Re(1)]),Br([new Re(1),pn])],scalez:["N",Br([new Re(1),new Re(1),pn])],scale3d:["NNN",Ro],skew:["Aa",null,Ro],skewx:["A",null,Br([pn,_i])],skewy:["A",null,Br([_i,pn])],translate:["Tt",Br([pn,pn,En]),Ro],translatex:["T",Br([pn,En,En]),Br([pn,En])],translatey:["T",Br([En,pn,En]),Br([En,pn])],translatez:["L",Br([En,En,pn])],translate3d:["TTL",Ro]};function jd(n){if(n=(n||"none").toLowerCase().trim(),n==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];i=r.index+r[0].length;var a=r[1],o=au[a];if(!o)return[];var s=r[2].split(","),l=o[0];if(l.length<s.length)return[];for(var c=[],u=0;u<l.length;u++){var h=s[u],f=l[u],d=void 0;if(h?d={A:function(p){return p.trim()==="0"?_i:fy(p)},N:No,T:ws,L:PP}[f.toUpperCase()](h):d={a:_i,n:c[0],t:En}[f],d===void 0)return[];c.push(d)}if(t.push({t:a,d:c}),e.lastIndex===n.length)return t}return[]}function Py(n){if(n=(n||"none").toLowerCase().trim(),n==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];i=r.index+r[0].length;var a=r[1],o=au[a];if(!o)return[];var s=r[2].split(","),l=o[0];if(l.length<s.length)return[];for(var c=[],u=0;u<l.length;u++){var h=s[u],f=l[u],d=void 0;if(h?d={A:function(p){return p.trim()==="0"?_i:Wd(p)},N:_s,T:Cl,L:hy}[f.toUpperCase()](h):d={a:_i,n:c[0],t:En}[f],d===void 0)return[];c.push(d)}if(t.push({t:a,d:c}),e.lastIndex===n.length)return t}return[]}function YP(n){var e,t,r,i;switch(n.t){case"rotatex":return i=Oe(Dr(n.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotatey":return i=Oe(Dr(n.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotatez":return i=Oe(Dr(n.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=n.d[0].value,t=n.d[1].value,r=n.d[2].value,i=Oe(Dr(n.d[3]));var a=e*e+t*t+r*r;if(a===0)e=1,t=0,r=0;else if(a!==1){var o=Math.sqrt(a);e/=o,t/=o,r/=o}var s=Math.sin(i/2),l=s*Math.cos(i/2),c=s*s;return[1-2*(t*t+r*r)*c,2*(e*t*c+r*l),2*(e*r*c-t*l),0,2*(e*t*c-r*l),1-2*(e*e+r*r)*c,2*(t*r*c+e*l),0,2*(e*r*c+t*l),2*(t*r*c-e*l),1-2*(e*e+t*t)*c,0,0,0,0,1];case"scale":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scalex":return[n.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,n.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,n.d[0].value,0,0,0,0,1];case"scale3d":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,n.d[2].value,0,0,0,0,1];case"skew":var u=Oe(Dr(n.d[0])),h=Oe(Dr(n.d[1]));return[1,Math.tan(h),0,0,Math.tan(u),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return i=Oe(Dr(n.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return i=Oe(Dr(n.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return e=ri(n.d[0],0,null)||0,t=ri(n.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1];case"translatex":return e=ri(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,0,0,1];case"translatey":return t=ri(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,t,0,1];case"translatez":return r=ri(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r,1];case"translate3d":return e=ri(n.d[0],0,null)||0,t=ri(n.d[1],0,null)||0,r=ri(n.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,r,1];case"perspective":var f=ri(n.d[0],0,null)||0,d=f?-1/f:0;return[1,0,0,0,0,1,0,0,0,0,1,d,0,0,0,1];case"matrix":return[n.d[0].value,n.d[1].value,0,0,n.d[2].value,n.d[3].value,0,0,0,0,1,0,n.d[4].value,n.d[5].value,0,1];case"matrix3d":return n.d.map(function(p){return p.value})}}function XP(n,e){return[n[0]*e[0]+n[4]*e[1]+n[8]*e[2]+n[12]*e[3],n[1]*e[0]+n[5]*e[1]+n[9]*e[2]+n[13]*e[3],n[2]*e[0]+n[6]*e[1]+n[10]*e[2]+n[14]*e[3],n[3]*e[0]+n[7]*e[1]+n[11]*e[2]+n[15]*e[3],n[0]*e[4]+n[4]*e[5]+n[8]*e[6]+n[12]*e[7],n[1]*e[4]+n[5]*e[5]+n[9]*e[6]+n[13]*e[7],n[2]*e[4]+n[6]*e[5]+n[10]*e[6]+n[14]*e[7],n[3]*e[4]+n[7]*e[5]+n[11]*e[6]+n[15]*e[7],n[0]*e[8]+n[4]*e[9]+n[8]*e[10]+n[12]*e[11],n[1]*e[8]+n[5]*e[9]+n[9]*e[10]+n[13]*e[11],n[2]*e[8]+n[6]*e[9]+n[10]*e[10]+n[14]*e[11],n[3]*e[8]+n[7]*e[9]+n[11]*e[10]+n[15]*e[11],n[0]*e[12]+n[4]*e[13]+n[8]*e[14]+n[12]*e[15],n[1]*e[12]+n[5]*e[13]+n[9]*e[14]+n[13]*e[15],n[2]*e[12]+n[6]*e[13]+n[10]*e[14]+n[14]*e[15],n[3]*e[12]+n[7]*e[13]+n[11]*e[14]+n[15]*e[15]]}function jP(n){return n.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:n.map(YP).reduce(XP)}function My(n){var e=[0,0,0],t=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return YT(jP(n),e,t,r,i,a),[[e,t,r,a,i]]}var $P=function(){function n(r,i){for(var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],o=0;o<4;o++)for(var s=0;s<4;s++)for(var l=0;l<4;l++)a[o][s]+=i[o][l]*r[l][s];return a}function e(r){return r[0][2]==0&&r[0][3]==0&&r[1][2]==0&&r[1][3]==0&&r[2][0]==0&&r[2][1]==0&&r[2][2]==1&&r[2][3]==0&&r[3][2]==0&&r[3][3]==1}function t(r,i,a,o,s){for(var l=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],c=0;c<4;c++)l[c][3]=s[c];for(var c=0;c<3;c++)for(var u=0;u<3;u++)l[3][c]+=r[u]*l[u][c];var h=o[0],f=o[1],d=o[2],p=o[3],v=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];v[0][0]=1-2*(f*f+d*d),v[0][1]=2*(h*f-d*p),v[0][2]=2*(h*d+f*p),v[1][0]=2*(h*f+d*p),v[1][1]=1-2*(h*h+d*d),v[1][2]=2*(f*d-h*p),v[2][0]=2*(h*d-f*p),v[2][1]=2*(f*d+h*p),v[2][2]=1-2*(h*h+f*f),l=n(l,v);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[2]&&(g[2][1]=a[2],l=n(l,g)),a[1]&&(g[2][1]=0,g[2][0]=a[0],l=n(l,g)),a[0]&&(g[2][0]=0,g[1][0]=a[0],l=n(l,g));for(var c=0;c<3;c++)for(var u=0;u<3;u++)l[c][u]*=i[c];return e(l)?[l[0][0],l[0][1],l[1][0],l[1][1],l[3][0],l[3][1]]:l[0].concat(l[1],l[2],l[3])}return t}();function KP(n){return n.toFixed(6).replace(".000000","")}function $d(n,e){var t,r;return n.decompositionPair!==e&&(n.decompositionPair=e,t=My(n)),e.decompositionPair!==n&&(e.decompositionPair=n,r=My(e)),t[0]===null||r[0]===null?[[!1],[!0],function(i){return i?e[0].d:n[0].d}]:(t[0].push(0),r[0].push(1),[t,r,function(i){var a=qP(t[0][3],r[0][3],i[5]),o=$P(i[0],i[1],i[2],a,i[4]),s=o.map(KP).join(",");return s}])}function ZP(n,e){for(var t=0,r=0;r<n.length;r++)t+=n[r]*e[r];return t}function qP(n,e,t){var r=ZP(n,e);r=me(r,-1,1);var i=[];if(r===1)i=n;else for(var a=Math.acos(r),o=Math.sin(t*a)*1/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(n[s]*(Math.cos(t*a)-r*o)+e[s]*o);return i}function Kd(n){return n.replace(/[xy]/,"")}function Zd(n){return n.replace(/(x|y|z|3d)?$/,"3d")}var JP=function(n,e){return n==="perspective"&&e==="perspective"||(n==="matrix"||n==="matrix3d")&&(e==="matrix"||e==="matrix3d")};function QP(n,e,t){var r=!1;if(!n.length||!e.length){n.length||(r=!0,n=e,e=[]);for(var i=function(y){var E=n[y],w=E.t,M=E.d,P=w.substring(0,5)==="scale"?1:0;e.push({t:w,d:M.map(function(A){return typeof A=="number"?Ge(P):Ge(P,A.unit)})})},a=0;a<n.length;a++)i(a)}var o=[],s=[],l=[];if(n.length!==e.length){var c=$d(n,e);o=[c[0]],s=[c[1]],l=[["matrix",[c[2]]]]}else for(var a=0;a<n.length;a++){var u=n[a].t,h=e[a].t,f=n[a].d,d=e[a].d,p=au[u],v=au[h],g=void 0;if(JP(u,h)){var c=$d([n[a]],[e[a]]);o.push(c[0]),s.push(c[1]),l.push(["matrix",[c[2]]]);continue}else if(u===h)g=u;else if(p[2]&&v[2]&&Kd(u)===Kd(h))g=Kd(u),f=p[2](f),d=v[2](d);else if(p[1]&&v[1]&&Zd(u)===Zd(h))g=Zd(u),f=p[1](f),d=v[1](d);else{var c=$d(n,e);o=[c[0]],s=[c[1]],l=[["matrix",[c[2]]]];break}for(var m=[],x=[],_=[],S=0;S<f.length;S++){var c=CP(f[S],d[S],t,!1,S);m[S]=c[0],x[S]=c[1],_.push(c[2])}o.push(m),s.push(x),l.push([g,_])}if(r){var b=o;o=s,s=b}return[o,s,function(y){return y.map(function(E,w){var M=E.map(function(P,A){return l[w][1][A](P)}).join(",");return l[w][0]==="matrix"&&M.split(",").length===16&&(l[w][0]="matrix3d"),l[w][0]==="matrix3d"&&M.split(",").length===6&&(l[w][0]="matrix"),l[w][0]+"("+M+")"}).join(" ")}]}var Cy=Xn(function(n){if(ue(n)){if(n==="text-anchor")return[Ge(0,"px"),Ge(0,"px")];var e=n.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[ws(ou(e[0])),ws(ou(e[1]))]}else return[Ge(n[0]||0,"px"),Ge(n[1]||0,"px")]}),tM=function(n){if(ue(n)){if(n==="text-anchor")return[Ge(0,"px"),Ge(0,"px")];var e=n.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[Cl(ou(e[0])),Cl(ou(e[1]))]}else return[Ge(n[0]||0,"px"),Ge(n[1]||0,"px")]};function ou(n){return n==="center"?"50%":n==="left"||n==="top"?"0%":n==="right"||n==="bottom"?"100%":n}var qd=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:Et.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:Et.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:Et.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:Et.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:Et.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:Et.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:Et.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:Et.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:Et.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:Et.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:Et.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:Et.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:Et.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:Et.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:Et.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:Et.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:Et.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:Et.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:Et.FILTER},{n:"clipPath",syntax:Et.DEFINED_PATH},{n:"textPath",syntax:Et.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:Et.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:Et.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:Et.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:Et.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:Et.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:Et.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:Et.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:Et.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:Et.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:Et.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:Et.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:Et.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:Et.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:Et.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:Et.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:Et.COORDINATE},{n:"y1",int:!0,l:!0,syntax:Et.COORDINATE},{n:"z1",int:!0,l:!0,syntax:Et.COORDINATE},{n:"x2",int:!0,l:!0,syntax:Et.COORDINATE},{n:"y2",int:!0,l:!0,syntax:Et.COORDINATE},{n:"z2",int:!0,l:!0,syntax:Et.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:Et.PATH,p:50},{n:"points",int:!0,l:!0,syntax:Et.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:Et.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:Et.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:Et.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:Et.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:Et.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:Et.NUMBER,d:function(n){return n===ct.PATH||n===ct.POLYGON||n===ct.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:Et.MARKER},{n:"markerEnd",syntax:Et.MARKER},{n:"markerMid",syntax:Et.MARKER},{n:"markerStartOffset",syntax:Et.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:Et.LENGTH,l:!0,int:!0,d:"0"}],Ay=qd.filter(function(n){return!!n.l}).map(function(n){return n.n}),Ha={},Ss=new WeakMap,eM=function(n,e){var t=Ss.get(n);return!t||t.length===0?!0:t.includes(e)},nM=function(){function n(e){var t=this;this.runtime=e,qd.forEach(function(r){t.registerMetadata(r)})}return n.prototype.registerMetadata=function(e){K([e.n],C(e.a||[]),!1).forEach(function(t){Ha[t]=e})},n.prototype.unregisterMetadata=function(e){delete Ha[e]},n.prototype.getPropertySyntax=function(e){return this.runtime.CSSPropertySyntaxFactory[e]},n.prototype.processProperties=function(e,t,r){var i=this;if(r===void 0&&(r={skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0}),this.runtime.enableCSSParsing){var u=r.skipUpdateAttribute,h=r.skipParse,f=r.forceUpdateGeometry,d=r.usedAttributes,p=r.memoize,v=f,g=Object.keys(t);g.forEach(function(m){var x;u||(e.attributes[m]=t[m]),!v&&(!((x=Ha[m])===null||x===void 0)&&x.l)&&(v=!0)}),h||g.forEach(function(m){e.computedStyle[m]=i.parseProperty(m,e.attributes[m],e,p)}),d!=null&&d.length&&(g=Array.from(new Set(g.concat(d)))),g.forEach(function(m){m in e.computedStyle&&(e.parsedStyle[m]=i.computeProperty(m,e.computedStyle[m],e,p))}),v&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e)),g.forEach(function(m){m in e.parsedStyle&&i.postProcessProperty(m,e,g)}),this.runtime.enableCSSParsing&&e.children.length&&g.forEach(function(m){m in e.parsedStyle&&i.isPropertyInheritable(m)&&e.children.forEach(function(x){x.internalSetAttribute(m,null,{skipUpdateAttribute:!0,skipParse:!0})})})}else{Object.assign(e.attributes,t);var a=Object.keys(t),o=e.parsedStyle.clipPath,s=e.parsedStyle.offsetPath;e.parsedStyle=Object.assign(e.parsedStyle,t);var l=!!r.forceUpdateGeometry;if(!l){for(var c=0;c<Ay.length;c++)if(Ay[c]in t){l=!0;break}}t.fill&&(e.parsedStyle.fill=Es(t.fill)),t.stroke&&(e.parsedStyle.stroke=Es(t.stroke)),t.shadowColor&&(e.parsedStyle.shadowColor=Es(t.shadowColor)),t.filter&&(e.parsedStyle.filter=vy(t.filter)),Mt(t.radius)||(e.parsedStyle.radius=dy(t.radius,4)),Mt(t.lineDash)||(e.parsedStyle.lineDash=dy(t.lineDash,2)),t.points&&(e.parsedStyle.points=Ty(t.points)),t.d===""&&(e.parsedStyle.d=N({},ly)),t.d&&(e.parsedStyle.d=Xd(t.d)),t.textTransform&&this.runtime.CSSPropertySyntaxFactory["<text-transform>"].calculator(null,null,{value:t.textTransform},e,null),Nt(t.clipPath)||this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("clipPath",o,t.clipPath,e,this.runtime),t.offsetPath&&this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("offsetPath",s,t.offsetPath,e,this.runtime),t.transform&&(e.parsedStyle.transform=jd(t.transform)),t.transformOrigin&&(e.parsedStyle.transformOrigin=Cy(t.transformOrigin)),t.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,t.markerStart,t.markerStart,null,null)),t.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,t.markerEnd,t.markerEnd,null,null)),t.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator("",t.markerMid,t.markerMid,null,null)),Mt(t.zIndex)||this.runtime.CSSPropertySyntaxFactory["<z-index>"].postProcessor(e,a),Mt(t.offsetDistance)||this.runtime.CSSPropertySyntaxFactory["<offset-distance>"].postProcessor(e,a),t.transform&&this.runtime.CSSPropertySyntaxFactory["<transform>"].postProcessor(e,a),t.transformOrigin&&this.runtime.CSSPropertySyntaxFactory["<transform-origin>"].postProcessor(e,a),l&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e))}},n.prototype.parseProperty=function(e,t,r,i){var a=Ha[e],o=t;if((t===""||Mt(t))&&(t="unset"),t==="unset"||t==="initial"||t==="inherit")o=Fd(t);else if(a){var s=a.k,l=a.syntax,c=l&&this.getPropertySyntax(l);s&&s.indexOf(t)>-1?o=Fd(t):c&&(!i&&c.parserUnmemoize?o=c.parserUnmemoize(t,r):c.parser&&(o=c.parser(t,r)))}return o},n.prototype.computeProperty=function(e,t,r,i){var a=Ha[e],o=r.id==="g-root",s=t;if(a){var l=a.syntax,c=a.inh,u=a.d;if(t instanceof Ir){var h=t.value;if(h==="unset"&&(c&&!o?h="inherit":h="initial"),h==="initial")Mt(u)||(t=this.parseProperty(e,xs(u)?u(r.nodeName):u,r,i));else if(h==="inherit"){var f=this.tryToResolveProperty(r,e,{inherited:!0});if(Mt(f)){this.addUnresolveProperty(r,e);return}else return f}}var d=l&&this.getPropertySyntax(l);if(d&&d.calculator){var p=r.parsedStyle[e];s=d.calculator(e,p,t,r,this.runtime)}else t instanceof Ir?s=t.value:s=t}return s},n.prototype.postProcessProperty=function(e,t,r){var i=Ha[e];if(i&&i.syntax){var a=i.syntax&&this.getPropertySyntax(i.syntax),o=a;o&&o.postProcessor&&o.postProcessor(t,r)}},n.prototype.addUnresolveProperty=function(e,t){var r=Ss.get(e);r||(Ss.set(e,[]),r=Ss.get(e)),r.indexOf(t)===-1&&r.push(t)},n.prototype.tryToResolveProperty=function(e,t,r){r===void 0&&(r={});var i=r.inherited;if(i&&e.parentElement&&eM(e.parentElement,t)){var a=e.parentElement.parsedStyle[t];return a==="unset"||a==="initial"||a==="inherit"?void 0:a}},n.prototype.recalc=function(e){var t=Ss.get(e);if(t&&t.length){var r={};t.forEach(function(i){r[i]=e.attributes[i]}),this.processProperties(e,r),Ss.delete(e)}},n.prototype.updateGeometry=function(e){var t=e.nodeName,r=this.runtime.geometryUpdaterFactory[t];if(r){var i=e.geometry;i.contentBounds||(i.contentBounds=new Fe),i.renderBounds||(i.renderBounds=new Fe);var a=e.parsedStyle,o=r.update(a,e),s=o.cx,l=s===void 0?0:s,c=o.cy,u=c===void 0?0:c,h=o.cz,f=h===void 0?0:h,d=o.hwidth,p=d===void 0?0:d,v=o.hheight,g=v===void 0?0:v,m=o.hdepth,x=m===void 0?0:m,_=[Math.abs(p),Math.abs(g),x],S=a,b=S.stroke,y=S.lineWidth,E=y===void 0?1:y,w=S.increasedLineWidthForHitTesting,M=w===void 0?0:w,P=S.shadowType,A=P===void 0?"outer":P,O=S.shadowColor,R=S.filter,L=R===void 0?[]:R,z=S.transformOrigin,Y=[l,u,f];i.contentBounds.update(Y,_);var I=t===ct.POLYLINE||t===ct.POLYGON||t===ct.PATH?Math.SQRT2:.5,Z=b&&!b.isNone;if(Z){var J=((E||0)+(M||0))*I;_[0]+=J,_[1]+=J}if(i.renderBounds.update(Y,_),O&&A&&A!=="inner"){var mt=i.renderBounds,It=mt.min,ae=mt.max,ve=a,Hn=ve.shadowBlur,rr=ve.shadowOffsetX,rn=ve.shadowOffsetY,He=Hn||0,hn=rr||0,dr=rn||0,an=It[0]-He+hn,pr=ae[0]+He+hn,bo=It[1]-He+dr,Rc=ae[1]+He+dr;It[0]=Math.min(It[0],an),ae[0]=Math.max(ae[0],pr),It[1]=Math.min(It[1],bo),ae[1]=Math.max(ae[1],Rc),i.renderBounds.setMinMax(It,ae)}L.forEach(function(_o){var So=_o.name,Jr=_o.params;if(So==="blur"){var To=Jr[0].value;i.renderBounds.update(i.renderBounds.center,Jc(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[To,To,0]))}else if(So==="drop-shadow"){var Po=Jr[0].value,Mo=Jr[1].value,Qr=Jr[2].value,Co=i.renderBounds,xn=Co.min,bn=Co.max,Ic=xn[0]-Qr+Po,Dc=bn[0]+Qr+Po,Bc=xn[1]-Qr+Mo,Fc=bn[1]+Qr+Mo;xn[0]=Math.min(xn[0],Ic),bn[0]=Math.max(bn[0],Dc),xn[1]=Math.min(xn[1],Bc),bn[1]=Math.max(bn[1],Fc),i.renderBounds.setMinMax(xn,bn)}}),e.geometry.dirty=!1;var kc=p<0,Lc=g<0,Eo=(kc?-1:1)*(z?ri(z[0],0,e,!0):0),wo=(Lc?-1:1)*(z?ri(z[1],1,e,!0):0);(Eo||wo)&&e.setOrigin(Eo,wo)}},n.prototype.updateSizeAttenuation=function(e,t){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/t,e.nodeName===ct.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/t)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===ct.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR))},n.prototype.isPropertyInheritable=function(e){var t=Ha[e];return t?t.inh:!1},n}(),rM=function(){function n(){this.parser=fy,this.parserUnmemoize=Wd,this.parserWithCSSDisabled=null,this.mixer=Ud}return n.prototype.calculator=function(e,t,r,i){return Dr(r)},n}(),iM=function(){function n(){}return n.prototype.calculator=function(e,t,r,i,a){return r instanceof Ir&&(r=null),a.sceneGraphService.updateDisplayObjectDependency(e,t,r,i),e==="clipPath"&&i.forEach(function(o){o.childNodes.length===0&&a.sceneGraphService.dirtifyToRoot(o)}),r},n}(),aM=function(){function n(){this.parser=Es,this.parserWithCSSDisabled=Es,this.mixer=TP}return n.prototype.calculator=function(e,t,r,i){return r instanceof Ir?r.value==="none"?eu:sy:r},n}(),oM=function(){function n(){this.parser=vy}return n.prototype.calculator=function(e,t,r){return r instanceof Ir?[]:r},n}();function Oy(n){var e=n.parsedStyle.fontSize;return Mt(e)?null:e}var Jd=function(){function n(){this.parser=ws,this.parserUnmemoize=Cl,this.parserWithCSSDisabled=null,this.mixer=Ud}return n.prototype.calculator=function(e,t,r,i,a){var o;if(fe(r))return r;if(Re.isRelativeUnit(r.unit)){var s=a.styleValueRegistry;if(r.unit===yt.kPercentage)return 0;if(r.unit===yt.kEms){if(i.parentNode){var l=Oy(i.parentNode);if(l)return l*=r.value,l;s.addUnresolveProperty(i,e)}else s.addUnresolveProperty(i,e);return 0}else if(r.unit===yt.kRems){if(!((o=i==null?void 0:i.ownerDocument)===null||o===void 0)&&o.documentElement){var l=Oy(i.ownerDocument.documentElement);if(l)return l*=r.value,l;s.addUnresolveProperty(i,e)}else s.addUnresolveProperty(i,e);return 0}}else return r.value},n}(),sM=function(){function n(){this.mixer=my}return n.prototype.parser=function(e){var t=py(fe(e)?[e]:e),r;return t.length===1?r=[t[0],t[0]]:r=[t[0],t[1]],r},n.prototype.calculator=function(e,t,r){return r.map(function(i){return i.value})},n}(),lM=function(){function n(){this.mixer=my}return n.prototype.parser=function(e){var t=py(fe(e)?[e]:e),r;return t.length===1?r=[t[0],t[0],t[0],t[0]]:t.length===2?r=[t[0],t[1],t[0],t[1]]:t.length===3?r=[t[0],t[1],t[2],t[1]]:r=[t[0],t[1],t[2],t[3]],r},n.prototype.calculator=function(e,t,r){return r.map(function(i){return i.value})},n}(),cM=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){r instanceof Ir&&(r=null);var a=r==null?void 0:r.cloneNode(!0);return a&&(a.style.isMarker=!0),a},n}(),uM=function(){function n(){this.mixer=Ud,this.parser=No,this.parserUnmemoize=_s,this.parserWithCSSDisabled=null}return n.prototype.calculator=function(e,t,r){return r.value},n}(),hM=function(){function n(){this.parser=No,this.parserUnmemoize=_s,this.parserWithCSSDisabled=null,this.mixer=Vd(0,1)}return n.prototype.calculator=function(e,t,r){return r.value},n.prototype.postProcessor=function(e){var t=e.parsedStyle,r=t.offsetPath,i=t.offsetDistance;if(r){var a=r.nodeName;if(a===ct.LINE||a===ct.PATH||a===ct.POLYLINE){var o=r.getPoint(i);o&&e.setLocalPosition(o.x,o.y)}}},n}(),fM=function(){function n(){this.parser=No,this.parserUnmemoize=_s,this.parserWithCSSDisabled=null,this.mixer=Vd(0,1)}return n.prototype.calculator=function(e,t,r){return r.value},n}(),dM=function(){function n(){this.parser=Xd,this.parserWithCSSDisabled=Xd,this.mixer=VP}return n.prototype.calculator=function(e,t,r){return r instanceof Ir&&r.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Ua(0,0,0,0)}:r},n}(),pM=function(){function n(){this.parser=Ty,this.mixer=HP}return n}(),vM=function(n){B(e,n);function e(){var t=n.apply(this,K([],C(arguments),!1))||this;return t.mixer=Vd(0,1/0),t}return e}(Jd),gM=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){return r instanceof Ir?r.value==="unset"?"":r.value:"".concat(r)},n.prototype.postProcessor=function(e){e.nodeValue="".concat(e.parsedStyle.text)||""},n}(),mM=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){var a=i.getAttribute("text");if(a){var o=a;r.value==="capitalize"?o=a.charAt(0).toUpperCase()+a.slice(1):r.value==="lowercase"?o=a.toLowerCase():r.value==="uppercase"&&(o=a.toUpperCase()),i.parsedStyle.text=o}return r.value},n}(),Qd={},yM=0;function xM(n,e){if(n){var t=typeof n=="string"?n:n.id||yM++;Qd[t]&&Qd[t].destroy(),Qd[t]=e}}var Al=typeof window!="undefined"&&typeof window.document!="undefined";function bM(n){return!!n.getAttribute}function EM(n,e){for(var t=0,r=n.length;t<r;){var i=t+r>>>1;Ny(n[i],e)<0?t=i+1:r=i}return t}function Ny(n,e){var t=Number(n.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(t===r){var i=n.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(n)-a.indexOf(e)}}return t-r}function Ry(n){var e,t=n;do{var r=(e=t.parsedStyle)===null||e===void 0?void 0:e.clipPath;if(r)return t;t=t.parentElement}while(t!==null);return null}var ky="px";function wM(n,e,t){Al&&n.style&&(n.style.width=e+ky,n.style.height=t+ky)}function Ly(n,e){if(Al)return document.defaultView.getComputedStyle(n,null).getPropertyValue(e)}function _M(n){var e=Ly(n,"width");return e==="auto"?n.offsetWidth:parseFloat(e)}function SM(n){var e=Ly(n,"height");return e==="auto"?n.offsetHeight:parseFloat(e)}var TM=1,PM={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},tp=typeof performance=="object"&&performance.now?performance:Date;function ko(n,e,t){n===void 0&&(n="auto");var r=!1,i=!1,a=!!e&&!e.isNone,o=!!t&&!t.isNone;return n==="visiblepainted"||n==="painted"||n==="auto"?(r=a,i=o):n==="visiblefill"||n==="fill"?r=!0:n==="visiblestroke"||n==="stroke"?i=!0:(n==="visible"||n==="all")&&(r=!0,i=!0),[r,i]}var MM=1,CM=function(){return MM++},na=typeof self=="object"&&self.self==self?self:typeof D.g=="object"&&D.g.global==D.g?D.g:{},AM=Date.now(),OM=function(){return na.performance&&typeof na.performance.now=="function"?na.performance.now():Date.now()-AM},Ol={},Iy=Date.now(),NM=function(n){if(typeof n!="function")throw new TypeError(n+" is not a function");var e=Date.now(),t=e-Iy,r=t>16?0:16-t,i=CM();return Ol[i]=n,Object.keys(Ol).length>1||setTimeout(function(){Iy=e;var a=Ol;Ol={},Object.keys(a).forEach(function(o){return a[o](OM())})},r),i},RM=function(n){delete Ol[n]},kM=["","webkit","moz","ms","o"],Dy=function(n){return typeof n!="string"?NM:n===""?na.requestAnimationFrame:na[n+"RequestAnimationFrame"]},LM=function(n){return typeof n!="string"?RM:n===""?na.cancelAnimationFrame:na[n+"CancelAnimationFrame"]||na[n+"CancelRequestAnimationFrame"]},IM=function(n,e){for(var t=0;n[t]!==void 0;){if(e(n[t]))return n[t];t=t+1}},By=IM(kM,function(n){return!!Dy(n)}),ep=Dy(By),Fy=LM(By);na.requestAnimationFrame=ep,na.cancelAnimationFrame=Fy;var DM=function(){function n(){this.callbacks=[]}return n.prototype.getCallbacksNum=function(){return this.callbacks.length},n.prototype.tapPromise=function(e,t){this.callbacks.push(t)},n.prototype.promise=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Promise.all(this.callbacks.map(function(r){return r.apply(void 0,K([],C(e),!1))}))},n}(),BM=function(){function n(){this.callbacks=[]}return n.prototype.tapPromise=function(e,t){this.callbacks.push(t)},n.prototype.promise=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return j(this,void 0,void 0,function(){var r,i,a,o;return gt(this,function(s){switch(s.label){case 0:return this.callbacks.length?[4,(o=this.callbacks)[0].apply(o,K([],C(e),!1))]:[3,6];case 1:r=s.sent(),i=0,s.label=2;case 2:return i<this.callbacks.length-1?(a=this.callbacks[i],[4,a(r)]):[3,5];case 3:r=s.sent(),s.label=4;case 4:return i++,[3,2];case 5:return[2,r];case 6:return[2,null]}})})},n}(),Er=function(){function n(){this.callbacks=[]}return n.prototype.tap=function(e,t){this.callbacks.push(t)},n.prototype.call=function(){var e=arguments;this.callbacks.forEach(function(t){t.apply(void 0,e)})},n}(),np=function(){function n(){this.callbacks=[]}return n.prototype.tap=function(e,t){this.callbacks.push(t)},n.prototype.call=function(){if(this.callbacks.length){for(var e=arguments,t=this.callbacks[0].apply(void 0,e),r=0;r<this.callbacks.length-1;r++){var i=this.callbacks[r];t=i(t)}return t}return null},n}(),FM=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],GM=/([\"\'])[^\'\"]+\1/;function zM(n){for(var e=n.fontSize,t=e===void 0?16:e,r=n.fontFamily,i=r===void 0?"sans-serif":r,a=n.fontStyle,o=a===void 0?"normal":a,s=n.fontVariant,l=s===void 0?"normal":s,c=n.fontWeight,u=c===void 0?"normal":c,h=fe(t)&&"".concat(t,"px")||"16px",f=i.split(","),d=f.length-1;d>=0;d--){var p=f[d].trim();!GM.test(p)&&FM.indexOf(p)<0&&(p='"'.concat(p,'"')),f[d]=p}return"".concat(o," ").concat(l," ").concat(u," ").concat(h," ").concat(f.join(","))}function rp(n,e,t){return Xt(n),n[4]=Math.tan(e),n[1]=Math.tan(t),n}var Nl=1e-5,WM=Q(),On=Q();function Gy(n,e){if(n.length){var t=Xt(WM);n.forEach(function(r){var i=r.t,a=r.d;if(i==="scale"){var o=(a==null?void 0:a.map(function(m){return Math.max(m.value,Nl)}))||[1,1];Ae(On,[o[0],o[1],1])}else if(i==="scalex"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,Nl)}))||[1];Ae(On,[o[0],1,1])}else if(i==="scaley"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,Nl)}))||[1];Ae(On,[1,o[0],1])}else if(i==="scalez"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,Nl)}))||[1];Ae(On,[1,1,o[0]])}else if(i==="scale3d"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,Nl)}))||[1,1,1];Ae(On,[o[0],o[1],o[2]])}else if(i==="translate"){var s=a||[En,En];ce(On,[s[0].value,s[1].value,0])}else if(i==="translatex"){var s=a||[En];ce(On,[s[0].value,0,0])}else if(i==="translatey"){var s=a||[En];ce(On,[0,s[0].value,0])}else if(i==="translatez"){var s=a||[En];ce(On,[0,0,s[0].value])}else if(i==="translate3d"){var s=a||[En,En,En];ce(On,[s[0].value,s[1].value,s[2].value])}else if(i==="rotate"){var l=a||[_i];ti(On,Oe(Dr(l[0])))}else if(i==="rotatex"){var l=a||[_i];re(On,Oe(Dr(l[0])))}else if(i==="rotatey"){var l=a||[_i];je(On,Oe(Dr(l[0])))}else if(i==="rotatez"){var l=a||[_i];ti(On,Oe(Dr(l[0])))}else if(i==="rotate3d"){var l=a||[En,En,En,_i];Or(On,Oe(Dr(l[3])),[l[0].value,l[1].value,l[2].value])}else if(i==="skew"){var c=(a==null?void 0:a.map(function(m){return m.value}))||[0,0];rp(On,Oe(c[0]),Oe(c[1]))}else if(i==="skewx"){var c=(a==null?void 0:a.map(function(x){return x.value}))||[0];rp(On,Oe(c[0]),0)}else if(i==="skewy"){var c=(a==null?void 0:a.map(function(x){return x.value}))||[0];rp(On,0,Oe(c[0]))}else if(i==="matrix"){var u=C(a.map(function(m){return m.value}),6),h=u[0],f=u[1],d=u[2],p=u[3],v=u[4],g=u[5];ne(On,h,f,0,0,d,p,0,0,0,0,1,0,v,g,0,1)}else i==="matrix3d"&&ne.apply(G,K([On],C(a.map(function(m){return m.value})),!1));Yc(t,t,On)}),e.setLocalTransform(t)}else e.resetLocalTransform();return e.getLocalTransform()}var UM=function(){function n(){this.parser=jd,this.parserUnmemoize=Py,this.parserWithCSSDisabled=Py,this.mixer=QP}return n.prototype.calculator=function(e,t,r,i){return r instanceof Ir?[]:r},n.prototype.postProcessor=function(e){var t=e.parsedStyle.transform;Gy(t,e)},n}(),VM=function(){function n(){this.parser=Cy,this.parserUnmemoize=tM}return n.prototype.postProcessor=function(e){var t=e.parsedStyle.transformOrigin;t[0].unit===yt.kPixels&&t[1].unit===yt.kPixels?e.setOrigin(t[0].value,t[1].value):e.getGeometryBounds()},n}(),HM=function(){function n(){this.parser=No,this.parserUnmemoize=_s}return n.prototype.calculator=function(e,t,r,i){return r.value},n.prototype.postProcessor=function(e){if(e.parentNode){var t=e.parentNode,r=t.renderable,i=t.sortable;r&&(r.dirty=!0),i&&(i.dirty=!0,i.dirtyReason=bs.Z_INDEX_CHANGED)}},n}(),YM=function(){function n(){}return n.prototype.update=function(e,t){var r=e.cx,i=r===void 0?0:r,a=e.cy,o=a===void 0?0:a,s=e.r,l=s===void 0?0:s;return{cx:i,cy:o,hwidth:l,hheight:l}},n}(),XM=function(){function n(){}return n.prototype.update=function(e,t){var r=e.cx,i=r===void 0?0:r,a=e.cy,o=a===void 0?0:a,s=e.rx,l=s===void 0?0:s,c=e.ry,u=c===void 0?0:c;return{cx:i,cy:o,hwidth:l,hheight:u}},n}(),jM=function(){function n(){}return n.prototype.update=function(e){var t=e.x1,r=e.y1,i=e.x2,a=e.y2,o=Math.min(t,i),s=Math.max(t,i),l=Math.min(r,a),c=Math.max(r,a),u=s-o,h=c-l,f=u/2,d=h/2;return{cx:o+f,cy:l+d,hwidth:f,hheight:d}},n}(),$M=function(){function n(){}return n.prototype.update=function(e){var t=e.d,r=t.rect,i=r.x,a=r.y,o=r.width,s=r.height,l=o/2,c=s/2;return{cx:i+l,cy:a+c,hwidth:l,hheight:c}},n}(),KM=function(){function n(){}return n.prototype.update=function(e){if(e.points&&xr(e.points.points)){var t=e.points.points,r=Math.min.apply(Math,K([],C(t.map(function(h){return h[0]})),!1)),i=Math.max.apply(Math,K([],C(t.map(function(h){return h[0]})),!1)),a=Math.min.apply(Math,K([],C(t.map(function(h){return h[1]})),!1)),o=Math.max.apply(Math,K([],C(t.map(function(h){return h[1]})),!1)),s=i-r,l=o-a,c=s/2,u=l/2;return{cx:r+c,cy:a+u,hwidth:c,hheight:u}}return{cx:0,cy:0,hwidth:0,hheight:0}},n}(),ZM=function(){function n(){}return n.prototype.update=function(e,t){var r=e.x,i=r===void 0?0:r,a=e.y,o=a===void 0?0:a,s=e.src,l=e.width,c=l===void 0?0:l,u=e.height,h=u===void 0?0:u,f=c,d=h;return s&&!ue(s)&&(f||(f=s.width,e.width=f),d||(d=s.height,e.height=d)),{cx:i+f/2,cy:o+d/2,hwidth:f/2,hheight:d/2}},n}(),qM=function(){function n(e){this.globalRuntime=e}return n.prototype.isReadyToMeasure=function(e,t){var r=e.text,i=e.textAlign,a=e.textBaseline,o=e.fontSize,s=e.fontStyle,l=e.fontWeight,c=e.fontVariant,u=e.lineWidth;return nt.enableCSSParsing?r&&o&&s&&l&&c&&i&&a&&!Mt(u):r},n.prototype.update=function(e,t){var r,i,a=e.text,o=e.textAlign,s=o===void 0?"start":o,l=e.lineWidth,c=l===void 0?1:l,u=e.textBaseline,h=u===void 0?"alphabetic":u,f=e.dx,d=f===void 0?0:f,p=e.dy,v=p===void 0?0:p,g=e.x,m=g===void 0?0:g,x=e.y,_=x===void 0?0:x;if(!this.isReadyToMeasure(e,t))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var S=(((i=(r=t==null?void 0:t.ownerDocument)===null||r===void 0?void 0:r.defaultView)===null||i===void 0?void 0:i.getConfig())||{}).offscreenCanvas,b=this.globalRuntime.textService.measureText(a,e,S);e.metrics=b;var y=b.width,E=b.height,w=b.lineHeight,M=b.fontProperties,P=y/2,A=E/2,O=m+P;s==="center"||s==="middle"?O+=c/2-P:(s==="right"||s==="end")&&(O+=c-P*2);var R=_-A;return h==="middle"?R+=A:h==="top"||h==="hanging"?R+=A*2:h==="alphabetic"?R+=this.globalRuntime.enableCSSParsing?w-M.ascent:0:(h==="bottom"||h==="ideographic")&&(R+=0),d&&(O+=d),v&&(R+=v),{cx:O,cy:R,hwidth:P,hheight:A}},n}(),JM=function(){function n(){}return n.prototype.update=function(e,t){return{cx:0,cy:0,hwidth:0,hheight:0}},n}();function QM(n){return!!n.type}var su=function(){function n(e){this.eventPhase=n.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Yn,this.page=new Yn,this.canvas=new Yn,this.viewport=new Yn,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}return Object.defineProperty(n.prototype,"name",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layerX",{get:function(){return this.layer.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layerY",{get:function(){return this.layer.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageX",{get:function(){return this.page.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageY",{get:function(){return this.page.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"x",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasX",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasY",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewportX",{get:function(){return this.viewport.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewportY",{get:function(){return this.viewport.y},enumerable:!1,configurable:!0}),n.prototype.composedPath=function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},Object.defineProperty(n.prototype,"propagationPath",{get:function(){return this.composedPath()},enumerable:!1,configurable:!0}),n.prototype.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},n.prototype.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},n.prototype.stopPropagation=function(){this.propagationStopped=!0},n.prototype.initEvent=function(){},n.prototype.initUIEvent=function(){},n.prototype.clone=function(){throw new Error(Ne)},n}(),zy=function(n){B(e,n);function e(){var t=n.apply(this,K([],C(arguments),!1))||this;return t.client=new Yn,t.movement=new Yn,t.offset=new Yn,t.global=new Yn,t.screen=new Yn,t}return Object.defineProperty(e.prototype,"clientX",{get:function(){return this.client.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientY",{get:function(){return this.client.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementX",{get:function(){return this.movement.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementY",{get:function(){return this.movement.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetX",{get:function(){return this.offset.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetY",{get:function(){return this.offset.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalX",{get:function(){return this.global.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalY",{get:function(){return this.global.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenX",{get:function(){return this.screen.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenY",{get:function(){return this.screen.y},enumerable:!1,configurable:!0}),e.prototype.getModifierState=function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)},e.prototype.initMouseEvent=function(){throw new Error(Ne)},e}(su),lu=function(n){B(e,n);function e(){var t=n.apply(this,K([],C(arguments),!1))||this;return t.width=0,t.height=0,t.isPrimary=!1,t}return e.prototype.getCoalescedEvents=function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]},e.prototype.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},e.prototype.clone=function(){return this.manager.clonePointerEvent(this)},e}(zy),ip=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.clone=function(){return this.manager.cloneWheelEvent(this)},e}(zy),or=function(n){B(e,n);function e(t,r){var i=n.call(this,null)||this;return i.type=t,i.detail=r,Object.assign(i,r),i}return e}(su),Wy=":",Uy=function(){function n(){this.emitter=new et}return n.prototype.on=function(e,t,r){return this.addEventListener(e,t,r),this},n.prototype.addEventListener=function(e,t,r){var i=ds(r)&&r||dn(r)&&r.capture,a=dn(r)&&r.once,o=xs(t)?void 0:t,s=!1,l="";if(e.indexOf(Wy)>-1){var c=C(e.split(Wy),2),u=c[0],h=c[1];e=h,l=u,s=!0}if(e=i?"".concat(e,"capture"):e,t=xs(t)?t:t.handleEvent,s){var f=t;t=function(){for(var d,p=[],v=0;v<arguments.length;v++)p[v]=arguments[v];((d=p[0].target)===null||d===void 0?void 0:d.name)===l&&f.apply(void 0,K([],C(p),!1))}}return a?this.emitter.once(e,t,o):this.emitter.on(e,t,o),this},n.prototype.off=function(e,t,r){return e?this.removeEventListener(e,t,r):this.removeAllEventListeners(),this},n.prototype.removeAllEventListeners=function(){this.emitter.removeAllListeners()},n.prototype.removeEventListener=function(e,t,r){var i=ds(r)&&r||dn(r)&&r.capture,a=xs(t)?void 0:t;return e=i?"".concat(e,"capture"):e,t=xs(t)?t:t==null?void 0:t.handleEvent,this.emitter.off(e,t,a),this},n.prototype.emit=function(e,t){this.dispatchEvent(new or(e,t))},n.prototype.dispatchEvent=function(e,t){var r,i;if(t===void 0&&(t=!1),!QM(e))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var a;if(this.document?a=this:this.defaultView?a=this.defaultView:a=(r=this.ownerDocument)===null||r===void 0?void 0:r.defaultView,a){if(e.manager=a.getEventService()||null,!e.manager)return!1;e.defaultPrevented=!1,e.path=[],t||(e.target=this),(i=e.manager)===null||i===void 0||i.dispatchEvent(e,e.type,t)}return!e.defaultPrevented},n}(),zn=function(n){B(e,n);function e(){var t=n.call(this)||this;return t.shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return e.isNode=function(t){return!!t.childNodes},Object.defineProperty(e.prototype,"textContent",{get:function(){var t,r,i="";this.nodeName===ct.TEXT&&(i+=this.style.text);try{for(var a=pt(this.childNodes),o=a.next();!o.done;o=a.next()){var s=o.value;s.nodeName===ct.TEXT?i+=s.nodeValue:i+=s.textContent}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return i},set:function(t){var r=this;this.childNodes.slice().forEach(function(i){r.removeChild(i)}),this.nodeName===ct.TEXT&&(this.style.text="".concat(t))},enumerable:!1,configurable:!0}),e.prototype.getRootNode=function(t){return t===void 0&&(t={}),this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this},e.prototype.hasChildNodes=function(){return this.childNodes.length>0},e.prototype.isDefaultNamespace=function(t){throw new Error(Ne)},e.prototype.lookupNamespaceURI=function(t){throw new Error(Ne)},e.prototype.lookupPrefix=function(t){throw new Error(Ne)},e.prototype.normalize=function(){throw new Error(Ne)},e.prototype.isEqualNode=function(t){return this===t},e.prototype.isSameNode=function(t){return this.isEqualNode(t)},Object.defineProperty(e.prototype,"parent",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.childNodes.length>0?this.childNodes[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null},enumerable:!1,configurable:!0}),e.prototype.compareDocumentPosition=function(t){var r;if(t===this)return 0;for(var i=t,a=this,o=[i],s=[a];(r=i.parentNode)!==null&&r!==void 0?r:a.parentNode;)i=i.parentNode?(o.push(i.parentNode),i.parentNode):i,a=a.parentNode?(s.push(a.parentNode),a.parentNode):a;if(i!==a)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var l=o.length>s.length?o:s,c=l===o?s:o;if(l[l.length-c.length]===c[0])return l===o?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=l.length-c.length,h=c.length-1;h>=0;h--){var f=c[h],d=l[u+h];if(d!==f){var p=f.parentNode.childNodes;return p.indexOf(f)<p.indexOf(d)?c===o?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:l===o?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING},e.prototype.contain=function(t){return this.contains(t)},e.prototype.contains=function(t){for(var r=t;r&&this!==r;)r=r.parentNode;return!!r},e.prototype.getAncestor=function(t){for(var r=this;t>0&&r;)r=r.parentNode,t--;return r},e.prototype.forEach=function(t,r){r===void 0&&(r=!1),t(this)||(r?this.childNodes.slice():this.childNodes).forEach(function(i){i.forEach(t)})},e.DOCUMENT_POSITION_DISCONNECTED=1,e.DOCUMENT_POSITION_PRECEDING=2,e.DOCUMENT_POSITION_FOLLOWING=4,e.DOCUMENT_POSITION_CONTAINS=8,e.DOCUMENT_POSITION_CONTAINED_BY=16,e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,e}(Uy),tC=2048,eC=function(){function n(e,t){var r=this;this.globalRuntime=e,this.context=t,this.emitter=new et,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=Q(),this.tmpVec3=T.Ue(),this.onPointerDown=function(i){var a=r.createPointerEvent(i);if(r.dispatchEvent(a,"pointerdown"),a.pointerType==="touch")r.dispatchEvent(a,"touchstart");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var o=a.button===2;r.dispatchEvent(a,o?"rightdown":"mousedown")}var s=r.trackingData(i.pointerId);s.pressTargetsByButton[i.button]=a.composedPath(),r.freeEvent(a)},this.onPointerUp=function(i){var a,o=tp.now(),s=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(s,"pointerup"),s.pointerType==="touch")r.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.dispatchEvent(s,l?"rightup":"mouseup")}var c=r.trackingData(i.pointerId),u=r.findMountedTarget(c.pressTargetsByButton[i.button]),h=u;if(u&&!s.composedPath().includes(u)){for(var f=u;f&&!s.composedPath().includes(f);){if(s.currentTarget=f,r.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")r.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.notifyTarget(s,l?"rightupoutside":"mouseupoutside")}zn.isNode(f)&&(f=f.parentNode)}delete c.pressTargetsByButton[i.button],h=f}if(h){var d=r.clonePointerEvent(s,"click");d.target=h,d.path=[],c.clicksByButton[i.button]||(c.clicksByButton[i.button]={clickCount:0,target:d.target,timeStamp:o});var p=r.context.renderingContext.root.ownerDocument.defaultView,v=c.clicksByButton[i.button];v.target===d.target&&o-v.timeStamp<p.dblClickSpeed?++v.clickCount:v.clickCount=1,v.target=d.target,v.timeStamp=o,d.detail=v.clickCount,!((a=s.detail)===null||a===void 0)&&a.preventClick||(!r.context.config.useNativeClickEvent&&(d.pointerType==="mouse"||d.pointerType==="touch")&&r.dispatchEvent(d,"click"),r.dispatchEvent(d,"pointertap")),r.freeEvent(d)}r.freeEvent(s)},this.onPointerMove=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),o=a.pointerType==="mouse"||a.pointerType==="pen",s=r.trackingData(i.pointerId),l=r.findMountedTarget(s.overTargets);if(s.overTargets&&l!==a.target){var c=i.type==="mousemove"?"mouseout":"pointerout",u=r.createPointerEvent(i,c,l||void 0);if(r.dispatchEvent(u,"pointerout"),o&&r.dispatchEvent(u,"mouseout"),!a.composedPath().includes(l)){var h=r.createPointerEvent(i,"pointerleave",l||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!a.composedPath().includes(h.target);)h.currentTarget=h.target,r.notifyTarget(h),o&&r.notifyTarget(h,"mouseleave"),zn.isNode(h.target)&&(h.target=h.target.parentNode);r.freeEvent(h)}r.freeEvent(u)}if(l!==a.target){var f=i.type==="mousemove"?"mouseover":"pointerover",d=r.clonePointerEvent(a,f);r.dispatchEvent(d,"pointerover"),o&&r.dispatchEvent(d,"mouseover");for(var p=l&&zn.isNode(l)&&l.parentNode;p&&p!==(zn.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&p!==a.target;)p=p.parentNode;var v=!p||p===(zn.isNode(r.rootTarget)&&r.rootTarget.parentNode);if(v){var g=r.clonePointerEvent(a,"pointerenter");for(g.eventPhase=g.AT_TARGET;g.target&&g.target!==l&&g.target!==(zn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)g.currentTarget=g.target,r.notifyTarget(g),o&&r.notifyTarget(g,"mouseenter"),zn.isNode(g.target)&&(g.target=g.target.parentNode);r.freeEvent(g)}r.freeEvent(d)}r.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&r.dispatchEvent(a,"touchmove"),o&&(r.dispatchEvent(a,"mousemove"),r.cursor=r.getCursor(a.target)),s.overTargets=a.composedPath(),r.freeEvent(a)},this.onPointerOut=function(i){var a=r.trackingData(i.pointerId);if(a.overTargets){var o=i.pointerType==="mouse"||i.pointerType==="pen",s=r.findMountedTarget(a.overTargets),l=r.createPointerEvent(i,"pointerout",s||void 0);r.dispatchEvent(l),o&&r.dispatchEvent(l,"mouseout");var c=r.createPointerEvent(i,"pointerleave",s||void 0);for(c.eventPhase=c.AT_TARGET;c.target&&c.target!==(zn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)c.currentTarget=c.target,r.notifyTarget(c),o&&r.notifyTarget(c,"mouseleave"),zn.isNode(c.target)&&(c.target=c.target.parentNode);a.overTargets=null,r.freeEvent(l),r.freeEvent(c)}r.cursor=null},this.onPointerOver=function(i){var a=r.trackingData(i.pointerId),o=r.createPointerEvent(i),s=o.pointerType==="mouse"||o.pointerType==="pen";r.dispatchEvent(o,"pointerover"),s&&r.dispatchEvent(o,"mouseover"),o.pointerType==="mouse"&&(r.cursor=r.getCursor(o.target));var l=r.clonePointerEvent(o,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(zn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)l.currentTarget=l.target,r.notifyTarget(l),s&&r.notifyTarget(l,"mouseenter"),zn.isNode(l.target)&&(l.target=l.target.parentNode);a.overTargets=o.composedPath(),r.freeEvent(o),r.freeEvent(l)},this.onPointerUpOutside=function(i){var a=r.trackingData(i.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[i.button]),s=r.createPointerEvent(i);if(o){for(var l=o;l;)s.currentTarget=l,r.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"||(s.pointerType==="mouse"||s.pointerType==="pen")&&r.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),zn.isNode(l)&&(l=l.parentNode);delete a.pressTargetsByButton[i.button]}r.freeEvent(s)},this.onWheel=function(i){var a=r.createWheelEvent(i);r.dispatchEvent(a),r.freeEvent(a)},this.onClick=function(i){if(r.context.config.useNativeClickEvent){var a=r.createPointerEvent(i);r.dispatchEvent(a),r.freeEvent(a)}},this.onPointerCancel=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(a),r.freeEvent(a)}}return n.prototype.init=function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)},n.prototype.destroy=function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()},n.prototype.getScale=function(){var e=this.context.contextService.getBoundingClientRect(),t=1,r=1,i=this.context.contextService.getDomElement();if(i&&e){var a=i.offsetWidth,o=i.offsetHeight;a&&o&&(t=e.width/a,r=e.height/o)}return{scaleX:t,scaleY:r,bbox:e}},n.prototype.client2Viewport=function(e){var t=this.getScale(),r=t.scaleX,i=t.scaleY,a=t.bbox;return new Yn((e.x-((a==null?void 0:a.left)||0))/r,(e.y-((a==null?void 0:a.top)||0))/i)},n.prototype.viewport2Client=function(e){var t=this.getScale(),r=t.scaleX,i=t.scaleY,a=t.bbox;return new Yn((e.x+((a==null?void 0:a.left)||0))*r,(e.y+((a==null?void 0:a.top)||0))*i)},n.prototype.viewport2Canvas=function(e){var t=e.x,r=e.y,i=this.rootTarget.defaultView,a=i.getCamera(),o=this.context.config,s=o.width,l=o.height,c=a.getPerspectiveInverse(),u=a.getWorldTransform(),h=Ut(this.tmpMatrix,u,c),f=T.t8(this.tmpVec3,t/s*2-1,(1-r/l)*2-1,0);return T.fF(f,f,h),new Yn(f[0],f[1])},n.prototype.canvas2Viewport=function(e){var t=this.rootTarget.defaultView,r=t.getCamera(),i=r.getPerspective(),a=r.getViewTransform(),o=Ut(this.tmpMatrix,i,a),s=T.t8(this.tmpVec3,e.x,e.y,0);T.fF(this.tmpVec3,this.tmpVec3,o);var l=this.context.config,c=l.width,u=l.height;return new Yn((s[0]+1)/2*c,(1-(s[1]+1)/2)*u)},n.prototype.setPickHandler=function(e){this.pickHandler=e},n.prototype.addEventMapping=function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(r,i){return r.priority-i.priority})},n.prototype.mapEvent=function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var r=0,i=t.length;r<i;r++)t[r].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type))}},n.prototype.dispatchEvent=function(e,t,r){if(!r)e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t);else{e.eventPhase=e.AT_TARGET;var i=this.rootTarget.defaultView||null;e.currentTarget=i,this.notifyListeners(e,t)}this.emitter.emit(t||e.type,e)},n.prototype.propagate=function(e,t){if(e.target){var r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var i=r.length-1;i>=1;i--)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){var a=r.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var i=a+1;i<r.length;i++)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}},n.prototype.propagationPath=function(e){var t=[e],r=this.rootTarget.defaultView||null;if(r&&r===e)return t.unshift(r.document),t;for(var i=0;i<tC&&e!==this.rootTarget;i++)zn.isNode(e)&&e.parentNode&&(t.push(e.parentNode),e=e.parentNode);return r&&t.push(r),t},n.prototype.hitTest=function(e){var t=e.viewportX,r=e.viewportY,i=this.context.config,a=i.width,o=i.height,s=i.disableHitTesting;return t<0||r<0||t>a||r>o?null:!s&&this.pickHandler(e)||this.rootTarget||null},n.prototype.isNativeEventFromCanvas=function(e,t){var r=t==null?void 0:t.target;if(r!=null&&r.shadowRoot&&(r=t.composedPath()[0]),r){if(r===e)return!0;if(e&&e.contains)return e.contains(r)}return t!=null&&t.composedPath?t.composedPath().indexOf(e)>-1:!1},n.prototype.getExistedHTML=function(e){var t,r;if(e.nativeEvent.composedPath)try{for(var i=pt(e.nativeEvent.composedPath()),a=i.next();!a.done;a=i.next()){var o=a.value,s=this.nativeHTMLMap.get(o);if(s)return s}}catch(l){t={error:l}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return null},n.prototype.pickTarget=function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY})},n.prototype.createPointerEvent=function(e,t,r,i){var a=this.allocateEvent(lu);this.copyPointerData(e,a),this.copyMouseData(e,a),this.copyData(e,a),a.nativeEvent=e.nativeEvent,a.originalEvent=e;var o=this.getExistedHTML(a),s=this.context.contextService.getDomElement();return a.target=r!=null?r:o||this.isNativeEventFromCanvas(s,a.nativeEvent)&&this.pickTarget(a)||i,typeof t=="string"&&(a.type=t),a},n.prototype.createWheelEvent=function(e){var t=this.allocateEvent(ip);this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e;var r=this.getExistedHTML(t),i=this.context.contextService.getDomElement();return t.target=r||this.isNativeEventFromCanvas(i,t.nativeEvent)&&this.pickTarget(t),t},n.prototype.trackingData=function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]},n.prototype.cloneWheelEvent=function(e){var t=this.allocateEvent(ip);return t.nativeEvent=e.nativeEvent,t.originalEvent=e.originalEvent,this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.target=e.target,t.path=e.composedPath().slice(),t.type=e.type,t},n.prototype.clonePointerEvent=function(e,t){var r=this.allocateEvent(lu);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=t!=null?t:r.type,r},n.prototype.copyPointerData=function(e,t){t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist},n.prototype.copyMouseData=function(e,t){t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.client.copyFrom(e.client),t.movement.copyFrom(e.movement),t.canvas.copyFrom(e.canvas),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global),t.offset.copyFrom(e.offset)},n.prototype.copyWheelData=function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ},n.prototype.copyData=function(e,t){t.isTrusted=e.isTrusted,t.timeStamp=tp.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.page.copyFrom(e.page),t.viewport.copyFrom(e.viewport)},n.prototype.allocateEvent=function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t},n.prototype.freeEvent=function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)},n.prototype.notifyTarget=function(e,t){t=t!=null?t:e.type;var r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)},n.prototype.notifyListeners=function(e,t){var r=e.currentTarget.emitter,i=r._events[t];if(i)if("fn"in i)i.once&&r.removeListener(t,i.fn,void 0,!0),i.fn.call(e.currentTarget||i.context,e);else for(var a=0;a<i.length&&!e.propagationImmediatelyStopped;a++)i[a].once&&r.removeListener(t,i[a].fn,void 0,!0),i[a].fn.call(e.currentTarget||i[a].context,e)},n.prototype.findMountedTarget=function(e){if(!e)return null;for(var t=e[e.length-1],r=e.length-2;r>=0;r--){var i=e[r];if(i===this.rootTarget||zn.isNode(i)&&i.parentNode===t)t=e[r];else break}return t},n.prototype.getCursor=function(e){for(var t=e;t;){var r=bM(t)&&t.getAttribute("cursor");if(r)return r;t=zn.isNode(t)&&t.parentNode}},n}(),nC=function(){function n(){}return n.prototype.getOrCreateCanvas=function(e,t){if(this.canvas)return this.canvas;if(e||nt.offscreenCanvas)this.canvas=e||nt.offscreenCanvas,this.context=this.canvas.getContext("2d",N({willReadFrequently:!0},t));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",N({willReadFrequently:!0},t)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",N({willReadFrequently:!0},t))}return this.canvas.width=10,this.canvas.height=10,this.canvas},n.prototype.getOrCreateContext=function(e,t){return this.context?this.context:(this.getOrCreateCanvas(e,t),this.context)},n}(),Lo;(function(n){n[n.CAMERA_CHANGED=0]="CAMERA_CHANGED",n[n.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",n[n.NONE=2]="NONE"})(Lo||(Lo={}));var rC=function(){function n(e,t){this.globalRuntime=e,this.context=t,this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new Er,initAsync:new DM,dirtycheck:new np,cull:new np,beginFrame:new Er,beforeRender:new Er,render:new Er,afterRender:new Er,endFrame:new Er,destroy:new Er,pick:new BM,pickSync:new np,pointerDown:new Er,pointerUp:new Er,pointerMove:new Er,pointerOut:new Er,pointerOver:new Er,pointerWheel:new Er,pointerCancel:new Er,click:new Er}}return n.prototype.init=function(e){var t=this,r=N(N({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(i){i.apply(r,t.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){t.inited=!0,e()})},n.prototype.getStats=function(){return this.stats},n.prototype.disableDirtyRectangleRendering=function(){var e=this.context.config.renderer,t=e.getConfig().enableDirtyRectangleRendering;return!t||this.context.renderingContext.renderReasons.has(Lo.CAMERA_CHANGED)},n.prototype.render=function(e,t,r){var i=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var a=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=a.renderReasons.size===1&&a.renderReasons.has(Lo.CAMERA_CHANGED),s=!e.disableRenderHooks||!(e.disableRenderHooks&&o);s&&this.renderDisplayObject(a.root,e,a),this.hooks.beginFrame.call(t),s&&a.renderListCurrentFrame.forEach(function(l){i.hooks.beforeRender.call(l),i.hooks.render.call(l),i.hooks.afterRender.call(l)}),this.hooks.endFrame.call(t),a.renderListCurrentFrame=[],a.renderReasons.clear(),r()}},n.prototype.renderDisplayObject=function(e,t,r){var i=this,a=t.renderer.getConfig(),o=a.enableDirtyCheck,s=a.enableCulling;this.globalRuntime.enableCSSParsing&&this.globalRuntime.styleValueRegistry.recalc(e);var l=e.renderable,c=o?l.dirty||r.dirtyRectangleRenderingDisabled?e:null:e;if(c){var u=s?this.hooks.cull.call(c,this.context.camera):c;u&&(this.stats.rendered++,r.renderListCurrentFrame.push(u))}e.renderable.dirty=!1,e.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var h=e.sortable;h.dirty&&(this.sort(e,h),h.dirty=!1,h.dirtyChildren=[],h.dirtyReason=void 0),(h.sorted||e.childNodes).forEach(function(f){i.renderDisplayObject(f,t,r)})},n.prototype.sort=function(e,t){t.sorted&&t.dirtyReason!==bs.Z_INDEX_CHANGED?t.dirtyChildren.forEach(function(r){var i=e.childNodes.indexOf(r);if(i===-1){var a=t.sorted.indexOf(r);a>=0&&t.sorted.splice(a,1)}else if(t.sorted.length===0)t.sorted.push(r);else{var o=EM(t.sorted,r);t.sorted.splice(o,0,r)}}):t.sorted=e.childNodes.slice().sort(Ny)},n.prototype.destroy=function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()},n.prototype.dirtify=function(){this.context.renderingContext.renderReasons.add(Lo.DISPLAY_OBJECT_CHANGED)},n}(),iC=/\[\s*(.*)=(.*)\s*\]/,aC=function(){function n(){}return n.prototype.selectOne=function(e,t){var r=this;if(e.startsWith("."))return t.find(function(s){return((s==null?void 0:s.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.find(function(s){return s.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,o=i.value;return a?t.find(function(s){return t!==s&&(a==="name"?s.name===o:r.attributeToString(s,a)===o)}):null}else return t.find(function(s){return t!==s&&s.nodeName===e})},n.prototype.selectAll=function(e,t){var r=this;if(e.startsWith("."))return t.findAll(function(s){return t!==s&&((s==null?void 0:s.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.findAll(function(s){return t!==s&&s.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,o=i.value;return a?t.findAll(function(s){return t!==s&&(a==="name"?s.name===o:r.attributeToString(s,a)===o)}):[]}else return t.findAll(function(s){return t!==s&&s.nodeName===e})},n.prototype.is=function(e,t){if(e.startsWith("."))return t.className===this.getIdOrClassname(e);if(e.startsWith("#"))return t.id===this.getIdOrClassname(e);if(e.startsWith("[")){var r=this.getAttribute(e),i=r.name,a=r.value;return i==="name"?t.name===a:this.attributeToString(t,i)===a}else return t.nodeName===e},n.prototype.getIdOrClassname=function(e){return e.substring(1)},n.prototype.getAttribute=function(e){var t=e.match(iC),r="",i="";return t&&t.length>2&&(r=t[1].replace(/"/g,""),i=t[2].replace(/"/g,"")),{name:r,value:i}},n.prototype.attributeToString=function(e,t){if(!e.getAttribute)return"";var r=e.getAttribute(t);return Mt(r)?"":r.toString?r.toString():""},n}(),Ya=function(n){B(e,n);function e(t,r,i,a,o,s,l,c){var u=n.call(this,null)||this;return u.relatedNode=r,u.prevValue=i,u.newValue=a,u.attrName=o,u.attrChange=s,u.prevParsedValue=l,u.newParsedValue=c,u.type=t,u}return e.ADDITION=2,e.MODIFICATION=1,e.REMOVAL=3,e}(su),oe;(function(n){n.REPARENT="reparent",n.DESTROY="destroy",n.ATTR_MODIFIED="DOMAttrModified",n.INSERTED="DOMNodeInserted",n.REMOVED="removed",n.MOUNTED="DOMNodeInsertedIntoDocument",n.UNMOUNTED="DOMNodeRemovedFromDocument",n.BOUNDS_CHANGED="bounds-changed",n.CULLED="culled"})(oe||(oe={}));function Vy(n){var e=n.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}var oC=new Ya(oe.REPARENT,null,"","","",0,"",""),sC=function(){function n(e){var t=this;this.runtime=e,this.pendingEvents=[],this.boundsChangedEvent=new or(oe.BOUNDS_CHANGED),this.rotate=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=T.al(a,o,s));var c=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)t.rotateLocal(i,a);else{var u=Vt();bi(u,a[0],a[1],a[2]);var h=t.getRotation(i),f=t.getRotation(i.parentNode);Ei(r,f),ga(r,r),Ln(u,r,u),Ln(c.localRotation,u,h),Ga(c.localRotation,c.localRotation),l&&t.dirtifyLocal(i,c)}}}(),this.rotateLocal=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=T.al(a,o,s));var c=i.transformable;bi(r,a[0],a[1],a[2]),os(c.localRotation,c.localRotation,r),l&&t.dirtifyLocal(i,c)}}(),this.setEulerAngles=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=T.al(a,o,s));var c=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)t.setLocalEulerAngles(i,a);else{bi(c.localRotation,a[0],a[1],a[2]);var u=t.getRotation(i.parentNode);Ei(r,ga(Vt(),u)),os(c.localRotation,c.localRotation,r),l&&t.dirtifyLocal(i,c)}}}(),this.translateLocal=function(){return function(r,i,a,o,s){a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=!0),typeof i=="number"&&(i=T.al(i,a,o));var l=r.transformable;T.fS(i,T.Ue())||(T.VC(i,i,l.localRotation),T.IH(l.localPosition,l.localPosition,i),s&&t.dirtifyLocal(r,l))}}(),this.setPosition=function(){var r=Q(),i=T.Ue();return function(a,o,s){s===void 0&&(s=!0);var l=a.transformable;if(i[0]=o[0],i[1]=o[1],i[2]=o[2]||0,!T.fS(t.getPosition(a),i)){if(T.JG(l.position,i),a.parentNode===null||!a.parentNode.transformable)T.JG(l.localPosition,i);else{var c=a.parentNode.transformable;kt(r,c.worldTransform),Wt(r,r),T.fF(l.localPosition,i,r)}s&&t.dirtifyLocal(a,l)}}}(),this.setLocalPosition=function(){var r=T.Ue();return function(i,a,o){o===void 0&&(o=!0);var s=i.transformable;r[0]=a[0],r[1]=a[1],r[2]=a[2]||0,!T.fS(s.localPosition,r)&&(T.JG(s.localPosition,r),o&&t.dirtifyLocal(i,s))}}(),this.translate=function(){var r=T.Ue(),i=T.Ue(),a=T.Ue();return function(o,s,l,c,u){l===void 0&&(l=0),c===void 0&&(c=0),u===void 0&&(u=!0),typeof s=="number"&&(s=T.t8(i,s,l,c)),!T.fS(s,r)&&(T.IH(a,t.getPosition(o),s),t.setPosition(o,a,u))}}(),this.setRotation=function(){var r=Vt();return function(i,a,o,s,l,c){c===void 0&&(c=!0);var u=i.transformable;if(typeof a=="number"&&(a=ma(a,o,s,l)),i.parentNode===null||!i.parentNode.transformable)t.setLocalRotation(i,a);else{var h=t.getRotation(i.parentNode);Ei(r,h),ga(r,r),Ln(u.localRotation,r,a),Ga(u.localRotation,u.localRotation),c&&t.dirtifyLocal(i,u)}}},this.displayObjectDependencyMap=new WeakMap,this.calcLocalTransform=function(){var r=Q(),i=T.Ue(),a=ma(0,0,0,1);return function(o){var s=o.localSkew[0]!==0||o.localSkew[1]!==0;if(s){if(mr(o.localTransform,o.localRotation,o.localPosition,T.al(1,1,1),o.origin),o.localSkew[0]!==0||o.localSkew[1]!==0){var l=Xt(r);l[4]=Math.tan(o.localSkew[0]),l[1]=Math.tan(o.localSkew[1]),Ut(o.localTransform,o.localTransform,l)}var c=mr(r,a,i,o.localScale,o.origin);Ut(o.localTransform,o.localTransform,c)}else mr(o.localTransform,o.localRotation,o.localPosition,o.localScale,o.origin)}}()}return n.prototype.matches=function(e,t){return this.runtime.sceneGraphSelector.is(e,t)},n.prototype.querySelector=function(e,t){return this.runtime.sceneGraphSelector.selectOne(e,t)},n.prototype.querySelectorAll=function(e,t){return this.runtime.sceneGraphSelector.selectAll(e,t)},n.prototype.attach=function(e,t,r){var i,a=!1;e.parentNode&&(a=e.parentNode!==t,this.detach(e)),e.parentNode=t,Mt(r)?e.parentNode.childNodes.push(e):e.parentNode.childNodes.splice(r,0,e);var o=t.sortable;(!((i=o==null?void 0:o.sorted)===null||i===void 0)&&i.length||e.parsedStyle.zIndex)&&(o.dirtyChildren.indexOf(e)===-1&&o.dirtyChildren.push(e),o.dirty=!0,o.dirtyReason=bs.ADDED);var s=e.transformable;s&&this.dirtifyWorld(e,s),s.frozen&&this.unfreezeParentToRoot(e),a&&e.dispatchEvent(oC)},n.prototype.detach=function(e){var t,r;if(e.parentNode){var i=e.transformable,a=e.parentNode.sortable;(!((t=a==null?void 0:a.sorted)===null||t===void 0)&&t.length||!((r=e.style)===null||r===void 0)&&r.zIndex)&&(a.dirtyChildren.indexOf(e)===-1&&a.dirtyChildren.push(e),a.dirty=!0,a.dirtyReason=bs.REMOVED);var o=e.parentNode.childNodes.indexOf(e);o>-1&&e.parentNode.childNodes.splice(o,1),i&&this.dirtifyWorld(e,i),e.parentNode=null}},n.prototype.getOrigin=function(e){return e.getGeometryBounds(),e.transformable.origin},n.prototype.setOrigin=function(e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=0),typeof t=="number"&&(t=[t,r,i]);var a=e.transformable;if(!(t[0]===a.origin[0]&&t[1]===a.origin[1]&&t[2]===a.origin[2])){var o=a.origin;o[0]=t[0],o[1]=t[1],o[2]=t[2]||0,this.dirtifyLocal(e,a)}},n.prototype.setLocalEulerAngles=function(e,t,r,i,a){r===void 0&&(r=0),i===void 0&&(i=0),a===void 0&&(a=!0),typeof t=="number"&&(t=T.al(t,r,i));var o=e.transformable;bi(o.localRotation,t[0],t[1],t[2]),a&&this.dirtifyLocal(e,o)},n.prototype.scaleLocal=function(e,t,r){r===void 0&&(r=!0);var i=e.transformable;T.Jp(i.localScale,i.localScale,T.al(t[0],t[1],t[2]||1)),r&&this.dirtifyLocal(e,i)},n.prototype.setLocalScale=function(e,t,r){r===void 0&&(r=!0);var i=e.transformable,a=T.al(t[0],t[1],t[2]||i.localScale[2]);T.fS(a,i.localScale)||(T.JG(i.localScale,a),r&&this.dirtifyLocal(e,i))},n.prototype.setLocalRotation=function(e,t,r,i,a,o){o===void 0&&(o=!0),typeof t=="number"&&(t=ma(t,r,i,a));var s=e.transformable;Ei(s.localRotation,t),o&&this.dirtifyLocal(e,s)},n.prototype.setLocalSkew=function(e,t,r){typeof t=="number"&&(t=ya.al(t,r));var i=e.transformable;ya.JG(i.localSkew,t),this.dirtifyLocal(e,i)},n.prototype.dirtifyLocal=function(e,t){t.localDirtyFlag||(t.localDirtyFlag=!0,t.dirtyFlag||this.dirtifyWorld(e,t))},n.prototype.dirtifyWorld=function(e,t){t.dirtyFlag||this.unfreezeParentToRoot(e),this.dirtifyWorldInternal(e,t),this.dirtifyToRoot(e,!0)},n.prototype.triggerPendingEvents=function(){var e=this,t=new Set,r=function(i,a){i.isConnected&&!t.has(i.entity)&&(e.boundsChangedEvent.detail=a,e.boundsChangedEvent.target=i,i.isMutationObserved?i.dispatchEvent(e.boundsChangedEvent):i.ownerDocument.defaultView.dispatchEvent(e.boundsChangedEvent,!0),t.add(i.entity))};this.pendingEvents.forEach(function(i){var a=C(i,2),o=a[0],s=a[1];s.affectChildren?o.forEach(function(l){r(l,s)}):r(o,s)}),this.clearPendingEvents(),t.clear()},n.prototype.clearPendingEvents=function(){this.pendingEvents=[]},n.prototype.dirtifyToRoot=function(e,t){t===void 0&&(t=!1);var r=e;for(r.renderable&&(r.renderable.dirty=!0);r;)Vy(r),r=r.parentNode;t&&e.forEach(function(i){Vy(i)}),this.informDependentDisplayObjects(e),this.pendingEvents.push([e,{affectChildren:t}])},n.prototype.updateDisplayObjectDependency=function(e,t,r,i){if(t&&t!==r){var a=this.displayObjectDependencyMap.get(t);if(a&&a[e]){var o=a[e].indexOf(i);a[e].splice(o,1)}}if(r){var s=this.displayObjectDependencyMap.get(r);s||(this.displayObjectDependencyMap.set(r,{}),s=this.displayObjectDependencyMap.get(r)),s[e]||(s[e]=[]),s[e].push(i)}},n.prototype.informDependentDisplayObjects=function(e){var t=this,r=this.displayObjectDependencyMap.get(e);r&&Object.keys(r).forEach(function(i){r[i].forEach(function(a){t.dirtifyToRoot(a,!0),a.dispatchEvent(new Ya(oe.ATTR_MODIFIED,a,t,t,i,Ya.MODIFICATION,t,t)),a.isCustomElement&&a.isConnected&&a.attributeChangedCallback&&a.attributeChangedCallback(i,t,t)})})},n.prototype.getPosition=function(e){var t=e.transformable;return ir(t.position,this.getWorldTransform(e,t))},n.prototype.getRotation=function(e){var t=e.transformable;return An(t.rotation,this.getWorldTransform(e,t))},n.prototype.getScale=function(e){var t=e.transformable;return Ye(t.scaling,this.getWorldTransform(e,t))},n.prototype.getWorldTransform=function(e,t){return t===void 0&&(t=e.transformable),!t.localDirtyFlag&&!t.dirtyFlag||(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.sync(e,t)),t.worldTransform},n.prototype.getLocalPosition=function(e){return e.transformable.localPosition},n.prototype.getLocalRotation=function(e){return e.transformable.localRotation},n.prototype.getLocalScale=function(e){return e.transformable.localScale},n.prototype.getLocalSkew=function(e){return e.transformable.localSkew},n.prototype.getLocalTransform=function(e){var t=e.transformable;return t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.localTransform},n.prototype.setLocalTransform=function(e,t){var r=ir(T.Ue(),t),i=An(Vt(),t),a=Ye(T.Ue(),t);this.setLocalScale(e,a,!1),this.setLocalPosition(e,r,!1),this.setLocalRotation(e,i,void 0,void 0,void 0,!1),this.dirtifyLocal(e,e.transformable)},n.prototype.resetLocalTransform=function(e){this.setLocalScale(e,[1,1,1]),this.setLocalPosition(e,[0,0,0]),this.setLocalEulerAngles(e,[0,0,0]),this.setLocalSkew(e,[0,0])},n.prototype.getTransformedGeometryBounds=function(e,t,r){t===void 0&&(t=!1);var i=this.getGeometryBounds(e,t);if(Fe.isEmpty(i))return null;var a=r||new Fe;return a.setFromTransformedAABB(i,this.getWorldTransform(e)),a},n.prototype.getGeometryBounds=function(e,t){t===void 0&&(t=!1);var r=e.geometry;r.dirty&&nt.styleValueRegistry.updateGeometry(e);var i=t?r.renderBounds:r.contentBounds||null;return i||new Fe},n.prototype.getBounds=function(e,t){var r=this;t===void 0&&(t=!1);var i=e.renderable;if(!i.boundsDirty&&!t&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&t&&i.renderBounds)return i.renderBounds;var a=t?i.renderBounds:i.bounds,o=this.getTransformedGeometryBounds(e,t,a),s=e.childNodes;if(s.forEach(function(u){var h=r.getBounds(u,t);h&&(o?o.add(h):(o=a||new Fe,o.update(h.center,h.halfExtents)))}),o||(o=new Fe),t){var l=Ry(e);if(l){var c=l.parsedStyle.clipPath.getBounds(t);o?c&&(o=c.intersection(o)):o.update(c.center,c.halfExtents)}}return t?(i.renderBounds=o,i.renderBoundsDirty=!1):(i.bounds=o,i.boundsDirty=!1),o},n.prototype.getLocalBounds=function(e){if(e.parentNode){var t=Q();e.parentNode.transformable&&(t=Wt(Q(),this.getWorldTransform(e.parentNode)));var r=this.getBounds(e);if(!Fe.isEmpty(r)){var i=new Fe;return i.setFromTransformedAABB(r,t),i}}return this.getBounds(e)},n.prototype.getBoundingClientRect=function(e){var t,r,i,a=this.getGeometryBounds(e);Fe.isEmpty(a)||(i=new Fe,i.setFromTransformedAABB(a,this.getWorldTransform(e)));var o=(r=(t=e.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect();if(i){var s=C(i.getMin(),2),l=s[0],c=s[1],u=C(i.getMax(),2),h=u[0],f=u[1];return new Ua(l+((o==null?void 0:o.left)||0),c+((o==null?void 0:o.top)||0),h-l,f-c)}return new Ua((o==null?void 0:o.left)||0,(o==null?void 0:o.top)||0,0,0)},n.prototype.dirtifyWorldInternal=function(e,t){var r=this;if(!t.dirtyFlag){t.dirtyFlag=!0,t.frozen=!1,e.childNodes.forEach(function(a){var o=a.transformable;o.dirtyFlag||r.dirtifyWorldInternal(a,o)});var i=e.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0)}},n.prototype.syncHierarchy=function(e){var t=e.transformable;if(!t.frozen){t.frozen=!0,(t.localDirtyFlag||t.dirtyFlag)&&this.sync(e,t);for(var r=e.childNodes,i=0;i<r.length;i++)this.syncHierarchy(r[i])}},n.prototype.sync=function(e,t){if(t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.dirtyFlag){var r=e.parentNode,i=r&&r.transformable;r===null||!i?kt(t.worldTransform,t.localTransform):Ut(t.worldTransform,i.worldTransform,t.localTransform),t.dirtyFlag=!1}},n.prototype.unfreezeParentToRoot=function(e){for(var t=e.parentNode;t;){var r=t.transformable;r&&(r.frozen=!1),t=t.parentNode}},n}(),Io={MetricsString:"|\xC9q\xC5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},Hy=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,lC=/[!%),.:;?\]}'""]/,cC=/[$('"]/,uC=/[!),.:;?\]}'""]/,hC=/[([{'"]/,fC=/[)\]'"?!:;,.]/,dC=/[(['"...]/,pC=/[!%),.:;?\]}'"]/,vC=/[$([{'"#]/,gC=new RegExp("".concat(lC.source,"|").concat(uC.source,"|").concat(fC.source,"|").concat(pC.source)),mC=new RegExp("".concat(cC.source,"|").concat(hC.source,"|").concat(dC.source,"|").concat(vC.source)),yC=function(){function n(e){var t=this;this.runtime=e,this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(r,i){return t.isBreakingSpace(i)?!1:!!(r&&(mC.exec(i)||gC.exec(r)))},this.trimByKinsokuShorui=function(r){var i=K([],C(r),!1),a=i[i.length-2];if(!a)return r;var o=a[a.length-1];return i[i.length-2]=a.slice(0,-1),i[i.length-1]=o+i[i.length-1],i}}return n.prototype.measureFont=function(e,t){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var r={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(t),a=this.runtime.offscreenCanvasCreator.getOrCreateContext(t,{willReadFrequently:!0});a.font=e;var o=Io.MetricsString+Io.BaselineSymbol,s=Math.ceil(a.measureText(o).width),l=Math.ceil(a.measureText(Io.BaselineSymbol).width),c=Io.HeightMultiplier*l;l=l*Io.BaselineMultiplier|0,i.width=s,i.height=c,a.fillStyle="#f00",a.fillRect(0,0,s,c),a.font=e,a.textBaseline="alphabetic",a.fillStyle="#000",a.fillText(o,0,l);var u=a.getImageData(0,0,s||1,c||1).data,h=u.length,f=s*4,d=0,p=0,v=!1;for(d=0;d<l;++d){for(var g=0;g<f;g+=4)if(u[p+g]!==255){v=!0;break}if(!v)p+=f;else break}for(r.ascent=l-d,p=h-f,v=!1,d=c;d>l;--d){for(var g=0;g<f;g+=4)if(u[p+g]!==255){v=!0;break}if(!v)p-=f;else break}return r.descent=d-l,r.fontSize=r.ascent+r.descent,this.fontMetricsCache[e]=r,r},n.prototype.measureText=function(e,t,r){var i=t.fontSize,a=i===void 0?16:i,o=t.wordWrap,s=o===void 0?!1:o,l=t.lineHeight,c=t.lineWidth,u=c===void 0?1:c,h=t.textBaseline,f=h===void 0?"alphabetic":h,d=t.textAlign,p=d===void 0?"start":d,v=t.letterSpacing,g=v===void 0?0:v,m=t.textPath;t.textPathSide,t.textPathStartOffset;var x=t.leading,_=x===void 0?0:x,S=zM(t),b=this.measureFont(S,r);b.fontSize===0&&(b.fontSize=a,b.ascent=a);var y=this.runtime.offscreenCanvasCreator.getOrCreateContext(r);y.font=S,t.isOverflowing=!1;var E=s?this.wordWrap(e,t,r):e,w=E.split(/(?:\r\n|\r|\n)/),M=new Array(w.length),P=0;if(m){m.getTotalLength();for(var A=0;A<w.length;A++)var O=y.measureText(w[A]).width+(w[A].length-1)*g}else{for(var A=0;A<w.length;A++){var R=y.measureText(w[A]).width+(w[A].length-1)*g;M[A]=R,P=Math.max(P,R)}var O=P+u,L=l||b.fontSize+u,z=Math.max(L,b.fontSize+u)+(w.length-1)*(L+_);L+=_;var Y=0;return f==="middle"?Y=-z/2:f==="bottom"||f==="alphabetic"||f==="ideographic"?Y=-z:(f==="top"||f==="hanging")&&(Y=0),{font:S,width:O,height:z,lines:w,lineWidths:M,lineHeight:L,maxLineWidth:P,fontProperties:b,lineMetrics:M.map(function(Z,J){var mt=0;return p==="center"||p==="middle"?mt-=Z/2:(p==="right"||p==="end")&&(mt-=Z),new Ua(mt-u/2,Y+J*L,Z+u,L)})}}},n.prototype.setGraphemeOnPath=function(){},n.prototype.wordWrap=function(e,t,r){var i=this,a=t.wordWrapWidth,o=a===void 0?0:a,s=t.letterSpacing,l=s===void 0?0:s,c=t.maxLines,u=c===void 0?1/0:c,h=t.textOverflow,f=this.runtime.offscreenCanvasCreator.getOrCreateContext(r),d=o+l,p="";h==="ellipsis"?p="...":h&&h!=="clip"&&(p=h);for(var v=[],g=0,m=0,x={},_=function(Y){return i.getFromCache(Y,l,x,f)},S=Array.from(p).reduce(function(Y,I){return Y+_(I)},0),b=Array.from(e),y=0;y<b.length;y++){var E=b[y],w=e[y-1],M=e[y+1],P=_(E);if(this.isNewline(E)){if(g++,g>=u){t.isOverflowing=!0;break}m=0,v[g]="";continue}if(m>0&&m+P>d){if(g+1>=u){if(t.isOverflowing=!0,S>0&&S<=d){for(var A=v[g].length,O=0,R=A,L=0;L<A;L++){var z=_(v[g][L]);if(O+z+S>d){R=L;break}O+=z}v[g]=(v[g]||"").slice(0,R)+p}break}if(g++,m=0,v[g]="",this.isBreakingSpace(E))continue;this.canBreakInLastChar(E)||(v=this.trimToBreakable(v),m=this.sumTextWidthByCache(v[g]||"",x)),this.shouldBreakByKinsokuShorui(E,M)&&(v=this.trimByKinsokuShorui(v),m+=_(w||""))}m+=P,v[g]=(v[g]||"")+E}return v.join(`
`)},n.prototype.isBreakingSpace=function(e){return typeof e!="string"?!1:Io.BreakingSpaces.indexOf(e.charCodeAt(0))>=0},n.prototype.isNewline=function(e){return typeof e!="string"?!1:Io.Newlines.indexOf(e.charCodeAt(0))>=0},n.prototype.trimToBreakable=function(e){var t=K([],C(e),!1),r=t[t.length-2],i=this.findBreakableIndex(r);if(i===-1||!r)return t;var a=r.slice(i,i+1),o=this.isBreakingSpace(a),s=i+1,l=i+(o?0:1);return t[t.length-1]+=r.slice(s,r.length),t[t.length-2]=r.slice(0,l),t},n.prototype.canBreakInLastChar=function(e){return!(e&&Hy.test(e))},n.prototype.sumTextWidthByCache=function(e,t){return e.split("").reduce(function(r,i){if(!t[i])throw Error("cannot count the word without cache");return r+t[i]},0)},n.prototype.findBreakableIndex=function(e){for(var t=e.length-1;t>=0;t--)if(!Hy.test(e[t]))return t;return-1},n.prototype.getFromCache=function(e,t,r,i){var a=r[e];if(typeof a!="number"){var o=e.length*t;a=i.measureText(e).width+o,r[e]=a}return a},n}(),nt={},xC=function(){var n,e=new ZM,t=new KM;return n={},n[ct.CIRCLE]=new YM,n[ct.ELLIPSE]=new XM,n[ct.RECT]=e,n[ct.IMAGE]=e,n[ct.GROUP]=new JM,n[ct.LINE]=new jM,n[ct.TEXT]=new qM(nt),n[ct.POLYLINE]=t,n[ct.POLYGON]=t,n[ct.PATH]=new $M,n[ct.HTML]=null,n[ct.MESH]=null,n}(),bC=function(){var n,e=new aM,t=new Jd;return n={},n[Et.PERCENTAGE]=null,n[Et.NUMBER]=new uM,n[Et.ANGLE]=new rM,n[Et.DEFINED_PATH]=new iM,n[Et.PAINT]=e,n[Et.COLOR]=e,n[Et.FILTER]=new oM,n[Et.LENGTH]=t,n[Et.LENGTH_PERCENTAGE]=t,n[Et.LENGTH_PERCENTAGE_12]=new sM,n[Et.LENGTH_PERCENTAGE_14]=new lM,n[Et.COORDINATE]=new Jd,n[Et.OFFSET_DISTANCE]=new hM,n[Et.OPACITY_VALUE]=new fM,n[Et.PATH]=new dM,n[Et.LIST_OF_POINTS]=new pM,n[Et.SHADOW_BLUR]=new vM,n[Et.TEXT]=new gM,n[Et.TEXT_TRANSFORM]=new mM,n[Et.TRANSFORM]=new UM,n[Et.TRANSFORM_ORIGIN]=new VM,n[Et.Z_INDEX]=new HM,n[Et.MARKER]=new cM,n}(),EC=function(){return typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:{}};nt.CameraContribution=ry,nt.AnimationTimeline=null,nt.EasingFunction=null,nt.offscreenCanvasCreator=new nC,nt.sceneGraphSelector=new aC,nt.sceneGraphService=new sC(nt),nt.textService=new yC(nt),nt.geometryUpdaterFactory=xC,nt.CSSPropertySyntaxFactory=bC,nt.styleValueRegistry=new nM(nt),nt.layoutRegistry=null,nt.globalThis=EC(),nt.enableCSSParsing=!1,nt.enableDataset=!1,nt.enableStyleSyntax=!0,nt.enableAttributeDashCased=!1,nt.enableSizeAttenuation=!1;var Yy=0;function nU(){Yy=0}var Xy=new Ya(oe.INSERTED,null,"","","",0,"",""),jy=new Ya(oe.REMOVED,null,"","","",0,"",""),wC=new or(oe.DESTROY),_C=function(n){B(e,n);function e(){var t=n.call(this)||this;return t.entity=Yy++,t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.cullable={strategy:Gd.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle=nt.enableCSSParsing?{opacity:$e,fillOpacity:$e,strokeOpacity:$e,fill:$e,stroke:$e,transform:$e,transformOrigin:$e,visibility:$e,pointerEvents:$e,lineWidth:$e,lineCap:$e,lineJoin:$e,increasedLineWidthForHitTesting:$e,fontSize:$e,fontFamily:$e,fontStyle:$e,fontWeight:$e,fontVariant:$e,textAlign:$e,textBaseline:$e,textTransform:$e,zIndex:$e,filter:$e,shadowType:$e}:null,t.parsedStyle={},t.attributes={},t}return Object.defineProperty(e.prototype,"className",{get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"classList",{get:function(){return this.className.split(" ").filter(function(t){return t!==""})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagName",{get:function(){return this.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(t){throw new Error(Ne)},e.prototype.appendChild=function(t,r){var i;if(t.destroyed)throw new Error(ZT);return nt.sceneGraphService.attach(t,this,r),!((i=this.ownerDocument)===null||i===void 0)&&i.defaultView&&this.ownerDocument.defaultView.mountChildren(t),this.isMutationObserved&&(Xy.relatedNode=this,t.dispatchEvent(Xy)),t},e.prototype.insertBefore=function(t,r){if(!r)this.appendChild(t);else{t.parentElement&&t.parentElement.removeChild(t);var i=this.childNodes.indexOf(r);i===-1?this.appendChild(t):this.appendChild(t,i)}return t},e.prototype.replaceChild=function(t,r){var i=this.childNodes.indexOf(r);return this.removeChild(r),this.appendChild(t,i),r},e.prototype.removeChild=function(t){var r;return jy.relatedNode=this,t.dispatchEvent(jy),!((r=t.ownerDocument)===null||r===void 0)&&r.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),nt.sceneGraphService.detach(t),t},e.prototype.removeChildren=function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];this.removeChild(r)}},e.prototype.destroyChildren=function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];r.childNodes.length&&r.destroyChildren(),r.destroy()}},e.prototype.matches=function(t){return nt.sceneGraphService.matches(t,this)},e.prototype.getElementById=function(t){return nt.sceneGraphService.querySelector("#".concat(t),this)},e.prototype.getElementsByName=function(t){return nt.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)},e.prototype.getElementsByClassName=function(t){return nt.sceneGraphService.querySelectorAll(".".concat(t),this)},e.prototype.getElementsByTagName=function(t){return nt.sceneGraphService.querySelectorAll(t,this)},e.prototype.querySelector=function(t){return nt.sceneGraphService.querySelector(t,this)},e.prototype.querySelectorAll=function(t){return nt.sceneGraphService.querySelectorAll(t,this)},e.prototype.closest=function(t){var r=this;do{if(nt.sceneGraphService.matches(t,r))return r;r=r.parentElement}while(r!==null);return null},e.prototype.find=function(t){var r=this,i=null;return this.forEach(function(a){return a!==r&&t(a)?(i=a,!0):!1}),i},e.prototype.findAll=function(t){var r=this,i=[];return this.forEach(function(a){a!==r&&t(a)&&i.push(a)}),i},e.prototype.after=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this);r.forEach(function(o,s){var l;return(l=t.parentNode)===null||l===void 0?void 0:l.appendChild(o,a+s+1)})}},e.prototype.before=function(){for(var t,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this),o=C(r),s=o[0],l=o.slice(1);this.parentNode.appendChild(s,a),(t=s).after.apply(t,K([],C(l),!1))}},e.prototype.replaceWith=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.after.apply(this,K([],C(t),!1)),this.remove()},e.prototype.append=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(a){return t.appendChild(a)})},e.prototype.prepend=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(a,o){return t.appendChild(a,o)})},e.prototype.replaceChildren=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,K([],C(t),!1))},e.prototype.remove=function(){return this.parentNode?this.parentNode.removeChild(this):this},e.prototype.destroy=function(){this.dispatchEvent(wC),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0},e.prototype.getGeometryBounds=function(){return nt.sceneGraphService.getGeometryBounds(this)},e.prototype.getRenderBounds=function(){return nt.sceneGraphService.getBounds(this,!0)},e.prototype.getBounds=function(){return nt.sceneGraphService.getBounds(this)},e.prototype.getLocalBounds=function(){return nt.sceneGraphService.getLocalBounds(this)},e.prototype.getBoundingClientRect=function(){return nt.sceneGraphService.getBoundingClientRect(this)},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},e.prototype.getAttributeNames=function(){return Object.keys(this.attributes)},e.prototype.getAttribute=function(t){if(aP(t))return nt.enableCSSParsing?null:void 0;var r=this.attributes[t];if(r===void 0){if(nt.enableAttributeDashCased){var i=Ld(t);r=this.attributes[i]}return nt.enableCSSParsing&&Mt(r)?null:r}else return r},e.prototype.hasAttribute=function(t){return this.getAttributeNames().includes(t)},e.prototype.hasAttributes=function(){return!!this.getAttributeNames().length},e.prototype.removeAttribute=function(t){this.setAttribute(t,null),delete this.attributes[t]},e.prototype.setAttribute=function(t,r,i,a){this.attributes[t]=r},e.prototype.getAttributeNS=function(t,r){throw new Error(Ne)},e.prototype.getAttributeNode=function(t){throw new Error(Ne)},e.prototype.getAttributeNodeNS=function(t,r){throw new Error(Ne)},e.prototype.hasAttributeNS=function(t,r){throw new Error(Ne)},e.prototype.removeAttributeNS=function(t,r){throw new Error(Ne)},e.prototype.removeAttributeNode=function(t){throw new Error(Ne)},e.prototype.setAttributeNS=function(t,r,i){throw new Error(Ne)},e.prototype.setAttributeNode=function(t){throw new Error(Ne)},e.prototype.setAttributeNodeNS=function(t){throw new Error(Ne)},e.prototype.toggleAttribute=function(t,r){throw new Error(Ne)},e}(zn);function ye(n){return!!(n!=null&&n.nodeName)}var $y=nt.globalThis.Proxy?nt.globalThis.Proxy:function(){},ba=new Ya(oe.ATTR_MODIFIED,null,null,null,null,Ya.MODIFICATION,null,null),SC={opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",zIndex:"",filter:"",shadowType:""},TC={fill:eu,stroke:eu,transform:[],zIndex:0,filter:[],shadowType:"outer",miterLimit:10},PC=["opacity","fillOpacity","strokeOpacity","transformOrigin","visibility","pointerEvents","lineWidth","lineCap","lineJoin","increasedLineWidthForHitTesting"],MC=K(K([],C(PC),!1),["fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform"],!1),Ky="data-",ii=function(n){B(e,n);function e(t){var r=n.call(this)||this;return r.isCustomElement=!1,r.isMutationObserved=!1,r.activeAnimations=[],r.config=t,r.id=r.config.id||"",r.name=r.config.name||"",(r.config.className||r.config.class)&&(r.className=r.config.className||r.config.class),r.nodeName=r.config.type||ct.GROUP,nt.enableCSSParsing?(Object.assign(r.attributes,SC),Object.assign(r.parsedStyle,TC,r.config.initialParsedStyle)):r.config.initialParsedStyle&&Object.assign(r.parsedStyle,r.config.initialParsedStyle),r.initAttributes(r.config.style),nt.enableDataset&&(r.dataset=new $y({},{get:function(i,a){var o="".concat(Ky).concat(oy(a));return i[o]!==void 0?i[o]:r.getAttribute(o)},set:function(i,a,o){return r.setAttribute("".concat(Ky).concat(oy(a)),o),!0}})),nt.enableStyleSyntax&&(r.style=new $y({setProperty:function(i,a){r.setAttribute(i,a)},getPropertyValue:function(i){return r.getAttribute(i)},removeProperty:function(i){r.removeAttribute(i)},item:function(){return""}},{get:function(i,a){return i[a]!==void 0?i[a]:r.getAttribute(a)},set:function(i,a,o){return r.setAttribute(a,o),!0}})),r}return e.prototype.destroy=function(){n.prototype.destroy.call(this),this.getAnimations().forEach(function(t){t.cancel()})},e.prototype.cloneNode=function(t,r){var i=N({},this.attributes);for(var a in i){var o=i[a];ye(o)&&a!=="clipPath"&&a!=="offsetPath"&&a!=="textPath"&&(i[a]=o.cloneNode(t)),r&&(i[a]=r(a,o))}var s=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:i});return s.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(l){if(!l.style.isMarker){var c=l.cloneNode(t);s.appendChild(c)}}),s},e.prototype.initAttributes=function(t){t===void 0&&(t={});var r=this.renderable,i={forceUpdateGeometry:!0};nt.enableCSSParsing&&(i.usedAttributes=MC);var a=t;if(nt.enableAttributeDashCased){a={};for(var o in t){var s=Ld(o);a[s]=t[o]}}nt.styleValueRegistry.processProperties(this,a,i),r.dirty=!0},e.prototype.setAttribute=function(t,r,i,a){i===void 0&&(i=!1),a===void 0&&(a=!0),nt.enableAttributeDashCased&&(t=Ld(t)),!Nt(r)&&(i||r!==this.attributes[t])&&(this.internalSetAttribute(t,r,{memoize:a}),n.prototype.setAttribute.call(this,t,r))},e.prototype.internalSetAttribute=function(t,r,i){var a;i===void 0&&(i={});var o=this.renderable,s=this.attributes[t],l=this.parsedStyle[t];nt.styleValueRegistry.processProperties(this,(a={},a[t]=r,a),i),o.dirty=!0;var c=this.parsedStyle[t];this.isConnected&&(ba.relatedNode=this,ba.prevValue=s,ba.newValue=r,ba.attrName=t,ba.prevParsedValue=l,ba.newParsedValue=c,this.isMutationObserved?this.dispatchEvent(ba):(ba.target=this,this.ownerDocument.defaultView.dispatchEvent(ba,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&this.attributeChangedCallback&&this.attributeChangedCallback(t,s,r,l,c)},e.prototype.getBBox=function(){var t=this.getBounds(),r=C(t.getMin(),2),i=r[0],a=r[1],o=C(t.getMax(),2),s=o[0],l=o[1];return new Ua(i,a,s-i,l-a)},e.prototype.setOrigin=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),nt.sceneGraphService.setOrigin(this,br(t,r,i)),this},e.prototype.getOrigin=function(){return nt.sceneGraphService.getOrigin(this)},e.prototype.setPosition=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),nt.sceneGraphService.setPosition(this,br(t,r,i)),this},e.prototype.setLocalPosition=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),nt.sceneGraphService.setLocalPosition(this,br(t,r,i)),this},e.prototype.translate=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),nt.sceneGraphService.translate(this,br(t,r,i)),this},e.prototype.translateLocal=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),nt.sceneGraphService.translateLocal(this,br(t,r,i)),this},e.prototype.getPosition=function(){return nt.sceneGraphService.getPosition(this)},e.prototype.getLocalPosition=function(){return nt.sceneGraphService.getLocalPosition(this)},e.prototype.scale=function(t,r,i){return this.scaleLocal(t,r,i)},e.prototype.scaleLocal=function(t,r,i){return typeof t=="number"&&(r=r||t,i=i||t,t=br(t,r,i)),nt.sceneGraphService.scaleLocal(this,t),this},e.prototype.setLocalScale=function(t,r,i){return typeof t=="number"&&(r=r||t,i=i||t,t=br(t,r,i)),nt.sceneGraphService.setLocalScale(this,t),this},e.prototype.getLocalScale=function(){return nt.sceneGraphService.getLocalScale(this)},e.prototype.getScale=function(){return nt.sceneGraphService.getScale(this)},e.prototype.getEulerAngles=function(){var t=C(Ad(T.Ue(),nt.sceneGraphService.getWorldTransform(this)),3),r=t[2];return wi(r)},e.prototype.getLocalEulerAngles=function(){var t=C(Ad(T.Ue(),nt.sceneGraphService.getLocalRotation(this)),3),r=t[2];return wi(r)},e.prototype.setEulerAngles=function(t){return nt.sceneGraphService.setEulerAngles(this,0,0,t),this},e.prototype.setLocalEulerAngles=function(t){return nt.sceneGraphService.setLocalEulerAngles(this,0,0,t),this},e.prototype.rotateLocal=function(t,r,i){return Mt(r)&&Mt(i)?nt.sceneGraphService.rotateLocal(this,0,0,t):nt.sceneGraphService.rotateLocal(this,t,r,i),this},e.prototype.rotate=function(t,r,i){return Mt(r)&&Mt(i)?nt.sceneGraphService.rotate(this,0,0,t):nt.sceneGraphService.rotate(this,t,r,i),this},e.prototype.setRotation=function(t,r,i,a){return nt.sceneGraphService.setRotation(this,t,r,i,a),this},e.prototype.setLocalRotation=function(t,r,i,a){return nt.sceneGraphService.setLocalRotation(this,t,r,i,a),this},e.prototype.setLocalSkew=function(t,r){return nt.sceneGraphService.setLocalSkew(this,t,r),this},e.prototype.getRotation=function(){return nt.sceneGraphService.getRotation(this)},e.prototype.getLocalRotation=function(){return nt.sceneGraphService.getLocalRotation(this)},e.prototype.getLocalSkew=function(){return nt.sceneGraphService.getLocalSkew(this)},e.prototype.getLocalTransform=function(){return nt.sceneGraphService.getLocalTransform(this)},e.prototype.getWorldTransform=function(){return nt.sceneGraphService.getWorldTransform(this)},e.prototype.setLocalTransform=function(t){return nt.sceneGraphService.setLocalTransform(this,t),this},e.prototype.resetLocalTransform=function(){nt.sceneGraphService.resetLocalTransform(this)},e.prototype.getAnimations=function(){return this.activeAnimations},e.prototype.animate=function(t,r){var i,a=(i=this.ownerDocument)===null||i===void 0?void 0:i.timeline;return a?a.play(this,t,r):null},e.prototype.isVisible=function(){var t,r;return nt.enableCSSParsing?((t=this.parsedStyle)===null||t===void 0?void 0:t.visibility)==="visible":((r=this.parsedStyle)===null||r===void 0?void 0:r.visibility)!=="hidden"},Object.defineProperty(e.prototype,"interactive",{get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"},enumerable:!1,configurable:!0}),e.prototype.isInteractive=function(){var t;return((t=this.parsedStyle)===null||t===void 0?void 0:t.pointerEvents)!=="none"},e.prototype.isCulled=function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)},e.prototype.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,K([],C(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})),!1))+1),this},e.prototype.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,K([],C(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})),!1))-1),this},e.prototype.getConfig=function(){return this.config},e.prototype.attr=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=C(r,2),o=a[0],s=a[1];return o?dn(o)?(Object.keys(o).forEach(function(l){t.setAttribute(l,o[l])}),this):r.length===2?(this.setAttribute(o,s),this):this.attributes[o]:this.attributes},e.prototype.getMatrix=function(t){var r=t||this.getWorldTransform(),i=C(ir(T.Ue(),r),2),a=i[0],o=i[1],s=C(Ye(T.Ue(),r),2),l=s[0],c=s[1],u=An(Vt(),r),h=C(Ad(T.Ue(),u),3),f=h[0],d=h[2];return VT(f||d,a,o,l,c)},e.prototype.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},e.prototype.setMatrix=function(t){var r=C(Qm(t),5),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];this.setEulerAngles(l).setPosition(i,a).setLocalScale(o,s)},e.prototype.setLocalMatrix=function(t){var r=C(Qm(t),5),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];this.setLocalEulerAngles(l).setLocalPosition(i,a).setLocalScale(o,s)},e.prototype.show=function(){nt.enableCSSParsing?this.style.visibility="visible":this.forEach(function(t){t.style.visibility="visible"})},e.prototype.hide=function(){nt.enableCSSParsing?this.style.visibility="hidden":this.forEach(function(t){t.style.visibility="hidden"})},e.prototype.getCount=function(){return this.childElementCount},e.prototype.getParent=function(){return this.parentElement},e.prototype.getChildren=function(){return this.children},e.prototype.getFirst=function(){return this.firstElementChild},e.prototype.getLast=function(){return this.lastElementChild},e.prototype.getChildByIndex=function(t){return this.children[t]||null},e.prototype.add=function(t,r){return this.appendChild(t,r)},e.prototype.set=function(t,r){this.config[t]=r},e.prototype.get=function(t){return this.config[t]},e.prototype.moveTo=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(t,r,i),this},e.prototype.move=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(t,r,i),this},e.prototype.setZIndex=function(t){return this.style.zIndex=t,this},e}(_C),Rl=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:ct.CIRCLE},t))||this}return e}(ii),CC=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);return r=n.call(this,N({style:nt.enableCSSParsing?N({},i):N({},i)},a))||this,r.isCustomElement=!0,r}return e}(ii),ap=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:ct.ELLIPSE},t))||this}return e}(ii),kl=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:ct.GROUP},t))||this}return e}(ii),op=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);return r=n.call(this,N({type:ct.HTML,style:nt.enableCSSParsing?N({x:"",y:"",width:"auto",height:"auto",innerHTML:""},i):N({},i)},a))||this,r.cullable.enable=!1,r}return e.prototype.getDomElement=function(){return this.parsedStyle.$el},e.prototype.getBoundingClientRect=function(){if(this.parsedStyle.$el){var t=this.ownerDocument.defaultView.getCamera().getOrthoMatrix(),r=this.parsedStyle.$el.getBoundingClientRect();return Ua.applyTransform(r,Wt(Q(),t))}else{var i=this.parsedStyle,a=i.x,o=i.y,s=i.width,l=i.height;return new Ua(a,o,s,l)}},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.getBounds=function(){var t,r,i=this.getBoundingClientRect(),a=(r=(t=this.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect(),o=new Fe,s=i.left-((a==null?void 0:a.left)||0),l=i.top-((a==null?void 0:a.top)||0);return o.setMinMax([s,l,0],[s+i.width,l+i.height,0]),o},e.prototype.getLocalBounds=function(){if(this.parentNode){var t=Wt(Q(),this.parentNode.getWorldTransform()),r=this.getBounds();if(!Fe.isEmpty(r)){var i=new Fe;return i.setFromTransformedAABB(r,t),i}}return this.getBounds()},e}(ii),sp=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:ct.IMAGE},t))||this}return e}(ii),cu=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);r=n.call(this,N({type:ct.LINE,style:N({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},a))||this,r.markerStartAngle=0,r.markerEndAngle=0;var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd;return s&&ye(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),l&&ye(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="x1"||t==="y1"||t==="x2"||t==="y2"||t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&ye(a)&&(this.markerStartAngle=0,a.remove()),o&&ye(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"&&(a&&ye(a)&&(this.markerEndAngle=0,a.remove()),o&&ye(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1)))},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=r.x1,c=r.x2,u=r.y1,h=r.y2,f=t?i:a;if(!(!f||!ye(f))){var d=0,p,v,g,m,x,_;t?(g=l,m=u,p=c-l,v=h-u,x=o||0,_=this.markerStartAngle):(g=c,m=h,p=l-c,v=u-h,x=s||0,_=this.markerEndAngle),d=Math.atan2(v,p),f.setLocalEulerAngles(d*180/Math.PI+_),f.setLocalPosition(g+Math.cos(d)*x,m+Math.sin(d)*x)}},e.prototype.getPoint=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle,a=i.x1,o=i.y1,s=i.x2,l=i.y2,c=kr(a,o,s,l,t),u=c.x,h=c.y,f=T.fF(T.Ue(),T.al(u,h,0),r?this.getWorldTransform():this.getLocalTransform());return new Yn(f[0],f[1])},e.prototype.getPointAtLength=function(t,r){return r===void 0&&(r=!1),this.getPoint(t/this.getTotalLength(),r)},e.prototype.getTotalLength=function(){var t=this.parsedStyle,r=t.x1,i=t.y1,a=t.x2,o=t.y2;return ps(r,i,a,o)},e}(ii),Xa=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);r=n.call(this,N({type:ct.PATH,style:nt.enableCSSParsing?N({d:"",miterLimit:""},i):N({},i),initialParsedStyle:nt.enableCSSParsing?null:{miterLimit:4,d:N({},ly)}},a))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd,c=o.markerMid;return s&&ye(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),c&&ye(c)&&r.placeMarkerMid(c),l&&ye(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&ye(a)&&(this.markerStartAngle=0,a.remove()),o&&ye(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"?(a&&ye(a)&&(this.markerEndAngle=0,a.remove()),o&&ye(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(o)},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=t?i:a;if(!(!l||!ye(l))){var c=0,u,h,f,d,p,v;if(t){var g=C(this.getStartTangent(),2),m=g[0],x=g[1];f=x[0],d=x[1],u=m[0]-x[0],h=m[1]-x[1],p=o||0,v=this.markerStartAngle}else{var _=C(this.getEndTangent(),2),m=_[0],x=_[1];f=x[0],d=x[1],u=m[0]-x[0],h=m[1]-x[1],p=s||0,v=this.markerEndAngle}c=Math.atan2(h,u),l.setLocalEulerAngles(c*180/Math.PI+v),l.setLocalPosition(f+Math.cos(c)*p,d+Math.sin(c)*p)}},e.prototype.placeMarkerMid=function(t){var r=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(c){c.remove()}),t&&ye(t))for(var i=1;i<r.length-1;i++){var a=C(r[i].currentPoint,2),o=a[0],s=a[1],l=i===1?t:t.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(o,s)}},e.prototype.getTotalLength=function(){return Hd(this)},e.prototype.getPointAtLength=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle.d.absolutePath,a=Im(i,t),o=a.x,s=a.y,l=T.fF(T.Ue(),T.al(o,s,0),r?this.getWorldTransform():this.getLocalTransform());return new Yn(l[0],l[1])},e.prototype.getPoint=function(t,r){return r===void 0&&(r=!1),this.getPointAtLength(t*Hd(this),r)},e.prototype.getStartTangent=function(){var t=this.parsedStyle.d.segments,r=[];if(t.length>1){var i=t[0].currentPoint,a=t[1].currentPoint,o=t[1].startTangent;r=[],o?(r.push([i[0]-o[0],i[1]-o[1]]),r.push([i[0],i[1]])):(r.push([a[0],a[1]]),r.push([i[0],i[1]]))}return r},e.prototype.getEndTangent=function(){var t=this.parsedStyle.d.segments,r=t.length,i=[];if(r>1){var a=t[r-2].currentPoint,o=t[r-1].currentPoint,s=t[r-1].endTangent;i=[],s?(i.push([o[0]-s[0],o[1]-s[1]]),i.push([o[0],o[1]])):(i.push([a[0],a[1]]),i.push([o[0],o[1]]))}return i},e}(ii),uu=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);r=n.call(this,N({type:ct.POLYGON,style:nt.enableCSSParsing?N({points:"",miterLimit:"",isClosed:!0},i):N({},i),initialParsedStyle:nt.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},a))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd,c=o.markerMid;return s&&ye(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),c&&ye(c)&&r.placeMarkerMid(c),l&&ye(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&ye(a)&&(this.markerStartAngle=0,a.remove()),o&&ye(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"?(a&&ye(a)&&(this.markerEndAngle=0,a.remove()),o&&ye(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(o)},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=r.points,c=(l||{}).points,u=t?i:a;if(!(!u||!ye(u)||!c)){var h=0,f,d,p,v,g,m;if(p=c[0][0],v=c[0][1],t)f=c[1][0]-c[0][0],d=c[1][1]-c[0][1],g=o||0,m=this.markerStartAngle;else{var x=c.length;this.parsedStyle.isClosed?(f=c[x-1][0]-c[0][0],d=c[x-1][1]-c[0][1]):(p=c[x-1][0],v=c[x-1][1],f=c[x-2][0]-c[x-1][0],d=c[x-2][1]-c[x-1][1]),g=s||0,m=this.markerEndAngle}h=Math.atan2(d,f),u.setLocalEulerAngles(h*180/Math.PI+m),u.setLocalPosition(p+Math.cos(h)*g,v+Math.sin(h)*g)}},e.prototype.placeMarkerMid=function(t){var r=this.parsedStyle.points,i=(r||{}).points;if(this.markerMidList.forEach(function(c){c.remove()}),this.markerMidList=[],t&&ye(t)&&i)for(var a=1;a<(this.parsedStyle.isClosed?i.length:i.length-1);a++){var o=i[a][0],s=i[a][1],l=a===1?t:t.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(o,s)}},e}(ii),Zy=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=V(t,["style"]);return n.call(this,N({type:ct.POLYLINE,style:nt.enableCSSParsing?N({points:"",miterLimit:"",isClosed:!1},r):N({},r),initialParsedStyle:nt.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i))||this}return e.prototype.getTotalLength=function(){return NP(this)},e.prototype.getPointAtLength=function(t,r){return r===void 0&&(r=!1),this.getPoint(t/this.getTotalLength(),r)},e.prototype.getPoint=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var a=[],o=0,s,l,c=this.getTotalLength();i.forEach(function(g,m){i[m+1]&&(s=[0,0],s[0]=o/c,l=ps(g[0],g[1],i[m+1][0],i[m+1][1]),o+=l,s[1]=o/c,a.push(s))}),this.parsedStyle.points.segments=a}var u=0,h=0;this.parsedStyle.points.segments.forEach(function(g,m){t>=g[0]&&t<=g[1]&&(u=(t-g[0])/(g[1]-g[0]),h=m)});var f=kr(i[h][0],i[h][1],i[h+1][0],i[h+1][1],u),d=f.x,p=f.y,v=T.fF(T.Ue(),T.al(d,p,0),r?this.getWorldTransform():this.getLocalTransform());return new Yn(v[0],v[1])},e.prototype.getStartTangent=function(){var t=this.parsedStyle.points.points,r=[];return r.push([t[1][0],t[1][1]]),r.push([t[0][0],t[0][1]]),r},e.prototype.getEndTangent=function(){var t=this.parsedStyle.points.points,r=t.length-1,i=[];return i.push([t[r-1][0],t[r-1][1]]),i.push([t[r][0],t[r][1]]),i},e}(uu),ra=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:ct.RECT},t))||this}return e}(ii),Ll=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=V(t,["style"]);return n.call(this,N({type:ct.TEXT,style:nt.enableCSSParsing?N({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:"",lineHeight:"",miterLimit:"",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},r):N({fill:"black"},r)},i))||this}return e.prototype.getComputedTextLength=function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.maxLineWidth)||0},e.prototype.getLineBoundingRects=function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.lineMetrics)||[]},e.prototype.isOverflowing=function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing},e}(ii),AC=function(){function n(){this.registry={},this.define(ct.CIRCLE,Rl),this.define(ct.ELLIPSE,ap),this.define(ct.RECT,ra),this.define(ct.IMAGE,sp),this.define(ct.LINE,cu),this.define(ct.GROUP,kl),this.define(ct.PATH,Xa),this.define(ct.POLYGON,uu),this.define(ct.POLYLINE,Zy),this.define(ct.TEXT,Ll),this.define(ct.HTML,op)}return n.prototype.define=function(e,t){this.registry[e]=t},n.prototype.get=function(e){return this.registry[e]},n}(),rU={number:function(n){return new Re(n)},percent:function(n){return new Re(n,"%")},px:function(n){return new Re(n,"px")},em:function(n){return new Re(n,"em")},rem:function(n){return new Re(n,"rem")},deg:function(n){return new Re(n,"deg")},grad:function(n){return new Re(n,"grad")},rad:function(n){return new Re(n,"rad")},turn:function(n){return new Re(n,"turn")},s:function(n){return new Re(n,"s")},ms:function(n){return new Re(n,"ms")},registerProperty:function(n){var e=n.name,t=n.inherits,r=n.interpolable,i=n.initialValue,a=n.syntax;nt.styleValueRegistry.registerMetadata({n:e,inh:t,int:r,d:i,syntax:a})},registerLayout:function(n,e){nt.layoutRegistry.registerLayout(n,e)}},qy=function(n){B(e,n);function e(){var t=n.call(this)||this;t.defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new nt.AnimationTimeline(t)}catch(i){}var r={};return qd.forEach(function(i){var a=i.n,o=i.inh,s=i.d;o&&s&&(r[a]=xs(s)?s(ct.GROUP):s)}),t.documentElement=new kl({id:"g-root",style:r}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),e.prototype.createElement=function(t,r){if(t==="svg")return this.documentElement;var i=this.defaultView.customElements.get(t);i||(console.warn("Unsupported tagName: ",t),i=t==="tspan"?Ll:kl);var a=new i(r);return a.ownerDocument=this,a},e.prototype.createElementNS=function(t,r,i){return this.createElement(r,i)},e.prototype.cloneNode=function(t){throw new Error(Ne)},e.prototype.destroy=function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(t){}},e.prototype.elementsFromBBox=function(t,r,i,a){var o=this.defaultView.context.rBushRoot,s=o.search({minX:t,minY:r,maxX:i,maxY:a}),l=[];return s.forEach(function(c){var u=c.displayObject,h=u.parsedStyle.pointerEvents,f=h===void 0?"auto":h,d=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(f);(!d||d&&u.isVisible())&&!u.isCulled()&&u.isInteractive()&&l.push(u)}),l.sort(function(c,u){return u.sortable.renderOrder-c.sortable.renderOrder}),l},e.prototype.elementFromPointSync=function(t,r){var i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height;if(a<0||o<0||a>l||o>c)return null;var u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]}).picked;return d&&d[0]||this.documentElement},e.prototype.elementFromPoint=function(t,r){return j(this,void 0,void 0,function(){var i,a,o,s,l,c,u,h,f,d;return gt(this,function(p){switch(p.label){case 0:return i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height,a<0||o<0||a>l||o>c?[2,null]:(u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]})]);case 1:return d=p.sent().picked,[2,d&&d[0]||this.documentElement]}})})},e.prototype.elementsFromPointSync=function(t,r){var i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height;if(a<0||o<0||a>l||o>c)return[];var u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]}).picked;return d[d.length-1]!==this.documentElement&&d.push(this.documentElement),d},e.prototype.elementsFromPoint=function(t,r){return j(this,void 0,void 0,function(){var i,a,o,s,l,c,u,h,f,d;return gt(this,function(p){switch(p.label){case 0:return i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height,a<0||o<0||a>l||o>c?[2,[]]:(u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]})]);case 1:return d=p.sent().picked,d[d.length-1]!==this.documentElement&&d.push(this.documentElement),[2,d]}})})},e.prototype.appendChild=function(t,r){throw new Error(ys)},e.prototype.insertBefore=function(t,r){throw new Error(ys)},e.prototype.removeChild=function(t,r){throw new Error(ys)},e.prototype.replaceChild=function(t,r,i){throw new Error(ys)},e.prototype.append=function(){throw new Error(ys)},e.prototype.prepend=function(){throw new Error(ys)},e.prototype.getElementById=function(t){return this.documentElement.getElementById(t)},e.prototype.getElementsByName=function(t){return this.documentElement.getElementsByName(t)},e.prototype.getElementsByTagName=function(t){return this.documentElement.getElementsByTagName(t)},e.prototype.getElementsByClassName=function(t){return this.documentElement.getElementsByClassName(t)},e.prototype.querySelector=function(t){return this.documentElement.querySelector(t)},e.prototype.querySelectorAll=function(t){return this.documentElement.querySelectorAll(t)},e.prototype.find=function(t){return this.documentElement.find(t)},e.prototype.findAll=function(t){return this.documentElement.findAll(t)},e}(zn),OC=function(){function n(e){this.strategies=e}return n.prototype.apply=function(e){var t=e.camera,r=e.renderingService,i=e.renderingContext,a=this.strategies;r.hooks.cull.tap(n.tag,function(o){if(o){var s=o.cullable;return a.length===0?s.visible=i.unculledEntities.indexOf(o.entity)>-1:s.visible=a.every(function(l){return l.isVisible(t,o)}),!o.isCulled()&&o.isVisible()?o:(o.dispatchEvent(new or(oe.CULLED)),null)}return o}),r.hooks.afterRender.tap(n.tag,function(o){o.cullable.visibilityPlaneMask=-1})},n.tag="Culling",n}(),NC=function(){function n(){var e=this;this.autoPreventDefault=!1,this.rootPointerEvent=new lu(null),this.rootWheelEvent=new ip(null),this.onPointerMove=function(t){var r,i,a,o,s=(o=(a=e.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||o===void 0?void 0:o.defaultView;if(!(s.supportsTouchEvents&&t.pointerType==="touch")){var l=e.normalizeToPointerEvent(t,s);try{for(var c=pt(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=e.bootstrapEvent(e.rootPointerEvent,h,s,t);e.context.eventService.mapEvent(f)}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var r,i,a,o,s=(o=(a=e.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||o===void 0?void 0:o.defaultView,l=e.normalizeToPointerEvent(t,s);try{for(var c=pt(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=e.bootstrapEvent(e.rootPointerEvent,h,s,t);e.context.eventService.mapEvent(f)}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}}return n.prototype.apply=function(e){var t=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(a){var o=t.context.renderingService.hooks.pickSync.call({position:a,picked:[],topmost:!0}).picked;return o[0]||null}),r.hooks.pointerWheel.tap(n.tag,function(a){var o=t.normalizeWheelEvent(a);t.context.eventService.mapEvent(o)}),r.hooks.pointerDown.tap(n.tag,function(a){var o,s;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var l=t.normalizeToPointerEvent(a,i);if(t.autoPreventDefault&&l[0].isNormalized){var c=a.cancelable||!("cancelable"in a);c&&a.preventDefault()}try{for(var u=pt(l),h=u.next();!h.done;h=u.next()){var f=h.value,d=t.bootstrapEvent(t.rootPointerEvent,f,i,a);t.context.eventService.mapEvent(d)}}catch(p){o={error:p}}finally{try{h&&!h.done&&(s=u.return)&&s.call(u)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerUp.tap(n.tag,function(a){var o,s;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var l=t.context.contextService.getDomElement(),c=t.context.eventService.isNativeEventFromCanvas(l,a),u=c?"":"outside",h=t.normalizeToPointerEvent(a,i);try{for(var f=pt(h),d=f.next();!d.done;d=f.next()){var p=d.value,v=t.bootstrapEvent(t.rootPointerEvent,p,i,a);v.type+=u,t.context.eventService.mapEvent(v)}}catch(g){o={error:g}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerMove.tap(n.tag,this.onPointerMove),r.hooks.pointerOver.tap(n.tag,this.onPointerMove),r.hooks.pointerOut.tap(n.tag,this.onPointerMove),r.hooks.click.tap(n.tag,this.onClick),r.hooks.pointerCancel.tap(n.tag,function(a){var o,s,l=t.normalizeToPointerEvent(a,i);try{for(var c=pt(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=t.bootstrapEvent(t.rootPointerEvent,h,i,a);t.context.eventService.mapEvent(f)}}catch(d){o={error:d}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)})},n.prototype.bootstrapEvent=function(e,t,r,i){e.view=r,e.originalEvent=null,e.nativeEvent=i,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);var a=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),o=a.x,s=a.y;e.viewport.x=o,e.viewport.y=s;var l=this.context.eventService.viewport2Canvas(e.viewport),c=l.x,u=l.y;return e.canvas.x=c,e.canvas.y=u,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=i.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=PM[e.type]||e.type),e},n.prototype.normalizeWheelEvent=function(e){var t=this.rootWheelEvent;this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;var r=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),i=r.x,a=r.y;t.viewport.x=i,t.viewport.y=a;var o=this.context.eventService.viewport2Canvas(t.viewport),s=o.x,l=o.y;return t.canvas.x=s,t.canvas.y=l,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.nativeEvent=e,t.type=e.type,t},n.prototype.transferMouseData=function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=tp.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null},n.prototype.setCursor=function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default")},n.prototype.normalizeToPointerEvent=function(e,t){var r=[];if(t.isTouchEvent(e))for(var i=0;i<e.changedTouches.length;i++){var a=e.changedTouches[i];Nt(a.button)&&(a.button=0),Nt(a.buttons)&&(a.buttons=1),Nt(a.isPrimary)&&(a.isPrimary=e.touches.length===1&&e.type==="touchstart"),Nt(a.width)&&(a.width=a.radiusX||1),Nt(a.height)&&(a.height=a.radiusY||1),Nt(a.tiltX)&&(a.tiltX=0),Nt(a.tiltY)&&(a.tiltY=0),Nt(a.pointerType)&&(a.pointerType="touch"),Nt(a.pointerId)&&(a.pointerId=a.identifier||0),Nt(a.pressure)&&(a.pressure=a.force||.5),Nt(a.twist)&&(a.twist=0),Nt(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,a.type=e.type,r.push(a)}else if(t.isMouseEvent(e)){var o=e;Nt(o.isPrimary)&&(o.isPrimary=!0),Nt(o.width)&&(o.width=1),Nt(o.height)&&(o.height=1),Nt(o.tiltX)&&(o.tiltX=0),Nt(o.tiltY)&&(o.tiltY=0),Nt(o.pointerType)&&(o.pointerType="mouse"),Nt(o.pointerId)&&(o.pointerId=TM),Nt(o.pressure)&&(o.pressure=.5),Nt(o.twist)&&(o.twist=0),Nt(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,r.push(o)}else r.push(e);return r},n.tag="Event",n}(),RC=[ct.CIRCLE,ct.ELLIPSE,ct.IMAGE,ct.RECT,ct.LINE,ct.POLYLINE,ct.POLYGON,ct.TEXT,ct.PATH,ct.HTML],kC=function(){function n(){}return n.prototype.isVisible=function(e,t){var r,i,a=t.cullable;if(!a.enable)return!0;var o=t.getRenderBounds();if(Fe.isEmpty(o))return!1;var s=e.getFrustum(),l=(i=(r=t.parentNode)===null||r===void 0?void 0:r.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return a.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,o,l||Wa.INDETERMINATE,s.planes),a.visible=a.visibilityPlaneMask!==Wa.OUTSIDE,a.visible},n.prototype.computeVisibilityWithPlaneMask=function(e,t,r,i){if(r===Wa.OUTSIDE||r===Wa.INSIDE)return r;for(var a=Wa.INSIDE,o=RC.indexOf(e.nodeName)>-1,s=0,l=i.length;s<l;++s){var c=1<<s;if(r&c&&!(o&&(s===4||s===5))){var u=i[s],h=u.normal,f=u.distance;if(T.AK(h,t.getPositiveFarPoint(i[s]))+f<0)return Wa.OUTSIDE;T.AK(h,t.getNegativeFarPoint(i[s]))+f<0&&(a|=c)}}return a},n}(),LC=function(){function n(){this.toSync=new Set,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return n.prototype.apply=function(e){var t=this,r,i=e.renderingService,a=e.renderingContext,o=e.rBushRoot,s=a.root.ownerDocument.defaultView;this.rBush=o;var l=function(d){var p=d.target;p.renderable.dirty=!0,i.dirtify()},c=function(d){var p=d.detail.affectChildren,v=d.target;p&&v.forEach(function(m){t.toSync.add(m)});for(var g=v;g;)g.renderable&&t.toSync.add(g),g=g.parentElement;i.dirtify()},u=function(d){var p=d.target;nt.enableSizeAttenuation&&nt.styleValueRegistry.updateSizeAttenuation(p,s.getCamera().getZoom()),nt.enableCSSParsing&&nt.styleValueRegistry.recalc(p),nt.sceneGraphService.dirtifyToRoot(p),i.dirtify()},h=function(d){var p=d.target,v=p.rBushNode;v.aabb&&t.rBush.remove(v.aabb),t.toSync.delete(p),nt.sceneGraphService.dirtifyToRoot(p),i.dirtify()};i.hooks.init.tap(n.tag,function(){s.addEventListener(oe.MOUNTED,u),s.addEventListener(oe.UNMOUNTED,h),s.addEventListener(oe.ATTR_MODIFIED,l),s.addEventListener(oe.BOUNDS_CHANGED,c)}),i.hooks.destroy.tap(n.tag,function(){s.removeEventListener(oe.MOUNTED,u),s.removeEventListener(oe.UNMOUNTED,h),s.removeEventListener(oe.ATTR_MODIFIED,l),s.removeEventListener(oe.BOUNDS_CHANGED,c),t.toSync.clear()});var f=(r=nt.globalThis.requestIdleCallback)!==null&&r!==void 0?r:ep.bind(nt.globalThis);i.hooks.endFrame.tap(n.tag,function(){t.isFirstTimeRendering?(t.isFirstTimeRendering=!1,t.syncing=!0,f(function(){t.syncRTree(!0),t.isFirstTimeRenderingFinished=!0})):t.syncRTree()})},n.prototype.syncRTree=function(e){var t=this;if(e===void 0&&(e=!1),!(!e&&(this.syncing||this.toSync.size===0))){this.syncing=!0;var r=[];Array.from(this.toSync).filter(function(i){return i.isConnected}).forEach(function(i){var a=i.rBushNode;a&&a.aabb&&t.rBush.remove(a.aabb);var o=i.getRenderBounds();if(o){var s=i.renderable;e&&(s.dirtyRenderBounds||(s.dirtyRenderBounds=new Fe),s.dirtyRenderBounds.update(o.center,o.halfExtents));var l=C(o.getMin(),2),c=l[0],u=l[1],h=C(o.getMax(),2),f=h[0],d=h[1];a.aabb||(a.aabb={}),a.aabb.displayObject=i,a.aabb.minX=c,a.aabb.minY=u,a.aabb.maxX=f,a.aabb.maxY=d}a.aabb&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.minX)&&!isNaN(a.aabb.minY)&&r.push(a.aabb)}),this.rBush.load(r),r.length=0,this.toSync.clear(),this.syncing=!1}},n.tag="Prepare",n}();function iU(n){return!!n.document}var ai;(function(n){n.READY="ready",n.BEFORE_RENDER="beforerender",n.RERENDER="rerender",n.AFTER_RENDER="afterrender",n.BEFORE_DESTROY="beforedestroy",n.AFTER_DESTROY="afterdestroy",n.RESIZE="resize",n.DIRTY_RECTANGLE="dirtyrectangle",n.RENDERER_CHANGED="rendererchanged"})(ai||(ai={}));var Jy=500,IC=.1,DC=1e3,lp=new or(oe.MOUNTED),cp=new or(oe.UNMOUNTED),Qy=new or(ai.BEFORE_RENDER),BC=new or(ai.RERENDER),t1=new or(ai.AFTER_RENDER),hu=function(n){B(e,n);function e(t){var r=n.call(this)||this;r.Element=ii,r.inited=!1,r.context={},r.document=new qy,r.document.defaultView=r,r.customElements=new AC;var i=t.container,a=t.canvas,o=t.offscreenCanvas,s=t.width,l=t.height,c=t.devicePixelRatio,u=t.renderer,h=t.background,f=t.cursor,d=t.document,p=t.requestAnimationFrame,v=t.cancelAnimationFrame,g=t.createImage,m=t.supportsPointerEvents,x=t.supportsTouchEvents,_=t.supportsCSSTransform,S=t.supportsMutipleCanvasesInOneContainer,b=t.useNativeClickEvent,y=t.alwaysTriggerPointerEventOnCanvas,E=t.isTouchEvent,w=t.isMouseEvent,M=t.dblClickSpeed;S||xM(i,r);var P=s,A=l,O=c;return a&&(O=c||Al&&window.devicePixelRatio||1,O=O>=1?Math.ceil(O):1,P=s||_M(a)||a.width/O,A=l||SM(a)||a.height/O),o&&(nt.offscreenCanvas=o),r.devicePixelRatio=O,r.requestAnimationFrame=p!=null?p:ep.bind(nt.globalThis),r.cancelAnimationFrame=v!=null?v:Fy.bind(nt.globalThis),r.supportsTouchEvents=x!=null?x:"ontouchstart"in nt.globalThis,r.supportsPointerEvents=m!=null?m:!!nt.globalThis.PointerEvent,r.isTouchEvent=E!=null?E:function(R){return r.supportsTouchEvents&&R instanceof nt.globalThis.TouchEvent},r.isMouseEvent=w!=null?w:function(R){return!nt.globalThis.MouseEvent||R instanceof nt.globalThis.MouseEvent&&(!r.supportsPointerEvents||!(R instanceof nt.globalThis.PointerEvent))},r.dblClickSpeed=M!=null?M:200,r.initRenderingContext({container:i,canvas:a,width:P,height:A,renderer:u,offscreenCanvas:o,devicePixelRatio:O,cursor:f||"default",background:h||"transparent",createImage:g,document:d,supportsCSSTransform:_,useNativeClickEvent:b,alwaysTriggerPointerEventOnCanvas:y}),r.initDefaultCamera(P,A,u.clipSpaceNearZ),r.initRenderer(u,!0),r}return e.prototype.initRenderingContext=function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}},e.prototype.initDefaultCamera=function(t,r,i){var a=this,o=new nt.CameraContribution;o.clipSpaceNearZ=i,o.setType(we.EXPLORING,Pl.DEFAULT).setPosition(t/2,r/2,Jy).setFocalPoint(t/2,r/2,0).setOrthographic(t/-2,t/2,r/2,r/-2,IC,DC),o.canvas=this,o.eventEmitter.on(ey.UPDATED,function(){a.context.renderingContext.renderReasons.add(Lo.CAMERA_CHANGED),nt.enableSizeAttenuation&&a.getConfig().renderer.getConfig().enableSizeAttenuation&&a.updateSizeAttenuation()}),this.context.camera=o},e.prototype.updateSizeAttenuation=function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach(function(r){nt.styleValueRegistry.updateSizeAttenuation(r,t)})},e.prototype.getConfig=function(){return this.context.config},e.prototype.getRoot=function(){return this.document.documentElement},e.prototype.getCamera=function(){return this.context.camera},e.prototype.getContextService=function(){return this.context.contextService},e.prototype.getEventService=function(){return this.context.eventService},e.prototype.getRenderingService=function(){return this.context.renderingService},e.prototype.getRenderingContext=function(){return this.context.renderingContext},e.prototype.getStats=function(){return this.getRenderingService().getStats()},Object.defineProperty(e.prototype,"ready",{get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise(function(r){t.resolveReadyPromise=function(){r(t)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t,r){if(t===void 0&&(t=!0),r===void 0&&(r=!1),r||this.dispatchEvent(new or(ai.BEFORE_DESTROY)),this.frameId){var i=this.getConfig().cancelAnimationFrame||cancelAnimationFrame;i(this.frameId)}var a=this.getRoot();this.unmountChildren(a),t&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),t&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),r||this.dispatchEvent(new or(ai.AFTER_DESTROY))},e.prototype.changeSize=function(t,r){this.resize(t,r)},e.prototype.resize=function(t,r){var i=this.context.config;i.width=t,i.height=r,this.getContextService().resize(t,r);var a=this.context.camera,o=a.getProjectionMode();a.setPosition(t/2,r/2,Jy).setFocalPoint(t/2,r/2,0),o===Lr.ORTHOGRAPHIC?a.setOrthographic(t/-2,t/2,r/2,r/-2,a.getNear(),a.getFar()):a.setAspect(t/r),this.dispatchEvent(new or(ai.RESIZE,{width:t,height:r}))},e.prototype.appendChild=function(t,r){return this.document.documentElement.appendChild(t,r)},e.prototype.insertBefore=function(t,r){return this.document.documentElement.insertBefore(t,r)},e.prototype.removeChild=function(t){return this.document.documentElement.removeChild(t)},e.prototype.removeChildren=function(){this.document.documentElement.removeChildren()},e.prototype.destroyChildren=function(){this.document.documentElement.destroyChildren()},e.prototype.render=function(t){var r=this;t&&(Qy.detail=t,t1.detail=t),this.dispatchEvent(Qy);var i=this.getRenderingService();i.render(this.getConfig(),t,function(){r.dispatchEvent(BC)}),this.dispatchEvent(t1)},e.prototype.run=function(){var t=this,r=function(i,a){t.render(a),t.frameId=t.requestAnimationFrame(r)};r()},e.prototype.initRenderer=function(t,r){var i=this;if(r===void 0&&(r=!1),!t)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new DT,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new NC,new LC,new OC([new kC])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService(N(N({},nt),this.context)),this.context.renderingService=new rC(nt,this.context),this.context.eventService=new eC(nt,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,r,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(t,r)})},e.prototype.initRenderingService=function(t,r,i){var a=this;r===void 0&&(r=!1),i===void 0&&(i=!1),this.context.renderingService.init(function(){a.inited=!0,r?i?a.requestAnimationFrame(function(){a.dispatchEvent(new or(ai.READY))}):a.dispatchEvent(new or(ai.READY)):a.dispatchEvent(new or(ai.RENDERER_CHANGED)),a.readyPromise&&a.resolveReadyPromise(),r||a.getRoot().forEach(function(o){var s=o.renderable;s&&(s.renderBoundsDirty=!0,s.boundsDirty=!0,s.dirty=!0)}),a.mountChildren(a.getRoot()),t.getConfig().enableAutoRendering&&a.run()})},e.prototype.loadRendererContainerModule=function(t){var r=this,i=t.getPlugins();i.forEach(function(a){a.context=r.context,a.init(nt)})},e.prototype.setRenderer=function(t){var r=this.getConfig();if(r.renderer!==t){var i=r.renderer;r.renderer=t,this.destroy(!1,!0),K([],C(i==null?void 0:i.getPlugins()),!1).reverse().forEach(function(a){a.destroy(nt)}),this.initRenderer(t)}},e.prototype.setCursor=function(t){var r=this.getConfig();r.cursor=t,this.getContextService().applyCursorStyle(t)},e.prototype.unmountChildren=function(t){var r=this;t.childNodes.forEach(function(i){r.unmountChildren(i)}),this.inited&&(t.isMutationObserved?t.dispatchEvent(cp):(cp.target=t,this.dispatchEvent(cp,!0)),t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1),t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()},e.prototype.mountChildren=function(t){var r=this;this.inited?t.isConnected||(t.ownerDocument=this.document,t.isConnected=!0,t.isMutationObserved?t.dispatchEvent(lp):(lp.target=t,this.dispatchEvent(lp,!0))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName),t.childNodes.forEach(function(i){r.mountChildren(i)}),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()},e.prototype.client2Viewport=function(t){return this.getEventService().client2Viewport(t)},e.prototype.viewport2Client=function(t){return this.getEventService().viewport2Client(t)},e.prototype.viewport2Canvas=function(t){return this.getEventService().viewport2Canvas(t)},e.prototype.canvas2Viewport=function(t){return this.getEventService().canvas2Viewport(t)},e.prototype.getPointByClient=function(t,r){return this.client2Viewport({x:t,y:r})},e.prototype.getClientByPoint=function(t,r){return this.viewport2Client({x:t,y:r})},e}(Uy),FC=function(n){B(e,n);function e(){var t=n.apply(this,K([],C(arguments),!1))||this;return t.landmarks=[],t}return e.prototype.rotate=function(t,r,i){if(this.relElevation=ms(r),this.relAzimuth=ms(t),this.relRoll=ms(i),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===we.EXPLORING){var a=Bn(Vt(),[1,0,0],Oe((this.rotateWorld?1:-1)*this.relElevation)),o=Bn(Vt(),[0,1,0],Oe((this.rotateWorld?1:-1)*this.relAzimuth)),s=Bn(Vt(),[0,0,1],Oe(this.relRoll)),l=Ln(Vt(),o,a);l=Ln(Vt(),l,s);var c=Fa(Q(),l);Ee(this.matrix,this.matrix,[0,0,-this.distance]),Ut(this.matrix,this.matrix,c),Ee(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===we.ORBITING||this.type===we.EXPLORING?this._getPosition():this.type===we.TRACKING&&this._getFocalPoint(),this._update(),this},e.prototype.pan=function(t,r){var i=br(t,r,0),a=T.d9(this.position);return T.IH(a,a,T.bA(T.Ue(),this.right,i[0])),T.IH(a,a,T.bA(T.Ue(),this.up,i[1])),this._setPosition(a),this.triggerUpdate(),this},e.prototype.dolly=function(t){var r=this.forward,i=T.d9(this.position),a=t*this.dollyingStep,o=this.distance+t*this.dollyingStep;return a=Math.max(Math.min(o,this.maxDistance),this.minDistance)-this.distance,i[0]+=a*r[0],i[1]+=a*r[1],i[2]+=a*r[2],this._setPosition(i),this.type===we.ORBITING||this.type===we.EXPLORING?this._getDistance():this.type===we.TRACKING&&T.IH(this.focalPoint,i,this.distanceVector),this.triggerUpdate(),this},e.prototype.cancelLandmarkAnimation=function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)},e.prototype.createLandmark=function(t,r){var i,a,o,s;r===void 0&&(r={});var l=r.position,c=l===void 0?this.position:l,u=r.focalPoint,h=u===void 0?this.focalPoint:u,f=r.roll,d=r.zoom,p=new nt.CameraContribution;p.setType(this.type,void 0),p.setPosition(c[0],(i=c[1])!==null&&i!==void 0?i:this.position[1],(a=c[2])!==null&&a!==void 0?a:this.position[2]),p.setFocalPoint(h[0],(o=h[1])!==null&&o!==void 0?o:this.focalPoint[1],(s=h[2])!==null&&s!==void 0?s:this.focalPoint[2]),p.setRoll(f!=null?f:this.roll),p.setZoom(d!=null?d:this.zoom);var v={name:t,matrix:Ft(p.getWorldTransform()),right:T.d9(p.right),up:T.d9(p.up),forward:T.d9(p.forward),position:T.d9(p.getPosition()),focalPoint:T.d9(p.getFocalPoint()),distanceVector:T.d9(p.getDistanceVector()),distance:p.getDistance(),dollyingStep:p.getDollyingStep(),azimuth:p.getAzimuth(),elevation:p.getElevation(),roll:p.getRoll(),relAzimuth:p.relAzimuth,relElevation:p.relElevation,relRoll:p.relRoll,zoom:p.getZoom()};return this.landmarks.push(v),v},e.prototype.gotoLandmark=function(t,r){var i=this;r===void 0&&(r={});var a=ue(t)?this.landmarks.find(function(P){return P.name===t}):t;if(a){var o=fe(r)?{duration:r}:r,s=o.easing,l=s===void 0?"linear":s,c=o.duration,u=c===void 0?100:c,h=o.easingFunction,f=h===void 0?void 0:h,d=o.onfinish,p=d===void 0?void 0:d,v=o.onframe,g=v===void 0?void 0:v,m=.01;this.cancelLandmarkAnimation();var x=a.position,_=a.focalPoint,S=a.zoom,b=a.roll,y=f||nt.EasingFunction(l),E,w=function(){i.setFocalPoint(_),i.setPosition(x),i.setRoll(b),i.setZoom(S),i.computeMatrix(),i.triggerUpdate(),p==null||p()};if(u===0)return w();var M=function(P){E===void 0&&(E=P);var A=P-E;if(A>=u){w();return}var O=y(A/u),R=T.Ue(),L=T.Ue(),z=1,Y=0;T.t7(R,i.focalPoint,_,O),T.t7(L,i.position,x,O),Y=i.roll*(1-O)+b*O,z=i.zoom*(1-O)+S*O,i.setFocalPoint(R),i.setPosition(L),i.setRoll(Y),i.setZoom(z);var I=T.TK(R,_)+T.TK(L,x);if(I<=m&&S==null&&b==null)return w();i.computeMatrix(),i.triggerUpdate(),A<u&&(g==null||g(O),i.landmarkAnimationID=i.canvas.requestAnimationFrame(M))};this.canvas.requestAnimationFrame(M)}},e}(ry);nt.CameraContribution=FC;var e1=function(){function n(e,t){this.type=e,this.target=t,this.addedNodes=[],this.attributeName=null,this.attributeNamespace=null,this.nextSibling=null,this.oldValue=null,this.previousSibling=null,this.removedNodes=[]}return n.copy=function(e){var t=new n(e.type,e.target);return t.addedNodes=e.addedNodes.slice(),t.removedNodes=e.removedNodes.slice(),t.previousSibling=e.previousSibling,t.nextSibling=e.nextSibling,t.attributeName=e.attributeName,t.attributeNamespace=e.attributeNamespace,t.oldValue=e.oldValue,t},n}(),GC=0,Ts=new WeakMap,zC=function(){function n(e,t,r){this.observer=e,this.target=t,this.options=r,this.transientObservedNodes=[]}return n.prototype.enqueue=function(e){var t=this.observer.records,r=t.length;if(t.length>0){var i=t[r-1],a=HC(i,e);if(a){t[r-1]=a;return}}else XC(this.observer);t[r]=e},n.prototype.addListeners=function(){this.addListeners_(this.target)},n.prototype.addListeners_=function(e){var t=this.options;t.attributes&&e.addEventListener(oe.ATTR_MODIFIED,this,!0),t.childList&&e.addEventListener(oe.INSERTED,this,!0),(t.childList||t.subtree)&&e.addEventListener(oe.REMOVED,this,!0)},n.prototype.removeListeners=function(){this.removeListeners_(this.target)},n.prototype.removeListeners_=function(e){var t=this.options;t.attributes&&e.removeEventListener(oe.ATTR_MODIFIED,this,!0),t.childList&&e.removeEventListener(oe.INSERTED,this,!0),(t.childList||t.subtree)&&e.removeEventListener(oe.REMOVED,this,!0)},n.prototype.removeTransientObservers=function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(t){this.removeListeners_(t);for(var r=Ts.get(t),i=0;i<r.length;i++)if(r[i]===this){r.splice(i,1);break}},this)},n.prototype.handleEvent=function(e){e.stopImmediatePropagation();var t,r;switch(e.type){case oe.ATTR_MODIFIED:var i=e.attrName,a=e.relatedNode.namespaceURI;r=e.target,t=n1("attributes",r),t.attributeName=i,t.attributeNamespace=a;var o=e.attrChange===Ya.ADDITION?null:e.prevValue;r1(r,function(f){if(f.attributes&&!(f.attributeFilter&&f.attributeFilter.length&&f.attributeFilter.indexOf(i)===-1&&f.attributeFilter.indexOf(a)===-1))return f.attributeOldValue?WC(o):t});break;case oe.REMOVED:case oe.INSERTED:r=e.relatedNode;var s=e.target,l=void 0,c=void 0;e.type===oe.INSERTED?(l=[s],c=[]):(l=[],c=[s]);var u=s.previousSibling,h=s.nextSibling;t=n1("childList",r),t.addedNodes=l,t.removedNodes=c,t.previousSibling=u,t.nextSibling=h,r1(r,function(f){if(f.childList)return t})}UC()},n}(),aU=function(){function n(e){this.callback=e,this.nodes=[],this.records=[],this.uid=GC++}return n.prototype.observe=function(e,t){if(!t.childList&&!t.attributes&&!t.characterData||t.attributeOldValue&&!t.attributes||t.attributeFilter&&t.attributeFilter.length&&!t.attributes||t.characterDataOldValue&&!t.characterData)throw new SyntaxError;var r=Ts.get(e);r||Ts.set(e,r=[]);for(var i,a=0;a<r.length;a++)if(r[a].observer===this){i=r[a],i.removeListeners(),i.options=t;break}i||(i=new zC(this,e,t),r.push(i),this.nodes.push(e)),i.addListeners()},n.prototype.disconnect=function(){var e=this;this.nodes.forEach(function(t){for(var r=Ts.get(t),i=0;i<r.length;i++){var a=r[i];if(a.observer===e){a.removeListeners(),r.splice(i,1);break}}},this),this.records=[]},n.prototype.takeRecords=function(){var e=this.records;return this.records=[],e},n}(),fu,Ea;function n1(n,e){return fu=new e1(n,e)}function WC(n){return Ea||(Ea=e1.copy(fu),Ea.oldValue=n,Ea)}function UC(){fu=Ea=void 0}function VC(n){return n===Ea||n===fu}function HC(n,e){return n===e?n:Ea&&VC(n)?Ea:null}function YC(n){n.nodes.forEach(function(e){var t=Ts.get(e);t&&t.forEach(function(r){r.observer===n&&r.removeTransientObservers()})})}function r1(n,e){for(var t=n;t;t=t.parentNode){var r=Ts.get(t);if(r)for(var i=0;i<r.length;i++){var a=r[i],o=a.options;if(!(t!==n&&!o.subtree)){var s=e(o);s&&a.enqueue(s)}}}}var up=!1,hp=[];function XC(n){hp.push(n),up||(up=!0,typeof nt.globalThis!="undefined"?nt.globalThis.setTimeout(fp):fp())}function fp(){up=!1;var n=hp;hp=[],n.sort(function(t,r){return t.uid-r.uid});var e=!1;n.forEach(function(t){var r=t.takeRecords();YC(t),r.length&&(t.callback(r,t),e=!0)}),e&&fp()}var dp=function(n){B(e,n);function e(t,r,i,a){var o=n.call(this,t)||this;return o.currentTime=i,o.timelineTime=a,o.target=r,o.type="finish",o.bubbles=!1,o.currentTarget=r,o.defaultPrevented=!1,o.eventPhase=o.AT_TARGET,o.timeStamp=Date.now(),o.currentTime=i,o.timelineTime=a,o}return e}(su),jC=0,$C=function(){function n(e,t){var r;this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=t,this.id="".concat(jC++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((r=this.effect)===null||r===void 0?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return Object.defineProperty(n.prototype,"pending",{get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playState",{get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ready",{get:function(){var e=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(t,r){e.resolveReadyPromise=function(){t(e)},e.rejectReadyPromise=function(){r(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"finished",{get:function(){var e=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(t,r){e.resolveFinishedPromise=function(){t(e)},e.rejectFinishedPromise=function(){r(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(e){var t;e=Number(e),!isNaN(e)&&(this.timeline.restart(),!this._paused&&this._startTime!==null&&(this._startTime=Number((t=this.timeline)===null||t===void 0?void 0:t.currentTime)-e/this.playbackRate),this.currentTimePending=!1,this._currentTime!==e&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(e,!0),this.timeline.applyDirtiedAnimation(this)))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"startTime",{get:function(){return this._startTime},set:function(e){if(e!==null){if(this.updatePromises(),e=Number(e),isNaN(e)||this._paused||this._idle)return;this._startTime=e,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(e){if(e!==this._playbackRate){this.updatePromises();var t=this.currentTime;this._playbackRate=e,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),t!==null&&(this.currentTime=t),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_isFinished",{get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"totalDuration",{get:function(){return this._totalDuration},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_needsTick",{get:function(){return this.pending||this.playState==="running"||!this._finishedFlag},enumerable:!1,configurable:!0}),n.prototype.updatePromises=function(){var e=this.oldPlayState,t=this.pending?"pending":this.playState;return this.readyPromise&&t!==e&&(t==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):e==="pending"?this.resolveReadyPromise():t==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&t!==e&&(t==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):t==="finished"?this.resolveFinishedPromise():e==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=t,this.readyPromise||this.finishedPromise},n.prototype.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()},n.prototype.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()},n.prototype.finish=function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},n.prototype.cancel=function(){var e=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var t=new dp(null,this,this.currentTime,null);setTimeout(function(){e.oncancel(t)})}},n.prototype.reverse=function(){this.updatePromises();var e=this.currentTime;this.playbackRate*=-1,this.play(),e!==null&&(this.currentTime=e),this.updatePromises()},n.prototype.updatePlaybackRate=function(e){this.playbackRate=e},n.prototype.targetAnimations=function(){var e,t=(e=this.effect)===null||e===void 0?void 0:e.target;return t.getAnimations()},n.prototype.markTarget=function(){var e=this.targetAnimations();e.indexOf(this)===-1&&e.push(this)},n.prototype.unmarkTarget=function(){var e=this.targetAnimations(),t=e.indexOf(this);t!==-1&&e.splice(t,1)},n.prototype.tick=function(e,t){!this._idle&&!this._paused&&(this._startTime===null?t&&(this.startTime=e-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((e-this._startTime)*this.playbackRate)),t&&(this.currentTimePending=!1,this.fireEvents(e))},n.prototype.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")},n.prototype.persist=function(){throw new Error(Ne)},n.prototype.addEventListener=function(e,t,r){throw new Error(Ne)},n.prototype.removeEventListener=function(e,t,r){throw new Error(Ne)},n.prototype.dispatchEvent=function(e){throw new Error(Ne)},n.prototype.commitStyles=function(){throw new Error(Ne)},n.prototype.ensureAlive=function(){var e,t;this.playbackRate<0&&this.currentTime===0?this._inEffect=!!(!((e=this.effect)===null||e===void 0)&&e.update(-1)):this._inEffect=!!(!((t=this.effect)===null||t===void 0)&&t.update(this.currentTime)),!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))},n.prototype.tickCurrentTime=function(e,t){e!==this._currentTime&&(this._currentTime=e,this._isFinished&&!t&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())},n.prototype.fireEvents=function(e){var t=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var r=new dp(null,this,this.currentTime,e);setTimeout(function(){t.onfinish&&t.onfinish(r)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var i=new dp(null,this,this.currentTime,e);this.onframe(i)}this._finishedFlag=!1}},n}(),KC=4,ZC=.001,qC=1e-7,JC=10,Il=11,du=1/(Il-1),QC=typeof Float32Array=="function",i1=function(n,e){return 1-3*e+3*n},a1=function(n,e){return 3*e-6*n},o1=function(n){return 3*n},pu=function(n,e,t){return((i1(e,t)*n+a1(e,t))*n+o1(e))*n},s1=function(n,e,t){return 3*i1(e,t)*n*n+2*a1(e,t)*n+o1(e)},tA=function(n,e,t,r,i){var a,o,s=0;do o=e+(t-e)/2,a=pu(o,r,i)-n,a>0?t=o:e=o;while(Math.abs(a)>qC&&++s<JC);return o},eA=function(n,e,t,r){for(var i=0;i<KC;++i){var a=s1(e,t,r);if(a===0)return e;var o=pu(e,t,r)-n;e-=o/a}return e},pp=function(n,e,t,r){if(!(0<=n&&n<=1&&0<=t&&t<=1))throw new Error("bezier x values must be in [0, 1] range");if(n===e&&t===r)return function(s){return s};for(var i=QC?new Float32Array(Il):new Array(Il),a=0;a<Il;++a)i[a]=pu(a*du,n,t);var o=function(s){for(var l=0,c=1,u=Il-1;c!==u&&i[c]<=s;++c)l+=du;--c;var h=(s-i[c])/(i[c+1]-i[c]),f=l+h*du,d=s1(f,n,t);return d>=ZC?eA(s,f,n,t):d===0?f:tA(s,l,l+du,n,t)};return function(s){return s===0||s===1?s:pu(o(s),e,r)}},nA=function(n){return n=n.replace(/([A-Z])/g,function(e){return"-".concat(e.toLowerCase())}),n.charAt(0)==="-"?n.substring(1):n},vu=function(n){return Math.pow(n,2)},gu=function(n){return Math.pow(n,3)},mu=function(n){return Math.pow(n,4)},yu=function(n){return Math.pow(n,5)},xu=function(n){return Math.pow(n,6)},bu=function(n){return 1-Math.cos(n*Math.PI/2)},Eu=function(n){return 1-Math.sqrt(1-n*n)},wu=function(n){return n*n*(3*n-2)},_u=function(n){for(var e,t=4;n<((e=Math.pow(2,--t))-1)/11;);return 1/Math.pow(4,3-t)-7.5625*Math.pow((e*3-2)/22-n,2)},Su=function(n,e){e===void 0&&(e=[]);var t=C(e,2),r=t[0],i=r===void 0?1:r,a=t[1],o=a===void 0?.5:a,s=me(Number(i),1,10),l=me(Number(o),.1,2);return n===0||n===1?n:-s*Math.pow(2,10*(n-1))*Math.sin((n-1-l/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/l)},Dl=function(n,e,t){e===void 0&&(e=[]);var r=C(e,4),i=r[0],a=i===void 0?1:i,o=r[1],s=o===void 0?100:o,l=r[2],c=l===void 0?10:l,u=r[3],h=u===void 0?0:u;a=me(a,.1,1e3),s=me(s,.1,1e3),c=me(c,.1,1e3),h=me(h,.1,1e3);var f=Math.sqrt(s/a),d=c/(2*Math.sqrt(s*a)),p=d<1?f*Math.sqrt(1-d*d):0,v=1,g=d<1?(d*f+-h)/p:-h+f,m=t?t*n/1e3:n;return d<1?m=Math.exp(-m*d*f)*(v*Math.cos(p*m)+g*Math.sin(p*m)):m=(v+g*m)*Math.exp(-m*f),n===0||n===1?n:1-m},vp=function(n,e){e===void 0&&(e=[]);var t=C(e,2),r=t[0],i=r===void 0?10:r,a=t[1],o=a=="start"?Math.ceil:Math.floor;return o(me(n,0,1)*i)/i},l1=function(n,e){e===void 0&&(e=[]);var t=C(e,4),r=t[0],i=t[1],a=t[2],o=t[3];return pp(r,i,a,o)(n)},Tu=pp(.42,0,1,1),Si=function(n){return function(e,t,r){return t===void 0&&(t=[]),1-n(1-e,t,r)}},Ti=function(n){return function(e,t,r){return t===void 0&&(t=[]),e<.5?n(e*2,t,r)/2:1-n(e*-2+2,t,r)/2}},Pi=function(n){return function(e,t,r){return t===void 0&&(t=[]),e<.5?(1-n(1-e*2,t,r))/2:(n(e*2-1,t,r)+1)/2}},c1={steps:vp,"step-start":function(n){return vp(n,[1,"start"])},"step-end":function(n){return vp(n,[1,"end"])},linear:function(n){return n},"cubic-bezier":l1,ease:function(n){return l1(n,[.25,.1,.25,1])},in:Tu,out:Si(Tu),"in-out":Ti(Tu),"out-in":Pi(Tu),"in-quad":vu,"out-quad":Si(vu),"in-out-quad":Ti(vu),"out-in-quad":Pi(vu),"in-cubic":gu,"out-cubic":Si(gu),"in-out-cubic":Ti(gu),"out-in-cubic":Pi(gu),"in-quart":mu,"out-quart":Si(mu),"in-out-quart":Ti(mu),"out-in-quart":Pi(mu),"in-quint":yu,"out-quint":Si(yu),"in-out-quint":Ti(yu),"out-in-quint":Pi(yu),"in-expo":xu,"out-expo":Si(xu),"in-out-expo":Ti(xu),"out-in-expo":Pi(xu),"in-sine":bu,"out-sine":Si(bu),"in-out-sine":Ti(bu),"out-in-sine":Pi(bu),"in-circ":Eu,"out-circ":Si(Eu),"in-out-circ":Ti(Eu),"out-in-circ":Pi(Eu),"in-back":wu,"out-back":Si(wu),"in-out-back":Ti(wu),"out-in-back":Pi(wu),"in-bounce":_u,"out-bounce":Si(_u),"in-out-bounce":Ti(_u),"out-in-bounce":Pi(_u),"in-elastic":Su,"out-elastic":Si(Su),"in-out-elastic":Ti(Su),"out-in-elastic":Pi(Su),spring:Dl,"spring-in":Dl,"spring-out":Si(Dl),"spring-in-out":Ti(Dl),"spring-out-in":Pi(Dl)},rA=function(n){return nA(n).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},iA=function(n){return c1[rA(n)]||c1.linear},aA=function(n){return n},oA=1,sA=.5,u1=0;function h1(n,e){return function(t){if(t>=1)return 1;var r=1/n;return t+=e*r,t-t%r}}var Pu="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",lA=new RegExp("cubic-bezier\\("+Pu+","+Pu+","+Pu+","+Pu+"\\)"),cA=/steps\(\s*(\d+)\s*\)/,uA=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function gp(n){var e=lA.exec(n);if(e)return pp.apply(void 0,K([],C(e.slice(1).map(Number)),!1));var t=cA.exec(n);if(t)return h1(Number(t[1]),u1);var r=uA.exec(n);return r?h1(Number(r[1]),{start:oA,middle:sA,end:u1}[r[2]]):iA(n)}function hA(n){return Math.abs(fA(n)/(n.playbackRate||1))}function fA(n){var e;return n.duration===0||n.iterations===0?0:(n.duration==="auto"?0:Number(n.duration))*((e=n.iterations)!==null&&e!==void 0?e:1)}var f1=0,mp=1,Mu=2,d1=3;function dA(n,e,t){if(e===null)return f1;var r=t.endTime;return e<Math.min(t.delay,r)?mp:e>=Math.min(t.delay+n+t.endDelay,r)?Mu:d1}function pA(n,e,t,r,i){switch(r){case mp:return e==="backwards"||e==="both"?0:null;case d1:return t-i;case Mu:return e==="forwards"||e==="both"?n:null;case f1:return null}}function vA(n,e,t,r,i){var a=i;return n===0?e!==mp&&(a+=t):a+=r/n,a}function gA(n,e,t,r,i,a){var o=n===1/0?e%1:n%1;return o===0&&t===Mu&&r!==0&&(i!==0||a===0)&&(o=1),o}function mA(n,e,t,r){return n===Mu&&e===1/0?1/0:t===1?Math.floor(r)-1:Math.floor(r)}function yA(n,e,t){var r=n;if(n!=="normal"&&n!=="reverse"){var i=e;n==="alternate-reverse"&&(i+=1),r="normal",i!==1/0&&i%2!==0&&(r="reverse")}return r==="normal"?t:1-t}function xA(n,e,t){var r=dA(n,e,t),i=pA(n,t.fill,e,r,t.delay);if(i===null)return null;var a=t.duration==="auto"?0:t.duration,o=vA(a,r,t.iterations,i,t.iterationStart),s=gA(o,t.iterationStart,r,t.iterations,i,a),l=mA(r,t.iterations,s,o),c=yA(t.direction,l,s);return t.currentIteration=l,t.progress=c,t.easingFunction(c)}function bA(n,e,t){var r=EA(n,e),i=wA(r,t);return function(a,o){if(o!==null)i.filter(function(l){return o>=l.applyFrom&&o<l.applyTo}).forEach(function(l){var c=o-l.startOffset,u=l.endOffset-l.startOffset,h=u===0?0:c/u;a.setAttribute(l.property,l.interpolation(h),!1,!1)});else for(var s in r)p1(s)&&a.setAttribute(s,null)}}function p1(n){return n!=="offset"&&n!=="easing"&&n!=="composite"&&n!=="computedOffset"}function EA(n,e){for(var t={},r=0;r<n.length;r++)for(var i in n[r])if(p1(i)){var a={offset:n[r].offset,computedOffset:n[r].computedOffset,easing:n[r].easing,easingFunction:gp(n[r].easing)||e.easingFunction,value:n[r][i]};t[i]=t[i]||[],t[i].push(a)}return t}function wA(n,e){var t=[];for(var r in n)for(var i=n[r],a=0;a<i.length-1;a++){var o=a,s=a+1,l=i[o].computedOffset,c=i[s].computedOffset,u=l,h=c;a===0&&(u=-1/0,c===0&&(s=o)),a===i.length-2&&(h=1/0,l===1&&(o=s)),t.push({applyFrom:u,applyTo:h,startOffset:i[o].computedOffset,endOffset:i[s].computedOffset,easingFunction:i[o].easingFunction,property:r,interpolation:_A(r,i[o].value,i[s].value,e)})}return t.sort(function(f,d){return f.startOffset-d.startOffset}),t}var v1=function(n,e,t){return function(r){var i=g1(n,e,r);return!nt.enableCSSParsing&&fe(i)?i:t(i)}};function _A(n,e,t,r){var i=Ha[n];if(i&&i.syntax&&i.int){var a=nt.styleValueRegistry.getPropertySyntax(i.syntax);if(a){var o=void 0,s=void 0;if(nt.enableCSSParsing){var l=nt.styleValueRegistry.parseProperty(n,e,r,!1),c=nt.styleValueRegistry.parseProperty(n,t,r,!1);o=nt.styleValueRegistry.computeProperty(n,l,r,!1),s=nt.styleValueRegistry.computeProperty(n,c,r,!1)}else{var u=a.parserWithCSSDisabled;o=u?u(e,r):e,s=u?u(t,r):t}var h=a.mixer(o,s,r);if(h){var f=v1.apply(void 0,K([],C(h),!1));return function(d){return d===0?e:d===1?t:f(d)}}}}return v1(!1,!0,function(d){return d?t:e})}function g1(n,e,t){if(typeof n=="number"&&typeof e=="number")return n*(1-t)+e*t;if(typeof n=="boolean"&&typeof e=="boolean"||typeof n=="string"&&typeof e=="string")return t<.5?n:e;if(Array.isArray(n)&&Array.isArray(e)){for(var r=n.length,i=e.length,a=Math.max(r,i),o=[],s=0;s<a;s++)o.push(g1(n[s<r?s:r-1],e[s<i?s:i-1],t));return o}throw new Error("Mismatched interpolation arguments "+n+":"+e)}var SA=function(){function n(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=aA,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return Object.defineProperty(n.prototype,"easing",{get:function(){return this._easing},set:function(e){this.easingFunction=gp(e),this._easing=e},enumerable:!1,configurable:!0}),n}();function TA(n){var e=[];for(var t in n)if(!(t in["easing","offset","composite"])){var r=n[t];Array.isArray(r)||(r=[r]);for(var i=r.length,a=0;a<i;a++){if(!e[a]){var o={};"offset"in n&&(o.offset=Number(n.offset)),"easing"in n&&(o.easing=n.easing),"composite"in n&&(o.composite=n.composite),e[a]=o}r[a]!==void 0&&r[a]!==null&&(e[a][t]=r[a])}}return e.sort(function(s,l){return(s.computedOffset||0)-(l.computedOffset||0)}),e}function m1(n,e){if(n===null)return[];Array.isArray(n)||(n=TA(n));for(var t=n.map(function(l){var c={};e!=null&&e.composite&&(c.composite="auto");for(var u in l){var h=l[u];if(u==="offset"){if(h!==null){if(h=Number(h),!isFinite(h))throw new Error("Keyframe offsets must be numbers.");if(h<0||h>1)throw new Error("Keyframe offsets must be between 0 and 1.");c.computedOffset=h}}else if(u==="composite"&&["replace","add","accumulate","auto"].indexOf(h)===-1)throw new Error("".concat(h," compositing is not supported"));c[u]=h}return c.offset===void 0&&(c.offset=null),c.easing===void 0&&(c.easing=(e==null?void 0:e.easing)||"linear"),c.composite===void 0&&(c.composite="auto"),c}),r=!0,i=-1/0,a=0;a<t.length;a++){var o=t[a].offset;if(Mt(o))r=!1;else{if(o<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=o}}t=t.filter(function(l){return Number(l.offset)>=0&&Number(l.offset)<=1});function s(){var l,c,u=t.length;t[u-1].computedOffset=Number((l=t[u-1].offset)!==null&&l!==void 0?l:1),u>1&&(t[0].computedOffset=Number((c=t[0].offset)!==null&&c!==void 0?c:0));for(var h=0,f=Number(t[0].computedOffset),d=1;d<u;d++){var p=t[d].computedOffset;if(!Mt(p)&&!Mt(f)){for(var v=1;v<d-h;v++)t[h+v].computedOffset=f+(Number(p)-f)*v/(d-h);h=d,f=Number(p)}}}return r||s(),t}var PA="backwards|forwards|both|none".split("|"),MA="reverse|alternate|alternate-reverse".split("|");function CA(n,e){var t=new SA;return e&&(t.fill="both",t.duration="auto"),typeof n=="number"&&!isNaN(n)?t.duration=n:n!==void 0&&Object.keys(n).forEach(function(r){if(n[r]!==void 0&&n[r]!==null&&n[r]!=="auto"){if((typeof t[r]=="number"||r==="duration")&&(typeof n[r]!="number"||isNaN(n[r]))||r==="fill"&&PA.indexOf(n[r])===-1||r==="direction"&&MA.indexOf(n[r])===-1)return;t[r]=n[r]}}),t}function AA(n,e){return n=OA(n!=null?n:{duration:"auto"}),CA(n,e)}function OA(n){return typeof n=="number"&&(isNaN(n)?n={duration:"auto"}:n={duration:n}),n}var NA=function(){function n(e,t,r){var i=this;this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=AA(r,!1),this.timing.effect=this,this.timing.activeDuration=hA(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=m1(t,this.timing),this.interpolations=bA(this.normalizedKeyframes,this.timing,this.target);var a=nt.globalThis.Proxy;this.computedTiming=a?new a(this.timing,{get:function(o,s){return s==="duration"?o.duration==="auto"?0:o.duration:s==="fill"?o.fill==="auto"?"none":o.fill:s==="localTime"?i.animation&&i.animation.currentTime||null:s==="currentIteration"?!i.animation||i.animation.playState!=="running"?null:o.currentIteration||0:s==="progress"?!i.animation||i.animation.playState!=="running"?null:o.progress||0:o[s]},set:function(){return!0}}):this.timing}return n.prototype.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},n.prototype.update=function(e){return e===null?!1:(this.timeFraction=xA(this.timing.activeDuration,e,this.timing),this.timeFraction!==null)},n.prototype.getKeyframes=function(){return this.normalizedKeyframes},n.prototype.setKeyframes=function(e){this.normalizedKeyframes=m1(e)},n.prototype.getComputedTiming=function(){return this.computedTiming},n.prototype.getTiming=function(){return this.timing},n.prototype.updateTiming=function(e){var t=this;Object.keys(e||{}).forEach(function(r){t.timing[r]=e[r]})},n}();function y1(n,e){return Number(n.id)-Number(e.id)}var RA=function(){function n(e){var t=this;this.document=e,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(r){t.currentTime=r,t.discardAnimations(),t.animations.length===0?t.timelineTicking=!1:t.requestAnimationFrame(t.webAnimationsNextTick)},this.processRafCallbacks=function(r){var i=t.rafCallbacks;t.rafCallbacks=[],r<Number(t.currentTime)&&(r=Number(t.currentTime)),t.animations.sort(y1),t.animations=t.tick(r,!0,t.animations)[0],i.forEach(function(a){a[1](r)}),t.applyPendingEffects()}}return n.prototype.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},n.prototype.isTicking=function(){return this.inTick},n.prototype.play=function(e,t,r){var i=new NA(e,t,r),a=new $C(i,this);return this.animations.push(a),this.restartWebAnimationsNextTick(),a.updatePromises(),a.play(),a.updatePromises(),a},n.prototype.applyDirtiedAnimation=function(e){var t=this;if(!this.inTick){e.markTarget();var r=e.targetAnimations();r.sort(y1);var i=this.tick(Number(this.currentTime),!1,r.slice())[1];i.forEach(function(a){var o=t.animations.indexOf(a);o!==-1&&t.animations.splice(o,1)}),this.applyPendingEffects()}},n.prototype.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},n.prototype.destroy=function(){this.document.defaultView.cancelAnimationFrame(this.frameId)},n.prototype.applyPendingEffects=function(){this.pendingEffects.forEach(function(e){e==null||e.applyInterpolations()}),this.pendingEffects=[]},n.prototype.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(e){return e.updatePromises()})},n.prototype.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(e){return e.playState!=="finished"&&e.playState!=="idle"})},n.prototype.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},n.prototype.rAF=function(e){var t=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([t,e]),t},n.prototype.requestAnimationFrame=function(e){var t=this;return this.rAF(function(r){t.updateAnimationsPromises(),e(r),t.updateAnimationsPromises()})},n.prototype.tick=function(e,t,r){var i,a,o=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=e,this.ticking=!1;var s=[],l=[],c=[],u=[];return r.forEach(function(h){h.tick(e,t),h._inEffect?(l.push(h.effect),h.markTarget()):(s.push(h.effect),h.unmarkTarget()),h._needsTick&&(o.ticking=!0);var f=h._inEffect||h._needsTick;h._inTimeline=f,f?c.push(h):u.push(h)}),(i=this.pendingEffects).push.apply(i,K([],C(s),!1)),(a=this.pendingEffects).push.apply(a,K([],C(l),!1)),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[c,u]},n}();nt.EasingFunction=gp,nt.AnimationTimeline=RA;var x1=function(n){return Mt(n)?"":n.toString()},kA=function(n){var e=x1(n);return e.charAt(0).toUpperCase()+e.substring(1)},Cu=kA,LA=function(n){return typeof n=="object"&&n!==null},yp=LA,IA=function(n){return n!==null&&typeof n!="function"&&isFinite(n.length)},Bl=IA,xp=function(n,e){if(n===e)return!0;if(!n||!e||ue(n)||ue(e))return!1;if(Bl(n)||Bl(e)){if(n.length!==e.length)return!1;for(var t=!0,r=0;r<n.length&&(t=xp(n[r],e[r]),!!t);r++);return t}if(yp(n)||yp(e)){var i=Object.keys(n),a=Object.keys(e);if(i.length!==a.length)return!1;for(var t=!0,r=0;r<i.length&&(t=xp(n[i[r]],e[i[r]]),!!t);r++);return t}return!1},vn=xp;const DA={duration:500},BA={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"},oU={CHANGE:"change"};var tn;(function(n){n.NodeAdded="NodeAdded",n.NodeUpdated="NodeUpdated",n.NodeRemoved="NodeRemoved",n.EdgeAdded="EdgeAdded",n.EdgeUpdated="EdgeUpdated",n.EdgeRemoved="EdgeRemoved",n.ComboAdded="ComboAdded",n.ComboUpdated="ComboUpdated",n.ComboRemoved="ComboRemoved"})(tn||(tn={}));var Fr;(function(n){n.DRAW="draw",n.COLLAPSE="collapse",n.EXPAND="expand",n.TRANSFORM="transform"})(Fr||(Fr={}));var wa;(function(n){n.CLICK="canvas:click",n.DBLCLICK="canvas:dblclick",n.POINTER_OVER="canvas:canvas:pointerover",n.POINTER_LEAVE="canvas:pointerleave",n.POINTER_ENTER="canvas:pointerenter",n.POINTER_MOVE="canvas:pointermove",n.POINTER_OUT="canvas:pointerout",n.POINTER_DOWN="canvas:pointerdown",n.POINTER_UP="canvas:pointerup",n.CONTEXT_MENU="canvas:contextmenu",n.DRAG_START="canvas:dragstart",n.DRAG="canvas:drag",n.DRAG_END="canvas:dragend",n.DRAG_ENTER="canvas:dragenter",n.DRAG_OVER="canvas:dragover",n.DRAG_LEAVE="canvas:dragleave",n.DROP="canvas:drop",n.WHEEL="canvas:wheel"})(wa||(wa={}));var Do;(function(n){n.CLICK="combo:click",n.DBLCLICK="combo:dblclick",n.POINTER_OVER="combo:pointerover",n.POINTER_LEAVE="combo:pointerleave",n.POINTER_ENTER="combo:pointerenter",n.POINTER_MOVE="combo:pointermove",n.POINTER_OUT="combo:pointerout",n.POINTER_DOWN="combo:pointerdown",n.POINTER_UP="combo:pointerup",n.CONTEXT_MENU="combo:contextmenu",n.DRAG_START="combo:dragstart",n.DRAG="combo:drag",n.DRAG_END="combo:dragend",n.DRAG_ENTER="combo:dragenter",n.DRAG_OVER="combo:dragover",n.DRAG_LEAVE="combo:dragleave",n.DROP="combo:drop"})(Do||(Do={}));var ht;(function(n){n.CLICK="click",n.DBLCLICK="dblclick",n.POINTER_OVER="pointerover",n.POINTER_LEAVE="pointerleave",n.POINTER_ENTER="pointerenter",n.POINTER_MOVE="pointermove",n.POINTER_OUT="pointerout",n.POINTER_DOWN="pointerdown",n.POINTER_UP="pointerup",n.CONTEXT_MENU="contextmenu",n.DRAG_START="dragstart",n.DRAG="drag",n.DRAG_END="dragend",n.DRAG_ENTER="dragenter",n.DRAG_OVER="dragover",n.DRAG_LEAVE="dragleave",n.DROP="drop",n.KEY_DOWN="keydown",n.KEY_UP="keyup",n.WHEEL="wheel"})(ht||(ht={}));var Ps;(function(n){n.KEY_DOWN="keydown",n.KEY_UP="keyup"})(Ps||(Ps={}));var Au;(function(n){n.CLICK="edge:click",n.DBLCLICK="edge:dblclick",n.POINTER_OVER="edge:pointerover",n.POINTER_LEAVE="edge:pointerleave",n.POINTER_ENTER="edge:pointerenter",n.POINTER_MOVE="edge:pointermove",n.POINTER_OUT="edge:pointerout",n.POINTER_DOWN="edge:pointerdown",n.POINTER_UP="edge:pointerup",n.CONTEXT_MENU="edge:contextmenu",n.DRAG_ENTER="edge:dragenter",n.DRAG_OVER="edge:dragover",n.DRAG_LEAVE="edge:dragleave",n.DROP="edge:drop"})(Au||(Au={}));var Tt;(function(n){n.BEFORE_CANVAS_INIT="beforecanvasinit",n.AFTER_CANVAS_INIT="aftercanvasinit",n.BEFORE_SIZE_CHANGE="beforesizechange",n.AFTER_SIZE_CHANGE="aftersizechange",n.BEFORE_ELEMENT_CREATE="beforeelementcreate",n.AFTER_ELEMENT_CREATE="afterelementcreate",n.BEFORE_ELEMENT_UPDATE="beforeelementupdate",n.AFTER_ELEMENT_UPDATE="afterelementupdate",n.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",n.AFTER_ELEMENT_DESTROY="afterelementdestroy",n.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",n.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",n.BEFORE_DRAW="beforedraw",n.AFTER_DRAW="afterdraw",n.BEFORE_RENDER="beforerender",n.AFTER_RENDER="afterrender",n.BEFORE_ANIMATE="beforeanimate",n.AFTER_ANIMATE="afteranimate",n.BEFORE_LAYOUT="beforelayout",n.AFTER_LAYOUT="afterlayout",n.BEFORE_STAGE_LAYOUT="beforestagelayout",n.AFTER_STAGE_LAYOUT="afterstagelayout",n.BEFORE_TRANSFORM="beforetransform",n.AFTER_TRANSFORM="aftertransform",n.BATCH_START="batchstart",n.BATCH_END="batchend",n.BEFORE_DESTROY="beforedestroy",n.AFTER_DESTROY="afterdestroy",n.BEFORE_RENDERER_CHANGE="beforerendererchange",n.AFTER_RENDERER_CHANGE="afterrendererchange"})(Tt||(Tt={}));var ja;(function(n){n.UNDO="undo",n.REDO="redo",n.CANCEL="cancel",n.ADD="add",n.CLEAR="clear",n.CHANGE="change"})(ja||(ja={}));var Mi;(function(n){n.CLICK="node:click",n.DBLCLICK="node:dblclick",n.POINTER_OVER="node:pointerover",n.POINTER_LEAVE="node:pointerleave",n.POINTER_ENTER="node:pointerenter",n.POINTER_MOVE="node:pointermove",n.POINTER_OUT="node:pointerout",n.POINTER_DOWN="node:pointerdown",n.POINTER_UP="node:pointerup",n.CONTEXT_MENU="node:contextmenu",n.DRAG_START="node:dragstart",n.DRAG="node:drag",n.DRAG_END="node:dragend",n.DRAG_ENTER="node:dragenter",n.DRAG_OVER="node:dragover",n.DRAG_LEAVE="node:dragleave",n.DROP="node:drop"})(Mi||(Mi={}));const en="combo",$a="tree";var Ms;(function(n){n.NODE="node",n.EDGE="edge",n.COMBO="combo",n.THEME="theme",n.PALETTE="palette",n.LAYOUT="layout",n.BEHAVIOR="behavior",n.PLUGIN="plugin",n.ANIMATION="animation",n.TRANSFORM="transform",n.SHAPE="shape"})(Ms||(Ms={}));const bp={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function _a(n,e){var r;const t=(r=bp[n])==null?void 0:r[e];if(t)return t}function sU(n){return EXTENSION_REGISTRY[n]}const FA="5.0.17",GA="G6";function Sa(n){return`[${GA} v${FA}] ${n}`}const Gr={mute:!1,debug:n=>{!Gr.mute&&console.debug(Sa(n))},info:n=>{!Gr.mute&&console.info(Sa(n))},warn:n=>{!Gr.mute&&console.warn(Sa(n))},error:n=>{!Gr.mute&&console.error(Sa(n))}};function b1(n){const{theme:e}=n;if(!e)return{};const t=_a(Ms.THEME,e);return t||(Gr.warn(`The theme of ${e} is not registered.`),{})}function Ep(n,e){if(Array.isArray(n)&&n.length===0)return null;const t=Array.isArray(n)?n[0]:n,r=Array.isArray(n)?n.slice(1):e||[];return new Proxy(t,{get(i,a){return typeof i[a]=="function"&&!["onframe","onfinish"].includes(a)?(...o)=>{i[a](...o),r.forEach(s=>{var l;return(l=s[a])==null?void 0:l.call(s,...o)})}:a==="finished"?Promise.all([t.finished,...r.map(o=>o.finished)]):Reflect.get(i,a)},set(i,a,o){return["onframe","onfinish"].includes(a)||r.forEach(s=>{s[a]=o}),Reflect.set(i,a,o)}})}function wp(n){const e=n.reduce((r,i)=>(Object.entries(i).forEach(([a,o])=>{r[a]===void 0?r[a]=[o]:r[a].push(o)}),r),{});Object.entries(e).forEach(([r,i])=>{(i.length!==n.length||i.some(a=>Mt(a))||i.every(a=>!["sourceNode","targetNode","childrenNode"].includes(r)&&vn(a,i[0])))&&delete e[r]});const t=Object.entries(e).reduce((r,[i,a])=>(a.forEach((o,s)=>{r[s]?r[s][i]=o:r[s]={[i]:o}}),r),[]);return n.length!==0&&t.length===0&&t.push({_:0},{_:0}),t}function Ou(n){switch(n){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function E1(n,e){const{animation:t}=n;if(t===!1||e===!1)return!1;const r=at({},DA);return dn(t)&&Object.assign(r,t),dn(e)&&Object.assign(r,e),r}function zA(n){if(typeof n=="string"){const e=_a(Ms.ANIMATION,n);return e||(Gr.warn(`The animation of ${n} is not registered.`),[])}return n}function WA(n,e,t,r){var u,h;const{animation:i}=n,a=(u=n==null?void 0:n[e])==null?void 0:u.animation;if(a===!1)return[];const o=a==null?void 0:a[t];if(o===!1)return[];if(i===!1||r===!1)return[];const s=(h=b1(n)[e])==null?void 0:h.animation,l=(f=[])=>zA(f).map(d=>at(at(at(at({},BA),dn(i)&&i),d),dn(r)&&r));if(o)return l(o);if(!s)return[];const c=s[t];return c===!1?[]:l(c)}var UA=function(n){if(!yp(n)||!ss(n,"Object"))return!1;if(Object.getPrototypeOf(n)===null)return!0;for(var e=n;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e},Cs=UA,VA=5;function HA(n,e){if(Object.hasOwn)return Object.hasOwn(n,e);if(n==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(n),e)}function w1(n,e,t,r){t=t||0,r=r||VA;for(var i in e)if(HA(e,i)){var a=e[i];a!==null&&Cs(a)?(Cs(n[i])||(n[i]={}),t<r?w1(n[i],a,t+1,r):n[i]=e[i]):xr(a)?(n[i]=[],n[i]=n[i].concat(a)):a!==void 0&&(n[i]=a)}}var YA=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r+=1)w1(n,e[r]);return n},Ci=YA;function it(n){if(n.id!==void 0)return n.id;if(n.source!==void 0&&n.target!==void 0)return`${n.source}-${n.target}`;throw new Error(Sa("The datum does not have available id."))}function _p(n){return n.combo}function _1(n,e){const t={nodes:(n.nodes||[]).map(it),edges:(n.edges||[]).map(it),combos:(n.combos||[]).map(it)};return e?Object.values(t).flat():t}function Sp(n,e,t,r){const i=r?r.replace(/translate(3d)?\([^)]*\)/g,""):"";return t===0?`translate(${n}, ${e})${i}`:`translate3d(${n}, ${e}, ${t})${i}`}const Fl=(n,e,t,r,i=!1)=>{const a=it(r),o=`${t}s`,s=n.add[o].get(a)||n.update[o].get(a)||n.remove[o].get(a)||r;Object.entries(n).forEach(([l,c])=>{e===l?c[o].set(a,i?Ci(s,r):s):c[o].delete(a)})},XA=(n,e,t)=>{if(!t.length)return null;const[r,i]=e,a=c=>{var u;if(c){const h=n.getShape(c);if(!h)return null;const f=`get${Cu(c)}Style`,d=((u=n==null?void 0:n[f])==null?void 0:u.bind(n))||(g=>g),p=(d==null?void 0:d(r))||{},v=(d==null?void 0:d(i))||{};return{shape:h,fromStyle:p,toStyle:v}}else return{shape:n,fromStyle:r,toStyle:i}};let o;const s=t.map(d=>{var p=d,{fields:c,shape:u,states:h}=p,f=Ce(p,["fields","shape","states"]);const v=a(u);if(!v)return null;const{shape:g,fromStyle:m,toStyle:x}=v,_=[{},{}];if(c.forEach(b=>{var y,E;Object.assign(_[0],{[b]:(y=m[b])!=null?y:Ou(b)}),Object.assign(_[1],{[b]:(E=x[b])!=null?E:Ou(b)})}),_.some(b=>Object.keys(b).some(y=>["x","y","z"].includes(y)))){const{x:b=0,y=0,z:E=0,transform:w=""}=g.attributes||{};_.forEach(M=>{M.transform=Sp(M.x||b,M.y||y,M.z||E,w)})}const S=g.animate(wp(_),f);return u===void 0&&(o=S),S}).filter(Boolean),l=o||(s==null?void 0:s[0]);return l?Ep(l,s.filter(c=>c!==c)):null},jA=[{fields:["opacity"]}],$A=[{fields:["x","y"]}],S1=[{fields:["x","y"]}],KA=S1,T1=[{fields:["sourceNode","targetNode"]}],ZA=T1,P1=[{fields:["childrenNode","x","y"]}],qA=P1,lU=[{fields:["childrenNode","x","y"]}];function As(n,e,t){const r=new Map(n.map(h=>[t(h),h])),i=new Map(e.map(h=>[t(h),h])),a=new Set(r.keys()),o=new Set(i.keys()),s=[],l=[],c=[],u=[];return o.forEach(h=>{a.has(h)?vn(r.get(h),i.get(h))?u.push(i.get(h)):l.push(i.get(h)):s.push(i.get(h))}),a.forEach(h=>{o.has(h)||c.push(r.get(h))}),{enter:s,exit:c,keep:u,update:l}}function JA(n,e,t){const r={},i=a=>(a in r||(r[a]=0),`${e}-${a}-${r[a]++}`);return t.map(a=>typeof a=="string"?{type:a,key:i(a)}:typeof a=="function"?a.call(n):a.key?a:Se(at({},a),{key:i(a.type)}))}class Tp{constructor(e){k(this,"context");k(this,"extensions",[]);k(this,"extensionMap",{});this.context=e}setExtensions(e){const t=JA(this.context.graph,this.category,e),{enter:r,update:i,exit:a,keep:o}=As(this.extensions,t,s=>s.key);this.createExtensions(r),this.updateExtensions([...i,...o]),this.destroyExtensions(a),this.extensions=t}createExtension(e){const{category:t}=this,{key:r,type:i}=e,a=_a(t,i);if(!a)return Gr.warn(`The extension ${i} of ${t} is not registered.`);const o=new a(this.context,e);this.extensionMap[r]=o}createExtensions(e){e.forEach(t=>this.createExtension(t))}updateExtension(e){const{key:t}=e,r=this.extensionMap[t];r&&r.update(e)}updateExtensions(e){e.forEach(t=>this.updateExtension(t))}destroyExtension(e){const t=this.extensionMap[e];t&&(t.destroy(),delete this.extensionMap[e])}destroyExtensions(e){e.forEach(({key:t})=>this.destroyExtension(t))}destroy(){Object.values(this.extensionMap).forEach(e=>e.destroy()),this.context={},this.extensions=[],this.extensionMap={}}}class Pp{constructor(e,t){k(this,"context");k(this,"options");k(this,"events",[]);k(this,"destroyed",!1);this.context=e,this.options=t}update(e){this.options=Object.assign(this.options,e)}destroy(){this.context={},this.options={},this.destroyed=!0}}class Ai extends Pp{}var jt=function(n){return typeof n=="function"},Mp=function(n){if(typeof n!="object"||n===null)return n;var e;if(xr(n)){e=[];for(var t=0,r=n.length;t<r;t++)typeof n[t]=="object"&&n[t]!=null?e[t]=Mp(n[t]):e[t]=n[t]}else{e={};for(var i in n)typeof n[i]=="object"&&n[i]!=null?e[i]=Mp(n[i]):e[i]=n[i]}return e},Nu=Mp;function QA(n){return"source"in n&&"target"in n}function tO(n){return n.length===2}function cU(n){return n.length===3}function Os(n){return n instanceof Float32Array?!0:Array.isArray(n)&&(n.length===2||n.length===3)?n.every(e=>typeof e=="number"):!1}function ia(n,e,t){return n>=e&&n<=t}function Ns(n=0){if(Array.isArray(n)){const[e=0,t=e,r=e,i=t]=n;return[e,t,r,i]}return[n,n,n,n]}function aa(n){return n.max[0]-n.min[0]}function oa(n){return n.max[1]-n.min[1]}function Ka(n){return[aa(n),oa(n)]}function Za(n,e){const t=Os(n)?eO(n):n.getShape("key").getBounds();return e?Ru(t,e):t}function eO(n){const[e,t,r=0]=n,i=new Fe;return i.setMinMax([e,t,r],[e,t,r]),i}function Ru(n,e){const[t,r,i,a]=Ns(e),[o,s,l]=n.min,[c,u,h]=n.max,f=new Fe;return f.setMinMax([o-a,s-t,l],[c+r,u+i,h]),f}function Gl(n){if(n.length===0)return new Fe;if(n.length===1)return n[0];const e=new Fe;e.setMinMax(n[0].min,n[0].max);for(let t=1;t<n.length;t++){const r=n[t];e.setMinMax([Math.min(e.min[0],r.min[0]),Math.min(e.min[1],r.min[1]),Math.min(e.min[2],r.min[2])],[Math.max(e.max[0],r.max[0]),Math.max(e.max[1],r.max[1]),Math.max(e.max[2],r.max[2])])}return e}function Ta(n,e){return ia(n[0],e.min[0],e.max[0])&&ia(n[1],e.min[1],e.max[1])}function M1(n,e,t=!1){const{min:[r,i],max:[a,o]}=e,s=(n[1]===i||n[1]===o)&&(t||ia(n[0],r,a)),l=(n[0]===r||n[0]===a)&&(t||ia(n[1],i,o));return s||l}function nO(n,e){return!Ta(n,e)}function ku(n,e){const[t,r]=e,[i,a]=n.min,[o,s]=n.max,l=t-i,c=o-t,u=r-a,h=s-r,f=Math.min(l,c,u,h);return f===l?"left":f===c?"right":f===u?"top":f===h?"bottom":"left"}function Cp(n,e){const t=Nu(e);if(Ta(e,n))switch(ku(n,e)){case"left":t[0]=n.min[0];break;case"right":t[0]=n.max[0];break;case"top":t[1]=n.min[1];break;case"bottom":t[1]=n.max[1];break}else{const[r,i]=e,[a,o]=n.min,[s,l]=n.max;t[0]=ia(r,a,s)?r:r<a?a:s,t[1]=ia(i,o,l)?i:i<o?o:l}return t}function rO(n,e){const{center:t}=n,[r,i]=Ka(n),a=e==="up"||e==="down"?t[0]:e==="right"?t[0]-r/6:t[0]+r/6,o=e==="left"||e==="right"?t[1]:e==="down"?t[1]-i/6:t[1]+i/6;return[a,o]}function iO(n,e){let[t,r]=Ka(n);return[t,r]=e==="up"||e==="down"?[t,r]:[r,t],(gi(r,2)-gi(Math.sqrt(gi(t/2,2)+gi(r,2))-t/2,2))/(2*r)}function aO(n){const{min:[e,t],max:[r,i]}=n,a=[e,i],o=[r,i],s=[r,t],l=[e,t];return[[a,o],[o,s],[s,l],[l,a]]}const C1=[0,0,0];function ge(n,e){return n.map((t,r)=>t+e[r])}function In(n,e){return n.map((t,r)=>t-e[r])}function Ap(n,e){return typeof e=="number"?n.map(t=>t*e):n.map((t,r)=>t*e[r])}function Rs(n,e){return typeof e=="number"?n.map(t=>t/e):n.map((t,r)=>t/e[r])}function uU(n,e){return n.reduce((t,r,i)=>t+r*e[i],0)}function oO(n,e){const t=Wl(n),r=Wl(e);return[t[1]*r[2]-t[2]*r[1],t[2]*r[0]-t[0]*r[2],t[0]*r[1]-t[1]*r[0]]}function qa(n,e){return n.map(t=>t*e)}function Oi(n,e){return Math.sqrt(n.reduce((t,r,i)=>t+gi(r-e[i]||0,2),0))}function Lu(n,e){return n.reduce((t,r,i)=>t+Math.abs(r-e[i]),0)}function Pa(n){const e=n.reduce((t,r)=>t+gi(r,2),0);return n.map(t=>t/Math.sqrt(e))}function Op(n,e,t=!1){const r=n[0]*e[1]-n[1]*e[0];let i=Math.acos(Ap(n,e).reduce((a,o)=>a+o,0)/(Oi(n,C1)*Oi(e,C1)));return t&&r<0&&(i=2*Math.PI-i),i}function hU(n,e){return n.every((t,r)=>t===e[r])}function Iu(n,e=!0){return e?[-n[1],n[0]]:[n[1],-n[0]]}function sO(n,e){return n.map(t=>t%e)}function zl(n){return[n[0],n[1]]}function Wl(n){return tO(n)?[n[0],n[1],0]:n}function A1(n,e){const[t,r]=n,[i,a]=e,o=In(t,r),s=In(i,a);return oO(o,s).every(l=>l===0)}function Np(n,e,t=!1){if(A1(n,e))return;const[r,i]=n,[a,o]=e,s=((r[0]-a[0])*(a[1]-o[1])-(r[1]-a[1])*(a[0]-o[0]))/((r[0]-i[0])*(a[1]-o[1])-(r[1]-i[1])*(a[0]-o[0])),l=o[0]-a[0]?(r[0]-a[0]+s*(i[0]-r[0]))/(o[0]-a[0]):(r[1]-a[1]+s*(i[1]-r[1]))/(o[1]-a[1]);if(!(!t&&(!ia(s,0,1)||!ia(l,0,1))))return[r[0]+s*(i[0]-r[0]),r[1]+s*(i[1]-r[1])]}function O1(n){if(Array.isArray(n))return ia(n[0],0,1)&&ia(n[1],0,1)?n:[.5,.5];const e=n.split("-"),t=e.includes("left")?0:e.includes("right")?1:.5,r=e.includes("top")?0:e.includes("bottom")?1:.5;return[t,r]}function Hi(n){const{x:e=0,y:t=0,z:r=0}=n.style||{};return[+e,+t,+r]}function N1(n,e){const[t,r]=e,{min:i,max:a}=n;return[i[0]+t*(a[0]-i[0]),i[1]+r*(a[1]-i[1])]}function Ma(n,e="center"){const t=O1(e);return N1(n,t)}function fU(n,e){const t=parseAnchor(e);return N1(n,t)}const dU=n=>{const[e,t]=n;return{left:Math.min(e[0],t[0]),right:Math.max(e[0],t[0]),top:Math.min(e[1],t[1]),bottom:Math.max(e[1],t[1])}};function zr(n){var e;return[n.x,n.y,(e=n.z)!=null?e:0]}function Bo(n){var e;return{x:n[0],y:n[1],z:(e=n[2])!=null?e:0}}function pU(n){return n.sort((e,t)=>e[0]-t[0]||e[1]-t[1])}function vU(n){const e=new Set;return n.filter(t=>{const r=t.join(",");return e.has(r)?!1:(e.add(r),!0)})}function Ul(n,e=0){return n.map(t=>parseFloat(t.toFixed(e)))}function Ja(n,e,t,r=!1){const i=r?In(n,e):In(e,n),a=Pa(i),o=[a[0]*t,a[1]*t];return ge(zl(n),o)}function R1(n,e){return n[1]===e[1]}function lO(n,e){return n[0]===e[0]}function cO(n,e){return R1(n,e)||lO(n,e)}function uO(n,e,t){return A1([n,e],[e,t])}function k1(n,e,t,r=!0){for(let i=0;i<t.length;i++){let a=t[i],o=t[(i+1)%t.length];r&&(a=ge(e,a),o=ge(e,o));const s=Np([e,n],[a,o]);if(s)return{point:s,line:[a,o]}}return{point:e,line:void 0}}function hO(n,e,t,r){const i=n[0],a=n[1];let o=!1;t===void 0&&(t=0),r===void 0&&(r=e.length);const s=r-t;for(let l=0,c=s-1;l<s;c=l++){const u=e[l+t][0],h=e[l+t][1],f=e[c+t][0],d=e[c+t][1];h>a!=d>a&&i<(f-u)*(a-h)/(d-h)+u&&(o=!o)}return o}function fO(n,e){const t=Ma(e,"center"),r=[Ma(e,"left-top"),Ma(e,"right-top"),Ma(e,"right-bottom"),Ma(e,"left-bottom")];return k1(n,t,r,!1).point}function Du(n,e){const t=e.center,r=In(n,e.center),i=Math.atan2(r[1],r[0]);if(isNaN(i))return t;const a=aa(e)/2,o=oa(e)/2,s=t[0]+a*Math.cos(i),l=t[1]+o*Math.sin(i);return[s,l]}function dO(n,e){let t=1/0,r=[n[0],e[0]];return n.forEach(i=>{e.forEach(a=>{const o=Oi(i,a);o<t&&(t=o,r=[i,a])})}),r}function pO(n,e){let t=1/0,r=[[0,0],[0,0]];return e.forEach(i=>{const a=vO(n,i);a<t&&(t=a,r=i)}),r}function vO(n,e){const t=L1(n,e);return Oi(n,t)}function L1(n,e){const[t,r]=e[0],[i,a]=e[1],[o,s]=n,l=i-t,c=a-r;if(l===0&&c===0)return[t,r];let u=((o-t)*l+(s-r)*c)/(l*l+c*c);u>1?u=1:u<0&&(u=0);const h=t+u*l,f=r+u*c;return[h,f]}function gO(n){const e=n.reduce((t,r)=>ge(t,r),[0,0]);return Rs(e,n.length)}function I1(n,e=!0){const t=gO(n);return n.sort(([r,i],[a,o])=>{const s=Math.atan2(i-t[1],r-t[0]),l=Math.atan2(o-t[1],a-t[0]);return e?l-s:s-l})}function D1(n,e){return[n,[n[0],e[1]],e,[e[0],n[1]]]}const B1=n=>n.map(e=>ue(e)?e.toLocaleLowerCase():e);class ks{constructor(e){k(this,"map",new Map);k(this,"emitter");k(this,"recordKey",new Set);k(this,"onKeyDown",e=>{e!=null&&e.key&&(this.recordKey.add(e.key),this.trigger(e))});k(this,"onKeyUp",e=>{e!=null&&e.key&&this.recordKey.delete(e.key)});k(this,"onWheel",e=>{this.triggerExtendKey(ht.WHEEL,e)});k(this,"onDrag",e=>{this.triggerExtendKey(ht.DRAG,e)});k(this,"onFocus",()=>{this.recordKey.clear()});this.emitter=e,this.bindEvents()}bind(e,t){e.length!==0&&this.map.set(e,t)}unbind(e,t){this.map.forEach((r,i)=>{vn(i,e)&&(!t||t===r)&&this.map.delete(i)})}unbindAll(){this.map.clear()}match(e){const t=B1(Array.from(this.recordKey)).sort(),r=B1(e).sort();return vn(t,r)}bindEvents(){const{emitter:e}=this;e.on(ht.KEY_DOWN,this.onKeyDown),e.on(ht.KEY_UP,this.onKeyUp),e.on(ht.WHEEL,this.onWheel),e.on(ht.DRAG,this.onDrag),window.addEventListener("focus",this.onFocus)}trigger(e){this.map.forEach((t,r)=>{this.match(r)&&t(e)})}triggerExtendKey(e,t){this.map.forEach((r,i)=>{i.includes(e)&&vn(Array.from(this.recordKey),i.filter(a=>a!==e))&&r(t)})}destroy(){this.unbindAll(),this.emitter.off(ht.KEY_DOWN,this.onKeyDown),this.emitter.off(ht.KEY_UP,this.onKeyUp),this.emitter.off(ht.WHEEL,this.onWheel),this.emitter.off(ht.DRAG,this.onDrag),window.removeEventListener("blur",this.onFocus)}}const Cg=class extends Ai{constructor(t,r){super(t,Ci({},Cg.defaultOptions,r));k(this,"startPoint");k(this,"endPoint");k(this,"rectShape");k(this,"shortcut");this.shortcut=new ks(t.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(t){if(!this.validate(t)||!this.isKeydown()||this.startPoint)return;const{canvas:r,graph:i}=this.context,a=at({},this.options.style);this.options.style.lineWidth&&(a.lineWidth=+this.options.style.lineWidth/i.getZoom()),this.rectShape=new ra({id:"g6-brush-select",style:a}),r.appendChild(this.rectShape),this.startPoint=[t.canvas.x,t.canvas.y]}onPointerMove(t){var a;if(!this.startPoint)return;const{immediately:r,mode:i}=this.options;this.endPoint=Bu(t),(a=this.rectShape)==null||a.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),r&&i==="default"&&this.updateElementsStates(D1(this.startPoint,this.endPoint))}onPointerUp(t){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=Bu(t),this.updateElementsStates(D1(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){const{graph:t}=this.context,r=Object.values(t.getData()).reduce((i,a)=>Object.assign({},i,a.reduce((o,s)=>(o[it(s)]=[],o),{})),{});t.setElementState(r,this.options.animation)}updateElementsStates(t){const{graph:r}=this.context,{enableElements:i,state:a,mode:o,onSelect:s}=this.options,l=this.selector(r,t,i);let c={};switch(o){case"union":l.forEach(u=>{c[u]=[...r.getElementState(u),a]});break;case"diff":l.forEach(u=>{const h=r.getElementState(u);c[u]=h.includes(a)?h.filter(f=>f!==a):[...h,a]});break;case"intersect":l.forEach(u=>{const h=r.getElementState(u);c[u]=h.includes(a)?[a]:[]});break;case"default":default:l.forEach(u=>{c[u]=[a]});break}jt(s)&&(c=s(c)),r.setElementState(c,this.options.animation)}selector(t,r,i){if(!i||i.length===0)return[];const a=[],o=t.getData();if(i.forEach(s=>{o[`${s}s`].forEach(l=>{const c=it(l);t.getElementVisibility(c)!=="hidden"&&hO(t.getElementPosition(c),r)&&a.push(c)})}),i.includes("edge")){const s=o.edges;s==null||s.forEach(l=>{const{source:c,target:u}=l;a.includes(c)&&a.includes(u)&&a.push(it(l))})}return a}clearBrush(){var t;(t=this.rectShape)==null||t.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){const{trigger:t}=this.options,r=Array.isArray(t)?t:[t];return this.shortcut.match(r.filter(i=>i!=="drag"))}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}bindEvents(){const{graph:t}=this.context;t.on(ht.POINTER_DOWN,this.onPointerDown),t.on(ht.POINTER_MOVE,this.onPointerMove),t.on(ht.POINTER_UP,this.onPointerUp),t.on(wa.CLICK,this.clearStates)}unbindEvents(){const{graph:t}=this.context;t.off(ht.POINTER_DOWN,this.onPointerDown),t.off(ht.POINTER_MOVE,this.onPointerMove),t.off(ht.POINTER_UP,this.onPointerUp),t.off(wa.CLICK,this.clearStates)}update(t){this.unbindEvents(),this.options=Ci(this.options,t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}};let Vl=Cg;k(Vl,"defaultOptions",{animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}});const Bu=n=>[n.canvas.x,n.canvas.y],Ca=.8,Fo=["node","edge","combo"];function Ls(n,e,t,r,i=0){r==="TB"&&e(n,i);const a=t(n);if(a)for(const o of a)Ls(o,e,t,r,i+1);r==="BT"&&e(n,i)}function mO(n,e,t){const r=[[n,0]];for(;r.length;){const[i,a]=r.shift();e(i,a);const o=t(i);if(o)for(const s of o)r.push([s,a+1])}}function F1(n,e,t,r){if(e==="combo"||e==="node")return Rp(n,t,r);const i=n.getEdgeData(t);if(!i)return[];const a=Rp(n,i.source,r-1),o=Rp(n,i.target,r-1);return Array.from(new Set([...a,...o,t]))}function Rp(n,e,t){const r=new Set,i=new Set,a=new Set;return mO(e,(o,s)=>{s>t||(a.add(o),n.getRelatedEdgesData(o).forEach(l=>{const c=it(l);!i.has(c)&&s<t&&(a.add(c),i.add(c))}))},o=>n.getRelatedEdgesData(o).map(s=>s.source===o?s.target:s.source).filter(s=>r.has(s)?!1:(r.add(s),!0))),Array.from(a)}function kp(n){return n.states||[]}const Ag=class extends Ai{constructor(t,r){super(t,Object.assign({},Ag.defaultOptions,r));k(this,"shortcut");k(this,"onClickSelect",t=>Pt(this,null,function*(){var r,i;this.validate(t)&&(yield this.updateState(t),(i=(r=this.options).onClick)==null||i.call(r,t))}));k(this,"onClickCanvas",t=>Pt(this,null,function*(){var r,i;this.validate(t)&&(yield this.clearState(),(i=(r=this.options).onClick)==null||i.call(r,t))}));this.shortcut=new ks(t.graph),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Fo.forEach(r=>{t.on(`${r}:${ht.CLICK}`,this.onClickSelect)}),t.on(wa.CLICK,this.onClickCanvas)}get isMultipleSelect(){const{multiple:t,trigger:r}=this.options;return t&&this.shortcut.match(r)}getNeighborIds(t){const{target:r,targetType:i}=t,{graph:a}=this.context,{degree:o}=this.options;return F1(a,i,r.id,typeof o=="function"?o(t):o).filter(s=>s!==r.id)}updateState(t){return Pt(this,null,function*(){const{state:r,unselectedState:i,neighborState:a,animation:o}=this.options;if(!r&&!a&&!i)return;const{target:s}=t,{graph:l}=this.context,c=l.getElementData(s.id),u=kp(c).includes(r)?"unselect":"select",h={},f=this.isMultipleSelect,d=[s.id],p=this.getNeighborIds(t);if(f)if(Object.assign(h,this.getDataStates()),u==="select"){const v=(g,m)=>{g.forEach(x=>{const _=new Set(l.getElementState(x));_.add(m),_.delete(i),h[x]=Array.from(_)})};v(d,r),v(p,a),i&&Object.keys(h).forEach(g=>{const m=h[g];!m.includes(r)&&!m.includes(a)&&!m.includes(i)&&h[g].push(i)})}else{const v=h[s.id];h[s.id]=v.filter(g=>g!==r&&g!==a),v.includes(i)||h[s.id].push(i),p.forEach(g=>{h[g]=h[g].filter(m=>m!==a),h[g].includes(r)||h[g].push(i)})}else if(u==="select"){Object.assign(h,this.getClearStates(!!i));const v=(g,m)=>{g.forEach(x=>{h[x]||(h[x]=l.getElementState(x)),h[x].push(m)})};v(d,r),v(p,a),i&&Object.keys(h).forEach(g=>{!d.includes(g)&&!p.includes(g)&&h[g].push(i)})}else Object.assign(h,this.getClearStates());yield l.setElementState(h,o)})}getDataStates(){const{graph:t}=this.context,{nodes:r,edges:i,combos:a}=t.getData(),o={};return[...r,...i,...a].forEach(s=>{o[it(s)]=kp(s)}),o}getClearStates(t=!1){const{graph:r}=this.context,{state:i,unselectedState:a,neighborState:o}=this.options,s=new Set([i,a,o]),{nodes:l,edges:c,combos:u}=r.getData(),h={};return[...l,...c,...u].forEach(f=>{const d=kp(f),p=d.filter(v=>!s.has(v));(t||p.length!==d.length)&&(h[it(f)]=p)}),h}clearState(){return Pt(this,null,function*(){const{graph:t}=this.context;yield t.setElementState(this.getClearStates(),this.options.animation)})}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}unbindEvents(){const{graph:t}=this.context;Fo.forEach(r=>{t.off(`${r}:${ht.CLICK}`,this.onClickSelect)}),t.off(wa.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}};let Fu=Ag;k(Fu,"defaultOptions",{animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0});function oi(n){var e;return!!((e=n.style)!=null&&e.collapsed)}var wr=function(n,e,t){for(var r=0,i=ue(e)?e.split("."):e;n&&r<i.length;)n=n[i[r++]];return n===void 0||r<i.length?t:n},Hl=function(n,e,t){var r=n,i=ue(e)?e.split("."):e;return i.forEach(function(a,o){o<i.length-1?(dn(r[a])||(r[a]=fe(i[o+1])?[]:{}),r=r[a]):r[a]=t}),n},yO=function(n){var e=x1(n);return e.charAt(0).toLowerCase()+e.substring(1)},xO=yO;function Yl(n,e){if(!n.startsWith(e))return!1;const t=n[e.length];return t>="A"&&t<="Z"}function G1(n,e){return`${e}${Cu(n)}`}function z1(n,e,t=!0){if(!e||!Yl(n,e))return n;const r=n.slice(e.length);return t?xO(r):r}function Dn(n,e){const t=Object.entries(n).reduce((r,[i,a])=>(i==="className"||i==="class"||Yl(i,e)&&Object.assign(r,{[z1(i,e)]:a}),r),{});if("opacity"in n){const r=G1("opacity",e),i=n.opacity;if(r in n){const a=n[r];Object.assign(t,{opacity:i*a})}else Object.assign(t,{opacity:i})}return t}function Lp(n,e){const t=e.length;return Object.keys(n).reduce((r,i)=>{if(i.startsWith(e)){const a=i.slice(t);r[a]=n[i]}return r},{})}function Ip(n,e){const t=typeof e=="string"?[e]:e,r={};return Object.keys(n).forEach(i=>{t.find(a=>i.startsWith(a))||(r[i]=n[i])}),r}function gU(n,e,t){return Object.entries(n).reduce((r,[i,a])=>(Yl(i,e)?r[G1(z1(i,e,!1),t)]=a:r[i]=a,r),{})}function Aa(n=0){if(typeof n=="number")return[n,n,n];const[e,t=e,r=e]=n;return[e,t,r]}function W1(n,e){const{datum:t,graph:r}=e;return typeof n=="function"?n.call(r,t):Object.fromEntries(Object.entries(n).map(([i,a])=>typeof a=="function"?[i,a.call(r,t)]:[i,a]))}function jn(n,e){const t=(n==null?void 0:n.style)||{},r=(e==null?void 0:e.style)||{};return Object.assign({},n,e,{style:Object.assign({},t,r)})}function bO(n){const f=n,{x:e,y:t,z:r,class:i,className:a,transform:o,transformOrigin:s,context:l,zIndex:c,visibility:u}=f;return Ce(f,["x","y","z","class","className","transform","transformOrigin","context","zIndex","visibility"])}const Is="cachedStyle",Gu=n=>`__${n}__`;function U1(n,e){const t=Array.isArray(e)?e:[e];wr(n,Is)||Hl(n,Is,{}),t.forEach(r=>{Hl(wr(n,Is),Gu(r),n.attributes[r])})}function zu(n,e){return wr(n,[Is,Gu(e)])}function V1(n,e){return Gu(e)in(wr(n,Is)||{})}function H1(n,e,t){Hl(n,[Is,Gu(e)],t)}function si(n){return function(e,t,r){const i=r.value;return r.value=function(a,...o){const s=`${t}_invoke`;if(!zu(this,s))return H1(this,s,!0),i.call(this,a,...o);const l=`${t}_style`,c=zu(this,l),u=n(this,a);return H1(this,l,u),Y1(c,u)?null:i.call(this,a,...o)},r}}const Y1=(n,e,t=2)=>{if(typeof n!="object"||typeof e!="object")return n===e;const r=Object.keys(n),i=Object.keys(e);if(r.length!==i.length)return!1;for(const a of r){const o=n[a],s=e[a];if(t>1&&typeof o=="object"&&typeof s=="object"){if(!Y1(o,s,t-1))return!1}else if(o!==s)return!1}return!0};function EO(n,e){const t=Aa(n);let r={};return e.text&&!e.fontSize&&(r={fontSize:Math.min(...t)*.5}),e.src&&(!e.width||!e.height)&&(r={width:t[0]*.5,height:t[1]*.5}),r}var wO=Object.prototype.hasOwnProperty;function _O(n,e){if(!e||!xr(n))return{};for(var t={},r=jt(e)?e:function(s){return s[e]},i,a=0;a<n.length;a++){var o=n[a];i=r(o),wO.call(t,i)?t[i].push(o):t[i]=[o]}return t}var Dp=_O;function X1(n){if(n)return typeof n=="string"||typeof n=="function"||Array.isArray(n)?{type:"group",field:e=>e.id,color:n,invert:!1}:n}function SO(n,e){if(!e)return{};const{type:t,color:r,field:i,invert:a}=e,o=l=>{const c=typeof r=="string"?_a("palette",r):r;if(typeof c=="function"){const u={};return l.forEach(([h,f])=>{u[h]=c(a?1-f:f)}),u}else if(Array.isArray(c)){const u=a?[...c].reverse():c,h={};return l.forEach(([f,d])=>{h[f]=u[d%c.length]}),h}return{}},s=(l,c)=>{var u;return typeof l=="string"?(u=c.data)==null?void 0:u[l]:l==null?void 0:l(c)};if(t==="group"){const l=Dp(n,f=>{if(!i)return"default";const d=s(i,f);return d?String(d):"default"}),c=Object.keys(l),u=o(c.map((f,d)=>[f,d])),h={};return Object.entries(l).forEach(([f,d])=>{d.forEach(p=>{h[it(p)]=u[f]})}),h}else if(t==="value"){const[l,c]=n.reduce(([h,f],d)=>{const p=s(i,d);if(typeof p!="number")throw new Error(Sa(`Palette field ${i} is not a number`));return[Math.min(h,p),Math.max(f,p)]},[1/0,-1/0]),u=c-l;return o(n.map(h=>[h.id,(s(i,h)-l)/u]))}}function j1(n){const e=typeof n=="string"?_a("palette",n):n;if(typeof e!="function")return e}function $1(n,e){let t=2*n;return typeof e=="string"?t=n*Number(e.replace("%",""))/100:typeof e=="number"&&(t=e),isNaN(t)&&(t=2*n),t}function K1(n,e,t=1,r=!1){const i=r?t:1,a=(n.max[0]-n.min[0])*i;return $1(a,e)}function TO(n,e,t=1){const r=Oi(n[0],n[1])*t;return $1(r,e)}const Xl=new WeakMap;function jl(n,e,t=!1,r){if(e===void 0)return;const i=(a,o=e)=>{const s=(l=o)=>a.childNodes.forEach(c=>i(c,l));if(r&&!r(a))return s();if(!t&&a===n)n.style.visibility=e,Xl.delete(n),s(e);else{Xl.has(a)||Xl.set(a,a.style.visibility);const l=o==="hidden"||PO(a)==="hidden"?"hidden":"visible";a.style.visibility=l,s(l)}};i(n)}function PO(n){return Xl.has(n)?Xl.get(n):n.style.visibility}var MO={}.toString,CO=function(n){return MO.call(n).replace(/^\[object /,"").replace(/]$/,"")},AO=CO,OO=Object.prototype,NO=function(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||OO;return n===t},RO=NO,kO=Object.prototype.hasOwnProperty;function LO(n){if(Mt(n))return!0;if(Bl(n))return!n.length;var e=AO(n);if(e==="Map"||e==="Set")return!n.size;if(RO(n))return!Object.keys(n).length;for(var t in n)if(kO.call(n,t))return!1;return!0}var Bp=LO;class $l extends CC{constructor(t){super(t);k(this,"shapeMap",{});k(this,"animateMap",{});this.transformPosition(this.attributes),this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(t,r,i,a,o){var c,u,h,f,d,p,v,g;const s=this.shapeMap[t];if(i===!1){s&&((c=o==null?void 0:o.beforeDestroy)==null||c.call(o,s),a.removeChild(s),delete this.shapeMap[t],(u=o==null?void 0:o.afterDestroy)==null||u.call(o,s));return}const l=typeof r=="string"?_a(Ms.SHAPE,r):r;if(!l)throw new Error(Sa(`Shape ${r} not found`));if(!s||s.destroyed||!(s instanceof l)){s&&((h=o==null?void 0:o.beforeDestroy)==null||h.call(o,s),s==null||s.destroy(),(f=o==null?void 0:o.afterDestroy)==null||f.call(o,s)),(d=o==null?void 0:o.beforeCreate)==null||d.call(o);const m=new l({className:t,style:i});return a.appendChild(m),this.shapeMap[t]=m,(p=o==null?void 0:o.afterCreate)==null||p.call(o,m),m}return(v=o==null?void 0:o.beforeUpdate)==null||v.call(o,s),qp(s,i),(g=o==null?void 0:o.afterUpdate)==null||g.call(o,s),s}transformPosition(t){const{x:r=0,y:i=0,z:a=0,transform:o}=t;(r!==0||i!==0||a!==0)&&(this.style.transform=Sp(+r,+i,+a,o))}update(t={}){const r=Object.assign({},this.attributes,t);this.attr(r),this.render(r,this),this.transformPosition(r),this.setVisibility()}bindEvents(){}getGraphicStyle(t){return bO(t)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(t,r){if(t.length===0)return null;const i=[];if(t[0].x!==void 0||t[0].y!==void 0||t[0].z!==void 0){const{x:o=0,y:s=0,z:l=0}=this.attributes;t.forEach(c=>{const{x:u=o,y:h=s,z:f=l}=c;Object.assign(c,{transform:Sp(+u,+h,+f)})})}const a=super.animate(t,r);if(a&&(Fp(this,a),i.push(a)),Array.isArray(t)&&t.length>0){const o=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(t[0]).some(s=>!o.includes(s))){Object.entries(this.shapeMap).forEach(([l,c])=>{const u=`get${Cu(l)}Style`,h=this[u];if(jt(h)){const f=t.map(p=>h.call(this,at(at({},this.attributes),p))),d=c.animate(wp(f),r);d&&(Fp(c,d),i.push(d))}});const s=(l,c)=>{if(!Bp(l)){const u=`get${Cu(c)}Style`,h=this[u];if(jt(h)){const f=t.map(d=>h.call(this,at(at({},this.attributes),d)));Object.entries(f[0]).map(([d])=>{const p=f.map(g=>g[d]),v=l[d];if(v){const g=v.animate(wp(p),r);g&&(Fp(v,g),i.push(g))}})}}};this.compositeShapes.forEach(([l,c])=>{const u=Lp(this.shapeMap,c);s(u,l)})}}return Ep(i)}getShape(t){return this.shapeMap[t]}setVisibility(){const{visibility:t}=this.attributes;jl(this,t,!0)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function Fp(n,e){e==null||e.finished.then(()=>{const t=n.activeAnimations.findIndex(r=>r===e);t>-1&&n.activeAnimations.splice(t,1)})}const Og=class extends $l{constructor(e){super(jn({style:Og.defaultStyleProps},e))}isTextStyle(e){return Yl(e,"label")}isBackgroundStyle(e){return Yl(e,"background")}getTextStyle(e){const i=this.getGraphicStyle(e),{padding:t}=i,r=Ce(i,["padding"]);return Ip(r,"background")}getBackgroundStyle(e){if(e.background===!1)return!1;const t=this.getGraphicStyle(e),{wordWrap:r,wordWrapWidth:i,padding:a}=t,o=Dn(t,"background"),{min:[s,l],center:[c,u],halfExtents:[h,f]}=this.shapeMap.text.getGeometryBounds(),[d,p,v,g]=Ns(a),m=h*2+g+p,{width:x,height:_}=o;x&&_?Object.assign(o,{x:c-Number(x)/2,y:u-Number(_)/2}):Object.assign(o,{x:s-g,y:l-d,width:r?Math.min(m,i+g+p):m,height:f*2+d+v});const{radius:S}=o;if(typeof S=="string"&&S.endsWith("%")){const b=Number(S.replace("%",""))/100;o.radius=Math.min(+o.width,+o.height)*b}return o}render(e=this.parsedAttributes,t=this){this.upsert("text",Ll,this.getTextStyle(e),t),this.upsert("background",ra,this.getBackgroundStyle(e),t)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}};let Qa=Og;k(Qa,"defaultStyleProps",{padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0});const Ng=class extends $l{constructor(e){super(jn({style:Ng.defaultStyleProps},e))}getBadgeStyle(e){return this.getGraphicStyle(e)}render(e=this.parsedAttributes,t=this){this.upsert("label",Qa,this.getBadgeStyle(e),t)}getGeometryBounds(){const e=this.getShape("label");return(e.getShape("background")||e.getShape("text")).getGeometryBounds()}};let Ds=Ng;k(Ds,"defaultStyleProps",{padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1});function IO(n,e=!0){const t=[];return n.forEach((r,i)=>{t.push([i===0?"M":"L",...r])}),e&&t.push(["Z"]),t}const Z1={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};function DO(n){const e=n.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),t=[];let r="",i={};for(;e.length>0;){let a=e.shift();a in Z1?r=a:e.unshift(a),i={type:r},Z1[r].forEach(l=>{a=e.shift(),i[l]=a}),r==="M"?r="L":r==="m"&&(r="l");const[o,...s]=Object.values(i);t.push([o,...s.map(Number)])}return t}function BO(n){const e=[];return(typeof n=="string"?DO(n):n).forEach(r=>{const i=r[0];if(i==="Z"){e.push(e[0]);return}if(i!=="A")for(let a=1;a<r.length;a=a+2)e.push([r[a],r[a+1],0]);else{const a=r.length;e.push([r[a-2],r[a-1],0])}}),e}const q1=n=>{if(n.length<2)return[["M",0,0],["L",0,0]];const e=n[0],t=n[1],r=n[n.length-1],i=n[n.length-2];n.unshift(i,r),n.push(e,t);const a=[["M",r[0],r[1]]];for(let o=1;o<n.length-2;o+=1){const[s,l]=n[o-1],[c,u]=n[o],[h,f]=n[o+1],[d,p]=o!==n.length-2?n[o+2]:[h,f],v=c+(h-s)/6,g=u+(f-l)/6,m=h-(d-c)/6,x=f-(p-u)/6;a.push(["C",v,g,m,x,h,f])}return a};function FO(n,e,t,r,i,a,o){const[s,l]=Ma(n,e),c={textAlign:e==="left"?"right":e==="right"?"left":"center",textBaseline:e==="top"?"bottom":e==="bottom"?"top":"middle",transform:`translate(${s+t}, ${l+r})`};if(e==="center"||!i)return c;const u=BO(a);if(!u||u.length<=3)return c;const h=u.map((p,v)=>{const g=p,m=u[(v+1)%u.length];return vn(g,m)?null:[g,m]}).filter(Boolean),f=pO([s,l],h),d=L1([s,l],f);if(d&&f&&(c.transform=`translate(${d[0]+t}, ${d[1]+r})`,o)){const p=Math.atan((f[0][1]-f[1][1])/(f[0][0]-f[1][0]));c.transform+=`rotate(${p/Math.PI*180}deg)`,c.textAlign="center",(e==="right"||e==="left")&&(p>0?c.textBaseline=e==="right"?"bottom":"top":c.textBaseline=e==="right"?"top":"bottom")}return c}const Rg=class extends $l{constructor(e){super(jn({style:Rg.defaultStyleProps},e))}getLabelStyle(e){if(!e.label||!e.d||e.d.length===0)return!1;const h=Dn(this.getGraphicStyle(e),"label"),{maxWidth:t,offsetX:r,offsetY:i,autoRotate:a,placement:o,closeToPath:s}=h,l=Ce(h,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),c=this.shapeMap.key,u=c==null?void 0:c.getRenderBounds();return Object.assign(FO(u,o,r,i,s,e.d,a),{wordWrapWidth:K1(u,t)},l)}getKeyStyle(e){return this.getGraphicStyle(e)}render(e,t){this.upsert("key",Xa,this.getKeyStyle(e),t),this.upsert("label",Qa,this.getLabelStyle(e),t)}};let Kl=Rg;k(Kl,"defaultStyleProps",{label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0});function GO(n){const e=[],t=r=>{r!=null&&r.children.length&&r.children.forEach(i=>{e.push(i),t(i)})};return t(n),e}function zO(n){const e=[];let t=n.parentNode;for(;t;)e.push(t),t=t.parentNode;return e}class Gp extends sp{constructor(t){super(t);k(this,"onMounted",()=>{this.handleRadius()});k(this,"onAttrModified",()=>{this.handleRadius()});Bs=this,this.isMutationObserved=!0,this.addEventListener(oe.MOUNTED,this.onMounted),this.addEventListener(oe.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){const{radius:t,clipPath:r,width:i=0,height:a=0}=this.attributes;if(t&&i&&a){const[o,s]=this.getBounds().min,l={x:o,y:s,radius:t,width:i,height:a};if(r)Object.assign(this.parsedStyle.clipPath.style,l);else{const c=new ra({style:l});this.style.clipPath=c}}else r&&(this.style.clipPath=null)}}const zp=new WeakMap;let Bs=null;const Wp=n=>{if(Bs&&zO(Bs).includes(n)){const e=zp.get(n);e?e.includes(Bs)||e.push(Bs):zp.set(n,[Bs])}},Up=n=>{const e=zp.get(n);e&&e.forEach(t=>t.handleRadius())};class J1 extends $l{constructor(e){super(e)}isImage(){const{src:e}=this.attributes;return!!e}getIconStyle(e=this.attributes){const{width:t=0,height:r=0}=e,i=this.getGraphicStyle(e);return this.isImage()?at({x:-t/2,y:-r/2},i):at({textBaseline:"middle",textAlign:"center"},i)}render(e=this.attributes,t=this){this.upsert("icon",this.isImage()?Gp:Ll,this.getIconStyle(e),t)}}class Q1 extends $l{get context(){return this.attributes.context}get parsedAttributes(){return this.attributes}onframe(){}animate(e,t){const r=super.animate(e,t);return r&&(r.onframe=()=>this.onframe(),r.finished.then(()=>this.onframe())),r}}var Fs=function(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(o=n[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};const kg=class extends Q1{constructor(t){super(jn({style:kg.defaultStyleProps},t));k(this,"type","node")}getSize(t=this.attributes){const{size:r}=t;return Aa(r)}getKeyStyle(t){const r=this.getGraphicStyle(t);return Object.assign(Ip(r,["label","halo","icon","badge","port"]))}getLabelStyle(t){if(t.label===!1||!t.labelText)return!1;const c=Dn(this.getGraphicStyle(t),"label"),{placement:r,maxWidth:i,offsetX:a,offsetY:o}=c,s=Ce(c,["placement","maxWidth","offsetX","offsetY"]),l=this.getShape("key").getLocalBounds();return Object.assign(bx(l,r,a,o),{wordWrapWidth:K1(l,i)},s)}getHaloStyle(t){if(t.halo===!1)return!1;const o=this.getKeyStyle(t),{fill:r}=o,i=Ce(o,["fill"]),a=Dn(this.getGraphicStyle(t),"halo");return at(Se(at({},i),{stroke:r}),a)}getIconStyle(t){if(t.icon===!1||!t.iconText&&!t.iconSrc)return!1;const r=Dn(this.getGraphicStyle(t),"icon");return Object.assign(EO(t.size,r),r)}getBadgesStyle(t){var h;const r=Lp(this.shapeMap,"badge-"),i={};if(Object.keys(r).forEach(d=>{i[d]=!1}),t.badge===!1||!((h=t.badges)!=null&&h.length))return i;const f=t,{badges:a=[],badgePalette:o,opacity:s=1}=f,l=Ce(f,["badges","badgePalette","opacity"]),c=j1(o),u=Dn(this.getGraphicStyle(l),"badge");return a.forEach((d,p)=>{i[p]=at(at({backgroundFill:c?c[p%(c==null?void 0:c.length)]:void 0,opacity:s},u),this.getBadgeStyle(d))}),i}getBadgeStyle(t){const r=this.getShape("key"),c=t,{placement:i="top",offsetX:a,offsetY:o}=c,s=Ce(c,["placement","offsetX","offsetY"]),l=bx(r.getLocalBounds(),i,a,o,!0);return at(at({},l),s)}getPortsStyle(t){var s;const r=this.getPorts(),i={};if(Object.keys(r).forEach(l=>{i[l]=!1}),t.port===!1||!((s=t.ports)!=null&&s.length))return i;const a=Dn(this.getGraphicStyle(t),"port"),{ports:o=[]}=t;return o.forEach((l,c)=>{const u=l.key||c,h=at(at({},a),l);if(mx(h))i[u]=!1;else{const[f,d]=this.getPortXY(t,l);i[u]=at({transform:`translate(${f}, ${d})`},h)}}),i}getPortXY(t,r){const{placement:i="left"}=r,a=this.getShape("key");return $p(WO(this.context,a),i)}getPorts(){return Lp(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(t){const r=this.getShape("key").getBounds();return fO(t,r)}drawHaloShape(t,r){const i=this.getShape("key");this.upsert("halo",i.constructor,this.getHaloStyle(t),r)}drawIconShape(t,r){this.upsert("icon",J1,this.getIconStyle(t),r),Wp(this)}drawBadgeShapes(t,r){const i=this.getBadgesStyle(t);Object.keys(i).forEach(a=>{this.upsert(`badge-${a}`,Ds,i[a],r)})}drawPortShapes(t,r){const i=this.getPortsStyle(t);Object.keys(i).forEach(a=>{this.upsert(`port-${a}`,Rl,i[a],r)})}drawLabelShape(t,r){this.upsert("label",Qa,this.getLabelStyle(t),r)}_drawKeyShape(t,r){return this.drawKeyShape(t,r)}render(t=this.parsedAttributes,r=this){this._drawKeyShape(t,r),this.getShape("key")&&(this.drawHaloShape(t,r),this.drawIconShape(t,r),this.drawBadgeShapes(t,r),this.drawLabelShape(t,r),this.drawPortShapes(t,r))}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&Up(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}};let $n=kg;k($n,"defaultStyleProps",{x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0}),Fs([si((n,e)=>n.getHaloStyle(e))],$n.prototype,"drawHaloShape",null),Fs([si((n,e)=>n.getIconStyle(e))],$n.prototype,"drawIconShape",null),Fs([si((n,e)=>n.getBadgesStyle(e))],$n.prototype,"drawBadgeShapes",null),Fs([si((n,e)=>n.getPortsStyle(e))],$n.prototype,"drawPortShapes",null),Fs([si((n,e)=>n.getLabelStyle(e))],$n.prototype,"drawLabelShape",null),Fs([si((n,e)=>n.getKeyStyle(e))],$n.prototype,"_drawKeyShape",null);function WO(n,e){if(!n)return e.getLocalBounds();const t=n.canvas.getLayer(),r=e.cloneNode();jl(r,"hidden"),t.appendChild(r);const i=r.getLocalBounds();return t.removeChild(r),i}const Lg=class extends $n{constructor(e){super(jn({style:Lg.defaultStyleProps},e))}drawKeyShape(e,t){return this.upsert("key",Rl,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e);return Se(at({},t),{r:Math.min(...this.getSize(e))/2})}getIconStyle(e){const t=super.getIconStyle(e),{r}=this.getShape("key").attributes,i=r*2*Ca;return t?at({width:i,height:i},t):!1}getIntersectPoint(e){const t=this.getShape("key").getBounds();return Du(e,t)}};let Gs=Lg;k(Gs,"defaultStyleProps",{size:32});class Wu extends $n{constructor(e){super(e)}get parsedAttributes(){return this.attributes}drawKeyShape(e,t){return this.upsert("key",uu,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e);return Se(at({},t),{points:this.getPoints(e)})}getIntersectPoint(e){var i,a;const{points:t}=this.getShape("key").attributes,r=[+(((i=this.attributes)==null?void 0:i.x)||0),+(((a=this.attributes)==null?void 0:a.y)||0)];return k1(e,r,t).point}}class UO extends Wu{constructor(e){super(e)}getPoints(e){const[t,r]=this.getSize(e);return VN(t,r)}}const Ig=class extends Gs{constructor(e){super(jn({style:Ig.defaultStyleProps},e))}parseOuterR(){const{size:e}=this.parsedAttributes;return Math.min(...Aa(e))/2}parseInnerR(){const{innerR:e}=this.parsedAttributes;return ue(e)?parseInt(e)/100*this.parseOuterR():e}drawDonutShape(e,t){const{donuts:r}=e;if(!(r!=null&&r.length))return;const i=r.map(h=>fe(h)?{value:h}:h),a=Dn(this.getGraphicStyle(e),"donut"),o=j1(e.donutPalette);if(!o)return;const s=i.reduce((h,f)=>{var d;return h+((d=f.value)!=null?d:0)},0),l=this.parseOuterR(),c=this.parseInnerR();let u=0;i.forEach((h,f)=>{const m=h,{value:d=0,color:p=o[f%o.length]}=m,v=Ce(m,["value","color"]),g=(s===0?1/i.length:d/s)*360;this.upsert(`round${f}`,Xa,at(Se(at({},a),{d:YO(l,c,u,u+g),fill:p}),v),t),u+=g})}render(e,t=this){super.render(e,t),this.drawDonutShape(e,t)}};let Uu=Ig;k(Uu,"defaultStyleProps",{innerR:"50%",donuts:[],donutPalette:"tableau"});const Vu=(n,e,t,r)=>[n+Math.sin(r)*t,e-Math.cos(r)*t],VO=(n,e,t,r)=>r<=0||t<=r?[["M",n-t,e],["A",t,t,0,1,1,n+t,e],["A",t,t,0,1,1,n-t,e],["Z"]]:[["M",n-t,e],["A",t,t,0,1,1,n+t,e],["A",t,t,0,1,1,n-t,e],["Z"],["M",n+r,e],["A",r,r,0,1,0,n-r,e],["A",r,r,0,1,0,n+r,e],["Z"]],HO=(n,e,t,r,i,a)=>{const[o,s]=[i/360*2*Math.PI,a/360*2*Math.PI],l=[Vu(n,e,r,o),Vu(n,e,t,o),Vu(n,e,t,s),Vu(n,e,r,s)],c=s-o>Math.PI?1:0;return[["M",l[0][0],l[0][1]],["L",l[1][0],l[1][1]],["A",t,t,0,c,1,l[2][0],l[2][1]],["L",l[3][0],l[3][1]],["A",r,r,0,c,0,l[0][0],l[0][1]],["Z"]]},YO=(n=0,e=0,t,r)=>{const[i,a]=[0,0];return Math.abs(t-r)%360<1e-6?VO(i,a,n,e):HO(i,a,n,e,t,r)},Dg=class extends $n{constructor(e){super(jn({style:Dg.defaultStyleProps},e))}drawKeyShape(e,t){return this.upsert("key",ap,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e),[r,i]=this.getSize(e);return Se(at({},t),{rx:r/2,ry:i/2})}getIconStyle(e){const t=super.getIconStyle(e),{rx:r,ry:i}=this.getShape("key").attributes,a=Math.min(+r,+i)*2*Ca;return t?at({width:a,height:a},t):!1}getIntersectPoint(e){const t=this.getShape("key").getBounds();return Du(e,t)}};let Hu=Dg;k(Hu,"defaultStyleProps",{size:[45,35]});class XO extends Wu{constructor(e){super(e)}getOuterR(e){return e.outerR||Math.min(...this.getSize(e))/2}getPoints(e){return YN(this.getOuterR(e))}getIconStyle(e){const t=super.getIconStyle(e),r=this.getOuterR(e)*Ca;return t?at({width:r,height:r},t):!1}}function jO(n,e){if(n){var t;if(xr(n))for(var r=0,i=n.length;r<i&&(t=e(n[r],r),t!==!1);r++);else if(dn(n)){for(var a in n)if(n.hasOwnProperty(a)&&(t=e(n[a],a),t===!1))break}}}var tx=jO,$O=Object.prototype.hasOwnProperty,Vp=function(n,e){if(n===null||!Cs(n))return{};var t={};return tx(e,function(r){$O.call(n,r)&&(t[r]=n[r])}),t};const Bg=class extends $n{constructor(t){super(Se(at({},t),{style:Object.assign({},Bg.defaultStyleProps,t.style)}));k(this,"rootPointerEvent",new lu(null));k(this,"forwardEvents",t=>{const r=this.context.canvas,i=r.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(t,i).forEach(o=>{const s=this.bootstrapEvent(this.rootPointerEvent,o,i,t);r.context.eventService.mapEvent(s)})})}get eventService(){return this.context.canvas.context.eventService}get events(){return[ht.CLICK,ht.POINTER_DOWN,ht.POINTER_MOVE,ht.POINTER_UP,ht.POINTER_OVER,ht.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}getKeyStyle(t){const r=Vp(t,["innerHTML","pointerEvents","cursor"]),[i,a]=this.getSize(t);return Se(at({},r),{width:i,height:a})}drawKeyShape(t,r){const i=this.getKeyStyle(t),{width:a=0,height:o=0}=i,s=this.upsert("key-container",ra,{width:a,height:o,opacity:0},r);return this.upsert("key",op,i,s)}connectedCallback(){const t=this.getDomElement();this.events.forEach(r=>{t.addEventListener(r,this.forwardEvents)})}attributeChangedCallback(t,r,i){t==="zIndex"&&r!==i&&(this.getDomElement().style.zIndex=i)}destroy(){const t=this.getDomElement();this.events.forEach(r=>{t.removeEventListener(r,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(t,r){const i=[];if(r.isTouchEvent(t))for(let a=0;a<t.changedTouches.length;a++){const o=t.changedTouches[a];Nt(o.button)&&(o.button=0),Nt(o.buttons)&&(o.buttons=1),Nt(o.isPrimary)&&(o.isPrimary=t.touches.length===1&&t.type==="touchstart"),Nt(o.width)&&(o.width=o.radiusX||1),Nt(o.height)&&(o.height=o.radiusY||1),Nt(o.tiltX)&&(o.tiltX=0),Nt(o.tiltY)&&(o.tiltY=0),Nt(o.pointerType)&&(o.pointerType="touch"),Nt(o.pointerId)&&(o.pointerId=o.identifier||0),Nt(o.pressure)&&(o.pressure=o.force||.5),Nt(o.twist)&&(o.twist=0),Nt(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,o.type=t.type,i.push(o)}else if(r.isMouseEvent(t)){const a=t;Nt(a.isPrimary)&&(a.isPrimary=!0),Nt(a.width)&&(a.width=1),Nt(a.height)&&(a.height=1),Nt(a.tiltX)&&(a.tiltX=0),Nt(a.tiltY)&&(a.tiltY=0),Nt(a.pointerType)&&(a.pointerType="mouse"),Nt(a.pointerId)&&(a.pointerId=1),Nt(a.pressure)&&(a.pressure=.5),Nt(a.twist)&&(a.twist=0),Nt(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,i.push(a)}else i.push(t);return i}transferMouseData(t,r){t.isTrusted=r.isTrusted,t.srcElement=r.srcElement,t.timeStamp=performance.now(),t.type=r.type,t.altKey=r.altKey,t.metaKey=r.metaKey,t.shiftKey=r.shiftKey,t.ctrlKey=r.ctrlKey,t.button=r.button,t.buttons=r.buttons,t.client.x=r.clientX,t.client.y=r.clientY,t.movement.x=r.movementX,t.movement.y=r.movementY,t.page.x=r.pageX,t.page.y=r.pageY,t.screen.x=r.screenX,t.screen.y=r.screenY,t.relatedTarget=null}bootstrapEvent(t,r,i,a){t.view=i,t.originalEvent=null,t.nativeEvent=a,t.pointerId=r.pointerId,t.width=r.width,t.height=r.height,t.isPrimary=r.isPrimary,t.pointerType=r.pointerType,t.pressure=r.pressure,t.tangentialPressure=r.tangentialPressure,t.tiltX=r.tiltX,t.tiltY=r.tiltY,t.twist=r.twist,this.transferMouseData(t,r);const{x:o,y:s}=this.getViewportXY(r);t.viewport.x=o,t.viewport.y=s;const[l,c]=this.context.canvas.getCanvasByViewport([o,s]);return t.canvas.x=l,t.canvas.y=c,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=a.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t}getViewportXY(t){let r,i;const{offsetX:a,offsetY:o,clientX:s,clientY:l}=t;if(this.context.canvas.context.config.supportsCSSTransform&&!Mt(a)&&!Mt(o))r=a,i=o;else{const c=this.eventService.client2Viewport({x:s,y:l});r=c.x,i=c.y}return{x:r,y:i}}onframe(){super.onframe();const{opacity:t}=this.attributes;this.getDomElement().style.opacity=`${t}`}};let Yu=Bg;k(Yu,"defaultStyleProps",{size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"});const Fg=class extends $n{constructor(e){super(jn({style:Fg.defaultStyleProps},e))}getKeyStyle(e){const[t,r]=this.getSize(e),s=super.getKeyStyle(e),{fillOpacity:i,opacity:a=i}=s,o=Ce(s,["fillOpacity","opacity"]);return Se(at({opacity:a},o),{width:t,height:r,x:-t/2,y:-r/2})}getHaloStyle(e){if(e.halo===!1)return!1;const u=this.getShape("key").attributes,{fill:t,stroke:r}=u,i=Ce(u,["fill","stroke"]),a=Dn(this.getGraphicStyle(e),"halo"),o=Number(a.lineWidth),[s,l]=ge(this.getSize(e),[o,o]),c="transparent";return Se(at({},a),{width:s,height:l,fill:c,x:-s/2,y:-l/2})}getIconStyle(e){const t=super.getIconStyle(e),[r,i]=this.getSize(e);return t?at({width:r*Ca,height:i*Ca},t):!1}drawKeyShape(e,t){const r=this.upsert("key",Gp,this.getKeyStyle(e),t);return Wp(this),r}drawHaloShape(e,t){this.upsert("halo",ra,this.getHaloStyle(e),t)}update(e){super.update(e),e&&("x"in e||"y"in e||"z"in e)&&Up(this)}};let Xu=Fg;k(Xu,"defaultStyleProps",{size:32});class KO extends $n{constructor(e){super(e)}getKeyStyle(e){const[t,r]=this.getSize(e);return Se(at({},super.getKeyStyle(e)),{width:t,height:r,x:-t/2,y:-r/2})}getIconStyle(e){const t=super.getIconStyle(e),{width:r,height:i}=this.getShape("key").attributes;return t?at({width:r*Ca,height:i*Ca},t):!1}drawKeyShape(e,t){return this.upsert("key",ra,this.getKeyStyle(e),t)}}class ZO extends Wu{constructor(e){super(e)}getInnerR(e){return e.innerR||this.getOuterR(e)*3/8}getOuterR(e){return Math.min(...this.getSize(e))/2}getPoints(e){return GN(this.getOuterR(e),this.getInnerR(e))}getIconStyle(e){const t=super.getIconStyle(e),r=this.getInnerR(e)*2*Ca;return t?at({width:r,height:r},t):!1}getPortXY(e,t){const{placement:r="top"}=t,i=this.getShape("key").getLocalBounds(),a=zN(this.getOuterR(e),this.getInnerR(e));return $p(i,r,a,!1)}}const Gg=class extends Wu{constructor(e){super(jn({style:Gg.defaultStyleProps},e))}getPoints(e){const{direction:t}=e,[r,i]=this.getSize(e);return WN(r,i,t)}getPortXY(e,t){const{direction:r}=e,{placement:i="top"}=t,a=this.getShape("key").getLocalBounds(),[o,s]=this.getSize(e),l=UN(o,s,r);return $p(a,i,l,!1)}getIconStyle(e){const{icon:t,iconText:r,iconSrc:i,direction:a}=e;if(t===!1||Bp(r||i))return!1;const o=Dn(this.getGraphicStyle(e),"icon"),s=this.getShape("key").getLocalBounds(),[l,c]=rO(s,a),u=iO(s,a)*2*Ca;return at({x:l,y:c,width:u,height:u},o)}};let ju=Gg;k(ju,"defaultStyleProps",{size:40,direction:"up"});var qO=function(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(o=n[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};const zg=class extends $n{constructor(t){super(jn({style:zg.defaultStyleProps},t));k(this,"type","combo");this.updateComboPosition(this.parsedAttributes)}getKeySize(t){const{collapsed:r,childrenNode:i=[]}=t;return i.length===0?this.getEmptyKeySize(t):r?this.getCollapsedKeySize(t):this.getExpandedKeySize(t)}getEmptyKeySize(t){const{padding:r,collapsedSize:i}=t,[a,o,s,l]=Ns(r);return ge(Aa(i),[l+o,a+s,0])}getCollapsedKeySize(t){return Aa(t.collapsedSize)}getExpandedKeySize(t){const r=this.getContentBBox(t);return[aa(r),oa(r),0]}getContentBBox(t){const{context:r,childrenNode:i=[],padding:a}=t,o=i.map(l=>r.element.getElement(l)).filter(Boolean);if(o.length===0){const l=new Fe,{x:c=0,y:u=0,size:h}=t,[f,d]=Aa(h);return l.setMinMax([c-f/2,u-d/2,0],[c+f/2,u+d/2,0]),l}const s=Gl(o.map(l=>l.getBounds()));return a?Ru(s,a):s}drawCollapsedMarkerShape(t,r){this.upsert("collapsed-marker",J1,this.getCollapsedMarkerStyle(t),r),Wp(this)}getCollapsedMarkerStyle(t){if(!t.collapsed||!t.collapsedMarker)return!1;const c=Dn(this.getGraphicStyle(t),"collapsedMarker"),{type:r}=c,i=Ce(c,["type"]),a=this.getShape("key"),[o,s]=Ma(a.getLocalBounds(),"center"),l=Se(at({},i),{x:o,y:s});if(r){const u=this.getCollapsedMarkerText(r,t);Object.assign(l,{text:u})}return l}getCollapsedMarkerText(t,r){const{context:i,childrenData:a=[]}=r,{model:o}=i;return t==="descendant-count"?o.getDescendantsData(this.id).length.toString():t==="child-count"?a.length.toString():t==="node-count"?o.getDescendantsData(this.id).filter(s=>o.getElementType(it(s))==="node").length.toString():jt(t)?t(a):""}getComboZIndex(t){return(this.context.model.getAncestorsData(this.id,en)||[]).length}getComboPosition(t){const{x:r=0,y:i=0,collapsed:a,context:o,childrenData:s=[]}=t;if(s.length===0)return[+r,+i,0];if(a){const{model:l}=o,c=l.getDescendantsData(this.id).filter(u=>!l.isCombo(it(u)));if(c.length>0){const u=c.reduce((h,f)=>ge(h,Hi(f)),[0,0,0]);return Rs(u,c.length)}return[+r,+i,0]}return this.getContentBBox(t).center}getComboStyle(t){const{zIndex:r=this.getComboZIndex(t)}=t,[i,a]=this.getComboPosition(t);return{x:i,y:a,transform:`translate(${i}, ${a})`,zIndex:r}}updateComboPosition(t){const r=this.getComboStyle(t);Object.assign(this.style,r);const{x:i,y:a}=r;this.context.model.syncComboDatum({id:this.id,style:{x:i,y:a}}),Up(this)}render(t,r=this){super.render(t,r),this.drawCollapsedMarkerShape(t,r)}update(t={}){super.update(t),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(t,r){const i=super.animate(this.attributes.collapsed?t:t.map(u=>{var h=u,{x:a,y:o,z:s,transform:l}=h,c=Ce(h,["x","y","z","transform"]);return c}),r);return i&&new Proxy(i,{set:(a,o,s)=>(o==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(a,o,s))})}};let Go=zg;k(Go,"defaultStyleProps",{childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"}),qO([si((n,e)=>n.getCollapsedMarkerStyle(e))],Go.prototype,"drawCollapsedMarkerShape",null);class JO extends Go{constructor(e){super(e)}drawKeyShape(e,t){return this.upsert("key",Rl,this.getKeyStyle(e),t)}getKeyStyle(e){const{collapsed:t}=e,r=super.getKeyStyle(e),[i]=this.getKeySize(e);return Se(at(at({},r),t&&Dn(r,"collapsed")),{r:i/2})}getCollapsedKeySize(e){const[t,r]=Aa(e.collapsedSize),i=Math.max(t,r)/2;return[i*2,i*2,0]}getExpandedKeySize(e){const t=this.getContentBBox(e),[r,i]=Ka(t),a=Math.sqrt(gi(r,2)+gi(i,2))/2;return[a*2,a*2,0]}getIntersectPoint(e){const t=this.getShape("key").getBounds();return Du(e,t)}}class QO extends Go{constructor(e){super(e)}drawKeyShape(e,t){return this.upsert("key",ra,this.getKeyStyle(e),t)}getKeyStyle(e){const t=super.getKeyStyle(e),[r,i]=this.getKeySize(e);return Se(at(at({},t),e.collapsed&&Dn(t,"collapsed")),{width:r,height:i,x:-r/2,y:-i/2})}}var tN=function(n,e){if(!Bl(n))return n;for(var t=[],r=0;r<n.length;r++){var i=n[r];e(i,r)&&t.push(i)}return t},eN=tN,nN=function(n,e){return Bl(n)?n.indexOf(e)>-1:!1},rN=nN,iN=function(n,e){return e===void 0&&(e=[]),eN(n,function(t){return!rN(e,t)})},aN=iN;const oN={padding:10};function ex(n,e,t,r,i,a){const{padding:o}=Object.assign(oN,a),s=Za(t,o),l=Za(r,o),c=[n,...i,e];let u=null;const h=[];for(let f=0,d=c.length;f<d-1;f++){const p=f+1,v=c[f],g=c[p],m=cO(v,g);let x=null;f===0?p===d-1?s.intersects(l)?x=Yp(v,g,s,l):m||(x=cN(v,g,s,l)):Ta(g,s)?x=Yp(v,g,s,Za(g,o),u):m||(x=$u(v,g,s)):p===d-1?Ta(v,l)?x=Yp(v,g,Za(v,o),l,u):m||(x=rx(v,g,l,u)):m||(x=lN(v,g,u)),x?(h.push(...x.points),u=x.direction):u=li(v,g),p<d-1&&h.push(g)}return h}const sN={N:"S",S:"N",W:"E",E:"W"},nx={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function li(n,e){const[t,r]=n,[i,a]=e;return t===i?r>a?"N":"S":r===a?t>i?"W":"E":null}function Hp(n,e){return e==="N"||e==="S"?oa(n):aa(n)}function lN(n,e,t){const r=[n[0],e[1]],i=[e[0],n[1]],a=li(n,r),o=li(n,i),s=t?sN[t]:null,l=a===t||a!==s&&o!==t?r:i;return{points:[l],direction:li(l,e)}}function $u(n,e,t){const r=Zl(n,e,t);return{points:[r],direction:li(r,e)}}function rx(n,e,t,r){const i=[[e[0],n[1]],[n[0],e[1]]],a=i.filter(s=>nO(s,t)&&!M1(s,t,!0)),o=a.filter(s=>li(s,n)!==r);if(o.length>0){const s=o.find(l=>li(n,l)===r)||o[0];return{points:[s],direction:li(s,e)}}else{const s=aN(i,a)[0],l=Ja(e,s,Hp(t,r)/2);return{points:[Zl(l,n,t),l],direction:li(l,e)}}}function cN(n,e,t,r){let i=$u(n,e,t);const a=Wl(i.points[0]);if(Ta(a,r)){i=$u(e,n,r);const o=Wl(i.points[0]);if(Ta(o,t)){const s=Ja(n,a,Hp(t,li(n,a))/2),l=Ja(e,o,Hp(r,li(e,o))/2),c=[(s[0]+l[0])/2,(s[1]+l[1])/2],u=$u(n,c,t),h=rx(c,e,r,u.direction);i.points=[u.points[0],h.points[0]],i.direction=h.direction}}return i}function Yp(n,e,t,r,i){const o=Gl([t,r]),s=Oi(e,o.center)>Oi(n,o.center),[l,c]=s?[e,n]:[n,e],u=oa(o)+aa(o);let h;if(i){const p=[l[0]+u*Math.cos(nx[i]),l[1]+u*Math.sin(nx[i])];h=Ja(Cp(o,p),p,.01)}else h=Ja(Cp(o,l),l,-.01);let f=Zl(h,c,o),d=[Ul(h,2),Ul(f,2)];if(vn(Ul(h),Ul(f))){const p=Op(In(h,l),[1,0,0])+Math.PI/2;f=[c[0]+u*Math.cos(p),c[1]+u*Math.sin(p),0],f=Ul(Ja(Cp(o,f),c,-.01),2);const v=Zl(h,f,o);d=[h,v,f]}return{points:s?d.reverse():d,direction:li(s?h:f,e)}}function Zl(n,e,t){let r=[n[0],e[1]];return Ta(r,t)&&(r=[e[0],n[1]]),r}function ix(n,e,t,r,i){let l=typeof e=="number"?e:.5;e==="start"&&(l=0),e==="end"&&(l=.99);const c=zr(n.getPoint(l)),u=zr(n.getPoint(l+.01));let h=e==="start"?"left":e==="end"?"right":"center";if(R1(c,u)||!t){const[m,x]=ax(n,l,r,i);return{transform:`translate(${m}, ${x})`,textAlign:h}}let f=Math.atan2(u[1]-c[1],u[0]-c[0]);u[0]<c[0]&&(h=h==="center"?h:h==="left"?"right":"left",r*=-1,f+=Math.PI);const[p,v]=ax(n,l,r,i,f),g=`translate(${p}, ${v}) rotate(${f/Math.PI*180}deg)`;return{textAlign:h,transform:g}}function uN(n,e,t,r,i){var s,l;const a=((s=n.badge)==null?void 0:s.getGeometryBounds().halfExtents[0])*2||0,o=((l=n.label)==null?void 0:l.getGeometryBounds().halfExtents[0])*2||0;return ix(n.key,t,!0,(o?(o/2+a/2)*(e==="suffix"?1:-1):0)+r,i)}function ax(n,e,t,r,i){const[a,o]=zr(n.getPoint(e));let s=t,l=r;return i&&(s=t*Math.cos(i)-r*Math.sin(i),l=t*Math.sin(i)+r*Math.cos(i)),[a+s,o+l]}function Xp(n,e,t,r){if(vn(n,e))return n;const i=In(e,n),a=[n[0]+t*i[0],n[1]+t*i[1]],o=Pa(Iu(i,!1));return a[0]+=r*o[0],a[1]+=r*o[1],a}function hN(n){return fe(n)?[n,-n]:n}function fN(n){return fe(n)?[n,1-n]:n}function dN(n,e,t){return[["M",n[0],n[1]],["Q",t[0],t[1],e[0],e[1]]]}function ox(n,e,t){return[["M",n[0],n[1]],["C",t[0][0],t[0][1],t[1][0],t[1][1],e[0],e[1]]]}function sx(n,e=0,t=!1){const r=n[0],i=n[n.length-1],a=n.slice(1,n.length-1),o=[["M",r[0],r[1]]];return a.forEach((s,l)=>{const c=a[l-1]||r,u=a[l+1]||i;if(!uO(c,s,u)&&e){const[h,f]=pN(c,s,u,e);o.push(["L",h[0],h[1]],["Q",s[0],s[1],f[0],f[1]],["L",f[0],f[1]])}else o.push(["L",s[0],s[1]])}),o.push(["L",i[0],i[1]]),t&&o.push(["Z"]),o}function pN(n,e,t,r){const i=Lu(n,e),a=Lu(t,e),o=Math.min(r,Math.min(i,a)/2),s=[e[0]-o/i*(e[0]-n[0]),e[1]-o/i*(e[1]-n[1])],l=[e[0]-o/a*(e[0]-t[0]),e[1]-o/a*(e[1]-t[1])];return[s,l]}const vN=n=>{const e=Math.PI/2,t=oa(n)/2,r=aa(n)/2,i=Math.atan2(t,r)/2,a=Math.atan2(r,t)/2;return{top:[-e-a,-e+a],"top-right":[-e+a,-i],"right-top":[-e+a,-i],right:[-i,i],"bottom-right":[i,e-a],"right-bottom":[i,e-a],bottom:[e-a,e+a],"bottom-left":[e+a,Math.PI-i],"left-bottom":[e+a,Math.PI-i],left:[Math.PI-i,Math.PI+i],"top-left":[Math.PI+i,-e-a],"left-top":[Math.PI+i,-e-a]}};function lx(n,e,t,r,i){const a=Za(n),o=n.getCenter();let s=r&&to(r),l=i&&to(i);if(!s||!l){const c=vN(a),u=c[e][0],h=c[e][1],[f,d]=Ka(a),p=Math.max(f,d),v=ge(o,[p*Math.cos(u),p*Math.sin(u),0]),g=ge(o,[p*Math.cos(h),p*Math.sin(h),0]);s=Zp(n,v),l=Zp(n,g),t||([s,l]=[l,s])}return[s,l]}function gN(n,e,t,r,i,a){const o=n.getPorts()[i||a],s=n.getPorts()[a||i];let[l,c]=lx(n,e,t,o,s);const u=mN(n,l,c,r);return o&&(l=Ql(o,u[0])),s&&(c=Ql(s,u[u.length-1])),ox(l,c,u)}function mN(n,e,t,r){const i=n.getCenter();if(vn(e,t)){const a=In(e,i),o=[r*Math.sign(a[0])||r/2,r*Math.sign(a[1])||-r/2,0];return[ge(e,o),ge(t,Ap(o,[1,-1,1]))]}return[Ja(i,e,Oi(i,e)+r),Ja(i,t,Oi(i,t)+r)]}function yN(n,e,t,r,i,a,o){const s=Kp(n),l=s[a||o],c=s[o||a];let[u,h]=lx(n,t,r,l,c);const f=xN(n,u,h,i);return l&&(u=Ql(l,f[0])),c&&(h=Ql(c,f[f.length-1])),sx([u,...f,h],e)}function xN(n,e,t,r){const i=[],a=Za(n);if(vn(e,t))switch(ku(a,e)){case"left":i.push([e[0]-r,e[1]]),i.push([e[0]-r,e[1]+r]),i.push([e[0],e[1]+r]);break;case"right":i.push([e[0]+r,e[1]]),i.push([e[0]+r,e[1]+r]),i.push([e[0],e[1]+r]);break;case"top":i.push([e[0],e[1]-r]),i.push([e[0]+r,e[1]-r]),i.push([e[0]+r,e[1]]);break;case"bottom":i.push([e[0],e[1]+r]),i.push([e[0]+r,e[1]+r]),i.push([e[0]+r,e[1]]);break}else{const o=ku(a,e),s=ku(a,t);if(o===s){const l=o;let c,u;switch(l){case"left":c=Math.min(e[0],t[0])-r,i.push([c,e[1]]),i.push([c,t[1]]);break;case"right":c=Math.max(e[0],t[0])+r,i.push([c,e[1]]),i.push([c,t[1]]);break;case"top":u=Math.min(e[1],t[1])-r,i.push([e[0],u]),i.push([t[0],u]);break;case"bottom":u=Math.max(e[1],t[1])+r,i.push([e[0],u]),i.push([t[0],u]);break}}else{const l=(f,d)=>({left:[d[0]-r,d[1]],right:[d[0]+r,d[1]],top:[d[0],d[1]-r],bottom:[d[0],d[1]+r]})[f],c=l(o,e),u=l(s,t),h=Zl(c,u,a);i.push(c,h,u)}}return i}function cx(n,e){const t=new Set,r=new Set,i=new Set;return n.forEach(a=>{e(a).forEach(s=>{t.add(s),n.includes(s.source)&&n.includes(s.target)?r.add(s):i.add(s)})}),{edges:Array.from(t),internal:Array.from(r),external:Array.from(i)}}function ux(n,e){const t=[];let r=n;for(;r;){t.push(r);const i=e(it(r));if(i)r=i;else break}if(t.some(i=>{var a;return(a=i.style)==null?void 0:a.collapsed})){const i=t.reverse().findIndex(oi);return t[i]||t.at(-1)}return n}function bN(n,e){return e||(n<4?10:n===4?12:n*2.5)}const EN=(n,e)=>{const t=Math.max(n,e)/2;return[["M",-n/2,0],["A",t,t,0,1,0,2*t-n/2,0],["A",t,t,0,1,0,-n/2,0],["Z"]]},hx=(n,e)=>[["M",-n/2,0],["L",n/2,-e/2],["L",n/2,e/2],["Z"]],wN=(n,e)=>[["M",-n/2,0],["L",0,-e/2],["L",n/2,0],["L",0,e/2],["Z"]],_N=(n,e)=>[["M",-n/2,0],["L",n/2,-e/2],["L",4*n/5-n/2,0],["L",n/2,e/2],["Z"]],SN=(n,e)=>[["M",-n/2,-e/2],["L",n/2,-e/2],["L",n/2,e/2],["L",-n/2,e/2],["Z"]],TN=(n,e)=>{const t=n/2,r=n/7,i=n-r;return[["M",-t,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",i-t,-e/2],["L",i+r-t,-e/2],["L",i+r-t,e/2],["L",i-t,e/2],["Z"]]},PN=(n,e)=>[["M",n/2,-e/2],["L",-n/2,0],["L",n/2,0],["L",-n/2,0],["L",n/2,e/2]];var zs=function(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(o=n[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a};const Wg=class extends Q1{constructor(t){super(jn({style:Wg.defaultStyleProps},t));k(this,"type","edge")}get sourceNode(){const{context:t,sourceNode:r}=this.parsedAttributes;return t.element.getElement(r)}get targetNode(){const{context:t,targetNode:r}=this.parsedAttributes;return t.element.getElement(r)}getKeyStyle(t){const l=this.getGraphicStyle(t),{loop:r}=l,i=Ce(l,["loop"]),{sourceNode:a,targetNode:o}=this,s=r&&IN(a,o)?this.getLoopPath(t):this.getKeyPath(t);return at({d:s},Ip(i,["halo","label","startArrow","endArrow"]))}getLoopPath(t){const{sourcePort:r,targetPort:i}=t,a=this.sourceNode,o=Za(a),s=Math.max(aa(o),oa(o)),{placement:l,clockwise:c,dist:u=s}=Dn(this.getGraphicStyle(t),"loop");return gN(a,l,c,u,r,i)}getEndpoints(t,r=!0,i=[]){const{sourcePort:a,targetPort:o}=t,{sourceNode:s,targetNode:l}=this,[c,u]=BN(s,l,a,o);if(!r){const p=c?to(c):s.getCenter(),v=u?to(u):l.getCenter();return[p,v]}const h=typeof i=="function"?i():i,f=xx(c||s,h[0]||u||l),d=xx(u||l,h[h.length-1]||c||s);return[f,d]}getHaloStyle(t){if(t.halo===!1)return!1;const r=this.getKeyStyle(t),i=Dn(this.getGraphicStyle(t),"halo");return at(at({},r),i)}getLabelStyle(t){if(t.label===!1||!t.labelText)return!1;const d=Dn(this.getGraphicStyle(t),"label"),{placement:i,offsetX:a,offsetY:o,autoRotate:s,maxWidth:l}=d,c=Ce(d,["placement","offsetX","offsetY","autoRotate","maxWidth"]),u=ix(this.shapeMap.key,i,s,a,o),h=this.shapeMap.key.getLocalBounds(),f=TO([h.min,h.max],l);return Object.assign({wordWrapWidth:f},u,c)}getBadgeStyle(t){if(t.badge===!1||!t.badgeText)return!1;const s=Dn(t,"badge"),{offsetX:r,offsetY:i,placement:a}=s,o=Ce(s,["offsetX","offsetY","placement"]);return Object.assign(o,uN(this.shapeMap,a,t.labelPlacement,r,i))}drawArrow(t,r){var l;const i=r==="start",o=t[r==="start"?"startArrow":"endArrow"],s=this.shapeMap.key;if(o){const c=this.getArrowStyle(t,i),[u,h,f]=i?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],d=s.parsedStyle[u];if(d)d.attr(c);else{const p=c.src?sp:Xa,v=new p({style:c});s.style[u]=v}s.style[h]=t[f]||c.width/2+ +c.lineWidth}else{const c=i?"markerStart":"markerEnd";(l=s.style[c])==null||l.destroy(),s.style[c]=null}}getArrowStyle(t,r){const i=this.getShape("key").attributes,a=r?"startArrow":"endArrow",d=Dn(this.getGraphicStyle(t),a),{size:o,type:s}=d,l=Ce(d,["size","type"]),[c,u]=Aa(bN(i.lineWidth,o)),f=(jt(s)?s:lt[s]||hx)(c,u);return Object.assign(Vp(i,["stroke","strokeOpacity","fillOpacity"]),{width:c,height:u},at({},f&&{d:f,fill:s==="simple"?"":i.stroke}),l)}drawLabelShape(t,r){this.upsert("label",Qa,this.getLabelStyle(t),r)}drawHaloShape(t,r){this.upsert("halo",Xa,this.getHaloStyle(t),r)}drawBadgeShape(t,r){this.upsert("badge",Ds,this.getBadgeStyle(t),r)}drawSourceArrow(t){this.drawArrow(t,"start")}drawTargetArrow(t){this.drawArrow(t,"end")}drawKeyShape(t,r){return this.upsert("key",Xa,this.getKeyStyle(t),r)}render(t=this.parsedAttributes,r=this){this.drawKeyShape(t,r),this.getShape("key")&&(this.drawSourceArrow(t),this.drawTargetArrow(t),this.drawLabelShape(t,r),this.drawHaloShape(t,r),this.drawBadgeShape(t,r))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(t,r){const i=super.animate(t,r);return i&&new Proxy(i,{set:(a,o,s)=>(o==="currentTime"&&Promise.resolve().then(()=>this.onframe()),Reflect.set(a,o,s))})}};let Wr=Wg;k(Wr,"defaultStyleProps",{badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0}),zs([si((n,e)=>n.getLabelStyle(e))],Wr.prototype,"drawLabelShape",null),zs([si((n,e)=>n.getHaloStyle(e))],Wr.prototype,"drawHaloShape",null),zs([si((n,e)=>n.getBadgeStyle(e))],Wr.prototype,"drawBadgeShape",null),zs([si((n,e)=>n.getArrowStyle(e,"start"))],Wr.prototype,"drawSourceArrow",null),zs([si((n,e)=>n.getArrowStyle(e,"end"))],Wr.prototype,"drawTargetArrow",null),zs([si((n,e)=>n.getKeyStyle(e))],Wr.prototype,"drawKeyShape",null);const Ug=class extends Wr{constructor(e){super(jn({style:Ug.defaultStyleProps},e))}getKeyPath(e){const[t,r]=this.getEndpoints(e),{controlPoints:i,curvePosition:a,curveOffset:o}=e,s=this.getControlPoints(t,r,fN(a),hN(o),i);return ox(t,r,s)}getControlPoints(e,t,r,i,a){return(a==null?void 0:a.length)===2?a:[Xp(e,t,r[0],i[0]),Xp(e,t,r[1],i[1])]}};let zo=Ug;k(zo,"defaultStyleProps",{curvePosition:.5,curveOffset:20});const Vg=class extends zo{constructor(e){super(jn({style:Vg.defaultStyleProps},e))}getControlPoints(e,t,r,i){const a=t[0]-e[0];return[[e[0]+a*r[0]+i[0],e[1]],[t[0]-a*r[1]+i[1],t[1]]]}};let Ku=Vg;k(Ku,"defaultStyleProps",{curvePosition:[.5,.5],curveOffset:[0,0]});const Hg=class extends zo{constructor(e){super(jn({style:Hg.defaultStyleProps},e))}getControlPoints(e,t,r,i){const a=t[1]-e[1];return[[e[0],e[1]+a*r[0]+i[0]],[t[0],t[1]-a*r[1]+i[1]]]}};let Zu=Hg;k(Zu,"defaultStyleProps",{curvePosition:[.5,.5],curveOffset:[0,0]});const Yg=class extends Wr{constructor(e){super(jn({style:Yg.defaultStyleProps},e))}getKeyPath(e){const[t,r]=this.getEndpoints(e);return[["M",t[0],t[1]],["L",r[0],r[1]]]}};let ql=Yg;k(ql,"defaultStyleProps",{});const MN={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:Lu},Oa=n=>`${Math.round(n[0])}|||${Math.round(n[1])}`;function Wo(n,e){const t=r=>Math.round(r/e);return fe(n)?t(n):n.map(t)}function CN(n,e){const t=Math.abs(n-e);return t>Math.PI?2*Math.PI-t:t}function fx(n,e){const t=e[0]-n[0],r=e[1]-n[1];return!t&&!r?0:Math.atan2(r,t)}function dx(n,e,t,r){const i=fx(n,e),a=t[Oa(n)],s=fx(a||r,n);return CN(s,i)}const AN=(n,e)=>{const{offset:t,gridSize:r}=e,i={};return n.forEach(a=>{if(!a||a.destroyed||!a.isVisible())return;const o=Ru(a.getRenderBounds(),t);for(let s=Wo(o.min[0],r);s<=Wo(o.max[0],r);s+=1)for(let l=Wo(o.min[1],r);l<=Wo(o.max[1],r);l+=1)i[`${s}|||${l}`]=!0}),i};function px(n,e,t){return Math.min(...e.map(r=>t(n,r)))}function ON(n,e,t){let r=n[0],i=t(n[0],e);for(let a=0;a<n.length;a++){const o=n[a],s=t(o,e);s<i&&(r=o,i=s)}return r}const vx=(n,e,t,r)=>{if(!e)return[n];const{directionMap:i,offset:a}=r,o=Ru(e.getRenderBounds(),a),s=Object.keys(i).reduce((l,c)=>{if(t.includes(c)){const u=i[c],[h,f]=Ka(o),d=[n[0]+u.stepX*h,n[1]+u.stepY*f],p=aO(o);for(let v=0;v<p.length;v++){const g=Np([n,d],p[v]);g&&M1(g,o)&&l.push(g)}}return l},[]);return Ta(n,o)||s.push(n),s.map(l=>Wo(l,r.gridSize))},NN=(n,e,t,r,i,a,o)=>{const s=[];let l=[a[0]===r[0]?r[0]:n[0]*o,a[1]===r[1]?r[1]:n[1]*o];s.unshift(l);let c=n,u=e[Oa(c)];for(;u;){const d=u,p=c;dx(d,p,e,t)&&(l=[d[0]===p[0]?l[0]:d[0]*o,d[1]===p[1]?l[1]:d[1]*o],s.unshift(l)),u=e[Oa(d)],c=d}const h=i.map(d=>[d[0]*o,d[1]*o]),f=ON(h,l,Lu);return s.unshift(f),s};function RN(n,e,t,r){const i=zl(n.getCenter()),a=zl(e.getCenter()),o=Object.assign(MN,r),{gridSize:s}=o,l=o.enableObstacleAvoidance?t:[n,e],c=AN(l,o),u=Wo(i,s),h=Wo(a,s),f=vx(i,n,o.startDirections,o),d=vx(a,e,o.endDirections,o);f.forEach(w=>delete c[Oa(w)]),d.forEach(w=>delete c[Oa(w)]);const p={},v={},g={},m={},x={},_=new kN;for(let w=0;w<f.length;w++){const M=f[w],P=Oa(M);p[P]=M,m[P]=0,x[P]=px(M,d,o.distFunc),_.add({id:P,value:x[P]})}const S=d.map(w=>Oa(w));let b=o.maximumLoops,y,E=1/0;for(const[w,M]of Object.entries(p))x[w]<=E&&(E=x[w],y=M);for(;Object.keys(p).length>0&&b>0;){const w=_.minId(!1);if(w)y=p[w];else break;const M=Oa(y);if(S.includes(M))return NN(y,g,u,a,f,h,s);delete p[M],_.remove(M),v[M]=!0;for(const P of Object.values(o.directionMap)){const A=ge(y,[P.stepX,P.stepY]),O=Oa(A);if(v[O])continue;const R=dx(y,A,g,u);if(R>o.maxAllowedDirectionChange||c[O])continue;p[O]||(p[O]=A);const L=o.penalties[R],z=o.distFunc(y,A)+(isNaN(L)?s:L),Y=m[M]+z,I=m[O];I&&Y>=I||(g[O]=y,m[O]=Y,x[O]=Y+px(A,d,o.distFunc),_.add({id:O,value:x[O]}))}b-=1}return[]}class kN{constructor(){k(this,"arr",[]);k(this,"map",{});this.arr=[],this.map={}}_innerAdd(e,t){let r=0,i=t-1;for(;i-r>1;){const a=Math.floor((r+i)/2);if(this.arr[a].value>e.value)i=a;else if(this.arr[a].value<e.value)r=a;else{this.arr.splice(a,0,e),this.map[e.id]=!0;return}}this.arr.splice(i,0,e),this.map[e.id]=!0}add(e){delete this.map[e.id];const t=this.arr.length;if(!t||this.arr[t-1].value<e.value){this.arr.push(e),this.map[e.id]=!0;return}this._innerAdd(e,t)}remove(e){this.map[e]&&delete this.map[e]}_clearAndGetMinId(){let e;for(let t=this.arr.length-1;t>=0;t--)this.map[this.arr[t].id]?e=this.arr[t].id:this.arr.splice(t,1);return e}_findFirstId(){for(;this.arr.length;){const e=this.arr.shift();if(this.map[e.id])return e.id}}minId(e){return e?this._clearAndGetMinId():this._findFirstId()}}const Xg=class extends Wr{constructor(e){super(jn({style:Xg.defaultStyleProps},e))}getControlPoints(e){const{router:t}=e,{sourceNode:r,targetNode:i}=this,[a,o]=this.getEndpoints(e,!1);let s=[];if(!t)s=e.controlPoints;else if(t.type==="shortest-path"){const l=this.context.element.getNodes();s=RN(r,i,l,t),s.length||(s=ex(a,o,r,i,e.controlPoints,{padding:t.offset}))}else t.type==="orth"&&(s=ex(a,o,r,i,e.controlPoints,t));return s}getPoints(e){const t=this.getControlPoints(e),[r,i]=this.getEndpoints(e,!0,t);return[r,...t,i]}getKeyPath(e){const t=this.getPoints(e);return sx(t,e.radius)}getLoopPath(e){const{sourcePort:t,targetPort:r,radius:i}=e,a=this.sourceNode,o=Za(a),s=Math.max(aa(o),oa(o))/4,{placement:l,clockwise:c,dist:u=s}=Dn(this.getGraphicStyle(e),"loop");return yN(a,i,l,c,u,t,r)}};let qu=Xg;k(qu,"defaultStyleProps",{radius:0,controlPoints:[],router:!1});const jg=class extends Wr{constructor(e){super(jn({style:jg.defaultStyleProps},e))}getKeyPath(e){const{curvePosition:t,curveOffset:r}=e,[i,a]=this.getEndpoints(e),o=e.controlPoint||Xp(i,a,t,r);return dN(i,a,o)}};let Ju=jg;k(Ju,"defaultStyleProps",{curvePosition:.5,curveOffset:30});function Jl(n){return n instanceof $n&&n.type==="node"}function gx(n){return n instanceof Wr}function jp(n){return n instanceof Go}function LN(n){return Jl(n)||gx(n)||jp(n)}function IN(n,e){return!n||!e?!1:n===e}const DN={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],default:[.5,.5]};function $p(n,e,t=DN,r=!0){const i=[.5,.5],a=ue(e)?wr(t,e.toLocaleLowerCase(),i):e;if(!r&&ue(e))return a;const[o,s]=a||i;return[n.min[0]+aa(n)*o,n.min[1]+oa(n)*s]}function Kp(n){if(!n)return{};const e=n.getPorts();return(n.attributes.ports||[]).forEach((r,i)=>{var s;const{key:a,placement:o}=r;mx(r)&&(e[s=a||i]||(e[s]=Ma(n.getShape("key").getBounds(),o)))}),e}function mx(n){const{r:e}=n;return!e||Number(e)===0}function to(n){return Os(n)?n:n.getPosition()}function BN(n,e,t,r){const i=yx(n,e,t,r),a=yx(e,n,r,t);return[i,a]}function yx(n,e,t,r){const i=Kp(n);if(t)return i[t];const a=Object.values(i);if(a.length===0)return;const o=a.map(c=>to(c)),s=FN(e,r),[l]=dO(o,s);return a.find(c=>to(c)===l)}function FN(n,e){const t=Kp(n);if(e)return[to(t[e])];const r=Object.values(t);return r.length>0?r.map(i=>to(i)):[n.getCenter()]}function xx(n,e){return jp(n)||Jl(n)?Zp(n,e):Ql(n,e)}function Ql(n,e){if(!n||!e)return[0,0,0];if(Os(n))return n;if(n.attributes.linkToCenter)return n.getPosition();const t=Os(e)?e:Jl(e)?e.getCenter():e.getPosition();return Du(t,n.getBounds())}function Zp(n,e){if(!n||!e)return[0,0,0];const t=Os(e)?e:Jl(e)?e.getCenter():e.getPosition();return n.getIntersectPoint(t)||n.getCenter()}function bx(n,e="bottom",t=0,r=0,i=!1){const a=e.split("-"),[o,s]=Ma(n,e),l=a.includes("left")?"right":a.includes("right")?"left":"center";let c=a.includes("top")?"bottom":a.includes("bottom")?"top":"middle";return i&&(c=c==="top"?"bottom":c==="bottom"?"top":c),{transform:`translate(${o+t}, ${s+r})`,textBaseline:c,textAlign:l}}function GN(n,e){return[[0,-n],[e*Math.cos(3*Math.PI/10),-e*Math.sin(3*Math.PI/10)],[n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],[e*Math.cos(Math.PI/10),e*Math.sin(Math.PI/10)],[n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],[0,e],[-n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],[-e*Math.cos(Math.PI/10),e*Math.sin(Math.PI/10)],[-n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],[-e*Math.cos(3*Math.PI/10),-e*Math.sin(3*Math.PI/10)]]}function zN(n,e){const t={};return t.top=[0,-n],t.left=[-n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],t["left-bottom"]=[-n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],t.bottom=[0,e],t["right-bottom"]=[n*Math.cos(3*Math.PI/10),n*Math.sin(3*Math.PI/10)],t.right=t.default=[n*Math.cos(Math.PI/10),-n*Math.sin(Math.PI/10)],t}function WN(n,e,t){const r=e/2,i=n/2,a={up:[[-i,r],[i,r],[0,-r]],left:[[-i,0],[i,r],[i,-r]],right:[[-i,r],[-i,-r],[i,0]],down:[[-i,-r],[i,-r],[0,r]]};return a[t]||a.up}function UN(n,e,t){const r=e/2,i=n/2,a={};return t==="down"?(a.bottom=a.default=[0,r],a.right=[i,-r],a.left=[-i,-r]):t==="left"?(a.top=[i,-r],a.bottom=[i,r],a.left=a.default=[-i,0]):t==="right"?(a.top=[-i,-r],a.bottom=[-i,r],a.right=a.default=[i,0]):(a.left=[-i,r],a.top=a.default=[0,-r],a.right=[i,r]),a}function mU(n,e){return[[n/2,-e/2],[n/2,e/2],[-n/2,e/2],[-n/2,-e/2]]}function VN(n,e){return[[0,-e/2],[n/2,0],[0,e/2],[-n/2,0]]}function HN(n){return wr(n,["style","visibility"])!=="hidden"}function qp(n,e){"update"in n?n.update(e):n.attr(e)}function YN(n){return[[0,n],[n*Math.sqrt(3)/2,n/2],[n*Math.sqrt(3)/2,-n/2],[0,-n],[-n*Math.sqrt(3)/2,-n/2],[-n*Math.sqrt(3)/2,n/2]]}function XN(n){Hl(n,"__to_be_destroyed__",!0)}function Jp(n){return wr(n,"__to_be_destroyed__",!1)}const $g=class extends Ai{constructor(t,r){super(t,Object.assign({},$g.defaultOptions,r));k(this,"onCollapseExpand",t=>Pt(this,null,function*(){if(!this.validate(t))return;const{target:r}=t;if(!LN(r))return;const i=r.id,{model:a,graph:o}=this.context,s=a.getElementDataById(i);if(!s)return!1;const{onCollapse:l,onExpand:c,animation:u}=this.options;oi(s)?(yield o.expandElement(i,u),c==null||c(i)):(yield o.collapseElement(i,u),l==null||l(i))}));this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;t.on(`node:${r}`,this.onCollapseExpand),t.on(`combo:${r}`,this.onCollapseExpand)}unbindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;t.off(`node:${r}`,this.onCollapseExpand),t.off(`combo:${r}`,this.onCollapseExpand)}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}destroy(){this.unbindEvents(),super.destroy()}};let Qu=$g;k(Qu,"defaultOptions",{enable:!0,animation:!0,trigger:ht.DBLCLICK});var th={},jN=function(n){return n=n||"g",th[n]?th[n]+=1:th[n]=1,n+th[n]};const $N="g6-create-edge-assist-edge-id",eh="g6-create-edge-assist-node-id",Kg=class extends Ai{constructor(t,r){super(t,Object.assign({},Kg.defaultOptions,r));k(this,"source");k(this,"drop",t=>Pt(this,null,function*(){const{targetType:r}=t;["combo","node"].includes(r)&&this.source?yield this.handleCreateEdge(t):yield this.cancelEdge()}));k(this,"handleCreateEdge",t=>Pt(this,null,function*(){var l;if(!this.validate(t))return;const{graph:r,canvas:i,batch:a,element:o}=this.context,{style:s}=this.options;if(this.source){this.createEdge(t),yield this.cancelEdge();return}a.startBatch(),i.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([t.target.id])[0],r.addNodeData([{id:eh,style:{visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}]}}]),r.addEdgeData([{id:$N,source:this.source,target:eh,style:at({pointerEvents:"none"},s)}]),yield(l=o.draw({animation:!1}))==null?void 0:l.finished}));k(this,"updateAssistEdge",t=>Pt(this,null,function*(){var a;if(!this.source)return;const{model:r,element:i}=this.context;r.translateNodeTo(eh,[t.canvas.x,t.canvas.y]),yield(a=i.draw({animation:!1,silence:!0}))==null?void 0:a.finished}));k(this,"createEdge",t=>{var h,f;const{graph:r}=this.context,{style:i,onFinish:a,onCreate:o}=this.options;if(((h=t.target)==null?void 0:h.id)===void 0||this.source===void 0)return;const l=(f=this.getSelectedNodeIDs([t.target.id]))==null?void 0:f[0],c=`${this.source}-${l}-${jN()}`,u=o({id:c,source:this.source,target:l,style:i});r.addEdgeData([u]),a(u)});k(this,"cancelEdge",()=>Pt(this,null,function*(){var a;if(!this.source)return;const{graph:t,element:r,batch:i}=this.context;t.removeNodeData([eh]),this.source=void 0,yield(a=r.draw({animation:!1}))==null?void 0:a.finished,i.endBatch()}));this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;this.unbindEvents(),r==="click"?(t.on(Mi.CLICK,this.handleCreateEdge),t.on(Do.CLICK,this.handleCreateEdge),t.on(wa.CLICK,this.cancelEdge),t.on(Au.CLICK,this.cancelEdge)):(t.on(Mi.DRAG_START,this.handleCreateEdge),t.on(Do.DRAG_START,this.handleCreateEdge),t.on(ht.POINTER_UP,this.drop)),t.on(ht.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(r=>r.id).concat(t)))}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}unbindEvents(){const{graph:t}=this.context;t.off(Mi.CLICK,this.handleCreateEdge),t.off(Do.CLICK,this.handleCreateEdge),t.off(wa.CLICK,this.cancelEdge),t.off(Au.CLICK,this.cancelEdge),t.off(Mi.DRAG_START,this.handleCreateEdge),t.off(Do.DRAG_START,this.handleCreateEdge),t.off(ht.POINTER_UP,this.drop),t.off(ht.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}};let nh=Kg;k(nh,"defaultOptions",{animation:!0,enable:!0,style:{},trigger:"drag",onCreate:t=>t,onFinish:()=>{}});function KN(n,e,t){var r;return function(){var i=this,a=arguments,o=function(){r=null,t||n.apply(i,a)},s=t&&!r;clearTimeout(r),r=setTimeout(o,e),s&&n.apply(i,a)}}var rh=KN;const Zg=class extends Ai{constructor(t,r){super(t,Object.assign({},Zg.defaultOptions,r));k(this,"shortcut");k(this,"defaultCursor");k(this,"isDragging",!1);k(this,"onDragStart",t=>{this.validate(t)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))});k(this,"onDrag",t=>{if(!this.isDragging)return;const{x:r,y:i}=t.movement;r|i&&this.translate([r,i],!1)});k(this,"onDragEnd",()=>{var t,r;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),(r=(t=this.options).onFinish)==null||r.call(t)});k(this,"invokeOnFinish",rh(()=>{var t,r;(r=(t=this.options).onFinish)==null||r.call(t)},300));this.shortcut=new ks(t.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{trigger:t}=this.options;if(dn(t)){const{up:r=[],down:i=[],left:a=[],right:o=[]}=t;this.shortcut.bind(r,s=>this.onTranslate([0,1],s)),this.shortcut.bind(i,s=>this.onTranslate([0,-1],s)),this.shortcut.bind(a,s=>this.onTranslate([1,0],s)),this.shortcut.bind(o,s=>this.onTranslate([-1,0],s))}else{const{graph:r}=this.context;r.on(ht.DRAG_START,this.onDragStart),r.on(ht.DRAG,this.onDrag),r.on(ht.DRAG_END,this.onDragEnd)}}onTranslate(t,r){return Pt(this,null,function*(){if(!this.validate(r))return;const{sensitivity:i}=this.options,a=i*-1;yield this.translate(Ap(t,a),this.options.animation),this.invokeOnFinish()})}translate(t,r){return Pt(this,null,function*(){let[i,a]=t;const{direction:o}=this.options;o==="x"?a=0:o==="y"&&(i=0),yield this.context.graph.translateBy([i,a],r)})}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return typeof r=="function"?r(t):!!r}unbindEvents(){this.shortcut.unbindAll();const{graph:t}=this.context;t.off(ht.DRAG_START,this.onDragStart),t.off(ht.DRAG,this.onDrag),t.off(ht.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}};let ih=Zg;k(ih,"defaultOptions",{enable:t=>"targetType"in t?t.targetType==="canvas":!0,sensitivity:10,direction:"both"});const qg=class extends Ai{constructor(t,r){super(t,Object.assign({},qg.defaultOptions,r));k(this,"enable",!1);k(this,"enableElements",["node","combo"]);k(this,"target",[]);k(this,"shadow");k(this,"shadowOrigin",[0,0]);k(this,"hiddenEdges",[]);k(this,"isDragging",!1);k(this,"onDrop",t=>Pt(this,null,function*(){var o;if(this.options.dropEffect!=="link")return;const{model:r,element:i}=this.context,a=t.target.id;this.target.forEach(s=>{const l=r.getParentData(s,en);l&&it(l)===a&&r.refreshComboData(a),r.setParent(s,a,en)}),yield(o=i==null?void 0:i.draw({animation:!0}))==null?void 0:o.finished}));k(this,"setCursor",t=>{if(this.isDragging)return;const{type:r}=t,{canvas:i}=this.context,{cursor:a}=this.options;r===ht.POINTER_ENTER?i.setCursor((a==null?void 0:a.grab)||"grab"):i.setCursor((a==null?void 0:a.default)||"default")});this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}get animation(){return this.options.shadow?this.options.animation:!1}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.enableElements.forEach(r=>{t.on(`${r}:${ht.DRAG_START}`,this.onDragStart),t.on(`${r}:${ht.DRAG}`,this.onDrag),t.on(`${r}:${ht.DRAG_END}`,this.onDragEnd),t.on(`${r}:${ht.POINTER_ENTER}`,this.setCursor),t.on(`${r}:${ht.POINTER_LEAVE}`,this.setCursor)}),["link"].includes(this.options.dropEffect)&&(t.on(Do.DROP,this.onDrop),t.on(wa.DROP,this.onDrop))}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(r=>r.id).concat(t)))}getDelta(t){const r=this.context.graph.getZoom();return Rs([t.dx,t.dy],r)}onDragStart(t){var a;if(this.enable=this.validate(t),!this.enable)return;const{batch:r,canvas:i}=this.context;i.setCursor(((a=this.options.cursor)==null?void 0:a.grabbing)||"grabbing"),this.isDragging=!0,r.startBatch(),this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(t){if(!this.enable)return;const r=this.getDelta(t);this.options.shadow?this.moveShadow(r):this.moveElement(this.target,r)}onDragEnd(){var i,a,o;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";const{x:s=0,y:l=0}=this.shadow.attributes,[c,u]=In([+s,+l],this.shadowOrigin);this.moveElement(this.target,[c,u])}this.showEdges(),(a=(i=this.options).onFinish)==null||a.call(i,this.target);const{batch:t,canvas:r}=this.context;t.endBatch(),r.setCursor(((o=this.options.cursor)==null?void 0:o.grab)||"grab"),this.isDragging=!1,this.target=[]}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}moveElement(t,r){return Pt(this,null,function*(){const{graph:i,model:a}=this.context,{dropEffect:o}=this.options;o==="move"&&t.forEach(s=>a.refreshComboData(s)),i.translateElementBy(Object.fromEntries(t.map(s=>[s,r])),!1)})}moveShadow(t){if(!this.shadow)return;const{x:r=0,y:i=0}=this.shadow.attributes,[a,o]=t;this.shadow.attr({x:+r+a,y:+i+o})}createShadow(t){const r=Dn(this.options,"shadow"),i=Gl(t.map(u=>this.context.element.getElement(u).getBounds())),[a,o]=i.min;this.shadowOrigin=[a,o];const[s,l]=Ka(i),c={width:s,height:l,x:a,y:o};this.shadow?this.shadow.attr(Se(at(at({},r),c),{visibility:"visible"})):(this.shadow=new ra({style:Se(at(at({$layer:"transient"},r),c),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||this.hiddenEdges.length===0||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){const{hideEdge:t,shadow:r}=this.options;if(t==="none"||r)return;const{graph:i}=this.context;t==="all"?this.hiddenEdges=i.getEdgeData().map(it):this.hiddenEdges=Array.from(new Set(this.target.map(a=>i.getRelatedEdgesData(a,t).map(it)).flat())),i.hideElement(this.hiddenEdges)}unbindEvents(){const{graph:t}=this.context;this.enableElements.forEach(r=>{t.off(`${r}:${ht.DRAG_START}`,this.onDragStart),t.off(`${r}:${ht.DRAG}`,this.onDrag),t.off(`${r}:${ht.DRAG_END}`,this.onDragEnd),t.off(`${r}:${ht.POINTER_ENTER}`,this.setCursor),t.off(`${r}:${ht.POINTER_LEAVE}`,this.setCursor)}),t.off(`combo:${ht.DROP}`,this.onDrop),t.off(`canvas:${ht.DROP}`,this.onDrop)}destroy(){var t;this.unbindEvents(),(t=this.shadow)==null||t.destroy(),super.destroy()}};let tc=qg;k(tc,"defaultOptions",{animation:!0,enable:t=>["node","combo"].includes(t.targetType),dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}});var Qp=D(72137);class Ex{constructor(e,t){k(this,"options");k(this,"context");k(this,"stop");k(this,"tick");this.context=e,this.options=t||{}}}function yU(n){const{type:e}=n;return!!(["comboCombined","comboForce"].includes(e)||e==="antv-dagre"&&n.sortByCombo)}function ZN(n){const{type:e}=n;return["compact-box","mindmap","dendrogram","indented"].includes(e)}function xU(n){return isNumber(n.x)&&isNumber(n.y)}function ah(n){const{nodes:e,edges:t}=n,r={nodes:[],edges:[],combos:[]};return e.forEach(i=>{const a=i.data._isCombo?r.combos:r.nodes,{x:o,y:s,z:l=0}=i.data;a==null||a.push({id:i.id,style:{x:o,y:s,z:l}})}),t.forEach(i=>{const{id:a,source:o,target:s,data:{points:l=[],controlPoints:c=l.slice(1,l.length-1)}}=i;r.edges.push({id:a,source:o,target:s,style:at({},c!=null&&c.length?{controlPoints:c.map(zr)}:{})})}),r}function qN(n,e){class t extends Ex{constructor(a,o){super(a,o);k(this,"instance");k(this,"id");if(this.instance=new n({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){const s=this.instance;this.stop=s.stop.bind(s),this.tick=l=>{const c=s.tick(l);return ah(c)}}}execute(a,o){return Pt(this,null,function*(){return ah(yield this.instance.execute(this.graphData2LayoutModel(a),this.transformOptions(Ci({},this.options,o))))})}transformOptions(a){const{onTick:o}=a;return o&&(a.onTick=s=>o(ah(s))),a}graphData2LayoutModel(a){const{nodes:o=[],edges:s=[],combos:l=[]}=a,c=o.map(p=>{const v=it(p),{data:g,style:m,combo:x}=p,_={id:v,data:at(at({},g),x?{parentId:x}:{}),style:at({},m)};return m!=null&&m.x&&Object.assign(_.data,{x:m.x}),m!=null&&m.y&&Object.assign(_.data,{y:m.y}),m!=null&&m.z&&Object.assign(_.data,{z:m.z}),_}),u=new Map(c.map(p=>[p.id,p])),h=s.filter(p=>{const{source:v,target:g}=p;return u.has(v)&&u.has(g)}).map(p=>{const{source:v,target:g,data:m,style:x}=p;return{id:it(p),source:v,target:g,data:at({},m),style:at({},x)}}),f=l.map(p=>({id:it(p),data:at({_isCombo:!0},p.data),style:at({},p.style)})),d=new Qp.k({nodes:[...c,...f],edges:h});return e.model.model.hasTreeStructure(en)&&(d.attachTreeStructure(en),c.forEach(p=>{const v=e.model.model.getParent(p.id,en);v&&d.hasNode(v.id)&&d.setParent(p.id,v.id,en)})),d}}return t}function tv(n,e,...t){if(e in n)return n[e](...t);if("instance"in n){const r=n.instance;if(e in r)return r[e](...t)}return null}function wx(n,e){if(e in n)return n[e];if("instance"in n){const t=n.instance;if(e in t)return t[e]}return null}class JN extends tc{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(e=>["d3-force","d3-force-3d"].includes(e==null?void 0:e.id))}validate(e){return this.context.layout?this.forceLayoutInstance?super.validate(e):(Gr.warn("DragElementForce only works with d3-force or d3-force-3d layout"),!1):!1}moveElement(e,t){return Pt(this,null,function*(){const r=this.forceLayoutInstance;this.context.graph.getNodeData(e).forEach((i,a)=>{const{x:o=0,y:s=0}=i.style||{};r&&tv(r,"setFixedPosition",e[a],[...ge([+o,+s],t)])})})}onDragStart(e){if(this.enable=this.validate(e),!this.enable)return;this.target=this.getSelectedNodeIDs([e.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);const t=this.forceLayoutInstance;t&&wx(t,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(r=>{const{x:i=0,y:a=0}=r.style||{};t&&tv(t,"setFixedPosition",it(r),[+i,+a])})}onDrag(e){if(!this.enable)return;const t=this.getDelta(e);this.moveElement(this.target,t)}onDragEnd(){const e=this.forceLayoutInstance;e&&wx(e,"simulation").alphaTarget(0),this.context.graph.getNodeData(this.target).forEach(t=>{e&&tv(e,"setFixedPosition",it(t),[null,null,null])})}}const Jg=class extends Ai{constructor(t,r){super(t,Object.assign({},Jg.defaultOptions,r));k(this,"elementCache",new Map);k(this,"isZoomEvent",t=>"scale"in t.data);k(this,"fixElementSize",t=>Pt(this,null,function*(){if(!this.isZoomEvent(t)||!this.validate(t))return;const{graph:r,element:i}=this.context,{state:a}=this.options,o=a?[...r.getElementDataByState("node",a),...r.getElementDataByState("edge",a),...r.getElementDataByState("combo",a)]:Object.values(r.getData()).flat();if(!o.length)return;const s=t.data.scale||r.getZoom();o.forEach(l=>{const c=it(l),u=i==null?void 0:i.getElement(c),h=r.getElementType(c),f=this.options[h];if(!f){this.elementCache.set(c,u),h==="edge"&&(u.style.transformOrigin="center"),u.setLocalScale(1/s);return}const d=GO(u);(Array.isArray(f)?f:[f]).forEach(v=>{const{shape:g,fields:m}=v,x=g(d);m.forEach(_=>{V1(x,_)||U1(x,_);const S=zu(x,_);fe(S)&&(x.style[_]=S/s)})})})}));k(this,"resetTransform",()=>Pt(this,null,function*(){this.elementCache&&(this.elementCache.forEach(t=>t.setLocalScale(1)),this.elementCache.clear())}));this.bindEvents()}bindEvents(){const{graph:t}=this.context;t.on(Tt.AFTER_TRANSFORM,this.fixElementSize),t.on(Tt.BEFORE_DRAW,this.resetTransform)}unbindEvents(){const{graph:t}=this.context;t.off(Tt.AFTER_TRANSFORM,this.fixElementSize),t.off(Tt.BEFORE_DRAW,this.resetTransform)}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}destroy(){this.unbindEvents(),super.destroy()}};let oh=Jg;k(oh,"defaultOptions",{enable:t=>t.data.scale<1,state:"selected",edge:[{shape:t=>t.find(r=>r.className==="key"),fields:["lineWidth"]},{shape:t=>t.find(r=>{var i;return((i=r.parentElement)==null?void 0:i.className)==="label"&&r.className==="text"}),fields:["fontSize","lineHeight"]}]});const Qg=class extends Ai{constructor(t,r){super(t,Object.assign({},Qg.defaultOptions,r));k(this,"focus",t=>Pt(this,null,function*(){if(!this.validate(t))return;const{graph:r}=this.context;yield r.focusElement(t.target.id,this.options.animation)}));this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Fo.forEach(r=>{t.on(`${r}:${ht.CLICK}`,this.focus)})}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}unbindEvents(){const{graph:t}=this.context;Fo.forEach(r=>{t.off(`${r}:${ht.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),super.destroy()}};let sh=Qg;k(sh,"defaultOptions",{animation:{easing:"ease-in",duration:500},enable:!0});const tm=class extends Ai{constructor(t,r){super(t,Object.assign({},tm.defaultOptions,r));k(this,"isFrozen",!1);k(this,"toggleFrozen",t=>{this.isFrozen=t.type==="dragstart"});k(this,"hoverElement",t=>{if(!this.validate(t))return;const r=t.type===ht.POINTER_OVER;this.updateElementsState(t,r);const{onHover:i,onHoverEnd:a}=this.options;r?i==null||i(t):a==null||a(t)});k(this,"updateElementsState",(t,r)=>{if(!this.options.state&&!this.options.inactiveState)return;const{graph:i}=this.context,{state:a,degree:o,animation:s,inactiveState:l}=this.options,{targetType:c,target:u}=t,h=o?F1(i,c,u.id,o):[u.id],f={};if(a&&Object.assign(f,this.getElementsState(h,a,r)),l){const d=_1(i.getData(),!0).filter(p=>!h.includes(p));Object.assign(f,this.getElementsState(d,l,r))}i.setElementState(f,s)});k(this,"getElementsState",(t,r,i)=>{const{graph:a}=this.context,o={};return t.forEach(s=>{const l=a.getElementState(s),c=i?[...l,r]:l.filter(u=>u!==r);o[s]=c}),o});this.bindEvents()}bindEvents(){const{graph:t}=this.context;this.unbindEvents(),Fo.forEach(i=>{t.on(`${i}:${ht.POINTER_OVER}`,this.hoverElement),t.on(`${i}:${ht.POINTER_OUT}`,this.hoverElement)});const r=this.context.canvas.document;r.addEventListener(`${ht.DRAG_START}`,this.toggleFrozen),r.addEventListener(`${ht.DRAG_END}`,this.toggleFrozen)}validate(t){if(this.destroyed||this.isFrozen||this.context.graph.isCollapsingExpanding)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}unbindEvents(){const{graph:t}=this.context;Fo.forEach(i=>{t.off(`${i}:${ht.POINTER_OVER}`,this.hoverElement),t.off(`${i}:${ht.POINTER_OUT}`,this.hoverElement)});const r=this.context.canvas.document;r.removeEventListener(`${ht.DRAG_START}`,this.toggleFrozen),r.removeEventListener(`${ht.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}};let lh=tm;k(lh,"defaultOptions",{animation:!1,enable:!0,degree:0,state:"active",inactiveState:void 0});class QN extends Vl{constructor(){super(...arguments);k(this,"points");k(this,"pathShape")}onPointerDown(t){if(!super.validate(t)||!super.isKeydown()||this.points)return;const{canvas:r}=this.context;this.pathShape=new Xa({id:"g6-lasso-select",style:this.options.style}),r.appendChild(this.pathShape),this.points=[Bu(t)]}onPointerMove(t){var a;if(!this.points)return;const{immediately:r,mode:i}=this.options;this.points.push(Bu(t)),(a=this.pathShape)==null||a.setAttribute("d",IO(this.points)),r&&i==="default"&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var t;(t=this.pathShape)==null||t.remove(),this.pathShape=void 0,this.points=void 0}}const em=class extends Ai{constructor(t,r){super(t,Object.assign({},em.defaultOptions,r));k(this,"isVisible",!0);k(this,"setElementsVisibility",(t,r,i)=>{t.forEach(a=>{jl(a,r,!1,o=>o.className?!(i!=null&&i.includes(o.className)):!0)})});k(this,"hideShapes",t=>{if(!this.validate(t)||!this.isVisible)return;const{element:r}=this.context,{shapes:i={}}=this.options;this.setElementsVisibility(r.getNodes(),"hidden",i.node),this.setElementsVisibility(r.getEdges(),"hidden",i.edge),this.setElementsVisibility(r.getCombos(),"hidden",i.combo),this.isVisible=!1});k(this,"showShapes",rh(t=>{if(!this.validate(t)||this.isVisible)return;const{element:r}=this.context;this.setElementsVisibility(r.getNodes(),"visible"),this.setElementsVisibility(r.getEdges(),"visible"),this.setElementsVisibility(r.getCombos(),"visible"),this.isVisible=!0},this.options.debounce));this.bindEvents()}bindEvents(){const{graph:t}=this.context;t.on(Tt.BEFORE_TRANSFORM,this.hideShapes),t.on(Tt.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){const{graph:t}=this.context;t.off(Tt.BEFORE_TRANSFORM,this.hideShapes),t.off(Tt.AFTER_TRANSFORM,this.showShapes)}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}destroy(){this.unbindEvents(),super.destroy()}};let ch=em;k(ch,"defaultOptions",{enable:!0,debounce:200,shapes:{node:["key"]}});const nm=class extends Ai{constructor(t,r){super(t,Object.assign({},nm.defaultOptions,r));k(this,"shortcut");k(this,"onWheel",t=>Pt(this,null,function*(){this.options.preventDefault&&t.preventDefault();const r=t.deltaX,i=t.deltaY;yield this.scroll([-r,-i],t)}));this.shortcut=new ks(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var r,i;const{trigger:t}=this.options;if(this.shortcut.unbindAll(),dn(t)){(r=this.graphDom)==null||r.removeEventListener(ht.WHEEL,this.onWheel);const{up:a=[],down:o=[],left:s=[],right:l=[]}=t;this.shortcut.bind(a,c=>this.scroll([0,-10],c)),this.shortcut.bind(o,c=>this.scroll([0,10],c)),this.shortcut.bind(s,c=>this.scroll([-10,0],c)),this.shortcut.bind(l,c=>this.scroll([10,0],c))}else(i=this.graphDom)==null||i.addEventListener(ht.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement([t,r]){const{direction:i,sensitivity:a}=this.options;return t=t*a,r=r*a,i==="x"?r=0:i==="y"&&(t=0),[t,r]}scroll(t,r){return Pt(this,null,function*(){if(!this.validate(r))return;const{onFinish:i}=this.options,a=this.context.graph,o=this.formatDisplacement(t);yield a.translateBy(o,!1),i==null||i()})}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}destroy(){var t;this.shortcut.destroy(),(t=this.graphDom)==null||t.removeEventListener(ht.WHEEL,this.onWheel),super.destroy()}};let uh=nm;k(uh,"defaultOptions",{enable:!0,sensitivity:1,preventDefault:!0});const rm=class extends Ai{constructor(t,r){super(t,Object.assign({},rm.defaultOptions,r));k(this,"shortcut");k(this,"zoom",(t,r,i)=>Pt(this,null,function*(){if(!this.validate(r))return;const{graph:a}=this.context;let o;"viewport"in r&&(o=zr(r.viewport));const{sensitivity:s,onFinish:l}=this.options,c=1+me(t,-50,50)*s/100,u=a.getZoom();yield a.zoomTo(u*c,i,o),l==null||l()}));k(this,"onReset",()=>Pt(this,null,function*(){yield this.context.graph.zoomTo(1,this.options.animation)}));k(this,"preventDefault",t=>{this.options.preventDefault&&t.preventDefault()});this.shortcut=new ks(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var r;const{trigger:t}=this.options;if(this.shortcut.unbindAll(),Array.isArray(t)&&((r=this.context.canvas.getContainer())==null||r.addEventListener(ht.WHEEL,this.preventDefault),this.shortcut.bind([...t,ht.WHEEL],i=>{const{deltaX:a,deltaY:o}=i;this.zoom(-(o!=null?o:a),i,!1)})),typeof t=="object"){const{zoomIn:i=[],zoomOut:a=[],reset:o=[]}=t;this.shortcut.bind(i,s=>this.zoom(10,s,this.options.animation)),this.shortcut.bind(a,s=>this.zoom(-10,s,this.options.animation)),this.shortcut.bind(o,this.onReset)}}validate(t){if(this.destroyed)return!1;const{enable:r}=this.options;return jt(r)?r(t):!!r}destroy(){var t;this.shortcut.destroy(),(t=this.context.canvas.getContainer())==null||t.removeEventListener(ht.WHEEL,this.preventDefault),super.destroy()}};let hh=rm;k(hh,"defaultOptions",{animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0});var fh=D(81746),tR=D(28104),eR=D(63795),nR=D(39233),rR=D(5192),iR=D(76750),aR=D(51712),oR=D(67753),sR=D(12368),lR=D(89469),cR=D(41733),uR=D(64912),hR=D(29257),fR=D(26629);const dR=["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],pR=["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],vR=["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],gR=["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],mR=["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"];var yR=function(n,e,t){if(!xr(n)&&!Cs(n))return n;var r=t;return tx(n,function(i,a){r=e(r,i,a)}),r},xR=yR,ev=function(n,e){return xR(n,function(t,r,i){return e.includes(i)||(t[i]=r),t},{})};const Ws=n=>n?parseInt(n):0;function bR(n){const e=getComputedStyle(n),t=n.clientWidth||Ws(e.width),r=n.clientHeight||Ws(e.height),i=Ws(e.paddingLeft)+Ws(e.paddingRight),a=Ws(e.paddingTop)+Ws(e.paddingBottom);return[t-i,r-a]}function _x(n){let e=640,t=480;const[r,i]=bR(n);e=r||e,t=i||t;const a=1,o=1;return[Math.max(fe(e)?e:a,a),Math.max(fe(t)?t:o,o)]}function ec(n,e=!0){const t=document.createElement("div");return t.setAttribute("class",`g6-${n}`),t.style.position="absolute",t.style.display="block",e&&(t.style.inset="0px",t.style.height="100%",t.style.width="100%",t.style.overflow="hidden",t.style.pointerEvents="none"),t}function nv(n,e="div",t={},r="",i=document.body){const a=document.getElementById(n);a&&a.remove();const o=document.createElement(e);return o.innerHTML=r,o.id=n,Object.assign(o.style,t),i.appendChild(o),o}function ER(n,e){const t=n.firstChild;t?n.insertBefore(e,t):n.appendChild(e)}class _r extends Pp{}const rd=class extends _r{constructor(t,r){super(t,Object.assign({},rd.defaultOptions,r));k(this,"$element",ec("background"));this.context.canvas.getContainer().prepend(this.$element),this.update(r)}update(t){return Pt(this,null,function*(){sd(rd.prototype,this,"update").call(this,t),Object.assign(this.$element.style,ev(this.options,["key","type"]))})}destroy(){super.destroy(),this.$element.remove()}};let dh=rd;k(dh,"defaultOptions",{transition:"background 0.5s",backgroundSize:"cover"});function rv(n,e,t,r,i,a){const o=n,s=e,l=t-o,c=r-s;let u=i-o,h=a-s,f=u*l+h*c,d=0;f<=0?d=0:(u=l-u,h=c-h,f=u*l+h*c,f<=0?d=0:d=f*f/(l*l+c*c));const p=u*u+h*h-d;return p<0?0:p}function eo(n,e,t,r){return(n-t)*(n-t)+(e-r)*(e-r)}function Sx(n,e,t,r,i){return eo(n,e,t,r)<i*i}function wR(n){if(!Number.isFinite(n))return t=>t;if(n===0)return Math.round;const e=Math.pow(10,n);return t=>Math.round(t*e)/e}function Tx(n){const e=Math.min(n.x1,n.x2),t=Math.max(n.x1,n.x2),r=Math.min(n.y1,n.y2),i=Math.max(n.y1,n.y2);return{x:e,y:r,x2:t,y2:i,width:t-e,height:i-r}}class Wn{constructor(e,t,r,i){this.x1=e,this.y1=t,this.x2=r,this.y2=i}equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2}draw(e){e.moveTo(this.x1,this.y1),e.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(e){return new Wn(e.x1,e.y1,e.x2,e.y2)}cuts(e,t){if(this.y1===this.y2||t<this.y1&&t<=this.y2||t>this.y1&&t>=this.y2||e>this.x1&&e>=this.x2)return!1;if(e<this.x1&&e<=this.x2)return!0;const r=this.x1+(t-this.y1)*(this.x2-this.x1)/(this.y2-this.y1);return e<=r}distSquare(e,t){return rv(this.x1,this.y1,this.x2,this.y2,e,t)}ptClose(e,t,r){if(this.x1<this.x2){if(e<this.x1-r||e>this.x2+r)return!1}else if(e<this.x2-r||e>this.x1+r)return!1;if(this.y1<this.y2){if(t<this.y1-r||t>this.y2+r)return!1}else if(t<this.y2-r||t>this.y1+r)return!1;return!0}}var wn;(function(n){n[n.POINT=1]="POINT",n[n.PARALLEL=2]="PARALLEL",n[n.COINCIDENT=3]="COINCIDENT",n[n.NONE=4]="NONE"})(wn||(wn={}));class iv{constructor(e,t=0,r=0){this.state=e,this.x=t,this.y=r}}function ph(n,e){const t=(e.x2-e.x1)*(n.y1-e.y1)-(e.y2-e.y1)*(n.x1-e.x1),r=(n.x2-n.x1)*(n.y1-e.y1)-(n.y2-n.y1)*(n.x1-e.x1),i=(e.y2-e.y1)*(n.x2-n.x1)-(e.x2-e.x1)*(n.y2-n.y1);if(i){const a=t/i,o=r/i;return 0<=a&&a<=1&&0<=o&&o<=1?new iv(wn.POINT,n.x1+a*(n.x2-n.x1),n.y1+a*(n.y2-n.y1)):new iv(wn.NONE)}return new iv(t===0||r===0?wn.COINCIDENT:wn.PARALLEL)}function Px(n,e){const t=(e.x2-e.x1)*(n.y1-e.y1)-(e.y2-e.y1)*(n.x1-e.x1),r=(n.x2-n.x1)*(n.y1-e.y1)-(n.y2-n.y1)*(n.x1-e.x1),i=(e.y2-e.y1)*(n.x2-n.x1)-(e.x2-e.x1)*(n.y2-n.y1);if(i){const a=t/i,o=r/i;if(0<=a&&a<=1&&0<=o&&o<=1)return a}return Number.POSITIVE_INFINITY}function _R(n,e){function t(i,a,o,s){let l=Px(e,new Wn(i,a,o,s));return l=Math.abs(l-.5),l>=0&&l<=1?1:0}let r=t(n.x,n.y,n.x2,n.y);return r+=t(n.x,n.y,n.x,n.y2),r>1||(r+=t(n.x,n.y2,n.x2,n.y2),r>1)?!0:(r+=t(n.x2,n.y,n.x2,n.y2),r>0)}var _n;(function(n){n[n.LEFT=0]="LEFT",n[n.TOP=1]="TOP",n[n.RIGHT=2]="RIGHT",n[n.BOTTOM=3]="BOTTOM"})(_n||(_n={}));function vh(n,e,t){const r=new Set;return n.width<=0?(r.add(_n.LEFT),r.add(_n.RIGHT)):e<n.x?r.add(_n.LEFT):e>n.x+n.width&&r.add(_n.RIGHT),n.height<=0?(r.add(_n.TOP),r.add(_n.BOTTOM)):t<n.y?r.add(_n.TOP):t>n.y+n.height&&r.add(_n.BOTTOM),r}function Mx(n,e){let t=e.x1,r=e.y1;const i=e.x2,a=e.y2,o=Array.from(vh(n,i,a));if(o.length===0)return!0;let s=vh(n,t,r);for(;s.size!==0;){for(const l of o)if(s.has(l))return!1;if(s.has(_n.RIGHT)||s.has(_n.LEFT)){let l=n.x;s.has(_n.RIGHT)&&(l+=n.width),r=r+(l-t)*(a-r)/(i-t),t=l}else{let l=n.y;s.has(_n.BOTTOM)&&(l+=n.height),t=t+(l-r)*(i-t)/(a-r),r=l}s=vh(n,t,r)}return!0}function SR(n,e){let t=Number.POSITIVE_INFINITY,r=0;function i(a,o,s,l){let c=Px(e,new Wn(a,o,s,l));c=Math.abs(c-.5),c>=0&&c<=1&&(r++,c<t&&(t=c))}return i(n.x,n.y,n.x2,n.y),i(n.x,n.y,n.x,n.y2),r>1||(i(n.x,n.y2,n.x2,n.y2),r>1)?t:(i(n.x2,n.y,n.x2,n.y2),r===0?-1:t)}function TR(n,e){let t=0;const r=ph(n,new Wn(e.x,e.y,e.x2,e.y));t+=r.state===wn.POINT?1:0;const i=ph(n,new Wn(e.x,e.y,e.x,e.y2));t+=i.state===wn.POINT?1:0;const a=ph(n,new Wn(e.x,e.y2,e.x2,e.y2));t+=a.state===wn.POINT?1:0;const o=ph(n,new Wn(e.x2,e.y,e.x2,e.y2));return t+=o.state===wn.POINT?1:0,{top:r,left:i,bottom:a,right:o,count:t}}class sr{constructor(e,t,r,i){this.x=e,this.y=t,this.width=r,this.height=i}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(e){return new sr(e.x,e.y,e.width,e.height)}equals(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height}clone(){return new sr(this.x,this.y,this.width,this.height)}add(e){const t=Math.min(this.x,e.x),r=Math.min(this.y,e.y),i=Math.max(this.x2,e.x+e.width),a=Math.max(this.y2,e.y+e.height);this.x=t,this.y=r,this.width=i-t,this.height=a-r}addPoint(e){const t=Math.min(this.x,e.x),r=Math.min(this.y,e.y),i=Math.max(this.x2,e.x),a=Math.max(this.y2,e.y);this.x=t,this.y=r,this.width=i-t,this.height=a-r}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(e){e.rect(this.x,this.y,this.width,this.height)}containsPt(e,t){return e>=this.x&&e<=this.x2&&t>=this.y&&t<=this.y2}get area(){return this.width*this.height}intersects(e){return this.area<=0||e.width<=0||e.height<=0?!1:e.x+e.width>this.x&&e.y+e.height>this.y&&e.x<this.x2&&e.y<this.y2}distSquare(e,t){if(this.containsPt(e,t))return 0;const r=vh(this,e,t);return r.has(_n.TOP)?r.has(_n.LEFT)?eo(e,t,this.x,this.y):r.has(_n.RIGHT)?eo(e,t,this.x2,this.y):(this.y-t)*(this.y-t):r.has(_n.BOTTOM)?r.has(_n.LEFT)?eo(e,t,this.x,this.y2):r.has(_n.RIGHT)?eo(e,t,this.x2,this.y2):(t-this.y2)*(t-this.y2):r.has(_n.LEFT)?(this.x-e)*(this.x-e):r.has(_n.RIGHT)?(e-this.x2)*(e-this.x2):0}}function PR(n){if(n.length===0)return null;const e=n[0],t=new sr(e.x,e.y,0,0);for(const r of n)t.addPoint(r);return t}class gh{constructor(e,t,r){this.cx=e,this.cy=t,this.radius=r}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return this.radius*2}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return this.radius*2}static from(e){return new gh(e.cx,e.cy,e.radius)}containsPt(e,t){return eo(this.cx,this.cy,e,t)<this.radius*this.radius}distSquare(e,t){const r=eo(this.cx,this.cy,e,t);if(r<this.radius*this.radius)return 0;const i=Math.sqrt(r)-this.radius;return i*i}draw(e){e.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,Math.PI*2)}}class Uo{constructor(e,t=0,r=0,i=0,a=0,o=10,s=10,l=new Float32Array(Math.max(0,o*s)).fill(0)){this.pixelGroup=e,this.i=t,this.j=r,this.pixelX=i,this.pixelY=a,this.width=o,this.height=s,this.area=l}createSub(e,t){return new Uo(this.pixelGroup,e.x,e.y,t.x,t.y,e.width,e.height)}static fromPixelRegion(e,t){return new Uo(t,0,0,e.x,e.y,Math.ceil(e.width/t),Math.ceil(e.height/t))}copy(e,t){return new Uo(this.pixelGroup,this.scaleX(t.x),this.scaleY(t.y),t.x,t.y,e.width,e.height,e.area)}boundX(e){return e<this.i?this.i:e>=this.width?this.width-1:e}boundY(e){return e<this.j?this.j:e>=this.height?this.height-1:e}scaleX(e){return this.boundX(Math.floor((e-this.pixelX)/this.pixelGroup))}scaleY(e){return this.boundY(Math.floor((e-this.pixelY)/this.pixelGroup))}scale(e){const t=this.scaleX(e.x),r=this.scaleY(e.y),i=this.boundX(Math.ceil((e.x+e.width-this.pixelX)/this.pixelGroup)),a=this.boundY(Math.ceil((e.y+e.height-this.pixelY)/this.pixelGroup)),o=i-t,s=a-r;return new sr(t,r,o,s)}invertScaleX(e){return Math.round(e*this.pixelGroup+this.pixelX)}invertScaleY(e){return Math.round(e*this.pixelGroup+this.pixelY)}addPadding(e,t){const r=Math.ceil(t/this.pixelGroup),i=this.boundX(e.x-r),a=this.boundY(e.y-r),o=this.boundX(e.x2+r),s=this.boundY(e.y2+r),l=o-i,c=s-a;return new sr(i,a,l,c)}get(e,t){return e<0||t<0||e>=this.width||t>=this.height?Number.NaN:this.area[e+t*this.width]}inc(e,t,r){e<0||t<0||e>=this.width||t>=this.height||(this.area[e+t*this.width]+=r)}set(e,t,r){e<0||t<0||e>=this.width||t>=this.height||(this.area[e+t*this.width]=r)}incArea(e,t){if(e.width<=0||e.height<=0||t===0)return;const r=this.width,i=e.width,a=Math.max(0,e.i),o=Math.max(0,e.j),s=Math.min(e.i+e.width,r),l=Math.min(e.j+e.height,this.height);if(!(l<=0||s<=0||a>=r||l>=this.height))for(let c=o;c<l;c++){const u=(c-e.j)*i,h=c*r;for(let f=a;f<s;f++){const d=e.area[f-e.i+u];d!==0&&(this.area[f+h]+=t*d)}}}fill(e){this.area.fill(e)}fillArea(e,t){const r=e.x+e.y*this.width;for(let i=0;i<e.height;i++){const a=r+i*this.width;this.area.fill(t,a,a+e.width)}}fillHorizontalLine(e,t,r,i){const a=e+t*this.width;this.area.fill(i,a,a+r)}fillVerticalLine(e,t,r,i){const a=e+t*this.width;for(let o=0;o<r;o++)this.area[a+o*this.width]=i}clear(){this.area.fill(0)}toString(){let e="";for(let t=0;t<this.height;t++){const r=t*this.width;for(let i=0;i<this.width;i++){const a=this.area[r+i];e+=a.toFixed(1).padStart(6),e+=" "}e+=`
`}return e}draw(e,t=!0){if(this.width<=0||this.height<=0)return;e.save(),t&&e.translate(this.pixelX,this.pixelY);const r=this.area.reduce((o,s)=>Math.min(o,s),Number.POSITIVE_INFINITY),i=this.area.reduce((o,s)=>Math.max(o,s),Number.NEGATIVE_INFINITY),a=o=>(o-r)/(i-r);e.scale(this.pixelGroup,this.pixelGroup);for(let o=0;o<this.width;o++)for(let s=0;s<this.height;s++){const l=this.area[o+s*this.width];e.fillStyle=`rgba(0, 0, 0, ${a(l)})`,e.fillRect(o,s,1,1)}e.restore()}drawThreshold(e,t,r=!0){if(!(this.width<=0||this.height<=0)){e.save(),r&&e.translate(this.pixelX,this.pixelY),e.scale(this.pixelGroup,this.pixelGroup);for(let i=0;i<this.width;i++)for(let a=0;a<this.height;a++){const o=this.area[i+a*this.width];e.fillStyle=o>t?"black":"white",e.fillRect(i,a,1,1)}e.restore()}}}function Cx(n,e){const t=r=>({x:r.x-e,y:r.y-e,width:r.width+2*e,height:r.height+2*e});return Array.isArray(n)?n.map(t):t(n)}function Ax(n,e,t){return Ox(Object.assign(Tx(n),{distSquare:(r,i)=>rv(n.x1,n.y1,n.x2,n.y2,r,i)}),e,t)}function Ox(n,e,t){const r=Cx(n,t),i=e.scale(r),a=e.createSub(i,r);return MR(a,e,t,(o,s)=>n.distSquare(o,s)),a}function MR(n,e,t,r){const i=t*t;for(let a=0;a<n.height;a++)for(let o=0;o<n.width;o++){const s=e.invertScaleX(n.i+o),l=e.invertScaleY(n.j+a),c=r(s,l);if(c===0){n.set(o,a,i);continue}if(c<i){const u=t-Math.sqrt(c);n.set(o,a,u*u)}}return n}function CR(n,e,t){const r=e.scale(n),i=e.addPadding(r,t),a=e.createSub(i,{x:n.x-t,y:n.y-t}),o=r.x-i.x,s=r.y-i.y,l=i.x2-r.x2,c=i.y2-r.y2,u=i.width-o-l,h=i.height-s-c,f=t*t;a.fillArea({x:o,y:s,width:u+1,height:h+1},f);const d=[0],p=Math.max(s,o,l,c);{const x=e.invertScaleX(r.x+r.width/2);for(let _=1;_<p;_++){const S=e.invertScaleY(r.y-_),b=n.distSquare(x,S);if(b<f){const y=t-Math.sqrt(b);d.push(y*y)}else break}}const v=[],g=Math.max(o,l),m=Math.max(s,l);for(let x=1;x<g;x++){const _=e.invertScaleX(r.x-x),S=[];for(let b=1;b<m;b++){const y=e.invertScaleY(r.y-b),E=n.distSquare(_,y);if(E<f){const w=t-Math.sqrt(E);S.push(w*w)}else S.push(0)}v.push(S)}for(let x=1;x<Math.min(s,d.length);x++){const _=d[x];a.fillHorizontalLine(o,s-x,u+1,_)}for(let x=1;x<Math.min(c,d.length);x++){const _=d[x];a.fillHorizontalLine(o,s+h+x,u+1,_)}for(let x=1;x<Math.min(o,d.length);x++){const _=d[x];a.fillVerticalLine(o-x,s,h+1,_)}for(let x=1;x<Math.min(c,d.length);x++){const _=d[x];a.fillVerticalLine(o+u+x,s,h+1,_)}for(let x=1;x<o;x++){const _=v[x-1],S=o-x;for(let b=1;b<s;b++)a.set(S,s-b,_[b-1]);for(let b=1;b<c;b++)a.set(S,s+h+b,_[b-1])}for(let x=1;x<l;x++){const _=v[x-1],S=o+u+x;for(let b=1;b<s;b++)a.set(S,s-b,_[b-1]);for(let b=1;b<c;b++)a.set(S,s+h+b,_[b-1])}return a}function bU(n,e,t,r){return{x:n,y:e,width:t,height:r}}function EU(n,e,t){return{cx:n,cy:e,radius:t}}function wU(n,e,t,r){return{x1:n,y1:e,x2:t,y2:r}}function nn(n,e){return{x:n,y:e}}function AR(n,e,t,r){if(n.length===0)return[];const i=LR(n);return i.map((a,o)=>{const s=i.slice(0,o);return OR(e,a,s,t,r)}).flat()}function OR(n,e,t,r,i){const a=nn(e.cx,e.cy),o=kR(a,t,n);if(o==null)return[];const s=new Wn(a.x,a.y,o.cx,o.cy),l=NR(s,n,r,i);return RR(l,n)}function NR(n,e,t,r){const i=[],a=[];a.push(n);let o=!0;for(let s=0;s<t&&o;s++)for(o=!1;!o&&a.length>0;){const l=a.pop(),c=Nx(e,l),u=c?TR(l,c):null;if(!c||!u||u.count!==2){o||i.push(l);continue}let h=r,f=yh(c,h,u,!0),d=no(f,a)||no(f,i),p=mh(f,e);for(;!d&&p&&h>=1;)h/=1.5,f=yh(c,h,u,!0),d=no(f,a)||no(f,i),p=mh(f,e);if(f&&!d&&!p&&(a.push(new Wn(l.x1,l.y1,f.x,f.y)),a.push(new Wn(f.x,f.y,l.x2,l.y2)),o=!0),o)continue;h=r,f=yh(c,h,u,!1);let v=no(f,a)||no(f,i);for(p=mh(f,e);!v&&p&&h>=1;)h/=1.5,f=yh(c,h,u,!1),v=no(f,a)||no(f,i),p=mh(f,e);f&&!v&&(a.push(new Wn(l.x1,l.y1,f.x,f.y)),a.push(new Wn(f.x,f.y,l.x2,l.y2)),o=!0),o||i.push(l)}for(;a.length>0;)i.push(a.pop());return i}function RR(n,e){const t=[];for(;n.length>0;){const r=n.pop();if(n.length===0){t.push(r);break}const i=n.pop(),a=new Wn(r.x1,r.y1,i.x2,i.y2);Nx(e,a)?(t.push(r),n.push(i)):n.push(a)}return t}function kR(n,e,t){let r=Number.POSITIVE_INFINITY;return e.reduce((i,a)=>{const o=eo(n.x,n.y,a.cx,a.cy);if(o>r)return i;const s=new Wn(n.x,n.y,a.cx,a.cy),l=IR(t,s);return o*(l+1)*(l+1)<r&&(i=a,r=o*(l+1)*(l+1)),i},null)}function LR(n){if(n.length<2)return n;let e=0,t=0;return n.forEach(r=>{e+=r.cx,t+=r.cy}),e/=n.length,t/=n.length,n.map(r=>{const i=e-r.cx,a=t-r.cy,o=i*i+a*a;return[r,o]}).sort((r,i)=>r[1]-i[1]).map(r=>r[0])}function mh(n,e){return e.some(t=>t.containsPt(n.x,n.y))}function no(n,e){return e.some(t=>!!(Sx(t.x1,t.y1,n.x,n.y,.001)||Sx(t.x2,t.y2,n.x,n.y,.001)))}function Nx(n,e){let t=Number.POSITIVE_INFINITY,r=null;for(const i of n){if(!Mx(i,e))continue;const a=SR(i,e);a>=0&&a<t&&(r=i,t=a)}return r}function IR(n,e){return n.reduce((t,r)=>Mx(r,e)&&_R(r,e)?t+1:t,0)}function yh(n,e,t,r){const i=t.top,a=t.left,o=t.bottom,s=t.right;if(r){if(a.state===wn.POINT){if(i.state===wn.POINT)return nn(n.x-e,n.y-e);if(o.state===wn.POINT)return nn(n.x-e,n.y2+e);const f=n.width*n.height;return n.width*((a.y-n.y+(s.y-n.y))*.5)<f*.5?a.y>s.y?nn(n.x-e,n.y-e):nn(n.x2+e,n.y-e):a.y<s.y?nn(n.x-e,n.y2+e):nn(n.x2+e,n.y2+e)}if(s.state===wn.POINT){if(i.state===wn.POINT)return nn(n.x2+e,n.y-e);if(o.state===wn.POINT)return nn(n.x2+e,n.y2+e)}const u=n.height*n.width;return n.height*((i.x-n.x+(s.x-n.x))*.5)<u*.5?i.x>o.x?nn(n.x-e,n.y-e):nn(n.x-e,n.y2+e):i.x<o.x?nn(n.x2+e,n.y-e):nn(n.x2+e,n.y2+e)}if(a.state===wn.POINT){if(i.state===wn.POINT)return nn(n.x2+e,n.y2+e);if(o.state===wn.POINT)return nn(n.x2+e,n.y-e);const u=n.height*n.width;return n.width*((a.y-n.y+(s.y-n.y))*.5)<u*.5?a.y>s.y?nn(n.x2+e,n.y2+e):nn(n.x-e,n.y2+e):a.y<s.y?nn(n.x2+e,n.y-e):nn(n.x-e,n.y-e)}if(s.state===wn.POINT){if(i.state===wn.POINT)return nn(n.x-e,n.y2+e);if(o.state===wn.POINT)return nn(n.x-e,n.y-e)}const l=n.height*n.width;return n.height*((i.x-n.x+(s.x-n.x))*.5)<l*.5?i.x>o.x?nn(n.x2+e,n.y2+e):nn(n.x2+e,n.y-e):i.x<o.x?nn(n.x-e,n.y2+e):nn(n.x-e,n.y-e)}function DR(n,e,t,r){if(!(n.closed?t<n.length:t<n.length-1))return!1;const a=n.get(e),o=n.get(t+1);for(let s=e+1;s<=t;s++){const l=n.get(s);if(rv(a.x,a.y,o.x,o.y,l.x,l.y)>r)return!1}return!0}function BR(n=0){return e=>{if(n<0||e.length<3)return e;const t=[];let r=0;const i=n*n;for(;r<e.length;){let a=r+1;for(;DR(e,r,a,i);)a++;t.push(e.get(r)),r=a}return new Vo(t)}}function FR(n,e){switch(n){case-2:return(((-e+3)*e-3)*e+1)/6;case-1:return((3*e-6)*e*e+4)/6;case 0:return(((-3*e+3)*e+3)*e+1)/6;case 1:return e*e*e/6;default:throw new Error("unknown error")}}function GR(n=6){function a(o,s,l){let c=0,u=0;for(let h=-2;h<=1;h++){const f=o.get(s+h),d=FR(h,l);c+=d*f.x,u+=d*f.y}return{x:c,y:u}}return o=>{if(o.length<3)return o;const s=[],l=o.closed,c=o.length+3-1+(l?0:2);s.push(a(o,2-(l?0:2),0));for(let u=2-(l?0:2);u<c;u++)for(let h=1;h<=n;h++)s.push(a(o,u,h/n));return new Vo(s)}}function zR(n=8){return e=>{let t=n,r=e.length;if(t>1)for(r=Math.floor(e.length/t);r<3&&t>1;)t-=1,r=Math.floor(e.length/t);const i=[];for(let a=0,o=0;o<r;o++,a+=t)i.push(e.get(a));return new Vo(i)}}class Vo{constructor(e=[],t=!0){this.points=e,this.closed=t}get(e){const t=e,r=this.points.length;return e<0?this.closed?this.get(e+r):this.points[0]:e>=r?this.closed?this.get(e-r):this.points[r-1]:this.points[t]}get length(){return this.points.length}toString(e=1/0){const t=this.points;if(t.length===0)return"";const r=typeof e=="function"?e:wR(e);let i="M";for(const a of t)i+=`${r(a.x)},${r(a.y)} L`;return i=i.slice(0,-1),this.closed&&(i+=" Z"),i}draw(e){const t=this.points;if(t.length!==0){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(const r of t)e.lineTo(r.x,r.y);this.closed&&e.closePath()}}sample(e){return zR(e)(this)}simplify(e){return BR(e)(this)}bSplines(e){return GR(e)(this)}apply(e){return e(this)}containsElements(e){const t=PR(this.points);return t?e.every(r=>t.containsPt(r.cx,r.cy)&&this.withinArea(r.cx,r.cy)):!1}withinArea(e,t){if(this.length===0)return!1;let r=0;const i=this.points[0],a=new Wn(i.x,i.y,i.x,i.y);for(let o=1;o<this.points.length;o++){const s=this.points[o];a.x1=a.x2,a.y1=a.y2,a.x2=s.x,a.y2=s.y,a.cuts(e,t)&&r++}return a.x1=a.x2,a.y1=a.y2,a.x2=i.x,a.y2=i.y,a.cuts(e,t)&&r++,r%2===1}}class WR{constructor(e=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=e}add(e){this.set.add(`${e.x}x${e.y}`),this.arr[this.count++]=e}contains(e){return this.set.has(`${e.x}x${e.y}`)}isFirst(e){if(this.count===0)return!1;const t=this.arr[0];return t!=null&&t.x===e.x&&t.y===e.y}path(){return new Vo(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(e){return this.arr[e]}get length(){return this.count}}const nc=0,xh=1,bh=2,av=3;function UR(n,e){const t=(Math.floor(n.width)+Math.floor(n.height))*2,r=new WR(t);function i(l,c,u,h){const f=n.get(l,c);return Number.isNaN(f)?Number.NaN:f>e?u+h:u}function a(l,c){let u=nc;return u=i(l,c,u,1),u=i(l+1,c,u,2),u=i(l,c+1,u,4),u=i(l+1,c+1,u,8),Number.isNaN(u)?-1:u}let o=xh;function s(l,c){let u=l,h=c,f=n.invertScaleX(u),d=n.invertScaleY(h);for(let p=0;p<n.width*n.height;p++){const v={x:f,y:d};if(r.contains(v)){if(r.isFirst(v))return!0}else r.add(v);const g=a(u,h);switch(g){case-1:return!0;case 0:case 3:case 2:case 7:o=bh;break;case 12:case 14:case 4:o=av;break;case 6:o=o===nc?av:bh;break;case 1:case 13:case 5:o=nc;break;case 9:o=o===bh?nc:xh;break;case 10:case 8:case 11:o=xh;break;default:return console.warn("Marching squares invalid state: "+g),!0}switch(o){case nc:h--,d-=n.pixelGroup;break;case xh:h++,d+=n.pixelGroup;break;case av:u--,f-=n.pixelGroup;break;case bh:u++,f+=n.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+g),!0}}return!0}for(let l=0;l<n.width;l++)for(let c=0;c<n.height;c++){if(n.get(l,c)<=e)continue;const u=a(l,c);if(!(u<0||u===15)&&s(l,c))return r.path()}return null}const Eh={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function rc(n){return n!=null&&typeof n.radius=="number"}function Rx(n,e){if(rc(n)!==rc(e))return!1;if(rc(n)){const r=e;return n.cx===r.cx&&n.cy===r.cy&&n.radius===r.radius}const t=e;return n.x===t.x&&n.y===t.y&&n.width===t.width&&n.height===t.height}var Yi;(function(n){n[n.MEMBERS=0]="MEMBERS",n[n.NON_MEMBERS=1]="NON_MEMBERS",n[n.EDGES=2]="EDGES"})(Yi||(Yi={}));class ov{constructor(e={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new sr(0,0,0,0),this.potentialArea=new Uo(1,0,0,0,0,0,0),this.o=Object.assign({},Eh,e)}pushMember(...e){if(e.length!==0){this.dirty.add(Yi.MEMBERS);for(const t of e)this.members.push({raw:t,obj:rc(t)?gh.from(t):sr.from(t),area:null})}}removeMember(e){const t=this.members.findIndex(r=>Rx(r.raw,e));return t<0?!1:(this.members.splice(t,1),this.dirty.add(Yi.MEMBERS),!0)}removeNonMember(e){const t=this.nonMembers.findIndex(r=>Rx(r.raw,e));return t<0?!1:(this.nonMembers.splice(t,1),this.dirty.add(Yi.NON_MEMBERS),!0)}removeEdge(e){const t=this.edges.findIndex(r=>r.obj.equals(e));return t<0?!1:(this.edges.splice(t,1),this.dirty.add(Yi.NON_MEMBERS),!0)}pushNonMember(...e){if(e.length!==0){this.dirty.add(Yi.NON_MEMBERS);for(const t of e)this.nonMembers.push({raw:t,obj:rc(t)?gh.from(t):sr.from(t),area:null})}}pushEdge(...e){if(e.length!==0){this.dirty.add(Yi.EDGES);for(const t of e)this.edges.push({raw:t,obj:Wn.from(t),area:null})}}update(){const e=this.dirty.has(Yi.MEMBERS),t=this.dirty.has(Yi.NON_MEMBERS);let r=this.dirty.has(Yi.EDGES);this.dirty.clear();const i=this.members.map(c=>c.obj);if(this.o.virtualEdges&&(e||t)){const c=this.nonMembers.map(f=>f.obj),u=AR(i,c,this.o.maxRoutingIterations,this.o.morphBuffer),h=new Map(this.virtualEdges.map(f=>[f.obj.toString(),f.area]));this.virtualEdges=u.map(f=>{var d;return{raw:f,obj:f,area:(d=h.get(f.toString()))!==null&&d!==void 0?d:null}}),r=!0}let a=!1;if(e||r){const c=this.virtualEdges.concat(this.edges).map(d=>d.obj),u=HR(i,c),h=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,f=sr.from(Cx(u,h));f.equals(this.activeRegion)||(a=!0,this.activeRegion=f)}if(a){const c=Math.ceil(this.activeRegion.width/this.o.pixelGroup),u=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=Uo.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(h=>h.area=null),this.nonMembers.forEach(h=>h.area=null),this.edges.forEach(h=>h.area=null),this.virtualEdges.forEach(h=>h.area=null)):(c!==this.potentialArea.width||u!==this.potentialArea.height)&&(this.potentialArea=Uo.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}const o=new Map,s=c=>{if(c.area){const u=`${c.obj.width}x${c.obj.height}x${c.obj instanceof sr?"R":"C"}`;o.set(u,c.area)}},l=c=>{if(c.area)return;const u=`${c.obj.width}x${c.obj.height}x${c.obj instanceof sr?"R":"C"}`;if(o.has(u)){const f=o.get(u);c.area=this.potentialArea.copy(f,{x:c.obj.x-this.o.nodeR1,y:c.obj.y-this.o.nodeR1});return}const h=c.obj instanceof sr?CR(c.obj,this.potentialArea,this.o.nodeR1):Ox(c.obj,this.potentialArea,this.o.nodeR1);c.area=h,o.set(u,h)};this.members.forEach(s),this.nonMembers.forEach(s),this.members.forEach(l),this.nonMembers.forEach(c=>{this.activeRegion.intersects(c.obj)?l(c):c.area=null}),this.edges.forEach(c=>{c.area||(c.area=Ax(c.obj,this.potentialArea,this.o.edgeR1))}),this.virtualEdges.forEach(c=>{c.area||(c.area=Ax(c.obj,this.potentialArea,this.o.edgeR1))})}drawMembers(e){for(const t of this.members)t.obj.draw(e)}drawNonMembers(e){for(const t of this.nonMembers)t.obj.draw(e)}drawEdges(e){for(const t of this.edges)t.obj.draw(e)}drawPotentialArea(e,t=!0){this.potentialArea.draw(e,t)}compute(){if(this.members.length===0)return new Vo([]);this.dirty.size>0&&this.update();const{o:e,potentialArea:t}=this,r=this.members.map(s=>s.area),i=this.virtualEdges.concat(this.edges).map(s=>s.area),a=this.nonMembers.filter(s=>s.area!=null).map(s=>s.area),o=this.members.map(s=>s.obj);return VR(t,r,i,a,s=>s.containsElements(o),e)}}function VR(n,e,t,r,i,a={}){const o=Object.assign({},Eh,a);let s=o.threshold,l=o.memberInfluenceFactor,c=o.edgeInfluenceFactor,u=o.nonMemberInfluenceFactor;const h=(o.nodeR0-o.nodeR1)*(o.nodeR0-o.nodeR1),f=(o.edgeR0-o.edgeR1)*(o.edgeR0-o.edgeR1);for(let d=0;d<o.maxMarchingIterations;d++){if(n.clear(),l!==0){const v=l/h;for(const g of e)n.incArea(g,v)}if(c!==0){const v=c/f;for(const g of t)n.incArea(g,v)}if(u!==0){const v=u/h;for(const g of r)n.incArea(g,v)}const p=UR(n,s);if(p&&i(p))return p;if(s*=.95,d<=o.maxMarchingIterations*.5)l*=1.2,c*=1.2;else if(u!==0&&r.length>0)u*=.8;else break}return new Vo([])}function HR(n,e){if(n.length===0)return new sr(0,0,0,0);const t=sr.from(n[0]);for(const r of n)t.add(r);for(const r of e)t.add(Tx(r));return t}function _U(n,e=[],t=[],r={}){if(n.length===0)return new Vo([]);const i=new ov(r);return i.pushMember(...n),i.pushNonMember(...e),i.pushEdge(...t),i.compute()}const im=class extends _r{constructor(t,r){super(t,Ci({},im.defaultOptions,r));k(this,"shape");k(this,"bubbleSets");k(this,"path");k(this,"members",new Map);k(this,"avoidMembers",new Map);k(this,"bubbleSetOptions",{});k(this,"drawBubbleSets",()=>{const{style:t,bubbleSetOptions:r}=this.parseOptions();vn(this.bubbleSetOptions,r)||this.init(),this.bubbleSetOptions=at({},r);const i=Se(at({},t),{d:this.getPath()});this.shape?this.shape.update(i):(this.shape=new Kl({style:i}),this.context.canvas.appendChild(this.shape))});k(this,"updateBubbleSetsPath",t=>{if(!this.shape)return;const r=it(t.data);[...this.options.members,...this.options.avoidMembers].includes(r)&&this.shape.update(Se(at({},this.parseOptions().style),{d:this.getPath(r)}))});k(this,"getPath",t=>{const{graph:r}=this.context,i=this.options.members,a=[...this.members.keys()],o=this.options.avoidMembers,s=[...this.avoidMembers.keys()];if(!t&&vn(i,a)&&vn(o,s))return this.path;const{enter:l=[],exit:c=[]}=As(a,i,v=>v),{enter:u=[],exit:h=[]}=As(s,o,v=>v);t&&(c.push(t),l.push(t));const f=(v,g,m)=>{v.forEach(x=>{const _=m?this.members:this.avoidMembers,S=m?"pushMember":"pushNonMember",b=m?"removeMember":"removeNonMember";if(g){let y;r.getElementType(x)==="edge"?([y]=XR(r,x),this.bubbleSets.pushEdge(y)):([y]=YR(r,x),this.bubbleSets[S](y)),_.set(x,y)}else{const y=_.get(x);y&&(r.getElementType(x)==="edge"?this.bubbleSets.removeEdge(y):this.bubbleSets[b](y),_.delete(x))}})};f(c,!1,!0),f(l,!0,!0),f(h,!1,!1),f(u,!0,!1);const p=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=q1(p.points.map(zr)),this.path});this.bindEvents(),this.bubbleSets=new ov(this.options)}bindEvents(){this.context.graph.on(Tt.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(Tt.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new ov(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){const l=this.options,{type:t,key:r,members:i,avoidMembers:a}=l,o=Ce(l,["type","key","members","avoidMembers"]),s=Object.keys(o).reduce((c,u)=>(u in Eh?c.bubbleSetOptions[u]=o[u]:c.style[u]=o[u],c),{style:{},bubbleSetOptions:{}});return at({type:t,key:r,members:i,avoidMembers:a},s)}addMember(t){const r=Array.isArray(t)?t:[t];r.some(i=>this.options.avoidMembers.includes(i))&&(this.options.avoidMembers=this.options.avoidMembers.filter(i=>!r.includes(i))),this.options.members=[...new Set([...this.options.members,...r])],this.drawBubbleSets()}removeMember(t){const r=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(i=>!r.includes(i)),this.drawBubbleSets()}updateMember(t){this.options.members=jt(t)?t(this.options.members):t,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(t){const r=Array.isArray(t)?t:[t];r.some(i=>this.options.members.includes(i))&&(this.options.members=this.options.members.filter(i=>!r.includes(i))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...r])],this.drawBubbleSets()}removeAvoidMember(t){const r=Array.isArray(t)?t:[t];this.options.avoidMembers.some(i=>r.includes(i))&&(this.options.avoidMembers=this.options.avoidMembers.filter(i=>!r.includes(i)),this.drawBubbleSets())}updateAvoidMember(t){this.options.avoidMembers=Array.isArray(t)?t:[t],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(Tt.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(Tt.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}};let wh=im;k(wh,"defaultOptions",at({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},Eh));const YR=(n,e)=>(Array.isArray(e)?e:[e]).map(r=>{const i=n.getElementRenderBounds(r);return new sr(i.min[0],i.min[1],aa(i),oa(i))}),XR=(n,e)=>(Array.isArray(e)?e:[e]).map(r=>{const i=n.getEdgeData(r),a=n.getElementPosition(i.source),o=n.getElementPosition(i.target);return Wn.from({x1:a[0],y1:a[1],x2:o[0],y2:o[1]})});class SU extends null{constructor(t,r){super(t,r);k(this,"setOptions",t=>{const r={cameraType:"setType",near:"setNear",far:"setFar",fov:"setFov",aspect:"setAspect",projectionMode:"setProjectionMode",distance:"setDistance",minDistance:"setMinDistance",maxDistance:"setMaxDistance",roll:"setRoll",elevation:"setElevation",azimuth:"setAzimuth"},i=(a,o)=>{switch(a){case"projectionMode":return o==="perspective"?1:0;case"cameraType":return{orbiting:0,exploring:1,tracking:2}[o];case"aspect":return typeof o=="number"?o:this.getCanvasAspect();default:return o}};Object.entries(r).forEach(([a,o])=>{const s=t[a];if(s!==void 0){const l=i(a,s);this.context.canvas.getCamera()[o](l)}})});this.bindEvents()}update(t){this.setOptions(t),super.update(t)}bindEvents(){this.context.graph.once(GraphEvent.BEFORE_DRAW,()=>this.setOptions(this.options))}getCanvasAspect(){const[t,r]=this.context.viewport.getCanvasSize();return t/r}}function jR(n){return`
    <ul class="g6-contextmenu-ul">
      ${n.map(e=>`<li  class="g6-contextmenu-li" value="${e.value}">${e.name}</li>`).join("")}
    </ul>
  `}const $R=`
  .g6-contextmenu {
    font-size: 12px;
    background-color: rgba(255, 255, 255, 0.96);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;
    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;
  }

  .g6-contextmenu-ul {
    max-width: 256px;
    min-width: 96px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .g6-contextmenu-li {
    padding: 8px 12px;
    cursor: pointer;
    user-select: none;
  }

  .g6-contextmenu-li:hover {
    background-color: #f5f5f5;
    cursor: pointer;
  }
`,am=class extends _r{constructor(t,r){super(t,Object.assign({},am.defaultOptions,r));k(this,"$element");k(this,"targetElement",null);k(this,"onTriggerEvent",t=>{var r;(r=t.preventDefault)==null||r.call(t),this.show(t)});k(this,"onMenuItemClick",t=>{const{onClick:r,trigger:i}=this.options;if(t.target instanceof HTMLElement&&t.target.className.includes("g6-contextmenu-li")){const a=t.target.getAttribute("value");r==null||r(a,t.target,this.targetElement),this.hide()}i!=="click"&&this.hide()});this.initElement(),this.update(r)}initElement(){this.$element=ec("contextmenu",!1);const{className:t}=this.options;t&&this.$element.classList.add(t),this.context.canvas.getContainer().appendChild(this.$element),nv("g6-contextmenu-css","style",{},$R,document.head)}show(t){return Pt(this,null,function*(){const{enable:r,offset:i}=this.options;if(typeof r=="function"&&!r(t)||!r){this.hide();return}const a=yield this.getDOMContent(t);a instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(a)):this.$element.innerHTML=a;const o=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${t.client.x-o.left+i[0]}px`,this.$element.style.top=`${t.client.y-o.top+i[1]}px`,this.$element.style.display="block",this.targetElement=t.target})}hide(){this.$element.style.display="none",this.targetElement=null}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(t){return Pt(this,null,function*(){const{getContent:r,getItems:i}=this.options;return i?jR(yield i(t)):yield r(t)})}bindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;t.on(`canvas:${r}`,this.onTriggerEvent),t.on(`node:${r}`,this.onTriggerEvent),t.on(`edge:${r}`,this.onTriggerEvent),t.on(`combo:${r}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){const{graph:t}=this.context,{trigger:r}=this.options;t.off(`canvas:${r}`,this.onTriggerEvent),t.off(`node:${r}`,this.onTriggerEvent),t.off(`edge:${r}`,this.onTriggerEvent),t.off(`combo:${r}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}};let _h=am;k(_h,"defaultOptions",{trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0});const KR={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8},kx=.05,om=class extends _r{constructor(t,r){super(t,Object.assign({},om.defaultOptions,r));k(this,"lens");k(this,"shapes",new Map);k(this,"r",this.options.r);k(this,"onEdgeFilter",t=>{if(this.options.trigger==="drag"&&this.isLensOn)return;const r=zr(t.canvas);this.renderLens(r),this.renderFocusElements()});k(this,"renderLens",t=>{const[r,i]=t,a={size:this.r*2,x:r,y:i};if(this.isLensOn)this.lens.update(a);else{const o=Object.assign({},KR,this.options.style,a);this.lens=new Gs({style:o})}this.canvas.appendChild(this.lens)});k(this,"getFilterData",()=>{const{filter:t}=this.options,{model:r}=this.context,i=r.getData();if(!t)return i;const{nodes:a,edges:o,combos:s}=i;return{nodes:a.filter(l=>t(it(l),"node")),edges:o.filter(l=>t(it(l),"edge")),combos:s.filter(l=>t(it(l),"combo"))}});k(this,"getFocusElements",t=>{const{nodes:r,edges:i}=this.getFilterData(),a=r.filter(l=>Oi(Hi(l),t)<this.r),o=a.map(l=>it(l)),s=i.filter(l=>{const{source:c,target:u}=l,h=o.includes(c),f=o.includes(u);switch(this.options.nodeType){case"both":return h&&f;case"either":return h!==f;case"source":return h&&!f;case"target":return!h&&f;default:return!1}});return{nodes:a,edges:s}});k(this,"renderFocusElements",()=>{const{element:t,graph:r}=this.context;if(!this.isLensOn)return;const i=this.lens.getCenter(),{nodes:a,edges:o}=this.getFocusElements(i),s=new Set,{nodeStyle:l,edgeStyle:c}=this.options,u=h=>{const f=it(h);s.add(f);const d=t.getElement(f);if(!d)return;const p=this.shapes.get(f)||d.cloneNode();p.setPosition(d.getPosition()),p.id=d.id,this.shapes.has(f)?Object.entries(d.attributes).forEach(([m,x])=>{p.style[m]!==x&&(p.style[m]=x)}):(this.canvas.appendChild(p),this.shapes.set(f,p));const v=r.getElementType(f),g=this.getElementStyle(v,h);p.update(g)};a.forEach(u),o.forEach(u),this.shapes.forEach((h,f)=>{s.has(f)||(h.destroy(),this.shapes.delete(f))})});k(this,"scaleRByWheel",t=>{var v;this.options.preventDefault&&t.preventDefault();const{clientX:r,clientY:i,deltaX:a,deltaY:o}=t,{graph:s,canvas:l}=this.context,c=s.getCanvasByClient([r,i]),u=(v=this.lens)==null?void 0:v.getCenter();if(!this.isLensOn||Oi(c,u)>this.r)return;const{maxR:h,minR:f}=this.options,d=a+o>0?1/(1-kx):1-kx,p=Math.min(...l.getSize())/2;this.r=Math.max(f||0,Math.min(h||p,this.r*d)),this.renderLens(u),this.renderFocusElements()});k(this,"isLensDragging",!1);k(this,"onDragStart",t=>{var a;const r=zr(t.canvas),i=(a=this.lens)==null?void 0:a.getCenter();!this.isLensOn||Oi(r,i)>this.r||(this.isLensDragging=!0)});k(this,"onDrag",t=>{if(!this.isLensDragging)return;const r=zr(t.canvas);this.renderLens(r),this.renderFocusElements()});k(this,"onDragEnd",()=>{this.isLensDragging=!1});this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(t,r){const i=t==="node"?this.options.nodeStyle:this.options.edgeStyle;return typeof i=="function"?i(r):i}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var o;const{graph:t}=this.context,{trigger:r,scaleRByWheel:i}=this.options,a=t.getCanvas().getLayer();["click","drag"].includes(r)&&a.addEventListener(ht.CLICK,this.onEdgeFilter),r==="pointermove"?a.addEventListener(ht.POINTER_MOVE,this.onEdgeFilter):r==="drag"&&(a.addEventListener(ht.DRAG_START,this.onDragStart),a.addEventListener(ht.DRAG,this.onDrag),a.addEventListener(ht.DRAG_END,this.onDragEnd)),i&&((o=this.graphDom)==null||o.addEventListener(ht.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var o;const{graph:t}=this.context,{trigger:r,scaleRByWheel:i}=this.options,a=t.getCanvas().getLayer();["click","drag"].includes(r)&&a.removeEventListener(ht.CLICK,this.onEdgeFilter),r==="pointermove"?a.removeEventListener(ht.POINTER_MOVE,this.onEdgeFilter):r==="drag"&&(a.removeEventListener(ht.DRAG_START,this.onDragStart),a.removeEventListener(ht.DRAG,this.onDrag),a.removeEventListener(ht.DRAG_END,this.onDragEnd)),i&&((o=this.graphDom)==null||o.removeEventListener(ht.WHEEL,this.scaleRByWheel))}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((t,r)=>{t.destroy(),this.shapes.delete(r)}),super.destroy()}};let Sh=om;k(Sh,"defaultOptions",{trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRByWheel:!0,preventDefault:!0});const sm=class extends _r{constructor(t,r){super(t,Object.assign({},sm.defaultOptions,r));k(this,"shortcut");k(this,"style");k(this,"$el",this.context.canvas.getContainer());k(this,"graphSize",[0,0]);k(this,"onFullscreenChange",()=>{var r,i,a,o;const t=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(t),t?(i=(r=this.options).onEnter)==null||i.call(r):(o=(a=this.options).onExit)==null||o.call(a)});this.shortcut=new ks(t.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML=`
      :not(:root):fullscreen::backdrop {
        background: transparent;
      }
    `}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();const{request:t=[],exit:r=[]}=this.options.trigger;this.shortcut.bind(t,this.request),this.shortcut.bind(r,this.exit),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(a=>{document.addEventListener(a,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(r=>{document.removeEventListener(r,this.onFullscreenChange,!1)})}setGraphSize(t=!0){let r,i;t?(r=window.screen.width,i=window.screen.height,this.graphSize=this.context.graph.getSize()):[r,i]=this.graphSize,this.context.graph.setSize(r,i),this.context.graph.render()}request(){document.fullscreenElement||!ZR()||this.$el.requestFullscreen().catch(t=>{Gr.warn(`Error attempting to enable full-screen: ${t.message} (${t.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}};let Th=sm;k(Th,"defaultOptions",{trigger:{},autoFit:!0});function ZR(){return document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled")}const lm=class extends _r{constructor(t,r){super(t,Object.assign({},lm.defaultOptions,r));k(this,"$element",ec("grid-line"));k(this,"offset",[0,0]);k(this,"onTransform",t=>{if(!this.options.follow)return;const{data:{translate:r}}=t;r&&this.updateOffset(r)});const i=this.context.canvas.getContainer();ER(i,this.$element),this.updateStyle(),this.bindEvents()}update(t){super.update(t),this.updateStyle()}bindEvents(){const{graph:t}=this.context;t.on(Tt.AFTER_TRANSFORM,this.onTransform)}updateStyle(){const{size:t,stroke:r,lineWidth:i,border:a,borderLineWidth:o,borderStroke:s,borderStyle:l}=this.options;Object.assign(this.$element.style,{border:a?`${o}px ${l} ${s}`:"none",backgroundImage:`linear-gradient(${r} ${i}px, transparent ${i}px), linear-gradient(90deg, ${r} ${i}px, transparent ${i}px)`,backgroundSize:`${t}px ${t}px`})}updateOffset(t){this.offset=sO(ge(this.offset,t),this.options.size),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}destroy(){this.context.graph.off(Tt.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}};let Ph=lm;k(Ph,"defaultOptions",{border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"});var sv=D(90494);function lv(n){const e={Added:new Map,Updated:new Map,Removed:new Map};return n.forEach(t=>{const{type:r,value:i}=t,a=it(i);if(r==="NodeAdded"||r==="EdgeAdded"||r==="ComboAdded")e.Added.set(a,t);else if(r==="NodeUpdated"||r==="EdgeUpdated"||r==="ComboUpdated")if(e.Added.has(a))e.Added.set(a,{type:r.replace("Updated","Added"),value:i});else if(e.Updated.has(a)){const{original:o}=e.Updated.get(a);e.Updated.set(a,{type:r,value:i,original:o})}else e.Removed.has(a)||e.Updated.set(a,t);else(r==="NodeRemoved"||r==="EdgeRemoved"||r==="ComboRemoved")&&(e.Added.has(a)?e.Added.delete(a):(e.Updated.has(a)&&e.Updated.delete(a),e.Removed.set(a,t)))}),[...Array.from(e.Added.values()),...Array.from(e.Updated.values()),...Array.from(e.Removed.values())]}function Lx(n){const{NodeAdded:e=[],NodeUpdated:t=[],NodeRemoved:r=[],EdgeAdded:i=[],EdgeUpdated:a=[],EdgeRemoved:o=[],ComboAdded:s=[],ComboUpdated:l=[],ComboRemoved:c=[]}=Dp(n,u=>u.type);return{add:{nodes:e,edges:i,combos:s},update:{nodes:t,edges:a,combos:l},remove:{nodes:r,edges:o,combos:c}}}function Ix(n,e){for(const t in n)dn(n[t])&&!Array.isArray(n[t])&&n[t]!==null?(e[t]||(e[t]={}),Ix(n[t],e[t])):e[t]===void 0&&(e[t]=Ou(t))}function qR(n,e=!1,t){const r={animation:e,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:i,update:a,remove:o}=Lx(lv(n));return["nodes","edges","combos"].forEach(s=>{a[s]&&a[s].forEach(l=>{var h,f;const c=at({},l.value);let u=at({},l.original);if(t){const d=t.graph.getElementType(it(l.original)),p=d==="edge"?"stroke":"fill",v=t.element.getElementComputedStyle(d,l.original);u=Se(at({},l.original),{style:at({[p]:v[p]},l.original.style)})}Ix(c,u),(h=r.current.update)[s]||(h[s]=[]),r.current.update[s].push(c),(f=r.original.update)[s]||(f[s]=[]),r.original.update[s].push(u)}),i[s]&&i[s].forEach(l=>{var u,h;const c=at({},l.value);(u=r.current.add)[s]||(u[s]=[]),r.current.add[s].push(c),(h=r.original.remove)[s]||(h[s]=[]),r.original.remove[s].push(c)}),o[s]&&o[s].forEach(l=>{var u,h;const c=at({},l.value);(u=r.current.remove)[s]||(u[s]=[]),r.current.remove[s].push(c),(h=r.original.add)[s]||(h[s]=[]),r.original.add[s].push(c)})}),r}const cm=class extends _r{constructor(t,r){super(t,Object.assign({},cm.defaultOptions,r));k(this,"emitter");k(this,"batchChanges",null);k(this,"batchAnimation",!1);k(this,"undoStack",[]);k(this,"redoStack",[]);k(this,"freezed",!1);k(this,"executeCommand",(t,r=!0)=>{var a,o,s;this.freezed=!0,(o=(a=this.options).executeCommand)==null||o.call(a,t);const i=r?t.original:t.current;this.context.graph.addData(i.add),this.context.graph.updateData(i.update),this.context.graph.removeData(_1(i.remove,!1)),(s=this.context.element)==null||s.draw({silence:!0,animation:t.animation}),this.freezed=!1});k(this,"addCommand",t=>{var r;if(!this.freezed){if(t.type===Tt.AFTER_DRAW){const{dataChanges:i=[],animation:a=!0}=t.data;if((r=this.context.batch)!=null&&r.isBatching){if(!this.batchChanges)return;this.batchChanges.push(i),this.batchAnimation&&(this.batchAnimation=a);return}this.batchChanges=[i],this.batchAnimation=a}this.undoStackPush(qR(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(ja.ADD,this.undoStack[this.undoStack.length-1])}});k(this,"initBatchCommand",t=>{const{initiate:r}=t.data;this.batchAnimation=!1,r?this.batchChanges=[]:this.undoStack.pop()||(this.batchChanges=null)});this.emitter=new sv.Z;const{graph:i}=this.context;i.on(Tt.AFTER_DRAW,this.addCommand),i.on(Tt.BATCH_START,this.initBatchCommand),i.on(Tt.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var r,i,a,o;const t=this.undoStack.pop();if(t){if(this.executeCommand(t),((i=(r=this.options).beforeAddCommand)==null?void 0:i.call(r,t,!1))===!1)return;this.redoStack.push(t),(o=(a=this.options).afterAddCommand)==null||o.call(a,t,!1),this.notify(ja.UNDO,t)}return this}redo(){const t=this.redoStack.pop();return t&&(this.executeCommand(t,!1),this.undoStackPush(t),this.notify(ja.REDO,t)),this}undoAndCancel(){const t=this.undoStack.pop();return t&&(this.executeCommand(t,!1),this.redoStack=[],this.notify(ja.CANCEL,t)),this}undoStackPush(t){var a,o,s,l;const{stackSize:r}=this.options;r!==0&&this.undoStack.length>=r&&this.undoStack.shift(),((o=(a=this.options).beforeAddCommand)==null?void 0:o.call(a,t,!0))!==!1&&(this.undoStack.push(t),(l=(s=this.options).afterAddCommand)==null||l.call(s,t,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(ja.CLEAR,null)}notify(t,r){this.emitter.emit(t,{cmd:r}),this.emitter.emit(ja.CHANGE,{cmd:r})}on(t,r){this.emitter.on(t,r)}destroy(){const{graph:t}=this.context;t.off(Tt.AFTER_DRAW,this.addCommand),t.off(Tt.BATCH_START,this.initBatchCommand),t.off(Tt.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}};let Mh=cm;k(Mh,"defaultOptions",{stackSize:0});var JR=D(1344),QR=D.n(JR);function tk(n,e,t){if(n.length===1)return ek(n[0],e,t);if(n.length===2)return nk(n,e,t);switch(t){case"smooth":return ik(n,e);case"sharp":return ak(n,e);case"rounded":default:return rk(n,e)}}const ek=(n,e,t)=>{if(t==="sharp")return[["M",n[0]-e,n[1]-e],["L",n[0]+e,n[1]-e],["L",n[0]+e,n[1]+e],["L",n[0]-e,n[1]+e],["Z"]];const r=[e,e,0,0,0];return[["M",n[0],n[1]-e],["A",...r,n[0],n[1]+e],["A",...r,n[0],n[1]-e]]},nk=(n,e,t)=>{const r=[e,e,0,0,0],i=t==="sharp"?ge(n[0],qa(Pa(In(n[0],n[1])),e)):n[0],a=t==="sharp"?ge(n[1],qa(Pa(In(n[1],n[0])),e)):n[1],o=qa(Pa(Iu(In(i,a),!1)),e),s=qa(o,-1),l=ge(i,o),c=ge(a,o),u=ge(a,s),h=ge(i,s);return t==="sharp"?[["M",l[0],l[1]],["L",c[0],c[1]],["L",u[0],u[1]],["L",h[0],h[1]],["Z"]]:[["M",l[0],l[1]],["L",c[0],c[1]],["A",...r,u[0],u[1]],["L",h[0],h[1]],["A",...r,l[0],l[1]]]},rk=(n,e)=>{const t=I1(n).map((s,l)=>{const c=(l-2+n.length)%n.length,u=(l-1+n.length)%n.length,h=(l+1)%n.length,f=n[c],d=n[u],p=n[h],v=In(f,d),g=In(d,s),m=In(s,p),x=(E,w)=>Op(E,w,!0)<Math.PI,_=x(v,g),S=x(g,m),b=E=>qa(Pa(Iu(E,!1)),e),y=b(g);return[{p:zl(_?ge(d,b(v)):ge(d,y)),concave:_&&d},{p:zl(S?ge(s,b(m)):ge(s,y)),concave:S&&s}]}),r=[e,e,0,0,0],i=t.findIndex((s,l)=>!t[(l-1+t.length)%t.length][0].concave&&!t[(l-1+t.length)%t.length][1].concave&&!s[0].concave&&!s[0].concave&&!s[1].concave),a=t.slice(i).concat(t.slice(0,i));let o=[];return a.flatMap((s,l)=>{const c=[],u=a[t.length-1];return l===0&&c.push(["M",...u[1].p]),s[0].concave?o.push(s[0].p,s[1].p):c.push(["A",...r,...s[0].p]),s[1].concave?o.unshift(s[1].p):c.push(["L",...s[1].p]),o.length===3&&(c.pop(),c.push(["C",...o.flat()]),o=[]),c})},ik=(n,e)=>{const t=I1(n).map((r,i)=>{const a=n[(i+1)%n.length];return{p:r,v:Pa(In(a,r))}});return t.forEach((r,i)=>{const a=i>0?i-1:n.length-1,o=t[a].v,s=Pa(ge(o,qa(r.v,Op(o,r.v,!0)<Math.PI?1:-1)));r.p=ge(r.p,qa(s,e))}),q1(t.map(r=>r.p))},ak=(n,e)=>{const r=n.map((a,o)=>{const s=n[o===0?n.length-1:o-1],l=Wl(qa(Pa(Iu(In(s,a),!1)),e));return[ge(s,l),ge(a,l)]}).flat();return r.map((a,o)=>{if(o%2===0)return null;const s=[r[(o-1)%r.length],r[o%r.length]],l=[r[(o+1)%r.length],r[(o+2)%r.length]];return Np(s,l,!0)}).filter(Boolean).map((a,o)=>[o===0?"M":"L",a[0],a[1]]).concat([["Z"]])},um=class extends _r{constructor(t,r){super(t,Object.assign({},um.defaultOptions,r));k(this,"shape");k(this,"hullMemberIds",[]);k(this,"path");k(this,"optionsCache");k(this,"drawHull",()=>{if(!this.shape)this.shape=new Kl({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);else{const t=!vn(this.optionsCache,this.options);this.shape.update(this.getHullStyle(t))}this.optionsCache=at({},this.options)});k(this,"updateHullPath",t=>{this.shape&&this.options.members.includes(it(t.data))&&this.shape.update({d:this.getHullPath(!0)})});k(this,"getHullPath",(t=!1)=>{const{graph:r}=this.context,i=this.getMember();if(i.length===0)return"";const a=i.map(l=>r.getNodeData(l)),o=QR()(a.map(Hi),this.options.concavity).slice(1).reverse(),s=o.flatMap(l=>a.filter(c=>vn(Hi(c),l)).map(it));return vn(s,this.hullMemberIds)&&!t?this.path:(this.hullMemberIds=s,this.path=tk(o,this.getPadding(),this.options.corner),this.path)});this.bindEvents()}bindEvents(){this.context.graph.on(Tt.AFTER_RENDER,this.drawHull),this.context.graph.on(Tt.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(t){const s=this.options,{members:r,padding:i,corner:a}=s,o=Ce(s,["members","padding","corner"]);return Se(at({},o),{d:this.getHullPath(t)})}getPadding(){const{graph:t}=this.context;return this.hullMemberIds.reduce((i,a)=>{const{halfExtents:o}=t.getElementRenderBounds(a),s=Math.max(o[0],o[1]);return Math.max(i,s)},0)+this.options.padding}addMember(t){const r=Array.isArray(t)?t:[t];this.options.members=[...new Set([...this.options.members,...r])],this.shape.update({d:this.getHullPath()})}removeMember(t){const r=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(i=>!r.includes(i)),r.some(i=>this.hullMemberIds.includes(i))&&this.shape.update({d:this.getHullPath()})}updateMember(t){this.options.members=jt(t)?t(this.options.members):t,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.context.graph.off(Tt.AFTER_DRAW,this.drawHull),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}};let Ch=um;k(Ch,"defaultOptions",{members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2});var ok=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:typeof self!="undefined"?self:{},Dx={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(ok,function(){function t(b,y,E,w,M){r(b,y,E||0,w||b.length-1,M||a)}function r(b,y,E,w,M){for(;w>E;){if(w-E>600){var P=w-E+1,A=y-E+1,O=Math.log(P),R=.5*Math.exp(2*O/3),L=.5*Math.sqrt(O*R*(P-R)/P)*(A-P/2<0?-1:1),z=Math.max(E,Math.floor(y-A*R/P+L)),Y=Math.min(w,Math.floor(y+(P-A)*R/P+L));r(b,y,z,Y,M)}var I=b[y],Z=E,J=w;for(i(b,E,y),M(b[w],I)>0&&i(b,E,w);Z<J;){for(i(b,Z,J),Z++,J--;M(b[Z],I)<0;)Z++;for(;M(b[J],I)>0;)J--}M(b[E],I)===0?i(b,E,J):(J++,i(b,J,w)),J<=y&&(E=J+1),y<=J&&(w=J-1)}}function i(b,y,E){var w=b[y];b[y]=b[E],b[E]=w}function a(b,y){return b<y?-1:b>y?1:0}var o=function(y){y===void 0&&(y=9),this._maxEntries=Math.max(4,y),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(y){var E=this.data,w=[];if(!x(y,E))return w;for(var M=this.toBBox,P=[];E;){for(var A=0;A<E.children.length;A++){var O=E.children[A],R=E.leaf?M(O):O;x(y,R)&&(E.leaf?w.push(O):m(y,R)?this._all(O,w):P.push(O))}E=P.pop()}return w},o.prototype.collides=function(y){var E=this.data;if(!x(y,E))return!1;for(var w=[];E;){for(var M=0;M<E.children.length;M++){var P=E.children[M],A=E.leaf?this.toBBox(P):P;if(x(y,A)){if(E.leaf||m(y,A))return!0;w.push(P)}}E=w.pop()}return!1},o.prototype.load=function(y){if(!(y&&y.length))return this;if(y.length<this._minEntries){for(var E=0;E<y.length;E++)this.insert(y[E]);return this}var w=this._build(y.slice(),0,y.length-1,0);if(!this.data.children.length)this.data=w;else if(this.data.height===w.height)this._splitRoot(this.data,w);else{if(this.data.height<w.height){var M=this.data;this.data=w,w=M}this._insert(w,this.data.height-w.height-1,!0)}return this},o.prototype.insert=function(y){return y&&this._insert(y,this.data.height-1),this},o.prototype.clear=function(){return this.data=_([]),this},o.prototype.remove=function(y,E){if(!y)return this;for(var w=this.data,M=this.toBBox(y),P=[],A=[],O,R,L;w||P.length;){if(w||(w=P.pop(),R=P[P.length-1],O=A.pop(),L=!0),w.leaf){var z=s(y,w.children,E);if(z!==-1)return w.children.splice(z,1),P.push(w),this._condense(P),this}!L&&!w.leaf&&m(w,M)?(P.push(w),A.push(O),O=0,R=w,w=w.children[0]):R?(O++,w=R.children[O],L=!1):w=null}return this},o.prototype.toBBox=function(y){return y},o.prototype.compareMinX=function(y,E){return y.minX-E.minX},o.prototype.compareMinY=function(y,E){return y.minY-E.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(y){return this.data=y,this},o.prototype._all=function(y,E){for(var w=[];y;)y.leaf?E.push.apply(E,y.children):w.push.apply(w,y.children),y=w.pop();return E},o.prototype._build=function(y,E,w,M){var P=w-E+1,A=this._maxEntries,O;if(P<=A)return O=_(y.slice(E,w+1)),l(O,this.toBBox),O;M||(M=Math.ceil(Math.log(P)/Math.log(A)),A=Math.ceil(P/Math.pow(A,M-1))),O=_([]),O.leaf=!1,O.height=M;var R=Math.ceil(P/A),L=R*Math.ceil(Math.sqrt(A));S(y,E,w,L,this.compareMinX);for(var z=E;z<=w;z+=L){var Y=Math.min(z+L-1,w);S(y,z,Y,R,this.compareMinY);for(var I=z;I<=Y;I+=R){var Z=Math.min(I+R-1,Y);O.children.push(this._build(y,I,Z,M-1))}}return l(O,this.toBBox),O},o.prototype._chooseSubtree=function(y,E,w,M){for(;M.push(E),!(E.leaf||M.length-1===w);){for(var P=1/0,A=1/0,O=void 0,R=0;R<E.children.length;R++){var L=E.children[R],z=d(L),Y=v(y,L)-z;Y<A?(A=Y,P=z<P?z:P,O=L):Y===A&&z<P&&(P=z,O=L)}E=O||E.children[0]}return E},o.prototype._insert=function(y,E,w){var M=w?y:this.toBBox(y),P=[],A=this._chooseSubtree(M,this.data,E,P);for(A.children.push(y),u(A,M);E>=0&&P[E].children.length>this._maxEntries;)this._split(P,E),E--;this._adjustParentBBoxes(M,P,E)},o.prototype._split=function(y,E){var w=y[E],M=w.children.length,P=this._minEntries;this._chooseSplitAxis(w,P,M);var A=this._chooseSplitIndex(w,P,M),O=_(w.children.splice(A,w.children.length-A));O.height=w.height,O.leaf=w.leaf,l(w,this.toBBox),l(O,this.toBBox),E?y[E-1].children.push(O):this._splitRoot(w,O)},o.prototype._splitRoot=function(y,E){this.data=_([y,E]),this.data.height=y.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(y,E,w){for(var M,P=1/0,A=1/0,O=E;O<=w-E;O++){var R=c(y,0,O,this.toBBox),L=c(y,O,w,this.toBBox),z=g(R,L),Y=d(R)+d(L);z<P?(P=z,M=O,A=Y<A?Y:A):z===P&&Y<A&&(A=Y,M=O)}return M||w-E},o.prototype._chooseSplitAxis=function(y,E,w){var M=y.leaf?this.compareMinX:h,P=y.leaf?this.compareMinY:f,A=this._allDistMargin(y,E,w,M),O=this._allDistMargin(y,E,w,P);A<O&&y.children.sort(M)},o.prototype._allDistMargin=function(y,E,w,M){y.children.sort(M);for(var P=this.toBBox,A=c(y,0,E,P),O=c(y,w-E,w,P),R=p(A)+p(O),L=E;L<w-E;L++){var z=y.children[L];u(A,y.leaf?P(z):z),R+=p(A)}for(var Y=w-E-1;Y>=E;Y--){var I=y.children[Y];u(O,y.leaf?P(I):I),R+=p(O)}return R},o.prototype._adjustParentBBoxes=function(y,E,w){for(var M=w;M>=0;M--)u(E[M],y)},o.prototype._condense=function(y){for(var E=y.length-1,w=void 0;E>=0;E--)y[E].children.length===0?E>0?(w=y[E-1].children,w.splice(w.indexOf(y[E]),1)):this.clear():l(y[E],this.toBBox)};function s(b,y,E){if(!E)return y.indexOf(b);for(var w=0;w<y.length;w++)if(E(b,y[w]))return w;return-1}function l(b,y){c(b,0,b.children.length,y,b)}function c(b,y,E,w,M){M||(M=_(null)),M.minX=1/0,M.minY=1/0,M.maxX=-1/0,M.maxY=-1/0;for(var P=y;P<E;P++){var A=b.children[P];u(M,b.leaf?w(A):A)}return M}function u(b,y){return b.minX=Math.min(b.minX,y.minX),b.minY=Math.min(b.minY,y.minY),b.maxX=Math.max(b.maxX,y.maxX),b.maxY=Math.max(b.maxY,y.maxY),b}function h(b,y){return b.minX-y.minX}function f(b,y){return b.minY-y.minY}function d(b){return(b.maxX-b.minX)*(b.maxY-b.minY)}function p(b){return b.maxX-b.minX+(b.maxY-b.minY)}function v(b,y){return(Math.max(y.maxX,b.maxX)-Math.min(y.minX,b.minX))*(Math.max(y.maxY,b.maxY)-Math.min(y.minY,b.minY))}function g(b,y){var E=Math.max(b.minX,y.minX),w=Math.max(b.minY,y.minY),M=Math.min(b.maxX,y.maxX),P=Math.min(b.maxY,y.maxY);return Math.max(0,M-E)*Math.max(0,P-w)}function m(b,y){return b.minX<=y.minX&&b.minY<=y.minY&&y.maxX<=b.maxX&&y.maxY<=b.maxY}function x(b,y){return y.minX<=b.maxX&&y.minY<=b.maxY&&y.maxX>=b.minX&&y.maxY>=b.minY}function _(b){return{children:b,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function S(b,y,E,w,M){for(var P=[y,E];P.length;)if(E=P.pop(),y=P.pop(),!(E-y<=w)){var A=y+Math.ceil((E-y)/w/2)*w;t(b,A,y,E,M),P.push(y,A,A,E)}}return o})})(Dx);var sk=Dx.exports,Rt;(function(n){n.GROUP="g",n.CIRCLE="circle",n.ELLIPSE="ellipse",n.IMAGE="image",n.RECT="rect",n.LINE="line",n.POLYLINE="polyline",n.POLYGON="polygon",n.TEXT="text",n.PATH="path",n.HTML="html",n.MESH="mesh"})(Rt||(Rt={}));var Us;(function(n){n[n.ZERO=0]="ZERO",n[n.NEGATIVE_ONE=1]="NEGATIVE_ONE"})(Us||(Us={}));var TU=function(){function n(){this.plugins=[]}return n.prototype.addRenderingPlugin=function(e){this.plugins.push(e),this.context.renderingPlugins.push(e)},n.prototype.removeAllRenderingPlugins=function(){var e=this;this.plugins.forEach(function(t){var r=e.context.renderingPlugins.indexOf(t);r>=0&&e.context.renderingPlugins.splice(r,1)})},n}(),PU=function(){function n(e){this.clipSpaceNearZ=Us.NEGATIVE_ONE,this.plugins=[],this.config=N({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0},e)}return n.prototype.registerPlugin=function(e){var t=this.plugins.findIndex(function(r){return r===e});t===-1&&this.plugins.push(e)},n.prototype.unregisterPlugin=function(e){var t=this.plugins.findIndex(function(r){return r===e});t>-1&&this.plugins.splice(t,1)},n.prototype.getPlugins=function(){return this.plugins},n.prototype.getPlugin=function(e){return this.plugins.find(function(t){return t.name===e})},n.prototype.getConfig=function(){return this.config},n.prototype.setConfig=function(e){Object.assign(this.config,e)},n}();function Vs(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function cv(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function Ah(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function Bx(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function lk(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n}function ck(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n}function Hs(n){return n===void 0?0:n>360||n<-360?n%360:n}function Sr(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=0),Array.isArray(n)&&n.length===3?T.d9(n):fe(n)?T.al(n,e,t):T.al(n[0],n[1]||e,n[2]||t)}function ke(n){return n*(Math.PI/180)}function Ni(n){return n*(180/Math.PI)}function MU(n){return n=n%400,n<0&&(n+=400),n/400*360}function CU(n){return n/360}function uk(n){return 360*n}function hk(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=t*t,s=r*r,l=i*i,c=a*a,u=o+s+l+c,h=t*a-r*i;return h>.499995*u?(n[0]=Math.PI/2,n[1]=2*Math.atan2(r,t),n[2]=0):h<-.499995*u?(n[0]=-Math.PI/2,n[1]=2*Math.atan2(r,t),n[2]=0):(n[0]=Math.asin(2*(t*i-a*r)),n[1]=Math.atan2(2*(t*a+r*i),1-2*(l+c)),n[2]=Math.atan2(2*(t*r+i*a),1-2*(s+l))),n}function fk(n,e){var t,r,i=Math.PI*.5,a=C(Ye(T.Ue(),e),3),o=a[0],s=a[1],l=a[2],c=Math.asin(-e[2]/o);return c<i?c>-i?(t=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,t=-Math.atan2(e[4]/s,e[5]/s)):(r=0,t=Math.atan2(e[4]/s,e[5]/s)),n[0]=t,n[1]=c,n[2]=r,n}function uv(n,e){return e.length===16?fk(n,e):hk(n,e)}function dk(n,e,t,r,i){var a=Math.cos(n),o=Math.sin(n);return Qi.al(r*a,i*o,0,-r*o,i*a,0,e,t,1)}function pk(n,e,t,r,i,a,o,s){s===void 0&&(s=!1);var l=2*a/(t-e),c=2*a/(r-i),u=(t+e)/(t-e),h=(r+i)/(r-i),f,d;return s?(f=-o/(o-a),d=-o*a/(o-a)):(f=-(o+a)/(o-a),d=-2*o*a/(o-a)),n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=u,n[9]=h,n[10]=f,n[11]=-1,n[12]=0,n[13]=0,n[14]=d,n[15]=0,n}function Fx(n){var e=n[0],t=n[1],r=n[3],i=n[4],a=Math.sqrt(e*e+t*t),o=Math.sqrt(r*r+i*i),s=e*i-t*r;s<0&&(e<i?a=-a:o=-o),a&&(e*=1/a,t*=1/a),o&&(r*=1/o,i*=1/o);var l=Math.atan2(t,e),c=Ni(l);return[n[6],n[7],a,o,c]}var sa=Q(),Xi=Q(),ic=on(),Kt=[T.Ue(),T.Ue(),T.Ue()],Gx=T.Ue();function vk(n,e,t,r,i,a){if(!gk(sa,n)||(kt(Xi,sa),Xi[3]=0,Xi[7]=0,Xi[11]=0,Xi[15]=1,Math.abs(Pe(Xi))<1e-8))return!1;var o=sa[3],s=sa[7],l=sa[11],c=sa[12],u=sa[13],h=sa[14],f=sa[15];if(o!==0||s!==0||l!==0){ic[0]=o,ic[1]=s,ic[2]=l,ic[3]=f;var d=Wt(Xi,Xi);if(!d)return!1;Te(Xi,Xi),fn(i,ic,Xi)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=c,e[1]=u,e[2]=h,mk(Kt,sa),t[0]=T.kE(Kt[0]),T.Fv(Kt[0],Kt[0]),r[0]=T.AK(Kt[0],Kt[1]),hv(Kt[1],Kt[1],Kt[0],1,-r[0]),t[1]=T.kE(Kt[1]),T.Fv(Kt[1],Kt[1]),r[0]/=t[1],r[1]=T.AK(Kt[0],Kt[2]),hv(Kt[2],Kt[2],Kt[0],1,-r[1]),r[2]=T.AK(Kt[1],Kt[2]),hv(Kt[2],Kt[2],Kt[1],1,-r[2]),t[2]=T.kE(Kt[2]),T.Fv(Kt[2],Kt[2]),r[1]/=t[2],r[2]/=t[2],T.kC(Gx,Kt[1],Kt[2]),T.AK(Kt[0],Gx)<0)for(var p=0;p<3;p++)t[p]*=-1,Kt[p][0]*=-1,Kt[p][1]*=-1,Kt[p][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+Kt[0][0]-Kt[1][1]-Kt[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-Kt[0][0]+Kt[1][1]-Kt[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-Kt[0][0]-Kt[1][1]+Kt[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+Kt[0][0]+Kt[1][1]+Kt[2][2],0)),Kt[2][1]>Kt[1][2]&&(a[0]=-a[0]),Kt[0][2]>Kt[2][0]&&(a[1]=-a[1]),Kt[1][0]>Kt[0][1]&&(a[2]=-a[2]),!0}function gk(n,e){var t=e[15];if(t===0)return!1;for(var r=1/t,i=0;i<16;i++)n[i]=e[i]*r;return!0}function mk(n,e){n[0][0]=e[0],n[0][1]=e[1],n[0][2]=e[2],n[1][0]=e[4],n[1][1]=e[5],n[1][2]=e[6],n[2][0]=e[8],n[2][1]=e[9],n[2][2]=e[10]}function hv(n,e,t,r,i){n[0]=e[0]*r+t[0]*i,n[1]=e[1]*r+t[1]*i,n[2]=e[2]*r+t[2]*i}var lr=function(){function n(){this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return n.isEmpty=function(e){return!e||e.halfExtents[0]===0&&e.halfExtents[1]===0&&e.halfExtents[2]===0},n.prototype.update=function(e,t){Vs(this.center,e),Vs(this.halfExtents,t),cv(this.min,this.center,this.halfExtents),Ah(this.max,this.center,this.halfExtents)},n.prototype.setMinMax=function(e,t){Ah(this.center,t,e),Bx(this.center,this.center,.5),cv(this.halfExtents,t,e),Bx(this.halfExtents,this.halfExtents,.5),Vs(this.min,e),Vs(this.max,t)},n.prototype.getMin=function(){return this.min},n.prototype.getMax=function(){return this.max},n.prototype.add=function(e){if(!n.isEmpty(e)){if(n.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return}var t=this.center,r=t[0],i=t[1],a=t[2],o=this.halfExtents,s=o[0],l=o[1],c=o[2],u=r-s,h=r+s,f=i-l,d=i+l,p=a-c,v=a+c,g=e.center,m=g[0],x=g[1],_=g[2],S=e.halfExtents,b=S[0],y=S[1],E=S[2],w=m-b,M=m+b,P=x-y,A=x+y,O=_-E,R=_+E;w<u&&(u=w),M>h&&(h=M),P<f&&(f=P),A>d&&(d=A),O<p&&(p=O),R>v&&(v=R),t[0]=(u+h)*.5,t[1]=(f+d)*.5,t[2]=(p+v)*.5,o[0]=(h-u)*.5,o[1]=(d-f)*.5,o[2]=(v-p)*.5,this.min[0]=u,this.min[1]=f,this.min[2]=p,this.max[0]=h,this.max[1]=d,this.max[2]=v}},n.prototype.setFromTransformedAABB=function(e,t){var r=this.center,i=this.halfExtents,a=e.center,o=e.halfExtents,s=t[0],l=t[4],c=t[8],u=t[1],h=t[5],f=t[9],d=t[2],p=t[6],v=t[10],g=Math.abs(s),m=Math.abs(l),x=Math.abs(c),_=Math.abs(u),S=Math.abs(h),b=Math.abs(f),y=Math.abs(d),E=Math.abs(p),w=Math.abs(v);r[0]=t[12]+s*a[0]+l*a[1]+c*a[2],r[1]=t[13]+u*a[0]+h*a[1]+f*a[2],r[2]=t[14]+d*a[0]+p*a[1]+v*a[2],i[0]=g*o[0]+m*o[1]+x*o[2],i[1]=_*o[0]+S*o[1]+b*o[2],i[2]=y*o[0]+E*o[1]+w*o[2],cv(this.min,r,i),Ah(this.max,r,i)},n.prototype.intersects=function(e){var t=this.getMax(),r=this.getMin(),i=e.getMax(),a=e.getMin();return r[0]<=i[0]&&t[0]>=a[0]&&r[1]<=i[1]&&t[1]>=a[1]&&r[2]<=i[2]&&t[2]>=a[2]},n.prototype.intersection=function(e){if(!this.intersects(e))return null;var t=new n,r=lk([0,0,0],this.getMin(),e.getMin()),i=ck([0,0,0],this.getMax(),e.getMax());return t.setMinMax(r,i),t},n.prototype.getNegativeFarPoint=function(e){return e.pnVertexFlag===273?Vs([0,0,0],this.min):e.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:e.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]},n.prototype.getPositiveFarPoint=function(e){return e.pnVertexFlag===273?Vs([0,0,0],this.max):e.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:e.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]},n}(),yk=function(){function n(e,t){this.distance=e||0,this.normal=t||T.al(0,1,0),this.updatePNVertexFlag()}return n.prototype.updatePNVertexFlag=function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)},n.prototype.distanceToPoint=function(e){return T.AK(e,this.normal)-this.distance},n.prototype.normalize=function(){var e=1/T.Zh(this.normal);T.bA(this.normal,this.normal,e),this.distance*=e},n.prototype.intersectsLine=function(e,t,r){var i=this.distanceToPoint(e),a=this.distanceToPoint(t),o=i/(i-a),s=o>=0&&o<=1;return s&&r&&T.t7(r,e,t,o),s},n}(),ro;(function(n){n[n.OUTSIDE=4294967295]="OUTSIDE",n[n.INSIDE=0]="INSIDE",n[n.INDETERMINATE=2147483647]="INDETERMINATE"})(ro||(ro={}));var xk=function(){function n(e){if(this.planes=[],e)this.planes=e;else for(var t=0;t<6;t++)this.planes.push(new yk)}return n.prototype.extractFromVPMatrix=function(e){var t=C(e,16),r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],f=t[9],d=t[10],p=t[11],v=t[12],g=t[13],m=t[14],x=t[15];T.t8(this.planes[0].normal,o-r,u-s,p-h),this.planes[0].distance=x-v,T.t8(this.planes[1].normal,o+r,u+s,p+h),this.planes[1].distance=x+v,T.t8(this.planes[2].normal,o+i,u+l,p+f),this.planes[2].distance=x+g,T.t8(this.planes[3].normal,o-i,u-l,p-f),this.planes[3].distance=x-g,T.t8(this.planes[4].normal,o-a,u-c,p-d),this.planes[4].distance=x-m,T.t8(this.planes[5].normal,o+a,u+c,p+d),this.planes[5].distance=x+m,this.planes.forEach(function(_){_.normalize(),_.updatePNVertexFlag()})},n}(),cr=function(){function n(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.copyFrom=function(e){this.x=e.x,this.y=e.y},n}(),Ho=function(){function n(e,t,r,i){this.x=e,this.y=t,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=t,this.bottom=t+i}return n.prototype.toJSON=function(){},n}(),Le="Method not implemented.",Ys="Use document.documentElement instead.",bk="Cannot append a destroyed element.",_e;(function(n){n[n.ORBITING=0]="ORBITING",n[n.EXPLORING=1]="EXPLORING",n[n.TRACKING=2]="TRACKING"})(_e||(_e={}));var ac;(function(n){n[n.DEFAULT=0]="DEFAULT",n[n.ROTATIONAL=1]="ROTATIONAL",n[n.TRANSLATIONAL=2]="TRANSLATIONAL",n[n.CINEMATIC=3]="CINEMATIC"})(ac||(ac={}));var Ur;(function(n){n[n.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",n[n.PERSPECTIVE=1]="PERSPECTIVE"})(Ur||(Ur={}));var zx={UPDATED:"updated"},Wx=2e-4,Ux=function(){function n(){this.clipSpaceNearZ=Us.NEGATIVE_ONE,this.eventEmitter=new et,this.matrix=Q(),this.right=T.al(1,0,0),this.up=T.al(0,1,0),this.forward=T.al(0,0,1),this.position=T.al(0,0,1),this.focalPoint=T.al(0,0,0),this.distanceVector=T.al(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=Q(),this.projectionMatrixInverse=Q(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=_e.EXPLORING,this.trackingMode=ac.DEFAULT,this.projectionMode=Ur.PERSPECTIVE,this.frustum=new xk,this.orthoMatrix=Q()}return n.prototype.isOrtho=function(){return this.projectionMode===Ur.ORTHOGRAPHIC},n.prototype.getProjectionMode=function(){return this.projectionMode},n.prototype.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},n.prototype.getPerspectiveInverse=function(){return this.projectionMatrixInverse},n.prototype.getFrustum=function(){return this.frustum},n.prototype.getPosition=function(){return this.position},n.prototype.getFocalPoint=function(){return this.focalPoint},n.prototype.getDollyingStep=function(){return this.dollyingStep},n.prototype.getNear=function(){return this.near},n.prototype.getFar=function(){return this.far},n.prototype.getZoom=function(){return this.zoom},n.prototype.getOrthoMatrix=function(){return this.orthoMatrix},n.prototype.getView=function(){return this.view},n.prototype.setEnableUpdate=function(e){this.enableUpdate=e},n.prototype.setType=function(e,t){return this.type=e,this.type===_e.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===_e.TRACKING&&t!==void 0&&this.setTrackingMode(t),this},n.prototype.setProjectionMode=function(e){return this.projectionMode=e,this},n.prototype.setTrackingMode=function(e){if(this.type!==_e.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this},n.prototype.setWorldRotation=function(e){return this.rotateWorld=e,this._getAngles(),this},n.prototype.getViewTransform=function(){return Wt(Q(),this.matrix)},n.prototype.getWorldTransform=function(){return this.matrix},n.prototype.jitterProjectionMatrix=function(e,t){var r=ce(Q(),[e,t,0]);this.jitteredProjectionMatrix=Ut(Q(),r,this.projectionMatrix)},n.prototype.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},n.prototype.setMatrix=function(e){return this.matrix=e,this._update(),this},n.prototype.setProjectionMatrix=function(e){this.projectionMatrix=e},n.prototype.setFov=function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this},n.prototype.setAspect=function(e){return this.setPerspective(this.near,this.far,this.fov,e),this},n.prototype.setNear=function(e){return this.projectionMode===Ur.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this},n.prototype.setFar=function(e){return this.projectionMode===Ur.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this},n.prototype.setViewOffset=function(e,t,r,i,a,o){return this.aspect=e/t,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.projectionMode===Ur.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},n.prototype.clearViewOffset=function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Ur.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},n.prototype.setZoom=function(e){return this.zoom=e,this.projectionMode===Ur.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Ur.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},n.prototype.setZoomByViewportPoint=function(e,t){var r=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),i=r.x,a=r.y,o=this.roll;this.rotate(0,0,-o),this.setPosition(i,a),this.setFocalPoint(i,a),this.setZoom(e),this.rotate(0,0,o);var s=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),l=s.x,c=s.y,u=T.al(l-i,c-a,0),h=T.AK(u,this.right)/T.kE(this.right),f=T.AK(u,this.up)/T.kE(this.up),d=C(this.getPosition(),2),p=d[0],v=d[1],g=C(this.getFocalPoint(),2),m=g[0],x=g[1];return this.setPosition(p-h,v-f),this.setFocalPoint(m-h,x-f),this},n.prototype.setPerspective=function(e,t,r,i){var a;this.projectionMode=Ur.PERSPECTIVE,this.fov=r,this.near=e,this.far=t,this.aspect=i;var o=this.near*Math.tan(ke(.5*this.fov))/this.zoom,s=2*o,l=this.aspect*s,c=-.5*l;if(!((a=this.view)===null||a===void 0)&&a.enabled){var u=this.view.fullWidth,h=this.view.fullHeight;c+=this.view.offsetX*l/u,o-=this.view.offsetY*s/h,l*=this.view.width/u,s*=this.view.height/h}return pk(this.projectionMatrix,c,c+l,o-s,o,e,this.far,this.clipSpaceNearZ===Us.ZERO),Wt(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},n.prototype.setOrthographic=function(e,t,r,i,a,o){var s;this.projectionMode=Ur.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=r,this.bottom=i,this.near=a,this.far=o;var l=(this.rright-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,f=u-l,d=u+l,p=h+c,v=h-c;if(!((s=this.view)===null||s===void 0)&&s.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;f+=g*this.view.offsetX,d=f+g*this.view.width,p-=m*this.view.offsetY,v=p-m*this.view.height}return this.clipSpaceNearZ===Us.NEGATIVE_ONE?Uc(this.projectionMatrix,f,d,p,v,a,o):Vc(this.projectionMatrix,f,d,p,v,a,o),Wt(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},n.prototype.setPosition=function(e,t,r){t===void 0&&(t=this.position[1]),r===void 0&&(r=this.position[2]);var i=Sr(e,t,r);return this._setPosition(i),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},n.prototype.setFocalPoint=function(e,t,r){t===void 0&&(t=this.focalPoint[1]),r===void 0&&(r=this.focalPoint[2]);var i=T.al(0,1,0);if(this.focalPoint=Sr(e,t,r),this.trackingMode===ac.CINEMATIC){var a=T.$X(T.Ue(),this.focalPoint,this.position);e=a[0],t=a[1],r=a[2];var o=T.kE(a),s=Ni(Math.asin(t/o)),l=90+Ni(Math.atan2(r,e)),c=Q();vr(c,c,ke(l)),Ar(c,c,ke(s)),i=T.fF(T.Ue(),[0,1,0],c)}return Wt(this.matrix,Hc(Q(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},n.prototype.getDistance=function(){return this.distance},n.prototype.getDistanceVector=function(){return this.distanceVector},n.prototype.setDistance=function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<Wx&&(this.distance=Wx),this.dollyingStep=this.distance/100;var t=T.Ue();e=this.distance;var r=this.forward,i=this.focalPoint;return t[0]=e*r[0]+i[0],t[1]=e*r[1]+i[1],t[2]=e*r[2]+i[2],this._setPosition(t),this.triggerUpdate(),this},n.prototype.setMaxDistance=function(e){return this.maxDistance=e,this},n.prototype.setMinDistance=function(e){return this.minDistance=e,this},n.prototype.setAzimuth=function(e){return this.azimuth=Hs(e),this.computeMatrix(),this._getAxes(),this.type===_e.ORBITING||this.type===_e.EXPLORING?this._getPosition():this.type===_e.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getAzimuth=function(){return this.azimuth},n.prototype.setElevation=function(e){return this.elevation=Hs(e),this.computeMatrix(),this._getAxes(),this.type===_e.ORBITING||this.type===_e.EXPLORING?this._getPosition():this.type===_e.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getElevation=function(){return this.elevation},n.prototype.setRoll=function(e){return this.roll=Hs(e),this.computeMatrix(),this._getAxes(),this.type===_e.ORBITING||this.type===_e.EXPLORING?this._getPosition():this.type===_e.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getRoll=function(){return this.roll},n.prototype._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},n.prototype.computeMatrix=function(){var e=Bn(Vt(),[0,0,1],ke(this.roll));Xt(this.matrix);var t=Bn(Vt(),[1,0,0],ke((this.rotateWorld&&this.type!==_e.TRACKING||this.type===_e.TRACKING?1:-1)*this.elevation)),r=Bn(Vt(),[0,1,0],ke((this.rotateWorld&&this.type!==_e.TRACKING||this.type===_e.TRACKING?1:-1)*this.azimuth)),i=Ln(Vt(),r,t);i=Ln(Vt(),i,e);var a=Fa(Q(),i);this.type===_e.ORBITING||this.type===_e.EXPLORING?(Ee(this.matrix,this.matrix,this.focalPoint),Ut(this.matrix,this.matrix,a),Ee(this.matrix,this.matrix,[0,0,this.distance])):this.type===_e.TRACKING&&(Ee(this.matrix,this.matrix,this.position),Ut(this.matrix,this.matrix,a))},n.prototype._setPosition=function(e,t,r){this.position=Sr(e,t,r);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()},n.prototype._getAxes=function(){T.JG(this.right,Sr(fn(on(),[1,0,0,0],this.matrix))),T.JG(this.up,Sr(fn(on(),[0,1,0,0],this.matrix))),T.JG(this.forward,Sr(fn(on(),[0,0,1,0],this.matrix))),T.Fv(this.right,this.right),T.Fv(this.up,this.up),T.Fv(this.forward,this.forward)},n.prototype._getAngles=function(){var e=this.distanceVector[0],t=this.distanceVector[1],r=this.distanceVector[2],i=T.kE(this.distanceVector);if(i===0){this.elevation=0,this.azimuth=0;return}this.type===_e.TRACKING?(this.elevation=Ni(Math.asin(t/i)),this.azimuth=Ni(Math.atan2(-e,-r))):this.rotateWorld?(this.elevation=Ni(Math.asin(t/i)),this.azimuth=Ni(Math.atan2(-e,-r))):(this.elevation=-Ni(Math.asin(t/i)),this.azimuth=-Ni(Math.atan2(-e,-r)))},n.prototype._getPosition=function(){T.JG(this.position,Sr(fn(on(),[0,0,0,1],this.matrix))),this._getDistance()},n.prototype._getFocalPoint=function(){T.kK(this.distanceVector,[0,0,-this.distance],Qi.xO(Qi.Ue(),this.matrix)),T.IH(this.focalPoint,this.position,this.distanceVector),this._getDistance()},n.prototype._getDistance=function(){this.distanceVector=T.$X(T.Ue(),this.focalPoint,this.position),this.distance=T.kE(this.distanceVector),this.dollyingStep=this.distance/100},n.prototype._getOrthoMatrix=function(){if(this.projectionMode===Ur.ORTHOGRAPHIC){var e=this.position,t=Bn(Vt(),[0,0,1],-this.roll*Math.PI/180);mr(this.orthoMatrix,t,T.al((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),T.al(this.zoom,this.zoom,1),e)}},n.prototype.triggerUpdate=function(){if(this.enableUpdate){var e=this.getViewTransform(),t=Ut(Q(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(t),this.eventEmitter.emit(zx.UPDATED)}},n.prototype.rotate=function(e,t,r){throw new Error(Le)},n.prototype.pan=function(e,t){throw new Error(Le)},n.prototype.dolly=function(e){throw new Error(Le)},n.prototype.createLandmark=function(e,t){throw new Error(Le)},n.prototype.gotoLandmark=function(e,t){throw new Error(Le)},n.prototype.cancelLandmarkAnimation=function(){throw new Error(Le)},n}();function Kn(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var t=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=e?e.apply(this,r):r[0],o=t.cache;if(o.has(a))return o.get(a);var s=n.apply(this,r);return t.cache=o.set(a,s)||o,s};return t.cache=new(Kn.Cache||Map),t}Kn.Cache=Map;var xt;(function(n){n[n.kUnknown=0]="kUnknown",n[n.kNumber=1]="kNumber",n[n.kPercentage=2]="kPercentage",n[n.kEms=3]="kEms",n[n.kPixels=4]="kPixels",n[n.kRems=5]="kRems",n[n.kDegrees=6]="kDegrees",n[n.kRadians=7]="kRadians",n[n.kGradians=8]="kGradians",n[n.kTurns=9]="kTurns",n[n.kMilliseconds=10]="kMilliseconds",n[n.kSeconds=11]="kSeconds",n[n.kInteger=12]="kInteger"})(xt||(xt={}));var ci;(function(n){n[n.kUNumber=0]="kUNumber",n[n.kUPercent=1]="kUPercent",n[n.kULength=2]="kULength",n[n.kUAngle=3]="kUAngle",n[n.kUTime=4]="kUTime",n[n.kUOther=5]="kUOther"})(ci||(ci={}));var Vx;(function(n){n[n.kAll=0]="kAll",n[n.kNonNegative=1]="kNonNegative",n[n.kInteger=2]="kInteger",n[n.kNonNegativeInteger=3]="kNonNegativeInteger",n[n.kPositiveInteger=4]="kPositiveInteger"})(Vx||(Vx={}));var fv;(function(n){n[n.kYes=0]="kYes",n[n.kNo=1]="kNo"})(fv||(fv={}));var dv;(function(n){n[n.kYes=0]="kYes",n[n.kNo=1]="kNo"})(dv||(dv={}));var Ek=[{name:"em",unit_type:xt.kEms},{name:"px",unit_type:xt.kPixels},{name:"deg",unit_type:xt.kDegrees},{name:"rad",unit_type:xt.kRadians},{name:"grad",unit_type:xt.kGradians},{name:"ms",unit_type:xt.kMilliseconds},{name:"s",unit_type:xt.kSeconds},{name:"rem",unit_type:xt.kRems},{name:"turn",unit_type:xt.kTurns}],io;(function(n){n[n.kUnknownType=0]="kUnknownType",n[n.kUnparsedType=1]="kUnparsedType",n[n.kKeywordType=2]="kKeywordType",n[n.kUnitType=3]="kUnitType",n[n.kSumType=4]="kSumType",n[n.kProductType=5]="kProductType",n[n.kNegateType=6]="kNegateType",n[n.kInvertType=7]="kInvertType",n[n.kMinType=8]="kMinType",n[n.kMaxType=9]="kMaxType",n[n.kClampType=10]="kClampType",n[n.kTransformType=11]="kTransformType",n[n.kPositionType=12]="kPositionType",n[n.kURLImageType=13]="kURLImageType",n[n.kColorType=14]="kColorType",n[n.kUnsupportedColorType=15]="kUnsupportedColorType"})(io||(io={}));var wk=function(n){return Ek.find(function(e){return e.name===n}).unit_type},_k=function(n){return n?n==="number"?xt.kNumber:n==="percent"||n==="%"?xt.kPercentage:wk(n):xt.kUnknown},Sk=function(n){switch(n){case xt.kNumber:case xt.kInteger:return ci.kUNumber;case xt.kPercentage:return ci.kUPercent;case xt.kPixels:return ci.kULength;case xt.kMilliseconds:case xt.kSeconds:return ci.kUTime;case xt.kDegrees:case xt.kRadians:case xt.kGradians:case xt.kTurns:return ci.kUAngle;default:return ci.kUOther}},Tk=function(n){switch(n){case ci.kUNumber:return xt.kNumber;case ci.kULength:return xt.kPixels;case ci.kUPercent:return xt.kPercentage;case ci.kUTime:return xt.kSeconds;case ci.kUAngle:return xt.kDegrees;default:return xt.kUnknown}},Hx=function(n){var e=1;switch(n){case xt.kPixels:case xt.kDegrees:case xt.kSeconds:break;case xt.kMilliseconds:e=.001;break;case xt.kRadians:e=180/Math.PI;break;case xt.kGradians:e=.9;break;case xt.kTurns:e=360;break}return e},pv=function(n){switch(n){case xt.kNumber:case xt.kInteger:return"";case xt.kPercentage:return"%";case xt.kEms:return"em";case xt.kRems:return"rem";case xt.kPixels:return"px";case xt.kDegrees:return"deg";case xt.kRadians:return"rad";case xt.kGradians:return"grad";case xt.kMilliseconds:return"ms";case xt.kSeconds:return"s";case xt.kTurns:return"turn"}return""},Oh=function(){function n(){}return n.isAngle=function(e){return e===xt.kDegrees||e===xt.kRadians||e===xt.kGradians||e===xt.kTurns},n.isLength=function(e){return e>=xt.kEms&&e<xt.kDegrees},n.isRelativeUnit=function(e){return e===xt.kPercentage||e===xt.kEms||e===xt.kRems},n.isTime=function(e){return e===xt.kSeconds||e===xt.kMilliseconds},n.prototype.toString=function(){return this.buildCSSText(fv.kNo,dv.kNo,"")},n.prototype.isNumericValue=function(){return this.getType()>=io.kUnitType&&this.getType()<=io.kClampType},n}(),Pk=function(n){B(e,n);function e(t){var r=n.call(this)||this;return r.colorSpace=t,r}return e.prototype.getType=function(){return io.kColorType},e.prototype.to=function(t){return this},e}(Oh),Xs;(function(n){n[n.Constant=0]="Constant",n[n.LinearGradient=1]="LinearGradient",n[n.RadialGradient=2]="RadialGradient"})(Xs||(Xs={}));var Nh=function(n){B(e,n);function e(t,r){var i=n.call(this)||this;return i.type=t,i.value=r,i}return e.prototype.clone=function(){return new e(this.type,this.value)},e.prototype.buildCSSText=function(t,r,i){return i},e.prototype.getType=function(){return io.kColorType},e}(Oh),Vr=function(n){B(e,n);function e(t){var r=n.call(this)||this;return r.value=t,r}return e.prototype.clone=function(){return new e(this.value)},e.prototype.getType=function(){return io.kKeywordType},e.prototype.buildCSSText=function(t,r,i){return i+this.value},e}(Oh),Mk=Kn(function(n){return n===void 0&&(n=""),n.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})}),Yx=function(n){return n.split("").map(function(e,t){return e.toUpperCase()===e?"".concat(t!==0?"-":"").concat(e.toLowerCase()):e}).join("")};function Ck(n){if(!n)throw new Error}function js(n){return typeof n=="function"}function Ak(n){return typeof n=="symbol"}var AU=function(n){return Object.fromEntries(Object.entries(n).filter(function(e){var t=__read(e,2),r=t[1];return r!==void 0}))},Ok={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign"},src:{alias:"img"}},vv=Kn(function(n){var e=Mk(n),t=Ok[e];return e=(t==null?void 0:t.alias)||e,e}),Nk=function(n,e){e===void 0&&(e="");var t="";return Number.isFinite(n)?(Ck(Number.isNaN(n)),t="NaN"):n>0?t="infinity":t="-infinity",t+=e},gv=function(n){return Tk(Sk(n))},Ie=function(n){B(e,n);function e(t,r){r===void 0&&(r=xt.kNumber);var i=n.call(this)||this,a;return typeof r=="string"?a=_k(r):a=r,i.unit=a,i.value=t,i}return e.prototype.clone=function(){return new e(this.value,this.unit)},e.prototype.equals=function(t){var r=t;return this.value===r.value&&this.unit===r.unit},e.prototype.getType=function(){return io.kUnitType},e.prototype.convertTo=function(t){if(this.unit===t)return new e(this.value,this.unit);var r=gv(this.unit);if(r!==gv(t)||r===xt.kUnknown)return null;var i=Hx(this.unit)/Hx(t);return new e(this.value*i,t)},e.prototype.buildCSSText=function(t,r,i){var a;switch(this.unit){case xt.kUnknown:break;case xt.kInteger:a=Number(this.value).toFixed(0);break;case xt.kNumber:case xt.kPercentage:case xt.kEms:case xt.kRems:case xt.kPixels:case xt.kDegrees:case xt.kRadians:case xt.kGradians:case xt.kMilliseconds:case xt.kSeconds:case xt.kTurns:{var o=-999999,s=999999,l=this.value,c=pv(this.unit);if(l<o||l>s){var u=pv(this.unit);!Number.isFinite(l)||Number.isNaN(l)?a=Nk(l,u):a=l+(u||"")}else a="".concat(l).concat(c)}}return i+=a,i},e}(Oh),Sn=new Ie(0,"px");new Ie(1,"px");var Ri=new Ie(0,"deg"),mv=function(n){B(e,n);function e(t,r,i,a,o){a===void 0&&(a=1),o===void 0&&(o=!1);var s=n.call(this,"rgb")||this;return s.r=t,s.g=r,s.b=i,s.alpha=a,s.isNone=o,s}return e.prototype.clone=function(){return new e(this.r,this.g,this.b,this.alpha)},e.prototype.buildCSSText=function(t,r,i){return i+"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")},e}(Pk),Ke=new Vr("unset"),Rk=new Vr("initial"),kk=new Vr("inherit"),yv={"":Ke,unset:Ke,initial:Rk,inherit:kk},xv=function(n){return yv[n]||(yv[n]=new Vr(n)),yv[n]},Rh=new mv(0,0,0,0,!0),Xx=new mv(0,0,0,0),Lk=Kn(function(n,e,t,r){return new mv(n,e,t,r)},function(n,e,t,r){return"rgba(".concat(n,",").concat(e,",").concat(t,",").concat(r,")")}),ze=function(n,e){return e===void 0&&(e=xt.kNumber),new Ie(n,e)};new Ie(50,"%");var bv;(function(n){n[n.Standard=0]="Standard"})(bv||(bv={}));var $s;(function(n){n[n.ADDED=0]="ADDED",n[n.REMOVED=1]="REMOVED",n[n.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED"})($s||($s={}));var jx={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Ho(0,0,0,0)},wt;(function(n){n.COORDINATE="<coordinate>",n.COLOR="<color>",n.PAINT="<paint>",n.NUMBER="<number>",n.ANGLE="<angle>",n.OPACITY_VALUE="<opacity-value>",n.SHADOW_BLUR="<shadow-blur>",n.LENGTH="<length>",n.PERCENTAGE="<percentage>",n.LENGTH_PERCENTAGE="<length> | <percentage>",n.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",n.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",n.LIST_OF_POINTS="<list-of-points>",n.PATH="<path>",n.FILTER="<filter>",n.Z_INDEX="<z-index>",n.OFFSET_DISTANCE="<offset-distance>",n.DEFINED_PATH="<defined-path>",n.MARKER="<marker>",n.TRANSFORM="<transform>",n.TRANSFORM_ORIGIN="<transform-origin>",n.TEXT="<text>",n.TEXT_TRANSFORM="<text-transform>"})(wt||(wt={}));function Ik(n){var e=n.type,t=n.value;return e==="hex"?"#".concat(t):e==="literal"?t:e==="rgb"?"rgb(".concat(t.join(","),")"):"rgba(".concat(t.join(","),")")}var Dk=function(){var n={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function t(I){throw new Error(e+": "+I)}function r(){var I=i();return e.length>0&&t("Invalid input not EOF"),I}function i(){return _(a)}function a(){return o("linear-gradient",n.linearGradient,l)||o("repeating-linear-gradient",n.repeatingLinearGradient,l)||o("radial-gradient",n.radialGradient,h)||o("repeating-radial-gradient",n.repeatingRadialGradient,h)||o("conic-gradient",n.conicGradient,h)}function o(I,Z,J){return s(Z,function(mt){var It=J();return It&&(z(n.comma)||t("Missing comma before color stops")),{type:I,orientation:It,colorStops:_(S)}})}function s(I,Z){var J=z(I);if(J){z(n.startCall)||t("Missing (");var mt=Z(J);return z(n.endCall)||t("Missing )"),mt}}function l(){return c()||u()}function c(){return L("directional",n.sideOrCorner,1)}function u(){return L("angular",n.angleValue,1)}function h(){var I,Z=f(),J;return Z&&(I=[],I.push(Z),J=e,z(n.comma)&&(Z=f(),Z?I.push(Z):e=J)),I}function f(){var I=d()||p();if(I)I.at=g();else{var Z=v();if(Z){I=Z;var J=g();J&&(I.at=J)}else{var mt=m();mt&&(I={type:"default-radial",at:mt})}}return I}function d(){var I=L("shape",/^(circle)/i,0);return I&&(I.style=R()||v()),I}function p(){var I=L("shape",/^(ellipse)/i,0);return I&&(I.style=A()||v()),I}function v(){return L("extent-keyword",n.extentKeywords,1)}function g(){if(L("position",/^at/,0)){var I=m();return I||t("Missing positioning value"),I}}function m(){var I=x();if(I.x||I.y)return{type:"position",value:I}}function x(){return{x:A(),y:A()}}function _(I){var Z=I(),J=[];if(Z)for(J.push(Z);z(n.comma);)Z=I(),Z?J.push(Z):t("One extra comma");return J}function S(){var I=b();return I||t("Expected color definition"),I.length=A(),I}function b(){return E()||M()||w()||y()}function y(){return L("literal",n.literalColor,0)}function E(){return L("hex",n.hexColor,1)}function w(){return s(n.rgbColor,function(){return{type:"rgb",value:_(P)}})}function M(){return s(n.rgbaColor,function(){return{type:"rgba",value:_(P)}})}function P(){return z(n.number)[1]}function A(){return L("%",n.percentageValue,1)||O()||R()}function O(){return L("position-keyword",n.positionKeywords,1)}function R(){return L("px",n.pixelValue,1)||L("em",n.emValue,1)}function L(I,Z,J){var mt=z(Z);if(mt)return{type:I,value:mt[J]}}function z(I){var Z=/^[\n\r\t\s]+/.exec(e);Z&&Y(Z[0].length);var J=I.exec(e);return J&&Y(J[0].length),J}function Y(I){e=e.substring(I)}return function(I){return e=I,r()}}();function OU(n,e,t,r){var i=ke(r.value),a=0,o=0,s=a+e/2,l=o+t/2,c=Math.abs(e*Math.cos(i))+Math.abs(t*Math.sin(i)),u=n[0]+s-Math.cos(i)*c/2,h=n[1]+l-Math.sin(i)*c/2,f=n[0]+s+Math.cos(i)*c/2,d=n[1]+l+Math.sin(i)*c/2;return{x1:u,y1:h,x2:f,y2:d}}function NU(n,e,t,r,i,a){var o=r.value,s=i.value;r.unit===xt.kPercentage&&(o=r.value/100*e),i.unit===xt.kPercentage&&(s=i.value/100*t);var l=Math.max(distanceSquareRoot([0,0],[o,s]),distanceSquareRoot([0,t],[o,s]),distanceSquareRoot([e,t],[o,s]),distanceSquareRoot([e,0],[o,s]));return a&&(a instanceof Ie?l=a.value:a instanceof Vr&&(a.value==="closest-side"?l=Math.min(o,e-o,s,t-s):a.value==="farthest-side"?l=Math.max(o,e-o,s,t-s):a.value==="closest-corner"&&(l=Math.min(distanceSquareRoot([0,0],[o,s]),distanceSquareRoot([0,t],[o,s]),distanceSquareRoot([e,t],[o,s]),distanceSquareRoot([e,0],[o,s]))))),{x:o+n[0],y:s+n[1],r:l}}var Bk=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,Fk=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,Gk=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,$x=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function zk(n){var e,t,r,i=n.length;n[i-1].length=(e=n[i-1].length)!==null&&e!==void 0?e:{type:"%",value:"100"},i>1&&(n[0].length=(t=n[0].length)!==null&&t!==void 0?t:{type:"%",value:"0"});for(var a=0,o=Number(n[0].length.value),s=1;s<i;s++){var l=(r=n[s].length)===null||r===void 0?void 0:r.value;if(!Mt(l)&&!Mt(o)){for(var c=1;c<s-a;c++)n[a+c].length={type:"%",value:"".concat(o+(Number(l)-o)*c/(s-a))};a=s,o=Number(l)}}}var Wk={left:270-90,top:0-90,bottom:180-90,right:90-90,"left top":315-90,"top left":315-90,"left bottom":225-90,"bottom left":225-90,"right top":45-90,"top right":45-90,"right bottom":135-90,"bottom right":135-90},Uk=Kn(function(n){var e;return n.type==="angular"?e=Number(n.value):e=Wk[n.value]||0,ze(e,"deg")}),Vk=Kn(function(n){var e=50,t=50,r="%",i="%";if((n==null?void 0:n.type)==="position"){var a=n.value,o=a.x,s=a.y;(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?e=0:o.value==="center"?e=50:o.value==="right"?e=100:o.value==="top"?t=0:o.value==="bottom"&&(t=100)),(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?e=0:s.value==="center"?t=50:s.value==="right"?e=100:s.value==="top"?t=0:s.value==="bottom"&&(t=100)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(r=o==null?void 0:o.type,e=Number(o.value)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(i=s==null?void 0:s.type,t=Number(s.value))}return{cx:ze(e,r),cy:ze(t,i)}}),Hk=Kn(function(n){var e;if(n.indexOf("linear")>-1||n.indexOf("radial")>-1){var t=Dk(n);return t.map(function(s){var l=s.type,c=s.orientation,u=s.colorStops;zk(u);var h=u.map(function(_){return{offset:ze(Number(_.length.value),"%"),color:Ik(_)}});if(l==="linear-gradient")return new Nh(Xs.LinearGradient,{angle:c?Uk(c):Ri,steps:h});if(l==="radial-gradient"&&(c||(c=[{type:"shape",value:"circle"}]),c[0].type==="shape"&&c[0].value==="circle")){var f=Vk(c[0].at),d=f.cx,p=f.cy,v=void 0;if(c[0].style){var g=c[0].style,m=g.type,x=g.value;m==="extent-keyword"?v=xv(x):v=ze(x,m)}return new Nh(Xs.RadialGradient,{cx:d,cy:p,size:v,steps:h})}})}var r=n[0];if(n[1]==="("||n[2]==="("){if(r==="l"){var i=Bk.exec(n);if(i){var a=((e=i[2].match($x))===null||e===void 0?void 0:e.map(function(s){return s.split(":")}))||[];return[new Nh(Xs.LinearGradient,{angle:ze(parseFloat(i[1]),"deg"),steps:a.map(function(s){var l=C(s,2),c=l[0],u=l[1];return{offset:ze(Number(c)*100,"%"),color:u}})})]}}else if(r==="r"){var o=Yk(n);if(o)if(ue(o))n=o;else return[new Nh(Xs.RadialGradient,o)]}else if(r==="p")return Xk(n)}});function Yk(n){var e,t=Fk.exec(n);if(t){var r=((e=t[4].match($x))===null||e===void 0?void 0:e.map(function(i){return i.split(":")}))||[];return{cx:ze(50,"%"),cy:ze(50,"%"),steps:r.map(function(i){var a=C(i,2),o=a[0],s=a[1];return{offset:ze(Number(o)*100,"%"),color:s}})}}return null}function Xk(n){var e=Gk.exec(n);if(e){var t=e[1],r=e[2];switch(t){case"a":t="repeat";break;case"x":t="repeat-x";break;case"y":t="repeat-y";break;case"n":t="no-repeat";break;default:t="no-repeat"}return{image:r,repetition:t}}return null}function RU(n){return!!n.type&&!!n.value}function jk(n){return n&&!!n.image}function Kx(n){return n&&!Mt(n.r)&&!Mt(n.g)&&!Mt(n.b)}var Ks=Kn(function(n){if(jk(n))return N({repetition:"repeat"},n);if(Mt(n)&&(n=""),n==="transparent")return Xx;if(n==="currentColor")n="black";else if(n==="none")return Rh;var e=Hk(n);if(e)return e;var t=md.ZP(n),r=[0,0,0,0];return t!==null&&(r[0]=t.r||0,r[1]=t.g||0,r[2]=t.b||0,r[3]=t.opacity),Lk.apply(void 0,K([],C(r),!1))});function $k(n,e){if(!(!Kx(n)||!Kx(e)))return[[Number(n.r),Number(n.g),Number(n.b),Number(n.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var r=t.slice();if(r[3])for(var i=0;i<3;i++)r[i]=Math.round(me(r[i],0,255));return r[3]=me(r[3],0,1),"rgba(".concat(r.join(","),")")}]}function oc(n,e){if(Mt(e))return ze(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(n)>=0)return ze(Number(e),"px");if("deg".search(n)>=0)return ze(Number(e),"deg")}var t=[];e=e.replace(n,function(i){return t.push(i),"U"+i});var r="U("+n.source+")";return t.map(function(i){return ze(Number(e.replace(new RegExp("U"+i,"g"),"").replace(new RegExp(r,"g"),"*0")),i)})[0]}var Zx=function(n){return oc(new RegExp("px","g"),n)},Kk=Kn(Zx),Zk=function(n){return oc(new RegExp("%","g"),n)};Kn(Zk);var sc=function(n){return fe(n)||isFinite(Number(n))?ze(Number(n)||0,"px"):oc(new RegExp("px|%|em|rem","g"),n)},Zs=Kn(sc),Ev=function(n){return oc(new RegExp("deg|rad|grad|turn","g"),n)},qx=Kn(Ev);function qk(n,e,t,r,i){i===void 0&&(i=0);var a="",o=n.value||0,s=e.value||0,l=gv(n.unit),c=n.convertTo(l),u=e.convertTo(l);return c&&u?(o=c.value,s=u.value,a=pv(n.unit)):(Ie.isLength(n.unit)||Ie.isLength(e.unit))&&(o=ui(n,i,t),s=ui(e,i,t),a="px"),[o,s,function(h){return r&&(h=Math.max(h,0)),h+a}]}function Hr(n){var e=0;return n.unit===xt.kDegrees?e=n.value:n.unit===xt.kRadians?e=Ni(Number(n.value)):n.unit===xt.kTurns&&(e=uk(Number(n.value))),e}function Jx(n,e){var t;return Array.isArray(n)?t=n.map(function(r){return Number(r)}):ue(n)?t=n.split(" ").map(function(r){return Number(r)}):fe(n)&&(t=[n]),e===2?t.length===1?[t[0],t[0]]:[t[0],t[1]]:t.length===1?[t[0],t[0],t[0],t[0]]:t.length===2?[t[0],t[1],t[0],t[1]]:t.length===3?[t[0],t[1],t[2],t[1]]:[t[0],t[1],t[2],t[3]]}function Qx(n){return ue(n)?n.split(" ").map(function(e){return Zs(e)}):n.map(function(e){return Zs(e.toString())})}function ui(n,e,t,r){if(r===void 0&&(r=!1),n.unit===xt.kPixels)return Number(n.value);if(n.unit===xt.kPercentage&&t){var i=t.nodeName===Rt.GROUP?t.getLocalBounds():t.getGeometryBounds();return(r?i.min[e]:0)+n.value/100*i.halfExtents[e]*2}return 0}var Jk=function(n){return oc(/deg|rad|grad|turn|px|%/g,n)},Qk=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function tb(n){if(n===void 0&&(n=""),n=n.toLowerCase().trim(),n==="none")return[];for(var e=/\s*([\w-]+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];if(i=r.index+r[0].length,Qk.indexOf(r[1])>-1&&t.push({name:r[1],params:r[2].split(" ").map(function(a){return Jk(a)||Ks(a)})}),e.lastIndex===n.length)return t}return[]}function eb(n){return n.toString()}var qs=function(n){return typeof n=="number"?ze(n):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(n)?ze(Number(n)):ze(0)},Yo=Kn(qs);Kn(function(n){return ue(n)?n.split(" ").map(Yo):n.map(Yo)});function wv(n,e){return[n,e,eb]}function _v(n,e){return function(t,r){return[t,r,function(i){return eb(me(i,n,e))}]}}function nb(n,e){if(n.length===e.length)return[n,e,function(t){return t}]}function rb(n){return n.parsedStyle.d.totalLength===0&&(n.parsedStyle.d.totalLength=Am(n.parsedStyle.d.absolutePath)),n.parsedStyle.d.totalLength}function t3(n){return n.parsedStyle.points.totalLength===0&&(n.parsedStyle.points.totalLength=Td(n.parsedStyle.points.points)),n.parsedStyle.points.totalLength}function e3(n){for(var e=0;e<n.length;e++){var t=n[e-1],r=n[e],i=r[0];if(i==="M"&&t){var a=t[0],o=[r[1],r[2]],s=void 0;a==="L"||a==="M"?s=[t[1],t[2]]:(a==="C"||a==="A"||a==="Q")&&(s=[t[t.length-2],t[t.length-1]]),s&&kh(o,s)&&(n.splice(e,1),e--)}}}function n3(n){for(var e=!1,t=n.length,r=0;r<t;r++){var i=n[r],a=i[0];if(a==="C"||a==="A"||a==="Q"){e=!0;break}}return e}function r3(n){for(var e=[],t=[],r=[],i=0;i<n.length;i++){var a=n[i],o=a[0];o==="M"?(r.length&&(t.push(r),r=[]),r.push([a[1],a[2]])):o==="Z"?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]])}return r.length>0&&t.push(r),{polygons:e,polylines:t}}function kh(n,e){return n[0]===e[0]&&n[1]===e[1]}function i3(n,e){for(var t=[],r=[],i=[],a=0;a<n.length;a++){var o=n[a],s=o.currentPoint,l=o.params,c=o.prePoint,u=void 0;switch(o.command){case"Q":u=Md(c[0],c[1],l[1],l[2],l[3],l[4]);break;case"C":u=Sd(c[0],c[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;u=wd(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:t.push(s[0]),r.push(s[1]);break}u&&(o.box=u,t.push(u.x,u.x+u.width),r.push(u.y,u.y+u.height)),e&&(o.command==="L"||o.command==="M")&&o.prePoint&&o.nextPoint&&i.push(o)}t=t.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0}),r=r.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0});var f=us(t),d=us(r),p=hs(t),v=hs(r);if(i.length===0)return{x:f,y:d,width:p-f,height:v-d};for(var a=0;a<i.length;a++){var o=i[a],s=o.currentPoint,g=void 0;s[0]===f?(g=Lh(o,e),f=f-g.xExtra):s[0]===p&&(g=Lh(o,e),p=p+g.xExtra),s[1]===d?(g=Lh(o,e),d=d-g.yExtra):s[1]===v&&(g=Lh(o,e),v=v+g.yExtra)}return{x:f,y:d,width:p-f,height:v-d}}function Lh(n,e){var t=n.prePoint,r=n.currentPoint,i=n.nextPoint,a=Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2),l=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!l||Math.sin(l)===0||fs(l,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));c=c>Math.PI/2?Math.PI-c:c,u=u>Math.PI/2?Math.PI-u:u;var h={xExtra:Math.cos(l/2-c)*(e/2*(1/Math.sin(l/2)))-e/2||0,yExtra:Math.cos(u-l/2)*(e/2*(1/Math.sin(l/2)))-e/2||0};return h}function ib(n,e){return[e[0]+(e[0]-n[0]),e[1]+(e[1]-n[1])]}var ab=function(n,e){var t=n.x*e.x+n.y*e.y,r=Math.sqrt((Math.pow(n.x,2)+Math.pow(n.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2))),i=n.x*e.y-n.y*e.x<0?-1:1,a=i*Math.acos(t/r);return a},ob=function(n,e,t,r,i,a,o,s){e=Math.abs(e),t=Math.abs(t),r=jc(r,360);var l=ke(r);if(n.x===o.x&&n.y===o.y)return{x:n.x,y:n.y,ellipticalArcAngle:0};if(e===0||t===0)return{x:0,y:0,ellipticalArcAngle:0};var c=(n.x-o.x)/2,u=(n.y-o.y)/2,h={x:Math.cos(l)*c+Math.sin(l)*u,y:-Math.sin(l)*c+Math.cos(l)*u},f=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(t,2);f>1&&(e=Math.sqrt(f)*e,t=Math.sqrt(f)*t);var d=Math.pow(e,2)*Math.pow(t,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(t,2)*Math.pow(h.x,2),p=Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(t,2)*Math.pow(h.x,2),v=d/p;v=v<0?0:v;var g=(i!==a?1:-1)*Math.sqrt(v),m={x:g*(e*h.y/t),y:g*(-(t*h.x)/e)},x={x:Math.cos(l)*m.x-Math.sin(l)*m.y+(n.x+o.x)/2,y:Math.sin(l)*m.x+Math.cos(l)*m.y+(n.y+o.y)/2},_={x:(h.x-m.x)/e,y:(h.y-m.y)/t},S=ab({x:1,y:0},_),b={x:(-h.x-m.x)/e,y:(-h.y-m.y)/t},y=ab(_,b);!a&&y>0?y-=2*Math.PI:a&&y<0&&(y+=2*Math.PI),y%=2*Math.PI;var E=S+y*s,w=e*Math.cos(E),M=t*Math.sin(E),P={x:Math.cos(l)*w-Math.sin(l)*M+x.x,y:Math.sin(l)*w+Math.cos(l)*M+x.y,ellipticalArcStartAngle:S,ellipticalArcEndAngle:S+y,ellipticalArcAngle:E,ellipticalArcCenter:x,resultantRx:e,resultantRy:t};return P};function a3(n){for(var e=[],t=null,r=null,i=null,a=0,o=n.length,s=0;s<o;s++){var l=n[s];r=n[s+1];var c=l[0],u={command:c,prePoint:t,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(c){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=o3(t,l);u.arcParams=h;break}if(c==="Z")t=i,r=n[a+1];else{var f=l.length;t=[l[f-2],l[f-1]]}r&&r[0]==="Z"&&(r=n[a],e[a]&&(e[a].prePoint=t)),u.currentPoint=t,e[a]&&kh(t,e[a].currentPoint)&&(e[a].prePoint=u.prePoint);var d=r?[r[r.length-2],r[r.length-1]]:null;u.nextPoint=d;var p=u.prePoint;if(["L","H","V"].includes(c))u.startTangent=[p[0]-t[0],p[1]-t[1]],u.endTangent=[t[0]-p[0],t[1]-p[1]];else if(c==="Q"){var v=[l[1],l[2]];u.startTangent=[p[0]-v[0],p[1]-v[1]],u.endTangent=[t[0]-v[0],t[1]-v[1]]}else if(c==="T"){var g=e[s-1],v=ib(g.currentPoint,p);g.command==="Q"?(u.command="Q",u.startTangent=[p[0]-v[0],p[1]-v[1]],u.endTangent=[t[0]-v[0],t[1]-v[1]]):(u.command="TL",u.startTangent=[p[0]-t[0],p[1]-t[1]],u.endTangent=[t[0]-p[0],t[1]-p[1]])}else if(c==="C"){var m=[l[1],l[2]],x=[l[3],l[4]];u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]],u.startTangent[0]===0&&u.startTangent[1]===0&&(u.startTangent=[m[0]-x[0],m[1]-x[1]]),u.endTangent[0]===0&&u.endTangent[1]===0&&(u.endTangent=[x[0]-m[0],x[1]-m[1]])}else if(c==="S"){var g=e[s-1],m=ib(g.currentPoint,p),x=[l[1],l[2]];g.command==="C"?(u.command="C",u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]]):(u.command="SQ",u.startTangent=[p[0]-x[0],p[1]-x[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]])}else if(c==="A"){var _=sb(u,0),S=_.x,b=_.y,y=sb(u,1,!1),E=y.x,w=y.y;u.startTangent=[S,b],u.endTangent=[E,w]}e.push(u)}return e}function sb(n,e,t){t===void 0&&(t=!0);var r=n.arcParams,i=r.rx,a=i===void 0?0:i,o=r.ry,s=o===void 0?0:o,l=r.xRotation,c=r.arcFlag,u=r.sweepFlag,h=ob({x:n.prePoint[0],y:n.prePoint[1]},a,s,l,!!c,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},e),f=ob({x:n.prePoint[0],y:n.prePoint[1]},a,s,l,!!c,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},t?e+.005:e-.005),d=f.x-h.x,p=f.y-h.y,v=Math.sqrt(d*d+p*p);return{x:-d/v,y:-p/v}}function Ih(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Sv(n,e){return Ih(n)*Ih(e)?(n[0]*e[0]+n[1]*e[1])/(Ih(n)*Ih(e)):1}function lb(n,e){return(n[0]*e[1]<n[1]*e[0]?-1:1)*Math.acos(Sv(n,e))}function o3(n,e){var t=e[1],r=e[2],i=jc(ke(e[3]),Math.PI*2),a=e[4],o=e[5],s=n[0],l=n[1],c=e[6],u=e[7],h=Math.cos(i)*(s-c)/2+Math.sin(i)*(l-u)/2,f=-1*Math.sin(i)*(s-c)/2+Math.cos(i)*(l-u)/2,d=h*h/(t*t)+f*f/(r*r);d>1&&(t*=Math.sqrt(d),r*=Math.sqrt(d));var p=t*t*(f*f)+r*r*(h*h),v=p?Math.sqrt((t*t*(r*r)-p)/p):1;a===o&&(v*=-1),isNaN(v)&&(v=0);var g=r?v*t*f/r:0,m=t?v*-r*h/t:0,x=(s+c)/2+Math.cos(i)*g-Math.sin(i)*m,_=(l+u)/2+Math.sin(i)*g+Math.cos(i)*m,S=[(h-g)/t,(f-m)/r],b=[(-1*h-g)/t,(-1*f-m)/r],y=lb([1,0],S),E=lb(S,b);return Sv(S,b)<=-1&&(E=Math.PI),Sv(S,b)>=1&&(E=0),o===0&&E>0&&(E=E-2*Math.PI),o===1&&E<0&&(E=E+2*Math.PI),{cx:x,cy:_,rx:kh(n,[c,u])?0:t,ry:kh(n,[c,u])?0:r,startAngle:y,endAngle:y+E,xRotation:i,arcFlag:a,sweepFlag:o}}function s3(n,e,t){return n.reduce(function(r,i){var a="";if(i[0]==="M"||i[0]==="L"){var o=vec3.fromValues(i[1],i[2],0);t&&vec3.transformMat4(o,o,t),a="".concat(i[0]).concat(o[0],",").concat(o[1])}else if(i[0]==="Z")a=i[0];else if(i[0]==="C"){var s=vec3.fromValues(i[1],i[2],0),l=vec3.fromValues(i[3],i[4],0),c=vec3.fromValues(i[5],i[6],0);t&&(vec3.transformMat4(s,s,t),vec3.transformMat4(l,l,t),vec3.transformMat4(c,c,t)),a="".concat(i[0]).concat(s[0],",").concat(s[1],",").concat(l[0],",").concat(l[1],",").concat(c[0],",").concat(c[1])}else if(i[0]==="A"){var u=vec3.fromValues(i[6],i[7],0);t&&vec3.transformMat4(u,u,t),a="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],",").concat(i[5],",").concat(u[0],",").concat(u[1])}else if(i[0]==="Q"){var s=vec3.fromValues(i[1],i[2],0),l=vec3.fromValues(i[3],i[4],0);t&&(vec3.transformMat4(s,s,t),vec3.transformMat4(l,l,t)),a="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],"}")}return r+=a},"")}function l3(n,e,t,r){return[["M",n,e],["L",t,r]]}function cb(n,e,t,r){var i=(-1+Math.sqrt(2))/3*4,a=n*i,o=e*i,s=t-n,l=t+n,c=r-e,u=r+e;return[["M",s,r],["C",s,r-o,t-a,c,t,c],["C",t+a,c,l,r-o,l,r],["C",l,r+o,t+a,u,t,u],["C",t-a,u,s,r+o,s,r],["Z"]]}function c3(n,e){var t=n.map(function(r,i){return[i===0?"M":"L",r[0],r[1]]});return e&&t.push(["Z"]),t}function u3(n,e,t,r,i){if(i){var a=__read(i,4),o=a[0],s=a[1],l=a[2],c=a[3],u=n>0?1:-1,h=e>0?1:-1,f=u+h!==0?1:0;return[["M",u*o+t,r],["L",n-u*s+t,r],s?["A",s,s,0,0,f,n+t,h*s+r]:null,["L",n+t,e-h*l+r],l?["A",l,l,0,0,f,n+t-u*l,e+r]:null,["L",t+u*c,e+r],c?["A",c,c,0,0,f,t,e+r-h*c]:null,["L",t,h*o+r],o?["A",o,o,0,0,f,u*o+t,r]:null,["Z"]].filter(function(d){return d})}return[["M",t,r],["L",t+n,r],["L",t+n,r+e],["L",t,r+e],["Z"]]}function kU(n,e){e===void 0&&(e=n.getLocalTransform());var t=[];switch(n.nodeName){case Rt.LINE:var r=n.parsedStyle,i=r.x1,a=i===void 0?0:i,o=r.y1,s=o===void 0?0:o,l=r.x2,c=l===void 0?0:l,u=r.y2,h=u===void 0?0:u;t=l3(a,s,c,h);break;case Rt.CIRCLE:{var f=n.parsedStyle,d=f.r,p=d===void 0?0:d,v=f.cx,g=v===void 0?0:v,m=f.cy,x=m===void 0?0:m;t=cb(p,p,g,x);break}case Rt.ELLIPSE:{var _=n.parsedStyle,S=_.rx,b=S===void 0?0:S,y=_.ry,E=y===void 0?0:y,w=_.cx,g=w===void 0?0:w,M=_.cy,x=M===void 0?0:M;t=cb(b,E,g,x);break}case Rt.POLYLINE:case Rt.POLYGON:var P=n.parsedStyle.points;t=c3(P.points,n.nodeName===Rt.POLYGON);break;case Rt.RECT:var A=n.parsedStyle,O=A.width,R=O===void 0?0:O,L=A.height,z=L===void 0?0:L,Y=A.x,I=Y===void 0?0:Y,Z=A.y,J=Z===void 0?0:Z,mt=A.radius,It=mt&&mt.some(function(ve){return ve!==0});t=u3(R,z,I,J,It&&mt.map(function(ve){return clamp(ve,0,Math.min(Math.abs(R)/2,Math.abs(z)/2))}));break;case Rt.PATH:var ae=n.parsedStyle.d.absolutePath;t=__spreadArray([],__read(ae),!1);break}if(t.length)return s3(t,n,e)}function LU(n,e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0);var a=n.map(function(o,s){var l=o[0],c=n[s+1],u=s===0&&(e!==0||t!==0),h=(s===n.length-1||c&&(c[0]==="M"||c[0]==="Z"))&&r!==0&&i!==0;switch(l){case"M":return u?"M ".concat(o[1]+e,",").concat(o[2]+t," L ").concat(o[1],",").concat(o[2]):"M ".concat(o[1],",").concat(o[2]);case"L":return"L ".concat(o[1]+(h?r:0),",").concat(o[2]+(h?i:0));case"Q":return"Q ".concat(o[1]," ").concat(o[2],",").concat(o[3]," ").concat(o[4])+(h?" L ".concat(o[3]+r,",").concat(o[4]+i):"");case"C":return"C ".concat(o[1]," ").concat(o[2],",").concat(o[3]," ").concat(o[4],",").concat(o[5]," ").concat(o[6])+(h?" L ".concat(o[5]+r,",").concat(o[6]+i):"");case"A":return"A ".concat(o[1]," ").concat(o[2]," ").concat(o[3]," ").concat(o[4]," ").concat(o[5]," ").concat(o[6]," ").concat(o[7])+(h?" L ".concat(o[6]+r,",").concat(o[7]+i):"");case"Z":return"Z"}}).join(" ");return~a.indexOf("NaN")?"":a}var ub=function(n){if(n===""||Array.isArray(n)&&n.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=cs(n)}catch(f){e=cs(""),console.error("[g]: Invalid SVG Path definition: ".concat(n))}e3(e);var t=n3(e),r=r3(e),i=r.polygons,a=r.polylines,o=a3(e),s=i3(o,0),l=s.x,c=s.y,u=s.width,h=s.height;return{absolutePath:e,hasArc:t,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(u)?u:0,height:Number.isFinite(h)?h:0}}},h3=Kn(ub);function Tv(n){return ue(n)?h3(n):ub(n)}function f3(n,e,t){var r=n.curve,i=e.curve;(!r||r.length===0)&&(r=wl(n.absolutePath,!1),n.curve=r),(!i||i.length===0)&&(i=wl(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=gd(r,i));var o=Kc(a[0])!==Kc(a[1])?Rm(a[0]):km(a[0]);return[o,Lm(a[1],o),function(s){return s}]}function hb(n,e){var t;return ue(n)?t=n.split(" ").map(function(r){var i=C(r.split(","),2),a=i[0],o=i[1];return[Number(a),Number(o)]}):t=n,{points:t,totalLength:0,segments:[]}}function d3(n,e){return[n.points,e.points,function(t){return t}]}var gn=null;function Yr(n){return function(e){var t=0;return n.map(function(r){return r===gn?e[t++]:r})}}function Xo(n){return n}var Dh={matrix:["NNNNNN",[gn,gn,0,0,gn,gn,0,0,0,0,1,0,gn,gn,0,1],Xo],matrix3d:["NNNNNNNNNNNNNNNN",Xo],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",Yr([gn,gn,new Ie(1)]),Xo],scalex:["N",Yr([gn,new Ie(1),new Ie(1)]),Yr([gn,new Ie(1)])],scaley:["N",Yr([new Ie(1),gn,new Ie(1)]),Yr([new Ie(1),gn])],scalez:["N",Yr([new Ie(1),new Ie(1),gn])],scale3d:["NNN",Xo],skew:["Aa",null,Xo],skewx:["A",null,Yr([gn,Ri])],skewy:["A",null,Yr([Ri,gn])],translate:["Tt",Yr([gn,gn,Sn]),Xo],translatex:["T",Yr([gn,Sn,Sn]),Yr([gn,Sn])],translatey:["T",Yr([Sn,gn,Sn]),Yr([Sn,gn])],translatez:["L",Yr([Sn,Sn,gn])],translate3d:["TTL",Xo]};function fb(n){if(n=(n||"none").toLowerCase().trim(),n==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];i=r.index+r[0].length;var a=r[1],o=Dh[a];if(!o)return[];var s=r[2].split(","),l=o[0];if(l.length<s.length)return[];for(var c=[],u=0;u<l.length;u++){var h=s[u],f=l[u],d=void 0;if(h?d={A:function(p){return p.trim()==="0"?Ri:qx(p)},N:Yo,T:Zs,L:Kk}[f.toUpperCase()](h):d={a:Ri,n:c[0],t:Sn}[f],d===void 0)return[];c.push(d)}if(t.push({t:a,d:c}),e.lastIndex===n.length)return t}return[]}function db(n){if(n=(n||"none").toLowerCase().trim(),n==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];i=r.index+r[0].length;var a=r[1],o=Dh[a];if(!o)return[];var s=r[2].split(","),l=o[0];if(l.length<s.length)return[];for(var c=[],u=0;u<l.length;u++){var h=s[u],f=l[u],d=void 0;if(h?d={A:function(p){return p.trim()==="0"?Ri:Ev(p)},N:qs,T:sc,L:Zx}[f.toUpperCase()](h):d={a:Ri,n:c[0],t:Sn}[f],d===void 0)return[];c.push(d)}if(t.push({t:a,d:c}),e.lastIndex===n.length)return t}return[]}function p3(n){var e,t,r,i;switch(n.t){case"rotatex":return i=ke(Hr(n.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotatey":return i=ke(Hr(n.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotatez":return i=ke(Hr(n.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=n.d[0].value,t=n.d[1].value,r=n.d[2].value,i=ke(Hr(n.d[3]));var a=e*e+t*t+r*r;if(a===0)e=1,t=0,r=0;else if(a!==1){var o=Math.sqrt(a);e/=o,t/=o,r/=o}var s=Math.sin(i/2),l=s*Math.cos(i/2),c=s*s;return[1-2*(t*t+r*r)*c,2*(e*t*c+r*l),2*(e*r*c-t*l),0,2*(e*t*c-r*l),1-2*(e*e+r*r)*c,2*(t*r*c+e*l),0,2*(e*r*c+t*l),2*(t*r*c-e*l),1-2*(e*e+t*t)*c,0,0,0,0,1];case"scale":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scalex":return[n.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,n.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,n.d[0].value,0,0,0,0,1];case"scale3d":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,n.d[2].value,0,0,0,0,1];case"skew":var u=ke(Hr(n.d[0])),h=ke(Hr(n.d[1]));return[1,Math.tan(h),0,0,Math.tan(u),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return i=ke(Hr(n.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return i=ke(Hr(n.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return e=ui(n.d[0],0,null)||0,t=ui(n.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1];case"translatex":return e=ui(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,0,0,1];case"translatey":return t=ui(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,t,0,1];case"translatez":return r=ui(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r,1];case"translate3d":return e=ui(n.d[0],0,null)||0,t=ui(n.d[1],0,null)||0,r=ui(n.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,r,1];case"perspective":var f=ui(n.d[0],0,null)||0,d=f?-1/f:0;return[1,0,0,0,0,1,0,0,0,0,1,d,0,0,0,1];case"matrix":return[n.d[0].value,n.d[1].value,0,0,n.d[2].value,n.d[3].value,0,0,0,0,1,0,n.d[4].value,n.d[5].value,0,1];case"matrix3d":return n.d.map(function(p){return p.value})}}function v3(n,e){return[n[0]*e[0]+n[4]*e[1]+n[8]*e[2]+n[12]*e[3],n[1]*e[0]+n[5]*e[1]+n[9]*e[2]+n[13]*e[3],n[2]*e[0]+n[6]*e[1]+n[10]*e[2]+n[14]*e[3],n[3]*e[0]+n[7]*e[1]+n[11]*e[2]+n[15]*e[3],n[0]*e[4]+n[4]*e[5]+n[8]*e[6]+n[12]*e[7],n[1]*e[4]+n[5]*e[5]+n[9]*e[6]+n[13]*e[7],n[2]*e[4]+n[6]*e[5]+n[10]*e[6]+n[14]*e[7],n[3]*e[4]+n[7]*e[5]+n[11]*e[6]+n[15]*e[7],n[0]*e[8]+n[4]*e[9]+n[8]*e[10]+n[12]*e[11],n[1]*e[8]+n[5]*e[9]+n[9]*e[10]+n[13]*e[11],n[2]*e[8]+n[6]*e[9]+n[10]*e[10]+n[14]*e[11],n[3]*e[8]+n[7]*e[9]+n[11]*e[10]+n[15]*e[11],n[0]*e[12]+n[4]*e[13]+n[8]*e[14]+n[12]*e[15],n[1]*e[12]+n[5]*e[13]+n[9]*e[14]+n[13]*e[15],n[2]*e[12]+n[6]*e[13]+n[10]*e[14]+n[14]*e[15],n[3]*e[12]+n[7]*e[13]+n[11]*e[14]+n[15]*e[15]]}function g3(n){return n.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:n.map(p3).reduce(v3)}function pb(n){var e=[0,0,0],t=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return vk(g3(n),e,t,r,i,a),[[e,t,r,a,i]]}var m3=function(){function n(r,i){for(var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],o=0;o<4;o++)for(var s=0;s<4;s++)for(var l=0;l<4;l++)a[o][s]+=i[o][l]*r[l][s];return a}function e(r){return r[0][2]==0&&r[0][3]==0&&r[1][2]==0&&r[1][3]==0&&r[2][0]==0&&r[2][1]==0&&r[2][2]==1&&r[2][3]==0&&r[3][2]==0&&r[3][3]==1}function t(r,i,a,o,s){for(var l=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],c=0;c<4;c++)l[c][3]=s[c];for(var c=0;c<3;c++)for(var u=0;u<3;u++)l[3][c]+=r[u]*l[u][c];var h=o[0],f=o[1],d=o[2],p=o[3],v=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];v[0][0]=1-2*(f*f+d*d),v[0][1]=2*(h*f-d*p),v[0][2]=2*(h*d+f*p),v[1][0]=2*(h*f+d*p),v[1][1]=1-2*(h*h+d*d),v[1][2]=2*(f*d-h*p),v[2][0]=2*(h*d-f*p),v[2][1]=2*(f*d+h*p),v[2][2]=1-2*(h*h+f*f),l=n(l,v);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[2]&&(g[2][1]=a[2],l=n(l,g)),a[1]&&(g[2][1]=0,g[2][0]=a[0],l=n(l,g)),a[0]&&(g[2][0]=0,g[1][0]=a[0],l=n(l,g));for(var c=0;c<3;c++)for(var u=0;u<3;u++)l[c][u]*=i[c];return e(l)?[l[0][0],l[0][1],l[1][0],l[1][1],l[3][0],l[3][1]]:l[0].concat(l[1],l[2],l[3])}return t}();function y3(n){return n.toFixed(6).replace(".000000","")}function Pv(n,e){var t,r;return n.decompositionPair!==e&&(n.decompositionPair=e,t=pb(n)),e.decompositionPair!==n&&(e.decompositionPair=n,r=pb(e)),t[0]===null||r[0]===null?[[!1],[!0],function(i){return i?e[0].d:n[0].d}]:(t[0].push(0),r[0].push(1),[t,r,function(i){var a=b3(t[0][3],r[0][3],i[5]),o=m3(i[0],i[1],i[2],a,i[4]),s=o.map(y3).join(",");return s}])}function x3(n,e){for(var t=0,r=0;r<n.length;r++)t+=n[r]*e[r];return t}function b3(n,e,t){var r=x3(n,e);r=me(r,-1,1);var i=[];if(r===1)i=n;else for(var a=Math.acos(r),o=Math.sin(t*a)*1/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(n[s]*(Math.cos(t*a)-r*o)+e[s]*o);return i}function Mv(n){return n.replace(/[xy]/,"")}function Cv(n){return n.replace(/(x|y|z|3d)?$/,"3d")}var E3=function(n,e){return n==="perspective"&&e==="perspective"||(n==="matrix"||n==="matrix3d")&&(e==="matrix"||e==="matrix3d")};function w3(n,e,t){var r=!1;if(!n.length||!e.length){n.length||(r=!0,n=e,e=[]);for(var i=function(y){var E=n[y],w=E.t,M=E.d,P=w.substring(0,5)==="scale"?1:0;e.push({t:w,d:M.map(function(A){return typeof A=="number"?ze(P):ze(P,A.unit)})})},a=0;a<n.length;a++)i(a)}var o=[],s=[],l=[];if(n.length!==e.length){var c=Pv(n,e);o=[c[0]],s=[c[1]],l=[["matrix",[c[2]]]]}else for(var a=0;a<n.length;a++){var u=n[a].t,h=e[a].t,f=n[a].d,d=e[a].d,p=Dh[u],v=Dh[h],g=void 0;if(E3(u,h)){var c=Pv([n[a]],[e[a]]);o.push(c[0]),s.push(c[1]),l.push(["matrix",[c[2]]]);continue}else if(u===h)g=u;else if(p[2]&&v[2]&&Mv(u)===Mv(h))g=Mv(u),f=p[2](f),d=v[2](d);else if(p[1]&&v[1]&&Cv(u)===Cv(h))g=Cv(u),f=p[1](f),d=v[1](d);else{var c=Pv(n,e);o=[c[0]],s=[c[1]],l=[["matrix",[c[2]]]];break}for(var m=[],x=[],_=[],S=0;S<f.length;S++){var c=qk(f[S],d[S],t,!1,S);m[S]=c[0],x[S]=c[1],_.push(c[2])}o.push(m),s.push(x),l.push([g,_])}if(r){var b=o;o=s,s=b}return[o,s,function(y){return y.map(function(E,w){var M=E.map(function(P,A){return l[w][1][A](P)}).join(",");return l[w][0]==="matrix"&&M.split(",").length===16&&(l[w][0]="matrix3d"),l[w][0]==="matrix3d"&&M.split(",").length===6&&(l[w][0]="matrix"),l[w][0]+"("+M+")"}).join(" ")}]}var vb=Kn(function(n){if(ue(n)){if(n==="text-anchor")return[ze(0,"px"),ze(0,"px")];var e=n.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[Zs(Bh(e[0])),Zs(Bh(e[1]))]}else return[ze(n[0]||0,"px"),ze(n[1]||0,"px")]}),_3=function(n){if(ue(n)){if(n==="text-anchor")return[ze(0,"px"),ze(0,"px")];var e=n.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[sc(Bh(e[0])),sc(Bh(e[1]))]}else return[ze(n[0]||0,"px"),ze(n[1]||0,"px")]};function Bh(n){return n==="center"?"50%":n==="left"||n==="top"?"0%":n==="right"||n==="bottom"?"100%":n}var Av=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:wt.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:wt.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:wt.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:wt.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:wt.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:wt.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:wt.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:wt.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:wt.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:wt.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:wt.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:wt.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:wt.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:wt.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:wt.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:wt.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:wt.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:wt.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:wt.FILTER},{n:"clipPath",syntax:wt.DEFINED_PATH},{n:"textPath",syntax:wt.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:wt.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:wt.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:wt.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:wt.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:wt.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:wt.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:wt.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:wt.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:wt.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:wt.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:wt.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:wt.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:wt.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:wt.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:wt.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:wt.COORDINATE},{n:"y1",int:!0,l:!0,syntax:wt.COORDINATE},{n:"z1",int:!0,l:!0,syntax:wt.COORDINATE},{n:"x2",int:!0,l:!0,syntax:wt.COORDINATE},{n:"y2",int:!0,l:!0,syntax:wt.COORDINATE},{n:"z2",int:!0,l:!0,syntax:wt.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:wt.PATH,p:50},{n:"points",int:!0,l:!0,syntax:wt.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:wt.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:wt.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:wt.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:wt.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:wt.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:wt.NUMBER,d:function(n){return n===Rt.PATH||n===Rt.POLYGON||n===Rt.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:wt.MARKER},{n:"markerEnd",syntax:wt.MARKER},{n:"markerMid",syntax:wt.MARKER},{n:"markerStartOffset",syntax:wt.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:wt.LENGTH,l:!0,int:!0,d:"0"}],gb=Av.filter(function(n){return!!n.l}).map(function(n){return n.n}),ao={},Js=new WeakMap,S3=function(n,e){var t=Js.get(n);return!t||t.length===0?!0:t.includes(e)},T3=function(){function n(e){var t=this;this.runtime=e,Av.forEach(function(r){t.registerMetadata(r)})}return n.prototype.registerMetadata=function(e){K([e.n],C(e.a||[]),!1).forEach(function(t){ao[t]=e})},n.prototype.unregisterMetadata=function(e){delete ao[e]},n.prototype.getPropertySyntax=function(e){return this.runtime.CSSPropertySyntaxFactory[e]},n.prototype.processProperties=function(e,t,r){var i=this;if(r===void 0&&(r={skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0}),this.runtime.enableCSSParsing){var u=r.skipUpdateAttribute,h=r.skipParse,f=r.forceUpdateGeometry,d=r.usedAttributes,p=r.memoize,v=f,g=Object.keys(t);g.forEach(function(m){var x;u||(e.attributes[m]=t[m]),!v&&(!((x=ao[m])===null||x===void 0)&&x.l)&&(v=!0)}),h||g.forEach(function(m){e.computedStyle[m]=i.parseProperty(m,e.attributes[m],e,p)}),d!=null&&d.length&&(g=Array.from(new Set(g.concat(d)))),g.forEach(function(m){m in e.computedStyle&&(e.parsedStyle[m]=i.computeProperty(m,e.computedStyle[m],e,p))}),v&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e)),g.forEach(function(m){m in e.parsedStyle&&i.postProcessProperty(m,e,g)}),this.runtime.enableCSSParsing&&e.children.length&&g.forEach(function(m){m in e.parsedStyle&&i.isPropertyInheritable(m)&&e.children.forEach(function(x){x.internalSetAttribute(m,null,{skipUpdateAttribute:!0,skipParse:!0})})})}else{Object.assign(e.attributes,t);var a=Object.keys(t),o=e.parsedStyle.clipPath,s=e.parsedStyle.offsetPath;e.parsedStyle=Object.assign(e.parsedStyle,t);var l=!!r.forceUpdateGeometry;if(!l){for(var c=0;c<gb.length;c++)if(gb[c]in t){l=!0;break}}t.fill&&(e.parsedStyle.fill=Ks(t.fill)),t.stroke&&(e.parsedStyle.stroke=Ks(t.stroke)),t.shadowColor&&(e.parsedStyle.shadowColor=Ks(t.shadowColor)),t.filter&&(e.parsedStyle.filter=tb(t.filter)),Mt(t.radius)||(e.parsedStyle.radius=Jx(t.radius,4)),Mt(t.lineDash)||(e.parsedStyle.lineDash=Jx(t.lineDash,2)),t.points&&(e.parsedStyle.points=hb(t.points)),t.d===""&&(e.parsedStyle.d=N({},jx)),t.d&&(e.parsedStyle.d=Tv(t.d)),t.textTransform&&this.runtime.CSSPropertySyntaxFactory["<text-transform>"].calculator(null,null,{value:t.textTransform},e,null),Nt(t.clipPath)||this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("clipPath",o,t.clipPath,e,this.runtime),t.offsetPath&&this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("offsetPath",s,t.offsetPath,e,this.runtime),t.transform&&(e.parsedStyle.transform=fb(t.transform)),t.transformOrigin&&(e.parsedStyle.transformOrigin=vb(t.transformOrigin)),t.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,t.markerStart,t.markerStart,null,null)),t.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,t.markerEnd,t.markerEnd,null,null)),t.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator("",t.markerMid,t.markerMid,null,null)),Mt(t.zIndex)||this.runtime.CSSPropertySyntaxFactory["<z-index>"].postProcessor(e,a),Mt(t.offsetDistance)||this.runtime.CSSPropertySyntaxFactory["<offset-distance>"].postProcessor(e,a),t.transform&&this.runtime.CSSPropertySyntaxFactory["<transform>"].postProcessor(e,a),t.transformOrigin&&this.runtime.CSSPropertySyntaxFactory["<transform-origin>"].postProcessor(e,a),l&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e))}},n.prototype.parseProperty=function(e,t,r,i){var a=ao[e],o=t;if((t===""||Mt(t))&&(t="unset"),t==="unset"||t==="initial"||t==="inherit")o=xv(t);else if(a){var s=a.k,l=a.syntax,c=l&&this.getPropertySyntax(l);s&&s.indexOf(t)>-1?o=xv(t):c&&(!i&&c.parserUnmemoize?o=c.parserUnmemoize(t,r):c.parser&&(o=c.parser(t,r)))}return o},n.prototype.computeProperty=function(e,t,r,i){var a=ao[e],o=r.id==="g-root",s=t;if(a){var l=a.syntax,c=a.inh,u=a.d;if(t instanceof Vr){var h=t.value;if(h==="unset"&&(c&&!o?h="inherit":h="initial"),h==="initial")Mt(u)||(t=this.parseProperty(e,js(u)?u(r.nodeName):u,r,i));else if(h==="inherit"){var f=this.tryToResolveProperty(r,e,{inherited:!0});if(Mt(f)){this.addUnresolveProperty(r,e);return}else return f}}var d=l&&this.getPropertySyntax(l);if(d&&d.calculator){var p=r.parsedStyle[e];s=d.calculator(e,p,t,r,this.runtime)}else t instanceof Vr?s=t.value:s=t}return s},n.prototype.postProcessProperty=function(e,t,r){var i=ao[e];if(i&&i.syntax){var a=i.syntax&&this.getPropertySyntax(i.syntax),o=a;o&&o.postProcessor&&o.postProcessor(t,r)}},n.prototype.addUnresolveProperty=function(e,t){var r=Js.get(e);r||(Js.set(e,[]),r=Js.get(e)),r.indexOf(t)===-1&&r.push(t)},n.prototype.tryToResolveProperty=function(e,t,r){r===void 0&&(r={});var i=r.inherited;if(i&&e.parentElement&&S3(e.parentElement,t)){var a=e.parentElement.parsedStyle[t];return a==="unset"||a==="initial"||a==="inherit"?void 0:a}},n.prototype.recalc=function(e){var t=Js.get(e);if(t&&t.length){var r={};t.forEach(function(i){r[i]=e.attributes[i]}),this.processProperties(e,r),Js.delete(e)}},n.prototype.updateGeometry=function(e){var t=e.nodeName,r=this.runtime.geometryUpdaterFactory[t];if(r){var i=e.geometry;i.contentBounds||(i.contentBounds=new lr),i.renderBounds||(i.renderBounds=new lr);var a=e.parsedStyle,o=r.update(a,e),s=o.cx,l=s===void 0?0:s,c=o.cy,u=c===void 0?0:c,h=o.cz,f=h===void 0?0:h,d=o.hwidth,p=d===void 0?0:d,v=o.hheight,g=v===void 0?0:v,m=o.hdepth,x=m===void 0?0:m,_=[Math.abs(p),Math.abs(g),x],S=a,b=S.stroke,y=S.lineWidth,E=y===void 0?1:y,w=S.increasedLineWidthForHitTesting,M=w===void 0?0:w,P=S.shadowType,A=P===void 0?"outer":P,O=S.shadowColor,R=S.filter,L=R===void 0?[]:R,z=S.transformOrigin,Y=[l,u,f];i.contentBounds.update(Y,_);var I=t===Rt.POLYLINE||t===Rt.POLYGON||t===Rt.PATH?Math.SQRT2:.5,Z=b&&!b.isNone;if(Z){var J=((E||0)+(M||0))*I;_[0]+=J,_[1]+=J}if(i.renderBounds.update(Y,_),O&&A&&A!=="inner"){var mt=i.renderBounds,It=mt.min,ae=mt.max,ve=a,Hn=ve.shadowBlur,rr=ve.shadowOffsetX,rn=ve.shadowOffsetY,He=Hn||0,hn=rr||0,dr=rn||0,an=It[0]-He+hn,pr=ae[0]+He+hn,bo=It[1]-He+dr,Rc=ae[1]+He+dr;It[0]=Math.min(It[0],an),ae[0]=Math.max(ae[0],pr),It[1]=Math.min(It[1],bo),ae[1]=Math.max(ae[1],Rc),i.renderBounds.setMinMax(It,ae)}L.forEach(function(_o){var So=_o.name,Jr=_o.params;if(So==="blur"){var To=Jr[0].value;i.renderBounds.update(i.renderBounds.center,Ah(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[To,To,0]))}else if(So==="drop-shadow"){var Po=Jr[0].value,Mo=Jr[1].value,Qr=Jr[2].value,Co=i.renderBounds,xn=Co.min,bn=Co.max,Ic=xn[0]-Qr+Po,Dc=bn[0]+Qr+Po,Bc=xn[1]-Qr+Mo,Fc=bn[1]+Qr+Mo;xn[0]=Math.min(xn[0],Ic),bn[0]=Math.max(bn[0],Dc),xn[1]=Math.min(xn[1],Bc),bn[1]=Math.max(bn[1],Fc),i.renderBounds.setMinMax(xn,bn)}}),e.geometry.dirty=!1;var kc=p<0,Lc=g<0,Eo=(kc?-1:1)*(z?ui(z[0],0,e,!0):0),wo=(Lc?-1:1)*(z?ui(z[1],1,e,!0):0);(Eo||wo)&&e.setOrigin(Eo,wo)}},n.prototype.updateSizeAttenuation=function(e,t){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/t,e.nodeName===Rt.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/t)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===Rt.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR))},n.prototype.isPropertyInheritable=function(e){var t=ao[e];return t?t.inh:!1},n}(),P3=function(){function n(){this.parser=qx,this.parserUnmemoize=Ev,this.parserWithCSSDisabled=null,this.mixer=wv}return n.prototype.calculator=function(e,t,r,i){return Hr(r)},n}(),M3=function(){function n(){}return n.prototype.calculator=function(e,t,r,i,a){return r instanceof Vr&&(r=null),a.sceneGraphService.updateDisplayObjectDependency(e,t,r,i),e==="clipPath"&&i.forEach(function(o){o.childNodes.length===0&&a.sceneGraphService.dirtifyToRoot(o)}),r},n}(),C3=function(){function n(){this.parser=Ks,this.parserWithCSSDisabled=Ks,this.mixer=$k}return n.prototype.calculator=function(e,t,r,i){return r instanceof Vr?r.value==="none"?Rh:Xx:r},n}(),A3=function(){function n(){this.parser=tb}return n.prototype.calculator=function(e,t,r){return r instanceof Vr?[]:r},n}();function mb(n){var e=n.parsedStyle.fontSize;return Mt(e)?null:e}var Ov=function(){function n(){this.parser=Zs,this.parserUnmemoize=sc,this.parserWithCSSDisabled=null,this.mixer=wv}return n.prototype.calculator=function(e,t,r,i,a){var o;if(fe(r))return r;if(Ie.isRelativeUnit(r.unit)){var s=a.styleValueRegistry;if(r.unit===xt.kPercentage)return 0;if(r.unit===xt.kEms){if(i.parentNode){var l=mb(i.parentNode);if(l)return l*=r.value,l;s.addUnresolveProperty(i,e)}else s.addUnresolveProperty(i,e);return 0}else if(r.unit===xt.kRems){if(!((o=i==null?void 0:i.ownerDocument)===null||o===void 0)&&o.documentElement){var l=mb(i.ownerDocument.documentElement);if(l)return l*=r.value,l;s.addUnresolveProperty(i,e)}else s.addUnresolveProperty(i,e);return 0}}else return r.value},n}(),O3=function(){function n(){this.mixer=nb}return n.prototype.parser=function(e){var t=Qx(fe(e)?[e]:e),r;return t.length===1?r=[t[0],t[0]]:r=[t[0],t[1]],r},n.prototype.calculator=function(e,t,r){return r.map(function(i){return i.value})},n}(),N3=function(){function n(){this.mixer=nb}return n.prototype.parser=function(e){var t=Qx(fe(e)?[e]:e),r;return t.length===1?r=[t[0],t[0],t[0],t[0]]:t.length===2?r=[t[0],t[1],t[0],t[1]]:t.length===3?r=[t[0],t[1],t[2],t[1]]:r=[t[0],t[1],t[2],t[3]],r},n.prototype.calculator=function(e,t,r){return r.map(function(i){return i.value})},n}(),R3=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){r instanceof Vr&&(r=null);var a=r==null?void 0:r.cloneNode(!0);return a&&(a.style.isMarker=!0),a},n}(),k3=function(){function n(){this.mixer=wv,this.parser=Yo,this.parserUnmemoize=qs,this.parserWithCSSDisabled=null}return n.prototype.calculator=function(e,t,r){return r.value},n}(),L3=function(){function n(){this.parser=Yo,this.parserUnmemoize=qs,this.parserWithCSSDisabled=null,this.mixer=_v(0,1)}return n.prototype.calculator=function(e,t,r){return r.value},n.prototype.postProcessor=function(e){var t=e.parsedStyle,r=t.offsetPath,i=t.offsetDistance;if(r){var a=r.nodeName;if(a===Rt.LINE||a===Rt.PATH||a===Rt.POLYLINE){var o=r.getPoint(i);o&&e.setLocalPosition(o.x,o.y)}}},n}(),I3=function(){function n(){this.parser=Yo,this.parserUnmemoize=qs,this.parserWithCSSDisabled=null,this.mixer=_v(0,1)}return n.prototype.calculator=function(e,t,r){return r.value},n}(),D3=function(){function n(){this.parser=Tv,this.parserWithCSSDisabled=Tv,this.mixer=f3}return n.prototype.calculator=function(e,t,r){return r instanceof Vr&&r.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Ho(0,0,0,0)}:r},n}(),B3=function(){function n(){this.parser=hb,this.mixer=d3}return n}(),F3=function(n){B(e,n);function e(){var t=n.apply(this,K([],C(arguments),!1))||this;return t.mixer=_v(0,1/0),t}return e}(Ov),G3=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){return r instanceof Vr?r.value==="unset"?"":r.value:"".concat(r)},n.prototype.postProcessor=function(e){e.nodeValue="".concat(e.parsedStyle.text)||""},n}(),z3=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){var a=i.getAttribute("text");if(a){var o=a;r.value==="capitalize"?o=a.charAt(0).toUpperCase()+a.slice(1):r.value==="lowercase"?o=a.toLowerCase():r.value==="uppercase"&&(o=a.toUpperCase()),i.parsedStyle.text=o}return r.value},n}(),Nv={},W3=0;function U3(n,e){if(n){var t=typeof n=="string"?n:n.id||W3++;Nv[t]&&Nv[t].destroy(),Nv[t]=e}}var Rv=typeof window!="undefined"&&typeof window.document!="undefined";function V3(n){return!!n.getAttribute}function H3(n,e){for(var t=0,r=n.length;t<r;){var i=t+r>>>1;yb(n[i],e)<0?t=i+1:r=i}return t}function yb(n,e){var t=Number(n.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(t===r){var i=n.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(n)-a.indexOf(e)}}return t-r}function Y3(n){var e,t=n;do{var r=(e=t.parsedStyle)===null||e===void 0?void 0:e.clipPath;if(r)return t;t=t.parentElement}while(t!==null);return null}var xb="px";function IU(n,e,t){Rv&&n.style&&(n.style.width=e+xb,n.style.height=t+xb)}function bb(n,e){if(Rv)return document.defaultView.getComputedStyle(n,null).getPropertyValue(e)}function X3(n){var e=bb(n,"width");return e==="auto"?n.offsetWidth:parseFloat(e)}function j3(n){var e=bb(n,"height");return e==="auto"?n.offsetHeight:parseFloat(e)}var $3=1,K3={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},kv=typeof performance=="object"&&performance.now?performance:Date;function DU(n,e,t){n===void 0&&(n="auto");var r=!1,i=!1,a=!!e&&!e.isNone,o=!!t&&!t.isNone;return n==="visiblepainted"||n==="painted"||n==="auto"?(r=a,i=o):n==="visiblefill"||n==="fill"?r=!0:n==="visiblestroke"||n==="stroke"?i=!0:(n==="visible"||n==="all")&&(r=!0,i=!0),[r,i]}var Z3=1,q3=function(){return Z3++},la=typeof self=="object"&&self.self==self?self:typeof D.g=="object"&&D.g.global==D.g?D.g:{},J3=Date.now(),Q3=function(){return la.performance&&typeof la.performance.now=="function"?la.performance.now():Date.now()-J3},lc={},Eb=Date.now(),tL=function(n){if(typeof n!="function")throw new TypeError(n+" is not a function");var e=Date.now(),t=e-Eb,r=t>16?0:16-t,i=q3();return lc[i]=n,Object.keys(lc).length>1||setTimeout(function(){Eb=e;var a=lc;lc={},Object.keys(a).forEach(function(o){return a[o](Q3())})},r),i},eL=function(n){delete lc[n]},nL=["","webkit","moz","ms","o"],wb=function(n){return typeof n!="string"?tL:n===""?la.requestAnimationFrame:la[n+"RequestAnimationFrame"]},rL=function(n){return typeof n!="string"?eL:n===""?la.cancelAnimationFrame:la[n+"CancelAnimationFrame"]||la[n+"CancelRequestAnimationFrame"]},iL=function(n,e){for(var t=0;n[t]!==void 0;){if(e(n[t]))return n[t];t=t+1}},_b=iL(nL,function(n){return!!wb(n)}),Lv=wb(_b),Sb=rL(_b);la.requestAnimationFrame=Lv,la.cancelAnimationFrame=Sb;var aL=function(){function n(){this.callbacks=[]}return n.prototype.getCallbacksNum=function(){return this.callbacks.length},n.prototype.tapPromise=function(e,t){this.callbacks.push(t)},n.prototype.promise=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Promise.all(this.callbacks.map(function(r){return r.apply(void 0,K([],C(e),!1))}))},n}(),oL=function(){function n(){this.callbacks=[]}return n.prototype.tapPromise=function(e,t){this.callbacks.push(t)},n.prototype.promise=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return j(this,void 0,void 0,function(){var r,i,a,o;return gt(this,function(s){switch(s.label){case 0:return this.callbacks.length?[4,(o=this.callbacks)[0].apply(o,K([],C(e),!1))]:[3,6];case 1:r=s.sent(),i=0,s.label=2;case 2:return i<this.callbacks.length-1?(a=this.callbacks[i],[4,a(r)]):[3,5];case 3:r=s.sent(),s.label=4;case 4:return i++,[3,2];case 5:return[2,r];case 6:return[2,null]}})})},n}(),Tr=function(){function n(){this.callbacks=[]}return n.prototype.tap=function(e,t){this.callbacks.push(t)},n.prototype.call=function(){var e=arguments;this.callbacks.forEach(function(t){t.apply(void 0,e)})},n}(),Iv=function(){function n(){this.callbacks=[]}return n.prototype.tap=function(e,t){this.callbacks.push(t)},n.prototype.call=function(){if(this.callbacks.length){for(var e=arguments,t=this.callbacks[0].apply(void 0,e),r=0;r<this.callbacks.length-1;r++){var i=this.callbacks[r];t=i(t)}return t}return null},n}(),sL=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],lL=/([\"\'])[^\'\"]+\1/;function cL(n){for(var e=n.fontSize,t=e===void 0?16:e,r=n.fontFamily,i=r===void 0?"sans-serif":r,a=n.fontStyle,o=a===void 0?"normal":a,s=n.fontVariant,l=s===void 0?"normal":s,c=n.fontWeight,u=c===void 0?"normal":c,h=fe(t)&&"".concat(t,"px")||"16px",f=i.split(","),d=f.length-1;d>=0;d--){var p=f[d].trim();!lL.test(p)&&sL.indexOf(p)<0&&(p='"'.concat(p,'"')),f[d]=p}return"".concat(o," ").concat(l," ").concat(u," ").concat(h," ").concat(f.join(","))}function Dv(n,e,t){return Xt(n),n[4]=Math.tan(e),n[1]=Math.tan(t),n}var cc=1e-5,uL=Q(),Nn=Q();function hL(n,e){if(n.length){var t=Xt(uL);n.forEach(function(r){var i=r.t,a=r.d;if(i==="scale"){var o=(a==null?void 0:a.map(function(m){return Math.max(m.value,cc)}))||[1,1];Ae(Nn,[o[0],o[1],1])}else if(i==="scalex"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,cc)}))||[1];Ae(Nn,[o[0],1,1])}else if(i==="scaley"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,cc)}))||[1];Ae(Nn,[1,o[0],1])}else if(i==="scalez"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,cc)}))||[1];Ae(Nn,[1,1,o[0]])}else if(i==="scale3d"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,cc)}))||[1,1,1];Ae(Nn,[o[0],o[1],o[2]])}else if(i==="translate"){var s=a||[Sn,Sn];ce(Nn,[s[0].value,s[1].value,0])}else if(i==="translatex"){var s=a||[Sn];ce(Nn,[s[0].value,0,0])}else if(i==="translatey"){var s=a||[Sn];ce(Nn,[0,s[0].value,0])}else if(i==="translatez"){var s=a||[Sn];ce(Nn,[0,0,s[0].value])}else if(i==="translate3d"){var s=a||[Sn,Sn,Sn];ce(Nn,[s[0].value,s[1].value,s[2].value])}else if(i==="rotate"){var l=a||[Ri];ti(Nn,ke(Hr(l[0])))}else if(i==="rotatex"){var l=a||[Ri];re(Nn,ke(Hr(l[0])))}else if(i==="rotatey"){var l=a||[Ri];je(Nn,ke(Hr(l[0])))}else if(i==="rotatez"){var l=a||[Ri];ti(Nn,ke(Hr(l[0])))}else if(i==="rotate3d"){var l=a||[Sn,Sn,Sn,Ri];Or(Nn,ke(Hr(l[3])),[l[0].value,l[1].value,l[2].value])}else if(i==="skew"){var c=(a==null?void 0:a.map(function(m){return m.value}))||[0,0];Dv(Nn,ke(c[0]),ke(c[1]))}else if(i==="skewx"){var c=(a==null?void 0:a.map(function(x){return x.value}))||[0];Dv(Nn,ke(c[0]),0)}else if(i==="skewy"){var c=(a==null?void 0:a.map(function(x){return x.value}))||[0];Dv(Nn,0,ke(c[0]))}else if(i==="matrix"){var u=C(a.map(function(m){return m.value}),6),h=u[0],f=u[1],d=u[2],p=u[3],v=u[4],g=u[5];ne(Nn,h,f,0,0,d,p,0,0,0,0,1,0,v,g,0,1)}else i==="matrix3d"&&ne.apply(G,K([Nn],C(a.map(function(m){return m.value})),!1));Yc(t,t,Nn)}),e.setLocalTransform(t)}else e.resetLocalTransform();return e.getLocalTransform()}var fL=function(){function n(){this.parser=fb,this.parserUnmemoize=db,this.parserWithCSSDisabled=db,this.mixer=w3}return n.prototype.calculator=function(e,t,r,i){return r instanceof Vr?[]:r},n.prototype.postProcessor=function(e){var t=e.parsedStyle.transform;hL(t,e)},n}(),dL=function(){function n(){this.parser=vb,this.parserUnmemoize=_3}return n.prototype.postProcessor=function(e){var t=e.parsedStyle.transformOrigin;t[0].unit===xt.kPixels&&t[1].unit===xt.kPixels?e.setOrigin(t[0].value,t[1].value):e.getGeometryBounds()},n}(),pL=function(){function n(){this.parser=Yo,this.parserUnmemoize=qs}return n.prototype.calculator=function(e,t,r,i){return r.value},n.prototype.postProcessor=function(e){if(e.parentNode){var t=e.parentNode,r=t.renderable,i=t.sortable;r&&(r.dirty=!0),i&&(i.dirty=!0,i.dirtyReason=$s.Z_INDEX_CHANGED)}},n}(),vL=function(){function n(){}return n.prototype.update=function(e,t){var r=e.cx,i=r===void 0?0:r,a=e.cy,o=a===void 0?0:a,s=e.r,l=s===void 0?0:s;return{cx:i,cy:o,hwidth:l,hheight:l}},n}(),gL=function(){function n(){}return n.prototype.update=function(e,t){var r=e.cx,i=r===void 0?0:r,a=e.cy,o=a===void 0?0:a,s=e.rx,l=s===void 0?0:s,c=e.ry,u=c===void 0?0:c;return{cx:i,cy:o,hwidth:l,hheight:u}},n}(),mL=function(){function n(){}return n.prototype.update=function(e){var t=e.x1,r=e.y1,i=e.x2,a=e.y2,o=Math.min(t,i),s=Math.max(t,i),l=Math.min(r,a),c=Math.max(r,a),u=s-o,h=c-l,f=u/2,d=h/2;return{cx:o+f,cy:l+d,hwidth:f,hheight:d}},n}(),yL=function(){function n(){}return n.prototype.update=function(e){var t=e.d,r=t.rect,i=r.x,a=r.y,o=r.width,s=r.height,l=o/2,c=s/2;return{cx:i+l,cy:a+c,hwidth:l,hheight:c}},n}(),xL=function(){function n(){}return n.prototype.update=function(e){if(e.points&&xr(e.points.points)){var t=e.points.points,r=Math.min.apply(Math,K([],C(t.map(function(h){return h[0]})),!1)),i=Math.max.apply(Math,K([],C(t.map(function(h){return h[0]})),!1)),a=Math.min.apply(Math,K([],C(t.map(function(h){return h[1]})),!1)),o=Math.max.apply(Math,K([],C(t.map(function(h){return h[1]})),!1)),s=i-r,l=o-a,c=s/2,u=l/2;return{cx:r+c,cy:a+u,hwidth:c,hheight:u}}return{cx:0,cy:0,hwidth:0,hheight:0}},n}(),bL=function(){function n(){}return n.prototype.update=function(e,t){var r=e.x,i=r===void 0?0:r,a=e.y,o=a===void 0?0:a,s=e.src,l=e.width,c=l===void 0?0:l,u=e.height,h=u===void 0?0:u,f=c,d=h;return s&&!ue(s)&&(f||(f=s.width,e.width=f),d||(d=s.height,e.height=d)),{cx:i+f/2,cy:o+d/2,hwidth:f/2,hheight:d/2}},n}(),EL=function(){function n(e){this.globalRuntime=e}return n.prototype.isReadyToMeasure=function(e,t){var r=e.text,i=e.textAlign,a=e.textBaseline,o=e.fontSize,s=e.fontStyle,l=e.fontWeight,c=e.fontVariant,u=e.lineWidth;return rt.enableCSSParsing?r&&o&&s&&l&&c&&i&&a&&!Mt(u):r},n.prototype.update=function(e,t){var r,i,a=e.text,o=e.textAlign,s=o===void 0?"start":o,l=e.lineWidth,c=l===void 0?1:l,u=e.textBaseline,h=u===void 0?"alphabetic":u,f=e.dx,d=f===void 0?0:f,p=e.dy,v=p===void 0?0:p,g=e.x,m=g===void 0?0:g,x=e.y,_=x===void 0?0:x;if(!this.isReadyToMeasure(e,t))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var S=(((i=(r=t==null?void 0:t.ownerDocument)===null||r===void 0?void 0:r.defaultView)===null||i===void 0?void 0:i.getConfig())||{}).offscreenCanvas,b=this.globalRuntime.textService.measureText(a,e,S);e.metrics=b;var y=b.width,E=b.height,w=b.lineHeight,M=b.fontProperties,P=y/2,A=E/2,O=m+P;s==="center"||s==="middle"?O+=c/2-P:(s==="right"||s==="end")&&(O+=c-P*2);var R=_-A;return h==="middle"?R+=A:h==="top"||h==="hanging"?R+=A*2:h==="alphabetic"?R+=this.globalRuntime.enableCSSParsing?w-M.ascent:0:(h==="bottom"||h==="ideographic")&&(R+=0),d&&(O+=d),v&&(R+=v),{cx:O,cy:R,hwidth:P,hheight:A}},n}(),wL=function(){function n(){}return n.prototype.update=function(e,t){return{cx:0,cy:0,hwidth:0,hheight:0}},n}();function _L(n){return!!n.type}var Fh=function(){function n(e){this.eventPhase=n.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new cr,this.page=new cr,this.canvas=new cr,this.viewport=new cr,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}return Object.defineProperty(n.prototype,"name",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layerX",{get:function(){return this.layer.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layerY",{get:function(){return this.layer.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageX",{get:function(){return this.page.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageY",{get:function(){return this.page.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"x",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasX",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasY",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewportX",{get:function(){return this.viewport.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewportY",{get:function(){return this.viewport.y},enumerable:!1,configurable:!0}),n.prototype.composedPath=function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},Object.defineProperty(n.prototype,"propagationPath",{get:function(){return this.composedPath()},enumerable:!1,configurable:!0}),n.prototype.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},n.prototype.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},n.prototype.stopPropagation=function(){this.propagationStopped=!0},n.prototype.initEvent=function(){},n.prototype.initUIEvent=function(){},n.prototype.clone=function(){throw new Error(Le)},n}(),Tb=function(n){B(e,n);function e(){var t=n.apply(this,K([],C(arguments),!1))||this;return t.client=new cr,t.movement=new cr,t.offset=new cr,t.global=new cr,t.screen=new cr,t}return Object.defineProperty(e.prototype,"clientX",{get:function(){return this.client.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientY",{get:function(){return this.client.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementX",{get:function(){return this.movement.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementY",{get:function(){return this.movement.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetX",{get:function(){return this.offset.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetY",{get:function(){return this.offset.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalX",{get:function(){return this.global.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalY",{get:function(){return this.global.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenX",{get:function(){return this.screen.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenY",{get:function(){return this.screen.y},enumerable:!1,configurable:!0}),e.prototype.getModifierState=function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)},e.prototype.initMouseEvent=function(){throw new Error(Le)},e}(Fh),Bv=function(n){B(e,n);function e(){var t=n.apply(this,K([],C(arguments),!1))||this;return t.width=0,t.height=0,t.isPrimary=!1,t}return e.prototype.getCoalescedEvents=function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]},e.prototype.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},e.prototype.clone=function(){return this.manager.clonePointerEvent(this)},e}(Tb),Fv=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.clone=function(){return this.manager.cloneWheelEvent(this)},e}(Tb),Fn=function(n){B(e,n);function e(t,r){var i=n.call(this,null)||this;return i.type=t,i.detail=r,Object.assign(i,r),i}return e}(Fh),Pb=":",Mb=function(){function n(){this.emitter=new et}return n.prototype.on=function(e,t,r){return this.addEventListener(e,t,r),this},n.prototype.addEventListener=function(e,t,r){var i=ds(r)&&r||dn(r)&&r.capture,a=dn(r)&&r.once,o=js(t)?void 0:t,s=!1,l="";if(e.indexOf(Pb)>-1){var c=C(e.split(Pb),2),u=c[0],h=c[1];e=h,l=u,s=!0}if(e=i?"".concat(e,"capture"):e,t=js(t)?t:t.handleEvent,s){var f=t;t=function(){for(var d,p=[],v=0;v<arguments.length;v++)p[v]=arguments[v];((d=p[0].target)===null||d===void 0?void 0:d.name)===l&&f.apply(void 0,K([],C(p),!1))}}return a?this.emitter.once(e,t,o):this.emitter.on(e,t,o),this},n.prototype.off=function(e,t,r){return e?this.removeEventListener(e,t,r):this.removeAllEventListeners(),this},n.prototype.removeAllEventListeners=function(){this.emitter.removeAllListeners()},n.prototype.removeEventListener=function(e,t,r){var i=ds(r)&&r||dn(r)&&r.capture,a=js(t)?void 0:t;return e=i?"".concat(e,"capture"):e,t=js(t)?t:t==null?void 0:t.handleEvent,this.emitter.off(e,t,a),this},n.prototype.emit=function(e,t){this.dispatchEvent(new Fn(e,t))},n.prototype.dispatchEvent=function(e,t){var r,i;if(t===void 0&&(t=!1),!_L(e))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var a;if(this.document?a=this:this.defaultView?a=this.defaultView:a=(r=this.ownerDocument)===null||r===void 0?void 0:r.defaultView,a){if(e.manager=a.getEventService()||null,!e.manager)return!1;e.defaultPrevented=!1,e.path=[],t||(e.target=this),(i=e.manager)===null||i===void 0||i.dispatchEvent(e,e.type,t)}return!e.defaultPrevented},n}(),Zn=function(n){B(e,n);function e(){var t=n.call(this)||this;return t.shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return e.isNode=function(t){return!!t.childNodes},Object.defineProperty(e.prototype,"textContent",{get:function(){var t,r,i="";this.nodeName===Rt.TEXT&&(i+=this.style.text);try{for(var a=pt(this.childNodes),o=a.next();!o.done;o=a.next()){var s=o.value;s.nodeName===Rt.TEXT?i+=s.nodeValue:i+=s.textContent}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return i},set:function(t){var r=this;this.childNodes.slice().forEach(function(i){r.removeChild(i)}),this.nodeName===Rt.TEXT&&(this.style.text="".concat(t))},enumerable:!1,configurable:!0}),e.prototype.getRootNode=function(t){return t===void 0&&(t={}),this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this},e.prototype.hasChildNodes=function(){return this.childNodes.length>0},e.prototype.isDefaultNamespace=function(t){throw new Error(Le)},e.prototype.lookupNamespaceURI=function(t){throw new Error(Le)},e.prototype.lookupPrefix=function(t){throw new Error(Le)},e.prototype.normalize=function(){throw new Error(Le)},e.prototype.isEqualNode=function(t){return this===t},e.prototype.isSameNode=function(t){return this.isEqualNode(t)},Object.defineProperty(e.prototype,"parent",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.childNodes.length>0?this.childNodes[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null},enumerable:!1,configurable:!0}),e.prototype.compareDocumentPosition=function(t){var r;if(t===this)return 0;for(var i=t,a=this,o=[i],s=[a];(r=i.parentNode)!==null&&r!==void 0?r:a.parentNode;)i=i.parentNode?(o.push(i.parentNode),i.parentNode):i,a=a.parentNode?(s.push(a.parentNode),a.parentNode):a;if(i!==a)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var l=o.length>s.length?o:s,c=l===o?s:o;if(l[l.length-c.length]===c[0])return l===o?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=l.length-c.length,h=c.length-1;h>=0;h--){var f=c[h],d=l[u+h];if(d!==f){var p=f.parentNode.childNodes;return p.indexOf(f)<p.indexOf(d)?c===o?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:l===o?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING},e.prototype.contain=function(t){return this.contains(t)},e.prototype.contains=function(t){for(var r=t;r&&this!==r;)r=r.parentNode;return!!r},e.prototype.getAncestor=function(t){for(var r=this;t>0&&r;)r=r.parentNode,t--;return r},e.prototype.forEach=function(t,r){r===void 0&&(r=!1),t(this)||(r?this.childNodes.slice():this.childNodes).forEach(function(i){i.forEach(t)})},e.DOCUMENT_POSITION_DISCONNECTED=1,e.DOCUMENT_POSITION_PRECEDING=2,e.DOCUMENT_POSITION_FOLLOWING=4,e.DOCUMENT_POSITION_CONTAINS=8,e.DOCUMENT_POSITION_CONTAINED_BY=16,e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,e}(Mb),SL=2048,TL=function(){function n(e,t){var r=this;this.globalRuntime=e,this.context=t,this.emitter=new et,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=Q(),this.tmpVec3=T.Ue(),this.onPointerDown=function(i){var a=r.createPointerEvent(i);if(r.dispatchEvent(a,"pointerdown"),a.pointerType==="touch")r.dispatchEvent(a,"touchstart");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var o=a.button===2;r.dispatchEvent(a,o?"rightdown":"mousedown")}var s=r.trackingData(i.pointerId);s.pressTargetsByButton[i.button]=a.composedPath(),r.freeEvent(a)},this.onPointerUp=function(i){var a,o=kv.now(),s=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(s,"pointerup"),s.pointerType==="touch")r.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.dispatchEvent(s,l?"rightup":"mouseup")}var c=r.trackingData(i.pointerId),u=r.findMountedTarget(c.pressTargetsByButton[i.button]),h=u;if(u&&!s.composedPath().includes(u)){for(var f=u;f&&!s.composedPath().includes(f);){if(s.currentTarget=f,r.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")r.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.notifyTarget(s,l?"rightupoutside":"mouseupoutside")}Zn.isNode(f)&&(f=f.parentNode)}delete c.pressTargetsByButton[i.button],h=f}if(h){var d=r.clonePointerEvent(s,"click");d.target=h,d.path=[],c.clicksByButton[i.button]||(c.clicksByButton[i.button]={clickCount:0,target:d.target,timeStamp:o});var p=c.clicksByButton[i.button];p.target===d.target&&o-p.timeStamp<200?++p.clickCount:p.clickCount=1,p.target=d.target,p.timeStamp=o,d.detail=p.clickCount,!((a=s.detail)===null||a===void 0)&&a.preventClick||(!r.context.config.useNativeClickEvent&&(d.pointerType==="mouse"||d.pointerType==="touch")&&r.dispatchEvent(d,"click"),r.dispatchEvent(d,"pointertap")),r.freeEvent(d)}r.freeEvent(s)},this.onPointerMove=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),o=a.pointerType==="mouse"||a.pointerType==="pen",s=r.trackingData(i.pointerId),l=r.findMountedTarget(s.overTargets);if(s.overTargets&&l!==a.target){var c=i.type==="mousemove"?"mouseout":"pointerout",u=r.createPointerEvent(i,c,l||void 0);if(r.dispatchEvent(u,"pointerout"),o&&r.dispatchEvent(u,"mouseout"),!a.composedPath().includes(l)){var h=r.createPointerEvent(i,"pointerleave",l||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!a.composedPath().includes(h.target);)h.currentTarget=h.target,r.notifyTarget(h),o&&r.notifyTarget(h,"mouseleave"),Zn.isNode(h.target)&&(h.target=h.target.parentNode);r.freeEvent(h)}r.freeEvent(u)}if(l!==a.target){var f=i.type==="mousemove"?"mouseover":"pointerover",d=r.clonePointerEvent(a,f);r.dispatchEvent(d,"pointerover"),o&&r.dispatchEvent(d,"mouseover");for(var p=l&&Zn.isNode(l)&&l.parentNode;p&&p!==(Zn.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&p!==a.target;)p=p.parentNode;var v=!p||p===(Zn.isNode(r.rootTarget)&&r.rootTarget.parentNode);if(v){var g=r.clonePointerEvent(a,"pointerenter");for(g.eventPhase=g.AT_TARGET;g.target&&g.target!==l&&g.target!==(Zn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)g.currentTarget=g.target,r.notifyTarget(g),o&&r.notifyTarget(g,"mouseenter"),Zn.isNode(g.target)&&(g.target=g.target.parentNode);r.freeEvent(g)}r.freeEvent(d)}r.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&r.dispatchEvent(a,"touchmove"),o&&(r.dispatchEvent(a,"mousemove"),r.cursor=r.getCursor(a.target)),s.overTargets=a.composedPath(),r.freeEvent(a)},this.onPointerOut=function(i){var a=r.trackingData(i.pointerId);if(a.overTargets){var o=i.pointerType==="mouse"||i.pointerType==="pen",s=r.findMountedTarget(a.overTargets),l=r.createPointerEvent(i,"pointerout",s||void 0);r.dispatchEvent(l),o&&r.dispatchEvent(l,"mouseout");var c=r.createPointerEvent(i,"pointerleave",s||void 0);for(c.eventPhase=c.AT_TARGET;c.target&&c.target!==(Zn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)c.currentTarget=c.target,r.notifyTarget(c),o&&r.notifyTarget(c,"mouseleave"),Zn.isNode(c.target)&&(c.target=c.target.parentNode);a.overTargets=null,r.freeEvent(l),r.freeEvent(c)}r.cursor=null},this.onPointerOver=function(i){var a=r.trackingData(i.pointerId),o=r.createPointerEvent(i),s=o.pointerType==="mouse"||o.pointerType==="pen";r.dispatchEvent(o,"pointerover"),s&&r.dispatchEvent(o,"mouseover"),o.pointerType==="mouse"&&(r.cursor=r.getCursor(o.target));var l=r.clonePointerEvent(o,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(Zn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)l.currentTarget=l.target,r.notifyTarget(l),s&&r.notifyTarget(l,"mouseenter"),Zn.isNode(l.target)&&(l.target=l.target.parentNode);a.overTargets=o.composedPath(),r.freeEvent(o),r.freeEvent(l)},this.onPointerUpOutside=function(i){var a=r.trackingData(i.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[i.button]),s=r.createPointerEvent(i);if(o){for(var l=o;l;)s.currentTarget=l,r.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"||(s.pointerType==="mouse"||s.pointerType==="pen")&&r.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),Zn.isNode(l)&&(l=l.parentNode);delete a.pressTargetsByButton[i.button]}r.freeEvent(s)},this.onWheel=function(i){var a=r.createWheelEvent(i);r.dispatchEvent(a),r.freeEvent(a)},this.onClick=function(i){if(r.context.config.useNativeClickEvent){var a=r.createPointerEvent(i);r.dispatchEvent(a),r.freeEvent(a)}},this.onPointerCancel=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(a),r.freeEvent(a)}}return n.prototype.init=function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)},n.prototype.destroy=function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()},n.prototype.getScale=function(){var e=this.context.contextService.getBoundingClientRect(),t=1,r=1,i=this.context.contextService.getDomElement();if(i&&e){var a=i.offsetWidth,o=i.offsetHeight;a&&o&&(t=e.width/a,r=e.height/o)}return{scaleX:t,scaleY:r,bbox:e}},n.prototype.client2Viewport=function(e){var t=this.getScale(),r=t.scaleX,i=t.scaleY,a=t.bbox;return new cr((e.x-((a==null?void 0:a.left)||0))/r,(e.y-((a==null?void 0:a.top)||0))/i)},n.prototype.viewport2Client=function(e){var t=this.getScale(),r=t.scaleX,i=t.scaleY,a=t.bbox;return new cr((e.x+((a==null?void 0:a.left)||0))*r,(e.y+((a==null?void 0:a.top)||0))*i)},n.prototype.viewport2Canvas=function(e){var t=e.x,r=e.y,i=this.rootTarget.defaultView,a=i.getCamera(),o=this.context.config,s=o.width,l=o.height,c=a.getPerspectiveInverse(),u=a.getWorldTransform(),h=Ut(this.tmpMatrix,u,c),f=T.t8(this.tmpVec3,t/s*2-1,(1-r/l)*2-1,0);return T.fF(f,f,h),new cr(f[0],f[1])},n.prototype.canvas2Viewport=function(e){var t=this.rootTarget.defaultView,r=t.getCamera(),i=r.getPerspective(),a=r.getViewTransform(),o=Ut(this.tmpMatrix,i,a),s=T.t8(this.tmpVec3,e.x,e.y,0);T.fF(this.tmpVec3,this.tmpVec3,o);var l=this.context.config,c=l.width,u=l.height;return new cr((s[0]+1)/2*c,(1-(s[1]+1)/2)*u)},n.prototype.setPickHandler=function(e){this.pickHandler=e},n.prototype.addEventMapping=function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(r,i){return r.priority-i.priority})},n.prototype.mapEvent=function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var r=0,i=t.length;r<i;r++)t[r].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type))}},n.prototype.dispatchEvent=function(e,t,r){if(!r)e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t);else{e.eventPhase=e.AT_TARGET;var i=this.rootTarget.defaultView||null;e.currentTarget=i,this.notifyListeners(e,t)}this.emitter.emit(t||e.type,e)},n.prototype.propagate=function(e,t){if(e.target){var r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var i=r.length-1;i>=1;i--)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){var a=r.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var i=a+1;i<r.length;i++)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}},n.prototype.propagationPath=function(e){var t=[e],r=this.rootTarget.defaultView||null;if(r&&r===e)return t.unshift(r.document),t;for(var i=0;i<SL&&e!==this.rootTarget;i++)Zn.isNode(e)&&e.parentNode&&(t.push(e.parentNode),e=e.parentNode);return r&&t.push(r),t},n.prototype.hitTest=function(e){var t=e.viewportX,r=e.viewportY,i=this.context.config,a=i.width,o=i.height,s=i.disableHitTesting;return t<0||r<0||t>a||r>o?null:!s&&this.pickHandler(e)||this.rootTarget||null},n.prototype.isNativeEventFromCanvas=function(e,t){var r=t==null?void 0:t.target;if(r!=null&&r.shadowRoot&&(r=t.composedPath()[0]),r){if(r===e)return!0;if(e&&e.contains)return e.contains(r)}return t!=null&&t.composedPath?t.composedPath().indexOf(e)>-1:!1},n.prototype.getExistedHTML=function(e){var t,r;if(e.nativeEvent.composedPath)try{for(var i=pt(e.nativeEvent.composedPath()),a=i.next();!a.done;a=i.next()){var o=a.value,s=this.nativeHTMLMap.get(o);if(s)return s}}catch(l){t={error:l}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return null},n.prototype.pickTarget=function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY})},n.prototype.createPointerEvent=function(e,t,r,i){var a=this.allocateEvent(Bv);this.copyPointerData(e,a),this.copyMouseData(e,a),this.copyData(e,a),a.nativeEvent=e.nativeEvent,a.originalEvent=e;var o=this.getExistedHTML(a),s=this.context.contextService.getDomElement();return a.target=r!=null?r:o||this.isNativeEventFromCanvas(s,a.nativeEvent)&&this.pickTarget(a)||i,typeof t=="string"&&(a.type=t),a},n.prototype.createWheelEvent=function(e){var t=this.allocateEvent(Fv);this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e;var r=this.getExistedHTML(t),i=this.context.contextService.getDomElement();return t.target=r||this.isNativeEventFromCanvas(i,t.nativeEvent)&&this.pickTarget(t),t},n.prototype.trackingData=function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]},n.prototype.cloneWheelEvent=function(e){var t=this.allocateEvent(Fv);return t.nativeEvent=e.nativeEvent,t.originalEvent=e.originalEvent,this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.target=e.target,t.path=e.composedPath().slice(),t.type=e.type,t},n.prototype.clonePointerEvent=function(e,t){var r=this.allocateEvent(Bv);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=t!=null?t:r.type,r},n.prototype.copyPointerData=function(e,t){t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist},n.prototype.copyMouseData=function(e,t){t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.client.copyFrom(e.client),t.movement.copyFrom(e.movement),t.canvas.copyFrom(e.canvas),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global),t.offset.copyFrom(e.offset)},n.prototype.copyWheelData=function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ},n.prototype.copyData=function(e,t){t.isTrusted=e.isTrusted,t.timeStamp=kv.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.page.copyFrom(e.page),t.viewport.copyFrom(e.viewport)},n.prototype.allocateEvent=function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t},n.prototype.freeEvent=function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)},n.prototype.notifyTarget=function(e,t){t=t!=null?t:e.type;var r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)},n.prototype.notifyListeners=function(e,t){var r=e.currentTarget.emitter,i=r._events[t];if(i)if("fn"in i)i.once&&r.removeListener(t,i.fn,void 0,!0),i.fn.call(e.currentTarget||i.context,e);else for(var a=0;a<i.length&&!e.propagationImmediatelyStopped;a++)i[a].once&&r.removeListener(t,i[a].fn,void 0,!0),i[a].fn.call(e.currentTarget||i[a].context,e)},n.prototype.findMountedTarget=function(e){if(!e)return null;for(var t=e[e.length-1],r=e.length-2;r>=0;r--){var i=e[r];if(i===this.rootTarget||Zn.isNode(i)&&i.parentNode===t)t=e[r];else break}return t},n.prototype.getCursor=function(e){for(var t=e;t;){var r=V3(t)&&t.getAttribute("cursor");if(r)return r;t=Zn.isNode(t)&&t.parentNode}},n}(),PL=function(){function n(){}return n.prototype.getOrCreateCanvas=function(e,t){if(this.canvas)return this.canvas;if(e||rt.offscreenCanvas)this.canvas=e||rt.offscreenCanvas,this.context=this.canvas.getContext("2d",N({willReadFrequently:!0},t));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",N({willReadFrequently:!0},t)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",N({willReadFrequently:!0},t))}return this.canvas.width=10,this.canvas.height=10,this.canvas},n.prototype.getOrCreateContext=function(e,t){return this.context?this.context:(this.getOrCreateCanvas(e,t),this.context)},n}(),Qs;(function(n){n[n.CAMERA_CHANGED=0]="CAMERA_CHANGED",n[n.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",n[n.NONE=2]="NONE"})(Qs||(Qs={}));var ML=function(){function n(e,t){this.globalRuntime=e,this.context=t,this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new Tr,initAsync:new aL,dirtycheck:new Iv,cull:new Iv,beginFrame:new Tr,beforeRender:new Tr,render:new Tr,afterRender:new Tr,endFrame:new Tr,destroy:new Tr,pick:new oL,pickSync:new Iv,pointerDown:new Tr,pointerUp:new Tr,pointerMove:new Tr,pointerOut:new Tr,pointerOver:new Tr,pointerWheel:new Tr,pointerCancel:new Tr,click:new Tr}}return n.prototype.init=function(e){var t=this,r=N(N({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(i){i.apply(r,t.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){t.inited=!0,e()})},n.prototype.getStats=function(){return this.stats},n.prototype.disableDirtyRectangleRendering=function(){var e=this.context.config.renderer,t=e.getConfig().enableDirtyRectangleRendering;return!t||this.context.renderingContext.renderReasons.has(Qs.CAMERA_CHANGED)},n.prototype.render=function(e,t,r){var i=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var a=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=a.renderReasons.size===1&&a.renderReasons.has(Qs.CAMERA_CHANGED),s=!e.disableRenderHooks||!(e.disableRenderHooks&&o);s&&this.renderDisplayObject(a.root,e,a),this.hooks.beginFrame.call(t),s&&a.renderListCurrentFrame.forEach(function(l){i.hooks.beforeRender.call(l),i.hooks.render.call(l),i.hooks.afterRender.call(l)}),this.hooks.endFrame.call(t),a.renderListCurrentFrame=[],a.renderReasons.clear(),r()}},n.prototype.renderDisplayObject=function(e,t,r){var i=this,a=t.renderer.getConfig(),o=a.enableDirtyCheck,s=a.enableCulling;this.globalRuntime.enableCSSParsing&&this.globalRuntime.styleValueRegistry.recalc(e);var l=e.renderable,c=o?l.dirty||r.dirtyRectangleRenderingDisabled?e:null:e;if(c){var u=s?this.hooks.cull.call(c,this.context.camera):c;u&&(this.stats.rendered++,r.renderListCurrentFrame.push(u))}e.renderable.dirty=!1,e.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var h=e.sortable;h.dirty&&(this.sort(e,h),h.dirty=!1,h.dirtyChildren=[],h.dirtyReason=void 0),(h.sorted||e.childNodes).forEach(function(f){i.renderDisplayObject(f,t,r)})},n.prototype.sort=function(e,t){t.sorted&&t.dirtyReason!==$s.Z_INDEX_CHANGED?t.dirtyChildren.forEach(function(r){var i=e.childNodes.indexOf(r);if(i===-1){var a=t.sorted.indexOf(r);a>=0&&t.sorted.splice(a,1)}else if(t.sorted.length===0)t.sorted.push(r);else{var o=H3(t.sorted,r);t.sorted.splice(o,0,r)}}):t.sorted=e.childNodes.slice().sort(yb)},n.prototype.destroy=function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()},n.prototype.dirtify=function(){this.context.renderingContext.renderReasons.add(Qs.DISPLAY_OBJECT_CHANGED)},n}(),CL=/\[\s*(.*)=(.*)\s*\]/,AL=function(){function n(){}return n.prototype.selectOne=function(e,t){var r=this;if(e.startsWith("."))return t.find(function(s){return((s==null?void 0:s.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.find(function(s){return s.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,o=i.value;return a?t.find(function(s){return t!==s&&(a==="name"?s.name===o:r.attributeToString(s,a)===o)}):null}else return t.find(function(s){return t!==s&&s.nodeName===e})},n.prototype.selectAll=function(e,t){var r=this;if(e.startsWith("."))return t.findAll(function(s){return t!==s&&((s==null?void 0:s.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.findAll(function(s){return t!==s&&s.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,o=i.value;return a?t.findAll(function(s){return t!==s&&(a==="name"?s.name===o:r.attributeToString(s,a)===o)}):[]}else return t.findAll(function(s){return t!==s&&s.nodeName===e})},n.prototype.is=function(e,t){if(e.startsWith("."))return t.className===this.getIdOrClassname(e);if(e.startsWith("#"))return t.id===this.getIdOrClassname(e);if(e.startsWith("[")){var r=this.getAttribute(e),i=r.name,a=r.value;return i==="name"?t.name===a:this.attributeToString(t,i)===a}else return t.nodeName===e},n.prototype.getIdOrClassname=function(e){return e.substring(1)},n.prototype.getAttribute=function(e){var t=e.match(CL),r="",i="";return t&&t.length>2&&(r=t[1].replace(/"/g,""),i=t[2].replace(/"/g,"")),{name:r,value:i}},n.prototype.attributeToString=function(e,t){if(!e.getAttribute)return"";var r=e.getAttribute(t);return Mt(r)?"":r.toString?r.toString():""},n}(),oo=function(n){B(e,n);function e(t,r,i,a,o,s,l,c){var u=n.call(this,null)||this;return u.relatedNode=r,u.prevValue=i,u.newValue=a,u.attrName=o,u.attrChange=s,u.prevParsedValue=l,u.newParsedValue=c,u.type=t,u}return e.ADDITION=2,e.MODIFICATION=1,e.REMOVAL=3,e}(Fh),de;(function(n){n.REPARENT="reparent",n.DESTROY="destroy",n.ATTR_MODIFIED="DOMAttrModified",n.INSERTED="DOMNodeInserted",n.REMOVED="removed",n.MOUNTED="DOMNodeInsertedIntoDocument",n.UNMOUNTED="DOMNodeRemovedFromDocument",n.BOUNDS_CHANGED="bounds-changed",n.CULLED="culled"})(de||(de={}));function Cb(n){var e=n.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}var OL=new oo(de.REPARENT,null,"","","",0,"",""),NL=function(){function n(e){var t=this;this.runtime=e,this.pendingEvents=[],this.boundsChangedEvent=new Fn(de.BOUNDS_CHANGED),this.rotate=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=T.al(a,o,s));var c=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)t.rotateLocal(i,a);else{var u=Vt();bi(u,a[0],a[1],a[2]);var h=t.getRotation(i),f=t.getRotation(i.parentNode);Ei(r,f),ga(r,r),Ln(u,r,u),Ln(c.localRotation,u,h),Ga(c.localRotation,c.localRotation),l&&t.dirtifyLocal(i,c)}}}(),this.rotateLocal=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=T.al(a,o,s));var c=i.transformable;bi(r,a[0],a[1],a[2]),os(c.localRotation,c.localRotation,r),l&&t.dirtifyLocal(i,c)}}(),this.setEulerAngles=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=T.al(a,o,s));var c=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)t.setLocalEulerAngles(i,a);else{bi(c.localRotation,a[0],a[1],a[2]);var u=t.getRotation(i.parentNode);Ei(r,ga(Vt(),u)),os(c.localRotation,c.localRotation,r),l&&t.dirtifyLocal(i,c)}}}(),this.translateLocal=function(){return function(r,i,a,o,s){a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=!0),typeof i=="number"&&(i=T.al(i,a,o));var l=r.transformable;T.fS(i,T.Ue())||(T.VC(i,i,l.localRotation),T.IH(l.localPosition,l.localPosition,i),s&&t.dirtifyLocal(r,l))}}(),this.setPosition=function(){var r=Q(),i=T.Ue();return function(a,o,s){s===void 0&&(s=!0);var l=a.transformable;if(i[0]=o[0],i[1]=o[1],i[2]=o[2]||0,!T.fS(t.getPosition(a),i)){if(T.JG(l.position,i),a.parentNode===null||!a.parentNode.transformable)T.JG(l.localPosition,i);else{var c=a.parentNode.transformable;kt(r,c.worldTransform),Wt(r,r),T.fF(l.localPosition,i,r)}s&&t.dirtifyLocal(a,l)}}}(),this.setLocalPosition=function(){var r=T.Ue();return function(i,a,o){o===void 0&&(o=!0);var s=i.transformable;r[0]=a[0],r[1]=a[1],r[2]=a[2]||0,!T.fS(s.localPosition,r)&&(T.JG(s.localPosition,r),o&&t.dirtifyLocal(i,s))}}(),this.translate=function(){var r=T.Ue(),i=T.Ue(),a=T.Ue();return function(o,s,l,c,u){l===void 0&&(l=0),c===void 0&&(c=0),u===void 0&&(u=!0),typeof s=="number"&&(s=T.t8(i,s,l,c)),!T.fS(s,r)&&(T.IH(a,t.getPosition(o),s),t.setPosition(o,a,u))}}(),this.setRotation=function(){var r=Vt();return function(i,a,o,s,l,c){c===void 0&&(c=!0);var u=i.transformable;if(typeof a=="number"&&(a=ma(a,o,s,l)),i.parentNode===null||!i.parentNode.transformable)t.setLocalRotation(i,a);else{var h=t.getRotation(i.parentNode);Ei(r,h),ga(r,r),Ln(u.localRotation,r,a),Ga(u.localRotation,u.localRotation),c&&t.dirtifyLocal(i,u)}}},this.displayObjectDependencyMap=new WeakMap,this.calcLocalTransform=function(){var r=Q(),i=T.Ue(),a=ma(0,0,0,1);return function(o){var s=o.localSkew[0]!==0||o.localSkew[1]!==0;if(s){if(mr(o.localTransform,o.localRotation,o.localPosition,T.al(1,1,1),o.origin),o.localSkew[0]!==0||o.localSkew[1]!==0){var l=Xt(r);l[4]=Math.tan(o.localSkew[0]),l[1]=Math.tan(o.localSkew[1]),Ut(o.localTransform,o.localTransform,l)}var c=mr(r,a,i,o.localScale,o.origin);Ut(o.localTransform,o.localTransform,c)}else mr(o.localTransform,o.localRotation,o.localPosition,o.localScale,o.origin)}}()}return n.prototype.matches=function(e,t){return this.runtime.sceneGraphSelector.is(e,t)},n.prototype.querySelector=function(e,t){return this.runtime.sceneGraphSelector.selectOne(e,t)},n.prototype.querySelectorAll=function(e,t){return this.runtime.sceneGraphSelector.selectAll(e,t)},n.prototype.attach=function(e,t,r){var i,a=!1;e.parentNode&&(a=e.parentNode!==t,this.detach(e)),e.parentNode=t,Mt(r)?e.parentNode.childNodes.push(e):e.parentNode.childNodes.splice(r,0,e);var o=t.sortable;(!((i=o==null?void 0:o.sorted)===null||i===void 0)&&i.length||e.parsedStyle.zIndex)&&(o.dirtyChildren.indexOf(e)===-1&&o.dirtyChildren.push(e),o.dirty=!0,o.dirtyReason=$s.ADDED);var s=e.transformable;s&&this.dirtifyWorld(e,s),s.frozen&&this.unfreezeParentToRoot(e),a&&e.dispatchEvent(OL)},n.prototype.detach=function(e){var t,r;if(e.parentNode){var i=e.transformable,a=e.parentNode.sortable;(!((t=a==null?void 0:a.sorted)===null||t===void 0)&&t.length||!((r=e.style)===null||r===void 0)&&r.zIndex)&&(a.dirtyChildren.indexOf(e)===-1&&a.dirtyChildren.push(e),a.dirty=!0,a.dirtyReason=$s.REMOVED);var o=e.parentNode.childNodes.indexOf(e);o>-1&&e.parentNode.childNodes.splice(o,1),i&&this.dirtifyWorld(e,i),e.parentNode=null}},n.prototype.getOrigin=function(e){return e.getGeometryBounds(),e.transformable.origin},n.prototype.setOrigin=function(e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=0),typeof t=="number"&&(t=[t,r,i]);var a=e.transformable;if(!(t[0]===a.origin[0]&&t[1]===a.origin[1]&&t[2]===a.origin[2])){var o=a.origin;o[0]=t[0],o[1]=t[1],o[2]=t[2]||0,this.dirtifyLocal(e,a)}},n.prototype.setLocalEulerAngles=function(e,t,r,i,a){r===void 0&&(r=0),i===void 0&&(i=0),a===void 0&&(a=!0),typeof t=="number"&&(t=T.al(t,r,i));var o=e.transformable;bi(o.localRotation,t[0],t[1],t[2]),a&&this.dirtifyLocal(e,o)},n.prototype.scaleLocal=function(e,t,r){r===void 0&&(r=!0);var i=e.transformable;T.Jp(i.localScale,i.localScale,T.al(t[0],t[1],t[2]||1)),r&&this.dirtifyLocal(e,i)},n.prototype.setLocalScale=function(e,t,r){r===void 0&&(r=!0);var i=e.transformable,a=T.al(t[0],t[1],t[2]||i.localScale[2]);T.fS(a,i.localScale)||(T.JG(i.localScale,a),r&&this.dirtifyLocal(e,i))},n.prototype.setLocalRotation=function(e,t,r,i,a,o){o===void 0&&(o=!0),typeof t=="number"&&(t=ma(t,r,i,a));var s=e.transformable;Ei(s.localRotation,t),o&&this.dirtifyLocal(e,s)},n.prototype.setLocalSkew=function(e,t,r){typeof t=="number"&&(t=ya.al(t,r));var i=e.transformable;ya.JG(i.localSkew,t),this.dirtifyLocal(e,i)},n.prototype.dirtifyLocal=function(e,t){t.localDirtyFlag||(t.localDirtyFlag=!0,t.dirtyFlag||this.dirtifyWorld(e,t))},n.prototype.dirtifyWorld=function(e,t){t.dirtyFlag||this.unfreezeParentToRoot(e),this.dirtifyWorldInternal(e,t),this.dirtifyToRoot(e,!0)},n.prototype.triggerPendingEvents=function(){var e=this,t=new Set,r=function(i,a){i.isConnected&&!t.has(i.entity)&&(e.boundsChangedEvent.detail=a,e.boundsChangedEvent.target=i,i.isMutationObserved?i.dispatchEvent(e.boundsChangedEvent):i.ownerDocument.defaultView.dispatchEvent(e.boundsChangedEvent,!0),t.add(i.entity))};this.pendingEvents.forEach(function(i){var a=C(i,2),o=a[0],s=a[1];s.affectChildren?o.forEach(function(l){r(l,s)}):r(o,s)}),this.clearPendingEvents(),t.clear()},n.prototype.clearPendingEvents=function(){this.pendingEvents=[]},n.prototype.dirtifyToRoot=function(e,t){t===void 0&&(t=!1);var r=e;for(r.renderable&&(r.renderable.dirty=!0);r;)Cb(r),r=r.parentNode;t&&e.forEach(function(i){Cb(i)}),this.informDependentDisplayObjects(e),this.pendingEvents.push([e,{affectChildren:t}])},n.prototype.updateDisplayObjectDependency=function(e,t,r,i){if(t&&t!==r){var a=this.displayObjectDependencyMap.get(t);if(a&&a[e]){var o=a[e].indexOf(i);a[e].splice(o,1)}}if(r){var s=this.displayObjectDependencyMap.get(r);s||(this.displayObjectDependencyMap.set(r,{}),s=this.displayObjectDependencyMap.get(r)),s[e]||(s[e]=[]),s[e].push(i)}},n.prototype.informDependentDisplayObjects=function(e){var t=this,r=this.displayObjectDependencyMap.get(e);r&&Object.keys(r).forEach(function(i){r[i].forEach(function(a){t.dirtifyToRoot(a,!0),a.dispatchEvent(new oo(de.ATTR_MODIFIED,a,t,t,i,oo.MODIFICATION,t,t)),a.isCustomElement&&a.isConnected&&a.attributeChangedCallback&&a.attributeChangedCallback(i,t,t)})})},n.prototype.getPosition=function(e){var t=e.transformable;return ir(t.position,this.getWorldTransform(e,t))},n.prototype.getRotation=function(e){var t=e.transformable;return An(t.rotation,this.getWorldTransform(e,t))},n.prototype.getScale=function(e){var t=e.transformable;return Ye(t.scaling,this.getWorldTransform(e,t))},n.prototype.getWorldTransform=function(e,t){return t===void 0&&(t=e.transformable),!t.localDirtyFlag&&!t.dirtyFlag||(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.sync(e,t)),t.worldTransform},n.prototype.getLocalPosition=function(e){return e.transformable.localPosition},n.prototype.getLocalRotation=function(e){return e.transformable.localRotation},n.prototype.getLocalScale=function(e){return e.transformable.localScale},n.prototype.getLocalSkew=function(e){return e.transformable.localSkew},n.prototype.getLocalTransform=function(e){var t=e.transformable;return t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.localTransform},n.prototype.setLocalTransform=function(e,t){var r=ir(T.Ue(),t),i=An(Vt(),t),a=Ye(T.Ue(),t);this.setLocalScale(e,a,!1),this.setLocalPosition(e,r,!1),this.setLocalRotation(e,i,void 0,void 0,void 0,!1),this.dirtifyLocal(e,e.transformable)},n.prototype.resetLocalTransform=function(e){this.setLocalScale(e,[1,1,1]),this.setLocalPosition(e,[0,0,0]),this.setLocalEulerAngles(e,[0,0,0]),this.setLocalSkew(e,[0,0])},n.prototype.getTransformedGeometryBounds=function(e,t,r){t===void 0&&(t=!1);var i=this.getGeometryBounds(e,t);if(lr.isEmpty(i))return null;var a=r||new lr;return a.setFromTransformedAABB(i,this.getWorldTransform(e)),a},n.prototype.getGeometryBounds=function(e,t){t===void 0&&(t=!1);var r=e.geometry;r.dirty&&rt.styleValueRegistry.updateGeometry(e);var i=t?r.renderBounds:r.contentBounds||null;return i||new lr},n.prototype.getBounds=function(e,t){var r=this;t===void 0&&(t=!1);var i=e.renderable;if(!i.boundsDirty&&!t&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&t&&i.renderBounds)return i.renderBounds;var a=t?i.renderBounds:i.bounds,o=this.getTransformedGeometryBounds(e,t,a),s=e.childNodes;if(s.forEach(function(u){var h=r.getBounds(u,t);h&&(o?o.add(h):(o=a||new lr,o.update(h.center,h.halfExtents)))}),o||(o=new lr),t){var l=Y3(e);if(l){var c=l.parsedStyle.clipPath.getBounds(t);o?c&&(o=c.intersection(o)):o.update(c.center,c.halfExtents)}}return t?(i.renderBounds=o,i.renderBoundsDirty=!1):(i.bounds=o,i.boundsDirty=!1),o},n.prototype.getLocalBounds=function(e){if(e.parentNode){var t=Q();e.parentNode.transformable&&(t=Wt(Q(),this.getWorldTransform(e.parentNode)));var r=this.getBounds(e);if(!lr.isEmpty(r)){var i=new lr;return i.setFromTransformedAABB(r,t),i}}return this.getBounds(e)},n.prototype.getBoundingClientRect=function(e){var t,r,i,a=this.getGeometryBounds(e);lr.isEmpty(a)||(i=new lr,i.setFromTransformedAABB(a,this.getWorldTransform(e)));var o=(r=(t=e.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect();if(i){var s=C(i.getMin(),2),l=s[0],c=s[1],u=C(i.getMax(),2),h=u[0],f=u[1];return new Ho(l+((o==null?void 0:o.left)||0),c+((o==null?void 0:o.top)||0),h-l,f-c)}return new Ho((o==null?void 0:o.left)||0,(o==null?void 0:o.top)||0,0,0)},n.prototype.dirtifyWorldInternal=function(e,t){var r=this;if(!t.dirtyFlag){t.dirtyFlag=!0,t.frozen=!1,e.childNodes.forEach(function(a){var o=a.transformable;o.dirtyFlag||r.dirtifyWorldInternal(a,o)});var i=e.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0)}},n.prototype.syncHierarchy=function(e){var t=e.transformable;if(!t.frozen){t.frozen=!0,(t.localDirtyFlag||t.dirtyFlag)&&this.sync(e,t);for(var r=e.childNodes,i=0;i<r.length;i++)this.syncHierarchy(r[i])}},n.prototype.sync=function(e,t){if(t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.dirtyFlag){var r=e.parentNode,i=r&&r.transformable;r===null||!i?kt(t.worldTransform,t.localTransform):Ut(t.worldTransform,i.worldTransform,t.localTransform),t.dirtyFlag=!1}},n.prototype.unfreezeParentToRoot=function(e){for(var t=e.parentNode;t;){var r=t.transformable;r&&(r.frozen=!1),t=t.parentNode}},n}(),jo={MetricsString:"|\xC9q\xC5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},Ab=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,RL=/[!%),.:;?\]}'""]/,kL=/[$('"]/,LL=/[!),.:;?\]}'""]/,IL=/[([{'"]/,DL=/[)\]'"?!:;,.]/,BL=/[(['"...]/,FL=/[!%),.:;?\]}'"]/,GL=/[$([{'"#]/,zL=new RegExp("".concat(RL.source,"|").concat(LL.source,"|").concat(DL.source,"|").concat(FL.source)),WL=new RegExp("".concat(kL.source,"|").concat(IL.source,"|").concat(BL.source,"|").concat(GL.source)),UL=function(){function n(e){var t=this;this.runtime=e,this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(r,i){return t.isBreakingSpace(i)?!1:!!(r&&(WL.exec(i)||zL.exec(r)))},this.trimByKinsokuShorui=function(r){var i=K([],C(r),!1),a=i[i.length-2];if(!a)return r;var o=a[a.length-1];return i[i.length-2]=a.slice(0,-1),i[i.length-1]=o+i[i.length-1],i}}return n.prototype.measureFont=function(e,t){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var r={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(t),a=this.runtime.offscreenCanvasCreator.getOrCreateContext(t,{willReadFrequently:!0});a.font=e;var o=jo.MetricsString+jo.BaselineSymbol,s=Math.ceil(a.measureText(o).width),l=Math.ceil(a.measureText(jo.BaselineSymbol).width),c=jo.HeightMultiplier*l;l=l*jo.BaselineMultiplier|0,i.width=s,i.height=c,a.fillStyle="#f00",a.fillRect(0,0,s,c),a.font=e,a.textBaseline="alphabetic",a.fillStyle="#000",a.fillText(o,0,l);var u=a.getImageData(0,0,s||1,c||1).data,h=u.length,f=s*4,d=0,p=0,v=!1;for(d=0;d<l;++d){for(var g=0;g<f;g+=4)if(u[p+g]!==255){v=!0;break}if(!v)p+=f;else break}for(r.ascent=l-d,p=h-f,v=!1,d=c;d>l;--d){for(var g=0;g<f;g+=4)if(u[p+g]!==255){v=!0;break}if(!v)p-=f;else break}return r.descent=d-l,r.fontSize=r.ascent+r.descent,this.fontMetricsCache[e]=r,r},n.prototype.measureText=function(e,t,r){var i=t.fontSize,a=i===void 0?16:i,o=t.wordWrap,s=o===void 0?!1:o,l=t.lineHeight,c=t.lineWidth,u=c===void 0?1:c,h=t.textBaseline,f=h===void 0?"alphabetic":h,d=t.textAlign,p=d===void 0?"start":d,v=t.letterSpacing,g=v===void 0?0:v,m=t.textPath;t.textPathSide,t.textPathStartOffset;var x=t.leading,_=x===void 0?0:x,S=cL(t),b=this.measureFont(S,r);b.fontSize===0&&(b.fontSize=a,b.ascent=a);var y=this.runtime.offscreenCanvasCreator.getOrCreateContext(r);y.font=S,t.isOverflowing=!1;var E=s?this.wordWrap(e,t,r):e,w=E.split(/(?:\r\n|\r|\n)/),M=new Array(w.length),P=0;if(m){m.getTotalLength();for(var A=0;A<w.length;A++)var O=y.measureText(w[A]).width+(w[A].length-1)*g}else{for(var A=0;A<w.length;A++){var R=y.measureText(w[A]).width+(w[A].length-1)*g;M[A]=R,P=Math.max(P,R)}var O=P+u,L=l||b.fontSize+u,z=Math.max(L,b.fontSize+u)+(w.length-1)*(L+_);L+=_;var Y=0;return f==="middle"?Y=-z/2:f==="bottom"||f==="alphabetic"||f==="ideographic"?Y=-z:(f==="top"||f==="hanging")&&(Y=0),{font:S,width:O,height:z,lines:w,lineWidths:M,lineHeight:L,maxLineWidth:P,fontProperties:b,lineMetrics:M.map(function(Z,J){var mt=0;return p==="center"||p==="middle"?mt-=Z/2:(p==="right"||p==="end")&&(mt-=Z),new Ho(mt-u/2,Y+J*L,Z+u,L)})}}},n.prototype.setGraphemeOnPath=function(){},n.prototype.wordWrap=function(e,t,r){var i=this,a=t.wordWrapWidth,o=a===void 0?0:a,s=t.letterSpacing,l=s===void 0?0:s,c=t.maxLines,u=c===void 0?1/0:c,h=t.textOverflow,f=this.runtime.offscreenCanvasCreator.getOrCreateContext(r),d=o+l,p="";h==="ellipsis"?p="...":h&&h!=="clip"&&(p=h);for(var v=[],g=0,m=0,x={},_=function(Y){return i.getFromCache(Y,l,x,f)},S=Array.from(p).reduce(function(Y,I){return Y+_(I)},0),b=Array.from(e),y=0;y<b.length;y++){var E=b[y],w=e[y-1],M=e[y+1],P=_(E);if(this.isNewline(E)){if(g++,g>=u){t.isOverflowing=!0;break}m=0,v[g]="";continue}if(m>0&&m+P>d){if(g+1>=u){if(t.isOverflowing=!0,S>0&&S<=d){for(var A=v[g].length,O=0,R=A,L=0;L<A;L++){var z=_(v[g][L]);if(O+z+S>d){R=L;break}O+=z}v[g]=(v[g]||"").slice(0,R)+p}break}if(g++,m=0,v[g]="",this.isBreakingSpace(E))continue;this.canBreakInLastChar(E)||(v=this.trimToBreakable(v),m=this.sumTextWidthByCache(v[g]||"",x)),this.shouldBreakByKinsokuShorui(E,M)&&(v=this.trimByKinsokuShorui(v),m+=_(w||""))}m+=P,v[g]=(v[g]||"")+E}return v.join(`
`)},n.prototype.isBreakingSpace=function(e){return typeof e!="string"?!1:jo.BreakingSpaces.indexOf(e.charCodeAt(0))>=0},n.prototype.isNewline=function(e){return typeof e!="string"?!1:jo.Newlines.indexOf(e.charCodeAt(0))>=0},n.prototype.trimToBreakable=function(e){var t=K([],C(e),!1),r=t[t.length-2],i=this.findBreakableIndex(r);if(i===-1||!r)return t;var a=r.slice(i,i+1),o=this.isBreakingSpace(a),s=i+1,l=i+(o?0:1);return t[t.length-1]+=r.slice(s,r.length),t[t.length-2]=r.slice(0,l),t},n.prototype.canBreakInLastChar=function(e){return!(e&&Ab.test(e))},n.prototype.sumTextWidthByCache=function(e,t){return e.split("").reduce(function(r,i){if(!t[i])throw Error("cannot count the word without cache");return r+t[i]},0)},n.prototype.findBreakableIndex=function(e){for(var t=e.length-1;t>=0;t--)if(!Ab.test(e[t]))return t;return-1},n.prototype.getFromCache=function(e,t,r,i){var a=r[e];if(typeof a!="number"){var o=e.length*t;a=i.measureText(e).width+o,r[e]=a}return a},n}(),rt={},VL=function(){var n,e=new bL,t=new xL;return n={},n[Rt.CIRCLE]=new vL,n[Rt.ELLIPSE]=new gL,n[Rt.RECT]=e,n[Rt.IMAGE]=e,n[Rt.GROUP]=new wL,n[Rt.LINE]=new mL,n[Rt.TEXT]=new EL(rt),n[Rt.POLYLINE]=t,n[Rt.POLYGON]=t,n[Rt.PATH]=new yL,n[Rt.HTML]=null,n[Rt.MESH]=null,n}(),HL=function(){var n,e=new C3,t=new Ov;return n={},n[wt.PERCENTAGE]=null,n[wt.NUMBER]=new k3,n[wt.ANGLE]=new P3,n[wt.DEFINED_PATH]=new M3,n[wt.PAINT]=e,n[wt.COLOR]=e,n[wt.FILTER]=new A3,n[wt.LENGTH]=t,n[wt.LENGTH_PERCENTAGE]=t,n[wt.LENGTH_PERCENTAGE_12]=new O3,n[wt.LENGTH_PERCENTAGE_14]=new N3,n[wt.COORDINATE]=new Ov,n[wt.OFFSET_DISTANCE]=new L3,n[wt.OPACITY_VALUE]=new I3,n[wt.PATH]=new D3,n[wt.LIST_OF_POINTS]=new B3,n[wt.SHADOW_BLUR]=new F3,n[wt.TEXT]=new G3,n[wt.TEXT_TRANSFORM]=new z3,n[wt.TRANSFORM]=new fL,n[wt.TRANSFORM_ORIGIN]=new dL,n[wt.Z_INDEX]=new pL,n[wt.MARKER]=new R3,n}(),YL=function(){return typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:{}};rt.CameraContribution=Ux,rt.AnimationTimeline=null,rt.EasingFunction=null,rt.offscreenCanvasCreator=new PL,rt.sceneGraphSelector=new AL,rt.sceneGraphService=new NL(rt),rt.textService=new UL(rt),rt.geometryUpdaterFactory=VL,rt.CSSPropertySyntaxFactory=HL,rt.styleValueRegistry=new T3(rt),rt.layoutRegistry=null,rt.globalThis=YL(),rt.enableCSSParsing=!1,rt.enableDataset=!1,rt.enableStyleSyntax=!0,rt.enableAttributeDashCased=!1,rt.enableSizeAttenuation=!1;var Ob=0;function BU(){Ob=0}var Nb=new oo(de.INSERTED,null,"","","",0,"",""),Rb=new oo(de.REMOVED,null,"","","",0,"",""),XL=new Fn(de.DESTROY),jL=function(n){B(e,n);function e(){var t=n.call(this)||this;return t.entity=Ob++,t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.cullable={strategy:bv.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle=rt.enableCSSParsing?{opacity:Ke,fillOpacity:Ke,strokeOpacity:Ke,fill:Ke,stroke:Ke,transform:Ke,transformOrigin:Ke,visibility:Ke,pointerEvents:Ke,lineWidth:Ke,lineCap:Ke,lineJoin:Ke,increasedLineWidthForHitTesting:Ke,fontSize:Ke,fontFamily:Ke,fontStyle:Ke,fontWeight:Ke,fontVariant:Ke,textAlign:Ke,textBaseline:Ke,textTransform:Ke,zIndex:Ke,filter:Ke,shadowType:Ke}:null,t.parsedStyle={},t.attributes={},t}return Object.defineProperty(e.prototype,"className",{get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"classList",{get:function(){return this.className.split(" ").filter(function(t){return t!==""})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagName",{get:function(){return this.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(t){throw new Error(Le)},e.prototype.appendChild=function(t,r){var i;if(t.destroyed)throw new Error(bk);return rt.sceneGraphService.attach(t,this,r),!((i=this.ownerDocument)===null||i===void 0)&&i.defaultView&&this.ownerDocument.defaultView.mountChildren(t),this.isMutationObserved&&(Nb.relatedNode=this,t.dispatchEvent(Nb)),t},e.prototype.insertBefore=function(t,r){if(!r)this.appendChild(t);else{t.parentElement&&t.parentElement.removeChild(t);var i=this.childNodes.indexOf(r);i===-1?this.appendChild(t):this.appendChild(t,i)}return t},e.prototype.replaceChild=function(t,r){var i=this.childNodes.indexOf(r);return this.removeChild(r),this.appendChild(t,i),r},e.prototype.removeChild=function(t){var r;return Rb.relatedNode=this,t.dispatchEvent(Rb),!((r=t.ownerDocument)===null||r===void 0)&&r.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),rt.sceneGraphService.detach(t),t},e.prototype.removeChildren=function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];this.removeChild(r)}},e.prototype.destroyChildren=function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];r.childNodes.length&&r.destroyChildren(),r.destroy()}},e.prototype.matches=function(t){return rt.sceneGraphService.matches(t,this)},e.prototype.getElementById=function(t){return rt.sceneGraphService.querySelector("#".concat(t),this)},e.prototype.getElementsByName=function(t){return rt.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)},e.prototype.getElementsByClassName=function(t){return rt.sceneGraphService.querySelectorAll(".".concat(t),this)},e.prototype.getElementsByTagName=function(t){return rt.sceneGraphService.querySelectorAll(t,this)},e.prototype.querySelector=function(t){return rt.sceneGraphService.querySelector(t,this)},e.prototype.querySelectorAll=function(t){return rt.sceneGraphService.querySelectorAll(t,this)},e.prototype.closest=function(t){var r=this;do{if(rt.sceneGraphService.matches(t,r))return r;r=r.parentElement}while(r!==null);return null},e.prototype.find=function(t){var r=this,i=null;return this.forEach(function(a){return a!==r&&t(a)?(i=a,!0):!1}),i},e.prototype.findAll=function(t){var r=this,i=[];return this.forEach(function(a){a!==r&&t(a)&&i.push(a)}),i},e.prototype.after=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this);r.forEach(function(o,s){var l;return(l=t.parentNode)===null||l===void 0?void 0:l.appendChild(o,a+s+1)})}},e.prototype.before=function(){for(var t,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this),o=C(r),s=o[0],l=o.slice(1);this.parentNode.appendChild(s,a),(t=s).after.apply(t,K([],C(l),!1))}},e.prototype.replaceWith=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.after.apply(this,K([],C(t),!1)),this.remove()},e.prototype.append=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(a){return t.appendChild(a)})},e.prototype.prepend=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(a,o){return t.appendChild(a,o)})},e.prototype.replaceChildren=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,K([],C(t),!1))},e.prototype.remove=function(){return this.parentNode?this.parentNode.removeChild(this):this},e.prototype.destroy=function(){this.dispatchEvent(XL),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0},e.prototype.getGeometryBounds=function(){return rt.sceneGraphService.getGeometryBounds(this)},e.prototype.getRenderBounds=function(){return rt.sceneGraphService.getBounds(this,!0)},e.prototype.getBounds=function(){return rt.sceneGraphService.getBounds(this)},e.prototype.getLocalBounds=function(){return rt.sceneGraphService.getLocalBounds(this)},e.prototype.getBoundingClientRect=function(){return rt.sceneGraphService.getBoundingClientRect(this)},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},e.prototype.getAttributeNames=function(){return Object.keys(this.attributes)},e.prototype.getAttribute=function(t){if(Ak(t))return rt.enableCSSParsing?null:void 0;var r=this.attributes[t];if(r===void 0){if(rt.enableAttributeDashCased){var i=vv(t);r=this.attributes[i]}return rt.enableCSSParsing&&Mt(r)?null:r}else return r},e.prototype.hasAttribute=function(t){return this.getAttributeNames().includes(t)},e.prototype.hasAttributes=function(){return!!this.getAttributeNames().length},e.prototype.removeAttribute=function(t){this.setAttribute(t,null),delete this.attributes[t]},e.prototype.setAttribute=function(t,r,i,a){this.attributes[t]=r},e.prototype.getAttributeNS=function(t,r){throw new Error(Le)},e.prototype.getAttributeNode=function(t){throw new Error(Le)},e.prototype.getAttributeNodeNS=function(t,r){throw new Error(Le)},e.prototype.hasAttributeNS=function(t,r){throw new Error(Le)},e.prototype.removeAttributeNS=function(t,r){throw new Error(Le)},e.prototype.removeAttributeNode=function(t){throw new Error(Le)},e.prototype.setAttributeNS=function(t,r,i){throw new Error(Le)},e.prototype.setAttributeNode=function(t){throw new Error(Le)},e.prototype.setAttributeNodeNS=function(t){throw new Error(Le)},e.prototype.toggleAttribute=function(t,r){throw new Error(Le)},e}(Zn);function Ze(n){return!!(n!=null&&n.nodeName)}var kb=rt.globalThis.Proxy?rt.globalThis.Proxy:function(){},Na=new oo(de.ATTR_MODIFIED,null,null,null,null,oo.MODIFICATION,null,null),$L={opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",zIndex:"",filter:"",shadowType:""},KL={fill:Rh,stroke:Rh,transform:[],zIndex:0,filter:[],shadowType:"outer",miterLimit:10},ZL=["opacity","fillOpacity","strokeOpacity","transformOrigin","visibility","pointerEvents","lineWidth","lineCap","lineJoin","increasedLineWidthForHitTesting"],qL=K(K([],C(ZL),!1),["fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform"],!1),Lb="data-",Xr=function(n){B(e,n);function e(t){var r=n.call(this)||this;return r.isCustomElement=!1,r.isMutationObserved=!1,r.activeAnimations=[],r.config=t,r.id=r.config.id||"",r.name=r.config.name||"",(r.config.className||r.config.class)&&(r.className=r.config.className||r.config.class),r.nodeName=r.config.type||Rt.GROUP,rt.enableCSSParsing?(Object.assign(r.attributes,$L),Object.assign(r.parsedStyle,KL,r.config.initialParsedStyle)):r.config.initialParsedStyle&&Object.assign(r.parsedStyle,r.config.initialParsedStyle),r.initAttributes(r.config.style),rt.enableDataset&&(r.dataset=new kb({},{get:function(i,a){var o="".concat(Lb).concat(Yx(a));return i[o]!==void 0?i[o]:r.getAttribute(o)},set:function(i,a,o){return r.setAttribute("".concat(Lb).concat(Yx(a)),o),!0}})),rt.enableStyleSyntax&&(r.style=new kb({setProperty:function(i,a){r.setAttribute(i,a)},getPropertyValue:function(i){return r.getAttribute(i)},removeProperty:function(i){r.removeAttribute(i)},item:function(){return""}},{get:function(i,a){return i[a]!==void 0?i[a]:r.getAttribute(a)},set:function(i,a,o){return r.setAttribute(a,o),!0}})),r}return e.prototype.destroy=function(){n.prototype.destroy.call(this),this.getAnimations().forEach(function(t){t.cancel()})},e.prototype.cloneNode=function(t,r){var i=N({},this.attributes);for(var a in i){var o=i[a];Ze(o)&&a!=="clipPath"&&a!=="offsetPath"&&a!=="textPath"&&(i[a]=o.cloneNode(t)),r&&(i[a]=r(a,o))}var s=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:i});return s.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(l){if(!l.style.isMarker){var c=l.cloneNode(t);s.appendChild(c)}}),s},e.prototype.initAttributes=function(t){t===void 0&&(t={});var r=this.renderable,i={forceUpdateGeometry:!0};rt.enableCSSParsing&&(i.usedAttributes=qL);var a=t;if(rt.enableAttributeDashCased){a={};for(var o in t){var s=vv(o);a[s]=t[o]}}rt.styleValueRegistry.processProperties(this,a,i),r.dirty=!0},e.prototype.setAttribute=function(t,r,i,a){i===void 0&&(i=!1),a===void 0&&(a=!0),rt.enableAttributeDashCased&&(t=vv(t)),!Nt(r)&&(i||r!==this.attributes[t])&&(this.internalSetAttribute(t,r,{memoize:a}),n.prototype.setAttribute.call(this,t,r))},e.prototype.internalSetAttribute=function(t,r,i){var a;i===void 0&&(i={});var o=this.renderable,s=this.attributes[t],l=this.parsedStyle[t];rt.styleValueRegistry.processProperties(this,(a={},a[t]=r,a),i),o.dirty=!0;var c=this.parsedStyle[t];this.isConnected&&(Na.relatedNode=this,Na.prevValue=s,Na.newValue=r,Na.attrName=t,Na.prevParsedValue=l,Na.newParsedValue=c,this.isMutationObserved?this.dispatchEvent(Na):(Na.target=this,this.ownerDocument.defaultView.dispatchEvent(Na,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&this.attributeChangedCallback&&this.attributeChangedCallback(t,s,r,l,c)},e.prototype.getBBox=function(){var t=this.getBounds(),r=C(t.getMin(),2),i=r[0],a=r[1],o=C(t.getMax(),2),s=o[0],l=o[1];return new Ho(i,a,s-i,l-a)},e.prototype.setOrigin=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),rt.sceneGraphService.setOrigin(this,Sr(t,r,i)),this},e.prototype.getOrigin=function(){return rt.sceneGraphService.getOrigin(this)},e.prototype.setPosition=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),rt.sceneGraphService.setPosition(this,Sr(t,r,i)),this},e.prototype.setLocalPosition=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),rt.sceneGraphService.setLocalPosition(this,Sr(t,r,i)),this},e.prototype.translate=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),rt.sceneGraphService.translate(this,Sr(t,r,i)),this},e.prototype.translateLocal=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),rt.sceneGraphService.translateLocal(this,Sr(t,r,i)),this},e.prototype.getPosition=function(){return rt.sceneGraphService.getPosition(this)},e.prototype.getLocalPosition=function(){return rt.sceneGraphService.getLocalPosition(this)},e.prototype.scale=function(t,r,i){return this.scaleLocal(t,r,i)},e.prototype.scaleLocal=function(t,r,i){return typeof t=="number"&&(r=r||t,i=i||t,t=Sr(t,r,i)),rt.sceneGraphService.scaleLocal(this,t),this},e.prototype.setLocalScale=function(t,r,i){return typeof t=="number"&&(r=r||t,i=i||t,t=Sr(t,r,i)),rt.sceneGraphService.setLocalScale(this,t),this},e.prototype.getLocalScale=function(){return rt.sceneGraphService.getLocalScale(this)},e.prototype.getScale=function(){return rt.sceneGraphService.getScale(this)},e.prototype.getEulerAngles=function(){var t=C(uv(T.Ue(),rt.sceneGraphService.getWorldTransform(this)),3),r=t[2];return Ni(r)},e.prototype.getLocalEulerAngles=function(){var t=C(uv(T.Ue(),rt.sceneGraphService.getLocalRotation(this)),3),r=t[2];return Ni(r)},e.prototype.setEulerAngles=function(t){return rt.sceneGraphService.setEulerAngles(this,0,0,t),this},e.prototype.setLocalEulerAngles=function(t){return rt.sceneGraphService.setLocalEulerAngles(this,0,0,t),this},e.prototype.rotateLocal=function(t,r,i){return Mt(r)&&Mt(i)?rt.sceneGraphService.rotateLocal(this,0,0,t):rt.sceneGraphService.rotateLocal(this,t,r,i),this},e.prototype.rotate=function(t,r,i){return Mt(r)&&Mt(i)?rt.sceneGraphService.rotate(this,0,0,t):rt.sceneGraphService.rotate(this,t,r,i),this},e.prototype.setRotation=function(t,r,i,a){return rt.sceneGraphService.setRotation(this,t,r,i,a),this},e.prototype.setLocalRotation=function(t,r,i,a){return rt.sceneGraphService.setLocalRotation(this,t,r,i,a),this},e.prototype.setLocalSkew=function(t,r){return rt.sceneGraphService.setLocalSkew(this,t,r),this},e.prototype.getRotation=function(){return rt.sceneGraphService.getRotation(this)},e.prototype.getLocalRotation=function(){return rt.sceneGraphService.getLocalRotation(this)},e.prototype.getLocalSkew=function(){return rt.sceneGraphService.getLocalSkew(this)},e.prototype.getLocalTransform=function(){return rt.sceneGraphService.getLocalTransform(this)},e.prototype.getWorldTransform=function(){return rt.sceneGraphService.getWorldTransform(this)},e.prototype.setLocalTransform=function(t){return rt.sceneGraphService.setLocalTransform(this,t),this},e.prototype.resetLocalTransform=function(){rt.sceneGraphService.resetLocalTransform(this)},e.prototype.getAnimations=function(){return this.activeAnimations},e.prototype.animate=function(t,r){var i,a=(i=this.ownerDocument)===null||i===void 0?void 0:i.timeline;return a?a.play(this,t,r):null},e.prototype.isVisible=function(){var t,r;return rt.enableCSSParsing?((t=this.parsedStyle)===null||t===void 0?void 0:t.visibility)==="visible":((r=this.parsedStyle)===null||r===void 0?void 0:r.visibility)!=="hidden"},Object.defineProperty(e.prototype,"interactive",{get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"},enumerable:!1,configurable:!0}),e.prototype.isInteractive=function(){var t;return((t=this.parsedStyle)===null||t===void 0?void 0:t.pointerEvents)!=="none"},e.prototype.isCulled=function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)},e.prototype.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,K([],C(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})),!1))+1),this},e.prototype.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,K([],C(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})),!1))-1),this},e.prototype.getConfig=function(){return this.config},e.prototype.attr=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=C(r,2),o=a[0],s=a[1];return o?dn(o)?(Object.keys(o).forEach(function(l){t.setAttribute(l,o[l])}),this):r.length===2?(this.setAttribute(o,s),this):this.attributes[o]:this.attributes},e.prototype.getMatrix=function(t){var r=t||this.getWorldTransform(),i=C(ir(T.Ue(),r),2),a=i[0],o=i[1],s=C(Ye(T.Ue(),r),2),l=s[0],c=s[1],u=An(Vt(),r),h=C(uv(T.Ue(),u),3),f=h[0],d=h[2];return dk(f||d,a,o,l,c)},e.prototype.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},e.prototype.setMatrix=function(t){var r=C(Fx(t),5),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];this.setEulerAngles(l).setPosition(i,a).setLocalScale(o,s)},e.prototype.setLocalMatrix=function(t){var r=C(Fx(t),5),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];this.setLocalEulerAngles(l).setLocalPosition(i,a).setLocalScale(o,s)},e.prototype.show=function(){rt.enableCSSParsing?this.style.visibility="visible":this.forEach(function(t){t.style.visibility="visible"})},e.prototype.hide=function(){rt.enableCSSParsing?this.style.visibility="hidden":this.forEach(function(t){t.style.visibility="hidden"})},e.prototype.getCount=function(){return this.childElementCount},e.prototype.getParent=function(){return this.parentElement},e.prototype.getChildren=function(){return this.children},e.prototype.getFirst=function(){return this.firstElementChild},e.prototype.getLast=function(){return this.lastElementChild},e.prototype.getChildByIndex=function(t){return this.children[t]||null},e.prototype.add=function(t,r){return this.appendChild(t,r)},e.prototype.set=function(t,r){this.config[t]=r},e.prototype.get=function(t){return this.config[t]},e.prototype.moveTo=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(t,r,i),this},e.prototype.move=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(t,r,i),this},e.prototype.setZIndex=function(t){return this.style.zIndex=t,this},e}(jL),Gh=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:Rt.CIRCLE},t))||this}return e}(Xr),JL=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);return r=n.call(this,N({style:rt.enableCSSParsing?N({},i):N({},i)},a))||this,r.isCustomElement=!0,r}return e}(Xr),Ib=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:Rt.ELLIPSE},t))||this}return e}(Xr),qn=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:Rt.GROUP},t))||this}return e}(Xr),Db=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);return r=n.call(this,N({type:Rt.HTML,style:rt.enableCSSParsing?N({x:"",y:"",width:"auto",height:"auto",innerHTML:""},i):N({},i)},a))||this,r.cullable.enable=!1,r}return e.prototype.getDomElement=function(){return this.parsedStyle.$el},e.prototype.getBoundingClientRect=function(){if(this.parsedStyle.$el)return this.parsedStyle.$el.getBoundingClientRect();var t=this.parsedStyle,r=t.x,i=t.y,a=t.width,o=t.height;return new Ho(r,i,a,o)},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.getBounds=function(){var t,r,i=this.getBoundingClientRect(),a=(r=(t=this.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect(),o=new lr,s=i.left-((a==null?void 0:a.left)||0),l=i.top-((a==null?void 0:a.top)||0);return o.setMinMax([s,l,0],[s+i.width,l+i.height,0]),o},e.prototype.getLocalBounds=function(){if(this.parentNode){var t=Wt(Q(),this.parentNode.getWorldTransform()),r=this.getBounds();if(!lr.isEmpty(r)){var i=new lr;return i.setFromTransformedAABB(r,t),i}}return this.getBounds()},e}(Xr),Bb=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:Rt.IMAGE},t))||this}return e}(Xr),Gv=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);r=n.call(this,N({type:Rt.LINE,style:N({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},a))||this,r.markerStartAngle=0,r.markerEndAngle=0;var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd;return s&&Ze(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),l&&Ze(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="x1"||t==="y1"||t==="x2"||t==="y2"||t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&Ze(a)&&(this.markerStartAngle=0,a.remove()),o&&Ze(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"&&(a&&Ze(a)&&(this.markerEndAngle=0,a.remove()),o&&Ze(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1)))},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=r.x1,c=r.x2,u=r.y1,h=r.y2,f=t?i:a;if(!(!f||!Ze(f))){var d=0,p,v,g,m,x,_;t?(g=l,m=u,p=c-l,v=h-u,x=o||0,_=this.markerStartAngle):(g=c,m=h,p=l-c,v=u-h,x=s||0,_=this.markerEndAngle),d=Math.atan2(v,p),f.setLocalEulerAngles(d*180/Math.PI+_),f.setLocalPosition(g+Math.cos(d)*x,m+Math.sin(d)*x)}},e.prototype.getPoint=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle,a=i.x1,o=i.y1,s=i.x2,l=i.y2,c=kr(a,o,s,l,t),u=c.x,h=c.y,f=T.fF(T.Ue(),T.al(u,h,0),r?this.getWorldTransform():this.getLocalTransform());return new cr(f[0],f[1])},e.prototype.getPointAtLength=function(t,r){return r===void 0&&(r=!1),this.getPoint(t/this.getTotalLength(),r)},e.prototype.getTotalLength=function(){var t=this.parsedStyle,r=t.x1,i=t.y1,a=t.x2,o=t.y2;return ps(r,i,a,o)},e}(Xr),zh=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);r=n.call(this,N({type:Rt.PATH,style:rt.enableCSSParsing?N({d:"",miterLimit:""},i):N({},i),initialParsedStyle:rt.enableCSSParsing?null:{miterLimit:4,d:N({},jx)}},a))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd,c=o.markerMid;return s&&Ze(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),c&&Ze(c)&&r.placeMarkerMid(c),l&&Ze(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&Ze(a)&&(this.markerStartAngle=0,a.remove()),o&&Ze(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"?(a&&Ze(a)&&(this.markerEndAngle=0,a.remove()),o&&Ze(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(o)},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=t?i:a;if(!(!l||!Ze(l))){var c=0,u,h,f,d,p,v;if(t){var g=C(this.getStartTangent(),2),m=g[0],x=g[1];f=x[0],d=x[1],u=m[0]-x[0],h=m[1]-x[1],p=o||0,v=this.markerStartAngle}else{var _=C(this.getEndTangent(),2),m=_[0],x=_[1];f=x[0],d=x[1],u=m[0]-x[0],h=m[1]-x[1],p=s||0,v=this.markerEndAngle}c=Math.atan2(h,u),l.setLocalEulerAngles(c*180/Math.PI+v),l.setLocalPosition(f+Math.cos(c)*p,d+Math.sin(c)*p)}},e.prototype.placeMarkerMid=function(t){var r=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(c){c.remove()}),t&&Ze(t))for(var i=1;i<r.length-1;i++){var a=C(r[i].currentPoint,2),o=a[0],s=a[1],l=i===1?t:t.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(o,s)}},e.prototype.getTotalLength=function(){return rb(this)},e.prototype.getPointAtLength=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle.d.absolutePath,a=Im(i,t),o=a.x,s=a.y,l=T.fF(T.Ue(),T.al(o,s,0),r?this.getWorldTransform():this.getLocalTransform());return new cr(l[0],l[1])},e.prototype.getPoint=function(t,r){return r===void 0&&(r=!1),this.getPointAtLength(t*rb(this),r)},e.prototype.getStartTangent=function(){var t=this.parsedStyle.d.segments,r=[];if(t.length>1){var i=t[0].currentPoint,a=t[1].currentPoint,o=t[1].startTangent;r=[],o?(r.push([i[0]-o[0],i[1]-o[1]]),r.push([i[0],i[1]])):(r.push([a[0],a[1]]),r.push([i[0],i[1]]))}return r},e.prototype.getEndTangent=function(){var t=this.parsedStyle.d.segments,r=t.length,i=[];if(r>1){var a=t[r-2].currentPoint,o=t[r-1].currentPoint,s=t[r-1].endTangent;i=[],s?(i.push([o[0]-s[0],o[1]-s[1]]),i.push([o[0],o[1]])):(i.push([a[0],a[1]]),i.push([o[0],o[1]]))}return i},e}(Xr),zv=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=V(t,["style"]);r=n.call(this,N({type:Rt.POLYGON,style:rt.enableCSSParsing?N({points:"",miterLimit:"",isClosed:!0},i):N({},i),initialParsedStyle:rt.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},a))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd,c=o.markerMid;return s&&Ze(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),c&&Ze(c)&&r.placeMarkerMid(c),l&&Ze(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&Ze(a)&&(this.markerStartAngle=0,a.remove()),o&&Ze(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"?(a&&Ze(a)&&(this.markerEndAngle=0,a.remove()),o&&Ze(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(o)},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=r.points,c=(l||{}).points,u=t?i:a;if(!(!u||!Ze(u)||!c)){var h=0,f,d,p,v,g,m;if(p=c[0][0],v=c[0][1],t)f=c[1][0]-c[0][0],d=c[1][1]-c[0][1],g=o||0,m=this.markerStartAngle;else{var x=c.length;this.parsedStyle.isClosed?(f=c[x-1][0]-c[0][0],d=c[x-1][1]-c[0][1]):(p=c[x-1][0],v=c[x-1][1],f=c[x-2][0]-c[x-1][0],d=c[x-2][1]-c[x-1][1]),g=s||0,m=this.markerEndAngle}h=Math.atan2(d,f),u.setLocalEulerAngles(h*180/Math.PI+m),u.setLocalPosition(p+Math.cos(h)*g,v+Math.sin(h)*g)}},e.prototype.placeMarkerMid=function(t){var r=this.parsedStyle.points,i=(r||{}).points;if(this.markerMidList.forEach(function(c){c.remove()}),this.markerMidList=[],t&&Ze(t)&&i)for(var a=1;a<(this.parsedStyle.isClosed?i.length:i.length-1);a++){var o=i[a][0],s=i[a][1],l=a===1?t:t.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(o,s)}},e}(Xr),Fb=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=V(t,["style"]);return n.call(this,N({type:Rt.POLYLINE,style:rt.enableCSSParsing?N({points:"",miterLimit:"",isClosed:!1},r):N({},r),initialParsedStyle:rt.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i))||this}return e.prototype.getTotalLength=function(){return t3(this)},e.prototype.getPointAtLength=function(t,r){return r===void 0&&(r=!1),this.getPoint(t/this.getTotalLength(),r)},e.prototype.getPoint=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var a=[],o=0,s,l,c=this.getTotalLength();i.forEach(function(g,m){i[m+1]&&(s=[0,0],s[0]=o/c,l=ps(g[0],g[1],i[m+1][0],i[m+1][1]),o+=l,s[1]=o/c,a.push(s))}),this.parsedStyle.points.segments=a}var u=0,h=0;this.parsedStyle.points.segments.forEach(function(g,m){t>=g[0]&&t<=g[1]&&(u=(t-g[0])/(g[1]-g[0]),h=m)});var f=kr(i[h][0],i[h][1],i[h+1][0],i[h+1][1],u),d=f.x,p=f.y,v=T.fF(T.Ue(),T.al(d,p,0),r?this.getWorldTransform():this.getLocalTransform());return new cr(v[0],v[1])},e.prototype.getStartTangent=function(){var t=this.parsedStyle.points.points,r=[];return r.push([t[1][0],t[1][1]]),r.push([t[0][0],t[0][1]]),r},e.prototype.getEndTangent=function(){var t=this.parsedStyle.points.points,r=t.length-1,i=[];return i.push([t[r-1][0],t[r-1][1]]),i.push([t[r][0],t[r][1]]),i},e}(zv),$o=function(n){B(e,n);function e(t){return t===void 0&&(t={}),n.call(this,N({type:Rt.RECT},t))||this}return e}(Xr),Wv=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=V(t,["style"]);return n.call(this,N({type:Rt.TEXT,style:rt.enableCSSParsing?N({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:"",lineHeight:"",miterLimit:"",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},r):N({fill:"black"},r)},i))||this}return e.prototype.getComputedTextLength=function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.maxLineWidth)||0},e.prototype.getLineBoundingRects=function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.lineMetrics)||[]},e.prototype.isOverflowing=function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing},e}(Xr),QL=function(){function n(){this.registry={},this.define(Rt.CIRCLE,Gh),this.define(Rt.ELLIPSE,Ib),this.define(Rt.RECT,$o),this.define(Rt.IMAGE,Bb),this.define(Rt.LINE,Gv),this.define(Rt.GROUP,qn),this.define(Rt.PATH,zh),this.define(Rt.POLYGON,zv),this.define(Rt.POLYLINE,Fb),this.define(Rt.TEXT,Wv),this.define(Rt.HTML,Db)}return n.prototype.define=function(e,t){this.registry[e]=t},n.prototype.get=function(e){return this.registry[e]},n}(),FU={number:function(n){return new Ie(n)},percent:function(n){return new Ie(n,"%")},px:function(n){return new Ie(n,"px")},em:function(n){return new Ie(n,"em")},rem:function(n){return new Ie(n,"rem")},deg:function(n){return new Ie(n,"deg")},grad:function(n){return new Ie(n,"grad")},rad:function(n){return new Ie(n,"rad")},turn:function(n){return new Ie(n,"turn")},s:function(n){return new Ie(n,"s")},ms:function(n){return new Ie(n,"ms")},registerProperty:function(n){var e=n.name,t=n.inherits,r=n.interpolable,i=n.initialValue,a=n.syntax;rt.styleValueRegistry.registerMetadata({n:e,inh:t,int:r,d:i,syntax:a})},registerLayout:function(n,e){rt.layoutRegistry.registerLayout(n,e)}},tI=function(n){B(e,n);function e(){var t=n.call(this)||this;t.defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new rt.AnimationTimeline(t)}catch(i){}var r={};return Av.forEach(function(i){var a=i.n,o=i.inh,s=i.d;o&&s&&(r[a]=js(s)?s(Rt.GROUP):s)}),t.documentElement=new qn({id:"g-root",style:r}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),e.prototype.createElement=function(t,r){if(t==="svg")return this.documentElement;var i=this.defaultView.customElements.get(t);i||(console.warn("Unsupported tagName: ",t),i=t==="tspan"?Wv:qn);var a=new i(r);return a.ownerDocument=this,a},e.prototype.createElementNS=function(t,r,i){return this.createElement(r,i)},e.prototype.cloneNode=function(t){throw new Error(Le)},e.prototype.destroy=function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(t){}},e.prototype.elementsFromBBox=function(t,r,i,a){var o=this.defaultView.context.rBushRoot,s=o.search({minX:t,minY:r,maxX:i,maxY:a}),l=[];return s.forEach(function(c){var u=c.displayObject,h=u.parsedStyle.pointerEvents,f=h===void 0?"auto":h,d=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(f);(!d||d&&u.isVisible())&&!u.isCulled()&&u.isInteractive()&&l.push(u)}),l.sort(function(c,u){return u.sortable.renderOrder-c.sortable.renderOrder}),l},e.prototype.elementFromPointSync=function(t,r){var i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height;if(a<0||o<0||a>l||o>c)return null;var u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]}).picked;return d&&d[0]||this.documentElement},e.prototype.elementFromPoint=function(t,r){return j(this,void 0,void 0,function(){var i,a,o,s,l,c,u,h,f,d;return gt(this,function(p){switch(p.label){case 0:return i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height,a<0||o<0||a>l||o>c?[2,null]:(u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]})]);case 1:return d=p.sent().picked,[2,d&&d[0]||this.documentElement]}})})},e.prototype.elementsFromPointSync=function(t,r){var i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height;if(a<0||o<0||a>l||o>c)return[];var u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]}).picked;return d[d.length-1]!==this.documentElement&&d.push(this.documentElement),d},e.prototype.elementsFromPoint=function(t,r){return j(this,void 0,void 0,function(){var i,a,o,s,l,c,u,h,f,d;return gt(this,function(p){switch(p.label){case 0:return i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height,a<0||o<0||a>l||o>c?[2,[]]:(u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]})]);case 1:return d=p.sent().picked,d[d.length-1]!==this.documentElement&&d.push(this.documentElement),[2,d]}})})},e.prototype.appendChild=function(t,r){throw new Error(Ys)},e.prototype.insertBefore=function(t,r){throw new Error(Ys)},e.prototype.removeChild=function(t,r){throw new Error(Ys)},e.prototype.replaceChild=function(t,r,i){throw new Error(Ys)},e.prototype.append=function(){throw new Error(Ys)},e.prototype.prepend=function(){throw new Error(Ys)},e.prototype.getElementById=function(t){return this.documentElement.getElementById(t)},e.prototype.getElementsByName=function(t){return this.documentElement.getElementsByName(t)},e.prototype.getElementsByTagName=function(t){return this.documentElement.getElementsByTagName(t)},e.prototype.getElementsByClassName=function(t){return this.documentElement.getElementsByClassName(t)},e.prototype.querySelector=function(t){return this.documentElement.querySelector(t)},e.prototype.querySelectorAll=function(t){return this.documentElement.querySelectorAll(t)},e.prototype.find=function(t){return this.documentElement.find(t)},e.prototype.findAll=function(t){return this.documentElement.findAll(t)},e}(Zn),eI=function(){function n(e){this.strategies=e}return n.prototype.apply=function(e){var t=e.camera,r=e.renderingService,i=e.renderingContext,a=this.strategies;r.hooks.cull.tap(n.tag,function(o){if(o){var s=o.cullable;return a.length===0?s.visible=i.unculledEntities.indexOf(o.entity)>-1:s.visible=a.every(function(l){return l.isVisible(t,o)}),!o.isCulled()&&o.isVisible()?o:(o.dispatchEvent(new Fn(de.CULLED)),null)}return o}),r.hooks.afterRender.tap(n.tag,function(o){o.cullable.visibilityPlaneMask=-1})},n.tag="Culling",n}(),nI=function(){function n(){var e=this;this.autoPreventDefault=!1,this.rootPointerEvent=new Bv(null),this.rootWheelEvent=new Fv(null),this.onPointerMove=function(t){var r,i,a,o,s=(o=(a=e.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||o===void 0?void 0:o.defaultView;if(!(s.supportsTouchEvents&&t.pointerType==="touch")){var l=e.normalizeToPointerEvent(t,s);try{for(var c=pt(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=e.bootstrapEvent(e.rootPointerEvent,h,s,t);e.context.eventService.mapEvent(f)}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var r,i,a,o,s=(o=(a=e.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||o===void 0?void 0:o.defaultView,l=e.normalizeToPointerEvent(t,s);try{for(var c=pt(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=e.bootstrapEvent(e.rootPointerEvent,h,s,t);e.context.eventService.mapEvent(f)}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}}return n.prototype.apply=function(e){var t=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(a){var o=t.context.renderingService.hooks.pickSync.call({position:a,picked:[],topmost:!0}).picked;return o[0]||null}),r.hooks.pointerWheel.tap(n.tag,function(a){var o=t.normalizeWheelEvent(a);t.context.eventService.mapEvent(o)}),r.hooks.pointerDown.tap(n.tag,function(a){var o,s;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var l=t.normalizeToPointerEvent(a,i);if(t.autoPreventDefault&&l[0].isNormalized){var c=a.cancelable||!("cancelable"in a);c&&a.preventDefault()}try{for(var u=pt(l),h=u.next();!h.done;h=u.next()){var f=h.value,d=t.bootstrapEvent(t.rootPointerEvent,f,i,a);t.context.eventService.mapEvent(d)}}catch(p){o={error:p}}finally{try{h&&!h.done&&(s=u.return)&&s.call(u)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerUp.tap(n.tag,function(a){var o,s;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var l=t.context.contextService.getDomElement(),c=t.context.eventService.isNativeEventFromCanvas(l,a),u=c?"":"outside",h=t.normalizeToPointerEvent(a,i);try{for(var f=pt(h),d=f.next();!d.done;d=f.next()){var p=d.value,v=t.bootstrapEvent(t.rootPointerEvent,p,i,a);v.type+=u,t.context.eventService.mapEvent(v)}}catch(g){o={error:g}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerMove.tap(n.tag,this.onPointerMove),r.hooks.pointerOver.tap(n.tag,this.onPointerMove),r.hooks.pointerOut.tap(n.tag,this.onPointerMove),r.hooks.click.tap(n.tag,this.onClick),r.hooks.pointerCancel.tap(n.tag,function(a){var o,s,l=t.normalizeToPointerEvent(a,i);try{for(var c=pt(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=t.bootstrapEvent(t.rootPointerEvent,h,i,a);t.context.eventService.mapEvent(f)}}catch(d){o={error:d}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)})},n.prototype.bootstrapEvent=function(e,t,r,i){e.view=r,e.originalEvent=null,e.nativeEvent=i,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);var a=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),o=a.x,s=a.y;e.viewport.x=o,e.viewport.y=s;var l=this.context.eventService.viewport2Canvas(e.viewport),c=l.x,u=l.y;return e.canvas.x=c,e.canvas.y=u,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=i.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=K3[e.type]||e.type),e},n.prototype.normalizeWheelEvent=function(e){var t=this.rootWheelEvent;this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;var r=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),i=r.x,a=r.y;t.viewport.x=i,t.viewport.y=a;var o=this.context.eventService.viewport2Canvas(t.viewport),s=o.x,l=o.y;return t.canvas.x=s,t.canvas.y=l,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.nativeEvent=e,t.type=e.type,t},n.prototype.transferMouseData=function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=kv.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null},n.prototype.setCursor=function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default")},n.prototype.normalizeToPointerEvent=function(e,t){var r=[];if(t.isTouchEvent(e))for(var i=0;i<e.changedTouches.length;i++){var a=e.changedTouches[i];Nt(a.button)&&(a.button=0),Nt(a.buttons)&&(a.buttons=1),Nt(a.isPrimary)&&(a.isPrimary=e.touches.length===1&&e.type==="touchstart"),Nt(a.width)&&(a.width=a.radiusX||1),Nt(a.height)&&(a.height=a.radiusY||1),Nt(a.tiltX)&&(a.tiltX=0),Nt(a.tiltY)&&(a.tiltY=0),Nt(a.pointerType)&&(a.pointerType="touch"),Nt(a.pointerId)&&(a.pointerId=a.identifier||0),Nt(a.pressure)&&(a.pressure=a.force||.5),Nt(a.twist)&&(a.twist=0),Nt(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,a.type=e.type,r.push(a)}else if(t.isMouseEvent(e)){var o=e;Nt(o.isPrimary)&&(o.isPrimary=!0),Nt(o.width)&&(o.width=1),Nt(o.height)&&(o.height=1),Nt(o.tiltX)&&(o.tiltX=0),Nt(o.tiltY)&&(o.tiltY=0),Nt(o.pointerType)&&(o.pointerType="mouse"),Nt(o.pointerId)&&(o.pointerId=$3),Nt(o.pressure)&&(o.pressure=.5),Nt(o.twist)&&(o.twist=0),Nt(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,r.push(o)}else r.push(e);return r},n.tag="Event",n}(),rI=[Rt.CIRCLE,Rt.ELLIPSE,Rt.IMAGE,Rt.RECT,Rt.LINE,Rt.POLYLINE,Rt.POLYGON,Rt.TEXT,Rt.PATH,Rt.HTML],iI=function(){function n(){}return n.prototype.isVisible=function(e,t){var r,i,a=t.cullable;if(!a.enable)return!0;var o=t.getRenderBounds();if(lr.isEmpty(o))return!1;var s=e.getFrustum(),l=(i=(r=t.parentNode)===null||r===void 0?void 0:r.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return a.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,o,l||ro.INDETERMINATE,s.planes),a.visible=a.visibilityPlaneMask!==ro.OUTSIDE,a.visible},n.prototype.computeVisibilityWithPlaneMask=function(e,t,r,i){if(r===ro.OUTSIDE||r===ro.INSIDE)return r;for(var a=ro.INSIDE,o=rI.indexOf(e.nodeName)>-1,s=0,l=i.length;s<l;++s){var c=1<<s;if(r&c&&!(o&&(s===4||s===5))){var u=i[s],h=u.normal,f=u.distance;if(T.AK(h,t.getPositiveFarPoint(i[s]))+f<0)return ro.OUTSIDE;T.AK(h,t.getNegativeFarPoint(i[s]))+f<0&&(a|=c)}}return a},n}(),aI=function(){function n(){this.toSync=new Set,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return n.prototype.apply=function(e){var t=this,r,i=e.renderingService,a=e.renderingContext,o=e.rBushRoot,s=a.root.ownerDocument.defaultView;this.rBush=o;var l=function(d){var p=d.target;p.renderable.dirty=!0,i.dirtify()},c=function(d){var p=d.detail.affectChildren,v=d.target;p&&v.forEach(function(m){t.toSync.add(m)});for(var g=v;g;)g.renderable&&t.toSync.add(g),g=g.parentElement;i.dirtify()},u=function(d){var p=d.target;rt.enableSizeAttenuation&&rt.styleValueRegistry.updateSizeAttenuation(p,s.getCamera().getZoom()),rt.enableCSSParsing&&rt.styleValueRegistry.recalc(p),rt.sceneGraphService.dirtifyToRoot(p),i.dirtify()},h=function(d){var p=d.target,v=p.rBushNode;v.aabb&&t.rBush.remove(v.aabb),t.toSync.delete(p),rt.sceneGraphService.dirtifyToRoot(p),i.dirtify()};i.hooks.init.tap(n.tag,function(){s.addEventListener(de.MOUNTED,u),s.addEventListener(de.UNMOUNTED,h),s.addEventListener(de.ATTR_MODIFIED,l),s.addEventListener(de.BOUNDS_CHANGED,c)}),i.hooks.destroy.tap(n.tag,function(){s.removeEventListener(de.MOUNTED,u),s.removeEventListener(de.UNMOUNTED,h),s.removeEventListener(de.ATTR_MODIFIED,l),s.removeEventListener(de.BOUNDS_CHANGED,c),t.toSync.clear()});var f=(r=rt.globalThis.requestIdleCallback)!==null&&r!==void 0?r:Lv.bind(rt.globalThis);i.hooks.endFrame.tap(n.tag,function(){t.isFirstTimeRendering?(t.isFirstTimeRendering=!1,t.syncing=!0,f(function(){t.syncRTree(!0),t.isFirstTimeRenderingFinished=!0})):t.syncRTree()})},n.prototype.syncRTree=function(e){var t=this;if(e===void 0&&(e=!1),!(!e&&(this.syncing||this.toSync.size===0))){this.syncing=!0;var r=[];Array.from(this.toSync).filter(function(i){return i.isConnected}).forEach(function(i){var a=i.rBushNode;a&&a.aabb&&t.rBush.remove(a.aabb);var o=i.getRenderBounds();if(o){var s=i.renderable;e&&(s.dirtyRenderBounds||(s.dirtyRenderBounds=new lr),s.dirtyRenderBounds.update(o.center,o.halfExtents));var l=C(o.getMin(),2),c=l[0],u=l[1],h=C(o.getMax(),2),f=h[0],d=h[1];a.aabb||(a.aabb={}),a.aabb.displayObject=i,a.aabb.minX=c,a.aabb.minY=u,a.aabb.maxX=f,a.aabb.maxY=d}a.aabb&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.minX)&&!isNaN(a.aabb.minY)&&r.push(a.aabb)}),this.rBush.load(r),r.length=0,this.toSync.clear(),this.syncing=!1}},n.tag="Prepare",n}();function GU(n){return!!n.document}var ji;(function(n){n.READY="ready",n.BEFORE_RENDER="beforerender",n.RERENDER="rerender",n.AFTER_RENDER="afterrender",n.BEFORE_DESTROY="beforedestroy",n.AFTER_DESTROY="afterdestroy",n.RESIZE="resize",n.DIRTY_RECTANGLE="dirtyrectangle",n.RENDERER_CHANGED="rendererchanged"})(ji||(ji={}));var Gb=500,oI=.1,sI=1e3,Uv=new Fn(de.MOUNTED),Vv=new Fn(de.UNMOUNTED),zb=new Fn(ji.BEFORE_RENDER),lI=new Fn(ji.RERENDER),Wb=new Fn(ji.AFTER_RENDER),zU=function(n){B(e,n);function e(t){var r=n.call(this)||this;r.Element=Xr,r.inited=!1,r.context={},r.document=new tI,r.document.defaultView=r,r.customElements=new QL;var i=t.container,a=t.canvas,o=t.offscreenCanvas,s=t.width,l=t.height,c=t.devicePixelRatio,u=t.renderer,h=t.background,f=t.cursor,d=t.document,p=t.requestAnimationFrame,v=t.cancelAnimationFrame,g=t.createImage,m=t.supportsPointerEvents,x=t.supportsTouchEvents,_=t.supportsCSSTransform,S=t.supportsMutipleCanvasesInOneContainer,b=t.useNativeClickEvent,y=t.alwaysTriggerPointerEventOnCanvas,E=t.isTouchEvent,w=t.isMouseEvent;S||U3(i,r);var M=s,P=l,A=c;return a&&(A=c||Rv&&window.devicePixelRatio||1,A=A>=1?Math.ceil(A):1,M=s||X3(a)||a.width/A,P=l||j3(a)||a.height/A),o&&(rt.offscreenCanvas=o),r.devicePixelRatio=A,r.requestAnimationFrame=p!=null?p:Lv.bind(rt.globalThis),r.cancelAnimationFrame=v!=null?v:Sb.bind(rt.globalThis),r.supportsTouchEvents=x!=null?x:"ontouchstart"in rt.globalThis,r.supportsPointerEvents=m!=null?m:!!rt.globalThis.PointerEvent,r.isTouchEvent=E!=null?E:function(O){return r.supportsTouchEvents&&O instanceof rt.globalThis.TouchEvent},r.isMouseEvent=w!=null?w:function(O){return!rt.globalThis.MouseEvent||O instanceof rt.globalThis.MouseEvent&&(!r.supportsPointerEvents||!(O instanceof rt.globalThis.PointerEvent))},r.initRenderingContext({container:i,canvas:a,width:M,height:P,renderer:u,offscreenCanvas:o,devicePixelRatio:A,cursor:f||"default",background:h||"transparent",createImage:g,document:d,supportsCSSTransform:_,useNativeClickEvent:b,alwaysTriggerPointerEventOnCanvas:y}),r.initDefaultCamera(M,P,u.clipSpaceNearZ),r.initRenderer(u,!0),r}return e.prototype.initRenderingContext=function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}},e.prototype.initDefaultCamera=function(t,r,i){var a=this,o=new rt.CameraContribution;o.clipSpaceNearZ=i,o.setType(_e.EXPLORING,ac.DEFAULT).setPosition(t/2,r/2,Gb).setFocalPoint(t/2,r/2,0).setOrthographic(t/-2,t/2,r/2,r/-2,oI,sI),o.canvas=this,o.eventEmitter.on(zx.UPDATED,function(){a.context.renderingContext.renderReasons.add(Qs.CAMERA_CHANGED),rt.enableSizeAttenuation&&a.getConfig().renderer.getConfig().enableSizeAttenuation&&a.updateSizeAttenuation()}),this.context.camera=o},e.prototype.updateSizeAttenuation=function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach(function(r){rt.styleValueRegistry.updateSizeAttenuation(r,t)})},e.prototype.getConfig=function(){return this.context.config},e.prototype.getRoot=function(){return this.document.documentElement},e.prototype.getCamera=function(){return this.context.camera},e.prototype.getContextService=function(){return this.context.contextService},e.prototype.getEventService=function(){return this.context.eventService},e.prototype.getRenderingService=function(){return this.context.renderingService},e.prototype.getRenderingContext=function(){return this.context.renderingContext},e.prototype.getStats=function(){return this.getRenderingService().getStats()},Object.defineProperty(e.prototype,"ready",{get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise(function(r){t.resolveReadyPromise=function(){r(t)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t,r){if(t===void 0&&(t=!0),r===void 0&&(r=!1),r||this.dispatchEvent(new Fn(ji.BEFORE_DESTROY)),this.frameId){var i=this.getConfig().cancelAnimationFrame||cancelAnimationFrame;i(this.frameId)}var a=this.getRoot();this.unmountChildren(a),t&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),t&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),r||this.dispatchEvent(new Fn(ji.AFTER_DESTROY))},e.prototype.changeSize=function(t,r){this.resize(t,r)},e.prototype.resize=function(t,r){var i=this.context.config;i.width=t,i.height=r,this.getContextService().resize(t,r);var a=this.context.camera,o=a.getProjectionMode();a.setPosition(t/2,r/2,Gb).setFocalPoint(t/2,r/2,0),o===Ur.ORTHOGRAPHIC?a.setOrthographic(t/-2,t/2,r/2,r/-2,a.getNear(),a.getFar()):a.setAspect(t/r),this.dispatchEvent(new Fn(ji.RESIZE,{width:t,height:r}))},e.prototype.appendChild=function(t,r){return this.document.documentElement.appendChild(t,r)},e.prototype.insertBefore=function(t,r){return this.document.documentElement.insertBefore(t,r)},e.prototype.removeChild=function(t){return this.document.documentElement.removeChild(t)},e.prototype.removeChildren=function(){this.document.documentElement.removeChildren()},e.prototype.destroyChildren=function(){this.document.documentElement.destroyChildren()},e.prototype.render=function(t){var r=this;t&&(zb.detail=t,Wb.detail=t),this.dispatchEvent(zb);var i=this.getRenderingService();i.render(this.getConfig(),t,function(){r.dispatchEvent(lI)}),this.dispatchEvent(Wb)},e.prototype.run=function(){var t=this,r=function(i,a){t.render(a),t.frameId=t.requestAnimationFrame(r)};r()},e.prototype.initRenderer=function(t,r){var i=this;if(r===void 0&&(r=!1),!t)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new sk,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new nI,new aI,new eI([new iI])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService(N(N({},rt),this.context)),this.context.renderingService=new ML(rt,this.context),this.context.eventService=new TL(rt,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,r,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(t,r)})},e.prototype.initRenderingService=function(t,r,i){var a=this;r===void 0&&(r=!1),i===void 0&&(i=!1),this.context.renderingService.init(function(){a.inited=!0,r?(i?a.requestAnimationFrame(function(){a.dispatchEvent(new Fn(ji.READY))}):a.dispatchEvent(new Fn(ji.READY)),a.readyPromise&&a.resolveReadyPromise()):a.dispatchEvent(new Fn(ji.RENDERER_CHANGED)),r||a.getRoot().forEach(function(o){var s=o.renderable;s&&(s.renderBoundsDirty=!0,s.boundsDirty=!0,s.dirty=!0)}),a.mountChildren(a.getRoot()),t.getConfig().enableAutoRendering&&a.run()})},e.prototype.loadRendererContainerModule=function(t){var r=this,i=t.getPlugins();i.forEach(function(a){a.context=r.context,a.init(rt)})},e.prototype.setRenderer=function(t){var r=this.getConfig();if(r.renderer!==t){var i=r.renderer;r.renderer=t,this.destroy(!1,!0),K([],C(i==null?void 0:i.getPlugins()),!1).reverse().forEach(function(a){a.destroy(rt)}),this.initRenderer(t)}},e.prototype.setCursor=function(t){var r=this.getConfig();r.cursor=t,this.getContextService().applyCursorStyle(t)},e.prototype.unmountChildren=function(t){var r=this;t.childNodes.forEach(function(i){r.unmountChildren(i)}),this.inited&&(t.isMutationObserved?t.dispatchEvent(Vv):(Vv.target=t,this.dispatchEvent(Vv,!0)),t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1),t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()},e.prototype.mountChildren=function(t){var r=this;this.inited?t.isConnected||(t.ownerDocument=this.document,t.isConnected=!0,t.isMutationObserved?t.dispatchEvent(Uv):(Uv.target=t,this.dispatchEvent(Uv,!0))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName),t.childNodes.forEach(function(i){r.mountChildren(i)}),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()},e.prototype.client2Viewport=function(t){return this.getEventService().client2Viewport(t)},e.prototype.viewport2Client=function(t){return this.getEventService().viewport2Client(t)},e.prototype.viewport2Canvas=function(t){return this.getEventService().viewport2Canvas(t)},e.prototype.canvas2Viewport=function(t){return this.getEventService().canvas2Viewport(t)},e.prototype.getPointByClient=function(t,r){return this.client2Viewport({x:t,y:r})},e.prototype.getClientByPoint=function(t,r){return this.viewport2Client({x:t,y:r})},e}(Mb),cI=function(n){B(e,n);function e(){var t=n.apply(this,K([],C(arguments),!1))||this;return t.landmarks=[],t}return e.prototype.rotate=function(t,r,i){if(this.relElevation=Hs(r),this.relAzimuth=Hs(t),this.relRoll=Hs(i),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===_e.EXPLORING){var a=Bn(Vt(),[1,0,0],ke((this.rotateWorld?1:-1)*this.relElevation)),o=Bn(Vt(),[0,1,0],ke((this.rotateWorld?1:-1)*this.relAzimuth)),s=Bn(Vt(),[0,0,1],ke(this.relRoll)),l=Ln(Vt(),o,a);l=Ln(Vt(),l,s);var c=Fa(Q(),l);Ee(this.matrix,this.matrix,[0,0,-this.distance]),Ut(this.matrix,this.matrix,c),Ee(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===_e.ORBITING||this.type===_e.EXPLORING?this._getPosition():this.type===_e.TRACKING&&this._getFocalPoint(),this._update(),this},e.prototype.pan=function(t,r){var i=Sr(t,r,0),a=T.d9(this.position);return T.IH(a,a,T.bA(T.Ue(),this.right,i[0])),T.IH(a,a,T.bA(T.Ue(),this.up,i[1])),this._setPosition(a),this.triggerUpdate(),this},e.prototype.dolly=function(t){var r=this.forward,i=T.d9(this.position),a=t*this.dollyingStep,o=this.distance+t*this.dollyingStep;return a=Math.max(Math.min(o,this.maxDistance),this.minDistance)-this.distance,i[0]+=a*r[0],i[1]+=a*r[1],i[2]+=a*r[2],this._setPosition(i),this.type===_e.ORBITING||this.type===_e.EXPLORING?this._getDistance():this.type===_e.TRACKING&&T.IH(this.focalPoint,i,this.distanceVector),this.triggerUpdate(),this},e.prototype.cancelLandmarkAnimation=function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)},e.prototype.createLandmark=function(t,r){var i,a,o,s;r===void 0&&(r={});var l=r.position,c=l===void 0?this.position:l,u=r.focalPoint,h=u===void 0?this.focalPoint:u,f=r.roll,d=r.zoom,p=new rt.CameraContribution;p.setType(this.type,void 0),p.setPosition(c[0],(i=c[1])!==null&&i!==void 0?i:this.position[1],(a=c[2])!==null&&a!==void 0?a:this.position[2]),p.setFocalPoint(h[0],(o=h[1])!==null&&o!==void 0?o:this.focalPoint[1],(s=h[2])!==null&&s!==void 0?s:this.focalPoint[2]),p.setRoll(f!=null?f:this.roll),p.setZoom(d!=null?d:this.zoom);var v={name:t,matrix:Ft(p.getWorldTransform()),right:T.d9(p.right),up:T.d9(p.up),forward:T.d9(p.forward),position:T.d9(p.getPosition()),focalPoint:T.d9(p.getFocalPoint()),distanceVector:T.d9(p.getDistanceVector()),distance:p.getDistance(),dollyingStep:p.getDollyingStep(),azimuth:p.getAzimuth(),elevation:p.getElevation(),roll:p.getRoll(),relAzimuth:p.relAzimuth,relElevation:p.relElevation,relRoll:p.relRoll,zoom:p.getZoom()};return this.landmarks.push(v),v},e.prototype.gotoLandmark=function(t,r){var i=this;r===void 0&&(r={});var a=ue(t)?this.landmarks.find(function(P){return P.name===t}):t;if(a){var o=fe(r)?{duration:r}:r,s=o.easing,l=s===void 0?"linear":s,c=o.duration,u=c===void 0?100:c,h=o.easingFunction,f=h===void 0?void 0:h,d=o.onfinish,p=d===void 0?void 0:d,v=o.onframe,g=v===void 0?void 0:v,m=.01;this.cancelLandmarkAnimation();var x=a.position,_=a.focalPoint,S=a.zoom,b=a.roll,y=f||rt.EasingFunction(l),E,w=function(){i.setFocalPoint(_),i.setPosition(x),i.setRoll(b),i.setZoom(S),i.computeMatrix(),i.triggerUpdate(),p==null||p()};if(u===0)return w();var M=function(P){E===void 0&&(E=P);var A=P-E;if(A>=u){w();return}var O=y(A/u),R=T.Ue(),L=T.Ue(),z=1,Y=0;T.t7(R,i.focalPoint,_,O),T.t7(L,i.position,x,O),Y=i.roll*(1-O)+b*O,z=i.zoom*(1-O)+S*O,i.setFocalPoint(R),i.setPosition(L),i.setRoll(Y),i.setZoom(z);var I=T.TK(R,_)+T.TK(L,x);if(I<=m&&S==null&&b==null)return w();i.computeMatrix(),i.triggerUpdate(),A<u&&(g==null||g(O),i.landmarkAnimationID=i.canvas.requestAnimationFrame(M))};this.canvas.requestAnimationFrame(M)}},e}(Ux);rt.CameraContribution=cI;var Ub=function(){function n(e,t){this.type=e,this.target=t,this.addedNodes=[],this.attributeName=null,this.attributeNamespace=null,this.nextSibling=null,this.oldValue=null,this.previousSibling=null,this.removedNodes=[]}return n.copy=function(e){var t=new n(e.type,e.target);return t.addedNodes=e.addedNodes.slice(),t.removedNodes=e.removedNodes.slice(),t.previousSibling=e.previousSibling,t.nextSibling=e.nextSibling,t.attributeName=e.attributeName,t.attributeNamespace=e.attributeNamespace,t.oldValue=e.oldValue,t},n}(),uI=0,tl=new WeakMap,hI=function(){function n(e,t,r){this.observer=e,this.target=t,this.options=r,this.transientObservedNodes=[]}return n.prototype.enqueue=function(e){var t=this.observer.records,r=t.length;if(t.length>0){var i=t[r-1],a=vI(i,e);if(a){t[r-1]=a;return}}else mI(this.observer);t[r]=e},n.prototype.addListeners=function(){this.addListeners_(this.target)},n.prototype.addListeners_=function(e){var t=this.options;t.attributes&&e.addEventListener(de.ATTR_MODIFIED,this,!0),t.childList&&e.addEventListener(de.INSERTED,this,!0),(t.childList||t.subtree)&&e.addEventListener(de.REMOVED,this,!0)},n.prototype.removeListeners=function(){this.removeListeners_(this.target)},n.prototype.removeListeners_=function(e){var t=this.options;t.attributes&&e.removeEventListener(de.ATTR_MODIFIED,this,!0),t.childList&&e.removeEventListener(de.INSERTED,this,!0),(t.childList||t.subtree)&&e.removeEventListener(de.REMOVED,this,!0)},n.prototype.removeTransientObservers=function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(t){this.removeListeners_(t);for(var r=tl.get(t),i=0;i<r.length;i++)if(r[i]===this){r.splice(i,1);break}},this)},n.prototype.handleEvent=function(e){e.stopImmediatePropagation();var t,r;switch(e.type){case de.ATTR_MODIFIED:var i=e.attrName,a=e.relatedNode.namespaceURI;r=e.target,t=Vb("attributes",r),t.attributeName=i,t.attributeNamespace=a;var o=e.attrChange===oo.ADDITION?null:e.prevValue;Hb(r,function(f){if(f.attributes&&!(f.attributeFilter&&f.attributeFilter.length&&f.attributeFilter.indexOf(i)===-1&&f.attributeFilter.indexOf(a)===-1))return f.attributeOldValue?fI(o):t});break;case de.REMOVED:case de.INSERTED:r=e.relatedNode;var s=e.target,l=void 0,c=void 0;e.type===de.INSERTED?(l=[s],c=[]):(l=[],c=[s]);var u=s.previousSibling,h=s.nextSibling;t=Vb("childList",r),t.addedNodes=l,t.removedNodes=c,t.previousSibling=u,t.nextSibling=h,Hb(r,function(f){if(f.childList)return t})}dI()},n}(),WU=function(){function n(e){this.callback=e,this.nodes=[],this.records=[],this.uid=uI++}return n.prototype.observe=function(e,t){if(!t.childList&&!t.attributes&&!t.characterData||t.attributeOldValue&&!t.attributes||t.attributeFilter&&t.attributeFilter.length&&!t.attributes||t.characterDataOldValue&&!t.characterData)throw new SyntaxError;var r=tl.get(e);r||tl.set(e,r=[]);for(var i,a=0;a<r.length;a++)if(r[a].observer===this){i=r[a],i.removeListeners(),i.options=t;break}i||(i=new hI(this,e,t),r.push(i),this.nodes.push(e)),i.addListeners()},n.prototype.disconnect=function(){var e=this;this.nodes.forEach(function(t){for(var r=tl.get(t),i=0;i<r.length;i++){var a=r[i];if(a.observer===e){a.removeListeners(),r.splice(i,1);break}}},this),this.records=[]},n.prototype.takeRecords=function(){var e=this.records;return this.records=[],e},n}(),Wh,Ra;function Vb(n,e){return Wh=new Ub(n,e)}function fI(n){return Ra||(Ra=Ub.copy(Wh),Ra.oldValue=n,Ra)}function dI(){Wh=Ra=void 0}function pI(n){return n===Ra||n===Wh}function vI(n,e){return n===e?n:Ra&&pI(n)?Ra:null}function gI(n){n.nodes.forEach(function(e){var t=tl.get(e);t&&t.forEach(function(r){r.observer===n&&r.removeTransientObservers()})})}function Hb(n,e){for(var t=n;t;t=t.parentNode){var r=tl.get(t);if(r)for(var i=0;i<r.length;i++){var a=r[i],o=a.options;if(!(t!==n&&!o.subtree)){var s=e(o);s&&a.enqueue(s)}}}}var Hv=!1,Yv=[];function mI(n){Yv.push(n),Hv||(Hv=!0,typeof rt.globalThis!="undefined"?rt.globalThis.setTimeout(Xv):Xv())}function Xv(){Hv=!1;var n=Yv;Yv=[],n.sort(function(t,r){return t.uid-r.uid});var e=!1;n.forEach(function(t){var r=t.takeRecords();gI(t),r.length&&(t.callback(r,t),e=!0)}),e&&Xv()}var jv=function(n){B(e,n);function e(t,r,i,a){var o=n.call(this,t)||this;return o.currentTime=i,o.timelineTime=a,o.target=r,o.type="finish",o.bubbles=!1,o.currentTarget=r,o.defaultPrevented=!1,o.eventPhase=o.AT_TARGET,o.timeStamp=Date.now(),o.currentTime=i,o.timelineTime=a,o}return e}(Fh),yI=0,xI=function(){function n(e,t){var r;this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=t,this.id="".concat(yI++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((r=this.effect)===null||r===void 0?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return Object.defineProperty(n.prototype,"pending",{get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playState",{get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ready",{get:function(){var e=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(t,r){e.resolveReadyPromise=function(){t(e)},e.rejectReadyPromise=function(){r(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"finished",{get:function(){var e=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(t,r){e.resolveFinishedPromise=function(){t(e)},e.rejectFinishedPromise=function(){r(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(e){var t;e=Number(e),!isNaN(e)&&(this.timeline.restart(),!this._paused&&this._startTime!==null&&(this._startTime=Number((t=this.timeline)===null||t===void 0?void 0:t.currentTime)-e/this.playbackRate),this.currentTimePending=!1,this._currentTime!==e&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(e,!0),this.timeline.applyDirtiedAnimation(this)))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"startTime",{get:function(){return this._startTime},set:function(e){if(e!==null){if(this.updatePromises(),e=Number(e),isNaN(e)||this._paused||this._idle)return;this._startTime=e,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(e){if(e!==this._playbackRate){this.updatePromises();var t=this.currentTime;this._playbackRate=e,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),t!==null&&(this.currentTime=t),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_isFinished",{get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"totalDuration",{get:function(){return this._totalDuration},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_needsTick",{get:function(){return this.pending||this.playState==="running"||!this._finishedFlag},enumerable:!1,configurable:!0}),n.prototype.updatePromises=function(){var e=this.oldPlayState,t=this.pending?"pending":this.playState;return this.readyPromise&&t!==e&&(t==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):e==="pending"?this.resolveReadyPromise():t==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&t!==e&&(t==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):t==="finished"?this.resolveFinishedPromise():e==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=t,this.readyPromise||this.finishedPromise},n.prototype.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()},n.prototype.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()},n.prototype.finish=function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},n.prototype.cancel=function(){var e=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var t=new jv(null,this,this.currentTime,null);setTimeout(function(){e.oncancel(t)})}},n.prototype.reverse=function(){this.updatePromises();var e=this.currentTime;this.playbackRate*=-1,this.play(),e!==null&&(this.currentTime=e),this.updatePromises()},n.prototype.updatePlaybackRate=function(e){this.playbackRate=e},n.prototype.targetAnimations=function(){var e,t=(e=this.effect)===null||e===void 0?void 0:e.target;return t.getAnimations()},n.prototype.markTarget=function(){var e=this.targetAnimations();e.indexOf(this)===-1&&e.push(this)},n.prototype.unmarkTarget=function(){var e=this.targetAnimations(),t=e.indexOf(this);t!==-1&&e.splice(t,1)},n.prototype.tick=function(e,t){!this._idle&&!this._paused&&(this._startTime===null?t&&(this.startTime=e-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((e-this._startTime)*this.playbackRate)),t&&(this.currentTimePending=!1,this.fireEvents(e))},n.prototype.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")},n.prototype.persist=function(){throw new Error(Le)},n.prototype.addEventListener=function(e,t,r){throw new Error(Le)},n.prototype.removeEventListener=function(e,t,r){throw new Error(Le)},n.prototype.dispatchEvent=function(e){throw new Error(Le)},n.prototype.commitStyles=function(){throw new Error(Le)},n.prototype.ensureAlive=function(){var e,t;this.playbackRate<0&&this.currentTime===0?this._inEffect=!!(!((e=this.effect)===null||e===void 0)&&e.update(-1)):this._inEffect=!!(!((t=this.effect)===null||t===void 0)&&t.update(this.currentTime)),!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))},n.prototype.tickCurrentTime=function(e,t){e!==this._currentTime&&(this._currentTime=e,this._isFinished&&!t&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())},n.prototype.fireEvents=function(e){var t=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var r=new jv(null,this,this.currentTime,e);setTimeout(function(){t.onfinish&&t.onfinish(r)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var i=new jv(null,this,this.currentTime,e);this.onframe(i)}this._finishedFlag=!1}},n}(),bI=4,EI=.001,wI=1e-7,_I=10,uc=11,Uh=1/(uc-1),SI=typeof Float32Array=="function",Yb=function(n,e){return 1-3*e+3*n},Xb=function(n,e){return 3*e-6*n},jb=function(n){return 3*n},Vh=function(n,e,t){return((Yb(e,t)*n+Xb(e,t))*n+jb(e))*n},$b=function(n,e,t){return 3*Yb(e,t)*n*n+2*Xb(e,t)*n+jb(e)},TI=function(n,e,t,r,i){var a,o,s=0;do o=e+(t-e)/2,a=Vh(o,r,i)-n,a>0?t=o:e=o;while(Math.abs(a)>wI&&++s<_I);return o},PI=function(n,e,t,r){for(var i=0;i<bI;++i){var a=$b(e,t,r);if(a===0)return e;var o=Vh(e,t,r)-n;e-=o/a}return e},$v=function(n,e,t,r){if(!(0<=n&&n<=1&&0<=t&&t<=1))throw new Error("bezier x values must be in [0, 1] range");if(n===e&&t===r)return function(s){return s};for(var i=SI?new Float32Array(uc):new Array(uc),a=0;a<uc;++a)i[a]=Vh(a*Uh,n,t);var o=function(s){for(var l=0,c=1,u=uc-1;c!==u&&i[c]<=s;++c)l+=Uh;--c;var h=(s-i[c])/(i[c+1]-i[c]),f=l+h*Uh,d=$b(f,n,t);return d>=EI?PI(s,f,n,t):d===0?f:TI(s,l,l+Uh,n,t)};return function(s){return s===0||s===1?s:Vh(o(s),e,r)}},MI=function(n){return n=n.replace(/([A-Z])/g,function(e){return"-".concat(e.toLowerCase())}),n.charAt(0)==="-"?n.substring(1):n},Hh=function(n){return Math.pow(n,2)},Yh=function(n){return Math.pow(n,3)},Xh=function(n){return Math.pow(n,4)},jh=function(n){return Math.pow(n,5)},$h=function(n){return Math.pow(n,6)},Kh=function(n){return 1-Math.cos(n*Math.PI/2)},Zh=function(n){return 1-Math.sqrt(1-n*n)},qh=function(n){return n*n*(3*n-2)},Jh=function(n){for(var e,t=4;n<((e=Math.pow(2,--t))-1)/11;);return 1/Math.pow(4,3-t)-7.5625*Math.pow((e*3-2)/22-n,2)},Qh=function(n,e){e===void 0&&(e=[]);var t=C(e,2),r=t[0],i=r===void 0?1:r,a=t[1],o=a===void 0?.5:a,s=me(Number(i),1,10),l=me(Number(o),.1,2);return n===0||n===1?n:-s*Math.pow(2,10*(n-1))*Math.sin((n-1-l/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/l)},hc=function(n,e,t){e===void 0&&(e=[]);var r=C(e,4),i=r[0],a=i===void 0?1:i,o=r[1],s=o===void 0?100:o,l=r[2],c=l===void 0?10:l,u=r[3],h=u===void 0?0:u;a=me(a,.1,1e3),s=me(s,.1,1e3),c=me(c,.1,1e3),h=me(h,.1,1e3);var f=Math.sqrt(s/a),d=c/(2*Math.sqrt(s*a)),p=d<1?f*Math.sqrt(1-d*d):0,v=1,g=d<1?(d*f+-h)/p:-h+f,m=t?t*n/1e3:n;return d<1?m=Math.exp(-m*d*f)*(v*Math.cos(p*m)+g*Math.sin(p*m)):m=(v+g*m)*Math.exp(-m*f),n===0||n===1?n:1-m},Kv=function(n,e){e===void 0&&(e=[]);var t=C(e,2),r=t[0],i=r===void 0?10:r,a=t[1],o=a=="start"?Math.ceil:Math.floor;return o(me(n,0,1)*i)/i},Kb=function(n,e){e===void 0&&(e=[]);var t=C(e,4),r=t[0],i=t[1],a=t[2],o=t[3];return $v(r,i,a,o)(n)},tf=$v(.42,0,1,1),ki=function(n){return function(e,t,r){return t===void 0&&(t=[]),1-n(1-e,t,r)}},Li=function(n){return function(e,t,r){return t===void 0&&(t=[]),e<.5?n(e*2,t,r)/2:1-n(e*-2+2,t,r)/2}},Ii=function(n){return function(e,t,r){return t===void 0&&(t=[]),e<.5?(1-n(1-e*2,t,r))/2:(n(e*2-1,t,r)+1)/2}},Zb={steps:Kv,"step-start":function(n){return Kv(n,[1,"start"])},"step-end":function(n){return Kv(n,[1,"end"])},linear:function(n){return n},"cubic-bezier":Kb,ease:function(n){return Kb(n,[.25,.1,.25,1])},in:tf,out:ki(tf),"in-out":Li(tf),"out-in":Ii(tf),"in-quad":Hh,"out-quad":ki(Hh),"in-out-quad":Li(Hh),"out-in-quad":Ii(Hh),"in-cubic":Yh,"out-cubic":ki(Yh),"in-out-cubic":Li(Yh),"out-in-cubic":Ii(Yh),"in-quart":Xh,"out-quart":ki(Xh),"in-out-quart":Li(Xh),"out-in-quart":Ii(Xh),"in-quint":jh,"out-quint":ki(jh),"in-out-quint":Li(jh),"out-in-quint":Ii(jh),"in-expo":$h,"out-expo":ki($h),"in-out-expo":Li($h),"out-in-expo":Ii($h),"in-sine":Kh,"out-sine":ki(Kh),"in-out-sine":Li(Kh),"out-in-sine":Ii(Kh),"in-circ":Zh,"out-circ":ki(Zh),"in-out-circ":Li(Zh),"out-in-circ":Ii(Zh),"in-back":qh,"out-back":ki(qh),"in-out-back":Li(qh),"out-in-back":Ii(qh),"in-bounce":Jh,"out-bounce":ki(Jh),"in-out-bounce":Li(Jh),"out-in-bounce":Ii(Jh),"in-elastic":Qh,"out-elastic":ki(Qh),"in-out-elastic":Li(Qh),"out-in-elastic":Ii(Qh),spring:hc,"spring-in":hc,"spring-out":ki(hc),"spring-in-out":Li(hc),"spring-out-in":Ii(hc)},CI=function(n){return MI(n).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},AI=function(n){return Zb[CI(n)]||Zb.linear},OI=function(n){return n},NI=1,RI=.5,qb=0;function Jb(n,e){return function(t){if(t>=1)return 1;var r=1/n;return t+=e*r,t-t%r}}var ef="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",kI=new RegExp("cubic-bezier\\("+ef+","+ef+","+ef+","+ef+"\\)"),LI=/steps\(\s*(\d+)\s*\)/,II=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function Zv(n){var e=kI.exec(n);if(e)return $v.apply(void 0,K([],C(e.slice(1).map(Number)),!1));var t=LI.exec(n);if(t)return Jb(Number(t[1]),qb);var r=II.exec(n);return r?Jb(Number(r[1]),{start:NI,middle:RI,end:qb}[r[2]]):AI(n)}function DI(n){return Math.abs(BI(n)/(n.playbackRate||1))}function BI(n){var e;return n.duration===0||n.iterations===0?0:(n.duration==="auto"?0:Number(n.duration))*((e=n.iterations)!==null&&e!==void 0?e:1)}var Qb=0,qv=1,nf=2,tE=3;function FI(n,e,t){if(e===null)return Qb;var r=t.endTime;return e<Math.min(t.delay,r)?qv:e>=Math.min(t.delay+n+t.endDelay,r)?nf:tE}function GI(n,e,t,r,i){switch(r){case qv:return e==="backwards"||e==="both"?0:null;case tE:return t-i;case nf:return e==="forwards"||e==="both"?n:null;case Qb:return null}}function zI(n,e,t,r,i){var a=i;return n===0?e!==qv&&(a+=t):a+=r/n,a}function WI(n,e,t,r,i,a){var o=n===1/0?e%1:n%1;return o===0&&t===nf&&r!==0&&(i!==0||a===0)&&(o=1),o}function UI(n,e,t,r){return n===nf&&e===1/0?1/0:t===1?Math.floor(r)-1:Math.floor(r)}function VI(n,e,t){var r=n;if(n!=="normal"&&n!=="reverse"){var i=e;n==="alternate-reverse"&&(i+=1),r="normal",i!==1/0&&i%2!==0&&(r="reverse")}return r==="normal"?t:1-t}function HI(n,e,t){var r=FI(n,e,t),i=GI(n,t.fill,e,r,t.delay);if(i===null)return null;var a=t.duration==="auto"?0:t.duration,o=zI(a,r,t.iterations,i,t.iterationStart),s=WI(o,t.iterationStart,r,t.iterations,i,a),l=UI(r,t.iterations,s,o),c=VI(t.direction,l,s);return t.currentIteration=l,t.progress=c,t.easingFunction(c)}function YI(n,e,t){var r=XI(n,e),i=jI(r,t);return function(a,o){if(o!==null)i.filter(function(l){return o>=l.applyFrom&&o<l.applyTo}).forEach(function(l){var c=o-l.startOffset,u=l.endOffset-l.startOffset,h=u===0?0:c/u;a.setAttribute(l.property,l.interpolation(h),!1,!1)});else for(var s in r)eE(s)&&a.setAttribute(s,null)}}function eE(n){return n!=="offset"&&n!=="easing"&&n!=="composite"&&n!=="computedOffset"}function XI(n,e){for(var t={},r=0;r<n.length;r++)for(var i in n[r])if(eE(i)){var a={offset:n[r].offset,computedOffset:n[r].computedOffset,easing:n[r].easing,easingFunction:Zv(n[r].easing)||e.easingFunction,value:n[r][i]};t[i]=t[i]||[],t[i].push(a)}return t}function jI(n,e){var t=[];for(var r in n)for(var i=n[r],a=0;a<i.length-1;a++){var o=a,s=a+1,l=i[o].computedOffset,c=i[s].computedOffset,u=l,h=c;a===0&&(u=-1/0,c===0&&(s=o)),a===i.length-2&&(h=1/0,l===1&&(o=s)),t.push({applyFrom:u,applyTo:h,startOffset:i[o].computedOffset,endOffset:i[s].computedOffset,easingFunction:i[o].easingFunction,property:r,interpolation:$I(r,i[o].value,i[s].value,e)})}return t.sort(function(f,d){return f.startOffset-d.startOffset}),t}var nE=function(n,e,t){return function(r){var i=rE(n,e,r);return!rt.enableCSSParsing&&fe(i)?i:t(i)}};function $I(n,e,t,r){var i=ao[n];if(i&&i.syntax&&i.int){var a=rt.styleValueRegistry.getPropertySyntax(i.syntax);if(a){var o=void 0,s=void 0;if(rt.enableCSSParsing){var l=rt.styleValueRegistry.parseProperty(n,e,r,!1),c=rt.styleValueRegistry.parseProperty(n,t,r,!1);o=rt.styleValueRegistry.computeProperty(n,l,r,!1),s=rt.styleValueRegistry.computeProperty(n,c,r,!1)}else{var u=a.parserWithCSSDisabled;o=u?u(e,r):e,s=u?u(t,r):t}var h=a.mixer(o,s,r);if(h){var f=nE.apply(void 0,K([],C(h),!1));return function(d){return d===0?e:d===1?t:f(d)}}}}return nE(!1,!0,function(d){return d?t:e})}function rE(n,e,t){if(typeof n=="number"&&typeof e=="number")return n*(1-t)+e*t;if(typeof n=="boolean"&&typeof e=="boolean"||typeof n=="string"&&typeof e=="string")return t<.5?n:e;if(Array.isArray(n)&&Array.isArray(e)){for(var r=n.length,i=e.length,a=Math.max(r,i),o=[],s=0;s<a;s++)o.push(rE(n[s<r?s:r-1],e[s<i?s:i-1],t));return o}throw new Error("Mismatched interpolation arguments "+n+":"+e)}var KI=function(){function n(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=OI,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return Object.defineProperty(n.prototype,"easing",{get:function(){return this._easing},set:function(e){this.easingFunction=Zv(e),this._easing=e},enumerable:!1,configurable:!0}),n}();function ZI(n){var e=[];for(var t in n)if(!(t in["easing","offset","composite"])){var r=n[t];Array.isArray(r)||(r=[r]);for(var i=r.length,a=0;a<i;a++){if(!e[a]){var o={};"offset"in n&&(o.offset=Number(n.offset)),"easing"in n&&(o.easing=n.easing),"composite"in n&&(o.composite=n.composite),e[a]=o}r[a]!==void 0&&r[a]!==null&&(e[a][t]=r[a])}}return e.sort(function(s,l){return(s.computedOffset||0)-(l.computedOffset||0)}),e}function iE(n,e){if(n===null)return[];Array.isArray(n)||(n=ZI(n));for(var t=n.map(function(l){var c={};e!=null&&e.composite&&(c.composite="auto");for(var u in l){var h=l[u];if(u==="offset"){if(h!==null){if(h=Number(h),!isFinite(h))throw new Error("Keyframe offsets must be numbers.");if(h<0||h>1)throw new Error("Keyframe offsets must be between 0 and 1.");c.computedOffset=h}}else if(u==="composite"&&["replace","add","accumulate","auto"].indexOf(h)===-1)throw new Error("".concat(h," compositing is not supported"));c[u]=h}return c.offset===void 0&&(c.offset=null),c.easing===void 0&&(c.easing=(e==null?void 0:e.easing)||"linear"),c.composite===void 0&&(c.composite="auto"),c}),r=!0,i=-1/0,a=0;a<t.length;a++){var o=t[a].offset;if(Mt(o))r=!1;else{if(o<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=o}}t=t.filter(function(l){return Number(l.offset)>=0&&Number(l.offset)<=1});function s(){var l,c,u=t.length;t[u-1].computedOffset=Number((l=t[u-1].offset)!==null&&l!==void 0?l:1),u>1&&(t[0].computedOffset=Number((c=t[0].offset)!==null&&c!==void 0?c:0));for(var h=0,f=Number(t[0].computedOffset),d=1;d<u;d++){var p=t[d].computedOffset;if(!Mt(p)&&!Mt(f)){for(var v=1;v<d-h;v++)t[h+v].computedOffset=f+(Number(p)-f)*v/(d-h);h=d,f=Number(p)}}}return r||s(),t}var qI="backwards|forwards|both|none".split("|"),JI="reverse|alternate|alternate-reverse".split("|");function QI(n,e){var t=new KI;return e&&(t.fill="both",t.duration="auto"),typeof n=="number"&&!isNaN(n)?t.duration=n:n!==void 0&&Object.keys(n).forEach(function(r){if(n[r]!==void 0&&n[r]!==null&&n[r]!=="auto"){if((typeof t[r]=="number"||r==="duration")&&(typeof n[r]!="number"||isNaN(n[r]))||r==="fill"&&qI.indexOf(n[r])===-1||r==="direction"&&JI.indexOf(n[r])===-1)return;t[r]=n[r]}}),t}function tD(n,e){return n=eD(n!=null?n:{duration:"auto"}),QI(n,e)}function eD(n){return typeof n=="number"&&(isNaN(n)?n={duration:"auto"}:n={duration:n}),n}var nD=function(){function n(e,t,r){var i=this;this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=tD(r,!1),this.timing.effect=this,this.timing.activeDuration=DI(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=iE(t,this.timing),this.interpolations=YI(this.normalizedKeyframes,this.timing,this.target);var a=rt.globalThis.Proxy;this.computedTiming=a?new a(this.timing,{get:function(o,s){return s==="duration"?o.duration==="auto"?0:o.duration:s==="fill"?o.fill==="auto"?"none":o.fill:s==="localTime"?i.animation&&i.animation.currentTime||null:s==="currentIteration"?!i.animation||i.animation.playState!=="running"?null:o.currentIteration||0:s==="progress"?!i.animation||i.animation.playState!=="running"?null:o.progress||0:o[s]},set:function(){return!0}}):this.timing}return n.prototype.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},n.prototype.update=function(e){return e===null?!1:(this.timeFraction=HI(this.timing.activeDuration,e,this.timing),this.timeFraction!==null)},n.prototype.getKeyframes=function(){return this.normalizedKeyframes},n.prototype.setKeyframes=function(e){this.normalizedKeyframes=iE(e)},n.prototype.getComputedTiming=function(){return this.computedTiming},n.prototype.getTiming=function(){return this.timing},n.prototype.updateTiming=function(e){var t=this;Object.keys(e||{}).forEach(function(r){t.timing[r]=e[r]})},n}();function aE(n,e){return Number(n.id)-Number(e.id)}var rD=function(){function n(e){var t=this;this.document=e,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(r){t.currentTime=r,t.discardAnimations(),t.animations.length===0?t.timelineTicking=!1:t.requestAnimationFrame(t.webAnimationsNextTick)},this.processRafCallbacks=function(r){var i=t.rafCallbacks;t.rafCallbacks=[],r<Number(t.currentTime)&&(r=Number(t.currentTime)),t.animations.sort(aE),t.animations=t.tick(r,!0,t.animations)[0],i.forEach(function(a){a[1](r)}),t.applyPendingEffects()}}return n.prototype.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},n.prototype.isTicking=function(){return this.inTick},n.prototype.play=function(e,t,r){var i=new nD(e,t,r),a=new xI(i,this);return this.animations.push(a),this.restartWebAnimationsNextTick(),a.updatePromises(),a.play(),a.updatePromises(),a},n.prototype.applyDirtiedAnimation=function(e){var t=this;if(!this.inTick){e.markTarget();var r=e.targetAnimations();r.sort(aE);var i=this.tick(Number(this.currentTime),!1,r.slice())[1];i.forEach(function(a){var o=t.animations.indexOf(a);o!==-1&&t.animations.splice(o,1)}),this.applyPendingEffects()}},n.prototype.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},n.prototype.destroy=function(){this.document.defaultView.cancelAnimationFrame(this.frameId)},n.prototype.applyPendingEffects=function(){this.pendingEffects.forEach(function(e){e==null||e.applyInterpolations()}),this.pendingEffects=[]},n.prototype.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(e){return e.updatePromises()})},n.prototype.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(e){return e.playState!=="finished"&&e.playState!=="idle"})},n.prototype.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},n.prototype.rAF=function(e){var t=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([t,e]),t},n.prototype.requestAnimationFrame=function(e){var t=this;return this.rAF(function(r){t.updateAnimationsPromises(),e(r),t.updateAnimationsPromises()})},n.prototype.tick=function(e,t,r){var i,a,o=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=e,this.ticking=!1;var s=[],l=[],c=[],u=[];return r.forEach(function(h){h.tick(e,t),h._inEffect?(l.push(h.effect),h.markTarget()):(s.push(h.effect),h.unmarkTarget()),h._needsTick&&(o.ticking=!0);var f=h._inEffect||h._needsTick;h._inTimeline=f,f?c.push(h):u.push(h)}),(i=this.pendingEffects).push.apply(i,K([],C(s),!1)),(a=this.pendingEffects).push.apply(a,K([],C(l),!1)),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[c,u]},n}();rt.EasingFunction=Zv,rt.AnimationTimeline=rD;var mn=function(){function n(e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=e,this.y=t,this.width=r,this.height=i}return Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),n.fromRect=function(e){return new n(e.x,e.y,e.width,e.height)},n.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},n.prototype.isPointIn=function(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom},n}();function UU(n){var e=n.getRenderBounds(),t=__read(e.min,2),r=t[0],i=t[1],a=__read(e.max,2),o=a[0],s=a[1],l=o-r,c=s-i;return new mn(r,i,l,c)}function oE(n){for(var e=1/0,t=1/0,r=-1/0,i=-1/0,a=0;a<n.length;a++){var o=n[a],s=o.x,l=o.y,c=o.width,u=o.height,h=C([s+c,l+u],2),f=h[0],d=h[1];s<e&&(e=s),l<t&&(t=l),f>r&&(r=f),d>i&&(i=d)}return new mn(e,t,r-e,i-t)}var iD=function(n,e,t){var r=n.width,i=n.height,a=t.flexDirection,o=a===void 0?"row":a,s=t.flexWrap,l=s===void 0?"nowrap":s,c=t.justifyContent,u=c===void 0?"flex-start":c,h=t.alignContent,f=h===void 0?"flex-start":h,d=t.alignItems,p=d===void 0?"flex-start":d,v=o==="row",g=o==="row"||o==="column",m=v?g?[1,0]:[-1,0]:g?[0,1]:[0,-1],x=C([0,0],2),_=x[0],S=x[1],b=e.map(function(R){var L,z=R.width,Y=R.height,I=C([_,S],2),Z=I[0],J=I[1];return L=C([_+z*m[0],S+Y*m[1]],2),_=L[0],S=L[1],new mn(Z,J,z,Y)}),y=oE(b),E={"flex-start":0,"flex-end":v?r-y.width:i-y.height,center:v?(r-y.width)/2:(i-y.height)/2},w=b.map(function(R){var L=R.x,z=R.y,Y=mn.fromRect(R);return Y.x=v?L+E[u]:L,Y.y=v?z:z+E[u],Y}),M=oE(w),P=function(R){var L=C(v?["height",i]:["width",r],2),z=L[0],Y=L[1];switch(p){case"flex-start":return 0;case"flex-end":return Y-R[z];case"center":return Y/2-R[z]/2;default:return 0}},A=w.map(function(R){var L=R.x,z=R.y,Y=mn.fromRect(R);return Y.x=v?L:L+P(Y),Y.y=v?z+P(Y):z,Y}),O=A.map(function(R){var L,z,Y=mn.fromRect(R);return Y.x+=(L=n.x)!==null&&L!==void 0?L:0,Y.y+=(z=n.y)!==null&&z!==void 0?z:0,Y});return O},aD=function(n,e,t){return[]},oD=function(n,e,t){if(e.length===0)return[];var r={flex:iD,grid:aD},i=t.display in r?r[t.display]:null;return(i==null?void 0:i.call(null,n,e,t))||[]};function Rn(n){if(fe(n))return[n,n,n,n];if(xr(n)){var e=n.length;if(e===1)return[n[0],n[0],n[0],n[0]];if(e===2)return[n[0],n[1],n[0],n[1]];if(e===3)return[n[0],n[1],n[2],n[1]];if(e===4)return n}return[0,0,0,0]}var sD=function(n){B(e,n);function e(t){var r=n.call(this,t)||this;r.layoutEvents=[de.BOUNDS_CHANGED,de.INSERTED,de.REMOVED],r.$margin=Rn(0),r.$padding=Rn(0);var i=t.style||{},a=i.margin,o=a===void 0?0:a,s=i.padding,l=s===void 0?0:s;return r.margin=o,r.padding=l,r.isMutationObserved=!0,r.bindEvents(),r}return Object.defineProperty(e.prototype,"margin",{get:function(){return this.$margin},set:function(t){this.$margin=Rn(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return this.$padding},set:function(t){this.$padding=Rn(t)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t=this.attributes,r=t.x,i=r===void 0?0:r,a=t.y,o=a===void 0?0:a,s=t.width,l=t.height,c=C(this.$margin,4),u=c[0],h=c[1],f=c[2],d=c[3];return new mn(i-d,o-u,s+d+h,l+u+f)},e.prototype.appendChild=function(t,r){return t.isMutationObserved=!0,n.prototype.appendChild.call(this,t,r),t},e.prototype.getAvailableSpace=function(){var t=this.attributes,r=t.width,i=t.height,a=C(this.$padding,4),o=a[0],s=a[1],l=a[2],c=a[3],u=C(this.$margin,4),h=u[0],f=u[3];return new mn(c+f,o+h,r-c-s,i-o-l)},e.prototype.layout=function(){if(!(!this.attributes.display||!this.isConnected)&&!this.children.some(function(o){return!o.isConnected}))try{var t=this.attributes,r=t.x,i=t.y;this.style.transform="translate(".concat(r,", ").concat(i,")");var a=oD(this.getAvailableSpace(),this.children.map(function(o){return o.getBBox()}),this.attributes);this.children.forEach(function(o,s){var l=a[s],c=l.x,u=l.y;o.style.transform="translate(".concat(c,", ").concat(u,")")})}catch(o){}},e.prototype.bindEvents=function(){var t=this;this.layoutEvents.forEach(function(r){t.addEventListener(r,function(i){i.target.isMutationObserved=!0,t.layout()})})},e.prototype.attributeChangedCallback=function(t,r,i){t==="margin"?this.margin=i:t==="padding"&&(this.padding=i),this.layout()},e}(qn);function sE(n,e){e(n),n.children&&n.children.forEach(function(t){t&&sE(t,e)})}function fc(n){rf(n,!0)}function $i(n){rf(n,!1)}function rf(n,e){var t=e?"visible":"hidden";sE(n,function(r){r.attr("visibility",t)})}var lD=5,lE=function(n,e,t,r){t===void 0&&(t=0),r===void 0&&(r=lD),Object.entries(e).forEach(function(i){var a=C(i,2),o=a[0],s=a[1],l=n;Object.prototype.hasOwnProperty.call(e,o)&&(s?Cs(s)?(Cs(n[o])||(l[o]={}),t<r?lE(n[o],s,t+1,r):l[o]=e[o]):xr(s)?(l[o]=[],l[o]=l[o].concat(s)):l[o]=s:l[o]=s)})},Un=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var r=0;r<e.length;r+=1)lE(n,e[r]);return n},cD=function(n){B(e,n);function e(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=n.apply(this,K([],C(t),!1))||this;return i.isMutationObserved=!0,i.addEventListener(de.INSERTED,function(){$i(i)}),i}return e}(qn);function cE(n){var e=n.appendChild(new cD({class:"offscreen"}));return $i(e),e}function uD(n){for(var e=n;e;){if(e.className==="offscreen")return!0;e=e.parent}return!1}function hD(){rf(this,this.attributes.visibility!=="hidden")}var Tn=function(n){B(e,n);function e(t,r){r===void 0&&(r={});var i=n.call(this,Un({},{style:r},t))||this;return i.initialized=!1,i._defaultOptions=r,i}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=cE(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},e.prototype.disconnectedCallback=function(){var t;(t=this._offscreen)===null||t===void 0||t.destroy()},e.prototype.attributeChangedCallback=function(t){t==="visibility"&&hD.call(this)},e.prototype.update=function(t,r){var i;return this.attr(Un({},this.attributes,t||{})),(i=this.render)===null||i===void 0?void 0:i.call(this,this.attributes,this,r)},e.prototype.clear=function(){this.removeChildren()},e.prototype.bindEvents=function(t,r){},e.prototype.getSubShapeStyle=function(t){var r=t.x,i=t.y,a=t.transform,o=t.transformOrigin,s=t.class,l=t.className,c=t.zIndex,u=V(t,["x","y","transform","transformOrigin","class","className","zIndex"]);return u},e}(JL);function Jv(n){return n.toString().charAt(0).toUpperCase()+n.toString().slice(1)}function fD(n){return n.toString().charAt(0).toLowerCase()+n.toString().slice(1)}function dD(n,e){return"".concat(e).concat(Jv(n))}function uE(n,e,t){var r;t===void 0&&(t=!0);var i=e||((r=n.match(/^([a-z][a-z0-9]+)/))===null||r===void 0?void 0:r[0])||"",a=n.replace(new RegExp("^(".concat(i,")")),"");return t?fD(a):a}function pD(n,e){Object.entries(e).forEach(function(t){var r=C(t,2),i=r[0],a=r[1];K([n],C(n.querySelectorAll(i)),!1).filter(function(o){return o.matches(i)}).forEach(function(o){if(o){var s=o;s.style.cssText+=Object.entries(a).reduce(function(l,c){return"".concat(l).concat(c.join(":"),";")},"")}})})}var af=function(n,e){if(!(n!=null&&n.startsWith(e)))return!1;var t=n[e.length];return t>="A"&&t<="Z"};function Qt(n,e,t){t===void 0&&(t=!1);var r={};return Object.entries(n).forEach(function(i){var a=C(i,2),o=a[0],s=a[1];if(!(o==="className"||o==="class")){if(af(o,"show")&&af(uE(o,"show"),e)!==t)o===dD(e,"show")?r[o]=s:r[o.replace(new RegExp(Jv(e)),"")]=s;else if(!af(o,"show")&&af(o,e)!==t){var l=uE(o,e);l==="filter"&&typeof s=="function"||(r[l]=s)}}}),r}function el(n,e){return Object.entries(n).reduce(function(t,r){var i=C(r,2),a=i[0],o=i[1];return a.startsWith("show")?t["show".concat(e).concat(a.slice(4))]=o:t["".concat(e).concat(Jv(a))]=o,t},{})}function ka(n,e){e===void 0&&(e=["x","y","class","className"]);var t=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],r={},i={};return Object.entries(n).forEach(function(a){var o=C(a,2),s=o[0],l=o[1];e.includes(s)||(t.indexOf(s)!==-1?i[s]=l:r[s]=l)}),[r,i]}var Qv=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=V(t,["style"]);return n.call(this,N({style:N({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},r)},i))||this}return Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=cE(this)),this._offscreen},enumerable:!1,configurable:!0}),e.prototype.disconnectedCallback=function(){var t;(t=this._offscreen)===null||t===void 0||t.destroy()},e}(Wv);function vD(n,e){var t=new Map;return n.forEach(function(r){var i=e(r);t.has(i)||t.set(i,[]),t.get(i).push(r)}),t}function gD(n){throw new Error(n)}var mD=function(){function n(i,a,o,s,l,c,u){i===void 0&&(i=null),a===void 0&&(a=null),o===void 0&&(o=null),s===void 0&&(s=null),l===void 0&&(l=[null,null,null,null,null]),c===void 0&&(c=[]),u===void 0&&(u=[]),e.add(this),this._elements=Array.from(i),this._data=a,this._parent=o,this._document=s,this._enter=l[0],this._update=l[1],this._exit=l[2],this._merge=l[3],this._split=l[4],this._transitions=c,this._facetElements=u}n.prototype.selectAll=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i):i;return new t(a,null,this._elements[0],this._document)},n.prototype.selectFacetAll=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i):i;return new t(this._elements,null,this._parent,this._document,void 0,void 0,a)},n.prototype.select=function(i){var a=typeof i=="string"?this._parent.querySelectorAll(i)[0]||null:i;return new t([a],null,a,this._document)},n.prototype.append=function(i){var a=this,o=typeof i=="function"?i:function(){return a.createElement(i)},s=[];if(this._data!==null){for(var l=0;l<this._data.length;l++){var c=this._data[l],u=C(Array.isArray(c)?c:[c,null],2),h=u[0],f=u[1],d=o(h,l);d.__data__=h,f!==null&&(d.__fromElements__=f),this._parent.appendChild(d),s.push(d)}return new t(s,null,this._parent,this._document)}for(var l=0;l<this._elements.length;l++){var p=this._elements[l],h=p.__data__,d=o(h,l);p.appendChild(d),s.push(d)}return new t(s,null,s[0],this._document)},n.prototype.maybeAppend=function(i,a){var o=Gn(this,e,"m",r).call(this,i[0]==="#"?i:"#".concat(i),a);return o.attr("id",i),o},n.prototype.maybeAppendByClassName=function(i,a){var o=i.toString(),s=Gn(this,e,"m",r).call(this,o[0]==="."?o:".".concat(o),a);return s.attr("className",o),s},n.prototype.maybeAppendByName=function(i,a){var o=Gn(this,e,"m",r).call(this,'[name="'.concat(i,'"]'),a);return o.attr("name",i),o},n.prototype.data=function(i,a,o){var s,l;a===void 0&&(a=function(P){return P}),o===void 0&&(o=function(){return null});for(var c=[],u=[],h=new Set(this._elements),f=[],d=new Set,p=new Map(this._elements.map(function(P,A){return[a(P.__data__,A),P]})),v=new Map(this._facetElements.map(function(P,A){return[a(P.__data__,A),P]})),g=vD(this._elements,function(P){return o(P.__data__)}),m=0;m<i.length;m++){var x=i[m],_=a(x,m),S=o(x,m);if(p.has(_)){var b=p.get(_);b.__data__=x,b.__facet__=!1,u.push(b),h.delete(b),p.delete(_)}else if(v.has(_)){var b=v.get(_);b.__data__=x,b.__facet__=!0,u.push(b),v.delete(_)}else if(g.has(_)){var y=g.get(_);f.push([x,y]);try{for(var E=(s=void 0,pt(y)),w=E.next();!w.done;w=E.next()){var b=w.value;h.delete(b)}}catch(P){s={error:P}}finally{try{w&&!w.done&&(l=E.return)&&l.call(E)}finally{if(s)throw s.error}}g.delete(_)}else if(p.has(S)){var b=p.get(S);b.__toData__?b.__toData__.push(x):b.__toData__=[x],d.add(b),h.delete(b)}else c.push(x)}var M=[new t([],c,this._parent,this._document),new t(u,null,this._parent,this._document),new t(h,null,this._parent,this._document),new t([],f,this._parent,this._document),new t(d,null,this._parent,this._document)];return new t(this._elements,null,this._parent,this._document,M)},n.prototype.merge=function(i){var a=K(K([],C(this._elements),!1),C(i._elements),!1),o=K(K([],C(this._transitions),!1),C(i._transitions),!1);return new t(a,null,this._parent,this._document,void 0,o)},n.prototype.createElement=function(i){if(this._document)return this._document.createElement(i,{});var a=t.registry[i];return a?new a:gD("Unknown node type: ".concat(i))},n.prototype.join=function(i,a,o,s,l){i===void 0&&(i=function(p){return p}),a===void 0&&(a=function(p){return p}),o===void 0&&(o=function(p){return p.remove()}),s===void 0&&(s=function(p){return p}),l===void 0&&(l=function(p){return p.remove()});var c=i(this._enter),u=a(this._update),h=o(this._exit),f=s(this._merge),d=l(this._split);return u.merge(c).merge(h).merge(f).merge(d)},n.prototype.remove=function(){for(var i=function(s){var l=a._elements[s],c=a._transitions[s];c?c.then(function(){return l.remove()}):l.remove()},a=this,o=0;o<this._elements.length;o++)i(o);return new t([],null,this._parent,this._document,void 0,this._transitions)},n.prototype.each=function(i){for(var a=0;a<this._elements.length;a++){var o=this._elements[a],s=o.__data__;i.call(o,s,a)}return this},n.prototype.attr=function(i,a){var o=typeof a!="function"?function(){return a}:a;return this.each(function(s,l){a!==void 0&&(this[i]=o.call(this,s,l))})},n.prototype.style=function(i,a,o){o===void 0&&(o=!0);var s=typeof a!="function"||!o?function(){return a}:a;return this.each(function(l,c){a!==void 0&&(this.style[i]=s.call(this,l,c))})},n.prototype.styles=function(i,a){return i===void 0&&(i={}),a===void 0&&(a=!0),this.each(function(o,s){var l=this;Object.entries(i).forEach(function(c){var u=C(c,2),h=u[0],f=u[1],d=typeof f!="function"||!a?function(){return f}:f;f!==void 0&&l.attr(h,d.call(l,o,s))})})},n.prototype.update=function(i,a){a===void 0&&(a=!0);var o=typeof i!="function"||!a?function(){return i}:i;return this.each(function(s,l){i&&this.update&&this.update(o.call(this,s,l))})},n.prototype.maybeUpdate=function(i,a){a===void 0&&(a=!0);var o=typeof i!="function"||!a?function(){return i}:i;return this.each(function(s,l){i&&this.update&&this.update(o.call(this,s,l))})},n.prototype.transition=function(i){var a=this._transitions;return this.each(function(o,s){a[s]=i.call(this,o,s)})},n.prototype.on=function(i,a){return this.each(function(){this.addEventListener(i,a)}),this},n.prototype.call=function(i){for(var a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];return i.call.apply(i,K([this._parent,this],C(a),!1)),this},n.prototype.node=function(){return this._elements[0]},n.prototype.nodes=function(){return this._elements},n.prototype.transitions=function(){return this._transitions.filter(function(i){return!!i})},n.prototype.parent=function(){return this._parent};var e,t,r;return t=n,e=new WeakSet,r=function(a,o){var s=this._elements[0],l=s.querySelector(a);if(l)return new t([l],null,this._parent,this._document);var c=typeof o=="string"?this.createElement(o):o();return s.appendChild(c),new t([c],null,this._parent,this._document)},n.registry={g:qn,rect:$o,circle:Gh,path:zh,text:Qv,ellipse:Ib,image:Bb,line:Gv,polygon:zv,polyline:Fb,html:Db},n}();function Lt(n){return new mD([n],null,n,n.ownerDocument)}function yD(n,e,t){return n.querySelector(e)?Lt(n).select(e):Lt(n).append(t)}var Ki=function(n,e){var t=function(i){return"".concat(e,"-").concat(i)},r=Object.fromEntries(Object.entries(n).map(function(i){var a=C(i,2),o=a[0],s=a[1],l=t(s);return[o,{name:l,class:".".concat(l),id:"#".concat(l),toString:function(){return l}}]}));return Object.assign(r,{prefix:t}),r};function hi(n,e,t,r,i){return r===void 0&&(r=!0),i===void 0&&(i=function(a){a.node().removeChildren()}),n?t(e):(r&&i(e),null)}var hE=Ki({text:"text"},"title");function of(n){return/\S+-\S+/g.test(n)?n.split("-").map(function(e){return e[0]}):n.length>2?[n[0]]:n.split("")}function xD(n,e){var t=n.attributes,r=t.position,i=t.spacing,a=t.inset,o=t.text,s=n.getBBox(),l=e.getBBox(),c=of(r),u=C(Rn(o?i:0),4),h=u[0],f=u[1],d=u[2],p=u[3],v=C(Rn(a),4),g=v[0],m=v[1],x=v[2],_=v[3],S=C([p+f,h+d],2),b=S[0],y=S[1],E=C([_+m,g+x],2),w=E[0],M=E[1];if(c[0]==="l")return new mn(s.x,s.y,l.width+s.width+b+w,Math.max(l.height+M,s.height));if(c[0]==="t")return new mn(s.x,s.y,Math.max(l.width+w,s.width),l.height+s.height+y+M);var P=C([e.attributes.width||l.width,e.attributes.height||l.height],2),A=P[0],O=P[1];return new mn(l.x,l.y,A+s.width+b+w,O+s.height+y+M)}function bD(n,e){var t=Object.entries(e).reduce(function(r,i){var a=C(i,2),o=a[0],s=a[1],l=n.node().attr(o);return l||(r[o]=s),r},{});n.styles(t)}function ED(n){var e,t,r,i,a=n,o=a.width,s=a.height,l=a.position,c=C([+o/2,+s/2],2),u=c[0],h=c[1],f=C([+u,+h,"center","middle"],4),d=f[0],p=f[1],v=f[2],g=f[3],m=of(l);return m.includes("l")&&(e=C([0,"start"],2),d=e[0],v=e[1]),m.includes("r")&&(t=C([+o,"end"],2),d=t[0],v=t[1]),m.includes("t")&&(r=C([0,"top"],2),p=r[0],g=r[1]),m.includes("b")&&(i=C([+s,"bottom"],2),p=i[0],g=i[1]),{x:d,y:p,textAlign:v,textBaseline:g}}var wD=function(n){B(e,n);function e(t){return n.call(this,t,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return e.prototype.getAvailableSpace=function(){var t=this,r=this.attributes,i=r.width,a=r.height,o=r.position,s=r.spacing,l=r.inset,c=t.querySelector(hE.text.class);if(!c)return new mn(0,0,+i,+a);var u=c.getBBox(),h=u.width,f=u.height,d=C(Rn(s),4),p=d[0],v=d[1],g=d[2],m=d[3],x=C([0,0,+i,+a],4),_=x[0],S=x[1],b=x[2],y=x[3],E=of(o);if(E.includes("i"))return new mn(_,S,b,y);E.forEach(function(Y,I){var Z,J,mt,It;Y==="t"&&(Z=C(I===0?[f+g,+a-f-g]:[0,+a],2),S=Z[0],y=Z[1]),Y==="r"&&(J=C([+i-h-m],1),b=J[0]),Y==="b"&&(mt=C([+a-f-p],1),y=mt[0]),Y==="l"&&(It=C(I===0?[h+v,+i-h-v]:[0,+i],2),_=It[0],b=It[1])});var w=C(Rn(l),4),M=w[0],P=w[1],A=w[2],O=w[3],R=C([O+P,M+A],2),L=R[0],z=R[1];return new mn(_+O,S+M,b-L,y-z)},e.prototype.getBBox=function(){return this.title?this.title.getBBox():new mn(0,0,0,0)},e.prototype.render=function(t,r){var i=this,a=t.width,o=t.height,s=t.position,l=t.spacing,c=V(t,["width","height","position","spacing"]),u=C(ka(c),1),h=u[0],f=ED(t),d=f.x,p=f.y,v=f.textAlign,g=f.textBaseline;hi(!!c.text,Lt(r),function(m){i.title=m.maybeAppendByClassName(hE.text,"text").styles(h).call(bD,{x:d,y:p,textAlign:v,textBaseline:g}).node()})},e}(Tn),t0=function(){};function Di(n,e){return jt(n)?n.apply(void 0,K([],C(e),!1)):n}function _D(n,e){return n.reduce(function(t,r){return(t[r[e]]=t[r[e]]||[]).push(r),t},{})}function SD(n){return typeof n=="boolean"?!1:"enter"in n&&"update"in n&&"exit"in n}function fE(n){if(!n)return{enter:!1,update:!1,exit:!1};var e=["enter","update","exit"],t=Object.fromEntries(Object.entries(n).filter(function(r){var i=C(r,1),a=i[0];return!e.includes(a)}));return Object.fromEntries(e.map(function(r){return SD(n)?n[r]===!1?[r,!1]:[r,N(N({},n[r]),t)]:[r,t]}))}function nl(n,e){n?n.finished.then(e):e()}function TD(n,e){n.length===0?e():Promise.all(n.map(function(t){return t==null?void 0:t.finished})).then(e)}function dE(n,e){"update"in n?n.update(e):n.attr(e)}function pE(n,e,t){if(e.length===0)return null;if(!t){var r=e.slice(-1)[0];return dE(n,{style:r}),null}return n.animate(e,t)}function PD(n,e){return!(n.nodeName!=="text"||e.nodeName!=="text"||n.attributes.text!==e.attributes.text)}function MD(n,e,t,r){if(r===void 0&&(r="destroy"),PD(n,e))return n.remove(),[null];var i=function(){r==="destroy"?n.destroy():r==="hide"&&$i(n),e.isVisible()&&fc(e)};if(!t)return i(),[null];var a=t.duration,o=a===void 0?0:a,s=t.delay,l=s===void 0?0:s,c=Math.ceil(+o/2),u=+o/4,h=C(n.getGeometryBounds().center,2),f=h[0],d=h[1],p=C(e.getGeometryBounds().center,2),v=p[0],g=p[1],m=C([(f+v)/2-f,(d+g)/2-d],2),x=m[0],_=m[1],S=n.style.opacity,b=S===void 0?1:S,y=e.style.opacity,E=y===void 0?1:y,w=n.style.transform||"",M=e.style.transform||"",P=n.animate([{opacity:b,transform:"translate(0, 0) ".concat(w)},{opacity:0,transform:"translate(".concat(x,", ").concat(_,") ").concat(w)}],N(N({fill:"both"},t),{duration:l+c+u})),A=e.animate([{opacity:0,transform:"translate(".concat(-x,", ").concat(-_,") ").concat(M),offset:.01},{opacity:E,transform:"translate(0, 0) ".concat(M)}],N(N({fill:"both"},t),{duration:c+u,delay:l+c-u}));return nl(A,i),[P,A]}function Zi(n,e,t){var r={},i={};return Object.entries(e).forEach(function(a){var o=C(a,2),s=o[0],l=o[1];if(!Mt(l)){var c=n.style[s]||n.parsedStyle[s]||0;c!==l&&(r[s]=c,i[s]=l)}}),t?pE(n,[r,i],N({fill:"both"},t)):(dE(n,i),null)}function CD(n){var e;return((e=n[0])===null||e===void 0?void 0:e.map(function(t,r){return n.map(function(i){return i[r]})}))||[]}function e0(n,e,t){t===void 0&&(t=!1);var r=n.getBBox(),i=r.width,a=r.height,o=e/Math.max(i,a);return t&&(n.style.transform="scale(".concat(o,")")),o}var vE=function(n,e,t){return[["M",n-t,e],["A",t,t,0,1,0,n+t,e],["A",t,t,0,1,0,n-t,e],["Z"]]},AD=vE,OD=function(n,e,t){return[["M",n-t,e-t],["L",n+t,e-t],["L",n+t,e+t],["L",n-t,e+t],["Z"]]},ND=function(n,e,t){return[["M",n-t,e],["L",n,e-t],["L",n+t,e],["L",n,e+t],["Z"]]},RD=function(n,e,t){var r=t*Math.sin(.3333333333333333*Math.PI);return[["M",n-t,e+r],["L",n,e-r],["L",n+t,e+r],["Z"]]},kD=function(n,e,t){var r=t*Math.sin(.3333333333333333*Math.PI);return[["M",n-t,e-r],["L",n+t,e-r],["L",n,e+r],["Z"]]},LD=function(n,e,t){var r=t/2*Math.sqrt(3);return[["M",n,e-t],["L",n+r,e-t/2],["L",n+r,e+t/2],["L",n,e+t],["L",n-r,e+t/2],["L",n-r,e-t/2],["Z"]]},ID=function(n,e,t){var r=t-1.5;return[["M",n-t,e-r],["L",n+t,e+r],["L",n+t,e-r],["L",n-t,e+r],["Z"]]},gE=function(n,e,t){return[["M",n,e+t],["L",n,e-t]]},DD=function(n,e,t){return[["M",n-t,e-t],["L",n+t,e+t],["M",n+t,e-t],["L",n-t,e+t]]},BD=function(n,e,t){return[["M",n-t/2,e-t],["L",n+t/2,e-t],["M",n,e-t],["L",n,e+t],["M",n-t/2,e+t],["L",n+t/2,e+t]]},FD=function(n,e,t){return[["M",n-t,e],["L",n+t,e],["M",n,e-t],["L",n,e+t]]},GD=function(n,e,t){return[["M",n-t,e],["L",n+t,e]]},mE=function(n,e,t){return[["M",n-t,e],["L",n+t,e]]},zD=mE,WD=function(n,e,t){return[["M",n-t,e],["A",t/2,t/2,0,1,1,n,e],["A",t/2,t/2,0,1,0,n+t,e]]},UD=function(n,e,t){return[["M",n-t-1,e-2.5],["L",n,e-2.5],["L",n,e+2.5],["L",n+t+1,e+2.5]]},VD=function(n,e,t){return[["M",n-t-1,e+2.5],["L",n,e+2.5],["L",n,e-2.5],["L",n+t+1,e-2.5]]},HD=function(n,e,t){return[["M",n-(t+1),e+2.5],["L",n-t/2,e+2.5],["L",n-t/2,e-2.5],["L",n+t/2,e-2.5],["L",n+t/2,e+2.5],["L",n+t+1,e+2.5]]};function YD(n,e){return[["M",n-5,e+2.5],["L",n-5,e],["L",n,e],["L",n,e-3],["L",n,e+3],["L",n+6.5,e+3]]}var XD=function(n,e,t){return[["M",n-t,e-t],["L",n+t,e],["L",n-t,e+t],["Z"]]},Bi=Ki({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),jD=function(n){B(e,n);function e(t){var r=n.call(this,t,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:XD(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(i,a){return"".concat(i,"/").concat(a)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return r.playState="idle",r.contentGroup=r.appendChild(new qn({class:Bi.contentGroup.name})),r.playWindow=r.contentGroup.appendChild(new qn({class:Bi.playWindow.name})),r.innerCurrPage=r.defaultPage,r}return Object.defineProperty(e.prototype,"defaultPage",{get:function(){var t=this.attributes.defaultPage;return me(t,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var t=this.pageViews,r=C(CD(t.map(function(h){var f=h.getBBox(),d=f.width,p=f.height;return[d,p]})).map(function(h){return Math.max.apply(Math,K([],C(h),!1))}),2),i=r[0],a=r[1],o=this.attributes,s=o.pageWidth,l=s===void 0?i:s,c=o.pageHeight,u=c===void 0?a:c;return{pageWidth:l,pageHeight:u}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t=n.prototype.getBBox.call(this),r=t.x,i=t.y,a=this.controllerShape,o=this.pageShape,s=o.pageWidth,l=o.pageHeight;return new mn(r,i,s+a.width,l)},e.prototype.goTo=function(t){var r=this,i=this.attributes.animate,a=this,o=a.currPage,s=a.playState,l=a.playWindow,c=a.pageViews;if(s!=="idle"||t<0||c.length<=0||t>=c.length)return null;c[o].setLocalPosition(0,0),this.prepareFollowingPage(t);var u=C(this.getFollowingPageDiff(t),2),h=u[0],f=u[1];this.playState="running";var d=pE(l,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-h,", ").concat(-f,")")}],i);return nl(d,function(){r.innerCurrPage=t,r.playState="idle",r.setVisiblePages([t]),r.updatePageInfo()}),d},e.prototype.prev=function(){var t=this.attributes.loop,r=this.pageViews.length,i=this.currPage;if(!t&&i<=0)return null;var a=t?(i-1+r)%r:me(i-1,0,r);return this.goTo(a)},e.prototype.next=function(){var t=this.attributes.loop,r=this.pageViews.length,i=this.currPage;if(!t&&i>=r-1)return null;var a=t?(i+1)%r:me(i+1,0,r);return this.goTo(a)},e.prototype.renderClipPath=function(t){var r=this.pageShape,i=r.pageWidth,a=r.pageHeight;if(!i||!a){this.contentGroup.style.clipPath=void 0;return}this.clipPath=t.maybeAppendByClassName(Bi.clipPath,"rect").styles({width:i,height:a}),this.contentGroup.attr("clipPath",this.clipPath.node())},e.prototype.setVisiblePages=function(t){this.playWindow.children.forEach(function(r,i){t.includes(i)?fc(r):$i(r)})},e.prototype.adjustControllerLayout=function(){var t=this,r=t.prevBtnGroup,i=t.nextBtnGroup,a=t.pageInfoGroup,o=this.attributes,s=o.orientation,l=o.controllerPadding,c=a.getBBox(),u=c.width,h=c.height,f=C(s==="horizontal"?[-180,0]:[-90,90],2),d=f[0],p=f[1];r.setLocalEulerAngles(d),i.setLocalEulerAngles(p);var v=r.getBBox(),g=v.width,m=v.height,x=i.getBBox(),_=x.width,S=x.height,b=Math.max(g,u,_),y=s==="horizontal"?{offset:[[0,0],[g/2+l,0],[g+u+l*2,0]],textAlign:"start"}:{offset:[[b/2,-m-l],[b/2,0],[b/2,S+l]],textAlign:"center"},E=C(y.offset,3),w=C(E[0],2),M=w[0],P=w[1],A=C(E[1],2),O=A[0],R=A[1],L=C(E[2],2),z=L[0],Y=L[1],I=y.textAlign,Z=a.querySelector("text");Z&&(Z.style.textAlign=I),r.setLocalPosition(M,P),a.setLocalPosition(O,R),i.setLocalPosition(z,Y)},e.prototype.updatePageInfo=function(){var t,r=this,i=r.currPage,a=r.pageViews,o=r.attributes.formatter;a.length<2||((t=this.pageInfoGroup.querySelector(Bi.pageInfo.class))===null||t===void 0||t.attr("text",o(i+1,a.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(t){var r=this.currPage;if(r===t)return[0,0];var i=this.attributes.orientation,a=this.pageShape,o=a.pageWidth,s=a.pageHeight,l=t<r?-1:1;return i==="horizontal"?[l*o,0]:[0,l*s]},e.prototype.prepareFollowingPage=function(t){var r=this,i=r.currPage,a=r.pageViews;if(this.setVisiblePages([t,i]),t!==i){var o=C(this.getFollowingPageDiff(t),2),s=o[0],l=o[1];a[t].setLocalPosition(s,l)}},e.prototype.renderController=function(t){var r=this,i=this.attributes.controllerSpacing,a=this.pageShape,o=a.pageWidth,s=a.pageHeight,l=this.pageViews.length>=2,c=t.maybeAppendByClassName(Bi.controller,"g");if(rf(c.node(),l),!!l){var u=Qt(this.attributes,"button"),h=Qt(this.attributes,"pageNum"),f=C(ka(u),2),d=f[0],p=f[1],v=d.size,g=V(d,["size"]),m=!c.select(Bi.prevBtnGroup.class).node(),x=c.maybeAppendByClassName(Bi.prevBtnGroup,"g").styles(p);this.prevBtnGroup=x.node();var _=x.maybeAppendByClassName(Bi.prevBtn,"path"),S=c.maybeAppendByClassName(Bi.nextBtnGroup,"g").styles(p);this.nextBtnGroup=S.node();var b=S.maybeAppendByClassName(Bi.nextBtn,"path");[_,b].forEach(function(E){E.styles(N(N({},g),{transformOrigin:"center"})),e0(E.node(),v,!0)});var y=c.maybeAppendByClassName(Bi.pageInfoGroup,"g");this.pageInfoGroup=y.node(),y.maybeAppendByClassName(Bi.pageInfo,"text").styles(h),this.updatePageInfo(),c.node().setLocalPosition(o+i,s/2),m&&(this.prevBtnGroup.addEventListener("click",function(){r.prev()}),this.nextBtnGroup.addEventListener("click",function(){r.next()}))}},e.prototype.render=function(t,r){var i=t.x,a=i===void 0?0:i,o=t.y,s=o===void 0?0:o;this.attr("transform","translate(".concat(a,", ").concat(s,")"));var l=Lt(r);this.renderClipPath(l),this.renderController(l),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var t=this,r=rh(function(){return t.render(t.attributes,t)},50);this.playWindow.addEventListener(de.INSERTED,r),this.playWindow.addEventListener(de.REMOVED,r)},e}(Tn);function $D(n){var e="default";if(dn(n)&&n instanceof Image)e="image";else if(jt(n))e="symbol";else if(ue(n)){var t=new RegExp("data:(image|text)");n.match(t)?e="base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(n)?e="url":e="symbol"}return e}function KD(n){var e=$D(n);return["base64","url","image"].includes(e)?"image":n&&e==="symbol"?"path":null}var We=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r){var i=t.x,a=i===void 0?0:i,o=t.y,s=o===void 0?0:o,l=this.getSubShapeStyle(t),c=l.symbol,u=l.size,h=u===void 0?16:u,f=V(l,["symbol","size"]),d=KD(c);hi(!!d,Lt(r),function(p){p.maybeAppendByClassName("marker",d).attr("className","marker ".concat(d,"-marker")).call(function(v){if(d==="image"){var g=h*2;v.styles({img:c,width:g,height:g,x:a-h,y:s-h})}else{var g=h/2,m=jt(c)?c:e.getSymbol(c);v.styles(N({d:m==null?void 0:m(a,s,g)},f))}})})},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(t,r){e.MARKER_SYMBOL_MAP.set(t,r)},e.getSymbol=function(t){return e.MARKER_SYMBOL_MAP.get(t)},e.getSymbols=function(){return Array.from(e.MARKER_SYMBOL_MAP.keys())},e}(Tn);We.registerSymbol("cross",DD),We.registerSymbol("hyphen",GD),We.registerSymbol("line",gE),We.registerSymbol("plus",FD),We.registerSymbol("tick",BD),We.registerSymbol("circle",vE),We.registerSymbol("point",AD),We.registerSymbol("bowtie",ID),We.registerSymbol("hexagon",LD),We.registerSymbol("square",OD),We.registerSymbol("diamond",ND),We.registerSymbol("triangle",RD),We.registerSymbol("triangle-down",kD),We.registerSymbol("line",gE),We.registerSymbol("dot",mE),We.registerSymbol("dash",zD),We.registerSymbol("smooth",WD),We.registerSymbol("hv",UD),We.registerSymbol("vh",VD),We.registerSymbol("hvh",HD),We.registerSymbol("vhv",YD);function VU(n,e,t){var r=Math.round((n-t)/e);return t+r*e}function ZD(n,e,t){var r=1.4,i=r*t;return[["M",n-t,e-i],["L",n+t,e-i],["L",n+t,e+i],["L",n-t,e+i],["Z"]]}var yE=1.4,xE=.4;function qD(n,e,t){var r=t,i=r*yE,a=r/2,o=r/6,s=n+i*xE;return[["M",n,e],["L",s,e+a],["L",n+i,e+a],["L",n+i,e-a],["L",s,e-a],["Z"],["M",s,e+o],["L",n+i-2,e+o],["M",s,e-o],["L",n+i-2,e-o]]}function JD(n,e,t){var r=t,i=r*yE,a=r/2,o=r/6,s=e+i*xE;return[["M",n,e],["L",n-a,s],["L",n-a,e+i],["L",n+a,e+i],["L",n+a,s],["Z"],["M",n-o,s],["L",n-o,e+i-2],["M",n+o,s],["L",n+o,e+i-2]]}We.registerSymbol("hiddenHandle",ZD),We.registerSymbol("verticalHandle",qD),We.registerSymbol("horizontalHandle",JD);var HU=function(n,e,t){return n===void 0&&(n="horizontal"),n==="horizontal"?e:t};function YU(n,e,t,r){var i;r===void 0&&(r=4);var a=__read(n,2),o=a[0],s=a[1],l=__read(e,2),c=l[0],u=l[1],h=__read(t,2),f=h[0],d=h[1],p=__read([c,u],2),v=p[0],g=p[1],m=g-v;return v>g&&(i=__read([g,v],2),v=i[0],g=i[1]),m>s-o?[o,s]:v<o?f===o&&d===g?[o,g]:[o,m+o]:g>s?d===s&&f===v?[v,s]:[s-m,s]:[v,g]}function n0(n,e,t){return n===void 0&&(n="horizontal"),n==="horizontal"?e:t}function XU(n){var e=n&&n.getRenderBounds();if(!e)return{width:0,height:0};var t=e.getMax(),r=e.getMin();return{width:t[0]-r[0],height:t[1]-r[1]}}function bE(n){var e=n.getLocalBounds(),t=e.min,r=e.max,i=C([t,r],2),a=C(i[0],2),o=a[0],s=a[1],l=C(i[1],2),c=l[0],u=l[1];return{x:o,y:s,width:c-o,height:u-s,left:o,bottom:u,top:s,right:c}}function jU(n,e){var t=select(n).append("text").node();return t.attr(__assign(__assign({},e),{visibility:"hidden"})),t}function QD(n,e){var t=C(n,2),r=t[0],i=t[1],a=C(e,2),o=a[0],s=a[1];return r!==o&&i===s}function $U(n,e){var t=__read(n,2),r=t[0],i=t[1],a=__read(e,2),o=a[0],s=a[1];return r===o&&i!==s}function t6(n,e){var t,r,i=e.attributes;try{for(var a=pt(Object.entries(i)),o=a.next();!o.done;o=a.next()){var s=C(o.value,2),l=s[0],c=s[1];l!=="id"&&l!=="className"&&n.attr(l,c)}}catch(u){t={error:u}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}}function La(n){return typeof n=="function"?n():ue(n)||fe(n)?new Qv({style:{text:String(n)}}):n}function e6(n){var e,t,r,i=n||1;function a(s,l){++e>i&&(r=t,o(1),++e),t[s]=l}function o(s){e=0,t=Object.create(null),s||(r=Object.create(null))}return o(),{clear:o,has:function(s){return t[s]!==void 0||r[s]!==void 0},get:function(s){var l=t[s];if(l!==void 0)return l;if((l=r[s])!==void 0)return a(s,l),l},set:function(s,l){t[s]!==void 0?t[s]=l:a(s,l)}}}var n6=function(n,e,t){if(t===void 0&&(t=128),!jt(n))throw new TypeError("Expected a function");var r=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=e?e.apply(this,i):i[0],s=r.cache;if(s.has(o))return s.get(o);var l=n.apply(this,i);return s.set(o,l),l};return r.cache=e6(t),r},sf,r0;function KU(n){r0=n}var r6=n6(function(n,e){var t=e.fontSize,r=e.fontFamily,i=e.fontWeight,a=e.fontStyle,o=e.fontVariant;return r0?r0(n,t):(sf||(sf=rt.offscreenCanvasCreator.getOrCreateContext(void 0)),sf.font=[a,o,i,"".concat(t,"px"),r].join(" "),sf.measureText(n).width)},function(n,e){return[n,Object.values(e||EE(n)).join()].join("")},4096),EE=function(n){var e=n.style.fontFamily||"sans-serif",t=n.style.fontWeight||"normal",r=n.style.fontStyle||"normal",i=n.style.fontVariant,a=n.style.fontSize;return a=typeof a=="object"?a.value:a,{fontSize:a,fontFamily:e,fontWeight:t,fontStyle:r,fontVariant:i}};function wE(n){return n.nodeName==="text"?n:n.nodeName==="g"&&n.children.length===1&&n.children[0].nodeName==="text"?n.children[0]:null}function _E(n,e){var t=wE(n);t&&t.attr(e)}function i0(n,e,t){t===void 0&&(t="..."),_E(n,{wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:t})}var fi=Ki({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item");function i6(n){var e=n.querySelector(fi.marker.class);return e?e.style:{}}var a6=function(n){B(e,n);function e(t){return n.call(this,t,{span:[1,1],marker:function(){return new Gh({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this}return Object.defineProperty(e.prototype,"showValue",{get:function(){var t=this.attributes.valueText;return t?typeof t=="string"||typeof t=="number"?t!=="":typeof t=="function"?!0:t.attr("text")!=="":!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var t=this.labelGroup,r=this.valueGroup,i=this.attributes.markerSize,a=t.node().getBBox(),o=a.width,s=a.height,l=r.node().getBBox(),c=l.width,u=l.height;return{markerWidth:i,labelWidth:o,valueWidth:c,height:Math.max(i,s,u)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var t=this.attributes.span;if(!t)return[1,1];var r=C(Rn(t),2),i=r[0],a=r[1],o=this.showValue?a:0,s=i+o;return[i/s,o/s]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t,r=this.attributes,i=r.markerSize,a=r.width,o=this.actualSpace,s=o.markerWidth,l=o.height,c=this.actualSpace,u=c.labelWidth,h=c.valueWidth,f=C(this.spacing,2),d=f[0],p=f[1];if(a){var v=a-i-d-p,g=C(this.span,2),m=g[0],x=g[1];t=C([m*v,x*v],2),u=t[0],h=t[1]}var _=s+u+h+d+p;return{width:_,height:l,markerWidth:s,labelWidth:u,valueWidth:h}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var t=this.attributes.spacing;if(!t)return[0,0];var r=C(Rn(t),2),i=r[0],a=r[1];return this.showValue?[i,a]:[i,0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var t=this.shape,r=t.markerWidth,i=t.labelWidth,a=t.valueWidth,o=t.width,s=t.height,l=C(this.spacing,2),c=l[0],u=l[1];return{height:s,width:o,markerWidth:r,labelWidth:i,valueWidth:a,position:[r/2,r+c,r+i+c+u]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleSize",{get:function(){var t=i6(this.markerGroup.node()),r=this.attributes,i=r.markerSize,a=r.markerStrokeWidth,o=a===void 0?t.strokeWidth:a,s=r.markerLineWidth,l=s===void 0?t.lineWidth:s,c=r.markerStroke,u=c===void 0?t.stroke:c,h=+(o||l||(u?1:0))*Math.sqrt(2),f=this.markerGroup.node().getBBox(),d=f.width,p=f.height;return(1-h/Math.max(d,p))*i},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(t){var r=this,i=this.attributes.marker,a=Qt(this.attributes,"marker");this.markerGroup=t.maybeAppendByClassName(fi.markerGroup,"g").style("zIndex",0),hi(!!i,this.markerGroup,function(){var o,s=r.markerGroup.node(),l=(o=s.childNodes)===null||o===void 0?void 0:o[0],c=typeof i=="string"?new We({style:{symbol:i},className:fi.marker.name}):i();l?c.nodeName===l.nodeName?l instanceof We?l.update(N(N({},a),{symbol:i})):(t6(l,c),Lt(l).styles(a)):(l.remove(),Lt(c).attr("className",fi.marker.name).styles(a),s.appendChild(c)):(c instanceof We||Lt(c).attr("className",fi.marker.name).styles(a),s.appendChild(c)),r.markerGroup.node().scale(1/r.markerGroup.node().getScale()[0]);var u=e0(r.markerGroup.node(),r.scaleSize,!0);r.markerGroup.node().style._transform="scale(".concat(u,")")})},e.prototype.renderLabel=function(t){var r=Qt(this.attributes,"label"),i=r.text,a=V(r,["text"]);this.labelGroup=t.maybeAppendByClassName(fi.labelGroup,"g").style("zIndex",0),this.labelGroup.maybeAppendByClassName(fi.label,function(){return La(i)}).styles(a)},e.prototype.renderValue=function(t){var r=this,i=Qt(this.attributes,"value"),a=i.text,o=V(i,["text"]);this.valueGroup=t.maybeAppendByClassName(fi.valueGroup,"g").style("zIndex",0),hi(this.showValue,this.valueGroup,function(){r.valueGroup.maybeAppendByClassName(fi.value,function(){return La(a)}).styles(o)})},e.prototype.renderBackground=function(t){var r=this.shape,i=r.width,a=r.height,o=Qt(this.attributes,"background");this.background=t.maybeAppendByClassName(fi.backgroundGroup,"g").style("zIndex",-1),this.background.maybeAppendByClassName(fi.background,"rect").styles(N({width:i,height:a},o))},e.prototype.adjustLayout=function(){var t=this.layout,r=t.labelWidth,i=t.valueWidth,a=t.height,o=C(t.position,3),s=o[0],l=o[1],c=o[2],u=a/2;this.markerGroup.styles({transform:"translate(".concat(s,", ").concat(u,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(l,", ").concat(u,")")}),i0(this.labelGroup.select(fi.label.class).node(),Math.ceil(r)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(c,", ").concat(u,")")}),i0(this.valueGroup.select(fi.value.class).node(),Math.ceil(i)))},e.prototype.render=function(t,r){var i=Lt(r),a=t.x,o=a===void 0?0:a,s=t.y,l=s===void 0?0:s;i.styles({transform:"translate(".concat(o,", ").concat(l,")")}),this.renderMarker(i),this.renderLabel(i),this.renderValue(i),this.renderBackground(i),this.adjustLayout()},e}(Tn),Ko=Ki({page:"item-page",navigator:"navigator",item:"item"},"items"),SE=function(n,e,t){return t===void 0&&(t=!0),n?e(n):t},o6=function(n){B(e,n);function e(t){var r=n.call(this,t,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:t0,mouseenter:t0,mouseleave:t0})||this;return r.navigatorShape=[0,0],r}return Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var t=this.attributes,r=t.gridRow,i=t.gridCol,a=t.data;if(!r&&!i)throw new Error("gridRow and gridCol can not be set null at the same time");return r&&i?[r,i]:r?[r,a.length]:[a.length,i]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var t=this.attributes,r=t.data,i=t.layout,a=Qt(this.attributes,"item"),o=r.map(function(s,l){var c=s.id,u=c===void 0?l:c,h=s.label,f=s.value;return{id:"".concat(u),index:l,style:N({layout:i,labelText:h,valueText:f},Object.fromEntries(Object.entries(a).map(function(d){var p=C(d,2),v=p[0],g=p[1];return[v,Di(g,[s,l,r])]})))}});return o},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var t=this,r=this.attributes,i=r.orientation,a=r.width,o=r.rowPadding,s=r.colPadding,l=C(this.navigatorShape,1),c=l[0],u=C(this.grid,2),h=u[0],f=u[1],d=f*h,p=0;return this.pageViews.children.map(function(v,g){var m,x,_=Math.floor(g/d),S=g%d,b=t.ifHorizontal(f,h),y=[Math.floor(S/b),S%b];i==="vertical"&&y.reverse();var E=C(y,2),w=E[0],M=E[1],P=(a-c-(f-1)*s)/f,A=v.getBBox().height,O=C([0,0],2),R=O[0],L=O[1];return i==="horizontal"?(m=C([p,w*(A+o)],2),R=m[0],L=m[1],p=M===f-1?0:p+P+s):(x=C([M*(P+s),p],2),R=x[0],L=x[1],p=w===h-1?0:p+A+o),{page:_,index:g,row:w,col:M,pageIndex:S,width:P,height:A,x:R,y:L}})},e.prototype.getFlexLayout=function(){var t=this.attributes,r=t.width,i=t.height,a=t.rowPadding,o=t.colPadding,s=C(this.navigatorShape,1),l=s[0],c=C(this.grid,2),u=c[0],h=c[1],f=C([r-l,i],2),d=f[0],p=f[1],v=C([0,0,0,0,0,0,0,0],8),g=v[0],m=v[1],x=v[2],_=v[3],S=v[4],b=v[5],y=v[6],E=v[7];return this.pageViews.children.map(function(w,M){var P,A,O,R,L=w.getBBox(),z=L.width,Y=L.height,I=y===0?0:o,Z=y+I+z;if(Z<=d&&SE(S,function(mt){return mt<h}))return P=C([y+I,E,Z],3),g=P[0],m=P[1],y=P[2],{width:z,height:Y,x:g,y:m,page:x,index:M,pageIndex:_++,row:b,col:S++};A=C([b+1,0,0,E+Y+a],4),b=A[0],S=A[1],y=A[2],E=A[3];var J=E+Y;return J<=p&&SE(b,function(mt){return mt<u})?(O=C([y,E,z],3),g=O[0],m=O[1],y=O[2],{width:z,height:Y,x:g,y:m,page:x,index:M,pageIndex:_++,row:b,col:S++}):(R=C([0,0,z,0,x+1,0,0,0],8),g=R[0],m=R[1],y=R[2],E=R[3],x=R[4],_=R[5],b=R[6],S=R[7],{width:z,height:Y,x:g,y:m,page:x,index:M,pageIndex:_++,row:b,col:S++})})},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var t=this.attributes.layout==="grid"?this.getGridLayout:this.getFlexLayout,r=t.call(this);return r.slice(-1)[0].page>0?(this.navigatorShape=[55,0],t.call(this)):r},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(t,r){var i=this.attributes.orientation;return n0(i,t,r)},e.prototype.flattenPage=function(t){t.querySelectorAll(Ko.item.class).forEach(function(r){t.appendChild(r)}),t.querySelectorAll(Ko.page.class).forEach(function(r){var i=t.removeChild(r);i.destroy()})},e.prototype.renderItems=function(t){var r=this.attributes,i=r.click,a=r.mouseenter,o=r.mouseleave;this.flattenPage(t);var s=this.dispatchCustomEvent.bind(this);Lt(t).selectAll(Ko.item.class).data(this.renderData,function(l){return l.id}).join(function(l){return l.append(function(c){var u=c.style;return new a6({style:u})}).attr("className",Ko.item.name).on("click",function(){i==null||i(this),s("itemClick",{item:this})}).on("pointerenter",function(){a==null||a(this),s("itemMouseenter",{item:this})}).on("pointerleave",function(){o==null||o(this),s("itemMouseleave",{item:this})})},function(l){return l.each(function(c){var u=c.style;this.update(u)})},function(l){return l.remove()})},e.prototype.relayoutNavigator=function(){var t,r=this.attributes,i=r.layout,a=r.width,o=((t=this.pageViews.children[0])===null||t===void 0?void 0:t.getBBox().height)||0,s=C(this.navigatorShape,2),l=s[0],c=s[1];this.navigator.update(i==="grid"?{pageWidth:a-l,pageHeight:o-c}:{})},e.prototype.adjustLayout=function(){var t=this,r=Object.entries(_D(this.itemsLayout,"page")).map(function(a){var o=C(a,2),s=o[0],l=o[1];return{page:s,layouts:l}}),i=K([],C(this.navigator.getContainer().children),!1);r.forEach(function(a){var o=a.layouts,s=t.pageViews.appendChild(new qn({className:Ko.page.name}));o.forEach(function(l){var c=l.x,u=l.y,h=l.index,f=l.width,d=l.height,p=i[h];s.appendChild(p),Hl(p,"__layout__",l),p.update({x:c,y:u,width:f,height:d})})}),this.relayoutNavigator()},e.prototype.renderNavigator=function(t){var r=this.attributes.orientation,i=Qt(this.attributes,"nav"),a=Un({orientation:r},i),o=this;return t.selectAll(Ko.navigator.class).data(["nav"]).join(function(s){return s.append(function(){return new jD({style:a})}).attr("className",Ko.navigator.name).each(function(){o.navigator=this})},function(s){return s.each(function(){this.update(a)})},function(s){return s.remove()}),this.navigator},e.prototype.getBBox=function(){return this.navigator.getBBox()},e.prototype.render=function(t,r){var i=this.attributes.data;if(!(!i||i.length===0)){var a=this.renderNavigator(Lt(r));this.renderItems(a.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(t,r){var i=new Fn(t,{detail:r});this.dispatchEvent(i)},e}(Tn),dc=Ki({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),TE={showLabel:!0,formatter:function(n){return n.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0},ZU=function(n){B(e,n);function e(t){return n.call(this,t,TE)||this}return e.prototype.render=function(t,r){var i=Lt(r).maybeAppendByClassName(dc.markerGroup,"g");this.renderMarker(i);var a=Lt(r).maybeAppendByClassName(dc.labelGroup,"g");this.renderLabel(a)},e.prototype.renderMarker=function(t){var r=this,i=this.attributes,a=i.orientation,o=i.markerSymbol,s=o===void 0?n0(a,"horizontalHandle","verticalHandle"):o;hi(!!s,t,function(l){var c=Qt(r.attributes,"marker"),u=N({symbol:s},c);r.marker=l.maybeAppendByClassName(dc.marker,function(){return new We({style:u})}).update(u)})},e.prototype.renderLabel=function(t){var r=this,i=this.attributes,a=i.showLabel,o=i.orientation,s=i.spacing,l=s===void 0?0:s,c=i.formatter;hi(a,t,function(u){var h,f=Qt(r.attributes,"label"),d=f.text,p=V(f,["text"]),v=((h=u.select(dc.marker.class))===null||h===void 0?void 0:h.node().getBBox())||{},g=v.width,m=g===void 0?0:g,x=v.height,_=x===void 0?0:x,S=C(n0(o,[0,_+l,"center","top"],[m+l,0,"start","middle"]),4),b=S[0],y=S[1],E=S[2],w=S[3];u.maybeAppendByClassName(dc.label,"text").styles(N(N({},p),{x:b,y,text:c(d).toString(),textAlign:E,textBaseline:w}))})},e}(Tn),PE={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},s6=Un({},PE,{}),qU=Un({},PE,el(TE,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"}),JU=.01,QU=.5,pc=Ki({title:"title",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend"),l6=function(n){B(e,n);function e(t){return n.call(this,t,s6)||this}return e.prototype.renderTitle=function(t,r,i){var a=this.attributes,o=a.showTitle,s=a.titleText,l=Qt(this.attributes,"title"),c=C(ka(l),2),u=c[0],h=c[1];this.titleGroup=t.maybeAppendByClassName(pc.titleGroup,"g").styles(h);var f=N(N({width:r,height:i},u),{text:o?s:""});this.title=this.titleGroup.maybeAppendByClassName(pc.title,function(){return new wD({style:f})}).update(f)},e.prototype.renderItems=function(t,r){var i=r.x,a=r.y,o=r.width,s=r.height,l=Qt(this.attributes,"title",!0),c=C(ka(l),2),u=c[0],h=c[1],f=N(N({},u),{width:o,height:s,x:0,y:0});this.itemsGroup=t.maybeAppendByClassName(pc.itemsGroup,"g").styles(N(N({},h),{transform:"translate(".concat(i,", ").concat(a,")")}));var d=this;this.itemsGroup.selectAll(pc.items.class).data(["items"]).join(function(p){return p.append(function(){return new o6({style:f})}).attr("className",pc.items.name).each(function(){d.items=Lt(this)})},function(p){return p.update(f)},function(p){return p.remove()})},e.prototype.adjustLayout=function(){var t=this.attributes.showTitle;if(t){var r=this.title.node().getAvailableSpace(),i=r.x,a=r.y;this.itemsGroup.node().style.transform="translate(".concat(i,", ").concat(a,")")}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,r=t.showTitle,i=t.width,a=t.height;return r?this.title.node().getAvailableSpace():new mn(0,0,i,a)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var t,r,i=(t=this.title)===null||t===void 0?void 0:t.node(),a=(r=this.items)===null||r===void 0?void 0:r.node();return!i||!a?n.prototype.getBBox.call(this):xD(i,a)},e.prototype.render=function(t,r){var i=this.attributes,a=i.width,o=i.height,s=i.x,l=s===void 0?0:s,c=i.y,u=c===void 0?0:c,h=Lt(r);r.style.transform="translate(".concat(l,", ").concat(u,")"),this.renderTitle(h,a,o),this.renderItems(h,this.availableSpace),this.adjustLayout()},e}(Tn);const hm=class extends _r{constructor(t,r){super(t,Object.assign({},hm.defaultOptions,r));k(this,"typePrefix","__data__");k(this,"element",null);k(this,"draw",!1);k(this,"fieldMap",{node:new Map,edge:new Map,combo:new Map});k(this,"selectedItems",[]);k(this,"bindEvents",()=>{const{graph:t}=this.context;t.on(Tt.AFTER_DRAW,this.createElement)});k(this,"changeState",(t,r)=>{const{graph:i}=this.context,{typePrefix:a}=this,o=wr(t,[a,"id"]),s=wr(t,[a,"style","labelText"]),[l]=o.split("__"),c=this.fieldMap[l].get(s)||[];i.setElementState(Object.fromEntries(c==null?void 0:c.map(u=>[u,r])))});k(this,"click",t=>{if(this.options.trigger==="hover")return;const r=wr(t,[this.typePrefix,"id"]);this.selectedItems.includes(r)?(this.selectedItems=this.selectedItems.filter(i=>i!==r),this.changeState(t,[])):(this.selectedItems.push(r),this.changeState(t,"selected"))});k(this,"mouseleave",t=>{this.options.trigger!=="click"&&(this.selectedItems=[],this.changeState(t,[]))});k(this,"mouseenter",t=>{if(this.options.trigger==="click")return;const r=wr(t,[this.typePrefix,"id"]);this.selectedItems.includes(r)?this.selectedItems=this.selectedItems.filter(i=>i!==r):(this.selectedItems.push(r),this.changeState(t,"active"))});k(this,"setFieldMap",(t,r,i)=>{if(!t)return;const a=this.fieldMap[i];if(a)if(!a.has(t))a.set(t,[r]);else{const o=a.get(t);o&&(o.push(r),a.set(t,o))}});k(this,"getEvents",()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}));k(this,"getMarkerData",(t,r)=>{if(!t)return[];const{model:i,element:a,graph:o}=this.context,{nodes:s,edges:l,combos:c}=i.getData(),u={},h=g=>jt(t)?t(g):t,f={node:"circle",edge:"line",combo:"rect"},d={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},p=(g,m)=>a==null?void 0:a.getElementComputedStyle(g,m),v=(g,m)=>{g.forEach(x=>{const{id:_}=x,S=wr(x,["data",h(x)]),b=(a==null?void 0:a.getElementType(m,x))||"circle",y=p(m,x),E=(m==="edge"?y==null?void 0:y.stroke:y==null?void 0:y.fill)||"#1783ff";_&&S&&S.replace(/\s+/g,"")&&(this.setFieldMap(S,_,m),u[S]||(u[S]={id:`${m}__${_}`,label:S,marker:d[b]||f[m],elementType:m,lineWidth:1,stroke:E,fill:E}))})};switch(r){case"node":v(s,"node");break;case"edge":v(l,"edge");break;case"combo":v(c,"combo");break;default:return[]}return Object.values(u)});k(this,"layout",t=>{const r={flexDirection:"row",alignItems:"flex-end",justifyContent:"center"};let{flexDirection:i,alignItems:a,justifyContent:o}=r;const s={top:["row","flex-start","center"],bottom:["row","flex-end","center"],left:["column","flex-start","center"],right:["column","flex-end","center"]};return t in s&&([i,a,o]=s[t]),{display:"flex",flexDirection:i,justifyContent:o,alignItems:a}});k(this,"createElement",()=>{if(this.draw){this.updateElement();return}const{canvas:t}=this.context,[r,i]=t.getSize(),b=this.options,{width:a=r,height:o=i,nodeField:s,edgeField:l,comboField:c,trigger:u,position:h}=b,f=Ce(b,["width","height","nodeField","edgeField","comboField","trigger","position"]),d=this.getMarkerData(s,"node"),p=this.getMarkerData(l,"edge"),v=this.getMarkerData(c,"combo"),g=[...d,...v,...p],m=this.layout(h),x=new sD({style:at({width:a,height:o},m)}),_=Object.assign({width:a,height:o,data:g,itemMarkerLineWidth:({lineWidth:y})=>y,itemMarker:({marker:y})=>y,itemMarkerStroke:({stroke:y})=>y,itemMarkerFill:({fill:y})=>y,gridCol:d.length},f,this.getEvents()),S=new l6({className:"legend",style:_});x.appendChild(S),t.appendChild(x),this.element=x,this.draw=!0});this.bindEvents()}update(t){super.update(t),this.clear(),this.createElement()}clear(){var t;(t=this.element)==null||t.destroy(),this.element=null,this.draw=!1}updateElement(){if(!this.element)return;this.element.getChildByIndex(0).update({itemMarkerOpacity:({id:r})=>!this.selectedItems.length||this.selectedItems.includes(r)?1:.5,itemLabelOpacity:({id:r})=>!this.selectedItems.length||this.selectedItems.includes(r)?1:.5})}destroy(){this.clear(),this.context.graph.off(Tt.AFTER_DRAW,this.createElement),super.destroy()}};let lf=hm;k(lf,"defaultOptions",{position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16});function c6(n,e){var t=e.cx,r=t===void 0?0:t,i=e.cy,a=i===void 0?0:i,o=e.r;n.arc(r,a,o,0,Math.PI*2,!1)}function u6(n,e){var t=e.cx,r=t===void 0?0:t,i=e.cy,a=i===void 0?0:i,o=e.rx,s=e.ry;if(n.ellipse)n.ellipse(r,a,o,s,0,0,Math.PI*2,!1);else{var l=o>s?o:s,c=o>s?1:o/s,u=o>s?s/o:1;n.save(),n.scale(c,u),n.arc(r,a,l,0,Math.PI*2)}}function h6(n,e){var t=e.x1,r=e.y1,i=e.x2,a=e.y2,o=e.markerStart,s=e.markerEnd,l=e.markerStartOffset,c=e.markerEndOffset,u=0,h=0,f=0,d=0,p=0,v,g;o&&ye(o)&&l&&(v=i-t,g=a-r,p=Math.atan2(g,v),u=Math.cos(p)*(l||0),h=Math.sin(p)*(l||0)),s&&ye(s)&&c&&(v=t-i,g=r-a,p=Math.atan2(g,v),f=Math.cos(p)*(c||0),d=Math.sin(p)*(c||0)),n.moveTo(t+u,r+h),n.lineTo(i+f,a+d)}function f6(n,e){var t=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,o=e.d,s=o.absolutePath,l=o.segments,c=0,u=0,h=0,f=0,d=0,p,v;if(t&&ye(t)&&i){var g=C(t.parentNode.getStartTangent(),2),m=g[0],x=g[1];p=m[0]-x[0],v=m[1]-x[1],d=Math.atan2(v,p),c=Math.cos(d)*(i||0),u=Math.sin(d)*(i||0)}if(r&&ye(r)&&a){var _=C(r.parentNode.getEndTangent(),2),m=_[0],x=_[1];p=m[0]-x[0],v=m[1]-x[1],d=Math.atan2(v,p),h=Math.cos(d)*(a||0),f=Math.sin(d)*(a||0)}for(var S=0;S<s.length;S++){var b=s[S],y=b[0],E=s[S+1],w=S===0&&(c!==0||u!==0),M=(S===s.length-1||E&&(E[0]==="M"||E[0]==="Z"))&&h!==0&&f!==0;switch(y){case"M":w?(n.moveTo(b[1]+c,b[2]+u),n.lineTo(b[1],b[2])):n.moveTo(b[1],b[2]);break;case"L":M?n.lineTo(b[1]+h,b[2]+f):n.lineTo(b[1],b[2]);break;case"Q":n.quadraticCurveTo(b[1],b[2],b[3],b[4]),M&&n.lineTo(b[3]+h,b[4]+f);break;case"C":n.bezierCurveTo(b[1],b[2],b[3],b[4],b[5],b[6]),M&&n.lineTo(b[5]+h,b[6]+f);break;case"A":{var P=l[S].arcParams,A=P.cx,O=P.cy,R=P.rx,L=P.ry,z=P.startAngle,Y=P.endAngle,I=P.xRotation,Z=P.sweepFlag;if(n.ellipse)n.ellipse(A,O,R,L,I,z,Y,!!(1-Z));else{var J=R>L?R:L,mt=R>L?1:R/L,It=R>L?L/R:1;n.translate(A,O),n.rotate(I),n.scale(mt,It),n.arc(0,0,J,z,Y,!!(1-Z)),n.scale(1/mt,1/It),n.rotate(-I),n.translate(-A,-O)}M&&n.lineTo(b[6]+h,b[7]+f);break}case"Z":n.closePath();break}}}function d6(n,e){var t=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,o=e.points.points,s=o.length,l=o[0][0],c=o[0][1],u=o[s-1][0],h=o[s-1][1],f=0,d=0,p=0,v=0,g=0,m,x;t&&ye(t)&&i&&(m=o[1][0]-o[0][0],x=o[1][1]-o[0][1],g=Math.atan2(x,m),f=Math.cos(g)*(i||0),d=Math.sin(g)*(i||0)),r&&ye(r)&&a&&(m=o[s-1][0]-o[0][0],x=o[s-1][1]-o[0][1],g=Math.atan2(x,m),p=Math.cos(g)*(a||0),v=Math.sin(g)*(a||0)),n.moveTo(l+(f||p),c+(d||v));for(var _=1;_<s-1;_++){var S=o[_];n.lineTo(S[0],S[1])}n.lineTo(u,h)}function p6(n,e){var t=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,a=e.markerEndOffset,o=e.points.points,s=o.length,l=o[0][0],c=o[0][1],u=o[s-1][0],h=o[s-1][1],f=0,d=0,p=0,v=0,g=0,m,x;t&&ye(t)&&i&&(m=o[1][0]-o[0][0],x=o[1][1]-o[0][1],g=Math.atan2(x,m),f=Math.cos(g)*(i||0),d=Math.sin(g)*(i||0)),r&&ye(r)&&a&&(m=o[s-2][0]-o[s-1][0],x=o[s-2][1]-o[s-1][1],g=Math.atan2(x,m),p=Math.cos(g)*(a||0),v=Math.sin(g)*(a||0)),n.moveTo(l+f,c+d);for(var _=1;_<s-1;_++){var S=o[_];n.lineTo(S[0],S[1])}n.lineTo(u+p,h+v)}function v6(n,e){var t=e.x,r=t===void 0?0:t,i=e.y,a=i===void 0?0:i,o=e.radius,s=e.width,l=e.height,c=s,u=l,h=o&&o.some(function(S){return S!==0});if(!h)n.rect(r,a,c,u);else{var f=s>0?1:-1,d=l>0?1:-1,p=f+d===0,v=C(o.map(function(S){return me(S,0,Math.min(Math.abs(c)/2,Math.abs(u)/2))}),4),g=v[0],m=v[1],x=v[2],_=v[3];n.moveTo(f*g+r,a),n.lineTo(c-f*m+r,a),m!==0&&n.arc(c-f*m+r,d*m+a,m,-d*Math.PI/2,f>0?0:Math.PI,p),n.lineTo(c+r,u-d*x+a),x!==0&&n.arc(c-f*x+r,u-d*x+a,x,f>0?0:Math.PI,d>0?Math.PI/2:1.5*Math.PI,p),n.lineTo(f*_+r,u+a),_!==0&&n.arc(f*_+r,u-d*_+a,_,d>0?Math.PI/2:-Math.PI/2,f>0?Math.PI:0,p),n.lineTo(r,d*g+a),g!==0&&n.arc(f*g+r,d*g+a,g,f>0?Math.PI:0,d>0?Math.PI*1.5:Math.PI/2,p)}}var g6=function(n){B(e,n);function e(){var t=n.apply(this,K([],C(arguments),!1))||this;return t.name="canvas-path-generator",t}return e.prototype.init=function(){var t,r=(t={},t[ct.CIRCLE]=c6,t[ct.ELLIPSE]=u6,t[ct.RECT]=v6,t[ct.LINE]=h6,t[ct.POLYLINE]=p6,t[ct.POLYGON]=d6,t[ct.PATH]=f6,t[ct.TEXT]=void 0,t[ct.GROUP]=void 0,t[ct.IMAGE]=void 0,t[ct.HTML]=void 0,t[ct.MESH]=void 0,t);this.context.pathGeneratorFactory=r},e.prototype.destroy=function(){delete this.context.pathGeneratorFactory},e}(Oo),m6=T.Ue(),y6=T.Ue(),x6=T.Ue(),b6=Q(),E6=function(){function n(){var e=this;this.isHit=function(t,r,i,a){var o=e.context.pointInPathPickerFactory[t.nodeName];if(o){var s=Wt(b6,i),l=T.fF(y6,T.t8(x6,r[0],r[1],0),s);if(o(t,new Yn(l[0],l[1]),a,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(t,r){var i=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),a=e.context.pathGeneratorFactory[t.nodeName];return a&&(i.beginPath(),a(i,t.parsedStyle),i.closePath()),i.isPointInPath(r.x,r.y)}}return n.prototype.apply=function(e,t){var r=this,i,a=e.renderingService,o=e.renderingContext;this.context=e,this.runtime=t;var s=(i=o.root)===null||i===void 0?void 0:i.ownerDocument;a.hooks.pick.tapPromise(n.tag,function(l){return j(r,void 0,void 0,function(){return gt(this,function(c){return[2,this.pick(s,l)]})})}),a.hooks.pickSync.tap(n.tag,function(l){return r.pick(s,l)})},n.prototype.pick=function(e,t){var r,i,a=t.topmost,o=t.position,s=o.x,l=o.y,c=T.t8(m6,s,l,0),u=e.elementsFromBBox(c[0],c[1],c[0],c[1]),h=[];try{for(var f=pt(u),d=f.next();!d.done;d=f.next()){var p=d.value,v=p.getWorldTransform(),g=this.isHit(p,c,v,!1);if(g){var m=Ry(p);if(m){var x=m.parsedStyle.clipPath,_=this.isHit(x,c,x.getWorldTransform(),!0);if(_){if(a)return t.picked=[p],t;h.push(p)}}else{if(a)return t.picked=[p],t;h.push(p)}}}}catch(S){r={error:S}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}return t.picked=h,t},n.tag="CanvasPicker",n}();function w6(n,e,t){var r=n.parsedStyle,i=r.cx,a=i===void 0?0:i,o=r.cy,s=o===void 0?0:o,l=r.r,c=r.fill,u=r.stroke,h=r.lineWidth,f=h===void 0?1:h,d=r.increasedLineWidthForHitTesting,p=d===void 0?0:d,v=r.pointerEvents,g=v===void 0?"auto":v,m=(f+p)/2,x=ar(a,s,e.x,e.y),_=C(ko(g,c,u),2),S=_[0],b=_[1];return S&&b||t?x<=l+m:S?x<=l:b?x>=l-m&&x<=l+m:!1}function cf(n,e,t,r){return n/(t*t)+e/(r*r)}function _6(n,e,t){var r=n.parsedStyle,i=r.cx,a=i===void 0?0:i,o=r.cy,s=o===void 0?0:o,l=r.rx,c=r.ry,u=r.fill,h=r.stroke,f=r.lineWidth,d=f===void 0?1:f,p=r.increasedLineWidthForHitTesting,v=p===void 0?0:p,g=r.pointerEvents,m=g===void 0?"auto":g,x=e.x,_=e.y,S=C(ko(m,u,h),2),b=S[0],y=S[1],E=(d+v)/2,w=(x-a)*(x-a),M=(_-s)*(_-s);return b&&y||t?cf(w,M,l+E,c+E)<=1:b?cf(w,M,l,c)<=1:y?cf(w,M,l-E,c-E)>=1&&cf(w,M,l+E,c+E)<=1:!1}function Zo(n,e,t,r,i,a){return i>=n&&i<=n+t&&a>=e&&a<=e+r}function S6(n,e,t,r,i,a,o){var s=i/2;return Zo(n-s,e-s,t,i,a,o)||Zo(n+t-s,e-s,i,r,a,o)||Zo(n+s,e+r-s,t,i,a,o)||Zo(n-s,e+s,i,r,a,o)}function uf(n,e,t,r,i,a,o,s){var l=(Math.atan2(s-e,o-n)+Math.PI*2)%(Math.PI*2),c={x:n+t*Math.cos(l),y:e+t*Math.sin(l)};return ar(c.x,c.y,o,s)<=a/2}function so(n,e,t,r,i,a,o){var s=Math.min(n,t),l=Math.max(n,t),c=Math.min(e,r),u=Math.max(e,r),h=i/2;return a>=s-h&&a<=l+h&&o>=c-h&&o<=u+h?Wm(n,e,t,r,a,o)<=i/2:!1}function ME(n,e,t,r,i){var a=n.length;if(a<2)return!1;for(var o=0;o<a-1;o++){var s=n[o][0],l=n[o][1],c=n[o+1][0],u=n[o+1][1];if(so(s,l,c,u,e,t,r))return!0}if(i){var h=n[0],f=n[a-1];if(so(h[0],h[1],f[0],f[1],e,t,r))return!0}return!1}var T6=1e-6;function a0(n){return Math.abs(n)<T6?0:n<0?-1:1}function P6(n,e,t){return(t[0]-n[0])*(e[1]-n[1])===(e[0]-n[0])*(t[1]-n[1])&&Math.min(n[0],e[0])<=t[0]&&t[0]<=Math.max(n[0],e[0])&&Math.min(n[1],e[1])<=t[1]&&t[1]<=Math.max(n[1],e[1])}function CE(n,e,t){var r=!1,i=n.length;if(i<=2)return!1;for(var a=0;a<i;a++){var o=n[a],s=n[(a+1)%i];if(P6(o,s,[e,t]))return!0;a0(o[1]-t)>0!=a0(s[1]-t)>0&&a0(e-(t-o[1])*(o[0]-s[0])/(o[1]-s[1])-o[0])<0&&(r=!r)}return r}function AE(n,e,t){for(var r=!1,i=0;i<n.length;i++){var a=n[i];if(r=CE(a,e,t),r)break}return r}function M6(n,e,t){var r=n.parsedStyle,i=r.x1,a=r.y1,o=r.x2,s=r.y2,l=r.lineWidth,c=l===void 0?1:l,u=r.increasedLineWidthForHitTesting,h=u===void 0?0:u,f=r.pointerEvents,d=f===void 0?"auto":f,p=r.fill,v=r.stroke,g=C(ko(d,p,v),2),m=g[1];return!m&&!t||!c?!1:so(i,a,o,s,c+h,e.x,e.y)}function C6(n,e,t,r,i){for(var a=!1,o=e/2,s=0;s<n.length;s++){var l=n[s],c=l.currentPoint,u=l.params,h=l.prePoint,f=l.box;if(!(f&&!Zo(f.x-o,f.y-o,f.width+e,f.height+e,t,r)))switch(l.command){case"L":case"Z":if(a=so(h[0],h[1],c[0],c[1],e,t,r),a)return!0;break;case"Q":var d=LT(h[0],h[1],u[1],u[2],u[3],u[4],t,r);if(a=d<=e/2,a)return!0;break;case"C":var p=Hm(h[0],h[1],u[1],u[2],u[3],u[4],u[5],u[6],t,r,i);if(a=p<=e/2,a)return!0;break;case"A":l.cubicParams||(l.cubicParams=vd(h[0],h[1],u[1],u[2],u[3],u[4],u[5],u[6],u[7],void 0));for(var v=l.cubicParams,g=h,m=0;m<v.length;m+=6){var x=Hm(g[0],g[1],v[m],v[m+1],v[m+2],v[m+3],v[m+4],v[m+5],t,r,i);if(g=[v[m+4],v[m+5]],a=x<=e/2,a)return!0}break}}return a}function A6(n,e,t,r,i,a){var o=n.parsedStyle,s=o.lineWidth,l=s===void 0?1:s,c=o.increasedLineWidthForHitTesting,u=c===void 0?0:c,h=o.stroke,f=o.fill,d=o.d,p=o.pointerEvents,v=p===void 0?"auto":p,g=d.segments,m=d.hasArc,x=d.polylines,_=d.polygons,S=C(ko(v,(_==null?void 0:_.length)&&f,h),2),b=S[0],y=S[1],E=Hd(n),w=!1;return b||t?(m?w=r(n,e):w=AE(_,e.x,e.y)||AE(x,e.x,e.y),w):((y||t)&&(w=C6(g,l+u,e.x,e.y,E)),w)}function O6(n,e,t){var r=n.parsedStyle,i=r.stroke,a=r.fill,o=r.lineWidth,s=o===void 0?1:o,l=r.increasedLineWidthForHitTesting,c=l===void 0?0:l,u=r.points,h=r.pointerEvents,f=h===void 0?"auto":h,d=C(ko(f,a,i),2),p=d[0],v=d[1],g=!1;return(v||t)&&(g=ME(u.points,s+c,e.x,e.y,!0)),!g&&(p||t)&&(g=CE(u.points,e.x,e.y)),g}function N6(n,e,t){var r=n.parsedStyle,i=r.lineWidth,a=i===void 0?1:i,o=r.increasedLineWidthForHitTesting,s=o===void 0?0:o,l=r.points,c=r.pointerEvents,u=c===void 0?"auto":c,h=r.fill,f=r.stroke,d=C(ko(u,h,f),2),p=d[1];return!p&&!t||!a?!1:ME(l.points,a+s,e.x,e.y,!1)}function R6(n,e,t,r,i){var a=n.parsedStyle,o=a.radius,s=a.fill,l=a.stroke,c=a.lineWidth,u=c===void 0?1:c,h=a.increasedLineWidthForHitTesting,f=h===void 0?0:h,d=a.x,p=d===void 0?0:d,v=a.y,g=v===void 0?0:v,m=a.width,x=a.height,_=a.pointerEvents,S=_===void 0?"auto":_,b=C(ko(S,s,l),2),y=b[0],E=b[1],w=o&&o.some(function(O){return O!==0}),M=u+f;if(w){var A=!1;return(E||t)&&(A=k6(p,g,m,x,o.map(function(O){return me(O,0,Math.min(Math.abs(m)/2,Math.abs(x)/2))}),M,e.x,e.y)),!A&&(y||t)&&(A=r(n,e)),A}else{var P=M/2;if(y&&E||t)return Zo(p-P,g-P,m+P,x+P,e.x,e.y);if(y)return Zo(p,g,m,x,e.x,e.y);if(E)return S6(p,g,m,x,M,e.x,e.y)}return!1}function k6(n,e,t,r,i,a,o,s){var l=C(i,4),c=l[0],u=l[1],h=l[2],f=l[3];return so(n+c,e,n+t-u,e,a,o,s)||so(n+t,e+u,n+t,e+r-h,a,o,s)||so(n+t-h,e+r,n+f,e+r,a,o,s)||so(n,e+r-f,n,e+c,a,o,s)||uf(n+t-u,e+u,u,1.5*Math.PI,2*Math.PI,a,o,s)||uf(n+t-h,e+r-h,h,0,.5*Math.PI,a,o,s)||uf(n+f,e+r-f,f,.5*Math.PI,Math.PI,a,o,s)||uf(n+c,e+c,c,Math.PI,1.5*Math.PI,a,o,s)}function L6(n,e,t,r,i,a){var o=n.parsedStyle,s=o.pointerEvents,l=s===void 0?"auto":s,c=o.x,u=c===void 0?0:c,h=o.y,f=h===void 0?0:h,d=o.width,p=o.height;if(l==="non-transparent-pixel"){var v=i.config.offscreenCanvas,g=a.offscreenCanvasCreator.getOrCreateCanvas(v),m=a.offscreenCanvasCreator.getOrCreateContext(v,{willReadFrequently:!0});g.width=d,g.height=p,i.defaultStyleRendererFactory[ct.IMAGE].render(m,N(N({},n.parsedStyle),{x:0,y:0}),n,void 0,void 0,void 0);var x=m.getImageData(e.x-u,e.y-f,1,1).data;return x.every(function(_){return _!==0})}return!0}var I6=function(n){B(e,n);function e(){var t=n.apply(this,K([],C(arguments),!1))||this;return t.name="canvas-picker",t}return e.prototype.init=function(){var t,r=function(){return!0},i=(t={},t[ct.CIRCLE]=w6,t[ct.ELLIPSE]=_6,t[ct.RECT]=R6,t[ct.LINE]=M6,t[ct.POLYLINE]=N6,t[ct.POLYGON]=O6,t[ct.PATH]=A6,t[ct.TEXT]=r,t[ct.GROUP]=null,t[ct.IMAGE]=L6,t[ct.HTML]=null,t[ct.MESH]=null,t);this.context.pointInPathPickerFactory=i,this.addRenderingPlugin(new E6)},e.prototype.destroy=function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()},e}(Oo),D6=function(){function n(e){this.canvasRendererPluginOptions=e,this.removedRBushNodeAABBs=[],this.renderQueue=[],this.restoreStack=[],this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=Q(),this.dprMatrix=Q(),this.tmpMat4=Q(),this.vec3a=T.Ue(),this.vec3b=T.Ue(),this.vec3c=T.Ue(),this.vec3d=T.Ue()}return n.prototype.apply=function(e,t){var r=this;this.context=e;var i=e.config,a=e.camera,o=e.renderingService,s=e.renderingContext,l=e.rBushRoot,c=e.pathGeneratorFactory;this.rBush=l,this.pathGeneratorFactory=c;var u=e.contextService,h=s.root.ownerDocument.defaultView,f=function(v){var g=v.target,m=g.rBushNode;m.aabb&&r.removedRBushNodeAABBs.push(m.aabb)},d=function(v){var g=v.target,m=g.rBushNode;m.aabb&&r.removedRBushNodeAABBs.push(m.aabb)};o.hooks.init.tap(n.tag,function(){h.addEventListener(oe.UNMOUNTED,f),h.addEventListener(oe.CULLED,d);var v=u.getDPR(),g=i.width,m=i.height,x=u.getContext();r.clearRect(x,0,0,g*v,m*v,i.background)}),o.hooks.destroy.tap(n.tag,function(){h.removeEventListener(oe.UNMOUNTED,f),h.removeEventListener(oe.CULLED,d),r.renderQueue=[],r.removedRBushNodeAABBs=[],r.restoreStack=[]}),o.hooks.beginFrame.tap(n.tag,function(){var v,g=u.getContext(),m=u.getDPR(),x=i.width,_=i.height,S=r.canvasRendererPluginOptions,b=S.dirtyObjectNumThreshold,y=S.dirtyObjectRatioThreshold,E=o.getStats(),w=E.total,M=E.rendered,P=M/w;r.clearFullScreen=r.clearFullScreenLastFrame||!(!((v=h.context.renderingPlugins[1])===null||v===void 0)&&v.isFirstTimeRenderingFinished)||o.disableDirtyRectangleRendering()||M>b&&P>y,g&&(g.resetTransform?g.resetTransform():g.setTransform(1,0,0,1,0,0),r.clearFullScreen&&r.clearRect(g,0,0,x*m,_*m,i.background))});var p=function(v,g){v.isVisible()&&!v.isCulled()&&r.renderDisplayObject(v,g,r.context,r.restoreStack,t);var m=v.sortable.sorted||v.childNodes;m.forEach(function(x){p(x,g)})};o.hooks.endFrame.tap(n.tag,function(){if(s.root.childNodes.length===0){r.clearFullScreenLastFrame=!0;return}r.clearFullScreenLastFrame=!1;var v=u.getContext(),g=u.getDPR();if(Ae(r.dprMatrix,[g,g,1]),Ut(r.vpMatrix,r.dprMatrix,a.getOrthoMatrix()),r.clearFullScreen)p(s.root,v);else{var m=r.safeMergeAABB.apply(r,K([r.mergeDirtyAABBs(r.renderQueue)],C(r.removedRBushNodeAABBs.map(function(It){var ae=It.minX,ve=It.minY,Hn=It.maxX,rr=It.maxY,rn=new Fe;return rn.setMinMax([ae,ve,0],[Hn,rr,0]),rn})),!1));if(r.removedRBushNodeAABBs=[],Fe.isEmpty(m)){r.renderQueue=[];return}var x=r.convertAABB2Rect(m),_=x.x,S=x.y,b=x.width,y=x.height,E=T.fF(r.vec3a,[_,S,0],r.vpMatrix),w=T.fF(r.vec3b,[_+b,S,0],r.vpMatrix),M=T.fF(r.vec3c,[_,S+y,0],r.vpMatrix),P=T.fF(r.vec3d,[_+b,S+y,0],r.vpMatrix),A=Math.min(E[0],w[0],P[0],M[0]),O=Math.min(E[1],w[1],P[1],M[1]),R=Math.max(E[0],w[0],P[0],M[0]),L=Math.max(E[1],w[1],P[1],M[1]),z=Math.floor(A),Y=Math.floor(O),I=Math.ceil(R-A),Z=Math.ceil(L-O);v.save(),r.clearRect(v,z,Y,I,Z,i.background),v.beginPath(),v.rect(z,Y,I,Z),v.clip(),v.setTransform(r.vpMatrix[0],r.vpMatrix[1],r.vpMatrix[4],r.vpMatrix[5],r.vpMatrix[12],r.vpMatrix[13]);var J=i.renderer.getConfig().enableDirtyRectangleRenderingDebug;J&&h.dispatchEvent(new or(ai.DIRTY_RECTANGLE,{dirtyRect:{x:z,y:Y,width:I,height:Z}}));var mt=r.searchDirtyObjects(m);mt.sort(function(It,ae){return It.sortable.renderOrder-ae.sortable.renderOrder}).forEach(function(It){It&&It.isVisible()&&!It.isCulled()&&r.renderDisplayObject(It,v,r.context,r.restoreStack,t)}),v.restore(),r.renderQueue.forEach(function(It){r.saveDirtyAABB(It)}),r.renderQueue=[]}r.restoreStack.forEach(function(){v.restore()}),r.restoreStack=[]}),o.hooks.render.tap(n.tag,function(v){r.clearFullScreen||r.renderQueue.push(v)})},n.prototype.clearRect=function(e,t,r,i,a,o){e.clearRect(t,r,i,a),o&&(e.fillStyle=o,e.fillRect(t,r,i,a))},n.prototype.renderDisplayObject=function(e,t,r,i,a){var o=e.nodeName,s=i[i.length-1];s&&!(e.compareDocumentPosition(s)&zn.DOCUMENT_POSITION_CONTAINS)&&(t.restore(),i.pop());var l=this.context.styleRendererFactory[o],c=this.pathGeneratorFactory[o],u=e.parsedStyle.clipPath;if(u){this.applyWorldTransform(t,u);var h=this.pathGeneratorFactory[u.nodeName];h&&(t.save(),i.push(e),t.beginPath(),h(t,u.parsedStyle),t.closePath(),t.clip())}l&&(this.applyWorldTransform(t,e),t.save(),this.applyAttributesToContext(t,e)),c&&(t.beginPath(),c(t,e.parsedStyle),e.nodeName!==ct.LINE&&e.nodeName!==ct.PATH&&e.nodeName!==ct.POLYLINE&&t.closePath()),l&&(l.render(t,e.parsedStyle,e,r,this,a),t.restore()),e.renderable.dirty=!1},n.prototype.convertAABB2Rect=function(e){var t=e.getMin(),r=e.getMax(),i=Math.floor(t[0]),a=Math.floor(t[1]),o=Math.ceil(r[0]),s=Math.ceil(r[1]),l=o-i,c=s-a;return{x:i,y:a,width:l,height:c}},n.prototype.mergeDirtyAABBs=function(e){var t=new Fe;return e.forEach(function(r){var i=r.getRenderBounds();t.add(i);var a=r.renderable.dirtyRenderBounds;a&&t.add(a)}),t},n.prototype.searchDirtyObjects=function(e){var t=C(e.getMin(),2),r=t[0],i=t[1],a=C(e.getMax(),2),o=a[0],s=a[1],l=this.rBush.search({minX:r,minY:i,maxX:o,maxY:s});return l.map(function(c){var u=c.displayObject;return u})},n.prototype.saveDirtyAABB=function(e){var t=e.renderable;t.dirtyRenderBounds||(t.dirtyRenderBounds=new Fe);var r=e.getRenderBounds();r&&t.dirtyRenderBounds.update(r.center,r.halfExtents)},n.prototype.applyAttributesToContext=function(e,t){var r=t.parsedStyle,i=r.stroke,a=r.fill,o=r.opacity,s=r.lineDash,l=r.lineDashOffset;s&&e.setLineDash(s),Mt(l)||(e.lineDashOffset=l),Mt(o)||(e.globalAlpha*=o),!Mt(i)&&!Array.isArray(i)&&!i.isNone&&(e.strokeStyle=t.attributes.stroke),!Mt(a)&&!Array.isArray(a)&&!a.isNone&&(e.fillStyle=t.attributes.fill)},n.prototype.applyWorldTransform=function(e,t,r){r?(kt(this.tmpMat4,t.getLocalTransform()),Ut(this.tmpMat4,r,this.tmpMat4),Ut(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(kt(this.tmpMat4,t.getWorldTransform()),Ut(this.tmpMat4,this.vpMatrix,this.tmpMat4)),e.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])},n.prototype.safeMergeAABB=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=new Fe;return e.forEach(function(i){r.add(i)}),r},n.tag="CanvasRenderer",n}(),lo=function(){function n(e){this.imagePool=e}return n.prototype.render=function(e,t,r,i,a,o){var s=t.fill,l=t.fillRule,c=t.opacity,u=c===void 0?1:c,h=t.fillOpacity,f=h===void 0?1:h,d=t.stroke,p=t.strokeOpacity,v=p===void 0?1:p,g=t.lineWidth,m=g===void 0?1:g,x=t.lineCap,_=t.lineJoin,S=t.shadowType,b=t.shadowColor,y=t.shadowBlur,E=t.filter,w=t.miterLimit,M=s&&!s.isNone,P=d&&!d.isNone&&m>0,A=(s==null?void 0:s.alpha)===0,O=!!(E&&E.length),R=!Mt(b)&&y>0,L=r.nodeName,z=S==="inner",Y=P&&R&&(L===ct.PATH||L===ct.LINE||L===ct.POLYLINE||A||z);M&&(e.globalAlpha=u*f,Y||hf(r,e,R),RE(e,r,s,l,i,a,o,this.imagePool),Y||this.clearShadowAndFilter(e,O,R)),P&&(e.globalAlpha=u*v,e.lineWidth=m,Mt(w)||(e.miterLimit=w),Mt(x)||(e.lineCap=x),Mt(_)||(e.lineJoin=_),Y&&(z&&(e.globalCompositeOperation="source-atop"),hf(r,e,!0),z&&(o0(e,r,d,i,a,o,this.imagePool),e.globalCompositeOperation="source-over",this.clearShadowAndFilter(e,O,!0))),o0(e,r,d,i,a,o,this.imagePool))},n.prototype.clearShadowAndFilter=function(e,t,r){if(r&&(e.shadowColor="transparent",e.shadowBlur=0),t){var i=e.filter;!Mt(i)&&i.indexOf("drop-shadow")>-1&&(e.filter=i.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}},n}();function hf(n,e,t){var r=n.parsedStyle,i=r.filter,a=r.shadowColor,o=r.shadowBlur,s=r.shadowOffsetX,l=r.shadowOffsetY;i&&i.length&&(e.filter=n.style.filter),t&&(e.shadowColor=a.toString(),e.shadowBlur=o||0,e.shadowOffsetX=s||0,e.shadowOffsetY=l||0)}function OE(n,e,t,r,i,a,o){var s,l;if(n.image.nodeName==="rect"){var c=n.image.parsedStyle,u=c.width,h=c.height;l=r.contextService.getDPR();var f=r.config.offscreenCanvas;s=a.offscreenCanvasCreator.getOrCreateCanvas(f),s.width=u*l,s.height=h*l;var d=a.offscreenCanvasCreator.getOrCreateContext(f),p=[];n.image.forEach(function(g){i.renderDisplayObject(g,d,r,p,a)}),p.forEach(function(){d.restore()})}var v=o.getOrCreatePatternSync(n,t,s,l,e.getGeometryBounds().min,function(){e.renderable.dirty=!0,r.renderingService.dirtify()});return v}function NE(n,e,t,r){var i;if(n.type===ea.LinearGradient||n.type===ea.RadialGradient){var a=e.getGeometryBounds(),o=a&&a.halfExtents[0]*2||1,s=a&&a.halfExtents[1]*2||1,l=a&&a.min||[0,0];i=r.getOrCreateGradient(N(N({type:n.type},n.value),{min:l,width:o,height:s}),t)}return i}function RE(n,e,t,r,i,a,o,s,l){l===void 0&&(l=!1),Array.isArray(t)?t.forEach(function(c){n.fillStyle=NE(c,e,n,s),l||(r?n.fill(r):n.fill())}):(zd(t)&&(n.fillStyle=OE(t,e,n,i,a,o,s)),l||(r?n.fill(r):n.fill()))}function o0(n,e,t,r,i,a,o,s){s===void 0&&(s=!1),Array.isArray(t)?t.forEach(function(l){n.strokeStyle=NE(l,e,n,o),s||n.stroke()}):(zd(t)&&(n.strokeStyle=OE(t,e,n,r,i,a,o)),s||n.stroke())}var B6=function(){function n(e){this.imagePool=e}return n.prototype.render=function(e,t,r){var i=t.x,a=i===void 0?0:i,o=t.y,s=o===void 0?0:o,l=t.width,c=t.height,u=t.src,h=t.shadowColor,f=t.shadowBlur,d,p=l,v=c;if(ue(u)?d=this.imagePool.getImageSync(u):(p||(p=u.width),v||(v=u.height),d=u),d){var g=!Mt(h)&&f>0;hf(r,e,g);try{e.drawImage(d,a,s,p,v)}catch(m){}}},n}(),F6=function(){function n(e){this.imagePool=e}return n.prototype.render=function(e,t,r,i,a,o){r.getBounds();var s=t,l=s.lineWidth,c=l===void 0?1:l,u=s.textAlign,h=u===void 0?"start":u,f=s.textBaseline,d=f===void 0?"alphabetic":f,p=s.lineJoin,v=p===void 0?"miter":p,g=s.miterLimit,m=g===void 0?10:g,x=s.letterSpacing,_=x===void 0?0:x,S=s.stroke,b=s.fill,y=s.fillRule,E=s.fillOpacity,w=E===void 0?1:E,M=s.strokeOpacity,P=M===void 0?1:M,A=s.opacity,O=A===void 0?1:A,R=s.metrics,L=s.x,z=L===void 0?0:L,Y=s.y,I=Y===void 0?0:Y,Z=s.dx,J=s.dy,mt=s.shadowColor,It=s.shadowBlur,ae=R.font,ve=R.lines,Hn=R.height,rr=R.lineHeight,rn=R.lineMetrics;e.font=ae,e.lineWidth=c,e.textAlign=h==="middle"?"center":h;var He=d;!o.enableCSSParsing&&He==="alphabetic"&&(He="bottom"),e.lineJoin=v,Mt(m)||(e.miterLimit=m);var hn=I;d==="middle"?hn+=-Hn/2-rr/2:d==="bottom"||d==="alphabetic"||d==="ideographic"?hn+=-Hn:(d==="top"||d==="hanging")&&(hn+=-rr);var dr=z+(Z||0);hn+=J||0,ve.length===1&&(He==="bottom"?(He="middle",hn-=.5*Hn):He==="top"&&(He="middle",hn+=.5*Hn)),e.textBaseline=He;var an=!Mt(mt)&&It>0;hf(r,e,an);for(var pr=0;pr<ve.length;pr++){var bo=c/2+dr;hn+=rr,!Mt(S)&&!S.isNone&&c&&this.drawLetterSpacing(e,r,ve[pr],rn[pr],h,bo,hn,_,b,y,w,S,P,O,!0,i,a,o),Mt(b)||this.drawLetterSpacing(e,r,ve[pr],rn[pr],h,bo,hn,_,b,y,w,S,P,O,!1,i,a,o)}},n.prototype.drawLetterSpacing=function(e,t,r,i,a,o,s,l,c,u,h,f,d,p,v,g,m,x){if(l===0){v?this.strokeText(e,t,r,o,s,f,d,g,m,x):this.fillText(e,t,r,o,s,c,u,h,p,g,m,x);return}var _=e.textAlign;e.textAlign="left";var S=o;a==="center"||a==="middle"?S=o-i.width/2:(a==="right"||a==="end")&&(S=o-i.width);for(var b=Array.from(r),y=e.measureText(r).width,E=0,w=0;w<b.length;++w){var M=b[w];v?this.strokeText(e,t,M,S,s,f,d,g,m,x):this.fillText(e,t,M,S,s,c,u,h,p,g,m,x),E=e.measureText(r.substring(w+1)).width,S+=y-E+l,y=E}e.textAlign=_},n.prototype.fillText=function(e,t,r,i,a,o,s,l,c,u,h,f){RE(e,t,o,s,u,h,f,this.imagePool,!0);var d,p=!Mt(l)&&l!==1;p&&(d=e.globalAlpha,e.globalAlpha=l*c),e.fillText(r,i,a),p&&(e.globalAlpha=d)},n.prototype.strokeText=function(e,t,r,i,a,o,s,l,c,u){o0(e,t,o,l,c,u,this.imagePool,!0);var h,f=!Mt(s)&&s!==1;f&&(h=e.globalAlpha,e.globalAlpha=s),e.strokeText(r,i,a),f&&(e.globalAlpha=h)},n}(),tV=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(lo),eV=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(lo),nV=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(lo),rV=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(lo),iV=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(lo),aV=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(lo),oV=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(lo),G6=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=n.call(this)||this;return r.options=t,r.name="canvas-renderer",r}return e.prototype.init=function(){var t,r=N({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),i=this.context.imagePool,a=new lo(i),o=(t={},t[ct.CIRCLE]=a,t[ct.ELLIPSE]=a,t[ct.RECT]=a,t[ct.IMAGE]=new B6(i),t[ct.TEXT]=new F6(i),t[ct.LINE]=a,t[ct.POLYLINE]=a,t[ct.POLYGON]=a,t[ct.PATH]=a,t[ct.GROUP]=void 0,t[ct.HTML]=void 0,t[ct.MESH]=void 0,t);this.context.defaultStyleRendererFactory=o,this.context.styleRendererFactory=o,this.addRenderingPlugin(new D6(r))},e.prototype.destroy=function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory},e}(Oo),z6=function(){function n(){}return n.prototype.apply=function(e,t){var r=this,i=e.renderingService,a=e.renderingContext,o=e.config;this.context=e;var s=a.root.ownerDocument.defaultView,l=function(y){i.hooks.pointerMove.call(y)},c=function(y){i.hooks.pointerUp.call(y)},u=function(y){i.hooks.pointerDown.call(y)},h=function(y){i.hooks.pointerOver.call(y)},f=function(y){i.hooks.pointerOut.call(y)},d=function(y){i.hooks.pointerCancel.call(y)},p=function(y){i.hooks.pointerWheel.call(y)},v=function(y){i.hooks.click.call(y)},g=function(y){t.globalThis.document.addEventListener("pointermove",l,!0),y.addEventListener("pointerdown",u,!0),y.addEventListener("pointerleave",f,!0),y.addEventListener("pointerover",h,!0),t.globalThis.addEventListener("pointerup",c,!0),t.globalThis.addEventListener("pointercancel",d,!0)},m=function(y){y.addEventListener("touchstart",u,!0),y.addEventListener("touchend",c,!0),y.addEventListener("touchmove",l,!0),y.addEventListener("touchcancel",d,!0)},x=function(y){t.globalThis.document.addEventListener("mousemove",l,!0),y.addEventListener("mousedown",u,!0),y.addEventListener("mouseout",f,!0),y.addEventListener("mouseover",h,!0),t.globalThis.addEventListener("mouseup",c,!0)},_=function(y){t.globalThis.document.removeEventListener("pointermove",l,!0),y.removeEventListener("pointerdown",u,!0),y.removeEventListener("pointerleave",f,!0),y.removeEventListener("pointerover",h,!0),t.globalThis.removeEventListener("pointerup",c,!0)},S=function(y){y.removeEventListener("touchstart",u,!0),y.removeEventListener("touchend",c,!0),y.removeEventListener("touchmove",l,!0),y.removeEventListener("touchcancel",d,!0)},b=function(y){t.globalThis.document.removeEventListener("mousemove",l,!0),y.removeEventListener("mousedown",u,!0),y.removeEventListener("mouseout",f,!0),y.removeEventListener("mouseover",h,!0),t.globalThis.removeEventListener("mouseup",c,!0)};i.hooks.init.tap(n.tag,function(){var y=r.context.contextService.getDomElement();t.globalThis.navigator.msPointerEnabled?(y.style.msContentZooming="none",y.style.msTouchAction="none"):s.supportsPointerEvents&&(y.style.touchAction="none"),s.supportsPointerEvents?g(y):x(y),s.supportsTouchEvents&&m(y),o.useNativeClickEvent&&y.addEventListener("click",v,!0),y.addEventListener("wheel",p,{passive:!0,capture:!0})}),i.hooks.destroy.tap(n.tag,function(){var y=r.context.contextService.getDomElement();t.globalThis.navigator.msPointerEnabled?(y.style.msContentZooming="",y.style.msTouchAction=""):s.supportsPointerEvents&&(y.style.touchAction=""),s.supportsPointerEvents?_(y):b(y),s.supportsTouchEvents&&S(y),o.useNativeClickEvent&&y.removeEventListener("click",v,!0),y.removeEventListener("wheel",p,!0)})},n.tag="DOMInteraction",n}(),W6=function(n){B(e,n);function e(){var t=n.apply(this,K([],C(arguments),!1))||this;return t.name="dom-interaction",t}return e.prototype.init=function(){this.addRenderingPlugin(new z6)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(Oo),s0=function(n,e){return s0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},s0(n,e)};function Me(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");s0(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var te=function(){return te=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},te.apply(this,arguments)};function co(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function U6(n,e,t,r){var i=arguments.length,a=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var s=n.length-1;s>=0;s--)(o=n[s])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function V6(n,e){return function(t,r){e(t,r,n)}}function sV(n,e,t,r,i,a){function o(m){if(m!==void 0&&typeof m!="function")throw new TypeError("Function expected");return m}for(var s=r.kind,l=s==="getter"?"get":s==="setter"?"set":"value",c=!e&&n?r.static?n:n.prototype:null,u=e||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),h,f=!1,d=t.length-1;d>=0;d--){var p={};for(var v in r)p[v]=v==="access"?{}:r[v];for(var v in r.access)p.access[v]=r.access[v];p.addInitializer=function(m){if(f)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(m||null))};var g=(0,t[d])(s==="accessor"?{get:u.get,set:u.set}:u[l],p);if(s==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(h=o(g.get))&&(u.get=h),(h=o(g.set))&&(u.set=h),(h=o(g.init))&&i.unshift(h)}else(h=o(g))&&(s==="field"?i.unshift(h):u[l]=h)}c&&Object.defineProperty(c,r.name,u),f=!0}function lV(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0}function cV(n){return typeof n=="symbol"?n:"".concat(n)}function uV(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function H6(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function ff(n,e,t,r){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function s(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?a(u.value):i(u.value).then(s,l)}c((r=r.apply(n,e||[])).next())})}function df(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(t=0)),t;)try{if(r=1,i&&(a=c[0]&2?i.return:c[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,c[1])).done)return a;switch(i=0,a&&(c=[c[0]&2,a.value]),c[0]){case 0:case 1:a=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){t.label=c[1];break}if(c[0]===6&&t.label<a[1]){t.label=a[1],a=c;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(c);break}a[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],i=0}finally{r=a=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var l0=Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]};function Y6(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&l0(e,n,t)}function ca(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ht(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function X6(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Ht(arguments[e]));return n}function j6(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function Xe(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,a;r<i;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function vc(n){return this instanceof vc?(this.v=n,this):new vc(n)}function $6(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,a=[];return i={},s("next"),s("throw"),s("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(d){return function(p){return Promise.resolve(p).then(d,h)}}function s(d,p){r[d]&&(i[d]=function(v){return new Promise(function(g,m){a.push([d,v,g,m])>1||l(d,v)})},p&&(i[d]=p(i[d])))}function l(d,p){try{c(r[d](p))}catch(v){f(a[0][3],v)}}function c(d){d.value instanceof vc?Promise.resolve(d.value.v).then(u,h):f(a[0][2],d)}function u(d){l("next",d)}function h(d){l("throw",d)}function f(d,p){d(p),a.shift(),a.length&&l(a[0][0],a[0][1])}}function K6(n){var e,t;return e={},r("next"),r("throw",function(i){throw i}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(i,a){e[i]=n[i]?function(o){return(t=!t)?{value:vc(n[i](o)),done:!1}:a?a(o):o}:a}}function Z6(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ca=="function"?ca(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(s,l){o=n[a](o),i(s,l,o.done,o.value)})}}function i(a,o,s,l){Promise.resolve(l).then(function(c){a({value:c,done:s})},o)}}function q6(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var J6=Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e};function Q6(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.prototype.hasOwnProperty.call(n,t)&&l0(e,n,t);return J6(e,n),e}function tB(n){return n&&n.__esModule?n:{default:n}}function eB(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function nB(n,e,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t}function rB(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function iB(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var aB=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function oB(n){function e(r){n.error=n.hasError?new aB(r,n.error,"An error was suppressed during disposal."):r,n.hasError=!0}function t(){for(;n.stack.length;){var r=n.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(t,function(a){return e(a),t()})}catch(a){e(a)}}if(n.hasError)throw n.error}return t()}var hV={__extends:Me,__assign:te,__rest:co,__decorate:U6,__param:V6,__metadata:H6,__awaiter:ff,__generator:df,__createBinding:l0,__exportStar:Y6,__values:ca,__read:Ht,__spread:X6,__spreadArrays:j6,__spreadArray:Xe,__await:vc,__asyncGenerator:$6,__asyncDelegator:K6,__asyncValues:Z6,__makeTemplateObject:q6,__importStar:Q6,__importDefault:tB,__classPrivateFieldGet:eB,__classPrivateFieldSet:nB,__classPrivateFieldIn:rB,__addDisposableResource:iB,__disposeResources:oB},sB={}.toString,lB=function(n,e){return sB.call(n)==="[object "+e+"]"},pf=lB,cB=function(n){return pf(n,"Number")},Ia=cB,uB=function(n){return n==null},sn=uB,ua=function(n){return pf(n,"String")},hB=function(n,e,t){return n<e?e:n>t?t:n},vf=hB,gc={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function kE(n){return Array.isArray(n)&&n.every(function(e){var t=e[0].toLowerCase();return gc[t]===e.length-1&&"achlmqstvz".includes(t)})}function LE(n){return kE(n)&&n.every(function(e){var t=e[0];return t===t.toUpperCase()})}function IE(n){return LE(n)&&n.every(function(e){var t=e[0];return"ACLMQZ".includes(t)})}var DE={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function BE(n){for(var e=n.pathValue[n.segmentStart],t=e.toLowerCase(),r=n.data;r.length>=gc[t]&&(t==="m"&&r.length>2?(n.segments.push([e].concat(r.splice(0,2))),t="l",e=e==="m"?"l":"L"):n.segments.push([e].concat(r.splice(0,gc[t]))),!!gc[t]););}function fB(n){var e=n.index,t=n.pathValue,r=t.charCodeAt(e);if(r===48){n.param=0,n.index+=1;return}if(r===49){n.param=1,n.index+=1;return}n.err='[path-util]: invalid Arc flag "'+t[e]+'", expecting 0 or 1 at index '+e}function dB(n){return n>=48&&n<=57||n===43||n===45||n===46}function rl(n){return n>=48&&n<=57}function pB(n){var e=n.max,t=n.pathValue,r=n.index,i=r,a=!1,o=!1,s=!1,l=!1,c;if(i>=e){n.err="[path-util]: Invalid path value at index "+i+', "pathValue" is missing param';return}if(c=t.charCodeAt(i),(c===43||c===45)&&(i+=1,c=t.charCodeAt(i)),!rl(c)&&c!==46){n.err="[path-util]: Invalid path value at index "+i+', "'+t[i]+'" is not a number';return}if(c!==46){if(a=c===48,i+=1,c=t.charCodeAt(i),a&&i<e&&c&&rl(c)){n.err="[path-util]: Invalid path value at index "+r+', "'+t[r]+'" illegal number';return}for(;i<e&&rl(t.charCodeAt(i));)i+=1,o=!0;c=t.charCodeAt(i)}if(c===46){for(l=!0,i+=1;rl(t.charCodeAt(i));)i+=1,s=!0;c=t.charCodeAt(i)}if(c===101||c===69){if(l&&!o&&!s){n.err="[path-util]: Invalid path value at index "+i+', "'+t[i]+'" invalid float exponent';return}if(i+=1,c=t.charCodeAt(i),(c===43||c===45)&&(i+=1),i<e&&rl(t.charCodeAt(i)))for(;i<e&&rl(t.charCodeAt(i));)i+=1;else{n.err="[path-util]: Invalid path value at index "+i+', "'+t[i]+'" invalid integer exponent';return}}n.index=i,n.param=+n.pathValue.slice(r,i)}function vB(n){var e=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return n===10||n===13||n===8232||n===8233||n===32||n===9||n===11||n===12||n===160||n>=5760&&e.includes(n)}function gf(n){for(var e=n.pathValue,t=n.max;n.index<t&&vB(e.charCodeAt(n.index));)n.index+=1}function gB(n){switch(n|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function mB(n){return(n|32)===97}function yB(n){var e=n.max,t=n.pathValue,r=n.index,i=t.charCodeAt(r),a=gc[t[r].toLowerCase()];if(n.segmentStart=r,!gB(i)){n.err='[path-util]: Invalid path value "'+t[r]+'" is not a path command';return}if(n.index+=1,gf(n),n.data=[],!a){BE(n);return}for(;;){for(var o=a;o>0;o-=1){if(mB(i)&&(o===3||o===4)?fB(n):pB(n),n.err.length)return;n.data.push(n.param),gf(n),n.index<e&&t.charCodeAt(n.index)===44&&(n.index+=1,gf(n))}if(n.index>=n.max||!dB(t.charCodeAt(n.index)))break}BE(n)}var xB=function(){function n(e){this.pathValue=e,this.segments=[],this.max=e.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return n}();function bB(n){if(kE(n))return[].concat(n);var e=new xB(n);for(gf(e);e.index<e.max&&!e.err.length;)yB(e);return e.err?e.err:e.segments}function EB(n){if(LE(n))return[].concat(n);var e=bB(n),t=0,r=0,i=0,a=0;return e.map(function(o){var s=o.slice(1).map(Number),l=o[0],c=l.toUpperCase();if(l==="M")return t=s[0],r=s[1],i=t,a=r,["M",t,r];var u;if(l!==c)switch(c){case"A":u=[c,s[0],s[1],s[2],s[3],s[4],s[5]+t,s[6]+r];break;case"V":u=[c,s[0]+r];break;case"H":u=[c,s[0]+t];break;default:{var h=s.map(function(d,p){return d+(p%2?r:t)});u=[c].concat(h)}}else u=[c].concat(s);var f=u.length;switch(c){case"Z":t=i,r=a;break;case"H":t=u[1];break;case"V":r=u[1];break;default:t=u[f-2],r=u[f-1],c==="M"&&(i=t,a=r)}return u})}function wB(n,e){var t=n[0],r=e.x1,i=e.y1,a=e.x2,o=e.y2,s=n.slice(1).map(Number),l=n;if("TQ".includes(t)||(e.qx=null,e.qy=null),t==="H")l=["L",n[1],i];else if(t==="V")l=["L",r,n[1]];else if(t==="S"){var c=r*2-a,u=i*2-o;e.x1=c,e.y1=u,l=["C",c,u].concat(s)}else if(t==="T"){var h=r*2-e.qx,f=i*2-e.qy;e.qx=h,e.qy=f,l=["Q",h,f].concat(s)}else if(t==="Q"){var d=s[0],p=s[1];e.qx=d,e.qy=p}return l}function mf(n){if(IE(n))return[].concat(n);for(var e=EB(n),t=te({},DE),r=0;r<e.length;r+=1){e[r]=wB(e[r],t);var i=e[r],a=i.length;t.x1=+i[a-2],t.y1=+i[a-1],t.x2=+i[a-4]||t.x1,t.y2=+i[a-3]||t.y1}return e}function uo(n,e,t){var r=n[0],i=n[1],a=e[0],o=e[1];return[r+(a-r)*t,i+(o-i)*t]}function mc(n,e){return Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1]))}function c0(n,e,t,r,i){var a=mc([n,e],[t,r]),o={x:0,y:0};if(typeof i=="number")if(i<=0)o={x:n,y:e};else if(i>=a)o={x:t,y:r};else{var s=uo([n,e],[t,r],i/a),l=s[0],c=s[1];o={x:l,y:c}}return{length:a,point:o,min:{x:Math.min(n,t),y:Math.min(e,r)},max:{x:Math.max(n,t),y:Math.max(e,r)}}}function FE(n,e){var t=n.x,r=n.y,i=e.x,a=e.y,o=t*i+r*a,s=Math.sqrt((Math.pow(t,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(a,2))),l=t*a-r*i<0?-1:1,c=l*Math.acos(o/s);return c}function _B(n,e,t,r,i,a,o,s,l,c){var u=Math.abs,h=Math.sin,f=Math.cos,d=Math.sqrt,p=Math.PI,v=u(t),g=u(r),m=(i%360+360)%360,x=m*(p/180);if(n===s&&e===l)return{x:n,y:e};if(v===0||g===0)return c0(n,e,s,l,c).point;var _=(n-s)/2,S=(e-l)/2,b={x:f(x)*_+h(x)*S,y:-h(x)*_+f(x)*S},y=Math.pow(b.x,2)/Math.pow(v,2)+Math.pow(b.y,2)/Math.pow(g,2);y>1&&(v*=d(y),g*=d(y));var E=Math.pow(v,2)*Math.pow(g,2)-Math.pow(v,2)*Math.pow(b.y,2)-Math.pow(g,2)*Math.pow(b.x,2),w=Math.pow(v,2)*Math.pow(b.y,2)+Math.pow(g,2)*Math.pow(b.x,2),M=E/w;M=M<0?0:M;var P=(a!==o?1:-1)*d(M),A={x:P*(v*b.y/g),y:P*(-(g*b.x)/v)},O={x:f(x)*A.x-h(x)*A.y+(n+s)/2,y:h(x)*A.x+f(x)*A.y+(e+l)/2},R={x:(b.x-A.x)/v,y:(b.y-A.y)/g},L=FE({x:1,y:0},R),z={x:(-b.x-A.x)/v,y:(-b.y-A.y)/g},Y=FE(R,z);!o&&Y>0?Y-=2*p:o&&Y<0&&(Y+=2*p),Y%=2*p;var I=L+Y*c,Z=v*f(I),J=g*h(I),mt={x:f(x)*Z-h(x)*J+O.x,y:h(x)*Z+f(x)*J+O.y};return mt}function SB(n,e,t,r,i,a,o,s,l,c,u){var h,f=u.bbox,d=f===void 0?!0:f,p=u.length,v=p===void 0?!0:p,g=u.sampleSize,m=g===void 0?30:g,x=typeof c=="number",_=n,S=e,b=0,y=[_,S,b],E=[_,S],w=0,M={x:0,y:0},P=[{x:_,y:S}];x&&c<=0&&(M={x:_,y:S});for(var A=0;A<=m;A+=1){if(w=A/m,h=_B(n,e,t,r,i,a,o,s,l,w),_=h.x,S=h.y,d&&P.push({x:_,y:S}),v&&(b+=mc(E,[_,S])),E=[_,S],x&&b>=c&&c>y[2]){var O=(b-c)/(b-y[2]);M={x:E[0]*(1-O)+y[0]*O,y:E[1]*(1-O)+y[1]*O}}y=[_,S,b]}return x&&c>=b&&(M={x:s,y:l}),{length:b,point:M,min:{x:Math.min.apply(null,P.map(function(R){return R.x})),y:Math.min.apply(null,P.map(function(R){return R.y}))},max:{x:Math.max.apply(null,P.map(function(R){return R.x})),y:Math.max.apply(null,P.map(function(R){return R.y}))}}}function TB(n,e,t,r,i,a,o,s,l){var c=1-l;return{x:Math.pow(c,3)*n+3*Math.pow(c,2)*l*t+3*c*Math.pow(l,2)*i+Math.pow(l,3)*o,y:Math.pow(c,3)*e+3*Math.pow(c,2)*l*r+3*c*Math.pow(l,2)*a+Math.pow(l,3)*s}}function GE(n,e,t,r,i,a,o,s,l,c){var u,h=c.bbox,f=h===void 0?!0:h,d=c.length,p=d===void 0?!0:d,v=c.sampleSize,g=v===void 0?10:v,m=typeof l=="number",x=n,_=e,S=0,b=[x,_,S],y=[x,_],E=0,w={x:0,y:0},M=[{x,y:_}];m&&l<=0&&(w={x,y:_});for(var P=0;P<=g;P+=1){if(E=P/g,u=TB(n,e,t,r,i,a,o,s,E),x=u.x,_=u.y,f&&M.push({x,y:_}),p&&(S+=mc(y,[x,_])),y=[x,_],m&&S>=l&&l>b[2]){var A=(S-l)/(S-b[2]);w={x:y[0]*(1-A)+b[0]*A,y:y[1]*(1-A)+b[1]*A}}b=[x,_,S]}return m&&l>=S&&(w={x:o,y:s}),{length:S,point:w,min:{x:Math.min.apply(null,M.map(function(O){return O.x})),y:Math.min.apply(null,M.map(function(O){return O.y}))},max:{x:Math.max.apply(null,M.map(function(O){return O.x})),y:Math.max.apply(null,M.map(function(O){return O.y}))}}}function PB(n,e,t,r,i,a,o){var s=1-o;return{x:Math.pow(s,2)*n+2*s*o*t+Math.pow(o,2)*i,y:Math.pow(s,2)*e+2*s*o*r+Math.pow(o,2)*a}}function MB(n,e,t,r,i,a,o,s){var l,c=s.bbox,u=c===void 0?!0:c,h=s.length,f=h===void 0?!0:h,d=s.sampleSize,p=d===void 0?10:d,v=typeof o=="number",g=n,m=e,x=0,_=[g,m,x],S=[g,m],b=0,y={x:0,y:0},E=[{x:g,y:m}];v&&o<=0&&(y={x:g,y:m});for(var w=0;w<=p;w+=1){if(b=w/p,l=PB(n,e,t,r,i,a,b),g=l.x,m=l.y,u&&E.push({x:g,y:m}),f&&(x+=mc(S,[g,m])),S=[g,m],v&&x>=o&&o>_[2]){var M=(x-o)/(x-_[2]);y={x:S[0]*(1-M)+_[0]*M,y:S[1]*(1-M)+_[1]*M}}_=[g,m,x]}return v&&o>=x&&(y={x:i,y:a}),{length:x,point:y,min:{x:Math.min.apply(null,E.map(function(P){return P.x})),y:Math.min.apply(null,E.map(function(P){return P.y}))},max:{x:Math.max.apply(null,E.map(function(P){return P.x})),y:Math.max.apply(null,E.map(function(P){return P.y}))}}}function zE(n,e,t){for(var r,i,a,o,s,l,c=mf(n),u=typeof e=="number",h,f=[],d,p=0,v=0,g=0,m=0,x,_=[],S=[],b=0,y={x:0,y:0},E=y,w=y,M=y,P=0,A=0,O=c.length;A<O;A+=1)x=c[A],d=x[0],h=d==="M",f=h?f:[p,v].concat(x.slice(1)),h?(g=x[1],m=x[2],y={x:g,y:m},E=y,b=0,u&&e<.001&&(M=y)):d==="L"?(r=c0(f[0],f[1],f[2],f[3],(e||0)-P),b=r.length,y=r.min,E=r.max,w=r.point):d==="A"?(i=SB(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],(e||0)-P,t||{}),b=i.length,y=i.min,E=i.max,w=i.point):d==="C"?(a=GE(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],(e||0)-P,t||{}),b=a.length,y=a.min,E=a.max,w=a.point):d==="Q"?(o=MB(f[0],f[1],f[2],f[3],f[4],f[5],(e||0)-P,t||{}),b=o.length,y=o.min,E=o.max,w=o.point):d==="Z"&&(f=[p,v,g,m],s=c0(f[0],f[1],f[2],f[3],(e||0)-P),b=s.length,y=s.min,E=s.max,w=s.point),u&&P<e&&P+b>=e&&(M=w),S.push(E),_.push(y),P+=b,l=d!=="Z"?x.slice(-2):[g,m],p=l[0],v=l[1];return u&&e>=P&&(M={x:p,y:v}),{length:P,point:M,min:{x:Math.min.apply(null,_.map(function(R){return R.x})),y:Math.min.apply(null,_.map(function(R){return R.y}))},max:{x:Math.max.apply(null,S.map(function(R){return R.x})),y:Math.max.apply(null,S.map(function(R){return R.y}))}}}function CB(n,e){return zE(n,void 0,te(te({},e),{bbox:!1,length:!0})).length}var u0=function(n){return Array.isArray?Array.isArray(n):pf(n,"Array")},WE=function(n){if(u0(n))return n.reduce(function(e,t){return Math.min(e,t)},n[0])},UE=function(n){if(u0(n))return n.reduce(function(e,t){return Math.max(e,t)},n[0])},AB=1e-5;function OB(n,e,t){return t===void 0&&(t=AB),Math.abs(n-e)<t}var NB=function(n,e){return(n%e+e)%e},VE=NB;function RB(n,e,t){if(n[t].length>7){n[t].shift();for(var r=n[t],i=t;r.length;)e[t]="A",n.splice(i+=1,0,["C"].concat(r.splice(0,6)));n.splice(t,1)}}function kB(n){return IE(n)&&n.every(function(e){var t=e[0];return"MC".includes(t)})}function yf(n,e,t){var r=n*Math.cos(t)-e*Math.sin(t),i=n*Math.sin(t)+e*Math.cos(t);return{x:r,y:i}}function HE(n,e,t,r,i,a,o,s,l,c){var u=n,h=e,f=t,d=r,p=s,v=l,g=Math.PI*120/180,m=Math.PI/180*(+i||0),x=[],_,S,b,y,E;if(c)S=c[0],b=c[1],y=c[2],E=c[3];else{_=yf(u,h,-m),u=_.x,h=_.y,_=yf(p,v,-m),p=_.x,v=_.y;var w=(u-p)/2,M=(h-v)/2,P=w*w/(f*f)+M*M/(d*d);P>1&&(P=Math.sqrt(P),f*=P,d*=P);var A=f*f,O=d*d,R=(a===o?-1:1)*Math.sqrt(Math.abs((A*O-A*M*M-O*w*w)/(A*M*M+O*w*w)));y=R*f*M/d+(u+p)/2,E=R*-d*w/f+(h+v)/2,S=Math.asin(((h-E)/d*Math.pow(10,9)>>0)/Math.pow(10,9)),b=Math.asin(((v-E)/d*Math.pow(10,9)>>0)/Math.pow(10,9)),S=u<y?Math.PI-S:S,b=p<y?Math.PI-b:b,S<0&&(S=Math.PI*2+S),b<0&&(b=Math.PI*2+b),o&&S>b&&(S-=Math.PI*2),!o&&b>S&&(b-=Math.PI*2)}var L=b-S;if(Math.abs(L)>g){var z=b,Y=p,I=v;b=S+g*(o&&b>S?1:-1),p=y+f*Math.cos(b),v=E+d*Math.sin(b),x=HE(p,v,f,d,i,0,o,Y,I,[b,z,y,E])}L=b-S;var Z=Math.cos(S),J=Math.sin(S),mt=Math.cos(b),It=Math.sin(b),ae=Math.tan(L/4),ve=4/3*f*ae,Hn=4/3*d*ae,rr=[u,h],rn=[u+ve*J,h-Hn*Z],He=[p+ve*It,v-Hn*mt],hn=[p,v];if(rn[0]=2*rr[0]-rn[0],rn[1]=2*rr[1]-rn[1],c)return rn.concat(He,hn,x);x=rn.concat(He,hn,x);for(var dr=[],an=0,pr=x.length;an<pr;an+=1)dr[an]=an%2?yf(x[an-1],x[an],m).y:yf(x[an],x[an+1],m).x;return dr}function LB(n,e,t,r,i,a){var o=.3333333333333333,s=2/3;return[o*n+s*t,o*e+s*r,o*i+s*t,o*a+s*r,i,a]}var YE=function(n,e,t,r){var i=.5,a=uo([n,e],[t,r],i);return Xe(Xe([],a,!0),[t,r,t,r],!1)};function IB(n,e){var t=n[0],r=n.slice(1).map(Number),i=r[0],a=r[1],o,s=e.x1,l=e.y1,c=e.x,u=e.y;switch("TQ".includes(t)||(e.qx=null,e.qy=null),t){case"M":return e.x=i,e.y=a,n;case"A":return o=[s,l].concat(r),["C"].concat(HE(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9]));case"Q":return e.qx=i,e.qy=a,o=[s,l].concat(r),["C"].concat(LB(o[0],o[1],o[2],o[3],o[4],o[5]));case"L":return["C"].concat(YE(s,l,i,a));case"Z":return s===c&&l===u?["C",s,l,c,u,c,u]:["C"].concat(YE(s,l,c,u));default:}return n}function h0(n,e){if(e===void 0&&(e=!1),kB(n)){var t=[].concat(n);return e?[t,[]]:t}for(var r=mf(n),i=te({},DE),a=[],o="",s=r.length,l,c,u=[],h=0;h<s;h+=1){r[h]&&(o=r[h][0]),a[h]=o;var f=IB(r[h],i);r[h]=f,RB(r,a,h),s=r.length,o==="Z"&&u.push(h),l=r[h],c=l.length,i.x1=+l[c-2],i.y1=+l[c-1],i.x2=+l[c-4]||i.x1,i.y2=+l[c-3]||i.y1}return e?[r,u]:r}function DB(n,e){e===void 0&&(e=.5);var t=n.slice(0,2),r=n.slice(2,4),i=n.slice(4,6),a=n.slice(6,8),o=uo(t,r,e),s=uo(r,i,e),l=uo(i,a,e),c=uo(o,s,e),u=uo(s,l,e),h=uo(c,u,e);return[["C"].concat(o,c,h),["C"].concat(u,l,a)]}function XE(n){return n.map(function(e,t,r){var i=t&&r[t-1].slice(-2).concat(e.slice(1)),a=t?GE(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0,o;return t?o=a?DB(i):[e,e]:o=[e],{s:e,ss:o,l:a}})}function jE(n,e,t){var r=XE(n),i=XE(e),a=r.length,o=i.length,s=r.filter(function(g){return g.l}).length,l=i.filter(function(g){return g.l}).length,c=r.filter(function(g){return g.l}).reduce(function(g,m){var x=m.l;return g+x},0)/s||0,u=i.filter(function(g){return g.l}).reduce(function(g,m){var x=m.l;return g+x},0)/l||0,h=t||Math.max(a,o),f=[c,u],d=[h-a,h-o],p=0,v=[r,i].map(function(g,m){return g.l===h?g.map(function(x){return x.s}):g.map(function(x,_){return p=_&&d[m]&&x.l>=f[m],d[m]-=p?1:0,p?x.ss:[x.s]}).flat()});return v[0].length===v[1].length?v:jE(v[0],v[1],h)}function BB(n,e,t,r,i,a,o,s){return 3*((s-e)*(t+i)-(o-n)*(r+a)+r*(n-i)-t*(e-a)+s*(i+n/3)-o*(a+e/3))/20}function FB(n){var e=0,t=0,r=0;return h0(n).map(function(i){var a;switch(i[0]){case"M":return e=i[1],t=i[2],0;default:var o=i.slice(1),s=o[0],l=o[1],c=o[2],u=o[3],h=o[4],f=o[5];return r=BB(e,t,s,l,c,u,h,f),a=i.slice(-2),e=a[0],t=a[1],r}}).reduce(function(i,a){return i+a},0)}function $E(n){return FB(n)>=0}function GB(n){var e=n.slice(1).map(function(t,r,i){return r?i[r-1].slice(-2).concat(t.slice(1)):n[0].slice(1).concat(t.slice(1))}).map(function(t){return t.map(function(r,i){return t[t.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(e[0].slice(0,2))].concat(e.map(function(t){return["C"].concat(t.slice(2))}))}function zB(n){return n.map(function(e){return Array.isArray(e)?[].concat(e):e})}function WB(n){var e=n.length,t=e-1;return n.map(function(r,i){return n.map(function(a,o){var s=i+o,l;return o===0||n[s]&&n[s][0]==="M"?(l=n[s],["M"].concat(l.slice(-2))):(s>=e&&(s-=t),n[s])})})}function UB(n,e){var t=n.length-1,r=[],i=0,a=0,o=WB(n);return o.forEach(function(s,l){n.slice(1).forEach(function(c,u){a+=mc(n[(l+u)%t].slice(-2),e[u%t].slice(-2))}),r[l]=a,a=0}),i=r.indexOf(Math.min.apply(null,r)),o[i]}var VB=function(n){return n===void 0},ln=VB,HB=function(n){return pf(n,"Boolean")},KE=HB,xf=function(n){var e=typeof n;return n!==null&&e==="object"||e==="function"};function YB(n,e,t){return zE(n,e,te(te({},t),{bbox:!1,length:!0})).point}var XB=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:typeof self!="undefined"?self:{},ZE={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(XB,function(){function t(b,y,E,w,M){r(b,y,E||0,w||b.length-1,M||a)}function r(b,y,E,w,M){for(;w>E;){if(w-E>600){var P=w-E+1,A=y-E+1,O=Math.log(P),R=.5*Math.exp(2*O/3),L=.5*Math.sqrt(O*R*(P-R)/P)*(A-P/2<0?-1:1),z=Math.max(E,Math.floor(y-A*R/P+L)),Y=Math.min(w,Math.floor(y+(P-A)*R/P+L));r(b,y,z,Y,M)}var I=b[y],Z=E,J=w;for(i(b,E,y),M(b[w],I)>0&&i(b,E,w);Z<J;){for(i(b,Z,J),Z++,J--;M(b[Z],I)<0;)Z++;for(;M(b[J],I)>0;)J--}M(b[E],I)===0?i(b,E,J):(J++,i(b,J,w)),J<=y&&(E=J+1),y<=J&&(w=J-1)}}function i(b,y,E){var w=b[y];b[y]=b[E],b[E]=w}function a(b,y){return b<y?-1:b>y?1:0}var o=function(y){y===void 0&&(y=9),this._maxEntries=Math.max(4,y),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(y){var E=this.data,w=[];if(!x(y,E))return w;for(var M=this.toBBox,P=[];E;){for(var A=0;A<E.children.length;A++){var O=E.children[A],R=E.leaf?M(O):O;x(y,R)&&(E.leaf?w.push(O):m(y,R)?this._all(O,w):P.push(O))}E=P.pop()}return w},o.prototype.collides=function(y){var E=this.data;if(!x(y,E))return!1;for(var w=[];E;){for(var M=0;M<E.children.length;M++){var P=E.children[M],A=E.leaf?this.toBBox(P):P;if(x(y,A)){if(E.leaf||m(y,A))return!0;w.push(P)}}E=w.pop()}return!1},o.prototype.load=function(y){if(!(y&&y.length))return this;if(y.length<this._minEntries){for(var E=0;E<y.length;E++)this.insert(y[E]);return this}var w=this._build(y.slice(),0,y.length-1,0);if(!this.data.children.length)this.data=w;else if(this.data.height===w.height)this._splitRoot(this.data,w);else{if(this.data.height<w.height){var M=this.data;this.data=w,w=M}this._insert(w,this.data.height-w.height-1,!0)}return this},o.prototype.insert=function(y){return y&&this._insert(y,this.data.height-1),this},o.prototype.clear=function(){return this.data=_([]),this},o.prototype.remove=function(y,E){if(!y)return this;for(var w=this.data,M=this.toBBox(y),P=[],A=[],O,R,L;w||P.length;){if(w||(w=P.pop(),R=P[P.length-1],O=A.pop(),L=!0),w.leaf){var z=s(y,w.children,E);if(z!==-1)return w.children.splice(z,1),P.push(w),this._condense(P),this}!L&&!w.leaf&&m(w,M)?(P.push(w),A.push(O),O=0,R=w,w=w.children[0]):R?(O++,w=R.children[O],L=!1):w=null}return this},o.prototype.toBBox=function(y){return y},o.prototype.compareMinX=function(y,E){return y.minX-E.minX},o.prototype.compareMinY=function(y,E){return y.minY-E.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(y){return this.data=y,this},o.prototype._all=function(y,E){for(var w=[];y;)y.leaf?E.push.apply(E,y.children):w.push.apply(w,y.children),y=w.pop();return E},o.prototype._build=function(y,E,w,M){var P=w-E+1,A=this._maxEntries,O;if(P<=A)return O=_(y.slice(E,w+1)),l(O,this.toBBox),O;M||(M=Math.ceil(Math.log(P)/Math.log(A)),A=Math.ceil(P/Math.pow(A,M-1))),O=_([]),O.leaf=!1,O.height=M;var R=Math.ceil(P/A),L=R*Math.ceil(Math.sqrt(A));S(y,E,w,L,this.compareMinX);for(var z=E;z<=w;z+=L){var Y=Math.min(z+L-1,w);S(y,z,Y,R,this.compareMinY);for(var I=z;I<=Y;I+=R){var Z=Math.min(I+R-1,Y);O.children.push(this._build(y,I,Z,M-1))}}return l(O,this.toBBox),O},o.prototype._chooseSubtree=function(y,E,w,M){for(;M.push(E),!(E.leaf||M.length-1===w);){for(var P=1/0,A=1/0,O=void 0,R=0;R<E.children.length;R++){var L=E.children[R],z=d(L),Y=v(y,L)-z;Y<A?(A=Y,P=z<P?z:P,O=L):Y===A&&z<P&&(P=z,O=L)}E=O||E.children[0]}return E},o.prototype._insert=function(y,E,w){var M=w?y:this.toBBox(y),P=[],A=this._chooseSubtree(M,this.data,E,P);for(A.children.push(y),u(A,M);E>=0&&P[E].children.length>this._maxEntries;)this._split(P,E),E--;this._adjustParentBBoxes(M,P,E)},o.prototype._split=function(y,E){var w=y[E],M=w.children.length,P=this._minEntries;this._chooseSplitAxis(w,P,M);var A=this._chooseSplitIndex(w,P,M),O=_(w.children.splice(A,w.children.length-A));O.height=w.height,O.leaf=w.leaf,l(w,this.toBBox),l(O,this.toBBox),E?y[E-1].children.push(O):this._splitRoot(w,O)},o.prototype._splitRoot=function(y,E){this.data=_([y,E]),this.data.height=y.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(y,E,w){for(var M,P=1/0,A=1/0,O=E;O<=w-E;O++){var R=c(y,0,O,this.toBBox),L=c(y,O,w,this.toBBox),z=g(R,L),Y=d(R)+d(L);z<P?(P=z,M=O,A=Y<A?Y:A):z===P&&Y<A&&(A=Y,M=O)}return M||w-E},o.prototype._chooseSplitAxis=function(y,E,w){var M=y.leaf?this.compareMinX:h,P=y.leaf?this.compareMinY:f,A=this._allDistMargin(y,E,w,M),O=this._allDistMargin(y,E,w,P);A<O&&y.children.sort(M)},o.prototype._allDistMargin=function(y,E,w,M){y.children.sort(M);for(var P=this.toBBox,A=c(y,0,E,P),O=c(y,w-E,w,P),R=p(A)+p(O),L=E;L<w-E;L++){var z=y.children[L];u(A,y.leaf?P(z):z),R+=p(A)}for(var Y=w-E-1;Y>=E;Y--){var I=y.children[Y];u(O,y.leaf?P(I):I),R+=p(O)}return R},o.prototype._adjustParentBBoxes=function(y,E,w){for(var M=w;M>=0;M--)u(E[M],y)},o.prototype._condense=function(y){for(var E=y.length-1,w=void 0;E>=0;E--)y[E].children.length===0?E>0?(w=y[E-1].children,w.splice(w.indexOf(y[E]),1)):this.clear():l(y[E],this.toBBox)};function s(b,y,E){if(!E)return y.indexOf(b);for(var w=0;w<y.length;w++)if(E(b,y[w]))return w;return-1}function l(b,y){c(b,0,b.children.length,y,b)}function c(b,y,E,w,M){M||(M=_(null)),M.minX=1/0,M.minY=1/0,M.maxX=-1/0,M.maxY=-1/0;for(var P=y;P<E;P++){var A=b.children[P];u(M,b.leaf?w(A):A)}return M}function u(b,y){return b.minX=Math.min(b.minX,y.minX),b.minY=Math.min(b.minY,y.minY),b.maxX=Math.max(b.maxX,y.maxX),b.maxY=Math.max(b.maxY,y.maxY),b}function h(b,y){return b.minX-y.minX}function f(b,y){return b.minY-y.minY}function d(b){return(b.maxX-b.minX)*(b.maxY-b.minY)}function p(b){return b.maxX-b.minX+(b.maxY-b.minY)}function v(b,y){return(Math.max(y.maxX,b.maxX)-Math.min(y.minX,b.minX))*(Math.max(y.maxY,b.maxY)-Math.min(y.minY,b.minY))}function g(b,y){var E=Math.max(b.minX,y.minX),w=Math.max(b.minY,y.minY),M=Math.min(b.maxX,y.maxX),P=Math.min(b.maxY,y.maxY);return Math.max(0,M-E)*Math.max(0,P-w)}function m(b,y){return b.minX<=y.minX&&b.minY<=y.minY&&y.maxX<=b.maxX&&y.maxY<=b.maxY}function x(b,y){return y.minX<=b.maxX&&y.minY<=b.maxY&&y.maxX>=b.minX&&y.maxY>=b.minY}function _(b){return{children:b,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function S(b,y,E,w,M){for(var P=[y,E];P.length;)if(E=P.pop(),y=P.pop(),!(E-y<=w)){var A=y+Math.ceil((E-y)/w/2)*w;t(b,A,y,E,M),P.push(y,A,A,E)}}return o})})(ZE);var jB=ZE.exports,At;(function(n){n.GROUP="g",n.CIRCLE="circle",n.ELLIPSE="ellipse",n.IMAGE="image",n.RECT="rect",n.LINE="line",n.POLYLINE="polyline",n.POLYGON="polygon",n.TEXT="text",n.PATH="path",n.HTML="html",n.MESH="mesh"})(At||(At={}));var il;(function(n){n[n.ZERO=0]="ZERO",n[n.NEGATIVE_ONE=1]="NEGATIVE_ONE"})(il||(il={}));var $B=function(){function n(){this.plugins=[]}return n.prototype.addRenderingPlugin=function(e){this.plugins.push(e),this.context.renderingPlugins.push(e)},n.prototype.removeAllRenderingPlugins=function(){var e=this;this.plugins.forEach(function(t){var r=e.context.renderingPlugins.indexOf(t);r>=0&&e.context.renderingPlugins.splice(r,1)})},n}(),fV=function(){function n(e){this.clipSpaceNearZ=il.NEGATIVE_ONE,this.plugins=[],this.config=te({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0},e)}return n.prototype.registerPlugin=function(e){var t=this.plugins.findIndex(function(r){return r===e});t===-1&&this.plugins.push(e)},n.prototype.unregisterPlugin=function(e){var t=this.plugins.findIndex(function(r){return r===e});t>-1&&this.plugins.splice(t,1)},n.prototype.getPlugins=function(){return this.plugins},n.prototype.getPlugin=function(e){return this.plugins.find(function(t){return t.name===e})},n.prototype.getConfig=function(){return this.config},n.prototype.setConfig=function(e){Object.assign(this.config,e)},n}();function al(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function f0(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function bf(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function qE(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n}function KB(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n}function ZB(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.min(e[2],t[2]),n}function d0(n){return n===void 0?0:n>360||n<-360?n%360:n}function jr(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=0),Array.isArray(n)&&n.length===3?T.d9(n):Ia(n)?T.al(n,e,t):T.al(n[0],n[1]||e,n[2]||t)}function qe(n){return n*(Math.PI/180)}function Fi(n){return n*(180/Math.PI)}function dV(n){return n=n%400,n<0&&(n+=400),n/400*360}function pV(n){return n/360}function qB(n){return 360*n}function JB(n,e){var t=e[0],r=e[1],i=e[2],a=e[3],o=t*t,s=r*r,l=i*i,c=a*a,u=o+s+l+c,h=t*a-r*i;return h>.499995*u?(n[0]=Math.PI/2,n[1]=2*Math.atan2(r,t),n[2]=0):h<-.499995*u?(n[0]=-Math.PI/2,n[1]=2*Math.atan2(r,t),n[2]=0):(n[0]=Math.asin(2*(t*i-a*r)),n[1]=Math.atan2(2*(t*a+r*i),1-2*(l+c)),n[2]=Math.atan2(2*(t*r+i*a),1-2*(s+l))),n}function QB(n,e){var t,r,i=Math.PI*.5,a=Ht(Ye(T.Ue(),e),3),o=a[0],s=a[1],l=a[2],c=Math.asin(-e[2]/o);return c<i?c>-i?(t=Math.atan2(e[6]/s,e[10]/l),r=Math.atan2(e[1]/o,e[0]/o)):(r=0,t=-Math.atan2(e[4]/s,e[5]/s)):(r=0,t=Math.atan2(e[4]/s,e[5]/s)),n[0]=t,n[1]=c,n[2]=r,n}function p0(n,e){return e.length===16?QB(n,e):JB(n,e)}function t4(n,e,t,r,i){var a=Math.cos(n),o=Math.sin(n);return Qi.al(r*a,i*o,0,-r*o,i*a,0,e,t,1)}function e4(n,e,t,r,i,a,o,s){s===void 0&&(s=!1);var l=2*a/(t-e),c=2*a/(r-i),u=(t+e)/(t-e),h=(r+i)/(r-i),f,d;return s?(f=-o/(o-a),d=-o*a/(o-a)):(f=-(o+a)/(o-a),d=-2*o*a/(o-a)),n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=u,n[9]=h,n[10]=f,n[11]=-1,n[12]=0,n[13]=0,n[14]=d,n[15]=0,n}function JE(n){var e=n[0],t=n[1],r=n[3],i=n[4],a=Math.sqrt(e*e+t*t),o=Math.sqrt(r*r+i*i),s=e*i-t*r;s<0&&(e<i?a=-a:o=-o),a&&(e*=1/a,t*=1/a),o&&(r*=1/o,i*=1/o);var l=Math.atan2(t,e),c=Fi(l);return[n[6],n[7],a,o,c]}var ha=Q(),qi=Q(),yc=on(),Zt=[T.Ue(),T.Ue(),T.Ue()],QE=T.Ue();function n4(n,e,t,r,i,a){if(!r4(ha,n)||(kt(qi,ha),qi[3]=0,qi[7]=0,qi[11]=0,qi[15]=1,Math.abs(Pe(qi))<1e-8))return!1;var o=ha[3],s=ha[7],l=ha[11],c=ha[12],u=ha[13],h=ha[14],f=ha[15];if(o!==0||s!==0||l!==0){yc[0]=o,yc[1]=s,yc[2]=l,yc[3]=f;var d=Wt(qi,qi);if(!d)return!1;Te(qi,qi),fn(i,yc,qi)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=c,e[1]=u,e[2]=h,i4(Zt,ha),t[0]=T.kE(Zt[0]),T.Fv(Zt[0],Zt[0]),r[0]=T.AK(Zt[0],Zt[1]),v0(Zt[1],Zt[1],Zt[0],1,-r[0]),t[1]=T.kE(Zt[1]),T.Fv(Zt[1],Zt[1]),r[0]/=t[1],r[1]=T.AK(Zt[0],Zt[2]),v0(Zt[2],Zt[2],Zt[0],1,-r[1]),r[2]=T.AK(Zt[1],Zt[2]),v0(Zt[2],Zt[2],Zt[1],1,-r[2]),t[2]=T.kE(Zt[2]),T.Fv(Zt[2],Zt[2]),r[1]/=t[2],r[2]/=t[2],T.kC(QE,Zt[1],Zt[2]),T.AK(Zt[0],QE)<0)for(var p=0;p<3;p++)t[p]*=-1,Zt[p][0]*=-1,Zt[p][1]*=-1,Zt[p][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+Zt[0][0]-Zt[1][1]-Zt[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-Zt[0][0]+Zt[1][1]-Zt[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-Zt[0][0]-Zt[1][1]+Zt[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+Zt[0][0]+Zt[1][1]+Zt[2][2],0)),Zt[2][1]>Zt[1][2]&&(a[0]=-a[0]),Zt[0][2]>Zt[2][0]&&(a[1]=-a[1]),Zt[1][0]>Zt[0][1]&&(a[2]=-a[2]),!0}function r4(n,e){var t=e[15];if(t===0)return!1;for(var r=1/t,i=0;i<16;i++)n[i]=e[i]*r;return!0}function i4(n,e){n[0][0]=e[0],n[0][1]=e[1],n[0][2]=e[2],n[1][0]=e[4],n[1][1]=e[5],n[1][2]=e[6],n[2][0]=e[8],n[2][1]=e[9],n[2][2]=e[10]}function v0(n,e,t,r,i){n[0]=e[0]*r+t[0]*i,n[1]=e[1]*r+t[1]*i,n[2]=e[2]*r+t[2]*i}var ur=function(){function n(){this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return n.isEmpty=function(e){return!e||e.halfExtents[0]===0&&e.halfExtents[1]===0&&e.halfExtents[2]===0},n.prototype.update=function(e,t){al(this.center,e),al(this.halfExtents,t),f0(this.min,this.center,this.halfExtents),bf(this.max,this.center,this.halfExtents)},n.prototype.setMinMax=function(e,t){bf(this.center,t,e),qE(this.center,this.center,.5),f0(this.halfExtents,t,e),qE(this.halfExtents,this.halfExtents,.5),al(this.min,e),al(this.max,t)},n.prototype.getMin=function(){return this.min},n.prototype.getMax=function(){return this.max},n.prototype.add=function(e){if(!n.isEmpty(e)){if(n.isEmpty(this)){this.setMinMax(e.getMin(),e.getMax());return}var t=this.center,r=t[0],i=t[1],a=t[2],o=this.halfExtents,s=o[0],l=o[1],c=o[2],u=r-s,h=r+s,f=i-l,d=i+l,p=a-c,v=a+c,g=e.center,m=g[0],x=g[1],_=g[2],S=e.halfExtents,b=S[0],y=S[1],E=S[2],w=m-b,M=m+b,P=x-y,A=x+y,O=_-E,R=_+E;w<u&&(u=w),M>h&&(h=M),P<f&&(f=P),A>d&&(d=A),O<p&&(p=O),R>v&&(v=R),t[0]=(u+h)*.5,t[1]=(f+d)*.5,t[2]=(p+v)*.5,o[0]=(h-u)*.5,o[1]=(d-f)*.5,o[2]=(v-p)*.5,this.min[0]=u,this.min[1]=f,this.min[2]=p,this.max[0]=h,this.max[1]=d,this.max[2]=v}},n.prototype.setFromTransformedAABB=function(e,t){var r=this.center,i=this.halfExtents,a=e.center,o=e.halfExtents,s=t[0],l=t[4],c=t[8],u=t[1],h=t[5],f=t[9],d=t[2],p=t[6],v=t[10],g=Math.abs(s),m=Math.abs(l),x=Math.abs(c),_=Math.abs(u),S=Math.abs(h),b=Math.abs(f),y=Math.abs(d),E=Math.abs(p),w=Math.abs(v);r[0]=t[12]+s*a[0]+l*a[1]+c*a[2],r[1]=t[13]+u*a[0]+h*a[1]+f*a[2],r[2]=t[14]+d*a[0]+p*a[1]+v*a[2],i[0]=g*o[0]+m*o[1]+x*o[2],i[1]=_*o[0]+S*o[1]+b*o[2],i[2]=y*o[0]+E*o[1]+w*o[2],f0(this.min,r,i),bf(this.max,r,i)},n.prototype.intersects=function(e){var t=this.getMax(),r=this.getMin(),i=e.getMax(),a=e.getMin();return r[0]<=i[0]&&t[0]>=a[0]&&r[1]<=i[1]&&t[1]>=a[1]&&r[2]<=i[2]&&t[2]>=a[2]},n.prototype.intersection=function(e){if(!this.intersects(e))return null;var t=new n,r=KB([0,0,0],this.getMin(),e.getMin()),i=ZB([0,0,0],this.getMax(),e.getMax());return t.setMinMax(r,i),t},n.prototype.getNegativeFarPoint=function(e){return e.pnVertexFlag===273?al([0,0,0],this.min):e.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:e.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]},n.prototype.getPositiveFarPoint=function(e){return e.pnVertexFlag===273?al([0,0,0],this.max):e.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:e.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]},n}(),a4=function(){function n(e,t){this.distance=e||0,this.normal=t||T.al(0,1,0),this.updatePNVertexFlag()}return n.prototype.updatePNVertexFlag=function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)},n.prototype.distanceToPoint=function(e){return T.AK(e,this.normal)-this.distance},n.prototype.normalize=function(){var e=1/T.Zh(this.normal);T.bA(this.normal,this.normal,e),this.distance*=e},n.prototype.intersectsLine=function(e,t,r){var i=this.distanceToPoint(e),a=this.distanceToPoint(t),o=i/(i-a),s=o>=0&&o<=1;return s&&r&&T.t7(r,e,t,o),s},n}(),ho;(function(n){n[n.OUTSIDE=4294967295]="OUTSIDE",n[n.INSIDE=0]="INSIDE",n[n.INDETERMINATE=2147483647]="INDETERMINATE"})(ho||(ho={}));var o4=function(){function n(e){if(this.planes=[],e)this.planes=e;else for(var t=0;t<6;t++)this.planes.push(new a4)}return n.prototype.extractFromVPMatrix=function(e){var t=Ht(e,16),r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8],f=t[9],d=t[10],p=t[11],v=t[12],g=t[13],m=t[14],x=t[15];T.t8(this.planes[0].normal,o-r,u-s,p-h),this.planes[0].distance=x-v,T.t8(this.planes[1].normal,o+r,u+s,p+h),this.planes[1].distance=x+v,T.t8(this.planes[2].normal,o+i,u+l,p+f),this.planes[2].distance=x+g,T.t8(this.planes[3].normal,o-i,u-l,p-f),this.planes[3].distance=x-g,T.t8(this.planes[4].normal,o-a,u-c,p-d),this.planes[4].distance=x-m,T.t8(this.planes[5].normal,o+a,u+c,p+d),this.planes[5].distance=x+m,this.planes.forEach(function(_){_.normalize(),_.updatePNVertexFlag()})},n}(),hr=function(){function n(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.copyFrom=function(e){this.x=e.x,this.y=e.y},n}(),fo=function(){function n(e,t,r,i){this.x=e,this.y=t,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=t,this.bottom=t+i}return n.fromRect=function(e){return new n(e.x,e.y,e.width,e.height)},n.applyTransform=function(e,t){var r=va(e.x,e.y,0,1),i=va(e.x+e.width,e.y,0,1),a=va(e.x,e.y+e.height,0,1),o=va(e.x+e.width,e.y+e.height,0,1),s=on(),l=on(),c=on(),u=on();fn(s,r,t),fn(l,i,t),fn(c,a,t),fn(u,o,t);var h=Math.min(s[0],l[0],c[0],u[0]),f=Math.min(s[1],l[1],c[1],u[1]),d=Math.max(s[0],l[0],c[0],u[0]),p=Math.max(s[1],l[1],c[1],u[1]);return n.fromRect({x:h,y:f,width:d-h,height:p-f})},n.prototype.toJSON=function(){},n}(),cn="Method not implemented.",ol="Use document.documentElement instead.",s4="Cannot append a destroyed element.",un;(function(n){n[n.ORBITING=0]="ORBITING",n[n.EXPLORING=1]="EXPLORING",n[n.TRACKING=2]="TRACKING"})(un||(un={}));var xc;(function(n){n[n.DEFAULT=0]="DEFAULT",n[n.ROTATIONAL=1]="ROTATIONAL",n[n.TRANSLATIONAL=2]="TRANSLATIONAL",n[n.CINEMATIC=3]="CINEMATIC"})(xc||(xc={}));var $r;(function(n){n[n.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",n[n.PERSPECTIVE=1]="PERSPECTIVE"})($r||($r={}));var t2={UPDATED:"updated"},e2=2e-4,l4=function(){function n(){this.clipSpaceNearZ=il.NEGATIVE_ONE,this.eventEmitter=new et,this.matrix=Q(),this.right=T.al(1,0,0),this.up=T.al(0,1,0),this.forward=T.al(0,0,1),this.position=T.al(0,0,1),this.focalPoint=T.al(0,0,0),this.distanceVector=T.al(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=Q(),this.projectionMatrixInverse=Q(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=un.EXPLORING,this.trackingMode=xc.DEFAULT,this.projectionMode=$r.PERSPECTIVE,this.frustum=new o4,this.orthoMatrix=Q()}return n.prototype.isOrtho=function(){return this.projectionMode===$r.ORTHOGRAPHIC},n.prototype.getProjectionMode=function(){return this.projectionMode},n.prototype.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},n.prototype.getPerspectiveInverse=function(){return this.projectionMatrixInverse},n.prototype.getFrustum=function(){return this.frustum},n.prototype.getPosition=function(){return this.position},n.prototype.getFocalPoint=function(){return this.focalPoint},n.prototype.getDollyingStep=function(){return this.dollyingStep},n.prototype.getNear=function(){return this.near},n.prototype.getFar=function(){return this.far},n.prototype.getZoom=function(){return this.zoom},n.prototype.getOrthoMatrix=function(){return this.orthoMatrix},n.prototype.getView=function(){return this.view},n.prototype.setEnableUpdate=function(e){this.enableUpdate=e},n.prototype.setType=function(e,t){return this.type=e,this.type===un.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===un.TRACKING&&t!==void 0&&this.setTrackingMode(t),this},n.prototype.setProjectionMode=function(e){return this.projectionMode=e,this},n.prototype.setTrackingMode=function(e){if(this.type!==un.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=e,this},n.prototype.setWorldRotation=function(e){return this.rotateWorld=e,this._getAngles(),this},n.prototype.getViewTransform=function(){return Wt(Q(),this.matrix)},n.prototype.getWorldTransform=function(){return this.matrix},n.prototype.jitterProjectionMatrix=function(e,t){var r=ce(Q(),[e,t,0]);this.jitteredProjectionMatrix=Ut(Q(),r,this.projectionMatrix)},n.prototype.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},n.prototype.setMatrix=function(e){return this.matrix=e,this._update(),this},n.prototype.setProjectionMatrix=function(e){this.projectionMatrix=e},n.prototype.setFov=function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this},n.prototype.setAspect=function(e){return this.setPerspective(this.near,this.far,this.fov,e),this},n.prototype.setNear=function(e){return this.projectionMode===$r.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this},n.prototype.setFar=function(e){return this.projectionMode===$r.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this},n.prototype.setViewOffset=function(e,t,r,i,a,o){return this.aspect=e/t,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.projectionMode===$r.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},n.prototype.clearViewOffset=function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===$r.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},n.prototype.setZoom=function(e){return this.zoom=e,this.projectionMode===$r.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===$r.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},n.prototype.setZoomByViewportPoint=function(e,t){var r=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),i=r.x,a=r.y,o=this.roll;this.rotate(0,0,-o),this.setPosition(i,a),this.setFocalPoint(i,a),this.setZoom(e),this.rotate(0,0,o);var s=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),l=s.x,c=s.y,u=T.al(l-i,c-a,0),h=T.AK(u,this.right)/T.kE(this.right),f=T.AK(u,this.up)/T.kE(this.up),d=Ht(this.getPosition(),2),p=d[0],v=d[1],g=Ht(this.getFocalPoint(),2),m=g[0],x=g[1];return this.setPosition(p-h,v-f),this.setFocalPoint(m-h,x-f),this},n.prototype.setPerspective=function(e,t,r,i){var a;this.projectionMode=$r.PERSPECTIVE,this.fov=r,this.near=e,this.far=t,this.aspect=i;var o=this.near*Math.tan(qe(.5*this.fov))/this.zoom,s=2*o,l=this.aspect*s,c=-.5*l;if(!((a=this.view)===null||a===void 0)&&a.enabled){var u=this.view.fullWidth,h=this.view.fullHeight;c+=this.view.offsetX*l/u,o-=this.view.offsetY*s/h,l*=this.view.width/u,s*=this.view.height/h}return e4(this.projectionMatrix,c,c+l,o-s,o,e,this.far,this.clipSpaceNearZ===il.ZERO),Wt(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},n.prototype.setOrthographic=function(e,t,r,i,a,o){var s;this.projectionMode=$r.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=r,this.bottom=i,this.near=a,this.far=o;var l=(this.rright-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,h=(this.top+this.bottom)/2,f=u-l,d=u+l,p=h+c,v=h-c;if(!((s=this.view)===null||s===void 0)&&s.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;f+=g*this.view.offsetX,d=f+g*this.view.width,p-=m*this.view.offsetY,v=p-m*this.view.height}return this.clipSpaceNearZ===il.NEGATIVE_ONE?Uc(this.projectionMatrix,f,d,p,v,a,o):Vc(this.projectionMatrix,f,d,p,v,a,o),Wt(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},n.prototype.setPosition=function(e,t,r){t===void 0&&(t=this.position[1]),r===void 0&&(r=this.position[2]);var i=jr(e,t,r);return this._setPosition(i),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},n.prototype.setFocalPoint=function(e,t,r){t===void 0&&(t=this.focalPoint[1]),r===void 0&&(r=this.focalPoint[2]);var i=T.al(0,1,0);if(this.focalPoint=jr(e,t,r),this.trackingMode===xc.CINEMATIC){var a=T.$X(T.Ue(),this.focalPoint,this.position);e=a[0],t=a[1],r=a[2];var o=T.kE(a),s=Fi(Math.asin(t/o)),l=90+Fi(Math.atan2(r,e)),c=Q();vr(c,c,qe(l)),Ar(c,c,qe(s)),i=T.fF(T.Ue(),[0,1,0],c)}return Wt(this.matrix,Hc(Q(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},n.prototype.getDistance=function(){return this.distance},n.prototype.getDistanceVector=function(){return this.distanceVector},n.prototype.setDistance=function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<e2&&(this.distance=e2),this.dollyingStep=this.distance/100;var t=T.Ue();e=this.distance;var r=this.forward,i=this.focalPoint;return t[0]=e*r[0]+i[0],t[1]=e*r[1]+i[1],t[2]=e*r[2]+i[2],this._setPosition(t),this.triggerUpdate(),this},n.prototype.setMaxDistance=function(e){return this.maxDistance=e,this},n.prototype.setMinDistance=function(e){return this.minDistance=e,this},n.prototype.setAzimuth=function(e){return this.azimuth=d0(e),this.computeMatrix(),this._getAxes(),this.type===un.ORBITING||this.type===un.EXPLORING?this._getPosition():this.type===un.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getAzimuth=function(){return this.azimuth},n.prototype.setElevation=function(e){return this.elevation=d0(e),this.computeMatrix(),this._getAxes(),this.type===un.ORBITING||this.type===un.EXPLORING?this._getPosition():this.type===un.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getElevation=function(){return this.elevation},n.prototype.setRoll=function(e){return this.roll=d0(e),this.computeMatrix(),this._getAxes(),this.type===un.ORBITING||this.type===un.EXPLORING?this._getPosition():this.type===un.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},n.prototype.getRoll=function(){return this.roll},n.prototype._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},n.prototype.computeMatrix=function(){var e=Bn(Vt(),[0,0,1],qe(this.roll));Xt(this.matrix);var t=Bn(Vt(),[1,0,0],qe((this.rotateWorld&&this.type!==un.TRACKING||this.type===un.TRACKING?1:-1)*this.elevation)),r=Bn(Vt(),[0,1,0],qe((this.rotateWorld&&this.type!==un.TRACKING||this.type===un.TRACKING?1:-1)*this.azimuth)),i=Ln(Vt(),r,t);i=Ln(Vt(),i,e);var a=Fa(Q(),i);this.type===un.ORBITING||this.type===un.EXPLORING?(Ee(this.matrix,this.matrix,this.focalPoint),Ut(this.matrix,this.matrix,a),Ee(this.matrix,this.matrix,[0,0,this.distance])):this.type===un.TRACKING&&(Ee(this.matrix,this.matrix,this.position),Ut(this.matrix,this.matrix,a))},n.prototype._setPosition=function(e,t,r){this.position=jr(e,t,r);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()},n.prototype._getAxes=function(){T.JG(this.right,jr(fn(on(),[1,0,0,0],this.matrix))),T.JG(this.up,jr(fn(on(),[0,1,0,0],this.matrix))),T.JG(this.forward,jr(fn(on(),[0,0,1,0],this.matrix))),T.Fv(this.right,this.right),T.Fv(this.up,this.up),T.Fv(this.forward,this.forward)},n.prototype._getAngles=function(){var e=this.distanceVector[0],t=this.distanceVector[1],r=this.distanceVector[2],i=T.kE(this.distanceVector);if(i===0){this.elevation=0,this.azimuth=0;return}this.type===un.TRACKING?(this.elevation=Fi(Math.asin(t/i)),this.azimuth=Fi(Math.atan2(-e,-r))):this.rotateWorld?(this.elevation=Fi(Math.asin(t/i)),this.azimuth=Fi(Math.atan2(-e,-r))):(this.elevation=-Fi(Math.asin(t/i)),this.azimuth=-Fi(Math.atan2(-e,-r)))},n.prototype._getPosition=function(){T.JG(this.position,jr(fn(on(),[0,0,0,1],this.matrix))),this._getDistance()},n.prototype._getFocalPoint=function(){T.kK(this.distanceVector,[0,0,-this.distance],Qi.xO(Qi.Ue(),this.matrix)),T.IH(this.focalPoint,this.position,this.distanceVector),this._getDistance()},n.prototype._getDistance=function(){this.distanceVector=T.$X(T.Ue(),this.focalPoint,this.position),this.distance=T.kE(this.distanceVector),this.dollyingStep=this.distance/100},n.prototype._getOrthoMatrix=function(){if(this.projectionMode===$r.ORTHOGRAPHIC){var e=this.position,t=Bn(Vt(),[0,0,1],-this.roll*Math.PI/180);mr(this.orthoMatrix,t,T.al((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),T.al(this.zoom,this.zoom,1),e)}},n.prototype.triggerUpdate=function(){if(this.enableUpdate){var e=this.getViewTransform(),t=Ut(Q(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(t),this.eventEmitter.emit(t2.UPDATED)}},n.prototype.rotate=function(e,t,r){throw new Error(cn)},n.prototype.pan=function(e,t){throw new Error(cn)},n.prototype.dolly=function(e){throw new Error(cn)},n.prototype.createLandmark=function(e,t){throw new Error(cn)},n.prototype.gotoLandmark=function(e,t){throw new Error(cn)},n.prototype.cancelLandmarkAnimation=function(){throw new Error(cn)},n}();function Jn(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError("Expected a function");var t=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=e?e.apply(this,r):r[0],o=t.cache;if(o.has(a))return o.get(a);var s=n.apply(this,r);return t.cache=o.set(a,s)||o,s};return t.cache=new(Jn.Cache||Map),t}Jn.Cache=Map;var bt;(function(n){n[n.kUnknown=0]="kUnknown",n[n.kNumber=1]="kNumber",n[n.kPercentage=2]="kPercentage",n[n.kEms=3]="kEms",n[n.kPixels=4]="kPixels",n[n.kRems=5]="kRems",n[n.kDegrees=6]="kDegrees",n[n.kRadians=7]="kRadians",n[n.kGradians=8]="kGradians",n[n.kTurns=9]="kTurns",n[n.kMilliseconds=10]="kMilliseconds",n[n.kSeconds=11]="kSeconds",n[n.kInteger=12]="kInteger"})(bt||(bt={}));var di;(function(n){n[n.kUNumber=0]="kUNumber",n[n.kUPercent=1]="kUPercent",n[n.kULength=2]="kULength",n[n.kUAngle=3]="kUAngle",n[n.kUTime=4]="kUTime",n[n.kUOther=5]="kUOther"})(di||(di={}));var n2;(function(n){n[n.kAll=0]="kAll",n[n.kNonNegative=1]="kNonNegative",n[n.kInteger=2]="kInteger",n[n.kNonNegativeInteger=3]="kNonNegativeInteger",n[n.kPositiveInteger=4]="kPositiveInteger"})(n2||(n2={}));var g0;(function(n){n[n.kYes=0]="kYes",n[n.kNo=1]="kNo"})(g0||(g0={}));var m0;(function(n){n[n.kYes=0]="kYes",n[n.kNo=1]="kNo"})(m0||(m0={}));var c4=[{name:"em",unit_type:bt.kEms},{name:"px",unit_type:bt.kPixels},{name:"deg",unit_type:bt.kDegrees},{name:"rad",unit_type:bt.kRadians},{name:"grad",unit_type:bt.kGradians},{name:"ms",unit_type:bt.kMilliseconds},{name:"s",unit_type:bt.kSeconds},{name:"rem",unit_type:bt.kRems},{name:"turn",unit_type:bt.kTurns}],po;(function(n){n[n.kUnknownType=0]="kUnknownType",n[n.kUnparsedType=1]="kUnparsedType",n[n.kKeywordType=2]="kKeywordType",n[n.kUnitType=3]="kUnitType",n[n.kSumType=4]="kSumType",n[n.kProductType=5]="kProductType",n[n.kNegateType=6]="kNegateType",n[n.kInvertType=7]="kInvertType",n[n.kMinType=8]="kMinType",n[n.kMaxType=9]="kMaxType",n[n.kClampType=10]="kClampType",n[n.kTransformType=11]="kTransformType",n[n.kPositionType=12]="kPositionType",n[n.kURLImageType=13]="kURLImageType",n[n.kColorType=14]="kColorType",n[n.kUnsupportedColorType=15]="kUnsupportedColorType"})(po||(po={}));var u4=function(n){return c4.find(function(e){return e.name===n}).unit_type},h4=function(n){return n?n==="number"?bt.kNumber:n==="percent"||n==="%"?bt.kPercentage:u4(n):bt.kUnknown},f4=function(n){switch(n){case bt.kNumber:case bt.kInteger:return di.kUNumber;case bt.kPercentage:return di.kUPercent;case bt.kPixels:return di.kULength;case bt.kMilliseconds:case bt.kSeconds:return di.kUTime;case bt.kDegrees:case bt.kRadians:case bt.kGradians:case bt.kTurns:return di.kUAngle;default:return di.kUOther}},d4=function(n){switch(n){case di.kUNumber:return bt.kNumber;case di.kULength:return bt.kPixels;case di.kUPercent:return bt.kPercentage;case di.kUTime:return bt.kSeconds;case di.kUAngle:return bt.kDegrees;default:return bt.kUnknown}},r2=function(n){var e=1;switch(n){case bt.kPixels:case bt.kDegrees:case bt.kSeconds:break;case bt.kMilliseconds:e=.001;break;case bt.kRadians:e=180/Math.PI;break;case bt.kGradians:e=.9;break;case bt.kTurns:e=360;break}return e},y0=function(n){switch(n){case bt.kNumber:case bt.kInteger:return"";case bt.kPercentage:return"%";case bt.kEms:return"em";case bt.kRems:return"rem";case bt.kPixels:return"px";case bt.kDegrees:return"deg";case bt.kRadians:return"rad";case bt.kGradians:return"grad";case bt.kMilliseconds:return"ms";case bt.kSeconds:return"s";case bt.kTurns:return"turn"}return""},Ef=function(){function n(){}return n.isAngle=function(e){return e===bt.kDegrees||e===bt.kRadians||e===bt.kGradians||e===bt.kTurns},n.isLength=function(e){return e>=bt.kEms&&e<bt.kDegrees},n.isRelativeUnit=function(e){return e===bt.kPercentage||e===bt.kEms||e===bt.kRems},n.isTime=function(e){return e===bt.kSeconds||e===bt.kMilliseconds},n.prototype.toString=function(){return this.buildCSSText(g0.kNo,m0.kNo,"")},n.prototype.isNumericValue=function(){return this.getType()>=po.kUnitType&&this.getType()<=po.kClampType},n}(),p4=function(n){Me(e,n);function e(t){var r=n.call(this)||this;return r.colorSpace=t,r}return e.prototype.getType=function(){return po.kColorType},e.prototype.to=function(t){return this},e}(Ef),sl;(function(n){n[n.Constant=0]="Constant",n[n.LinearGradient=1]="LinearGradient",n[n.RadialGradient=2]="RadialGradient"})(sl||(sl={}));var wf=function(n){Me(e,n);function e(t,r){var i=n.call(this)||this;return i.type=t,i.value=r,i}return e.prototype.clone=function(){return new e(this.type,this.value)},e.prototype.buildCSSText=function(t,r,i){return i},e.prototype.getType=function(){return po.kColorType},e}(Ef),Kr=function(n){Me(e,n);function e(t){var r=n.call(this)||this;return r.value=t,r}return e.prototype.clone=function(){return new e(this.value)},e.prototype.getType=function(){return po.kKeywordType},e.prototype.buildCSSText=function(t,r,i){return i+this.value},e}(Ef),v4=Jn(function(n){return n===void 0&&(n=""),n.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()})}),i2=function(n){return n.split("").map(function(e,t){return e.toUpperCase()===e?"".concat(t!==0?"-":"").concat(e.toLowerCase()):e}).join("")};function g4(n){if(!n)throw new Error}function ll(n){return typeof n=="function"}function m4(n){return typeof n=="symbol"}var vV=function(n){return Object.fromEntries(Object.entries(n).filter(function(e){var t=__read(e,2),r=t[1];return r!==void 0}))},y4={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign"},src:{alias:"img"}},x0=Jn(function(n){var e=v4(n),t=y4[e];return e=(t==null?void 0:t.alias)||e,e}),x4=function(n,e){e===void 0&&(e="");var t="";return Number.isFinite(n)?(g4(Number.isNaN(n)),t="NaN"):n>0?t="infinity":t="-infinity",t+=e},b0=function(n){return d4(f4(n))},De=function(n){Me(e,n);function e(t,r){r===void 0&&(r=bt.kNumber);var i=n.call(this)||this,a;return typeof r=="string"?a=h4(r):a=r,i.unit=a,i.value=t,i}return e.prototype.clone=function(){return new e(this.value,this.unit)},e.prototype.equals=function(t){var r=t;return this.value===r.value&&this.unit===r.unit},e.prototype.getType=function(){return po.kUnitType},e.prototype.convertTo=function(t){if(this.unit===t)return new e(this.value,this.unit);var r=b0(this.unit);if(r!==b0(t)||r===bt.kUnknown)return null;var i=r2(this.unit)/r2(t);return new e(this.value*i,t)},e.prototype.buildCSSText=function(t,r,i){var a;switch(this.unit){case bt.kUnknown:break;case bt.kInteger:a=Number(this.value).toFixed(0);break;case bt.kNumber:case bt.kPercentage:case bt.kEms:case bt.kRems:case bt.kPixels:case bt.kDegrees:case bt.kRadians:case bt.kGradians:case bt.kMilliseconds:case bt.kSeconds:case bt.kTurns:{var o=-999999,s=999999,l=this.value,c=y0(this.unit);if(l<o||l>s){var u=y0(this.unit);!Number.isFinite(l)||Number.isNaN(l)?a=x4(l,u):a=l+(u||"")}else a="".concat(l).concat(c)}}return i+=a,i},e}(Ef),Pn=new De(0,"px");new De(1,"px");var Gi=new De(0,"deg"),E0=function(n){Me(e,n);function e(t,r,i,a,o){a===void 0&&(a=1),o===void 0&&(o=!1);var s=n.call(this,"rgb")||this;return s.r=t,s.g=r,s.b=i,s.alpha=a,s.isNone=o,s}return e.prototype.clone=function(){return new e(this.r,this.g,this.b,this.alpha)},e.prototype.buildCSSText=function(t,r,i){return i+"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")},e}(p4),Je=new Kr("unset"),b4=new Kr("initial"),E4=new Kr("inherit"),w0={"":Je,unset:Je,initial:b4,inherit:E4},_0=function(n){return w0[n]||(w0[n]=new Kr(n)),w0[n]},_f=new E0(0,0,0,0,!0),a2=new E0(0,0,0,0),w4=Jn(function(n,e,t,r){return new E0(n,e,t,r)},function(n,e,t,r){return"rgba(".concat(n,",").concat(e,",").concat(t,",").concat(r,")")}),Ue=function(n,e){return e===void 0&&(e=bt.kNumber),new De(n,e)};new De(50,"%");var S0;(function(n){n[n.Standard=0]="Standard"})(S0||(S0={}));var cl;(function(n){n[n.ADDED=0]="ADDED",n[n.REMOVED=1]="REMOVED",n[n.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED"})(cl||(cl={}));var o2={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new fo(0,0,0,0)},_t;(function(n){n.COORDINATE="<coordinate>",n.COLOR="<color>",n.PAINT="<paint>",n.NUMBER="<number>",n.ANGLE="<angle>",n.OPACITY_VALUE="<opacity-value>",n.SHADOW_BLUR="<shadow-blur>",n.LENGTH="<length>",n.PERCENTAGE="<percentage>",n.LENGTH_PERCENTAGE="<length> | <percentage>",n.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",n.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",n.LIST_OF_POINTS="<list-of-points>",n.PATH="<path>",n.FILTER="<filter>",n.Z_INDEX="<z-index>",n.OFFSET_DISTANCE="<offset-distance>",n.DEFINED_PATH="<defined-path>",n.MARKER="<marker>",n.TRANSFORM="<transform>",n.TRANSFORM_ORIGIN="<transform-origin>",n.TEXT="<text>",n.TEXT_TRANSFORM="<text-transform>"})(_t||(_t={}));function _4(n){var e=n.type,t=n.value;return e==="hex"?"#".concat(t):e==="literal"?t:e==="rgb"?"rgb(".concat(t.join(","),")"):"rgba(".concat(t.join(","),")")}var S4=function(){var n={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},e="";function t(I){throw new Error(e+": "+I)}function r(){var I=i();return e.length>0&&t("Invalid input not EOF"),I}function i(){return _(a)}function a(){return o("linear-gradient",n.linearGradient,l)||o("repeating-linear-gradient",n.repeatingLinearGradient,l)||o("radial-gradient",n.radialGradient,h)||o("repeating-radial-gradient",n.repeatingRadialGradient,h)||o("conic-gradient",n.conicGradient,h)}function o(I,Z,J){return s(Z,function(mt){var It=J();return It&&(z(n.comma)||t("Missing comma before color stops")),{type:I,orientation:It,colorStops:_(S)}})}function s(I,Z){var J=z(I);if(J){z(n.startCall)||t("Missing (");var mt=Z(J);return z(n.endCall)||t("Missing )"),mt}}function l(){return c()||u()}function c(){return L("directional",n.sideOrCorner,1)}function u(){return L("angular",n.angleValue,1)}function h(){var I,Z=f(),J;return Z&&(I=[],I.push(Z),J=e,z(n.comma)&&(Z=f(),Z?I.push(Z):e=J)),I}function f(){var I=d()||p();if(I)I.at=g();else{var Z=v();if(Z){I=Z;var J=g();J&&(I.at=J)}else{var mt=m();mt&&(I={type:"default-radial",at:mt})}}return I}function d(){var I=L("shape",/^(circle)/i,0);return I&&(I.style=R()||v()),I}function p(){var I=L("shape",/^(ellipse)/i,0);return I&&(I.style=A()||v()),I}function v(){return L("extent-keyword",n.extentKeywords,1)}function g(){if(L("position",/^at/,0)){var I=m();return I||t("Missing positioning value"),I}}function m(){var I=x();if(I.x||I.y)return{type:"position",value:I}}function x(){return{x:A(),y:A()}}function _(I){var Z=I(),J=[];if(Z)for(J.push(Z);z(n.comma);)Z=I(),Z?J.push(Z):t("One extra comma");return J}function S(){var I=b();return I||t("Expected color definition"),I.length=A(),I}function b(){return E()||M()||w()||y()}function y(){return L("literal",n.literalColor,0)}function E(){return L("hex",n.hexColor,1)}function w(){return s(n.rgbColor,function(){return{type:"rgb",value:_(P)}})}function M(){return s(n.rgbaColor,function(){return{type:"rgba",value:_(P)}})}function P(){return z(n.number)[1]}function A(){return L("%",n.percentageValue,1)||O()||R()}function O(){return L("position-keyword",n.positionKeywords,1)}function R(){return L("px",n.pixelValue,1)||L("em",n.emValue,1)}function L(I,Z,J){var mt=z(Z);if(mt)return{type:I,value:mt[J]}}function z(I){var Z=/^[\n\r\t\s]+/.exec(e);Z&&Y(Z[0].length);var J=I.exec(e);return J&&Y(J[0].length),J}function Y(I){e=e.substring(I)}return function(I){return e=I,r()}}();function gV(n,e,t,r){var i=qe(r.value),a=0,o=0,s=a+e/2,l=o+t/2,c=Math.abs(e*Math.cos(i))+Math.abs(t*Math.sin(i)),u=n[0]+s-Math.cos(i)*c/2,h=n[1]+l-Math.sin(i)*c/2,f=n[0]+s+Math.cos(i)*c/2,d=n[1]+l+Math.sin(i)*c/2;return{x1:u,y1:h,x2:f,y2:d}}function mV(n,e,t,r,i,a){var o=r.value,s=i.value;r.unit===bt.kPercentage&&(o=r.value/100*e),i.unit===bt.kPercentage&&(s=i.value/100*t);var l=Math.max(distanceSquareRoot([0,0],[o,s]),distanceSquareRoot([0,t],[o,s]),distanceSquareRoot([e,t],[o,s]),distanceSquareRoot([e,0],[o,s]));return a&&(a instanceof De?l=a.value:a instanceof Kr&&(a.value==="closest-side"?l=Math.min(o,e-o,s,t-s):a.value==="farthest-side"?l=Math.max(o,e-o,s,t-s):a.value==="closest-corner"&&(l=Math.min(distanceSquareRoot([0,0],[o,s]),distanceSquareRoot([0,t],[o,s]),distanceSquareRoot([e,t],[o,s]),distanceSquareRoot([e,0],[o,s]))))),{x:o+n[0],y:s+n[1],r:l}}var T4=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,P4=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,M4=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,s2=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function C4(n){var e,t,r,i=n.length;n[i-1].length=(e=n[i-1].length)!==null&&e!==void 0?e:{type:"%",value:"100"},i>1&&(n[0].length=(t=n[0].length)!==null&&t!==void 0?t:{type:"%",value:"0"});for(var a=0,o=Number(n[0].length.value),s=1;s<i;s++){var l=(r=n[s].length)===null||r===void 0?void 0:r.value;if(!sn(l)&&!sn(o)){for(var c=1;c<s-a;c++)n[a+c].length={type:"%",value:"".concat(o+(Number(l)-o)*c/(s-a))};a=s,o=Number(l)}}}var A4={left:270-90,top:0-90,bottom:180-90,right:90-90,"left top":315-90,"top left":315-90,"left bottom":225-90,"bottom left":225-90,"right top":45-90,"top right":45-90,"right bottom":135-90,"bottom right":135-90},O4=Jn(function(n){var e;return n.type==="angular"?e=Number(n.value):e=A4[n.value]||0,Ue(e,"deg")}),N4=Jn(function(n){var e=50,t=50,r="%",i="%";if((n==null?void 0:n.type)==="position"){var a=n.value,o=a.x,s=a.y;(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?e=0:o.value==="center"?e=50:o.value==="right"?e=100:o.value==="top"?t=0:o.value==="bottom"&&(t=100)),(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?e=0:s.value==="center"?t=50:s.value==="right"?e=100:s.value==="top"?t=0:s.value==="bottom"&&(t=100)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(r=o==null?void 0:o.type,e=Number(o.value)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(i=s==null?void 0:s.type,t=Number(s.value))}return{cx:Ue(e,r),cy:Ue(t,i)}}),R4=Jn(function(n){var e;if(n.indexOf("linear")>-1||n.indexOf("radial")>-1){var t=S4(n);return t.map(function(s){var l=s.type,c=s.orientation,u=s.colorStops;C4(u);var h=u.map(function(_){return{offset:Ue(Number(_.length.value),"%"),color:_4(_)}});if(l==="linear-gradient")return new wf(sl.LinearGradient,{angle:c?O4(c):Gi,steps:h});if(l==="radial-gradient"&&(c||(c=[{type:"shape",value:"circle"}]),c[0].type==="shape"&&c[0].value==="circle")){var f=N4(c[0].at),d=f.cx,p=f.cy,v=void 0;if(c[0].style){var g=c[0].style,m=g.type,x=g.value;m==="extent-keyword"?v=_0(x):v=Ue(x,m)}return new wf(sl.RadialGradient,{cx:d,cy:p,size:v,steps:h})}})}var r=n[0];if(n[1]==="("||n[2]==="("){if(r==="l"){var i=T4.exec(n);if(i){var a=((e=i[2].match(s2))===null||e===void 0?void 0:e.map(function(s){return s.split(":")}))||[];return[new wf(sl.LinearGradient,{angle:Ue(parseFloat(i[1]),"deg"),steps:a.map(function(s){var l=Ht(s,2),c=l[0],u=l[1];return{offset:Ue(Number(c)*100,"%"),color:u}})})]}}else if(r==="r"){var o=k4(n);if(o)if(ua(o))n=o;else return[new wf(sl.RadialGradient,o)]}else if(r==="p")return L4(n)}});function k4(n){var e,t=P4.exec(n);if(t){var r=((e=t[4].match(s2))===null||e===void 0?void 0:e.map(function(i){return i.split(":")}))||[];return{cx:Ue(50,"%"),cy:Ue(50,"%"),steps:r.map(function(i){var a=Ht(i,2),o=a[0],s=a[1];return{offset:Ue(Number(o)*100,"%"),color:s}})}}return null}function L4(n){var e=M4.exec(n);if(e){var t=e[1],r=e[2];switch(t){case"a":t="repeat";break;case"x":t="repeat-x";break;case"y":t="repeat-y";break;case"n":t="no-repeat";break;default:t="no-repeat"}return{image:r,repetition:t}}return null}function yV(n){return!!n.type&&!!n.value}function T0(n){return n&&!!n.image}function Sf(n){return n&&!sn(n.r)&&!sn(n.g)&&!sn(n.b)}var ul=Jn(function(n){if(T0(n))return te({repetition:"repeat"},n);if(sn(n)&&(n=""),n==="transparent")return a2;if(n==="currentColor")n="black";else if(n==="none")return _f;var e=R4(n);if(e)return e;var t=md.ZP(n),r=[0,0,0,0];return t!==null&&(r[0]=t.r||0,r[1]=t.g||0,r[2]=t.b||0,r[3]=t.opacity),w4.apply(void 0,Xe([],Ht(r),!1))});function I4(n,e){if(!(!Sf(n)||!Sf(e)))return[[Number(n.r),Number(n.g),Number(n.b),Number(n.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var r=t.slice();if(r[3])for(var i=0;i<3;i++)r[i]=Math.round(vf(r[i],0,255));return r[3]=vf(r[3],0,1),"rgba(".concat(r.join(","),")")}]}function bc(n,e){if(sn(e))return Ue(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(n)>=0)return Ue(Number(e),"px");if("deg".search(n)>=0)return Ue(Number(e),"deg")}var t=[];e=e.replace(n,function(i){return t.push(i),"U"+i});var r="U("+n.source+")";return t.map(function(i){return Ue(Number(e.replace(new RegExp("U"+i,"g"),"").replace(new RegExp(r,"g"),"*0")),i)})[0]}var l2=function(n){return bc(new RegExp("px","g"),n)},D4=Jn(l2),B4=function(n){return bc(new RegExp("%","g"),n)};Jn(B4);var Ec=function(n){return Ia(n)||isFinite(Number(n))?Ue(Number(n)||0,"px"):bc(new RegExp("px|%|em|rem","g"),n)},hl=Jn(Ec),P0=function(n){return bc(new RegExp("deg|rad|grad|turn","g"),n)},c2=Jn(P0);function F4(n,e,t,r,i){i===void 0&&(i=0);var a="",o=n.value||0,s=e.value||0,l=b0(n.unit),c=n.convertTo(l),u=e.convertTo(l);return c&&u?(o=c.value,s=u.value,a=y0(n.unit)):(De.isLength(n.unit)||De.isLength(e.unit))&&(o=pi(n,i,t),s=pi(e,i,t),a="px"),[o,s,function(h){return r&&(h=Math.max(h,0)),h+a}]}function Zr(n){var e=0;return n.unit===bt.kDegrees?e=n.value:n.unit===bt.kRadians?e=Fi(Number(n.value)):n.unit===bt.kTurns&&(e=qB(Number(n.value))),e}function u2(n,e){var t;return Array.isArray(n)?t=n.map(function(r){return Number(r)}):ua(n)?t=n.split(" ").map(function(r){return Number(r)}):Ia(n)&&(t=[n]),e===2?t.length===1?[t[0],t[0]]:[t[0],t[1]]:t.length===1?[t[0],t[0],t[0],t[0]]:t.length===2?[t[0],t[1],t[0],t[1]]:t.length===3?[t[0],t[1],t[2],t[1]]:[t[0],t[1],t[2],t[3]]}function h2(n){return ua(n)?n.split(" ").map(function(e){return hl(e)}):n.map(function(e){return hl(e.toString())})}function pi(n,e,t,r){if(r===void 0&&(r=!1),n.unit===bt.kPixels)return Number(n.value);if(n.unit===bt.kPercentage&&t){var i=t.nodeName===At.GROUP?t.getLocalBounds():t.getGeometryBounds();return(r?i.min[e]:0)+n.value/100*i.halfExtents[e]*2}return 0}var G4=function(n){return bc(/deg|rad|grad|turn|px|%/g,n)},z4=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function f2(n){if(n===void 0&&(n=""),n=n.toLowerCase().trim(),n==="none")return[];for(var e=/\s*([\w-]+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];if(i=r.index+r[0].length,z4.indexOf(r[1])>-1&&t.push({name:r[1],params:r[2].split(" ").map(function(a){return G4(a)||ul(a)})}),e.lastIndex===n.length)return t}return[]}function d2(n){return n.toString()}var fl=function(n){return typeof n=="number"?Ue(n):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(n)?Ue(Number(n)):Ue(0)},qo=Jn(fl);Jn(function(n){return ua(n)?n.split(" ").map(qo):n.map(qo)});function M0(n,e){return[n,e,d2]}function C0(n,e){return function(t,r){return[t,r,function(i){return d2(vf(i,n,e))}]}}function p2(n,e){if(n.length===e.length)return[n,e,function(t){return t}]}function v2(n){return n.parsedStyle.d.totalLength===0&&(n.parsedStyle.d.totalLength=CB(n.parsedStyle.d.absolutePath)),n.parsedStyle.d.totalLength}function W4(n){return n.parsedStyle.points.totalLength===0&&(n.parsedStyle.points.totalLength=Td(n.parsedStyle.points.points)),n.parsedStyle.points.totalLength}function U4(n){for(var e=0;e<n.length;e++){var t=n[e-1],r=n[e],i=r[0];if(i==="M"&&t){var a=t[0],o=[r[1],r[2]],s=void 0;a==="L"||a==="M"?s=[t[1],t[2]]:(a==="C"||a==="A"||a==="Q")&&(s=[t[t.length-2],t[t.length-1]]),s&&Tf(o,s)&&(n.splice(e,1),e--)}}}function V4(n){for(var e=!1,t=n.length,r=0;r<t;r++){var i=n[r],a=i[0];if(a==="C"||a==="A"||a==="Q"){e=!0;break}}return e}function H4(n){for(var e=[],t=[],r=[],i=0;i<n.length;i++){var a=n[i],o=a[0];o==="M"?(r.length&&(t.push(r),r=[]),r.push([a[1],a[2]])):o==="Z"?r.length&&(e.push(r),r=[]):r.push([a[1],a[2]])}return r.length>0&&t.push(r),{polygons:e,polylines:t}}function Tf(n,e){return n[0]===e[0]&&n[1]===e[1]}function Y4(n,e){for(var t=[],r=[],i=[],a=0;a<n.length;a++){var o=n[a],s=o.currentPoint,l=o.params,c=o.prePoint,u=void 0;switch(o.command){case"Q":u=Md(c[0],c[1],l[1],l[2],l[3],l[4]);break;case"C":u=Sd(c[0],c[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var h=o.arcParams;u=wd(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:t.push(s[0]),r.push(s[1]);break}u&&(o.box=u,t.push(u.x,u.x+u.width),r.push(u.y,u.y+u.height)),e&&(o.command==="L"||o.command==="M")&&o.prePoint&&o.nextPoint&&i.push(o)}t=t.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0}),r=r.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0});var f=WE(t),d=WE(r),p=UE(t),v=UE(r);if(i.length===0)return{x:f,y:d,width:p-f,height:v-d};for(var a=0;a<i.length;a++){var o=i[a],s=o.currentPoint,g=void 0;s[0]===f?(g=Pf(o,e),f=f-g.xExtra):s[0]===p&&(g=Pf(o,e),p=p+g.xExtra),s[1]===d?(g=Pf(o,e),d=d-g.yExtra):s[1]===v&&(g=Pf(o,e),v=v+g.yExtra)}return{x:f,y:d,width:p-f,height:v-d}}function Pf(n,e){var t=n.prePoint,r=n.currentPoint,i=n.nextPoint,a=Math.pow(r[0]-t[0],2)+Math.pow(r[1]-t[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.pow(t[0]-i[0],2)+Math.pow(t[1]-i[1],2),l=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!l||Math.sin(l)===0||OB(l,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));c=c>Math.PI/2?Math.PI-c:c,u=u>Math.PI/2?Math.PI-u:u;var h={xExtra:Math.cos(l/2-c)*(e/2*(1/Math.sin(l/2)))-e/2||0,yExtra:Math.cos(u-l/2)*(e/2*(1/Math.sin(l/2)))-e/2||0};return h}function g2(n,e){return[e[0]+(e[0]-n[0]),e[1]+(e[1]-n[1])]}var m2=function(n,e){var t=n.x*e.x+n.y*e.y,r=Math.sqrt((Math.pow(n.x,2)+Math.pow(n.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2))),i=n.x*e.y-n.y*e.x<0?-1:1,a=i*Math.acos(t/r);return a},y2=function(n,e,t,r,i,a,o,s){e=Math.abs(e),t=Math.abs(t),r=VE(r,360);var l=qe(r);if(n.x===o.x&&n.y===o.y)return{x:n.x,y:n.y,ellipticalArcAngle:0};if(e===0||t===0)return{x:0,y:0,ellipticalArcAngle:0};var c=(n.x-o.x)/2,u=(n.y-o.y)/2,h={x:Math.cos(l)*c+Math.sin(l)*u,y:-Math.sin(l)*c+Math.cos(l)*u},f=Math.pow(h.x,2)/Math.pow(e,2)+Math.pow(h.y,2)/Math.pow(t,2);f>1&&(e=Math.sqrt(f)*e,t=Math.sqrt(f)*t);var d=Math.pow(e,2)*Math.pow(t,2)-Math.pow(e,2)*Math.pow(h.y,2)-Math.pow(t,2)*Math.pow(h.x,2),p=Math.pow(e,2)*Math.pow(h.y,2)+Math.pow(t,2)*Math.pow(h.x,2),v=d/p;v=v<0?0:v;var g=(i!==a?1:-1)*Math.sqrt(v),m={x:g*(e*h.y/t),y:g*(-(t*h.x)/e)},x={x:Math.cos(l)*m.x-Math.sin(l)*m.y+(n.x+o.x)/2,y:Math.sin(l)*m.x+Math.cos(l)*m.y+(n.y+o.y)/2},_={x:(h.x-m.x)/e,y:(h.y-m.y)/t},S=m2({x:1,y:0},_),b={x:(-h.x-m.x)/e,y:(-h.y-m.y)/t},y=m2(_,b);!a&&y>0?y-=2*Math.PI:a&&y<0&&(y+=2*Math.PI),y%=2*Math.PI;var E=S+y*s,w=e*Math.cos(E),M=t*Math.sin(E),P={x:Math.cos(l)*w-Math.sin(l)*M+x.x,y:Math.sin(l)*w+Math.cos(l)*M+x.y,ellipticalArcStartAngle:S,ellipticalArcEndAngle:S+y,ellipticalArcAngle:E,ellipticalArcCenter:x,resultantRx:e,resultantRy:t};return P};function X4(n){for(var e=[],t=null,r=null,i=null,a=0,o=n.length,s=0;s<o;s++){var l=n[s];r=n[s+1];var c=l[0],u={command:c,prePoint:t,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(c){case"M":i=[l[1],l[2]],a=s;break;case"A":var h=j4(t,l);u.arcParams=h;break}if(c==="Z")t=i,r=n[a+1];else{var f=l.length;t=[l[f-2],l[f-1]]}r&&r[0]==="Z"&&(r=n[a],e[a]&&(e[a].prePoint=t)),u.currentPoint=t,e[a]&&Tf(t,e[a].currentPoint)&&(e[a].prePoint=u.prePoint);var d=r?[r[r.length-2],r[r.length-1]]:null;u.nextPoint=d;var p=u.prePoint;if(["L","H","V"].includes(c))u.startTangent=[p[0]-t[0],p[1]-t[1]],u.endTangent=[t[0]-p[0],t[1]-p[1]];else if(c==="Q"){var v=[l[1],l[2]];u.startTangent=[p[0]-v[0],p[1]-v[1]],u.endTangent=[t[0]-v[0],t[1]-v[1]]}else if(c==="T"){var g=e[s-1],v=g2(g.currentPoint,p);g.command==="Q"?(u.command="Q",u.startTangent=[p[0]-v[0],p[1]-v[1]],u.endTangent=[t[0]-v[0],t[1]-v[1]]):(u.command="TL",u.startTangent=[p[0]-t[0],p[1]-t[1]],u.endTangent=[t[0]-p[0],t[1]-p[1]])}else if(c==="C"){var m=[l[1],l[2]],x=[l[3],l[4]];u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]],u.startTangent[0]===0&&u.startTangent[1]===0&&(u.startTangent=[m[0]-x[0],m[1]-x[1]]),u.endTangent[0]===0&&u.endTangent[1]===0&&(u.endTangent=[x[0]-m[0],x[1]-m[1]])}else if(c==="S"){var g=e[s-1],m=g2(g.currentPoint,p),x=[l[1],l[2]];g.command==="C"?(u.command="C",u.startTangent=[p[0]-m[0],p[1]-m[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]]):(u.command="SQ",u.startTangent=[p[0]-x[0],p[1]-x[1]],u.endTangent=[t[0]-x[0],t[1]-x[1]])}else if(c==="A"){var _=x2(u,0),S=_.x,b=_.y,y=x2(u,1,!1),E=y.x,w=y.y;u.startTangent=[S,b],u.endTangent=[E,w]}e.push(u)}return e}function x2(n,e,t){t===void 0&&(t=!0);var r=n.arcParams,i=r.rx,a=i===void 0?0:i,o=r.ry,s=o===void 0?0:o,l=r.xRotation,c=r.arcFlag,u=r.sweepFlag,h=y2({x:n.prePoint[0],y:n.prePoint[1]},a,s,l,!!c,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},e),f=y2({x:n.prePoint[0],y:n.prePoint[1]},a,s,l,!!c,!!u,{x:n.currentPoint[0],y:n.currentPoint[1]},t?e+.005:e-.005),d=f.x-h.x,p=f.y-h.y,v=Math.sqrt(d*d+p*p);return{x:-d/v,y:-p/v}}function Mf(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function A0(n,e){return Mf(n)*Mf(e)?(n[0]*e[0]+n[1]*e[1])/(Mf(n)*Mf(e)):1}function b2(n,e){return(n[0]*e[1]<n[1]*e[0]?-1:1)*Math.acos(A0(n,e))}function j4(n,e){var t=e[1],r=e[2],i=VE(qe(e[3]),Math.PI*2),a=e[4],o=e[5],s=n[0],l=n[1],c=e[6],u=e[7],h=Math.cos(i)*(s-c)/2+Math.sin(i)*(l-u)/2,f=-1*Math.sin(i)*(s-c)/2+Math.cos(i)*(l-u)/2,d=h*h/(t*t)+f*f/(r*r);d>1&&(t*=Math.sqrt(d),r*=Math.sqrt(d));var p=t*t*(f*f)+r*r*(h*h),v=p?Math.sqrt((t*t*(r*r)-p)/p):1;a===o&&(v*=-1),isNaN(v)&&(v=0);var g=r?v*t*f/r:0,m=t?v*-r*h/t:0,x=(s+c)/2+Math.cos(i)*g-Math.sin(i)*m,_=(l+u)/2+Math.sin(i)*g+Math.cos(i)*m,S=[(h-g)/t,(f-m)/r],b=[(-1*h-g)/t,(-1*f-m)/r],y=b2([1,0],S),E=b2(S,b);return A0(S,b)<=-1&&(E=Math.PI),A0(S,b)>=1&&(E=0),o===0&&E>0&&(E=E-2*Math.PI),o===1&&E<0&&(E=E+2*Math.PI),{cx:x,cy:_,rx:Tf(n,[c,u])?0:t,ry:Tf(n,[c,u])?0:r,startAngle:y,endAngle:y+E,xRotation:i,arcFlag:a,sweepFlag:o}}function $4(n,e,t){return n.reduce(function(r,i){var a="";if(i[0]==="M"||i[0]==="L"){var o=vec3.fromValues(i[1],i[2],0);t&&vec3.transformMat4(o,o,t),a="".concat(i[0]).concat(o[0],",").concat(o[1])}else if(i[0]==="Z")a=i[0];else if(i[0]==="C"){var s=vec3.fromValues(i[1],i[2],0),l=vec3.fromValues(i[3],i[4],0),c=vec3.fromValues(i[5],i[6],0);t&&(vec3.transformMat4(s,s,t),vec3.transformMat4(l,l,t),vec3.transformMat4(c,c,t)),a="".concat(i[0]).concat(s[0],",").concat(s[1],",").concat(l[0],",").concat(l[1],",").concat(c[0],",").concat(c[1])}else if(i[0]==="A"){var u=vec3.fromValues(i[6],i[7],0);t&&vec3.transformMat4(u,u,t),a="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],",").concat(i[5],",").concat(u[0],",").concat(u[1])}else if(i[0]==="Q"){var s=vec3.fromValues(i[1],i[2],0),l=vec3.fromValues(i[3],i[4],0);t&&(vec3.transformMat4(s,s,t),vec3.transformMat4(l,l,t)),a="".concat(i[0]).concat(i[1],",").concat(i[2],",").concat(i[3],",").concat(i[4],"}")}return r+=a},"")}function K4(n,e,t,r){return[["M",n,e],["L",t,r]]}function E2(n,e,t,r){var i=(-1+Math.sqrt(2))/3*4,a=n*i,o=e*i,s=t-n,l=t+n,c=r-e,u=r+e;return[["M",s,r],["C",s,r-o,t-a,c,t,c],["C",t+a,c,l,r-o,l,r],["C",l,r+o,t+a,u,t,u],["C",t-a,u,s,r+o,s,r],["Z"]]}function Z4(n,e){var t=n.map(function(r,i){return[i===0?"M":"L",r[0],r[1]]});return e&&t.push(["Z"]),t}function q4(n,e,t,r,i){if(i){var a=__read(i,4),o=a[0],s=a[1],l=a[2],c=a[3],u=n>0?1:-1,h=e>0?1:-1,f=u+h!==0?1:0;return[["M",u*o+t,r],["L",n-u*s+t,r],s?["A",s,s,0,0,f,n+t,h*s+r]:null,["L",n+t,e-h*l+r],l?["A",l,l,0,0,f,n+t-u*l,e+r]:null,["L",t+u*c,e+r],c?["A",c,c,0,0,f,t,e+r-h*c]:null,["L",t,h*o+r],o?["A",o,o,0,0,f,u*o+t,r]:null,["Z"]].filter(function(d){return d})}return[["M",t,r],["L",t+n,r],["L",t+n,r+e],["L",t,r+e],["Z"]]}function xV(n,e){e===void 0&&(e=n.getLocalTransform());var t=[];switch(n.nodeName){case At.LINE:var r=n.parsedStyle,i=r.x1,a=i===void 0?0:i,o=r.y1,s=o===void 0?0:o,l=r.x2,c=l===void 0?0:l,u=r.y2,h=u===void 0?0:u;t=K4(a,s,c,h);break;case At.CIRCLE:{var f=n.parsedStyle,d=f.r,p=d===void 0?0:d,v=f.cx,g=v===void 0?0:v,m=f.cy,x=m===void 0?0:m;t=E2(p,p,g,x);break}case At.ELLIPSE:{var _=n.parsedStyle,S=_.rx,b=S===void 0?0:S,y=_.ry,E=y===void 0?0:y,w=_.cx,g=w===void 0?0:w,M=_.cy,x=M===void 0?0:M;t=E2(b,E,g,x);break}case At.POLYLINE:case At.POLYGON:var P=n.parsedStyle.points;t=Z4(P.points,n.nodeName===At.POLYGON);break;case At.RECT:var A=n.parsedStyle,O=A.width,R=O===void 0?0:O,L=A.height,z=L===void 0?0:L,Y=A.x,I=Y===void 0?0:Y,Z=A.y,J=Z===void 0?0:Z,mt=A.radius,It=mt&&mt.some(function(ve){return ve!==0});t=q4(R,z,I,J,It&&mt.map(function(ve){return clamp(ve,0,Math.min(Math.abs(R)/2,Math.abs(z)/2))}));break;case At.PATH:var ae=n.parsedStyle.d.absolutePath;t=__spreadArray([],__read(ae),!1);break}if(t.length)return $4(t,n,e)}function bV(n,e,t,r,i){e===void 0&&(e=0),t===void 0&&(t=0),r===void 0&&(r=0),i===void 0&&(i=0);var a=n.map(function(o,s){var l=o[0],c=n[s+1],u=s===0&&(e!==0||t!==0),h=(s===n.length-1||c&&(c[0]==="M"||c[0]==="Z"))&&r!==0&&i!==0;switch(l){case"M":return u?"M ".concat(o[1]+e,",").concat(o[2]+t," L ").concat(o[1],",").concat(o[2]):"M ".concat(o[1],",").concat(o[2]);case"L":return"L ".concat(o[1]+(h?r:0),",").concat(o[2]+(h?i:0));case"Q":return"Q ".concat(o[1]," ").concat(o[2],",").concat(o[3]," ").concat(o[4])+(h?" L ".concat(o[3]+r,",").concat(o[4]+i):"");case"C":return"C ".concat(o[1]," ").concat(o[2],",").concat(o[3]," ").concat(o[4],",").concat(o[5]," ").concat(o[6])+(h?" L ".concat(o[5]+r,",").concat(o[6]+i):"");case"A":return"A ".concat(o[1]," ").concat(o[2]," ").concat(o[3]," ").concat(o[4]," ").concat(o[5]," ").concat(o[6]," ").concat(o[7])+(h?" L ".concat(o[6]+r,",").concat(o[7]+i):"");case"Z":return"Z"}}).join(" ");return~a.indexOf("NaN")?"":a}var w2=function(n){if(n===""||Array.isArray(n)&&n.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=mf(n)}catch(f){e=mf(""),console.error("[g]: Invalid SVG Path definition: ".concat(n))}U4(e);var t=V4(e),r=H4(e),i=r.polygons,a=r.polylines,o=X4(e),s=Y4(o,0),l=s.x,c=s.y,u=s.width,h=s.height;return{absolutePath:e,hasArc:t,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(u)?u:0,height:Number.isFinite(h)?h:0}}},J4=Jn(w2);function O0(n){return ua(n)?J4(n):w2(n)}function Q4(n,e,t){var r=n.curve,i=e.curve;(!r||r.length===0)&&(r=h0(n.absolutePath,!1),n.curve=r),(!i||i.length===0)&&(i=h0(e.absolutePath,!1),e.curve=i);var a=[r,i];r.length!==i.length&&(a=jE(r,i));var o=$E(a[0])!==$E(a[1])?GB(a[0]):zB(a[0]);return[o,UB(a[1],o),function(s){return s}]}function _2(n,e){var t;return ua(n)?t=n.split(" ").map(function(r){var i=Ht(r.split(","),2),a=i[0],o=i[1];return[Number(a),Number(o)]}):t=n,{points:t,totalLength:0,segments:[]}}function tF(n,e){return[n.points,e.points,function(t){return t}]}var yn=null;function qr(n){return function(e){var t=0;return n.map(function(r){return r===yn?e[t++]:r})}}function Jo(n){return n}var Cf={matrix:["NNNNNN",[yn,yn,0,0,yn,yn,0,0,0,0,1,0,yn,yn,0,1],Jo],matrix3d:["NNNNNNNNNNNNNNNN",Jo],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",qr([yn,yn,new De(1)]),Jo],scalex:["N",qr([yn,new De(1),new De(1)]),qr([yn,new De(1)])],scaley:["N",qr([new De(1),yn,new De(1)]),qr([new De(1),yn])],scalez:["N",qr([new De(1),new De(1),yn])],scale3d:["NNN",Jo],skew:["Aa",null,Jo],skewx:["A",null,qr([yn,Gi])],skewy:["A",null,qr([Gi,yn])],translate:["Tt",qr([yn,yn,Pn]),Jo],translatex:["T",qr([yn,Pn,Pn]),qr([yn,Pn])],translatey:["T",qr([Pn,yn,Pn]),qr([Pn,yn])],translatez:["L",qr([Pn,Pn,yn])],translate3d:["TTL",Jo]};function S2(n){if(n=(n||"none").toLowerCase().trim(),n==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];i=r.index+r[0].length;var a=r[1],o=Cf[a];if(!o)return[];var s=r[2].split(","),l=o[0];if(l.length<s.length)return[];for(var c=[],u=0;u<l.length;u++){var h=s[u],f=l[u],d=void 0;if(h?d={A:function(p){return p.trim()==="0"?Gi:c2(p)},N:qo,T:hl,L:D4}[f.toUpperCase()](h):d={a:Gi,n:c[0],t:Pn}[f],d===void 0)return[];c.push(d)}if(t.push({t:a,d:c}),e.lastIndex===n.length)return t}return[]}function T2(n){if(n=(n||"none").toLowerCase().trim(),n==="none")return[];for(var e=/\s*(\w+)\(([^)]*)\)/g,t=[],r,i=0;r=e.exec(n);){if(r.index!==i)return[];i=r.index+r[0].length;var a=r[1],o=Cf[a];if(!o)return[];var s=r[2].split(","),l=o[0];if(l.length<s.length)return[];for(var c=[],u=0;u<l.length;u++){var h=s[u],f=l[u],d=void 0;if(h?d={A:function(p){return p.trim()==="0"?Gi:P0(p)},N:fl,T:Ec,L:l2}[f.toUpperCase()](h):d={a:Gi,n:c[0],t:Pn}[f],d===void 0)return[];c.push(d)}if(t.push({t:a,d:c}),e.lastIndex===n.length)return t}return[]}function eF(n){var e,t,r,i;switch(n.t){case"rotatex":return i=qe(Zr(n.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotatey":return i=qe(Zr(n.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotatez":return i=qe(Zr(n.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=n.d[0].value,t=n.d[1].value,r=n.d[2].value,i=qe(Zr(n.d[3]));var a=e*e+t*t+r*r;if(a===0)e=1,t=0,r=0;else if(a!==1){var o=Math.sqrt(a);e/=o,t/=o,r/=o}var s=Math.sin(i/2),l=s*Math.cos(i/2),c=s*s;return[1-2*(t*t+r*r)*c,2*(e*t*c+r*l),2*(e*r*c-t*l),0,2*(e*t*c-r*l),1-2*(e*e+r*r)*c,2*(t*r*c+e*l),0,2*(e*r*c+t*l),2*(t*r*c-e*l),1-2*(e*e+t*t)*c,0,0,0,0,1];case"scale":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scalex":return[n.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,n.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,n.d[0].value,0,0,0,0,1];case"scale3d":return[n.d[0].value,0,0,0,0,n.d[1].value,0,0,0,0,n.d[2].value,0,0,0,0,1];case"skew":var u=qe(Zr(n.d[0])),h=qe(Zr(n.d[1]));return[1,Math.tan(h),0,0,Math.tan(u),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return i=qe(Zr(n.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return i=qe(Zr(n.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return e=pi(n.d[0],0,null)||0,t=pi(n.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1];case"translatex":return e=pi(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,0,0,1];case"translatey":return t=pi(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,t,0,1];case"translatez":return r=pi(n.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r,1];case"translate3d":return e=pi(n.d[0],0,null)||0,t=pi(n.d[1],0,null)||0,r=pi(n.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,e,t,r,1];case"perspective":var f=pi(n.d[0],0,null)||0,d=f?-1/f:0;return[1,0,0,0,0,1,0,0,0,0,1,d,0,0,0,1];case"matrix":return[n.d[0].value,n.d[1].value,0,0,n.d[2].value,n.d[3].value,0,0,0,0,1,0,n.d[4].value,n.d[5].value,0,1];case"matrix3d":return n.d.map(function(p){return p.value})}}function nF(n,e){return[n[0]*e[0]+n[4]*e[1]+n[8]*e[2]+n[12]*e[3],n[1]*e[0]+n[5]*e[1]+n[9]*e[2]+n[13]*e[3],n[2]*e[0]+n[6]*e[1]+n[10]*e[2]+n[14]*e[3],n[3]*e[0]+n[7]*e[1]+n[11]*e[2]+n[15]*e[3],n[0]*e[4]+n[4]*e[5]+n[8]*e[6]+n[12]*e[7],n[1]*e[4]+n[5]*e[5]+n[9]*e[6]+n[13]*e[7],n[2]*e[4]+n[6]*e[5]+n[10]*e[6]+n[14]*e[7],n[3]*e[4]+n[7]*e[5]+n[11]*e[6]+n[15]*e[7],n[0]*e[8]+n[4]*e[9]+n[8]*e[10]+n[12]*e[11],n[1]*e[8]+n[5]*e[9]+n[9]*e[10]+n[13]*e[11],n[2]*e[8]+n[6]*e[9]+n[10]*e[10]+n[14]*e[11],n[3]*e[8]+n[7]*e[9]+n[11]*e[10]+n[15]*e[11],n[0]*e[12]+n[4]*e[13]+n[8]*e[14]+n[12]*e[15],n[1]*e[12]+n[5]*e[13]+n[9]*e[14]+n[13]*e[15],n[2]*e[12]+n[6]*e[13]+n[10]*e[14]+n[14]*e[15],n[3]*e[12]+n[7]*e[13]+n[11]*e[14]+n[15]*e[15]]}function rF(n){return n.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:n.map(eF).reduce(nF)}function P2(n){var e=[0,0,0],t=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return n4(rF(n),e,t,r,i,a),[[e,t,r,a,i]]}var iF=function(){function n(r,i){for(var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],o=0;o<4;o++)for(var s=0;s<4;s++)for(var l=0;l<4;l++)a[o][s]+=i[o][l]*r[l][s];return a}function e(r){return r[0][2]==0&&r[0][3]==0&&r[1][2]==0&&r[1][3]==0&&r[2][0]==0&&r[2][1]==0&&r[2][2]==1&&r[2][3]==0&&r[3][2]==0&&r[3][3]==1}function t(r,i,a,o,s){for(var l=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],c=0;c<4;c++)l[c][3]=s[c];for(var c=0;c<3;c++)for(var u=0;u<3;u++)l[3][c]+=r[u]*l[u][c];var h=o[0],f=o[1],d=o[2],p=o[3],v=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];v[0][0]=1-2*(f*f+d*d),v[0][1]=2*(h*f-d*p),v[0][2]=2*(h*d+f*p),v[1][0]=2*(h*f+d*p),v[1][1]=1-2*(h*h+d*d),v[1][2]=2*(f*d-h*p),v[2][0]=2*(h*d-f*p),v[2][1]=2*(f*d+h*p),v[2][2]=1-2*(h*h+f*f),l=n(l,v);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[2]&&(g[2][1]=a[2],l=n(l,g)),a[1]&&(g[2][1]=0,g[2][0]=a[0],l=n(l,g)),a[0]&&(g[2][0]=0,g[1][0]=a[0],l=n(l,g));for(var c=0;c<3;c++)for(var u=0;u<3;u++)l[c][u]*=i[c];return e(l)?[l[0][0],l[0][1],l[1][0],l[1][1],l[3][0],l[3][1]]:l[0].concat(l[1],l[2],l[3])}return t}();function aF(n){return n.toFixed(6).replace(".000000","")}function N0(n,e){var t,r;return n.decompositionPair!==e&&(n.decompositionPair=e,t=P2(n)),e.decompositionPair!==n&&(e.decompositionPair=n,r=P2(e)),t[0]===null||r[0]===null?[[!1],[!0],function(i){return i?e[0].d:n[0].d}]:(t[0].push(0),r[0].push(1),[t,r,function(i){var a=sF(t[0][3],r[0][3],i[5]),o=iF(i[0],i[1],i[2],a,i[4]),s=o.map(aF).join(",");return s}])}function oF(n,e){for(var t=0,r=0;r<n.length;r++)t+=n[r]*e[r];return t}function sF(n,e,t){var r=oF(n,e);r=vf(r,-1,1);var i=[];if(r===1)i=n;else for(var a=Math.acos(r),o=Math.sin(t*a)*1/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(n[s]*(Math.cos(t*a)-r*o)+e[s]*o);return i}function R0(n){return n.replace(/[xy]/,"")}function k0(n){return n.replace(/(x|y|z|3d)?$/,"3d")}var lF=function(n,e){return n==="perspective"&&e==="perspective"||(n==="matrix"||n==="matrix3d")&&(e==="matrix"||e==="matrix3d")};function cF(n,e,t){var r=!1;if(!n.length||!e.length){n.length||(r=!0,n=e,e=[]);for(var i=function(y){var E=n[y],w=E.t,M=E.d,P=w.substring(0,5)==="scale"?1:0;e.push({t:w,d:M.map(function(A){return typeof A=="number"?Ue(P):Ue(P,A.unit)})})},a=0;a<n.length;a++)i(a)}var o=[],s=[],l=[];if(n.length!==e.length){var c=N0(n,e);o=[c[0]],s=[c[1]],l=[["matrix",[c[2]]]]}else for(var a=0;a<n.length;a++){var u=n[a].t,h=e[a].t,f=n[a].d,d=e[a].d,p=Cf[u],v=Cf[h],g=void 0;if(lF(u,h)){var c=N0([n[a]],[e[a]]);o.push(c[0]),s.push(c[1]),l.push(["matrix",[c[2]]]);continue}else if(u===h)g=u;else if(p[2]&&v[2]&&R0(u)===R0(h))g=R0(u),f=p[2](f),d=v[2](d);else if(p[1]&&v[1]&&k0(u)===k0(h))g=k0(u),f=p[1](f),d=v[1](d);else{var c=N0(n,e);o=[c[0]],s=[c[1]],l=[["matrix",[c[2]]]];break}for(var m=[],x=[],_=[],S=0;S<f.length;S++){var c=F4(f[S],d[S],t,!1,S);m[S]=c[0],x[S]=c[1],_.push(c[2])}o.push(m),s.push(x),l.push([g,_])}if(r){var b=o;o=s,s=b}return[o,s,function(y){return y.map(function(E,w){var M=E.map(function(P,A){return l[w][1][A](P)}).join(",");return l[w][0]==="matrix"&&M.split(",").length===16&&(l[w][0]="matrix3d"),l[w][0]==="matrix3d"&&M.split(",").length===6&&(l[w][0]="matrix"),l[w][0]+"("+M+")"}).join(" ")}]}var M2=Jn(function(n){if(ua(n)){if(n==="text-anchor")return[Ue(0,"px"),Ue(0,"px")];var e=n.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[hl(Af(e[0])),hl(Af(e[1]))]}else return[Ue(n[0]||0,"px"),Ue(n[1]||0,"px")]}),uF=function(n){if(ua(n)){if(n==="text-anchor")return[Ue(0,"px"),Ue(0,"px")];var e=n.split(" ");return e.length===1&&(e[0]==="top"||e[0]==="bottom"?(e[1]=e[0],e[0]="center"):e[1]="center"),e.length!==2?null:[Ec(Af(e[0])),Ec(Af(e[1]))]}else return[Ue(n[0]||0,"px"),Ue(n[1]||0,"px")]};function Af(n){return n==="center"?"50%":n==="left"||n==="top"?"0%":n==="right"||n==="bottom"?"100%":n}var L0=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:_t.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:_t.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:_t.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:_t.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:_t.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:_t.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:_t.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:_t.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:_t.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:_t.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:_t.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:_t.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:_t.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:_t.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:_t.FILTER},{n:"clipPath",syntax:_t.DEFINED_PATH},{n:"textPath",syntax:_t.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:_t.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:_t.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:_t.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:_t.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:_t.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:_t.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:_t.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:_t.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:_t.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:_t.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:_t.COORDINATE},{n:"y1",int:!0,l:!0,syntax:_t.COORDINATE},{n:"z1",int:!0,l:!0,syntax:_t.COORDINATE},{n:"x2",int:!0,l:!0,syntax:_t.COORDINATE},{n:"y2",int:!0,l:!0,syntax:_t.COORDINATE},{n:"z2",int:!0,l:!0,syntax:_t.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:_t.PATH,p:50},{n:"points",int:!0,l:!0,syntax:_t.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:_t.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:_t.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:_t.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:_t.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:_t.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:_t.NUMBER,d:function(n){return n===At.PATH||n===At.POLYGON||n===At.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:_t.MARKER},{n:"markerEnd",syntax:_t.MARKER},{n:"markerMid",syntax:_t.MARKER},{n:"markerStartOffset",syntax:_t.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:_t.LENGTH,l:!0,int:!0,d:"0"}],C2=L0.filter(function(n){return!!n.l}).map(function(n){return n.n}),Qo={},dl=new WeakMap,hF=function(n,e){var t=dl.get(n);return!t||t.length===0?!0:t.includes(e)},fF=function(){function n(e){var t=this;this.runtime=e,L0.forEach(function(r){t.registerMetadata(r)})}return n.prototype.registerMetadata=function(e){Xe([e.n],Ht(e.a||[]),!1).forEach(function(t){Qo[t]=e})},n.prototype.unregisterMetadata=function(e){delete Qo[e]},n.prototype.getPropertySyntax=function(e){return this.runtime.CSSPropertySyntaxFactory[e]},n.prototype.processProperties=function(e,t,r){var i=this;if(r===void 0&&(r={skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0}),this.runtime.enableCSSParsing){var u=r.skipUpdateAttribute,h=r.skipParse,f=r.forceUpdateGeometry,d=r.usedAttributes,p=r.memoize,v=f,g=Object.keys(t);g.forEach(function(m){var x;u||(e.attributes[m]=t[m]),!v&&(!((x=Qo[m])===null||x===void 0)&&x.l)&&(v=!0)}),h||g.forEach(function(m){e.computedStyle[m]=i.parseProperty(m,e.attributes[m],e,p)}),d!=null&&d.length&&(g=Array.from(new Set(g.concat(d)))),g.forEach(function(m){m in e.computedStyle&&(e.parsedStyle[m]=i.computeProperty(m,e.computedStyle[m],e,p))}),v&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e)),g.forEach(function(m){m in e.parsedStyle&&i.postProcessProperty(m,e,g)}),this.runtime.enableCSSParsing&&e.children.length&&g.forEach(function(m){m in e.parsedStyle&&i.isPropertyInheritable(m)&&e.children.forEach(function(x){x.internalSetAttribute(m,null,{skipUpdateAttribute:!0,skipParse:!0})})})}else{Object.assign(e.attributes,t);var a=Object.keys(t),o=e.parsedStyle.clipPath,s=e.parsedStyle.offsetPath;e.parsedStyle=Object.assign(e.parsedStyle,t);var l=!!r.forceUpdateGeometry;if(!l){for(var c=0;c<C2.length;c++)if(C2[c]in t){l=!0;break}}t.fill&&(e.parsedStyle.fill=ul(t.fill)),t.stroke&&(e.parsedStyle.stroke=ul(t.stroke)),t.shadowColor&&(e.parsedStyle.shadowColor=ul(t.shadowColor)),t.filter&&(e.parsedStyle.filter=f2(t.filter)),sn(t.radius)||(e.parsedStyle.radius=u2(t.radius,4)),sn(t.lineDash)||(e.parsedStyle.lineDash=u2(t.lineDash,2)),t.points&&(e.parsedStyle.points=_2(t.points)),t.d===""&&(e.parsedStyle.d=te({},o2)),t.d&&(e.parsedStyle.d=O0(t.d)),t.textTransform&&this.runtime.CSSPropertySyntaxFactory["<text-transform>"].calculator(null,null,{value:t.textTransform},e,null),ln(t.clipPath)||this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("clipPath",o,t.clipPath,e,this.runtime),t.offsetPath&&this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("offsetPath",s,t.offsetPath,e,this.runtime),t.transform&&(e.parsedStyle.transform=S2(t.transform)),t.transformOrigin&&(e.parsedStyle.transformOrigin=M2(t.transformOrigin)),t.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,t.markerStart,t.markerStart,null,null)),t.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,t.markerEnd,t.markerEnd,null,null)),t.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator("",t.markerMid,t.markerMid,null,null)),sn(t.zIndex)||this.runtime.CSSPropertySyntaxFactory["<z-index>"].postProcessor(e,a),sn(t.offsetDistance)||this.runtime.CSSPropertySyntaxFactory["<offset-distance>"].postProcessor(e,a),t.transform&&this.runtime.CSSPropertySyntaxFactory["<transform>"].postProcessor(e,a),t.transformOrigin&&this.runtime.CSSPropertySyntaxFactory["<transform-origin>"].postProcessor(e,a),l&&(e.geometry.dirty=!0,e.renderable.boundsDirty=!0,e.renderable.renderBoundsDirty=!0,r.forceUpdateGeometry||this.runtime.sceneGraphService.dirtifyToRoot(e))}},n.prototype.parseProperty=function(e,t,r,i){var a=Qo[e],o=t;if((t===""||sn(t))&&(t="unset"),t==="unset"||t==="initial"||t==="inherit")o=_0(t);else if(a){var s=a.k,l=a.syntax,c=l&&this.getPropertySyntax(l);s&&s.indexOf(t)>-1?o=_0(t):c&&(!i&&c.parserUnmemoize?o=c.parserUnmemoize(t,r):c.parser&&(o=c.parser(t,r)))}return o},n.prototype.computeProperty=function(e,t,r,i){var a=Qo[e],o=r.id==="g-root",s=t;if(a){var l=a.syntax,c=a.inh,u=a.d;if(t instanceof Kr){var h=t.value;if(h==="unset"&&(c&&!o?h="inherit":h="initial"),h==="initial")sn(u)||(t=this.parseProperty(e,ll(u)?u(r.nodeName):u,r,i));else if(h==="inherit"){var f=this.tryToResolveProperty(r,e,{inherited:!0});if(sn(f)){this.addUnresolveProperty(r,e);return}else return f}}var d=l&&this.getPropertySyntax(l);if(d&&d.calculator){var p=r.parsedStyle[e];s=d.calculator(e,p,t,r,this.runtime)}else t instanceof Kr?s=t.value:s=t}return s},n.prototype.postProcessProperty=function(e,t,r){var i=Qo[e];if(i&&i.syntax){var a=i.syntax&&this.getPropertySyntax(i.syntax),o=a;o&&o.postProcessor&&o.postProcessor(t,r)}},n.prototype.addUnresolveProperty=function(e,t){var r=dl.get(e);r||(dl.set(e,[]),r=dl.get(e)),r.indexOf(t)===-1&&r.push(t)},n.prototype.tryToResolveProperty=function(e,t,r){r===void 0&&(r={});var i=r.inherited;if(i&&e.parentElement&&hF(e.parentElement,t)){var a=e.parentElement.parsedStyle[t];return a==="unset"||a==="initial"||a==="inherit"?void 0:a}},n.prototype.recalc=function(e){var t=dl.get(e);if(t&&t.length){var r={};t.forEach(function(i){r[i]=e.attributes[i]}),this.processProperties(e,r),dl.delete(e)}},n.prototype.updateGeometry=function(e){var t=e.nodeName,r=this.runtime.geometryUpdaterFactory[t];if(r){var i=e.geometry;i.contentBounds||(i.contentBounds=new ur),i.renderBounds||(i.renderBounds=new ur);var a=e.parsedStyle,o=r.update(a,e),s=o.cx,l=s===void 0?0:s,c=o.cy,u=c===void 0?0:c,h=o.cz,f=h===void 0?0:h,d=o.hwidth,p=d===void 0?0:d,v=o.hheight,g=v===void 0?0:v,m=o.hdepth,x=m===void 0?0:m,_=[Math.abs(p),Math.abs(g),x],S=a,b=S.stroke,y=S.lineWidth,E=y===void 0?1:y,w=S.increasedLineWidthForHitTesting,M=w===void 0?0:w,P=S.shadowType,A=P===void 0?"outer":P,O=S.shadowColor,R=S.filter,L=R===void 0?[]:R,z=S.transformOrigin,Y=[l,u,f];i.contentBounds.update(Y,_);var I=t===At.POLYLINE||t===At.POLYGON||t===At.PATH?Math.SQRT2:.5,Z=b&&!b.isNone;if(Z){var J=((E||0)+(M||0))*I;_[0]+=J,_[1]+=J}if(i.renderBounds.update(Y,_),O&&A&&A!=="inner"){var mt=i.renderBounds,It=mt.min,ae=mt.max,ve=a,Hn=ve.shadowBlur,rr=ve.shadowOffsetX,rn=ve.shadowOffsetY,He=Hn||0,hn=rr||0,dr=rn||0,an=It[0]-He+hn,pr=ae[0]+He+hn,bo=It[1]-He+dr,Rc=ae[1]+He+dr;It[0]=Math.min(It[0],an),ae[0]=Math.max(ae[0],pr),It[1]=Math.min(It[1],bo),ae[1]=Math.max(ae[1],Rc),i.renderBounds.setMinMax(It,ae)}L.forEach(function(_o){var So=_o.name,Jr=_o.params;if(So==="blur"){var To=Jr[0].value;i.renderBounds.update(i.renderBounds.center,bf(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[To,To,0]))}else if(So==="drop-shadow"){var Po=Jr[0].value,Mo=Jr[1].value,Qr=Jr[2].value,Co=i.renderBounds,xn=Co.min,bn=Co.max,Ic=xn[0]-Qr+Po,Dc=bn[0]+Qr+Po,Bc=xn[1]-Qr+Mo,Fc=bn[1]+Qr+Mo;xn[0]=Math.min(xn[0],Ic),bn[0]=Math.max(bn[0],Dc),xn[1]=Math.min(xn[1],Bc),bn[1]=Math.max(bn[1],Fc),i.renderBounds.setMinMax(xn,bn)}}),e.geometry.dirty=!1;var kc=p<0,Lc=g<0,Eo=(kc?-1:1)*(z?pi(z[0],0,e,!0):0),wo=(Lc?-1:1)*(z?pi(z[1],1,e,!0):0);(Eo||wo)&&e.setOrigin(Eo,wo)}},n.prototype.updateSizeAttenuation=function(e,t){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/t,e.nodeName===At.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/t)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===At.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR))},n.prototype.isPropertyInheritable=function(e){var t=Qo[e];return t?t.inh:!1},n}(),dF=function(){function n(){this.parser=c2,this.parserUnmemoize=P0,this.parserWithCSSDisabled=null,this.mixer=M0}return n.prototype.calculator=function(e,t,r,i){return Zr(r)},n}(),pF=function(){function n(){}return n.prototype.calculator=function(e,t,r,i,a){return r instanceof Kr&&(r=null),a.sceneGraphService.updateDisplayObjectDependency(e,t,r,i),e==="clipPath"&&i.forEach(function(o){o.childNodes.length===0&&a.sceneGraphService.dirtifyToRoot(o)}),r},n}(),vF=function(){function n(){this.parser=ul,this.parserWithCSSDisabled=ul,this.mixer=I4}return n.prototype.calculator=function(e,t,r,i){return r instanceof Kr?r.value==="none"?_f:a2:r},n}(),gF=function(){function n(){this.parser=f2}return n.prototype.calculator=function(e,t,r){return r instanceof Kr?[]:r},n}();function A2(n){var e=n.parsedStyle.fontSize;return sn(e)?null:e}var I0=function(){function n(){this.parser=hl,this.parserUnmemoize=Ec,this.parserWithCSSDisabled=null,this.mixer=M0}return n.prototype.calculator=function(e,t,r,i,a){var o;if(Ia(r))return r;if(De.isRelativeUnit(r.unit)){var s=a.styleValueRegistry;if(r.unit===bt.kPercentage)return 0;if(r.unit===bt.kEms){if(i.parentNode){var l=A2(i.parentNode);if(l)return l*=r.value,l;s.addUnresolveProperty(i,e)}else s.addUnresolveProperty(i,e);return 0}else if(r.unit===bt.kRems){if(!((o=i==null?void 0:i.ownerDocument)===null||o===void 0)&&o.documentElement){var l=A2(i.ownerDocument.documentElement);if(l)return l*=r.value,l;s.addUnresolveProperty(i,e)}else s.addUnresolveProperty(i,e);return 0}}else return r.value},n}(),mF=function(){function n(){this.mixer=p2}return n.prototype.parser=function(e){var t=h2(Ia(e)?[e]:e),r;return t.length===1?r=[t[0],t[0]]:r=[t[0],t[1]],r},n.prototype.calculator=function(e,t,r){return r.map(function(i){return i.value})},n}(),yF=function(){function n(){this.mixer=p2}return n.prototype.parser=function(e){var t=h2(Ia(e)?[e]:e),r;return t.length===1?r=[t[0],t[0],t[0],t[0]]:t.length===2?r=[t[0],t[1],t[0],t[1]]:t.length===3?r=[t[0],t[1],t[2],t[1]]:r=[t[0],t[1],t[2],t[3]],r},n.prototype.calculator=function(e,t,r){return r.map(function(i){return i.value})},n}(),xF=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){r instanceof Kr&&(r=null);var a=r==null?void 0:r.cloneNode(!0);return a&&(a.style.isMarker=!0),a},n}(),bF=function(){function n(){this.mixer=M0,this.parser=qo,this.parserUnmemoize=fl,this.parserWithCSSDisabled=null}return n.prototype.calculator=function(e,t,r){return r.value},n}(),EF=function(){function n(){this.parser=qo,this.parserUnmemoize=fl,this.parserWithCSSDisabled=null,this.mixer=C0(0,1)}return n.prototype.calculator=function(e,t,r){return r.value},n.prototype.postProcessor=function(e){var t=e.parsedStyle,r=t.offsetPath,i=t.offsetDistance;if(r){var a=r.nodeName;if(a===At.LINE||a===At.PATH||a===At.POLYLINE){var o=r.getPoint(i);o&&e.setLocalPosition(o.x,o.y)}}},n}(),wF=function(){function n(){this.parser=qo,this.parserUnmemoize=fl,this.parserWithCSSDisabled=null,this.mixer=C0(0,1)}return n.prototype.calculator=function(e,t,r){return r.value},n}(),_F=function(){function n(){this.parser=O0,this.parserWithCSSDisabled=O0,this.mixer=Q4}return n.prototype.calculator=function(e,t,r){return r instanceof Kr&&r.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new fo(0,0,0,0)}:r},n}(),SF=function(){function n(){this.parser=_2,this.mixer=tF}return n}(),TF=function(n){Me(e,n);function e(){var t=n.apply(this,Xe([],Ht(arguments),!1))||this;return t.mixer=C0(0,1/0),t}return e}(I0),PF=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){return r instanceof Kr?r.value==="unset"?"":r.value:"".concat(r)},n.prototype.postProcessor=function(e){e.nodeValue="".concat(e.parsedStyle.text)||""},n}(),MF=function(){function n(){}return n.prototype.calculator=function(e,t,r,i){var a=i.getAttribute("text");if(a){var o=a;r.value==="capitalize"?o=a.charAt(0).toUpperCase()+a.slice(1):r.value==="lowercase"?o=a.toLowerCase():r.value==="uppercase"&&(o=a.toUpperCase()),i.parsedStyle.text=o}return r.value},n}(),D0={},CF=0;function AF(n,e){if(n){var t=typeof n=="string"?n:n.id||CF++;D0[t]&&D0[t].destroy(),D0[t]=e}}var B0=typeof window!="undefined"&&typeof window.document!="undefined";function OF(n){return!!n.getAttribute}function NF(n,e){for(var t=0,r=n.length;t<r;){var i=t+r>>>1;O2(n[i],e)<0?t=i+1:r=i}return t}function O2(n,e){var t=Number(n.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(t===r){var i=n.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(n)-a.indexOf(e)}}return t-r}function RF(n){var e,t=n;do{var r=(e=t.parsedStyle)===null||e===void 0?void 0:e.clipPath;if(r)return t;t=t.parentElement}while(t!==null);return null}var N2="px";function EV(n,e,t){B0&&n.style&&(n.style.width=e+N2,n.style.height=t+N2)}function R2(n,e){if(B0)return document.defaultView.getComputedStyle(n,null).getPropertyValue(e)}function kF(n){var e=R2(n,"width");return e==="auto"?n.offsetWidth:parseFloat(e)}function LF(n){var e=R2(n,"height");return e==="auto"?n.offsetHeight:parseFloat(e)}var IF=1,DF={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},F0=typeof performance=="object"&&performance.now?performance:Date;function wV(n,e,t){n===void 0&&(n="auto");var r=!1,i=!1,a=!!e&&!e.isNone,o=!!t&&!t.isNone;return n==="visiblepainted"||n==="painted"||n==="auto"?(r=a,i=o):n==="visiblefill"||n==="fill"?r=!0:n==="visiblestroke"||n==="stroke"?i=!0:(n==="visible"||n==="all")&&(r=!0,i=!0),[r,i]}var BF=1,FF=function(){return BF++},fa=typeof self=="object"&&self.self==self?self:typeof D.g=="object"&&D.g.global==D.g?D.g:{},GF=Date.now(),zF=function(){return fa.performance&&typeof fa.performance.now=="function"?fa.performance.now():Date.now()-GF},wc={},k2=Date.now(),WF=function(n){if(typeof n!="function")throw new TypeError(n+" is not a function");var e=Date.now(),t=e-k2,r=t>16?0:16-t,i=FF();return wc[i]=n,Object.keys(wc).length>1||setTimeout(function(){k2=e;var a=wc;wc={},Object.keys(a).forEach(function(o){return a[o](zF())})},r),i},UF=function(n){delete wc[n]},VF=["","webkit","moz","ms","o"],L2=function(n){return typeof n!="string"?WF:n===""?fa.requestAnimationFrame:fa[n+"RequestAnimationFrame"]},HF=function(n){return typeof n!="string"?UF:n===""?fa.cancelAnimationFrame:fa[n+"CancelAnimationFrame"]||fa[n+"CancelRequestAnimationFrame"]},YF=function(n,e){for(var t=0;n[t]!==void 0;){if(e(n[t]))return n[t];t=t+1}},I2=YF(VF,function(n){return!!L2(n)}),G0=L2(I2),D2=HF(I2);fa.requestAnimationFrame=G0,fa.cancelAnimationFrame=D2;var XF=function(){function n(){this.callbacks=[]}return n.prototype.getCallbacksNum=function(){return this.callbacks.length},n.prototype.tapPromise=function(e,t){this.callbacks.push(t)},n.prototype.promise=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Promise.all(this.callbacks.map(function(r){return r.apply(void 0,Xe([],Ht(e),!1))}))},n}(),jF=function(){function n(){this.callbacks=[]}return n.prototype.tapPromise=function(e,t){this.callbacks.push(t)},n.prototype.promise=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ff(this,void 0,void 0,function(){var r,i,a,o;return df(this,function(s){switch(s.label){case 0:return this.callbacks.length?[4,(o=this.callbacks)[0].apply(o,Xe([],Ht(e),!1))]:[3,6];case 1:r=s.sent(),i=0,s.label=2;case 2:return i<this.callbacks.length-1?(a=this.callbacks[i],[4,a(r)]):[3,5];case 3:r=s.sent(),s.label=4;case 4:return i++,[3,2];case 5:return[2,r];case 6:return[2,null]}})})},n}(),Pr=function(){function n(){this.callbacks=[]}return n.prototype.tap=function(e,t){this.callbacks.push(t)},n.prototype.call=function(){var e=arguments;this.callbacks.forEach(function(t){t.apply(void 0,e)})},n}(),z0=function(){function n(){this.callbacks=[]}return n.prototype.tap=function(e,t){this.callbacks.push(t)},n.prototype.call=function(){if(this.callbacks.length){for(var e=arguments,t=this.callbacks[0].apply(void 0,e),r=0;r<this.callbacks.length-1;r++){var i=this.callbacks[r];t=i(t)}return t}return null},n}(),$F=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],KF=/([\"\'])[^\'\"]+\1/;function ZF(n){for(var e=n.fontSize,t=e===void 0?16:e,r=n.fontFamily,i=r===void 0?"sans-serif":r,a=n.fontStyle,o=a===void 0?"normal":a,s=n.fontVariant,l=s===void 0?"normal":s,c=n.fontWeight,u=c===void 0?"normal":c,h=Ia(t)&&"".concat(t,"px")||"16px",f=i.split(","),d=f.length-1;d>=0;d--){var p=f[d].trim();!KF.test(p)&&$F.indexOf(p)<0&&(p='"'.concat(p,'"')),f[d]=p}return"".concat(o," ").concat(l," ").concat(u," ").concat(h," ").concat(f.join(","))}function W0(n,e,t){return Xt(n),n[4]=Math.tan(e),n[1]=Math.tan(t),n}var _c=1e-5,qF=Q(),kn=Q();function JF(n,e){if(n.length){var t=Xt(qF);n.forEach(function(r){var i=r.t,a=r.d;if(i==="scale"){var o=(a==null?void 0:a.map(function(m){return Math.max(m.value,_c)}))||[1,1];Ae(kn,[o[0],o[1],1])}else if(i==="scalex"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,_c)}))||[1];Ae(kn,[o[0],1,1])}else if(i==="scaley"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,_c)}))||[1];Ae(kn,[1,o[0],1])}else if(i==="scalez"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,_c)}))||[1];Ae(kn,[1,1,o[0]])}else if(i==="scale3d"){var o=(a==null?void 0:a.map(function(x){return Math.max(x.value,_c)}))||[1,1,1];Ae(kn,[o[0],o[1],o[2]])}else if(i==="translate"){var s=a||[Pn,Pn];ce(kn,[s[0].value,s[1].value,0])}else if(i==="translatex"){var s=a||[Pn];ce(kn,[s[0].value,0,0])}else if(i==="translatey"){var s=a||[Pn];ce(kn,[0,s[0].value,0])}else if(i==="translatez"){var s=a||[Pn];ce(kn,[0,0,s[0].value])}else if(i==="translate3d"){var s=a||[Pn,Pn,Pn];ce(kn,[s[0].value,s[1].value,s[2].value])}else if(i==="rotate"){var l=a||[Gi];ti(kn,qe(Zr(l[0])))}else if(i==="rotatex"){var l=a||[Gi];re(kn,qe(Zr(l[0])))}else if(i==="rotatey"){var l=a||[Gi];je(kn,qe(Zr(l[0])))}else if(i==="rotatez"){var l=a||[Gi];ti(kn,qe(Zr(l[0])))}else if(i==="rotate3d"){var l=a||[Pn,Pn,Pn,Gi];Or(kn,qe(Zr(l[3])),[l[0].value,l[1].value,l[2].value])}else if(i==="skew"){var c=(a==null?void 0:a.map(function(m){return m.value}))||[0,0];W0(kn,qe(c[0]),qe(c[1]))}else if(i==="skewx"){var c=(a==null?void 0:a.map(function(x){return x.value}))||[0];W0(kn,qe(c[0]),0)}else if(i==="skewy"){var c=(a==null?void 0:a.map(function(x){return x.value}))||[0];W0(kn,0,qe(c[0]))}else if(i==="matrix"){var u=Ht(a.map(function(m){return m.value}),6),h=u[0],f=u[1],d=u[2],p=u[3],v=u[4],g=u[5];ne(kn,h,f,0,0,d,p,0,0,0,0,1,0,v,g,0,1)}else i==="matrix3d"&&ne.apply(G,Xe([kn],Ht(a.map(function(m){return m.value})),!1));Yc(t,t,kn)}),e.setLocalTransform(t)}else e.resetLocalTransform();return e.getLocalTransform()}var QF=function(){function n(){this.parser=S2,this.parserUnmemoize=T2,this.parserWithCSSDisabled=T2,this.mixer=cF}return n.prototype.calculator=function(e,t,r,i){return r instanceof Kr?[]:r},n.prototype.postProcessor=function(e){var t=e.parsedStyle.transform;JF(t,e)},n}(),t5=function(){function n(){this.parser=M2,this.parserUnmemoize=uF}return n.prototype.postProcessor=function(e){var t=e.parsedStyle.transformOrigin;t[0].unit===bt.kPixels&&t[1].unit===bt.kPixels?e.setOrigin(t[0].value,t[1].value):e.getGeometryBounds()},n}(),e5=function(){function n(){this.parser=qo,this.parserUnmemoize=fl}return n.prototype.calculator=function(e,t,r,i){return r.value},n.prototype.postProcessor=function(e){if(e.parentNode){var t=e.parentNode,r=t.renderable,i=t.sortable;r&&(r.dirty=!0),i&&(i.dirty=!0,i.dirtyReason=cl.Z_INDEX_CHANGED)}},n}(),n5=function(){function n(){}return n.prototype.update=function(e,t){var r=e.cx,i=r===void 0?0:r,a=e.cy,o=a===void 0?0:a,s=e.r,l=s===void 0?0:s;return{cx:i,cy:o,hwidth:l,hheight:l}},n}(),r5=function(){function n(){}return n.prototype.update=function(e,t){var r=e.cx,i=r===void 0?0:r,a=e.cy,o=a===void 0?0:a,s=e.rx,l=s===void 0?0:s,c=e.ry,u=c===void 0?0:c;return{cx:i,cy:o,hwidth:l,hheight:u}},n}(),i5=function(){function n(){}return n.prototype.update=function(e){var t=e.x1,r=e.y1,i=e.x2,a=e.y2,o=Math.min(t,i),s=Math.max(t,i),l=Math.min(r,a),c=Math.max(r,a),u=s-o,h=c-l,f=u/2,d=h/2;return{cx:o+f,cy:l+d,hwidth:f,hheight:d}},n}(),a5=function(){function n(){}return n.prototype.update=function(e){var t=e.d,r=t.rect,i=r.x,a=r.y,o=r.width,s=r.height,l=o/2,c=s/2;return{cx:i+l,cy:a+c,hwidth:l,hheight:c}},n}(),o5=function(){function n(){}return n.prototype.update=function(e){if(e.points&&u0(e.points.points)){var t=e.points.points,r=Math.min.apply(Math,Xe([],Ht(t.map(function(h){return h[0]})),!1)),i=Math.max.apply(Math,Xe([],Ht(t.map(function(h){return h[0]})),!1)),a=Math.min.apply(Math,Xe([],Ht(t.map(function(h){return h[1]})),!1)),o=Math.max.apply(Math,Xe([],Ht(t.map(function(h){return h[1]})),!1)),s=i-r,l=o-a,c=s/2,u=l/2;return{cx:r+c,cy:a+u,hwidth:c,hheight:u}}return{cx:0,cy:0,hwidth:0,hheight:0}},n}(),s5=function(){function n(){}return n.prototype.update=function(e,t){var r=e.x,i=r===void 0?0:r,a=e.y,o=a===void 0?0:a,s=e.src,l=e.width,c=l===void 0?0:l,u=e.height,h=u===void 0?0:u,f=c,d=h;return s&&!ua(s)&&(f||(f=s.width,e.width=f),d||(d=s.height,e.height=d)),{cx:i+f/2,cy:o+d/2,hwidth:f/2,hheight:d/2}},n}(),l5=function(){function n(e){this.globalRuntime=e}return n.prototype.isReadyToMeasure=function(e,t){var r=e.text,i=e.textAlign,a=e.textBaseline,o=e.fontSize,s=e.fontStyle,l=e.fontWeight,c=e.fontVariant,u=e.lineWidth;return st.enableCSSParsing?r&&o&&s&&l&&c&&i&&a&&!sn(u):r},n.prototype.update=function(e,t){var r,i,a=e.text,o=e.textAlign,s=o===void 0?"start":o,l=e.lineWidth,c=l===void 0?1:l,u=e.textBaseline,h=u===void 0?"alphabetic":u,f=e.dx,d=f===void 0?0:f,p=e.dy,v=p===void 0?0:p,g=e.x,m=g===void 0?0:g,x=e.y,_=x===void 0?0:x;if(!this.isReadyToMeasure(e,t))return e.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var S=(((i=(r=t==null?void 0:t.ownerDocument)===null||r===void 0?void 0:r.defaultView)===null||i===void 0?void 0:i.getConfig())||{}).offscreenCanvas,b=this.globalRuntime.textService.measureText(a,e,S);e.metrics=b;var y=b.width,E=b.height,w=b.lineHeight,M=b.fontProperties,P=y/2,A=E/2,O=m+P;s==="center"||s==="middle"?O+=c/2-P:(s==="right"||s==="end")&&(O+=c-P*2);var R=_-A;return h==="middle"?R+=A:h==="top"||h==="hanging"?R+=A*2:h==="alphabetic"?R+=this.globalRuntime.enableCSSParsing?w-M.ascent:0:(h==="bottom"||h==="ideographic")&&(R+=0),d&&(O+=d),v&&(R+=v),{cx:O,cy:R,hwidth:P,hheight:A}},n}(),c5=function(){function n(){}return n.prototype.update=function(e,t){return{cx:0,cy:0,hwidth:0,hheight:0}},n}();function u5(n){return!!n.type}var U0=function(){function n(e){this.eventPhase=n.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new hr,this.page=new hr,this.canvas=new hr,this.viewport=new hr,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}return Object.defineProperty(n.prototype,"name",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layerX",{get:function(){return this.layer.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layerY",{get:function(){return this.layer.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageX",{get:function(){return this.page.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"pageY",{get:function(){return this.page.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"x",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasX",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvasY",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewportX",{get:function(){return this.viewport.x},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"viewportY",{get:function(){return this.viewport.y},enumerable:!1,configurable:!0}),n.prototype.composedPath=function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},Object.defineProperty(n.prototype,"propagationPath",{get:function(){return this.composedPath()},enumerable:!1,configurable:!0}),n.prototype.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},n.prototype.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},n.prototype.stopPropagation=function(){this.propagationStopped=!0},n.prototype.initEvent=function(){},n.prototype.initUIEvent=function(){},n.prototype.clone=function(){throw new Error(cn)},n}(),B2=function(n){Me(e,n);function e(){var t=n.apply(this,Xe([],Ht(arguments),!1))||this;return t.client=new hr,t.movement=new hr,t.offset=new hr,t.global=new hr,t.screen=new hr,t}return Object.defineProperty(e.prototype,"clientX",{get:function(){return this.client.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientY",{get:function(){return this.client.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementX",{get:function(){return this.movement.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementY",{get:function(){return this.movement.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetX",{get:function(){return this.offset.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetY",{get:function(){return this.offset.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalX",{get:function(){return this.global.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalY",{get:function(){return this.global.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenX",{get:function(){return this.screen.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenY",{get:function(){return this.screen.y},enumerable:!1,configurable:!0}),e.prototype.getModifierState=function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)},e.prototype.initMouseEvent=function(){throw new Error(cn)},e}(U0),V0=function(n){Me(e,n);function e(){var t=n.apply(this,Xe([],Ht(arguments),!1))||this;return t.width=0,t.height=0,t.isPrimary=!1,t}return e.prototype.getCoalescedEvents=function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]},e.prototype.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},e.prototype.clone=function(){return this.manager.clonePointerEvent(this)},e}(B2),H0=function(n){Me(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.clone=function(){return this.manager.cloneWheelEvent(this)},e}(B2),Mr=function(n){Me(e,n);function e(t,r){var i=n.call(this,null)||this;return i.type=t,i.detail=r,Object.assign(i,r),i}return e}(U0),F2=":",G2=function(){function n(){this.emitter=new et}return n.prototype.on=function(e,t,r){return this.addEventListener(e,t,r),this},n.prototype.addEventListener=function(e,t,r){var i=KE(r)&&r||xf(r)&&r.capture,a=xf(r)&&r.once,o=ll(t)?void 0:t,s=!1,l="";if(e.indexOf(F2)>-1){var c=Ht(e.split(F2),2),u=c[0],h=c[1];e=h,l=u,s=!0}if(e=i?"".concat(e,"capture"):e,t=ll(t)?t:t.handleEvent,s){var f=t;t=function(){for(var d,p=[],v=0;v<arguments.length;v++)p[v]=arguments[v];((d=p[0].target)===null||d===void 0?void 0:d.name)===l&&f.apply(void 0,Xe([],Ht(p),!1))}}return a?this.emitter.once(e,t,o):this.emitter.on(e,t,o),this},n.prototype.off=function(e,t,r){return e?this.removeEventListener(e,t,r):this.removeAllEventListeners(),this},n.prototype.removeAllEventListeners=function(){this.emitter.removeAllListeners()},n.prototype.removeEventListener=function(e,t,r){var i=KE(r)&&r||xf(r)&&r.capture,a=ll(t)?void 0:t;return e=i?"".concat(e,"capture"):e,t=ll(t)?t:t==null?void 0:t.handleEvent,this.emitter.off(e,t,a),this},n.prototype.emit=function(e,t){this.dispatchEvent(new Mr(e,t))},n.prototype.dispatchEvent=function(e,t){var r,i;if(t===void 0&&(t=!1),!u5(e))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var a;if(this.document?a=this:this.defaultView?a=this.defaultView:a=(r=this.ownerDocument)===null||r===void 0?void 0:r.defaultView,a){if(e.manager=a.getEventService()||null,!e.manager)return!1;e.defaultPrevented=!1,e.path=[],t||(e.target=this),(i=e.manager)===null||i===void 0||i.dispatchEvent(e,e.type,t)}return!e.defaultPrevented},n}(),Qn=function(n){Me(e,n);function e(){var t=n.call(this)||this;return t.shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.parentNode=null,t}return e.isNode=function(t){return!!t.childNodes},Object.defineProperty(e.prototype,"textContent",{get:function(){var t,r,i="";this.nodeName===At.TEXT&&(i+=this.style.text);try{for(var a=ca(this.childNodes),o=a.next();!o.done;o=a.next()){var s=o.value;s.nodeName===At.TEXT?i+=s.nodeValue:i+=s.textContent}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return i},set:function(t){var r=this;this.childNodes.slice().forEach(function(i){r.removeChild(i)}),this.nodeName===At.TEXT&&(this.style.text="".concat(t))},enumerable:!1,configurable:!0}),e.prototype.getRootNode=function(t){return t===void 0&&(t={}),this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this},e.prototype.hasChildNodes=function(){return this.childNodes.length>0},e.prototype.isDefaultNamespace=function(t){throw new Error(cn)},e.prototype.lookupNamespaceURI=function(t){throw new Error(cn)},e.prototype.lookupPrefix=function(t){throw new Error(cn)},e.prototype.normalize=function(){throw new Error(cn)},e.prototype.isEqualNode=function(t){return this===t},e.prototype.isSameNode=function(t){return this.isEqualNode(t)},Object.defineProperty(e.prototype,"parent",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.childNodes.length>0?this.childNodes[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null},enumerable:!1,configurable:!0}),e.prototype.compareDocumentPosition=function(t){var r;if(t===this)return 0;for(var i=t,a=this,o=[i],s=[a];(r=i.parentNode)!==null&&r!==void 0?r:a.parentNode;)i=i.parentNode?(o.push(i.parentNode),i.parentNode):i,a=a.parentNode?(s.push(a.parentNode),a.parentNode):a;if(i!==a)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var l=o.length>s.length?o:s,c=l===o?s:o;if(l[l.length-c.length]===c[0])return l===o?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var u=l.length-c.length,h=c.length-1;h>=0;h--){var f=c[h],d=l[u+h];if(d!==f){var p=f.parentNode.childNodes;return p.indexOf(f)<p.indexOf(d)?c===o?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:l===o?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING},e.prototype.contain=function(t){return this.contains(t)},e.prototype.contains=function(t){for(var r=t;r&&this!==r;)r=r.parentNode;return!!r},e.prototype.getAncestor=function(t){for(var r=this;t>0&&r;)r=r.parentNode,t--;return r},e.prototype.forEach=function(t,r){r===void 0&&(r=!1),t(this)||(r?this.childNodes.slice():this.childNodes).forEach(function(i){i.forEach(t)})},e.DOCUMENT_POSITION_DISCONNECTED=1,e.DOCUMENT_POSITION_PRECEDING=2,e.DOCUMENT_POSITION_FOLLOWING=4,e.DOCUMENT_POSITION_CONTAINS=8,e.DOCUMENT_POSITION_CONTAINED_BY=16,e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,e}(G2),h5=2048,f5=function(){function n(e,t){var r=this;this.globalRuntime=e,this.context=t,this.emitter=new et,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=Q(),this.tmpVec3=T.Ue(),this.onPointerDown=function(i){var a=r.createPointerEvent(i);if(r.dispatchEvent(a,"pointerdown"),a.pointerType==="touch")r.dispatchEvent(a,"touchstart");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var o=a.button===2;r.dispatchEvent(a,o?"rightdown":"mousedown")}var s=r.trackingData(i.pointerId);s.pressTargetsByButton[i.button]=a.composedPath(),r.freeEvent(a)},this.onPointerUp=function(i){var a,o=F0.now(),s=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(s,"pointerup"),s.pointerType==="touch")r.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.dispatchEvent(s,l?"rightup":"mouseup")}var c=r.trackingData(i.pointerId),u=r.findMountedTarget(c.pressTargetsByButton[i.button]),h=u;if(u&&!s.composedPath().includes(u)){for(var f=u;f&&!s.composedPath().includes(f);){if(s.currentTarget=f,r.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")r.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;r.notifyTarget(s,l?"rightupoutside":"mouseupoutside")}Qn.isNode(f)&&(f=f.parentNode)}delete c.pressTargetsByButton[i.button],h=f}if(h){var d=r.clonePointerEvent(s,"click");d.target=h,d.path=[],c.clicksByButton[i.button]||(c.clicksByButton[i.button]={clickCount:0,target:d.target,timeStamp:o});var p=r.context.renderingContext.root.ownerDocument.defaultView,v=c.clicksByButton[i.button];v.target===d.target&&o-v.timeStamp<p.dblClickSpeed?++v.clickCount:v.clickCount=1,v.target=d.target,v.timeStamp=o,d.detail=v.clickCount,!((a=s.detail)===null||a===void 0)&&a.preventClick||(!r.context.config.useNativeClickEvent&&(d.pointerType==="mouse"||d.pointerType==="touch")&&r.dispatchEvent(d,"click"),r.dispatchEvent(d,"pointertap")),r.freeEvent(d)}r.freeEvent(s)},this.onPointerMove=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),o=a.pointerType==="mouse"||a.pointerType==="pen",s=r.trackingData(i.pointerId),l=r.findMountedTarget(s.overTargets);if(s.overTargets&&l!==a.target){var c=i.type==="mousemove"?"mouseout":"pointerout",u=r.createPointerEvent(i,c,l||void 0);if(r.dispatchEvent(u,"pointerout"),o&&r.dispatchEvent(u,"mouseout"),!a.composedPath().includes(l)){var h=r.createPointerEvent(i,"pointerleave",l||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&!a.composedPath().includes(h.target);)h.currentTarget=h.target,r.notifyTarget(h),o&&r.notifyTarget(h,"mouseleave"),Qn.isNode(h.target)&&(h.target=h.target.parentNode);r.freeEvent(h)}r.freeEvent(u)}if(l!==a.target){var f=i.type==="mousemove"?"mouseover":"pointerover",d=r.clonePointerEvent(a,f);r.dispatchEvent(d,"pointerover"),o&&r.dispatchEvent(d,"mouseover");for(var p=l&&Qn.isNode(l)&&l.parentNode;p&&p!==(Qn.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&p!==a.target;)p=p.parentNode;var v=!p||p===(Qn.isNode(r.rootTarget)&&r.rootTarget.parentNode);if(v){var g=r.clonePointerEvent(a,"pointerenter");for(g.eventPhase=g.AT_TARGET;g.target&&g.target!==l&&g.target!==(Qn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)g.currentTarget=g.target,r.notifyTarget(g),o&&r.notifyTarget(g,"mouseenter"),Qn.isNode(g.target)&&(g.target=g.target.parentNode);r.freeEvent(g)}r.freeEvent(d)}r.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&r.dispatchEvent(a,"touchmove"),o&&(r.dispatchEvent(a,"mousemove"),r.cursor=r.getCursor(a.target)),s.overTargets=a.composedPath(),r.freeEvent(a)},this.onPointerOut=function(i){var a=r.trackingData(i.pointerId);if(a.overTargets){var o=i.pointerType==="mouse"||i.pointerType==="pen",s=r.findMountedTarget(a.overTargets),l=r.createPointerEvent(i,"pointerout",s||void 0);r.dispatchEvent(l),o&&r.dispatchEvent(l,"mouseout");var c=r.createPointerEvent(i,"pointerleave",s||void 0);for(c.eventPhase=c.AT_TARGET;c.target&&c.target!==(Qn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)c.currentTarget=c.target,r.notifyTarget(c),o&&r.notifyTarget(c,"mouseleave"),Qn.isNode(c.target)&&(c.target=c.target.parentNode);a.overTargets=null,r.freeEvent(l),r.freeEvent(c)}r.cursor=null},this.onPointerOver=function(i){var a=r.trackingData(i.pointerId),o=r.createPointerEvent(i),s=o.pointerType==="mouse"||o.pointerType==="pen";r.dispatchEvent(o,"pointerover"),s&&r.dispatchEvent(o,"mouseover"),o.pointerType==="mouse"&&(r.cursor=r.getCursor(o.target));var l=r.clonePointerEvent(o,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(Qn.isNode(r.rootTarget)&&r.rootTarget.parentNode);)l.currentTarget=l.target,r.notifyTarget(l),s&&r.notifyTarget(l,"mouseenter"),Qn.isNode(l.target)&&(l.target=l.target.parentNode);a.overTargets=o.composedPath(),r.freeEvent(o),r.freeEvent(l)},this.onPointerUpOutside=function(i){var a=r.trackingData(i.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[i.button]),s=r.createPointerEvent(i);if(o){for(var l=o;l;)s.currentTarget=l,r.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"||(s.pointerType==="mouse"||s.pointerType==="pen")&&r.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),Qn.isNode(l)&&(l=l.parentNode);delete a.pressTargetsByButton[i.button]}r.freeEvent(s)},this.onWheel=function(i){var a=r.createWheelEvent(i);r.dispatchEvent(a),r.freeEvent(a)},this.onClick=function(i){if(r.context.config.useNativeClickEvent){var a=r.createPointerEvent(i);r.dispatchEvent(a),r.freeEvent(a)}},this.onPointerCancel=function(i){var a=r.createPointerEvent(i,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(a),r.freeEvent(a)}}return n.prototype.init=function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)},n.prototype.destroy=function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()},n.prototype.getScale=function(){var e=this.context.contextService.getBoundingClientRect(),t=1,r=1,i=this.context.contextService.getDomElement();if(i&&e){var a=i.offsetWidth,o=i.offsetHeight;a&&o&&(t=e.width/a,r=e.height/o)}return{scaleX:t,scaleY:r,bbox:e}},n.prototype.client2Viewport=function(e){var t=this.getScale(),r=t.scaleX,i=t.scaleY,a=t.bbox;return new hr((e.x-((a==null?void 0:a.left)||0))/r,(e.y-((a==null?void 0:a.top)||0))/i)},n.prototype.viewport2Client=function(e){var t=this.getScale(),r=t.scaleX,i=t.scaleY,a=t.bbox;return new hr((e.x+((a==null?void 0:a.left)||0))*r,(e.y+((a==null?void 0:a.top)||0))*i)},n.prototype.viewport2Canvas=function(e){var t=e.x,r=e.y,i=this.rootTarget.defaultView,a=i.getCamera(),o=this.context.config,s=o.width,l=o.height,c=a.getPerspectiveInverse(),u=a.getWorldTransform(),h=Ut(this.tmpMatrix,u,c),f=T.t8(this.tmpVec3,t/s*2-1,(1-r/l)*2-1,0);return T.fF(f,f,h),new hr(f[0],f[1])},n.prototype.canvas2Viewport=function(e){var t=this.rootTarget.defaultView,r=t.getCamera(),i=r.getPerspective(),a=r.getViewTransform(),o=Ut(this.tmpMatrix,i,a),s=T.t8(this.tmpVec3,e.x,e.y,0);T.fF(this.tmpVec3,this.tmpVec3,o);var l=this.context.config,c=l.width,u=l.height;return new hr((s[0]+1)/2*c,(1-(s[1]+1)/2)*u)},n.prototype.setPickHandler=function(e){this.pickHandler=e},n.prototype.addEventMapping=function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(r,i){return r.priority-i.priority})},n.prototype.mapEvent=function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var r=0,i=t.length;r<i;r++)t[r].fn(e);else console.warn("[EventService]: Event mapping not defined for ".concat(e.type))}},n.prototype.dispatchEvent=function(e,t,r){if(!r)e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t);else{e.eventPhase=e.AT_TARGET;var i=this.rootTarget.defaultView||null;e.currentTarget=i,this.notifyListeners(e,t)}this.emitter.emit(t||e.type,e)},n.prototype.propagate=function(e,t){if(e.target){var r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var i=r.length-1;i>=1;i--)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){var a=r.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var i=a+1;i<r.length;i++)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}},n.prototype.propagationPath=function(e){var t=[e],r=this.rootTarget.defaultView||null;if(r&&r===e)return t.unshift(r.document),t;for(var i=0;i<h5&&e!==this.rootTarget;i++)Qn.isNode(e)&&e.parentNode&&(t.push(e.parentNode),e=e.parentNode);return r&&t.push(r),t},n.prototype.hitTest=function(e){var t=e.viewportX,r=e.viewportY,i=this.context.config,a=i.width,o=i.height,s=i.disableHitTesting;return t<0||r<0||t>a||r>o?null:!s&&this.pickHandler(e)||this.rootTarget||null},n.prototype.isNativeEventFromCanvas=function(e,t){var r=t==null?void 0:t.target;if(r!=null&&r.shadowRoot&&(r=t.composedPath()[0]),r){if(r===e)return!0;if(e&&e.contains)return e.contains(r)}return t!=null&&t.composedPath?t.composedPath().indexOf(e)>-1:!1},n.prototype.getExistedHTML=function(e){var t,r;if(e.nativeEvent.composedPath)try{for(var i=ca(e.nativeEvent.composedPath()),a=i.next();!a.done;a=i.next()){var o=a.value,s=this.nativeHTMLMap.get(o);if(s)return s}}catch(l){t={error:l}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return null},n.prototype.pickTarget=function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY})},n.prototype.createPointerEvent=function(e,t,r,i){var a=this.allocateEvent(V0);this.copyPointerData(e,a),this.copyMouseData(e,a),this.copyData(e,a),a.nativeEvent=e.nativeEvent,a.originalEvent=e;var o=this.getExistedHTML(a),s=this.context.contextService.getDomElement();return a.target=r!=null?r:o||this.isNativeEventFromCanvas(s,a.nativeEvent)&&this.pickTarget(a)||i,typeof t=="string"&&(a.type=t),a},n.prototype.createWheelEvent=function(e){var t=this.allocateEvent(H0);this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e;var r=this.getExistedHTML(t),i=this.context.contextService.getDomElement();return t.target=r||this.isNativeEventFromCanvas(i,t.nativeEvent)&&this.pickTarget(t),t},n.prototype.trackingData=function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]},n.prototype.cloneWheelEvent=function(e){var t=this.allocateEvent(H0);return t.nativeEvent=e.nativeEvent,t.originalEvent=e.originalEvent,this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.target=e.target,t.path=e.composedPath().slice(),t.type=e.type,t},n.prototype.clonePointerEvent=function(e,t){var r=this.allocateEvent(V0);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=t!=null?t:r.type,r},n.prototype.copyPointerData=function(e,t){t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist},n.prototype.copyMouseData=function(e,t){t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.client.copyFrom(e.client),t.movement.copyFrom(e.movement),t.canvas.copyFrom(e.canvas),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global),t.offset.copyFrom(e.offset)},n.prototype.copyWheelData=function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ},n.prototype.copyData=function(e,t){t.isTrusted=e.isTrusted,t.timeStamp=F0.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.page.copyFrom(e.page),t.viewport.copyFrom(e.viewport)},n.prototype.allocateEvent=function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t},n.prototype.freeEvent=function(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)},n.prototype.notifyTarget=function(e,t){t=t!=null?t:e.type;var r=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?"".concat(t,"capture"):t;this.notifyListeners(e,r),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)},n.prototype.notifyListeners=function(e,t){var r=e.currentTarget.emitter,i=r._events[t];if(i)if("fn"in i)i.once&&r.removeListener(t,i.fn,void 0,!0),i.fn.call(e.currentTarget||i.context,e);else for(var a=0;a<i.length&&!e.propagationImmediatelyStopped;a++)i[a].once&&r.removeListener(t,i[a].fn,void 0,!0),i[a].fn.call(e.currentTarget||i[a].context,e)},n.prototype.findMountedTarget=function(e){if(!e)return null;for(var t=e[e.length-1],r=e.length-2;r>=0;r--){var i=e[r];if(i===this.rootTarget||Qn.isNode(i)&&i.parentNode===t)t=e[r];else break}return t},n.prototype.getCursor=function(e){for(var t=e;t;){var r=OF(t)&&t.getAttribute("cursor");if(r)return r;t=Qn.isNode(t)&&t.parentNode}},n}(),d5=function(){function n(){}return n.prototype.getOrCreateCanvas=function(e,t){if(this.canvas)return this.canvas;if(e||st.offscreenCanvas)this.canvas=e||st.offscreenCanvas,this.context=this.canvas.getContext("2d",te({willReadFrequently:!0},t));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",te({willReadFrequently:!0},t)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(r){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",te({willReadFrequently:!0},t))}return this.canvas.width=10,this.canvas.height=10,this.canvas},n.prototype.getOrCreateContext=function(e,t){return this.context?this.context:(this.getOrCreateCanvas(e,t),this.context)},n}(),ts;(function(n){n[n.CAMERA_CHANGED=0]="CAMERA_CHANGED",n[n.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",n[n.NONE=2]="NONE"})(ts||(ts={}));var p5=function(){function n(e,t){this.globalRuntime=e,this.context=t,this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new Pr,initAsync:new XF,dirtycheck:new z0,cull:new z0,beginFrame:new Pr,beforeRender:new Pr,render:new Pr,afterRender:new Pr,endFrame:new Pr,destroy:new Pr,pick:new jF,pickSync:new z0,pointerDown:new Pr,pointerUp:new Pr,pointerMove:new Pr,pointerOut:new Pr,pointerOver:new Pr,pointerWheel:new Pr,pointerCancel:new Pr,click:new Pr}}return n.prototype.init=function(e){var t=this,r=te(te({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(i){i.apply(r,t.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){t.inited=!0,e()})},n.prototype.getStats=function(){return this.stats},n.prototype.disableDirtyRectangleRendering=function(){var e=this.context.config.renderer,t=e.getConfig().enableDirtyRectangleRendering;return!t||this.context.renderingContext.renderReasons.has(ts.CAMERA_CHANGED)},n.prototype.render=function(e,t,r){var i=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var a=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=a.renderReasons.size===1&&a.renderReasons.has(ts.CAMERA_CHANGED),s=!e.disableRenderHooks||!(e.disableRenderHooks&&o);s&&this.renderDisplayObject(a.root,e,a),this.hooks.beginFrame.call(t),s&&a.renderListCurrentFrame.forEach(function(l){i.hooks.beforeRender.call(l),i.hooks.render.call(l),i.hooks.afterRender.call(l)}),this.hooks.endFrame.call(t),a.renderListCurrentFrame=[],a.renderReasons.clear(),r()}},n.prototype.renderDisplayObject=function(e,t,r){var i=this,a=t.renderer.getConfig(),o=a.enableDirtyCheck,s=a.enableCulling;this.globalRuntime.enableCSSParsing&&this.globalRuntime.styleValueRegistry.recalc(e);var l=e.renderable,c=o?l.dirty||r.dirtyRectangleRenderingDisabled?e:null:e;if(c){var u=s?this.hooks.cull.call(c,this.context.camera):c;u&&(this.stats.rendered++,r.renderListCurrentFrame.push(u))}e.renderable.dirty=!1,e.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var h=e.sortable;h.dirty&&(this.sort(e,h),h.dirty=!1,h.dirtyChildren=[],h.dirtyReason=void 0),(h.sorted||e.childNodes).forEach(function(f){i.renderDisplayObject(f,t,r)})},n.prototype.sort=function(e,t){t.sorted&&t.dirtyReason!==cl.Z_INDEX_CHANGED?t.dirtyChildren.forEach(function(r){var i=e.childNodes.indexOf(r);if(i===-1){var a=t.sorted.indexOf(r);a>=0&&t.sorted.splice(a,1)}else if(t.sorted.length===0)t.sorted.push(r);else{var o=NF(t.sorted,r);t.sorted.splice(o,0,r)}}):t.sorted=e.childNodes.slice().sort(O2)},n.prototype.destroy=function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()},n.prototype.dirtify=function(){this.context.renderingContext.renderReasons.add(ts.DISPLAY_OBJECT_CHANGED)},n}(),v5=/\[\s*(.*)=(.*)\s*\]/,g5=function(){function n(){}return n.prototype.selectOne=function(e,t){var r=this;if(e.startsWith("."))return t.find(function(s){return((s==null?void 0:s.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.find(function(s){return s.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,o=i.value;return a?t.find(function(s){return t!==s&&(a==="name"?s.name===o:r.attributeToString(s,a)===o)}):null}else return t.find(function(s){return t!==s&&s.nodeName===e})},n.prototype.selectAll=function(e,t){var r=this;if(e.startsWith("."))return t.findAll(function(s){return t!==s&&((s==null?void 0:s.classList)||[]).indexOf(r.getIdOrClassname(e))>-1});if(e.startsWith("#"))return t.findAll(function(s){return t!==s&&s.id===r.getIdOrClassname(e)});if(e.startsWith("[")){var i=this.getAttribute(e),a=i.name,o=i.value;return a?t.findAll(function(s){return t!==s&&(a==="name"?s.name===o:r.attributeToString(s,a)===o)}):[]}else return t.findAll(function(s){return t!==s&&s.nodeName===e})},n.prototype.is=function(e,t){if(e.startsWith("."))return t.className===this.getIdOrClassname(e);if(e.startsWith("#"))return t.id===this.getIdOrClassname(e);if(e.startsWith("[")){var r=this.getAttribute(e),i=r.name,a=r.value;return i==="name"?t.name===a:this.attributeToString(t,i)===a}else return t.nodeName===e},n.prototype.getIdOrClassname=function(e){return e.substring(1)},n.prototype.getAttribute=function(e){var t=e.match(v5),r="",i="";return t&&t.length>2&&(r=t[1].replace(/"/g,""),i=t[2].replace(/"/g,"")),{name:r,value:i}},n.prototype.attributeToString=function(e,t){if(!e.getAttribute)return"";var r=e.getAttribute(t);return sn(r)?"":r.toString?r.toString():""},n}(),es=function(n){Me(e,n);function e(t,r,i,a,o,s,l,c){var u=n.call(this,null)||this;return u.relatedNode=r,u.prevValue=i,u.newValue=a,u.attrName=o,u.attrChange=s,u.prevParsedValue=l,u.newParsedValue=c,u.type=t,u}return e.ADDITION=2,e.MODIFICATION=1,e.REMOVAL=3,e}(U0),Ve;(function(n){n.REPARENT="reparent",n.DESTROY="destroy",n.ATTR_MODIFIED="DOMAttrModified",n.INSERTED="DOMNodeInserted",n.REMOVED="removed",n.MOUNTED="DOMNodeInsertedIntoDocument",n.UNMOUNTED="DOMNodeRemovedFromDocument",n.BOUNDS_CHANGED="bounds-changed",n.CULLED="culled"})(Ve||(Ve={}));function z2(n){var e=n.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0)}var m5=new es(Ve.REPARENT,null,"","","",0,"",""),y5=function(){function n(e){var t=this;this.runtime=e,this.pendingEvents=[],this.boundsChangedEvent=new Mr(Ve.BOUNDS_CHANGED),this.rotate=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=T.al(a,o,s));var c=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)t.rotateLocal(i,a);else{var u=Vt();bi(u,a[0],a[1],a[2]);var h=t.getRotation(i),f=t.getRotation(i.parentNode);Ei(r,f),ga(r,r),Ln(u,r,u),Ln(c.localRotation,u,h),Ga(c.localRotation,c.localRotation),l&&t.dirtifyLocal(i,c)}}}(),this.rotateLocal=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=T.al(a,o,s));var c=i.transformable;bi(r,a[0],a[1],a[2]),os(c.localRotation,c.localRotation,r),l&&t.dirtifyLocal(i,c)}}(),this.setEulerAngles=function(){var r=Vt();return function(i,a,o,s,l){o===void 0&&(o=0),s===void 0&&(s=0),l===void 0&&(l=!0),typeof a=="number"&&(a=T.al(a,o,s));var c=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)t.setLocalEulerAngles(i,a);else{bi(c.localRotation,a[0],a[1],a[2]);var u=t.getRotation(i.parentNode);Ei(r,ga(Vt(),u)),os(c.localRotation,c.localRotation,r),l&&t.dirtifyLocal(i,c)}}}(),this.translateLocal=function(){return function(r,i,a,o,s){a===void 0&&(a=0),o===void 0&&(o=0),s===void 0&&(s=!0),typeof i=="number"&&(i=T.al(i,a,o));var l=r.transformable;T.fS(i,T.Ue())||(T.VC(i,i,l.localRotation),T.IH(l.localPosition,l.localPosition,i),s&&t.dirtifyLocal(r,l))}}(),this.setPosition=function(){var r=Q(),i=T.Ue();return function(a,o,s){s===void 0&&(s=!0);var l=a.transformable;if(i[0]=o[0],i[1]=o[1],i[2]=o[2]||0,!T.fS(t.getPosition(a),i)){if(T.JG(l.position,i),a.parentNode===null||!a.parentNode.transformable)T.JG(l.localPosition,i);else{var c=a.parentNode.transformable;kt(r,c.worldTransform),Wt(r,r),T.fF(l.localPosition,i,r)}s&&t.dirtifyLocal(a,l)}}}(),this.setLocalPosition=function(){var r=T.Ue();return function(i,a,o){o===void 0&&(o=!0);var s=i.transformable;r[0]=a[0],r[1]=a[1],r[2]=a[2]||0,!T.fS(s.localPosition,r)&&(T.JG(s.localPosition,r),o&&t.dirtifyLocal(i,s))}}(),this.translate=function(){var r=T.Ue(),i=T.Ue(),a=T.Ue();return function(o,s,l,c,u){l===void 0&&(l=0),c===void 0&&(c=0),u===void 0&&(u=!0),typeof s=="number"&&(s=T.t8(i,s,l,c)),!T.fS(s,r)&&(T.IH(a,t.getPosition(o),s),t.setPosition(o,a,u))}}(),this.setRotation=function(){var r=Vt();return function(i,a,o,s,l,c){c===void 0&&(c=!0);var u=i.transformable;if(typeof a=="number"&&(a=ma(a,o,s,l)),i.parentNode===null||!i.parentNode.transformable)t.setLocalRotation(i,a);else{var h=t.getRotation(i.parentNode);Ei(r,h),ga(r,r),Ln(u.localRotation,r,a),Ga(u.localRotation,u.localRotation),c&&t.dirtifyLocal(i,u)}}},this.displayObjectDependencyMap=new WeakMap,this.calcLocalTransform=function(){var r=Q(),i=T.Ue(),a=ma(0,0,0,1);return function(o){var s=o.localSkew[0]!==0||o.localSkew[1]!==0;if(s){if(mr(o.localTransform,o.localRotation,o.localPosition,T.al(1,1,1),o.origin),o.localSkew[0]!==0||o.localSkew[1]!==0){var l=Xt(r);l[4]=Math.tan(o.localSkew[0]),l[1]=Math.tan(o.localSkew[1]),Ut(o.localTransform,o.localTransform,l)}var c=mr(r,a,i,o.localScale,o.origin);Ut(o.localTransform,o.localTransform,c)}else mr(o.localTransform,o.localRotation,o.localPosition,o.localScale,o.origin)}}()}return n.prototype.matches=function(e,t){return this.runtime.sceneGraphSelector.is(e,t)},n.prototype.querySelector=function(e,t){return this.runtime.sceneGraphSelector.selectOne(e,t)},n.prototype.querySelectorAll=function(e,t){return this.runtime.sceneGraphSelector.selectAll(e,t)},n.prototype.attach=function(e,t,r){var i,a=!1;e.parentNode&&(a=e.parentNode!==t,this.detach(e)),e.parentNode=t,sn(r)?e.parentNode.childNodes.push(e):e.parentNode.childNodes.splice(r,0,e);var o=t.sortable;(!((i=o==null?void 0:o.sorted)===null||i===void 0)&&i.length||e.parsedStyle.zIndex)&&(o.dirtyChildren.indexOf(e)===-1&&o.dirtyChildren.push(e),o.dirty=!0,o.dirtyReason=cl.ADDED);var s=e.transformable;s&&this.dirtifyWorld(e,s),s.frozen&&this.unfreezeParentToRoot(e),a&&e.dispatchEvent(m5)},n.prototype.detach=function(e){var t,r;if(e.parentNode){var i=e.transformable,a=e.parentNode.sortable;(!((t=a==null?void 0:a.sorted)===null||t===void 0)&&t.length||!((r=e.style)===null||r===void 0)&&r.zIndex)&&(a.dirtyChildren.indexOf(e)===-1&&a.dirtyChildren.push(e),a.dirty=!0,a.dirtyReason=cl.REMOVED);var o=e.parentNode.childNodes.indexOf(e);o>-1&&e.parentNode.childNodes.splice(o,1),i&&this.dirtifyWorld(e,i),e.parentNode=null}},n.prototype.getOrigin=function(e){return e.getGeometryBounds(),e.transformable.origin},n.prototype.setOrigin=function(e,t,r,i){r===void 0&&(r=0),i===void 0&&(i=0),typeof t=="number"&&(t=[t,r,i]);var a=e.transformable;if(!(t[0]===a.origin[0]&&t[1]===a.origin[1]&&t[2]===a.origin[2])){var o=a.origin;o[0]=t[0],o[1]=t[1],o[2]=t[2]||0,this.dirtifyLocal(e,a)}},n.prototype.setLocalEulerAngles=function(e,t,r,i,a){r===void 0&&(r=0),i===void 0&&(i=0),a===void 0&&(a=!0),typeof t=="number"&&(t=T.al(t,r,i));var o=e.transformable;bi(o.localRotation,t[0],t[1],t[2]),a&&this.dirtifyLocal(e,o)},n.prototype.scaleLocal=function(e,t,r){r===void 0&&(r=!0);var i=e.transformable;T.Jp(i.localScale,i.localScale,T.al(t[0],t[1],t[2]||1)),r&&this.dirtifyLocal(e,i)},n.prototype.setLocalScale=function(e,t,r){r===void 0&&(r=!0);var i=e.transformable,a=T.al(t[0],t[1],t[2]||i.localScale[2]);T.fS(a,i.localScale)||(T.JG(i.localScale,a),r&&this.dirtifyLocal(e,i))},n.prototype.setLocalRotation=function(e,t,r,i,a,o){o===void 0&&(o=!0),typeof t=="number"&&(t=ma(t,r,i,a));var s=e.transformable;Ei(s.localRotation,t),o&&this.dirtifyLocal(e,s)},n.prototype.setLocalSkew=function(e,t,r){typeof t=="number"&&(t=ya.al(t,r));var i=e.transformable;ya.JG(i.localSkew,t),this.dirtifyLocal(e,i)},n.prototype.dirtifyLocal=function(e,t){t.localDirtyFlag||(t.localDirtyFlag=!0,t.dirtyFlag||this.dirtifyWorld(e,t))},n.prototype.dirtifyWorld=function(e,t){t.dirtyFlag||this.unfreezeParentToRoot(e),this.dirtifyWorldInternal(e,t),this.dirtifyToRoot(e,!0)},n.prototype.triggerPendingEvents=function(){var e=this,t=new Set,r=function(i,a){i.isConnected&&!t.has(i.entity)&&(e.boundsChangedEvent.detail=a,e.boundsChangedEvent.target=i,i.isMutationObserved?i.dispatchEvent(e.boundsChangedEvent):i.ownerDocument.defaultView.dispatchEvent(e.boundsChangedEvent,!0),t.add(i.entity))};this.pendingEvents.forEach(function(i){var a=Ht(i,2),o=a[0],s=a[1];s.affectChildren?o.forEach(function(l){r(l,s)}):r(o,s)}),this.clearPendingEvents(),t.clear()},n.prototype.clearPendingEvents=function(){this.pendingEvents=[]},n.prototype.dirtifyToRoot=function(e,t){t===void 0&&(t=!1);var r=e;for(r.renderable&&(r.renderable.dirty=!0);r;)z2(r),r=r.parentNode;t&&e.forEach(function(i){z2(i)}),this.informDependentDisplayObjects(e),this.pendingEvents.push([e,{affectChildren:t}])},n.prototype.updateDisplayObjectDependency=function(e,t,r,i){if(t&&t!==r){var a=this.displayObjectDependencyMap.get(t);if(a&&a[e]){var o=a[e].indexOf(i);a[e].splice(o,1)}}if(r){var s=this.displayObjectDependencyMap.get(r);s||(this.displayObjectDependencyMap.set(r,{}),s=this.displayObjectDependencyMap.get(r)),s[e]||(s[e]=[]),s[e].push(i)}},n.prototype.informDependentDisplayObjects=function(e){var t=this,r=this.displayObjectDependencyMap.get(e);r&&Object.keys(r).forEach(function(i){r[i].forEach(function(a){t.dirtifyToRoot(a,!0),a.dispatchEvent(new es(Ve.ATTR_MODIFIED,a,t,t,i,es.MODIFICATION,t,t)),a.isCustomElement&&a.isConnected&&a.attributeChangedCallback&&a.attributeChangedCallback(i,t,t)})})},n.prototype.getPosition=function(e){var t=e.transformable;return ir(t.position,this.getWorldTransform(e,t))},n.prototype.getRotation=function(e){var t=e.transformable;return An(t.rotation,this.getWorldTransform(e,t))},n.prototype.getScale=function(e){var t=e.transformable;return Ye(t.scaling,this.getWorldTransform(e,t))},n.prototype.getWorldTransform=function(e,t){return t===void 0&&(t=e.transformable),!t.localDirtyFlag&&!t.dirtyFlag||(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.sync(e,t)),t.worldTransform},n.prototype.getLocalPosition=function(e){return e.transformable.localPosition},n.prototype.getLocalRotation=function(e){return e.transformable.localRotation},n.prototype.getLocalScale=function(e){return e.transformable.localScale},n.prototype.getLocalSkew=function(e){return e.transformable.localSkew},n.prototype.getLocalTransform=function(e){var t=e.transformable;return t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.localTransform},n.prototype.setLocalTransform=function(e,t){var r=ir(T.Ue(),t),i=An(Vt(),t),a=Ye(T.Ue(),t);this.setLocalScale(e,a,!1),this.setLocalPosition(e,r,!1),this.setLocalRotation(e,i,void 0,void 0,void 0,!1),this.dirtifyLocal(e,e.transformable)},n.prototype.resetLocalTransform=function(e){this.setLocalScale(e,[1,1,1]),this.setLocalPosition(e,[0,0,0]),this.setLocalEulerAngles(e,[0,0,0]),this.setLocalSkew(e,[0,0])},n.prototype.getTransformedGeometryBounds=function(e,t,r){t===void 0&&(t=!1);var i=this.getGeometryBounds(e,t);if(ur.isEmpty(i))return null;var a=r||new ur;return a.setFromTransformedAABB(i,this.getWorldTransform(e)),a},n.prototype.getGeometryBounds=function(e,t){t===void 0&&(t=!1);var r=e.geometry;r.dirty&&st.styleValueRegistry.updateGeometry(e);var i=t?r.renderBounds:r.contentBounds||null;return i||new ur},n.prototype.getBounds=function(e,t){var r=this;t===void 0&&(t=!1);var i=e.renderable;if(!i.boundsDirty&&!t&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&t&&i.renderBounds)return i.renderBounds;var a=t?i.renderBounds:i.bounds,o=this.getTransformedGeometryBounds(e,t,a),s=e.childNodes;if(s.forEach(function(u){var h=r.getBounds(u,t);h&&(o?o.add(h):(o=a||new ur,o.update(h.center,h.halfExtents)))}),o||(o=new ur),t){var l=RF(e);if(l){var c=l.parsedStyle.clipPath.getBounds(t);o?c&&(o=c.intersection(o)):o.update(c.center,c.halfExtents)}}return t?(i.renderBounds=o,i.renderBoundsDirty=!1):(i.bounds=o,i.boundsDirty=!1),o},n.prototype.getLocalBounds=function(e){if(e.parentNode){var t=Q();e.parentNode.transformable&&(t=Wt(Q(),this.getWorldTransform(e.parentNode)));var r=this.getBounds(e);if(!ur.isEmpty(r)){var i=new ur;return i.setFromTransformedAABB(r,t),i}}return this.getBounds(e)},n.prototype.getBoundingClientRect=function(e){var t,r,i,a=this.getGeometryBounds(e);ur.isEmpty(a)||(i=new ur,i.setFromTransformedAABB(a,this.getWorldTransform(e)));var o=(r=(t=e.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect();if(i){var s=Ht(i.getMin(),2),l=s[0],c=s[1],u=Ht(i.getMax(),2),h=u[0],f=u[1];return new fo(l+((o==null?void 0:o.left)||0),c+((o==null?void 0:o.top)||0),h-l,f-c)}return new fo((o==null?void 0:o.left)||0,(o==null?void 0:o.top)||0,0,0)},n.prototype.dirtifyWorldInternal=function(e,t){var r=this;if(!t.dirtyFlag){t.dirtyFlag=!0,t.frozen=!1,e.childNodes.forEach(function(a){var o=a.transformable;o.dirtyFlag||r.dirtifyWorldInternal(a,o)});var i=e.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0)}},n.prototype.syncHierarchy=function(e){var t=e.transformable;if(!t.frozen){t.frozen=!0,(t.localDirtyFlag||t.dirtyFlag)&&this.sync(e,t);for(var r=e.childNodes,i=0;i<r.length;i++)this.syncHierarchy(r[i])}},n.prototype.sync=function(e,t){if(t.localDirtyFlag&&(this.calcLocalTransform(t),t.localDirtyFlag=!1),t.dirtyFlag){var r=e.parentNode,i=r&&r.transformable;r===null||!i?kt(t.worldTransform,t.localTransform):Ut(t.worldTransform,i.worldTransform,t.localTransform),t.dirtyFlag=!1}},n.prototype.unfreezeParentToRoot=function(e){for(var t=e.parentNode;t;){var r=t.transformable;r&&(r.frozen=!1),t=t.parentNode}},n}(),ns={MetricsString:"|\xC9q\xC5",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},W2=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,x5=/[!%),.:;?\]}'""]/,b5=/[$('"]/,E5=/[!),.:;?\]}'""]/,w5=/[([{'"]/,_5=/[)\]'"?!:;,.]/,S5=/[(['"...]/,T5=/[!%),.:;?\]}'"]/,P5=/[$([{'"#]/,M5=new RegExp("".concat(x5.source,"|").concat(E5.source,"|").concat(_5.source,"|").concat(T5.source)),C5=new RegExp("".concat(b5.source,"|").concat(w5.source,"|").concat(S5.source,"|").concat(P5.source)),A5=function(){function n(e){var t=this;this.runtime=e,this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(r,i){return t.isBreakingSpace(i)?!1:!!(r&&(C5.exec(i)||M5.exec(r)))},this.trimByKinsokuShorui=function(r){var i=Xe([],Ht(r),!1),a=i[i.length-2];if(!a)return r;var o=a[a.length-1];return i[i.length-2]=a.slice(0,-1),i[i.length-1]=o+i[i.length-1],i}}return n.prototype.measureFont=function(e,t){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var r={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(t),a=this.runtime.offscreenCanvasCreator.getOrCreateContext(t,{willReadFrequently:!0});a.font=e;var o=ns.MetricsString+ns.BaselineSymbol,s=Math.ceil(a.measureText(o).width),l=Math.ceil(a.measureText(ns.BaselineSymbol).width),c=ns.HeightMultiplier*l;l=l*ns.BaselineMultiplier|0,i.width=s,i.height=c,a.fillStyle="#f00",a.fillRect(0,0,s,c),a.font=e,a.textBaseline="alphabetic",a.fillStyle="#000",a.fillText(o,0,l);var u=a.getImageData(0,0,s||1,c||1).data,h=u.length,f=s*4,d=0,p=0,v=!1;for(d=0;d<l;++d){for(var g=0;g<f;g+=4)if(u[p+g]!==255){v=!0;break}if(!v)p+=f;else break}for(r.ascent=l-d,p=h-f,v=!1,d=c;d>l;--d){for(var g=0;g<f;g+=4)if(u[p+g]!==255){v=!0;break}if(!v)p-=f;else break}return r.descent=d-l,r.fontSize=r.ascent+r.descent,this.fontMetricsCache[e]=r,r},n.prototype.measureText=function(e,t,r){var i=t.fontSize,a=i===void 0?16:i,o=t.wordWrap,s=o===void 0?!1:o,l=t.lineHeight,c=t.lineWidth,u=c===void 0?1:c,h=t.textBaseline,f=h===void 0?"alphabetic":h,d=t.textAlign,p=d===void 0?"start":d,v=t.letterSpacing,g=v===void 0?0:v,m=t.textPath;t.textPathSide,t.textPathStartOffset;var x=t.leading,_=x===void 0?0:x,S=ZF(t),b=this.measureFont(S,r);b.fontSize===0&&(b.fontSize=a,b.ascent=a);var y=this.runtime.offscreenCanvasCreator.getOrCreateContext(r);y.font=S,t.isOverflowing=!1;var E=s?this.wordWrap(e,t,r):e,w=E.split(/(?:\r\n|\r|\n)/),M=new Array(w.length),P=0;if(m){m.getTotalLength();for(var A=0;A<w.length;A++)var O=y.measureText(w[A]).width+(w[A].length-1)*g}else{for(var A=0;A<w.length;A++){var R=y.measureText(w[A]).width+(w[A].length-1)*g;M[A]=R,P=Math.max(P,R)}var O=P+u,L=l||b.fontSize+u,z=Math.max(L,b.fontSize+u)+(w.length-1)*(L+_);L+=_;var Y=0;return f==="middle"?Y=-z/2:f==="bottom"||f==="alphabetic"||f==="ideographic"?Y=-z:(f==="top"||f==="hanging")&&(Y=0),{font:S,width:O,height:z,lines:w,lineWidths:M,lineHeight:L,maxLineWidth:P,fontProperties:b,lineMetrics:M.map(function(Z,J){var mt=0;return p==="center"||p==="middle"?mt-=Z/2:(p==="right"||p==="end")&&(mt-=Z),new fo(mt-u/2,Y+J*L,Z+u,L)})}}},n.prototype.setGraphemeOnPath=function(){},n.prototype.wordWrap=function(e,t,r){var i=this,a=t.wordWrapWidth,o=a===void 0?0:a,s=t.letterSpacing,l=s===void 0?0:s,c=t.maxLines,u=c===void 0?1/0:c,h=t.textOverflow,f=this.runtime.offscreenCanvasCreator.getOrCreateContext(r),d=o+l,p="";h==="ellipsis"?p="...":h&&h!=="clip"&&(p=h);for(var v=[],g=0,m=0,x={},_=function(Y){return i.getFromCache(Y,l,x,f)},S=Array.from(p).reduce(function(Y,I){return Y+_(I)},0),b=Array.from(e),y=0;y<b.length;y++){var E=b[y],w=e[y-1],M=e[y+1],P=_(E);if(this.isNewline(E)){if(g++,g>=u){t.isOverflowing=!0;break}m=0,v[g]="";continue}if(m>0&&m+P>d){if(g+1>=u){if(t.isOverflowing=!0,S>0&&S<=d){for(var A=v[g].length,O=0,R=A,L=0;L<A;L++){var z=_(v[g][L]);if(O+z+S>d){R=L;break}O+=z}v[g]=(v[g]||"").slice(0,R)+p}break}if(g++,m=0,v[g]="",this.isBreakingSpace(E))continue;this.canBreakInLastChar(E)||(v=this.trimToBreakable(v),m=this.sumTextWidthByCache(v[g]||"",x)),this.shouldBreakByKinsokuShorui(E,M)&&(v=this.trimByKinsokuShorui(v),m+=_(w||""))}m+=P,v[g]=(v[g]||"")+E}return v.join(`
`)},n.prototype.isBreakingSpace=function(e){return typeof e!="string"?!1:ns.BreakingSpaces.indexOf(e.charCodeAt(0))>=0},n.prototype.isNewline=function(e){return typeof e!="string"?!1:ns.Newlines.indexOf(e.charCodeAt(0))>=0},n.prototype.trimToBreakable=function(e){var t=Xe([],Ht(e),!1),r=t[t.length-2],i=this.findBreakableIndex(r);if(i===-1||!r)return t;var a=r.slice(i,i+1),o=this.isBreakingSpace(a),s=i+1,l=i+(o?0:1);return t[t.length-1]+=r.slice(s,r.length),t[t.length-2]=r.slice(0,l),t},n.prototype.canBreakInLastChar=function(e){return!(e&&W2.test(e))},n.prototype.sumTextWidthByCache=function(e,t){return e.split("").reduce(function(r,i){if(!t[i])throw Error("cannot count the word without cache");return r+t[i]},0)},n.prototype.findBreakableIndex=function(e){for(var t=e.length-1;t>=0;t--)if(!W2.test(e[t]))return t;return-1},n.prototype.getFromCache=function(e,t,r,i){var a=r[e];if(typeof a!="number"){var o=e.length*t;a=i.measureText(e).width+o,r[e]=a}return a},n}(),st={},O5=function(){var n,e=new s5,t=new o5;return n={},n[At.CIRCLE]=new n5,n[At.ELLIPSE]=new r5,n[At.RECT]=e,n[At.IMAGE]=e,n[At.GROUP]=new c5,n[At.LINE]=new i5,n[At.TEXT]=new l5(st),n[At.POLYLINE]=t,n[At.POLYGON]=t,n[At.PATH]=new a5,n[At.HTML]=null,n[At.MESH]=null,n}(),N5=function(){var n,e=new vF,t=new I0;return n={},n[_t.PERCENTAGE]=null,n[_t.NUMBER]=new bF,n[_t.ANGLE]=new dF,n[_t.DEFINED_PATH]=new pF,n[_t.PAINT]=e,n[_t.COLOR]=e,n[_t.FILTER]=new gF,n[_t.LENGTH]=t,n[_t.LENGTH_PERCENTAGE]=t,n[_t.LENGTH_PERCENTAGE_12]=new mF,n[_t.LENGTH_PERCENTAGE_14]=new yF,n[_t.COORDINATE]=new I0,n[_t.OFFSET_DISTANCE]=new EF,n[_t.OPACITY_VALUE]=new wF,n[_t.PATH]=new _F,n[_t.LIST_OF_POINTS]=new SF,n[_t.SHADOW_BLUR]=new TF,n[_t.TEXT]=new PF,n[_t.TEXT_TRANSFORM]=new MF,n[_t.TRANSFORM]=new QF,n[_t.TRANSFORM_ORIGIN]=new t5,n[_t.Z_INDEX]=new e5,n[_t.MARKER]=new xF,n}(),R5=function(){return typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof D.g!="undefined"?D.g:{}};st.CameraContribution=l4,st.AnimationTimeline=null,st.EasingFunction=null,st.offscreenCanvasCreator=new d5,st.sceneGraphSelector=new g5,st.sceneGraphService=new y5(st),st.textService=new A5(st),st.geometryUpdaterFactory=O5,st.CSSPropertySyntaxFactory=N5,st.styleValueRegistry=new fF(st),st.layoutRegistry=null,st.globalThis=R5(),st.enableCSSParsing=!1,st.enableDataset=!1,st.enableStyleSyntax=!0,st.enableAttributeDashCased=!1,st.enableSizeAttenuation=!1;var U2=0;function _V(){U2=0}var V2=new es(Ve.INSERTED,null,"","","",0,"",""),H2=new es(Ve.REMOVED,null,"","","",0,"",""),k5=new Mr(Ve.DESTROY),L5=function(n){Me(e,n);function e(){var t=n.call(this)||this;return t.entity=U2++,t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.cullable={strategy:S0.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.rBushNode={aabb:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.destroyed=!1,t.style={},t.computedStyle=st.enableCSSParsing?{opacity:Je,fillOpacity:Je,strokeOpacity:Je,fill:Je,stroke:Je,transform:Je,transformOrigin:Je,visibility:Je,pointerEvents:Je,lineWidth:Je,lineCap:Je,lineJoin:Je,increasedLineWidthForHitTesting:Je,fontSize:Je,fontFamily:Je,fontStyle:Je,fontWeight:Je,fontVariant:Je,textAlign:Je,textBaseline:Je,textTransform:Je,zIndex:Je,filter:Je,shadowType:Je}:null,t.parsedStyle={},t.attributes={},t}return Object.defineProperty(e.prototype,"className",{get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"classList",{get:function(){return this.className.split(" ").filter(function(t){return t!==""})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagName",{get:function(){return this.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(t){throw new Error(cn)},e.prototype.appendChild=function(t,r){var i;if(t.destroyed)throw new Error(s4);return st.sceneGraphService.attach(t,this,r),!((i=this.ownerDocument)===null||i===void 0)&&i.defaultView&&this.ownerDocument.defaultView.mountChildren(t),this.isMutationObserved&&(V2.relatedNode=this,t.dispatchEvent(V2)),t},e.prototype.insertBefore=function(t,r){if(!r)this.appendChild(t);else{t.parentElement&&t.parentElement.removeChild(t);var i=this.childNodes.indexOf(r);i===-1?this.appendChild(t):this.appendChild(t,i)}return t},e.prototype.replaceChild=function(t,r){var i=this.childNodes.indexOf(r);return this.removeChild(r),this.appendChild(t,i),r},e.prototype.removeChild=function(t){var r;return H2.relatedNode=this,t.dispatchEvent(H2),!((r=t.ownerDocument)===null||r===void 0)&&r.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),st.sceneGraphService.detach(t),t},e.prototype.removeChildren=function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];this.removeChild(r)}},e.prototype.destroyChildren=function(){for(var t=this.childNodes.length-1;t>=0;t--){var r=this.childNodes[t];r.childNodes.length&&r.destroyChildren(),r.destroy()}},e.prototype.matches=function(t){return st.sceneGraphService.matches(t,this)},e.prototype.getElementById=function(t){return st.sceneGraphService.querySelector("#".concat(t),this)},e.prototype.getElementsByName=function(t){return st.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)},e.prototype.getElementsByClassName=function(t){return st.sceneGraphService.querySelectorAll(".".concat(t),this)},e.prototype.getElementsByTagName=function(t){return st.sceneGraphService.querySelectorAll(t,this)},e.prototype.querySelector=function(t){return st.sceneGraphService.querySelector(t,this)},e.prototype.querySelectorAll=function(t){return st.sceneGraphService.querySelectorAll(t,this)},e.prototype.closest=function(t){var r=this;do{if(st.sceneGraphService.matches(t,r))return r;r=r.parentElement}while(r!==null);return null},e.prototype.find=function(t){var r=this,i=null;return this.forEach(function(a){return a!==r&&t(a)?(i=a,!0):!1}),i},e.prototype.findAll=function(t){var r=this,i=[];return this.forEach(function(a){a!==r&&t(a)&&i.push(a)}),i},e.prototype.after=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this);r.forEach(function(o,s){var l;return(l=t.parentNode)===null||l===void 0?void 0:l.appendChild(o,a+s+1)})}},e.prototype.before=function(){for(var t,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this),o=Ht(r),s=o[0],l=o.slice(1);this.parentNode.appendChild(s,a),(t=s).after.apply(t,Xe([],Ht(l),!1))}},e.prototype.replaceWith=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.after.apply(this,Xe([],Ht(t),!1)),this.remove()},e.prototype.append=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(a){return t.appendChild(a)})},e.prototype.prepend=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r.forEach(function(a,o){return t.appendChild(a,o)})},e.prototype.replaceChildren=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,Xe([],Ht(t),!1))},e.prototype.remove=function(){return this.parentNode?this.parentNode.removeChild(this):this},e.prototype.destroy=function(){this.dispatchEvent(k5),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0},e.prototype.getGeometryBounds=function(){return st.sceneGraphService.getGeometryBounds(this)},e.prototype.getRenderBounds=function(){return st.sceneGraphService.getBounds(this,!0)},e.prototype.getBounds=function(){return st.sceneGraphService.getBounds(this)},e.prototype.getLocalBounds=function(){return st.sceneGraphService.getLocalBounds(this)},e.prototype.getBoundingClientRect=function(){return st.sceneGraphService.getBoundingClientRect(this)},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},e.prototype.getAttributeNames=function(){return Object.keys(this.attributes)},e.prototype.getAttribute=function(t){if(m4(t))return st.enableCSSParsing?null:void 0;var r=this.attributes[t];if(r===void 0){if(st.enableAttributeDashCased){var i=x0(t);r=this.attributes[i]}return st.enableCSSParsing&&sn(r)?null:r}else return r},e.prototype.hasAttribute=function(t){return this.getAttributeNames().includes(t)},e.prototype.hasAttributes=function(){return!!this.getAttributeNames().length},e.prototype.removeAttribute=function(t){this.setAttribute(t,null),delete this.attributes[t]},e.prototype.setAttribute=function(t,r,i,a){this.attributes[t]=r},e.prototype.getAttributeNS=function(t,r){throw new Error(cn)},e.prototype.getAttributeNode=function(t){throw new Error(cn)},e.prototype.getAttributeNodeNS=function(t,r){throw new Error(cn)},e.prototype.hasAttributeNS=function(t,r){throw new Error(cn)},e.prototype.removeAttributeNS=function(t,r){throw new Error(cn)},e.prototype.removeAttributeNode=function(t){throw new Error(cn)},e.prototype.setAttributeNS=function(t,r,i){throw new Error(cn)},e.prototype.setAttributeNode=function(t){throw new Error(cn)},e.prototype.setAttributeNodeNS=function(t){throw new Error(cn)},e.prototype.toggleAttribute=function(t,r){throw new Error(cn)},e}(Qn);function Qe(n){return!!(n!=null&&n.nodeName)}var Y2=st.globalThis.Proxy?st.globalThis.Proxy:function(){},Da=new es(Ve.ATTR_MODIFIED,null,null,null,null,es.MODIFICATION,null,null),I5={opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",zIndex:"",filter:"",shadowType:""},D5={fill:_f,stroke:_f,transform:[],zIndex:0,filter:[],shadowType:"outer",miterLimit:10},B5=["opacity","fillOpacity","strokeOpacity","transformOrigin","visibility","pointerEvents","lineWidth","lineCap","lineJoin","increasedLineWidthForHitTesting"],F5=Xe(Xe([],Ht(B5),!1),["fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform"],!1),X2="data-",zi=function(n){Me(e,n);function e(t){var r=n.call(this)||this;return r.isCustomElement=!1,r.isMutationObserved=!1,r.activeAnimations=[],r.config=t,r.id=r.config.id||"",r.name=r.config.name||"",(r.config.className||r.config.class)&&(r.className=r.config.className||r.config.class),r.nodeName=r.config.type||At.GROUP,st.enableCSSParsing?(Object.assign(r.attributes,I5),Object.assign(r.parsedStyle,D5,r.config.initialParsedStyle)):r.config.initialParsedStyle&&Object.assign(r.parsedStyle,r.config.initialParsedStyle),r.initAttributes(r.config.style),st.enableDataset&&(r.dataset=new Y2({},{get:function(i,a){var o="".concat(X2).concat(i2(a));return i[o]!==void 0?i[o]:r.getAttribute(o)},set:function(i,a,o){return r.setAttribute("".concat(X2).concat(i2(a)),o),!0}})),st.enableStyleSyntax&&(r.style=new Y2({setProperty:function(i,a){r.setAttribute(i,a)},getPropertyValue:function(i){return r.getAttribute(i)},removeProperty:function(i){r.removeAttribute(i)},item:function(){return""}},{get:function(i,a){return i[a]!==void 0?i[a]:r.getAttribute(a)},set:function(i,a,o){return r.setAttribute(a,o),!0}})),r}return e.prototype.destroy=function(){n.prototype.destroy.call(this),this.getAnimations().forEach(function(t){t.cancel()})},e.prototype.cloneNode=function(t,r){var i=te({},this.attributes);for(var a in i){var o=i[a];Qe(o)&&a!=="clipPath"&&a!=="offsetPath"&&a!=="textPath"&&(i[a]=o.cloneNode(t)),r&&(i[a]=r(a,o))}var s=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:i});return s.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(l){if(!l.style.isMarker){var c=l.cloneNode(t);s.appendChild(c)}}),s},e.prototype.initAttributes=function(t){t===void 0&&(t={});var r=this.renderable,i={forceUpdateGeometry:!0};st.enableCSSParsing&&(i.usedAttributes=F5);var a=t;if(st.enableAttributeDashCased){a={};for(var o in t){var s=x0(o);a[s]=t[o]}}st.styleValueRegistry.processProperties(this,a,i),r.dirty=!0},e.prototype.setAttribute=function(t,r,i,a){i===void 0&&(i=!1),a===void 0&&(a=!0),st.enableAttributeDashCased&&(t=x0(t)),!ln(r)&&(i||r!==this.attributes[t])&&(this.internalSetAttribute(t,r,{memoize:a}),n.prototype.setAttribute.call(this,t,r))},e.prototype.internalSetAttribute=function(t,r,i){var a;i===void 0&&(i={});var o=this.renderable,s=this.attributes[t],l=this.parsedStyle[t];st.styleValueRegistry.processProperties(this,(a={},a[t]=r,a),i),o.dirty=!0;var c=this.parsedStyle[t];this.isConnected&&(Da.relatedNode=this,Da.prevValue=s,Da.newValue=r,Da.attrName=t,Da.prevParsedValue=l,Da.newParsedValue=c,this.isMutationObserved?this.dispatchEvent(Da):(Da.target=this,this.ownerDocument.defaultView.dispatchEvent(Da,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&this.attributeChangedCallback&&this.attributeChangedCallback(t,s,r,l,c)},e.prototype.getBBox=function(){var t=this.getBounds(),r=Ht(t.getMin(),2),i=r[0],a=r[1],o=Ht(t.getMax(),2),s=o[0],l=o[1];return new fo(i,a,s-i,l-a)},e.prototype.setOrigin=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),st.sceneGraphService.setOrigin(this,jr(t,r,i)),this},e.prototype.getOrigin=function(){return st.sceneGraphService.getOrigin(this)},e.prototype.setPosition=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),st.sceneGraphService.setPosition(this,jr(t,r,i)),this},e.prototype.setLocalPosition=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),st.sceneGraphService.setLocalPosition(this,jr(t,r,i)),this},e.prototype.translate=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),st.sceneGraphService.translate(this,jr(t,r,i)),this},e.prototype.translateLocal=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),st.sceneGraphService.translateLocal(this,jr(t,r,i)),this},e.prototype.getPosition=function(){return st.sceneGraphService.getPosition(this)},e.prototype.getLocalPosition=function(){return st.sceneGraphService.getLocalPosition(this)},e.prototype.scale=function(t,r,i){return this.scaleLocal(t,r,i)},e.prototype.scaleLocal=function(t,r,i){return typeof t=="number"&&(r=r||t,i=i||t,t=jr(t,r,i)),st.sceneGraphService.scaleLocal(this,t),this},e.prototype.setLocalScale=function(t,r,i){return typeof t=="number"&&(r=r||t,i=i||t,t=jr(t,r,i)),st.sceneGraphService.setLocalScale(this,t),this},e.prototype.getLocalScale=function(){return st.sceneGraphService.getLocalScale(this)},e.prototype.getScale=function(){return st.sceneGraphService.getScale(this)},e.prototype.getEulerAngles=function(){var t=Ht(p0(T.Ue(),st.sceneGraphService.getWorldTransform(this)),3),r=t[2];return Fi(r)},e.prototype.getLocalEulerAngles=function(){var t=Ht(p0(T.Ue(),st.sceneGraphService.getLocalRotation(this)),3),r=t[2];return Fi(r)},e.prototype.setEulerAngles=function(t){return st.sceneGraphService.setEulerAngles(this,0,0,t),this},e.prototype.setLocalEulerAngles=function(t){return st.sceneGraphService.setLocalEulerAngles(this,0,0,t),this},e.prototype.rotateLocal=function(t,r,i){return sn(r)&&sn(i)?st.sceneGraphService.rotateLocal(this,0,0,t):st.sceneGraphService.rotateLocal(this,t,r,i),this},e.prototype.rotate=function(t,r,i){return sn(r)&&sn(i)?st.sceneGraphService.rotate(this,0,0,t):st.sceneGraphService.rotate(this,t,r,i),this},e.prototype.setRotation=function(t,r,i,a){return st.sceneGraphService.setRotation(this,t,r,i,a),this},e.prototype.setLocalRotation=function(t,r,i,a){return st.sceneGraphService.setLocalRotation(this,t,r,i,a),this},e.prototype.setLocalSkew=function(t,r){return st.sceneGraphService.setLocalSkew(this,t,r),this},e.prototype.getRotation=function(){return st.sceneGraphService.getRotation(this)},e.prototype.getLocalRotation=function(){return st.sceneGraphService.getLocalRotation(this)},e.prototype.getLocalSkew=function(){return st.sceneGraphService.getLocalSkew(this)},e.prototype.getLocalTransform=function(){return st.sceneGraphService.getLocalTransform(this)},e.prototype.getWorldTransform=function(){return st.sceneGraphService.getWorldTransform(this)},e.prototype.setLocalTransform=function(t){return st.sceneGraphService.setLocalTransform(this,t),this},e.prototype.resetLocalTransform=function(){st.sceneGraphService.resetLocalTransform(this)},e.prototype.getAnimations=function(){return this.activeAnimations},e.prototype.animate=function(t,r){var i,a=(i=this.ownerDocument)===null||i===void 0?void 0:i.timeline;return a?a.play(this,t,r):null},e.prototype.isVisible=function(){var t,r;return st.enableCSSParsing?((t=this.parsedStyle)===null||t===void 0?void 0:t.visibility)==="visible":((r=this.parsedStyle)===null||r===void 0?void 0:r.visibility)!=="hidden"},Object.defineProperty(e.prototype,"interactive",{get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"},enumerable:!1,configurable:!0}),e.prototype.isInteractive=function(){var t;return((t=this.parsedStyle)===null||t===void 0?void 0:t.pointerEvents)!=="none"},e.prototype.isCulled=function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)},e.prototype.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,Xe([],Ht(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})),!1))+1),this},e.prototype.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,Xe([],Ht(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})),!1))-1),this},e.prototype.getConfig=function(){return this.config},e.prototype.attr=function(){for(var t=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=Ht(r,2),o=a[0],s=a[1];return o?xf(o)?(Object.keys(o).forEach(function(l){t.setAttribute(l,o[l])}),this):r.length===2?(this.setAttribute(o,s),this):this.attributes[o]:this.attributes},e.prototype.getMatrix=function(t){var r=t||this.getWorldTransform(),i=Ht(ir(T.Ue(),r),2),a=i[0],o=i[1],s=Ht(Ye(T.Ue(),r),2),l=s[0],c=s[1],u=An(Vt(),r),h=Ht(p0(T.Ue(),u),3),f=h[0],d=h[2];return t4(f||d,a,o,l,c)},e.prototype.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},e.prototype.setMatrix=function(t){var r=Ht(JE(t),5),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];this.setEulerAngles(l).setPosition(i,a).setLocalScale(o,s)},e.prototype.setLocalMatrix=function(t){var r=Ht(JE(t),5),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];this.setLocalEulerAngles(l).setLocalPosition(i,a).setLocalScale(o,s)},e.prototype.show=function(){st.enableCSSParsing?this.style.visibility="visible":this.forEach(function(t){t.style.visibility="visible"})},e.prototype.hide=function(){st.enableCSSParsing?this.style.visibility="hidden":this.forEach(function(t){t.style.visibility="hidden"})},e.prototype.getCount=function(){return this.childElementCount},e.prototype.getParent=function(){return this.parentElement},e.prototype.getChildren=function(){return this.children},e.prototype.getFirst=function(){return this.firstElementChild},e.prototype.getLast=function(){return this.lastElementChild},e.prototype.getChildByIndex=function(t){return this.children[t]||null},e.prototype.add=function(t,r){return this.appendChild(t,r)},e.prototype.set=function(t,r){this.config[t]=r},e.prototype.get=function(t){return this.config[t]},e.prototype.moveTo=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(t,r,i),this},e.prototype.move=function(t,r,i){return r===void 0&&(r=0),i===void 0&&(i=0),this.setPosition(t,r,i),this},e.prototype.setZIndex=function(t){return this.style.zIndex=t,this},e}(L5),G5=function(n){Me(e,n);function e(t){return t===void 0&&(t={}),n.call(this,te({type:At.CIRCLE},t))||this}return e}(zi),SV=function(n){Me(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=co(t,["style"]);return r=n.call(this,te({style:st.enableCSSParsing?te({},i):te({},i)},a))||this,r.isCustomElement=!0,r}return e}(zi),z5=function(n){Me(e,n);function e(t){return t===void 0&&(t={}),n.call(this,te({type:At.ELLIPSE},t))||this}return e}(zi),Y0=function(n){Me(e,n);function e(t){return t===void 0&&(t={}),n.call(this,te({type:At.GROUP},t))||this}return e}(zi),W5=function(n){Me(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=co(t,["style"]);return r=n.call(this,te({type:At.HTML,style:st.enableCSSParsing?te({x:"",y:"",width:"auto",height:"auto",innerHTML:""},i):te({},i)},a))||this,r.cullable.enable=!1,r}return e.prototype.getDomElement=function(){return this.parsedStyle.$el},e.prototype.getBoundingClientRect=function(){if(this.parsedStyle.$el){var t=this.ownerDocument.defaultView.getCamera().getOrthoMatrix(),r=this.parsedStyle.$el.getBoundingClientRect();return fo.applyTransform(r,Wt(Q(),t))}else{var i=this.parsedStyle,a=i.x,o=i.y,s=i.width,l=i.height;return new fo(a,o,s,l)}},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.getBounds=function(){var t,r,i=this.getBoundingClientRect(),a=(r=(t=this.ownerDocument)===null||t===void 0?void 0:t.defaultView)===null||r===void 0?void 0:r.getContextService().getBoundingClientRect(),o=new ur,s=i.left-((a==null?void 0:a.left)||0),l=i.top-((a==null?void 0:a.top)||0);return o.setMinMax([s,l,0],[s+i.width,l+i.height,0]),o},e.prototype.getLocalBounds=function(){if(this.parentNode){var t=Wt(Q(),this.parentNode.getWorldTransform()),r=this.getBounds();if(!ur.isEmpty(r)){var i=new ur;return i.setFromTransformedAABB(r,t),i}}return this.getBounds()},e}(zi),U5=function(n){Me(e,n);function e(t){return t===void 0&&(t={}),n.call(this,te({type:At.IMAGE},t))||this}return e}(zi),V5=function(n){Me(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=co(t,["style"]);r=n.call(this,te({type:At.LINE,style:te({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},a))||this,r.markerStartAngle=0,r.markerEndAngle=0;var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd;return s&&Qe(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),l&&Qe(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="x1"||t==="y1"||t==="x2"||t==="y2"||t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&Qe(a)&&(this.markerStartAngle=0,a.remove()),o&&Qe(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"&&(a&&Qe(a)&&(this.markerEndAngle=0,a.remove()),o&&Qe(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1)))},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=r.x1,c=r.x2,u=r.y1,h=r.y2,f=t?i:a;if(!(!f||!Qe(f))){var d=0,p,v,g,m,x,_;t?(g=l,m=u,p=c-l,v=h-u,x=o||0,_=this.markerStartAngle):(g=c,m=h,p=l-c,v=u-h,x=s||0,_=this.markerEndAngle),d=Math.atan2(v,p),f.setLocalEulerAngles(d*180/Math.PI+_),f.setLocalPosition(g+Math.cos(d)*x,m+Math.sin(d)*x)}},e.prototype.getPoint=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle,a=i.x1,o=i.y1,s=i.x2,l=i.y2,c=kr(a,o,s,l,t),u=c.x,h=c.y,f=T.fF(T.Ue(),T.al(u,h,0),r?this.getWorldTransform():this.getLocalTransform());return new hr(f[0],f[1])},e.prototype.getPointAtLength=function(t,r){return r===void 0&&(r=!1),this.getPoint(t/this.getTotalLength(),r)},e.prototype.getTotalLength=function(){var t=this.parsedStyle,r=t.x1,i=t.y1,a=t.x2,o=t.y2;return ps(r,i,a,o)},e}(zi),H5=function(n){Me(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=co(t,["style"]);r=n.call(this,te({type:At.PATH,style:st.enableCSSParsing?te({d:"",miterLimit:""},i):te({},i),initialParsedStyle:st.enableCSSParsing?null:{miterLimit:4,d:te({},o2)}},a))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd,c=o.markerMid;return s&&Qe(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),c&&Qe(c)&&r.placeMarkerMid(c),l&&Qe(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="d"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&Qe(a)&&(this.markerStartAngle=0,a.remove()),o&&Qe(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"?(a&&Qe(a)&&(this.markerEndAngle=0,a.remove()),o&&Qe(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(o)},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=t?i:a;if(!(!l||!Qe(l))){var c=0,u,h,f,d,p,v;if(t){var g=Ht(this.getStartTangent(),2),m=g[0],x=g[1];f=x[0],d=x[1],u=m[0]-x[0],h=m[1]-x[1],p=o||0,v=this.markerStartAngle}else{var _=Ht(this.getEndTangent(),2),m=_[0],x=_[1];f=x[0],d=x[1],u=m[0]-x[0],h=m[1]-x[1],p=s||0,v=this.markerEndAngle}c=Math.atan2(h,u),l.setLocalEulerAngles(c*180/Math.PI+v),l.setLocalPosition(f+Math.cos(c)*p,d+Math.sin(c)*p)}},e.prototype.placeMarkerMid=function(t){var r=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(c){c.remove()}),t&&Qe(t))for(var i=1;i<r.length-1;i++){var a=Ht(r[i].currentPoint,2),o=a[0],s=a[1],l=i===1?t:t.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(o,s)}},e.prototype.getTotalLength=function(){return v2(this)},e.prototype.getPointAtLength=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle.d.absolutePath,a=YB(i,t),o=a.x,s=a.y,l=T.fF(T.Ue(),T.al(o,s,0),r?this.getWorldTransform():this.getLocalTransform());return new hr(l[0],l[1])},e.prototype.getPoint=function(t,r){return r===void 0&&(r=!1),this.getPointAtLength(t*v2(this),r)},e.prototype.getStartTangent=function(){var t=this.parsedStyle.d.segments,r=[];if(t.length>1){var i=t[0].currentPoint,a=t[1].currentPoint,o=t[1].startTangent;r=[],o?(r.push([i[0]-o[0],i[1]-o[1]]),r.push([i[0],i[1]])):(r.push([a[0],a[1]]),r.push([i[0],i[1]]))}return r},e.prototype.getEndTangent=function(){var t=this.parsedStyle.d.segments,r=t.length,i=[];if(r>1){var a=t[r-2].currentPoint,o=t[r-1].currentPoint,s=t[r-1].endTangent;i=[],s?(i.push([o[0]-s[0],o[1]-s[1]]),i.push([o[0],o[1]])):(i.push([a[0],a[1]]),i.push([o[0],o[1]]))}return i},e}(zi),j2=function(n){Me(e,n);function e(t){t===void 0&&(t={});var r=this,i=t.style,a=co(t,["style"]);r=n.call(this,te({type:At.POLYGON,style:st.enableCSSParsing?te({points:"",miterLimit:"",isClosed:!0},i):te({},i),initialParsedStyle:st.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},a))||this,r.markerStartAngle=0,r.markerEndAngle=0,r.markerMidList=[];var o=r.parsedStyle,s=o.markerStart,l=o.markerEnd,c=o.markerMid;return s&&Qe(s)&&(r.markerStartAngle=s.getLocalEulerAngles(),r.appendChild(s)),c&&Qe(c)&&r.placeMarkerMid(c),l&&Qe(l)&&(r.markerEndAngle=l.getLocalEulerAngles(),r.appendChild(l)),r.transformMarker(!0),r.transformMarker(!1),r}return e.prototype.attributeChangedCallback=function(t,r,i,a,o){t==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):t==="markerStartOffset"||t==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):t==="markerStart"?(a&&Qe(a)&&(this.markerStartAngle=0,a.remove()),o&&Qe(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):t==="markerEnd"?(a&&Qe(a)&&(this.markerEndAngle=0,a.remove()),o&&Qe(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):t==="markerMid"&&this.placeMarkerMid(o)},e.prototype.transformMarker=function(t){var r=this.parsedStyle,i=r.markerStart,a=r.markerEnd,o=r.markerStartOffset,s=r.markerEndOffset,l=r.points,c=(l||{}).points,u=t?i:a;if(!(!u||!Qe(u)||!c)){var h=0,f,d,p,v,g,m;if(p=c[0][0],v=c[0][1],t)f=c[1][0]-c[0][0],d=c[1][1]-c[0][1],g=o||0,m=this.markerStartAngle;else{var x=c.length;this.parsedStyle.isClosed?(f=c[x-1][0]-c[0][0],d=c[x-1][1]-c[0][1]):(p=c[x-1][0],v=c[x-1][1],f=c[x-2][0]-c[x-1][0],d=c[x-2][1]-c[x-1][1]),g=s||0,m=this.markerEndAngle}h=Math.atan2(d,f),u.setLocalEulerAngles(h*180/Math.PI+m),u.setLocalPosition(p+Math.cos(h)*g,v+Math.sin(h)*g)}},e.prototype.placeMarkerMid=function(t){var r=this.parsedStyle.points,i=(r||{}).points;if(this.markerMidList.forEach(function(c){c.remove()}),this.markerMidList=[],t&&Qe(t)&&i)for(var a=1;a<(this.parsedStyle.isClosed?i.length:i.length-1);a++){var o=i[a][0],s=i[a][1],l=a===1?t:t.cloneNode(!0);this.markerMidList.push(l),this.appendChild(l),l.setLocalPosition(o,s)}},e}(zi),Y5=function(n){Me(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=co(t,["style"]);return n.call(this,te({type:At.POLYLINE,style:st.enableCSSParsing?te({points:"",miterLimit:"",isClosed:!1},r):te({},r),initialParsedStyle:st.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i))||this}return e.prototype.getTotalLength=function(){return W4(this)},e.prototype.getPointAtLength=function(t,r){return r===void 0&&(r=!1),this.getPoint(t/this.getTotalLength(),r)},e.prototype.getPoint=function(t,r){r===void 0&&(r=!1);var i=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var a=[],o=0,s,l,c=this.getTotalLength();i.forEach(function(g,m){i[m+1]&&(s=[0,0],s[0]=o/c,l=ps(g[0],g[1],i[m+1][0],i[m+1][1]),o+=l,s[1]=o/c,a.push(s))}),this.parsedStyle.points.segments=a}var u=0,h=0;this.parsedStyle.points.segments.forEach(function(g,m){t>=g[0]&&t<=g[1]&&(u=(t-g[0])/(g[1]-g[0]),h=m)});var f=kr(i[h][0],i[h][1],i[h+1][0],i[h+1][1],u),d=f.x,p=f.y,v=T.fF(T.Ue(),T.al(d,p,0),r?this.getWorldTransform():this.getLocalTransform());return new hr(v[0],v[1])},e.prototype.getStartTangent=function(){var t=this.parsedStyle.points.points,r=[];return r.push([t[1][0],t[1][1]]),r.push([t[0][0],t[0][1]]),r},e.prototype.getEndTangent=function(){var t=this.parsedStyle.points.points,r=t.length-1,i=[];return i.push([t[r-1][0],t[r-1][1]]),i.push([t[r][0],t[r][1]]),i},e}(j2),X5=function(n){Me(e,n);function e(t){return t===void 0&&(t={}),n.call(this,te({type:At.RECT},t))||this}return e}(zi),$2=function(n){Me(e,n);function e(t){t===void 0&&(t={});var r=t.style,i=co(t,["style"]);return n.call(this,te({type:At.TEXT,style:st.enableCSSParsing?te({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:"",lineHeight:"",miterLimit:"",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},r):te({fill:"black"},r)},i))||this}return e.prototype.getComputedTextLength=function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.maxLineWidth)||0},e.prototype.getLineBoundingRects=function(){var t;return this.getGeometryBounds(),((t=this.parsedStyle.metrics)===null||t===void 0?void 0:t.lineMetrics)||[]},e.prototype.isOverflowing=function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing},e}(zi),j5=function(){function n(){this.registry={},this.define(At.CIRCLE,G5),this.define(At.ELLIPSE,z5),this.define(At.RECT,X5),this.define(At.IMAGE,U5),this.define(At.LINE,V5),this.define(At.GROUP,Y0),this.define(At.PATH,H5),this.define(At.POLYGON,j2),this.define(At.POLYLINE,Y5),this.define(At.TEXT,$2),this.define(At.HTML,W5)}return n.prototype.define=function(e,t){this.registry[e]=t},n.prototype.get=function(e){return this.registry[e]},n}(),TV={number:function(n){return new De(n)},percent:function(n){return new De(n,"%")},px:function(n){return new De(n,"px")},em:function(n){return new De(n,"em")},rem:function(n){return new De(n,"rem")},deg:function(n){return new De(n,"deg")},grad:function(n){return new De(n,"grad")},rad:function(n){return new De(n,"rad")},turn:function(n){return new De(n,"turn")},s:function(n){return new De(n,"s")},ms:function(n){return new De(n,"ms")},registerProperty:function(n){var e=n.name,t=n.inherits,r=n.interpolable,i=n.initialValue,a=n.syntax;st.styleValueRegistry.registerMetadata({n:e,inh:t,int:r,d:i,syntax:a})},registerLayout:function(n,e){st.layoutRegistry.registerLayout(n,e)}},$5=function(n){Me(e,n);function e(){var t=n.call(this)||this;t.defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new st.AnimationTimeline(t)}catch(i){}var r={};return L0.forEach(function(i){var a=i.n,o=i.inh,s=i.d;o&&s&&(r[a]=ll(s)?s(At.GROUP):s)}),t.documentElement=new Y0({id:"g-root",style:r}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),e.prototype.createElement=function(t,r){if(t==="svg")return this.documentElement;var i=this.defaultView.customElements.get(t);i||(console.warn("Unsupported tagName: ",t),i=t==="tspan"?$2:Y0);var a=new i(r);return a.ownerDocument=this,a},e.prototype.createElementNS=function(t,r,i){return this.createElement(r,i)},e.prototype.cloneNode=function(t){throw new Error(cn)},e.prototype.destroy=function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(t){}},e.prototype.elementsFromBBox=function(t,r,i,a){var o=this.defaultView.context.rBushRoot,s=o.search({minX:t,minY:r,maxX:i,maxY:a}),l=[];return s.forEach(function(c){var u=c.displayObject,h=u.parsedStyle.pointerEvents,f=h===void 0?"auto":h,d=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(f);(!d||d&&u.isVisible())&&!u.isCulled()&&u.isInteractive()&&l.push(u)}),l.sort(function(c,u){return u.sortable.renderOrder-c.sortable.renderOrder}),l},e.prototype.elementFromPointSync=function(t,r){var i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height;if(a<0||o<0||a>l||o>c)return null;var u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]}).picked;return d&&d[0]||this.documentElement},e.prototype.elementFromPoint=function(t,r){return ff(this,void 0,void 0,function(){var i,a,o,s,l,c,u,h,f,d;return df(this,function(p){switch(p.label){case 0:return i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height,a<0||o<0||a>l||o>c?[2,null]:(u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]})]);case 1:return d=p.sent().picked,[2,d&&d[0]||this.documentElement]}})})},e.prototype.elementsFromPointSync=function(t,r){var i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height;if(a<0||o<0||a>l||o>c)return[];var u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]}).picked;return d[d.length-1]!==this.documentElement&&d.push(this.documentElement),d},e.prototype.elementsFromPoint=function(t,r){return ff(this,void 0,void 0,function(){var i,a,o,s,l,c,u,h,f,d;return df(this,function(p){switch(p.label){case 0:return i=this.defaultView.canvas2Viewport({x:t,y:r}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,c=s.height,a<0||o<0||a>l||o>c?[2,[]]:(u=this.defaultView.viewport2Client({x:a,y:o}),h=u.x,f=u.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:t,y:r,viewportX:a,viewportY:o,clientX:h,clientY:f},picked:[]})]);case 1:return d=p.sent().picked,d[d.length-1]!==this.documentElement&&d.push(this.documentElement),[2,d]}})})},e.prototype.appendChild=function(t,r){throw new Error(ol)},e.prototype.insertBefore=function(t,r){throw new Error(ol)},e.prototype.removeChild=function(t,r){throw new Error(ol)},e.prototype.replaceChild=function(t,r,i){throw new Error(ol)},e.prototype.append=function(){throw new Error(ol)},e.prototype.prepend=function(){throw new Error(ol)},e.prototype.getElementById=function(t){return this.documentElement.getElementById(t)},e.prototype.getElementsByName=function(t){return this.documentElement.getElementsByName(t)},e.prototype.getElementsByTagName=function(t){return this.documentElement.getElementsByTagName(t)},e.prototype.getElementsByClassName=function(t){return this.documentElement.getElementsByClassName(t)},e.prototype.querySelector=function(t){return this.documentElement.querySelector(t)},e.prototype.querySelectorAll=function(t){return this.documentElement.querySelectorAll(t)},e.prototype.find=function(t){return this.documentElement.find(t)},e.prototype.findAll=function(t){return this.documentElement.findAll(t)},e}(Qn),K5=function(){function n(e){this.strategies=e}return n.prototype.apply=function(e){var t=e.camera,r=e.renderingService,i=e.renderingContext,a=this.strategies;r.hooks.cull.tap(n.tag,function(o){if(o){var s=o.cullable;return a.length===0?s.visible=i.unculledEntities.indexOf(o.entity)>-1:s.visible=a.every(function(l){return l.isVisible(t,o)}),!o.isCulled()&&o.isVisible()?o:(o.dispatchEvent(new Mr(Ve.CULLED)),null)}return o}),r.hooks.afterRender.tap(n.tag,function(o){o.cullable.visibilityPlaneMask=-1})},n.tag="Culling",n}(),Z5=function(){function n(){var e=this;this.autoPreventDefault=!1,this.rootPointerEvent=new V0(null),this.rootWheelEvent=new H0(null),this.onPointerMove=function(t){var r,i,a,o,s=(o=(a=e.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||o===void 0?void 0:o.defaultView;if(!(s.supportsTouchEvents&&t.pointerType==="touch")){var l=e.normalizeToPointerEvent(t,s);try{for(var c=ca(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=e.bootstrapEvent(e.rootPointerEvent,h,s,t);e.context.eventService.mapEvent(f)}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var r,i,a,o,s=(o=(a=e.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||o===void 0?void 0:o.defaultView,l=e.normalizeToPointerEvent(t,s);try{for(var c=ca(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=e.bootstrapEvent(e.rootPointerEvent,h,s,t);e.context.eventService.mapEvent(f)}}catch(d){r={error:d}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}e.setCursor(e.context.eventService.cursor)}}return n.prototype.apply=function(e){var t=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(a){var o=t.context.renderingService.hooks.pickSync.call({position:a,picked:[],topmost:!0}).picked;return o[0]||null}),r.hooks.pointerWheel.tap(n.tag,function(a){var o=t.normalizeWheelEvent(a);t.context.eventService.mapEvent(o)}),r.hooks.pointerDown.tap(n.tag,function(a){var o,s;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var l=t.normalizeToPointerEvent(a,i);if(t.autoPreventDefault&&l[0].isNormalized){var c=a.cancelable||!("cancelable"in a);c&&a.preventDefault()}try{for(var u=ca(l),h=u.next();!h.done;h=u.next()){var f=h.value,d=t.bootstrapEvent(t.rootPointerEvent,f,i,a);t.context.eventService.mapEvent(d)}}catch(p){o={error:p}}finally{try{h&&!h.done&&(s=u.return)&&s.call(u)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerUp.tap(n.tag,function(a){var o,s;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var l=t.context.contextService.getDomElement(),c=t.context.eventService.isNativeEventFromCanvas(l,a),u=c?"":"outside",h=t.normalizeToPointerEvent(a,i);try{for(var f=ca(h),d=f.next();!d.done;d=f.next()){var p=d.value,v=t.bootstrapEvent(t.rootPointerEvent,p,i,a);v.type+=u,t.context.eventService.mapEvent(v)}}catch(g){o={error:g}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)}}),r.hooks.pointerMove.tap(n.tag,this.onPointerMove),r.hooks.pointerOver.tap(n.tag,this.onPointerMove),r.hooks.pointerOut.tap(n.tag,this.onPointerMove),r.hooks.click.tap(n.tag,this.onClick),r.hooks.pointerCancel.tap(n.tag,function(a){var o,s,l=t.normalizeToPointerEvent(a,i);try{for(var c=ca(l),u=c.next();!u.done;u=c.next()){var h=u.value,f=t.bootstrapEvent(t.rootPointerEvent,h,i,a);t.context.eventService.mapEvent(f)}}catch(d){o={error:d}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}t.setCursor(t.context.eventService.cursor)})},n.prototype.bootstrapEvent=function(e,t,r,i){e.view=r,e.originalEvent=null,e.nativeEvent=i,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);var a=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),o=a.x,s=a.y;e.viewport.x=o,e.viewport.y=s;var l=this.context.eventService.viewport2Canvas(e.viewport),c=l.x,u=l.y;return e.canvas.x=c,e.canvas.y=u,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=i.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=DF[e.type]||e.type),e},n.prototype.normalizeWheelEvent=function(e){var t=this.rootWheelEvent;this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;var r=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),i=r.x,a=r.y;t.viewport.x=i,t.viewport.y=a;var o=this.context.eventService.viewport2Canvas(t.viewport),s=o.x,l=o.y;return t.canvas.x=s,t.canvas.y=l,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.nativeEvent=e,t.type=e.type,t},n.prototype.transferMouseData=function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=F0.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null},n.prototype.setCursor=function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||"default")},n.prototype.normalizeToPointerEvent=function(e,t){var r=[];if(t.isTouchEvent(e))for(var i=0;i<e.changedTouches.length;i++){var a=e.changedTouches[i];ln(a.button)&&(a.button=0),ln(a.buttons)&&(a.buttons=1),ln(a.isPrimary)&&(a.isPrimary=e.touches.length===1&&e.type==="touchstart"),ln(a.width)&&(a.width=a.radiusX||1),ln(a.height)&&(a.height=a.radiusY||1),ln(a.tiltX)&&(a.tiltX=0),ln(a.tiltY)&&(a.tiltY=0),ln(a.pointerType)&&(a.pointerType="touch"),ln(a.pointerId)&&(a.pointerId=a.identifier||0),ln(a.pressure)&&(a.pressure=a.force||.5),ln(a.twist)&&(a.twist=0),ln(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,a.type=e.type,r.push(a)}else if(t.isMouseEvent(e)){var o=e;ln(o.isPrimary)&&(o.isPrimary=!0),ln(o.width)&&(o.width=1),ln(o.height)&&(o.height=1),ln(o.tiltX)&&(o.tiltX=0),ln(o.tiltY)&&(o.tiltY=0),ln(o.pointerType)&&(o.pointerType="mouse"),ln(o.pointerId)&&(o.pointerId=IF),ln(o.pressure)&&(o.pressure=.5),ln(o.twist)&&(o.twist=0),ln(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,r.push(o)}else r.push(e);return r},n.tag="Event",n}(),q5=[At.CIRCLE,At.ELLIPSE,At.IMAGE,At.RECT,At.LINE,At.POLYLINE,At.POLYGON,At.TEXT,At.PATH,At.HTML],J5=function(){function n(){}return n.prototype.isVisible=function(e,t){var r,i,a=t.cullable;if(!a.enable)return!0;var o=t.getRenderBounds();if(ur.isEmpty(o))return!1;var s=e.getFrustum(),l=(i=(r=t.parentNode)===null||r===void 0?void 0:r.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return a.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,o,l||ho.INDETERMINATE,s.planes),a.visible=a.visibilityPlaneMask!==ho.OUTSIDE,a.visible},n.prototype.computeVisibilityWithPlaneMask=function(e,t,r,i){if(r===ho.OUTSIDE||r===ho.INSIDE)return r;for(var a=ho.INSIDE,o=q5.indexOf(e.nodeName)>-1,s=0,l=i.length;s<l;++s){var c=1<<s;if(r&c&&!(o&&(s===4||s===5))){var u=i[s],h=u.normal,f=u.distance;if(T.AK(h,t.getPositiveFarPoint(i[s]))+f<0)return ho.OUTSIDE;T.AK(h,t.getNegativeFarPoint(i[s]))+f<0&&(a|=c)}}return a},n}(),Q5=function(){function n(){this.toSync=new Set,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return n.prototype.apply=function(e){var t=this,r,i=e.renderingService,a=e.renderingContext,o=e.rBushRoot,s=a.root.ownerDocument.defaultView;this.rBush=o;var l=function(d){var p=d.target;p.renderable.dirty=!0,i.dirtify()},c=function(d){var p=d.detail.affectChildren,v=d.target;p&&v.forEach(function(m){t.toSync.add(m)});for(var g=v;g;)g.renderable&&t.toSync.add(g),g=g.parentElement;i.dirtify()},u=function(d){var p=d.target;st.enableSizeAttenuation&&st.styleValueRegistry.updateSizeAttenuation(p,s.getCamera().getZoom()),st.enableCSSParsing&&st.styleValueRegistry.recalc(p),st.sceneGraphService.dirtifyToRoot(p),i.dirtify()},h=function(d){var p=d.target,v=p.rBushNode;v.aabb&&t.rBush.remove(v.aabb),t.toSync.delete(p),st.sceneGraphService.dirtifyToRoot(p),i.dirtify()};i.hooks.init.tap(n.tag,function(){s.addEventListener(Ve.MOUNTED,u),s.addEventListener(Ve.UNMOUNTED,h),s.addEventListener(Ve.ATTR_MODIFIED,l),s.addEventListener(Ve.BOUNDS_CHANGED,c)}),i.hooks.destroy.tap(n.tag,function(){s.removeEventListener(Ve.MOUNTED,u),s.removeEventListener(Ve.UNMOUNTED,h),s.removeEventListener(Ve.ATTR_MODIFIED,l),s.removeEventListener(Ve.BOUNDS_CHANGED,c),t.toSync.clear()});var f=(r=st.globalThis.requestIdleCallback)!==null&&r!==void 0?r:G0.bind(st.globalThis);i.hooks.endFrame.tap(n.tag,function(){t.isFirstTimeRendering?(t.isFirstTimeRendering=!1,t.syncing=!0,f(function(){t.syncRTree(!0),t.isFirstTimeRenderingFinished=!0})):t.syncRTree()})},n.prototype.syncRTree=function(e){var t=this;if(e===void 0&&(e=!1),!(!e&&(this.syncing||this.toSync.size===0))){this.syncing=!0;var r=[];Array.from(this.toSync).filter(function(i){return i.isConnected}).forEach(function(i){var a=i.rBushNode;a&&a.aabb&&t.rBush.remove(a.aabb);var o=i.getRenderBounds();if(o){var s=i.renderable;e&&(s.dirtyRenderBounds||(s.dirtyRenderBounds=new ur),s.dirtyRenderBounds.update(o.center,o.halfExtents));var l=Ht(o.getMin(),2),c=l[0],u=l[1],h=Ht(o.getMax(),2),f=h[0],d=h[1];a.aabb||(a.aabb={}),a.aabb.displayObject=i,a.aabb.minX=c,a.aabb.minY=u,a.aabb.maxX=f,a.aabb.maxY=d}a.aabb&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.minX)&&!isNaN(a.aabb.minY)&&r.push(a.aabb)}),this.rBush.load(r),r.length=0,this.toSync.clear(),this.syncing=!1}},n.tag="Prepare",n}();function PV(n){return!!n.document}var vi;(function(n){n.READY="ready",n.BEFORE_RENDER="beforerender",n.RERENDER="rerender",n.AFTER_RENDER="afterrender",n.BEFORE_DESTROY="beforedestroy",n.AFTER_DESTROY="afterdestroy",n.RESIZE="resize",n.DIRTY_RECTANGLE="dirtyrectangle",n.RENDERER_CHANGED="rendererchanged"})(vi||(vi={}));var K2=500,tG=.1,eG=1e3,X0=new Mr(Ve.MOUNTED),j0=new Mr(Ve.UNMOUNTED),Z2=new Mr(vi.BEFORE_RENDER),nG=new Mr(vi.RERENDER),q2=new Mr(vi.AFTER_RENDER),MV=function(n){Me(e,n);function e(t){var r=n.call(this)||this;r.Element=zi,r.inited=!1,r.context={},r.document=new $5,r.document.defaultView=r,r.customElements=new j5;var i=t.container,a=t.canvas,o=t.offscreenCanvas,s=t.width,l=t.height,c=t.devicePixelRatio,u=t.renderer,h=t.background,f=t.cursor,d=t.document,p=t.requestAnimationFrame,v=t.cancelAnimationFrame,g=t.createImage,m=t.supportsPointerEvents,x=t.supportsTouchEvents,_=t.supportsCSSTransform,S=t.supportsMutipleCanvasesInOneContainer,b=t.useNativeClickEvent,y=t.alwaysTriggerPointerEventOnCanvas,E=t.isTouchEvent,w=t.isMouseEvent,M=t.dblClickSpeed;S||AF(i,r);var P=s,A=l,O=c;return a&&(O=c||B0&&window.devicePixelRatio||1,O=O>=1?Math.ceil(O):1,P=s||kF(a)||a.width/O,A=l||LF(a)||a.height/O),o&&(st.offscreenCanvas=o),r.devicePixelRatio=O,r.requestAnimationFrame=p!=null?p:G0.bind(st.globalThis),r.cancelAnimationFrame=v!=null?v:D2.bind(st.globalThis),r.supportsTouchEvents=x!=null?x:"ontouchstart"in st.globalThis,r.supportsPointerEvents=m!=null?m:!!st.globalThis.PointerEvent,r.isTouchEvent=E!=null?E:function(R){return r.supportsTouchEvents&&R instanceof st.globalThis.TouchEvent},r.isMouseEvent=w!=null?w:function(R){return!st.globalThis.MouseEvent||R instanceof st.globalThis.MouseEvent&&(!r.supportsPointerEvents||!(R instanceof st.globalThis.PointerEvent))},r.dblClickSpeed=M!=null?M:200,r.initRenderingContext({container:i,canvas:a,width:P,height:A,renderer:u,offscreenCanvas:o,devicePixelRatio:O,cursor:f||"default",background:h||"transparent",createImage:g,document:d,supportsCSSTransform:_,useNativeClickEvent:b,alwaysTriggerPointerEventOnCanvas:y}),r.initDefaultCamera(P,A,u.clipSpaceNearZ),r.initRenderer(u,!0),r}return e.prototype.initRenderingContext=function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}},e.prototype.initDefaultCamera=function(t,r,i){var a=this,o=new st.CameraContribution;o.clipSpaceNearZ=i,o.setType(un.EXPLORING,xc.DEFAULT).setPosition(t/2,r/2,K2).setFocalPoint(t/2,r/2,0).setOrthographic(t/-2,t/2,r/2,r/-2,tG,eG),o.canvas=this,o.eventEmitter.on(t2.UPDATED,function(){a.context.renderingContext.renderReasons.add(ts.CAMERA_CHANGED),st.enableSizeAttenuation&&a.getConfig().renderer.getConfig().enableSizeAttenuation&&a.updateSizeAttenuation()}),this.context.camera=o},e.prototype.updateSizeAttenuation=function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach(function(r){st.styleValueRegistry.updateSizeAttenuation(r,t)})},e.prototype.getConfig=function(){return this.context.config},e.prototype.getRoot=function(){return this.document.documentElement},e.prototype.getCamera=function(){return this.context.camera},e.prototype.getContextService=function(){return this.context.contextService},e.prototype.getEventService=function(){return this.context.eventService},e.prototype.getRenderingService=function(){return this.context.renderingService},e.prototype.getRenderingContext=function(){return this.context.renderingContext},e.prototype.getStats=function(){return this.getRenderingService().getStats()},Object.defineProperty(e.prototype,"ready",{get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise(function(r){t.resolveReadyPromise=function(){r(t)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),e.prototype.destroy=function(t,r){if(t===void 0&&(t=!0),r===void 0&&(r=!1),r||this.dispatchEvent(new Mr(vi.BEFORE_DESTROY)),this.frameId){var i=this.getConfig().cancelAnimationFrame||cancelAnimationFrame;i(this.frameId)}var a=this.getRoot();this.unmountChildren(a),t&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),t&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),r||this.dispatchEvent(new Mr(vi.AFTER_DESTROY))},e.prototype.changeSize=function(t,r){this.resize(t,r)},e.prototype.resize=function(t,r){var i=this.context.config;i.width=t,i.height=r,this.getContextService().resize(t,r);var a=this.context.camera,o=a.getProjectionMode();a.setPosition(t/2,r/2,K2).setFocalPoint(t/2,r/2,0),o===$r.ORTHOGRAPHIC?a.setOrthographic(t/-2,t/2,r/2,r/-2,a.getNear(),a.getFar()):a.setAspect(t/r),this.dispatchEvent(new Mr(vi.RESIZE,{width:t,height:r}))},e.prototype.appendChild=function(t,r){return this.document.documentElement.appendChild(t,r)},e.prototype.insertBefore=function(t,r){return this.document.documentElement.insertBefore(t,r)},e.prototype.removeChild=function(t){return this.document.documentElement.removeChild(t)},e.prototype.removeChildren=function(){this.document.documentElement.removeChildren()},e.prototype.destroyChildren=function(){this.document.documentElement.destroyChildren()},e.prototype.render=function(t){var r=this;t&&(Z2.detail=t,q2.detail=t),this.dispatchEvent(Z2);var i=this.getRenderingService();i.render(this.getConfig(),t,function(){r.dispatchEvent(nG)}),this.dispatchEvent(q2)},e.prototype.run=function(){var t=this,r=function(i,a){t.render(a),t.frameId=t.requestAnimationFrame(r)};r()},e.prototype.initRenderer=function(t,r){var i=this;if(r===void 0&&(r=!1),!t)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new jB,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new Z5,new Q5,new K5([new J5])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService(te(te({},st),this.context)),this.context.renderingService=new p5(st,this.context),this.context.eventService=new f5(st,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,r,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(t,r)})},e.prototype.initRenderingService=function(t,r,i){var a=this;r===void 0&&(r=!1),i===void 0&&(i=!1),this.context.renderingService.init(function(){a.inited=!0,r?i?a.requestAnimationFrame(function(){a.dispatchEvent(new Mr(vi.READY))}):a.dispatchEvent(new Mr(vi.READY)):a.dispatchEvent(new Mr(vi.RENDERER_CHANGED)),a.readyPromise&&a.resolveReadyPromise(),r||a.getRoot().forEach(function(o){var s=o.renderable;s&&(s.renderBoundsDirty=!0,s.boundsDirty=!0,s.dirty=!0)}),a.mountChildren(a.getRoot()),t.getConfig().enableAutoRendering&&a.run()})},e.prototype.loadRendererContainerModule=function(t){var r=this,i=t.getPlugins();i.forEach(function(a){a.context=r.context,a.init(st)})},e.prototype.setRenderer=function(t){var r=this.getConfig();if(r.renderer!==t){var i=r.renderer;r.renderer=t,this.destroy(!1,!0),Xe([],Ht(i==null?void 0:i.getPlugins()),!1).reverse().forEach(function(a){a.destroy(st)}),this.initRenderer(t)}},e.prototype.setCursor=function(t){var r=this.getConfig();r.cursor=t,this.getContextService().applyCursorStyle(t)},e.prototype.unmountChildren=function(t){var r=this;t.childNodes.forEach(function(i){r.unmountChildren(i)}),this.inited&&(t.isMutationObserved?t.dispatchEvent(j0):(j0.target=t,this.dispatchEvent(j0,!0)),t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1),t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()},e.prototype.mountChildren=function(t){var r=this;this.inited?t.isConnected||(t.ownerDocument=this.document,t.isConnected=!0,t.isMutationObserved?t.dispatchEvent(X0):(X0.target=t,this.dispatchEvent(X0,!0))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName),t.childNodes.forEach(function(i){r.mountChildren(i)}),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()},e.prototype.client2Viewport=function(t){return this.getEventService().client2Viewport(t)},e.prototype.viewport2Client=function(t){return this.getEventService().viewport2Client(t)},e.prototype.viewport2Canvas=function(t){return this.getEventService().viewport2Canvas(t)},e.prototype.canvas2Viewport=function(t){return this.getEventService().canvas2Viewport(t)},e.prototype.getPointByClient=function(t,r){return this.client2Viewport({x:t,y:r})},e.prototype.getClientByPoint=function(t,r){return this.viewport2Client({x:t,y:r})},e}(G2),rG="g-canvas-camera",iG=function(){function n(){this.displayObjectHTMLElementMap=new WeakMap}return n.prototype.joinTransformMatrix=function(e){return"matrix(".concat([e[0],e[1],e[4],e[5],e[12],e[13]].join(","),")")},n.prototype.apply=function(e,t){var r=this,i=e.camera,a=e.renderingContext,o=e.renderingService;this.context=e;var s=a.root.ownerDocument.defaultView,l=s.context.eventService.nativeHTMLMap,c=function(v,g){g.style.transform=r.joinTransformMatrix(v.getWorldTransform())},u=function(v){var g=v.target;if(g.nodeName===At.HTML){r.$camera||(r.$camera=r.createCamera(i));var m=r.getOrCreateEl(g);if(r.$camera.appendChild(m),t.enableCSSParsing){var x=g.ownerDocument.documentElement.attributes;Object.keys(x).forEach(function(_){m.style[_]=x[_]})}Object.keys(g.attributes).forEach(function(_){r.updateAttribute(_,g)}),c(g,m),l.set(m,g)}},h=function(v){var g=v.target;if(g.nodeName===At.HTML&&r.$camera){var m=r.getOrCreateEl(g);m&&(m.remove(),l.delete(m))}},f=function(v){var g=v.target;if(g.nodeName===At.HTML){var m=v.attrName;r.updateAttribute(m,g)}},d=function(v){var g=v.target;if(g.nodeName===At.HTML){var m=r.getOrCreateEl(g);c(g,m)}},p=function(){if(r.$camera){var v=r.context.config,g=v.width,m=v.height;r.$camera.style.width="".concat(g||0,"px"),r.$camera.style.height="".concat(m||0,"px")}};o.hooks.init.tap(n.tag,function(){s.addEventListener(vi.RESIZE,p),s.addEventListener(Ve.MOUNTED,u),s.addEventListener(Ve.UNMOUNTED,h),s.addEventListener(Ve.ATTR_MODIFIED,f),s.addEventListener(Ve.BOUNDS_CHANGED,d)}),o.hooks.endFrame.tap(n.tag,function(){r.$camera&&a.renderReasons.has(ts.CAMERA_CHANGED)&&(r.$camera.style.transform=r.joinTransformMatrix(i.getOrthoMatrix()))}),o.hooks.destroy.tap(n.tag,function(){r.$camera&&r.$camera.remove(),s.removeEventListener(vi.RESIZE,p),s.removeEventListener(Ve.MOUNTED,u),s.removeEventListener(Ve.UNMOUNTED,h),s.removeEventListener(Ve.ATTR_MODIFIED,f),s.removeEventListener(Ve.BOUNDS_CHANGED,d)})},n.prototype.createCamera=function(e){var t=this.context.config,r=t.document,i=t.width,a=t.height,o=this.context.contextService.getDomElement(),s=o.parentNode;if(s){var l=rG,c=s.querySelector("#"+l);if(!c){var u=(r||document).createElement("div");u.style.overflow="hidden",u.style.pointerEvents="none",u.style.position="absolute",u.style.left="0px",u.style.top="0px",u.style.width="".concat(i||0,"px"),u.style.height="".concat(a||0,"px");var h=(r||document).createElement("div");c=h,h.id=l,h.style.position="absolute",h.style.left="".concat(o.offsetLeft||0,"px"),h.style.top="".concat(o.offsetTop||0,"px"),h.style.transformOrigin="left top",h.style.transform=this.joinTransformMatrix(e.getOrthoMatrix()),h.style.pointerEvents="none",h.style.width="100%",h.style.height="100%",u.appendChild(h),s.appendChild(u)}return c}return null},n.prototype.getOrCreateEl=function(e){var t=this.context.config.document,r=this.displayObjectHTMLElementMap.get(e);return r||(r=(t||document).createElement("div"),e.parsedStyle.$el=r,this.displayObjectHTMLElementMap.set(e,r),e.id&&(r.id=e.id),e.name&&r.setAttribute("name",e.name),e.className&&(r.className=e.className),r.style.position="absolute",r.style["will-change"]="transform",r.style.transform=this.joinTransformMatrix(e.getWorldTransform())),r},n.prototype.updateAttribute=function(e,t){var r=this.getOrCreateEl(t);switch(e){case"innerHTML":var i=t.parsedStyle.innerHTML;ua(i)?r.innerHTML=i:(r.innerHTML="",r.appendChild(i));break;case"x":r.style.left="".concat(t.parsedStyle.x,"px");break;case"y":r.style.top="".concat(t.parsedStyle.y,"px");break;case"transformOrigin":var a=t.parsedStyle.transformOrigin;r.style["transform-origin"]="".concat(a[0].value," ").concat(a[1].value);break;case"width":if(this.context.enableCSSParsing){var o=t.computedStyleMap().get("width");r.style.width=o.toString()}else{var o=t.parsedStyle.width;r.style.width=Ia(o)?"".concat(o,"px"):o.toString()}break;case"height":if(this.context.enableCSSParsing){var s=t.computedStyleMap().get("height");r.style.height=s.toString()}else{var s=t.parsedStyle.height;r.style.height=Ia(s)?"".concat(s,"px"):s.toString()}break;case"zIndex":var l=t.parsedStyle.zIndex;r.style["z-index"]="".concat(l);break;case"visibility":var c=t.parsedStyle.visibility;r.style.visibility=c;break;case"pointerEvents":var u=t.parsedStyle.pointerEvents,h=u===void 0?"auto":u;r.style.pointerEvents=h;break;case"opacity":var f=t.parsedStyle.opacity;r.style.opacity="".concat(f);break;case"fill":var d=t.parsedStyle.fill,p="";Sf(d)?d.isNone?p="transparent":p=t.getAttribute("fill"):Array.isArray(d)?p=t.getAttribute("fill"):T0(d),r.style.background=p;break;case"stroke":var v=t.parsedStyle.stroke,g="";Sf(v)?v.isNone?g="transparent":g=t.getAttribute("stroke"):Array.isArray(v)?g=t.getAttribute("stroke"):T0(v),r.style["border-color"]=g,r.style["border-style"]="solid";break;case"lineWidth":var m=t.parsedStyle.lineWidth;r.style["border-width"]="".concat(m||0,"px");break;case"lineDash":r.style["border-style"]="dashed";break;case"filter":var x=t.style.filter;r.style.filter=x;break;default:!sn(t.style[e])&&t.style[e]!==""&&(r.style[e]=t.style[e])}},n.tag="HTMLRendering",n}(),aG=function(n){Me(e,n);function e(){var t=n.apply(this,Xe([],Ht(arguments),!1))||this;return t.name="html-renderer",t}return e.prototype.init=function(){this.addRenderingPlugin(new iG)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}($B),oG=function(){function n(e){this.canvasConfig=e,this.imageCache={},this.gradientCache={},this.patternCache={}}return n.prototype.getImageSync=function(e,t){return this.imageCache[e]?t&&t(this.imageCache[e]):this.getOrCreateImage(e).then(function(r){t&&t(r)}),this.imageCache[e]},n.prototype.getOrCreateImage=function(e){var t=this;if(this.imageCache[e])return Promise.resolve(this.imageCache[e]);var r=this.canvasConfig.createImage;return new Promise(function(i,a){var o;r?o=r(e):Al&&(o=new window.Image),o&&(o.onload=function(){t.imageCache[e]=o,i(o)},o.onerror=function(s){a(s)},o.crossOrigin="Anonymous",o.src=e)})},n.prototype.getOrCreatePatternSync=function(e,t,r,i,a,o){var s=this.generatePatternKey(e);if(s&&this.patternCache[s])return this.patternCache[s];var l=e.image,c=e.repetition,u=e.transform,h,f=!1;ue(l)?h=this.getImageSync(l,o):r?(h=r,f=!0):h=l;var d=h&&t.createPattern(h,c);if(d){var p=void 0;u?p=Gy(jd(u),new ii({})):p=Xt(Q()),f&&mi(p,p,[1/i,1/i,1]),d.setTransform({a:p[0],b:p[1],c:p[4],d:p[5],e:p[12]+a[0],f:p[13]+a[1]})}return s&&d&&(this.patternCache[s]=d),d},n.prototype.getOrCreateGradient=function(e,t){var r=this.generateGradientKey(e),i=e.type,a=e.steps,o=e.min,s=e.width,l=e.height,c=e.angle,u=e.cx,h=e.cy,f=e.size;if(this.gradientCache[r])return this.gradientCache[r];var d=null;if(i===ea.LinearGradient){var p=dP(o,s,l,c),v=p.x1,g=p.y1,m=p.x2,x=p.y2;d=t.createLinearGradient(v,g,m,x)}else if(i===ea.RadialGradient){var _=pP(o,s,l,u,h,f),S=_.x,b=_.y,y=_.r;d=t.createRadialGradient(S,b,0,S,b,y)}return d&&(a.forEach(function(E){var w=E.offset,M=E.color;w.unit===yt.kPercentage&&(d==null||d.addColorStop(w.value/100,M.toString()))}),this.gradientCache[r]=d),this.gradientCache[r]},n.prototype.generateGradientKey=function(e){var t=e.type,r=e.min,i=e.width,a=e.height,o=e.steps,s=e.angle,l=e.cx,c=e.cy,u=e.size;return"gradient-".concat(t,"-").concat((s==null?void 0:s.toString())||0,"-").concat((l==null?void 0:l.toString())||0,"-").concat((c==null?void 0:c.toString())||0,"-").concat((u==null?void 0:u.toString())||0,"-").concat(r[0],"-").concat(r[1],"-").concat(i,"-").concat(a,"-").concat(o.map(function(h){var f=h.offset,d=h.color;return"".concat(f).concat(d)}).join("-"))},n.prototype.generatePatternKey=function(e){var t=e.image,r=e.repetition;if(ue(t))return"pattern-".concat(t,"-").concat(r);if(t.nodeName==="rect")return"pattern-".concat(t.entity,"-").concat(r)},n}(),sG=function(){function n(){}return n.prototype.apply=function(e){var t=e.renderingService,r=e.renderingContext,i=e.imagePool,a=r.root.ownerDocument.defaultView,o=function(c,u,h){var f=c.parsedStyle,d=f.width,p=f.height;d&&!p?c.setAttribute("height",h/u*d):!d&&p&&c.setAttribute("width",u/h*p)},s=function(c){var u=c.target,h=u.nodeName,f=u.attributes;if(h===ct.IMAGE){var d=f.src,p=f.keepAspectRatio;ue(d)&&i.getImageSync(d,function(v){var g=v.width,m=v.height;p&&o(u,g,m),u.renderable.dirty=!0,t.dirtify()})}},l=function(c){var u=c.target,h=c.attrName,f=c.newValue;u.nodeName===ct.IMAGE&&h==="src"&&ue(f)&&i.getOrCreateImage(f).then(function(d){var p=d.width,v=d.height;u.attributes.keepAspectRatio&&o(u,p,v),u.renderable.dirty=!0,t.dirtify()})};t.hooks.init.tap(n.tag,function(){a.addEventListener(oe.MOUNTED,s),a.addEventListener(oe.ATTR_MODIFIED,l)}),t.hooks.destroy.tap(n.tag,function(){a.removeEventListener(oe.MOUNTED,s),a.removeEventListener(oe.ATTR_MODIFIED,l)})},n.tag="LoadImage",n}(),lG=function(n){B(e,n);function e(){var t=n.apply(this,K([],C(arguments),!1))||this;return t.name="image-loader",t}return e.prototype.init=function(){this.context.imagePool=new oG(this.context.config),this.addRenderingPlugin(new sG)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(Oo),cG=function(){function n(e){this.renderingContext=e.renderingContext,this.canvasConfig=e.config}return n.prototype.init=function(){var e=this.canvasConfig,t=e.container,r=e.canvas;if(r)this.$canvas=r,t&&r.parentElement!==t&&t.appendChild(r),this.$container=r.parentElement,this.canvasConfig.container=this.$container;else if(t&&(this.$container=ue(t)?document.getElementById(t):t,this.$container)){var i=document.createElement("canvas");this.$container.appendChild(i),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=i}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)},n.prototype.getContext=function(){return this.context},n.prototype.getDomElement=function(){return this.$canvas},n.prototype.getDPR=function(){return this.dpr},n.prototype.getBoundingClientRect=function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()},n.prototype.destroy=function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)},n.prototype.resize=function(e,t){var r=this.canvasConfig.devicePixelRatio,i=r||Al&&window.devicePixelRatio||1;i=i>=1?Math.ceil(i):1,this.dpr=i,this.$canvas&&(this.$canvas.width=this.dpr*e,this.$canvas.height=this.dpr*t,wM(this.$canvas,e,t)),this.renderingContext.renderReasons.add(Lo.CAMERA_CHANGED)},n.prototype.applyCursorStyle=function(e){this.$container&&this.$container.style&&(this.$container.style.cursor=e)},n.prototype.toDataURL=function(e){return e===void 0&&(e={}),j(this,void 0,void 0,function(){var t,r;return gt(this,function(i){return t=e.type,r=e.encoderOptions,[2,this.context.canvas.toDataURL(t,r)]})})},n}(),uG=function(n){B(e,n);function e(){var t=n.apply(this,K([],C(arguments),!1))||this;return t.name="canvas-context-register",t}return e.prototype.init=function(){this.context.ContextService=cG},e.prototype.destroy=function(){delete this.context.ContextService},e}(Oo),Of=function(n){B(e,n);function e(t){var r=n.call(this,t)||this;return r.registerPlugin(new uG),r.registerPlugin(new lG),r.registerPlugin(new g6),r.registerPlugin(new G6),r.registerPlugin(new W6),r.registerPlugin(new I6),r.registerPlugin(new aG),r}return e}(BT),J2=function(n,e,t){var r,i,a,o,s=0;t||(t={});var l=function(){s=t.leading===!1?0:Date.now(),r=null,o=n.apply(i,a),r||(i=a=null)},c=function(){var u=Date.now();!s&&t.leading===!1&&(s=u);var h=e-(u-s);return i=this,a=arguments,h<=0||h>e?(r&&(clearTimeout(r),r=null),s=u,o=n.apply(i,a),r||(i=a=null)):!r&&t.trailing!==!1&&(r=setTimeout(l,h)),o};return c.cancel=function(){clearTimeout(r),s=0,r=i=a=null},c};const fm=class extends _r{constructor(t,r){super(t,Object.assign({},fm.defaultOptions,r));k(this,"canvas");k(this,"onDraw",t=>{var r;(r=t==null?void 0:t.data)!=null&&r.render||this.onRender()});k(this,"onRender",J2(()=>{this.renderMinimap(),this.renderMask()},32,{leading:!0}));k(this,"shapes",new Map);k(this,"container");k(this,"landmarkMap",new Map);k(this,"mask",null);k(this,"isMaskDragging",!1);k(this,"onMaskDragStart",t=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(t.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))});k(this,"onMaskDrag",t=>{if(!this.mask||!this.isMaskDragging)return;const{size:[r,i]}=this.options,{movementX:a,movementY:o}=t,{left:s,top:l,width:c,height:u}=this.mask.style,[,,h,f]=this.maskBBox;let d=parseInt(s)+a,p=parseInt(l)+o,v=parseInt(c),g=parseInt(u);d<0&&(d=0),p<0&&(p=0),d+v>r&&(d=go(r-v,0)),p+g>i&&(p=go(i-g,0)),v<h&&(a>0?(d=go(d-a,0),v=vo(v+a,r)):a<0&&(v=vo(v-a,r))),g<f&&(o>0?(p=go(p-o,0),g=vo(g+o,i)):o<0&&(g=vo(g-o,i))),Object.assign(this.mask.style,{left:d+"px",top:p+"px",width:v+"px",height:g+"px"});const m=parseInt(s)-d,x=parseInt(l)-p;if(m===0&&x===0)return;const _=this.context.canvas.getCamera().getZoom(),S=this.canvas.getCamera().getZoom(),b=_/S;this.context.graph.translateBy([m*b,x*b],!1)});k(this,"onMaskDragEnd",t=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(t.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))});k(this,"onTransform",J2(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}));this.bindEvents()}bindEvents(){const{graph:t}=this.context;t.on(Tt.AFTER_DRAW,this.onDraw),t.on(Tt.AFTER_RENDER,this.onRender),t.on(Tt.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:t}=this.context;t.off(Tt.AFTER_DRAW,this.onDraw),t.off(Tt.AFTER_RENDER,this.onRender),t.off(Tt.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){const t=this.getElements(),r=this.initCanvas();this.setShapes(r,t)}getElements(){const{filter:t}=this.options,{model:r}=this.context,i=r.getData();if(!t)return i;const{nodes:a,edges:o,combos:s}=i;return{nodes:a.filter(l=>t(it(l),"node")),edges:o.filter(l=>t(it(l),"edge")),combos:s.filter(l=>t(it(l),"combo"))}}setShapes(t,r){const{nodes:i,edges:a,combos:o}=r,{shape:s}=this.options,{element:l}=this.context;if(s==="key"){const u=new Set,h=f=>{const d=it(f);u.add(d);const p=l.getElement(d);if(!p)return;const v=p.getShape("key"),g=this.shapes.get(d)||v.cloneNode();g.setPosition(v.getPosition()),p.style.zIndex&&(g.style.zIndex=p.style.zIndex),g.id=p.id,this.shapes.has(d)?Object.entries(v.attributes).forEach(([m,x])=>{g.style[m]!==x&&(g.style[m]=x)}):(t.appendChild(g),this.shapes.set(d,g))};a.forEach(h),o.forEach(h),i.forEach(h),this.shapes.forEach((f,d)=>{u.has(d)||(t.removeChild(f),this.shapes.delete(d))});return}const c=(u,h)=>{const d=l.getElement(u).getPosition();return h.setPosition(d),h};t.removeChildren(),a.forEach(u=>t.appendChild(s(it(u),"edge"))),o.forEach(u=>{t.appendChild(c(it(u),s(it(u),"combo")))}),i.forEach(u=>{t.appendChild(c(it(u),s(it(u),"node")))})}calculatePosition(){const{position:t,size:[r,i]}=this.options,{canvas:a}=this.context,[o,s]=a.getSize(),[l,c]=O1(t);return[l*(o-r),c*(s-i)]}createContainer(){const{container:t,className:r,size:[i,a],containerStyle:o}=this.options;if(t)return typeof t=="string"?document.querySelector(t):t;const s=document.createElement("div");s.classList.add("g6-minimap"),r&&s.classList.add(r);const[l,c]=this.calculatePosition();return Object.assign(s.style,at({position:"absolute",left:l+"px",top:c+"px",width:i+"px",height:a+"px"},o)),this.context.canvas.getContainer().appendChild(s)}initCanvas(){const{renderer:t,size:[r,i]}=this.options;if(this.canvas)this.canvas.resize(r,i),t&&this.canvas.setRenderer(t);else{const a=document.createElement("div"),o=this.createContainer();this.container=o,o.appendChild(a),this.canvas=new hu({width:r,height:i,container:a,renderer:t||new Of})}return this.setCamera(),this.canvas}createLandmark(t,r,i){const a=`${t.join(",")}-${r.join(",")}-${i}`;if(this.landmarkMap.has(a))return this.landmarkMap.get(a);const s=this.canvas.getCamera().createLandmark(a,{position:t,focalPoint:r,zoom:i});return this.landmarkMap.set(a,s),s}setCamera(){var y;const{canvas:t}=this.context,r=(y=this.canvas)==null?void 0:y.getCamera();if(!r)return;const{size:[i,a],padding:o}=this.options,[s,l,c,u]=Ns(o),{min:h,max:f,center:d}=t.getBounds("elements"),p=f[0]-h[0],v=f[1]-h[1],g=i-u-l,m=a-s-c,x=g/p,_=m/v,S=Math.min(x,_),b=this.createLandmark(d,d,S);r.gotoLandmark(b,0)}get maskBBox(){const{canvas:t}=this.context,r=t.getSize(),i=t.getCanvasByViewport([0,0]),a=t.getCanvasByViewport(r),o=this.canvas.canvas2Viewport(Bo(i)),s=this.canvas.canvas2Viewport(Bo(a)),l=s.x-o.x,c=s.y-o.y;return[o.x,o.y,l,c]}calculateMaskBBox(){const{size:[t,r]}=this.options;let[i,a,o,s]=this.maskBBox;return i<0&&(o=vo(o+i,t),i=0),a<0&&(s=vo(s+a,r),a=0),i+o>t&&(o=go(t-i,0)),a+s>r&&(s=go(r-a,0)),[vo(i,t),vo(a,r),go(o,0),go(s,0)]}renderMask(){const{maskStyle:t}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart)),this.container.appendChild(this.mask),Object.assign(this.mask.style,Se(at({},t),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;const[t,r,i,a]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:r+"px",left:t+"px",width:i+"px",height:a+"px"})}destroy(){var t;this.unbindEvents(),this.canvas.destroy(),(t=this.mask)==null||t.remove(),super.destroy()}};let Nf=fm;k(Nf,"defaultOptions",{size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"}});const vo=(n,e)=>Math.min(n,e),go=(n,e)=>Math.max(n,e),$0={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"},dm=class extends _r{constructor(t,r){super(t,Object.assign({},dm.defaultOptions,r));k(this,"horizontalLine");k(this,"verticalLine");k(this,"initSnapline",()=>{const t=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=t.appendChild(new cu({style:at(at({},$0),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=t.appendChild(new cu({style:at(at({},$0),this.options.verticalLineStyle)})))});k(this,"isHorizontalSticking",!1);k(this,"isVerticalSticking",!1);k(this,"enableStick",!0);k(this,"autoSnapToLine",(t,r,i)=>Pt(this,null,function*(){const{verticalX:a,horizontalY:o}=i,{tolerance:s}=this.options,{min:[l,c],max:[u,h],center:[f,d]}=r;let p=0,v=0;a!==null&&(fr(u,a)<s&&(p=a-u),fr(l,a)<s&&(p=a-l),fr(f,a)<s&&(p=a-f),p!==0&&(this.isVerticalSticking=!0)),o!==null&&(fr(h,o)<s&&(v=o-h),fr(c,o)<s&&(v=o-c),fr(d,o)<s&&(v=o-d),v!==0&&(this.isHorizontalSticking=!0)),(p!==0||v!==0)&&(yield this.context.graph.translateElementBy({[t]:[p,v]},!1))}));k(this,"enableSnap",t=>{const{target:r}=t,i=.5;if(this.isHorizontalSticking||this.isVerticalSticking){const[a,o]=this.getDelta(t);if(this.isHorizontalSticking&&this.isVerticalSticking&&Math.abs(a)<=i&&Math.abs(o)<=i)return this.context.graph.translateElementBy({[r.id]:[-a,-o]},!1),!1;if(this.isHorizontalSticking&&Math.abs(o)<=i)return this.context.graph.translateElementBy({[r.id]:[0,-o]},!1),!1;if(this.isVerticalSticking&&Math.abs(a)<=i)return this.context.graph.translateElementBy({[r.id]:[-a,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick});k(this,"calcSnaplineMetadata",(t,r)=>{const{tolerance:i,shape:a}=this.options,{min:[o,s],max:[l,c],center:[u,h]}=r;let f=null,d=null,p=null,v=null,g=null,m=null;return this.getNodes().some(x=>{if(vn(t.id,x.id))return!1;const _=Q2(x,a).getRenderBounds(),{min:[S,b],max:[y,E],center:[w,M]}=_;return f===null&&(fr(w,u)<i?f=w:fr(S,o)<i||fr(S,l)<i?f=S:(fr(y,l)<i||fr(y,o)<i)&&(f=y),f!==null&&(d=Math.min(b,s),p=Math.max(E,c))),v===null&&(fr(M,h)<i?v=M:fr(b,s)<i||fr(b,c)<i?v=b:(fr(E,c)<i||fr(E,s)<i)&&(v=E),v!==null&&(g=Math.min(S,o),m=Math.max(y,l))),f!==null&&v!==null}),{verticalX:f,verticalMinY:d,verticalMaxY:p,horizontalY:v,horizontalMinX:g,horizontalMaxX:m}});k(this,"onDragStart",()=>{this.initSnapline()});k(this,"onDrag",t=>Pt(this,null,function*(){const{target:r}=t;if(this.options.autoSnap&&!this.enableSnap(t))return;const i=Q2(r,this.options.shape).getRenderBounds(),a=this.calcSnaplineMetadata(r,i);this.hideSnapline(),(a.verticalX!==null||a.horizontalY!==null)&&this.updateSnapline(a),this.options.autoSnap&&(yield this.autoSnapToLine(r.id,i,a))}));k(this,"onDragEnd",()=>{this.hideSnapline()});this.bindEvents()}getNodes(){var a;const{filter:t}=this.options,i=(((a=this.context.element)==null?void 0:a.getNodes())||[]).filter(o=>{var s;return HN(o)&&((s=this.context.viewport)==null?void 0:s.isInViewport(o.getRenderBounds()))});return t?i.filter(o=>t(o)):i}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(t){const{lineWidth:r}=this.options[`${t}LineStyle`];return+(r||$0.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(t){const{verticalX:r,verticalMinY:i,verticalMaxY:a,horizontalY:o,horizontalMinX:s,horizontalMaxX:l}=t,[c,u]=this.context.canvas.getSize(),{offset:h}=this.options;o!==null?Object.assign(this.horizontalLine.style,{x1:h===1/0?0:s-h,y1:o,x2:h===1/0?c:l+h,y2:o,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",r!==null?Object.assign(this.verticalLine.style,{x1:r,y1:h===1/0?0:i-h,x2:r,y2:h===1/0?u:a+h,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(t){const r=this.context.graph.getZoom();return Rs([t.dx,t.dy],r)}bindEvents(){return Pt(this,null,function*(){const{graph:t}=this.context;t.on(Mi.DRAG_START,this.onDragStart),t.on(Mi.DRAG,this.onDrag),t.on(Mi.DRAG_END,this.onDragEnd)})}unbindEvents(){const{graph:t}=this.context;t.off(Mi.DRAG_START,this.onDragStart),t.off(Mi.DRAG,this.onDrag),t.off(Mi.DRAG_END,this.onDragEnd)}destroyElements(){var t,r;(t=this.horizontalLine)==null||t.destroy(),(r=this.verticalLine)==null||r.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}};let Rf=dm;k(Rf,"defaultOptions",{tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0});const fr=(n,e)=>Math.abs(n-e),Q2=(n,e)=>typeof e=="function"?e(n):n.getShape(e);var tw=null,hG=null;function kf(n){return n instanceof Date?n:new Date(n)}function fG(n){for(var e=__read(n,2),t=e[0],r=e[1],i=tw.indexOf(t),a=tw.indexOf(r),o="",s=i;s<=a;s+=1)if(o+=hG[s],s<a){var l="-";s===2?l=" ":s>2&&(l=":"),o+=l}return o}function Cr(n,e){var t={YYYY:n.getFullYear(),MM:n.getMonth()+1,DD:n.getDate(),HH:n.getHours(),mm:n.getMinutes(),ss:n.getSeconds()},r=e;return Object.keys(t).forEach(function(i){var a=t[i];r=r.replace(i,i==="YYYY"?"".concat(a):"".concat(a).padStart(2,"0"))}),r}function CV(n,e){return kf(n).getTime()-kf(e).getTime()}function AV(n,e){var t=__read([kf(n),kf(e)],2),r=t[0],i=t[1];return r.getFullYear()!==i.getFullYear()?"year":r.getMonth()!==i.getMonth()?"month":r.getDay()!==i.getDay()?"day":r.getHours()!==i.getHours()?"hour":r.getMinutes()!==i.getMinutes()?"minute":"second"}function OV(n,e){var t=new Date(n),r={year:function(i){i.setMonth(0),i.setHours(0,0,0,0)},month:function(i){i.setDate(1),i.setHours(0,0,0,0)},day:function(i){return i.setHours(0,0,0,0)},hour:function(i){return i.setMinutes(0,0,0)},minute:function(i){return i.setSeconds(0,0)},second:function(i){return i.setMilliseconds(0)}};return r[e](t),Cr(t,fG(["year",e]))}function dG(n,e){if(n.length<=e)return n;for(var t=Math.floor(n.length/e),r=[],i=0;i<n.length;i+=t)r.push(n[i]);return r}var K0={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new zh({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]},NV=Ci({},K0,{style:{type:"arc"}}),RV=Ci({},K0,{style:{}}),Be=Ki({mainGroup:"main-group",gridGroup:"grid-group",grid:"grid",lineGroup:"line-group",line:"line",tickGroup:"tick-group",tick:"tick",tickItem:"tick-item",labelGroup:"label-group",label:"label",labelItem:"label-item",titleGroup:"title-group",title:"title",lineFirst:"line-first",lineSecond:"line-second"},"axis");function Ba(n,e){return[n[0]*e,n[1]*e]}function Sc(n,e){return[n[0]+e[0],n[1]+e[1]]}function Z0(n,e){return[n[0]-e[0],n[1]-e[1]]}function rs(n,e){return[Math.min(n[0],e[0]),Math.min(n[1],e[1])]}function is(n,e){return[Math.max(n[0],e[0]),Math.max(n[1],e[1])]}function Tc(n,e){return Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2))}function ew(n){if(n[0]===0&&n[1]===0)return[0,0];var e=Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2));return[n[0]/e,n[1]/e]}function kV(n,e,t){var r=__read(n,2),i=r[0],a=r[1],o=__read(e,2),s=o[0],l=o[1],c=i-s,u=a-l,h=Math.sin(t),f=Math.cos(t);return[c*f-u*h+s,c*h+u*f+l]}function pG(n,e){return e?[n[1],-n[0]]:[-n[1],n[0]]}function pl(n){return n*Math.PI/180}function nw(n){return Number((n*180/Math.PI).toPrecision(5))}function Lf(n,e){return n.style.opacity||(n.style.opacity=1),Zi(n,{opacity:0},e)}var vG=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function gG(n){return vG.includes(n)}function rw(n){var e={};for(var t in n)gG(t)&&(e[t]=n[t]);return e}var vl=Ki({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function iw(n){return n.reduce(function(e,t,r){return e.push(K([r===0?"M":"L"],C(t),!1)),e},[])}function mG(n,e,t){var r=e.connect,i=r===void 0?"line":r,a=e.center;if(i==="line")return iw(n);if(!a)return[];var o=Tc(n[0],a),s=t?0:1;return n.reduce(function(l,c,u){return u===0?l.push(K(["M"],C(c),!1)):l.push(K(["A",o,o,0,0,s],C(c),!1)),l},[])}function q0(n,e,t){return e.type==="surround"?mG(n,e,t):iw(n)}function yG(n,e,t){var r=t.type,i=t.connect,a=t.center,o=t.closed,s=o?[["Z"]]:[],l=C([q0(n,t),q0(e.slice().reverse(),t,!0)],2),c=l[0],u=l[1],h=C([n[0],e.slice(-1)[0]],2),f=h[0],d=h[1],p=function(x,_){return[c,x,u,_,s].flat()};if(i==="line"||r==="surround")return p([K(["L"],C(d),!1)],[K(["L"],C(f),!1)]);if(!a)throw new Error("Arc grid need to specified center");var v=C([Tc(d,a),Tc(f,a)],2),g=v[0],m=v[1];return p([K(["A",g,g,0,0,1],C(d),!1),K(["L"],C(d),!1)],[K(["A",m,m,0,0,0],C(f),!1),K(["L"],C(f),!1)])}function xG(n,e,t,r){var i=t.animate,a=t.isBillboard,o=e.map(function(s,l){return{id:s.id||"grid-line-".concat(l),d:q0(s.points,t)}});return n.selectAll(vl.line.class).data(o,function(s){return s.id}).join(function(s){return s.append("path").each(function(l,c){var u=Di(rw(N({d:l.d},r)),[l,c,o]);this.attr(N({class:vl.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:a},u))})},function(s){return s.transition(function(l,c){var u=Di(rw(N({d:l.d},r)),[l,c,o]);return Zi(this,u,i.update)})},function(s){return s.transition(function(){var l=this,c=Lf(this,i.exit);return nl(c,function(){return l.remove()}),c})}).transitions()}function bG(n,e,t){var r=t.animate,i=t.connect,a=t.areaFill;if(e.length<2||!a||!i)return[];for(var o=Array.isArray(a)?a:[a,"transparent"],s=function(p){return o[p%o.length]},l=[],c=0;c<e.length-1;c++){var u=C([e[c].points,e[c+1].points],2),h=u[0],f=u[1],d=yG(h,f,t);l.push({d,fill:s(c)})}return n.selectAll(vl.region.class).data(l,function(p,v){return v}).join(function(p){return p.append("path").each(function(v,g){var m=Di(v,[v,g,l]);this.attr(m)}).attr("className",vl.region.name)},function(p){return p.transition(function(v,g){var m=Di(v,[v,g,l]);return Zi(this,m,r.update)})},function(p){return p.transition(function(){var v=this,g=Lf(this,r.exit);return nl(g,function(){return v.remove()}),g})}).transitions()}function EG(n){var e=n.data,t=e===void 0?[]:e,r=n.closed;return r?t.map(function(i){var a=i.points,o=C(a,1),s=o[0];return N(N({},i),{points:K(K([],C(a),!1),[s],!1)})}):t}var wG=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r){var i=t.type,a=t.center,o=t.areaFill,s=t.closed,l=V(t,["type","center","areaFill","closed"]),c=EG(t),u=Lt(r).maybeAppendByClassName(vl.lineGroup,"g"),h=Lt(r).maybeAppendByClassName(vl.regionGroup,"g"),f=xG(u,c,t,l),d=bG(h,c,t);return K(K([],C(f),!1),C(d),!1)},e}(Tn),_G=function(n,e){return function(t){return n*(1-t)+e*t}};function SG(n,e){var t=e?e.length:0,r=n?Math.min(t,n.length):0;return function(i){var a=new Array(r),o=new Array(t),s=0;for(s=0;s<r;++s)a[s]=J0(n[s],e[s]);for(;s<t;++s)o[s]=e[s];for(s=0;s<r;++s)o[s]=a[s](i);return o}}function TG(n,e){n===void 0&&(n={}),e===void 0&&(e={});var t={},r={};return Object.entries(e).forEach(function(i){var a=C(i,2),o=a[0],s=a[1];o in n?t[o]=J0(n[o],s):r[o]=s}),function(i){return Object.entries(t).forEach(function(a){var o=C(a,2),s=o[0],l=o[1];return r[s]=l(i)}),r}}function J0(n,e){return typeof n=="number"&&typeof e=="number"?_G(n,e):Array.isArray(n)&&Array.isArray(e)?SG(n,e):typeof n=="object"&&typeof e=="object"?TG(n,e):function(t){return n}}function PG(n,e,t,r){if(!r)return n.attr("__keyframe_data__",t),null;var i=r.duration,a=i===void 0?0:i,o=J0(e,t),s=Math.ceil(+a/16),l=new Array(s).fill(0).map(function(c,u,h){return{__keyframe_data__:o(u/(h.length-1))}});return n.animate(l,N({fill:"both"},r))}function aw(n,e){var t={},r=Array.isArray(e)?e:[e];for(var i in n)r.includes(i)||(t[i]=n[i]);return t}function ow(n,e){return Object.fromEntries(Object.entries(n).map(function(t){var r=C(t,2),i=r[0],a=r[1];return[i,Di(a,e)]}))}function LV(n){if(n.type==="linear"){var e=n.startPos,t=n.endPos;return __spreadArray(__spreadArray([],__read(e),!1),__read(t),!1)}var r=n.startAngle,i=n.endAngle,a=n.center,o=n.radius;return __spreadArray(__spreadArray([r,i],__read(a),!1),[o],!1)}function Q0(n,e){return e&&jt(e)?n.filter(e):n}function sw(n,e){var t=e.startAngle,r=e.endAngle;return(r-t)*n+t}function If(n,e){if(e.type==="linear"){var t=C(e.startPos,2),r=t[0],i=t[1],a=C(e.endPos,2),o=a[0],s=a[1],l=C([o-r,s-i],2),c=l[0],u=l[1];return ew([c,u])}var h=pl(sw(n,e));return[-Math.sin(h),Math.cos(h)]}function tg(n,e,t){var r=If(n,t);return pG(r,e!=="positive")}function Pc(n,e){return tg(n,e.labelDirection,e)}function MG(n,e){var t=C(e.startPos,2),r=t[0],i=t[1],a=C(e.endPos,2),o=a[0],s=a[1],l=C([o-r,s-i],2),c=l[0],u=l[1];return[r+c*n,i+u*n]}function CG(n,e){var t=e.radius,r=C(e.center,2),i=r[0],a=r[1],o=pl(sw(n,e));return[i+t*Math.cos(o),a+t*Math.sin(o)]}function Df(n,e){return e.type==="linear"?MG(n,e):CG(n,e)}function lw(n){return If(0,n)[1]===0}function cw(n){return If(0,n)[0]===0}function uw(n,e){return e-n===360}function hw(n,e,t,r,i){var a=e-n,o=C([i,i],2),s=o[0],l=o[1],c=C([pl(n),pl(e)],2),u=c[0],h=c[1],f=function(P){return[t+i*Math.cos(P),r+i*Math.sin(P)]},d=C(f(u),2),p=d[0],v=d[1],g=C(f(h),2),m=g[0],x=g[1];if(uw(n,e)){var _=(h+u)/2,S=C(f(_),2),b=S[0],y=S[1];return[["M",p,v],["A",s,l,0,1,0,b,y],["A",s,l,0,1,0,m,x]]}var E=a>180?1:0,w=n>e?0:1,M=!1;return M?"M".concat(t,",").concat(r,",L").concat(p,",").concat(v,",A").concat(s,",").concat(l,",0,").concat(E,",").concat(w,",").concat(m,",").concat(x,",L").concat(t,",").concat(r):"M".concat(p,",").concat(v,",A").concat(s,",").concat(l,",0,").concat(E,",").concat(w,",").concat(m,",").concat(x)}function AG(n){var e=n.attributes,t=e.startAngle,r=e.endAngle,i=e.center,a=e.radius;return K(K([t,r],C(i),!1),[a],!1)}function OG(n,e,t,r){var i=e.startAngle,a=e.endAngle,o=e.center,s=e.radius;return n.selectAll(Be.line.class).data([{d:hw.apply(void 0,K(K([i,a],C(o),!1),[s],!1))}],function(l,c){return c}).join(function(l){return l.append("path").attr("className",Be.line.name).styles(e).styles({d:function(c){return c.d}})},function(l){return l.transition(function(){var c=this,u=PG(this,AG(this),K(K([i,a],C(o),!1),[s],!1),r.update);if(u){var h=function(){var f=wr(c.attributes,"__keyframe_data__");c.style.d=hw.apply(void 0,K([],C(f),!1))};u.onframe=h,u.onfinish=h}return u}).styles(e)},function(l){return l.remove()}).styles(t).transitions()}function NG(n,e){var t=e.truncRange,r=e.truncShape,i=e.lineExtension}function RG(n,e,t){t===void 0&&(t=[0,0]);var r=C([n,e,t],3),i=C(r[0],2),a=i[0],o=i[1],s=C(r[1],2),l=s[0],c=s[1],u=C(r[2],2),h=u[0],f=u[1],d=C([l-a,c-o],2),p=d[0],v=d[1],g=Math.sqrt(Math.pow(p,2)+Math.pow(v,2)),m=C([-h/g,f/g],2),x=m[0],_=m[1];return[x*p,x*v,_*p,_*v]}function fw(n){var e=C(n,2),t=C(e[0],2),r=t[0],i=t[1],a=C(e[1],2),o=a[0],s=a[1];return{x1:r,y1:i,x2:o,y2:s}}function kG(n,e,t,r){var i=e.showTrunc,a=e.startPos,o=e.endPos,s=e.truncRange,l=e.lineExtension,c=C([a,o],2),u=C(c[0],2),h=u[0],f=u[1],d=C(c[1],2),p=d[0],v=d[1],g=C(l?RG(a,o,l):new Array(4).fill(0),4),m=g[0],x=g[1],_=g[2],S=g[3],b=function(Z){return n.selectAll(Be.line.class).data(Z,function(J,mt){return mt}).join(function(J){return J.append("line").attr("className",function(mt){return"".concat(Be.line.name," ").concat(mt.className)}).styles(t).transition(function(mt){return Zi(this,fw(mt.line),!1)})},function(J){return J.styles(t).transition(function(mt){var It=mt.line;return Zi(this,fw(It),r.update)})},function(J){return J.remove()}).transitions()};if(!i||!s)return b([{line:[[h+m,f+x],[p+_,v+S]],className:Be.line.name}]);var y=C(s,2),E=y[0],w=y[1],M=p-h,P=v-f,A=C([h+M*E,f+P*E],2),O=A[0],R=A[1],L=C([h+M*w,f+P*w],2),z=L[0],Y=L[1],I=b([{line:[[h+m,f+x],[O,R]],className:Be.lineFirst.name},{line:[[z,Y],[p+_,v+S]],className:Be.lineSecond.name}]);return NG(n,e),I}function LG(n,e,t,r){var i=t.showArrow,a=t.showTrunc,o=t.lineArrow,s=t.lineArrowOffset,l=t.lineArrowSize,c;if(e==="arc"?c=n.select(Be.line.class):a?c=n.select(Be.lineSecond.class):c=n.select(Be.line.class),!i||!o||t.type==="arc"&&uw(t.startAngle,t.endAngle)){var u=c.node();u&&(u.style.markerEnd=void 0);return}var h=La(o);h.attr(r),e0(h,l,!0),c.style("markerEnd",h).style("markerEndOffset",-s)}function IG(n,e,t){var r=e.type,i,a=Qt(e,"line");return r==="linear"?i=kG(n,e,aw(a,"arrow"),t):i=OG(n,e,aw(a,"arrow"),t),LG(n,r,e,a),i}function DG(n,e){return tg(n,e.gridDirection,e)}function dw(n){var e=n.type,t=n.gridCenter;return e==="linear"?t:t||n.center}function BG(n,e){var t=e.gridLength;return n.map(function(r,i){var a=r.value,o=C(Df(a,e),2),s=o[0],l=o[1],c=C(Ba(DG(a,e),t),2),u=c[0],h=c[1];return{id:i,points:[[s,l],[s+u,l+h]]}})}function FG(n,e){var t=e.gridControlAngles,r=dw(e);if(!r)throw new Error("grid center is not provide");if(n.length<2)throw new Error("Invalid grid data");if(!t||t.length===0)throw new Error("Invalid gridControlAngles");var i=C(r,2),a=i[0],o=i[1];return n.map(function(s,l){var c=s.value,u=C(Df(c,e),2),h=u[0],f=u[1],d=C([h-a,f-o],2),p=d[0],v=d[1],g=[];return t.forEach(function(m){var x=pl(m),_=C([Math.cos(x),Math.sin(x)],2),S=_[0],b=_[1],y=p*S-v*b+a,E=p*b+v*S+o;g.push([y,E])}),{points:g,id:l}})}function GG(n,e,t,r){var i=Qt(t,"grid"),a=i.type,o=i.areaFill,s=dw(t),l=Q0(e,t.gridFilter),c=a==="segment"?BG(l,t):FG(l,t),u=N(N({},i),{center:s,areaFill:jt(o)?l.map(function(h,f){return Di(o,[h,f,l])}):o,animate:r,data:c});return n.selectAll(Be.grid.class).data([1]).join(function(h){return h.append(function(){return new wG({style:u})}).attr("className",Be.grid.name)},function(h){return h.transition(function(){return this.update(u)})},function(h){return h.remove()}).transitions()}function tr(n,e,t,r,i){return r===void 0&&(r=!0),i===void 0&&(i=!1),r&&n===e||i&&n===t?!0:n>e&&n<t}function zG(n,e,t,r){t===void 0&&(t=2),r===void 0&&(r="top"),_E(n,{wordWrap:!0,wordWrapWidth:e,maxLines:t,textBaseline:r})}function WG(n,e,t){var r=n.getBBox(),i=r.width,a=r.height,o=C([e,t].map(function(c,u){var h;return c.includes("%")?parseFloat(((h=c.match(/[+-]?([0-9]*[.])?[0-9]+/))===null||h===void 0?void 0:h[0])||"0")/100*(u===0?i:a):c}),2),s=o[0],l=o[1];return[s,l]}function pw(n,e){if(e)try{var t=/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,r=e.replace(t,function(i,a,o){return"translate(".concat(WG(n,a,o),")")});n.attr("transform",r)}catch(i){}}var vw=function(n){return n!==void 0&&n!=null&&!Number.isNaN(n)},eg=function(){function n(e,t,r,i){this.set(e,t,r,i)}return Object.defineProperty(n.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),n.prototype.rotatedPoints=function(e,t,r){var i=this,a=i.x1,o=i.y1,s=i.x2,l=i.y2,c=Math.cos(e),u=Math.sin(e),h=t-t*c+r*u,f=r-t*u-r*c,d=[[c*a-u*l+h,u*a+c*l+f],[c*s-u*l+h,u*s+c*l+f],[c*a-u*o+h,u*a+c*o+f],[c*s-u*o+h,u*s+c*o+f]];return d},n.prototype.set=function(e,t,r,i){return r<e?(this.x2=e,this.x1=r):(this.x1=e,this.x2=r),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},n.prototype.defined=function(e){return this[e]!==Number.MAX_VALUE&&this[e]!==-Number.MAX_VALUE},n}();function Bf(n,e){var t=n.getEulerAngles()||0;n.setEulerAngles(0);var r=n.getBounds(),i=C(r.min,2),a=i[0],o=i[1],s=C(r.max,2),l=s[0],c=s[1],u=n.getBBox(),h=u.width,f=u.height,d=f,p=0,v=0,g=a,m=o,x=wE(n);if(x){d-=1.5;var _=x.style.textAlign,S=x.style.textBaseline;_==="center"?g=(a+l)/2:(_==="right"||_==="end")&&(g=l),S==="middle"?m=(o+c)/2:S==="bottom"&&(m=c)}var b=C(Rn(e),4),y=b[0],E=y===void 0?0:y,w=b[1],M=w===void 0?0:w,P=b[2],A=P===void 0?E:P,O=b[3],R=O===void 0?M:O,L=new eg((p+=a)-R,(v+=o)-E,p+h+M,v+d+A);return n.setEulerAngles(t),L.rotatedPoints(pl(t),g,m)}function Mc(n,e){return e[0]<=Math.max(n[0][0],n[1][0])&&e[0]<=Math.min(n[0][0],n[1][0])&&e[1]<=Math.max(n[0][1],n[1][1])&&e[1]<=Math.min(n[0][1],n[1][1])}function Cc(n,e,t){var r=(e[1]-n[1])*(t[0]-e[0])-(e[0]-n[0])*(t[1]-e[1]);return r===0?0:r<0?2:1}function UG(n,e){var t=Cc(n[0],n[1],e[0]),r=Cc(n[0],n[1],e[1]),i=Cc(e[0],e[1],n[0]),a=Cc(e[0],e[1],n[1]);return!!(t!==r&&i!==a||t===0&&Mc(n,e[0])||r===0&&Mc(n,e[1])||i===0&&Mc(e,n[0])||a===0&&Mc(e,n[1]))}function VG(n,e){var t=n.length;if(t<3)return!1;var r=[e,[9999,e[1]]],i=0,a=0;do{var o=[n[a],n[(a+1)%t]];if(UG(o,r)){if(Cc(o[0],e,o[1])===0)return Mc(o,e);i++}a=(a+1)%t}while(a!==0);return!!(i&1)}function HG(n,e){return e.every(function(t){return VG(n,t)})}function YG(n,e,t){var r=n.x1,i=n.x2,a=n.y1,o=n.y2,s=[[r,a],[i,a],[i,o],[r,o]],l=Bf(e,t);return HG(s,l)}function gw(n,e){var t=C(n,4),r=t[0],i=t[1],a=t[2],o=t[3],s=C(e,4),l=s[0],c=s[1],u=s[2],h=s[3],f=a-r,d=o-i,p=u-l,v=h-c,g=f*v-p*d;if(g===0)return!1;var m=g>0,x=r-l,_=i-c,S=f*_-d*x;if(S<0===m)return!1;var b=p*_-v*x;return!(b<0===m||S>g===m||b>g===m)}function mw(n,e){var t=[[n[0],n[1],n[2],n[3]],[n[2],n[3],n[4],n[5]],[n[4],n[5],n[6],n[7]],[n[6],n[7],n[0],n[1]]];return t.some(function(r){return gw(e,r)})}var IV={lineToLine:gw,intersectBoxLine:mw,getBounds:Bf};function XG(n,e,t){var r,i,a=Bf(n,t).flat(1),o=Bf(e,t).flat(1),s=[[a[0],a[1],a[2],a[3]],[a[0],a[1],a[4],a[5]],[a[4],a[5],a[6],a[7]],[a[2],a[3],a[6],a[7]]];try{for(var l=pt(s),c=l.next();!c.done;c=l.next()){var u=c.value;if(mw(o,u))return!0}}catch(h){r={error:h}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return!1}function jG(n,e){var t=n.type,r=n.labelDirection,i=n.crossSize;if(!i)return!1;if(t==="arc"){var a=n.center,o=n.radius,s=C(a,2),l=s[0],c=s[1],u=r==="negative"?0:i,h=-o-u,f=o+u,d=C(Rn(e),4),p=d[0],v=d[1],g=d[2],m=d[3];return new eg(l+h-m,c+h-p,l+f+v,c+f+g)}var x=C(n.startPos,2),_=x[0],S=x[1],b=C(n.endPos,2),y=b[0],E=b[1],w=C(cw(n)?[-e,0,e,0]:[0,e,0,-e],4),M=w[0],P=w[1],A=w[2],O=w[3],R=Pc(0,n),L=Ba(R,i),z=new eg(_,S,y,E);return z.x1+=O,z.y1+=M,z.x2+=P+L[0],z.y2+=A+L[1],z}function Ff(n,e,t){var r,i,a=e.crossPadding,o=new Set,s=null,l=jG(e,a),c=function(p){return l?YG(l,p):!0},u=function(p,v){return!p||!p.firstChild?!0:!XG(p.firstChild,v.firstChild,Rn(t))};try{for(var h=pt(n),f=h.next();!f.done;f=h.next()){var d=f.value;c(d)?!s||u(s,d)?s=d:(o.add(s),o.add(d)):o.add(d)}}catch(p){r={error:p}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}return Array.from(o)}function ng(n,e){return e===void 0&&(e={}),Mt(n)?0:typeof n=="number"?n:Math.floor(r6(n,e))}function $G(n,e,t,r){if(!(n.length<=1)){var i=e.suffix,a=i===void 0?"...":i,o=e.minLength,s=e.maxLength,l=s===void 0?1/0:s,c=e.step,u=c===void 0?" ":c,h=e.margin,f=h===void 0?[0,0,0,0]:h,d=EE(r.getTextShape(n[0])),p=ng(u,d),v=o?ng(o,d):p,g=ng(l,d);(Mt(g)||g===1/0)&&(g=Math.max.apply(null,n.map(function(L){return L.getBBox().width})));for(var m=n.slice(),x=C(f,4),_=x[0],S=_===void 0?0:_,b=x[1],y=b===void 0?0:b,E=x[2],w=E===void 0?S:E,M=x[3],P=M===void 0?y:M,A=function(L){if(m.forEach(function(z){r.ellipsis(r.getTextShape(z),L,a)}),m=Ff(n,t,f),m.length<1)return{value:void 0}},O=g;O>v+p;O-=p){var R=A(O);if(typeof R=="object")return R.value}}}var KG={parity:function(n,e){var t=e.seq,r=t===void 0?2:t;return n.filter(function(i,a){return a%r?($i(i),!1):!0})}},ZG=function(n){return n.filter(vw)};function qG(n,e,t,r){var i=n.length,a=e.keepHeader,o=e.keepTail;if(!(i<=1||i===2&&a&&o)){var s=KG.parity,l=function(_){return _.forEach(r.show),_},c=2,u=n.slice(),h=n.slice(),f=Math.min.apply(Math,K([1],C(n.map(function(_){return _.getBBox().width})),!1));if(t.type==="linear"&&(lw(t)||cw(t))){var d=bE(n[0]).left,p=bE(n[i-1]).right,v=Math.abs(p-d)||1;c=Math.max(Math.floor(i*f/v),c)}var g,m;for(a&&(g=u.splice(0,1)[0]),o&&(m=u.splice(-1,1)[0],u.reverse()),l(u);c<n.length&&Ff(ZG(m?K(K([m],C(h),!1),[g],!1):K([g],C(h),!1)),t,e==null?void 0:e.margin).length;){if(m&&!g&&c%2===0){var x=u.splice(0,1);x.forEach(r.hide)}else if(m&&g){var x=u.splice(0,1);x.forEach(r.hide)}h=s(l(u),{seq:c}),c++}}}function JG(n,e,t,r){var i,a,o=e.optionalAngles,s=o===void 0?[0,45,90]:o,l=e.margin,c=e.recoverWhenFailed,u=c===void 0?!0:c,h=n.map(function(m){return m.getLocalEulerAngles()}),f=function(){return Ff(n,t,l).length<1},d=function(m){return n.forEach(function(x,_){var S=Array.isArray(m)?m[_]:m;r.rotate(x,+S)})};try{for(var p=pt(s),v=p.next();!v.done;v=p.next()){var g=v.value;if(d(g),f())return}}catch(m){i={error:m}}finally{try{v&&!v.done&&(a=p.return)&&a.call(p)}finally{if(i)throw i.error}}u&&d(h)}function QG(n){var e=n.type,t=n.labelDirection;return e==="linear"&&lw(n)?t==="negative"?"bottom":"top":"middle"}function t9(n,e,t,r){var i=e.wordWrapWidth,a=i===void 0?50:i,o=e.maxLines,s=o===void 0?3:o,l=e.recoverWhenFailed,c=l===void 0?!0:l,u=e.margin,h=u===void 0?[0,0,0,0]:u,f=n.map(function(x){return x.attr("maxLines")||1}),d=Math.min.apply(Math,K([],C(f),!1)),p=function(){return Ff(n,t,h).length<1},v=QG(t),g=function(x){return n.forEach(function(_,S){var b=Array.isArray(x)?x[S]:x;r.wrap(_,a,b,v)})};if(!(d>s)){for(var m=d;m<=s;m++)if(g(m),p())return;c&&g(f)}}var e9=new Map([["hide",qG],["rotate",JG],["ellipsis",$G],["wrap",t9]]);function n9(n,e,t){return e.labelOverlap.length<1?!1:t==="hide"?!uD(n[0]):t==="rotate"?!n.some(function(r){var i;return!!(!((i=r.attr("transform"))===null||i===void 0)&&i.includes("rotate"))}):t==="ellipsis"||t==="wrap"?n.filter(function(r){return r.querySelector("text")}).length>1:!0}function r9(n,e,t){var r=e.labelOverlap,i=r===void 0?[]:r;i.length&&i.forEach(function(a){var o=a.type,s=e9.get(o);n9(n,e,o)&&(s==null||s(n,a,e,t))})}function i9(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=function(r){return r==="positive"?-1:1};return n.reduce(function(r,i){return r*t(i)},1)}function yw(n){for(var e=n;e<0;)e+=360;return Math.round(e%360)}function rg(n,e){var t=C(n,2),r=t[0],i=t[1],a=C(e,2),o=a[0],s=a[1],l=C([r*o+i*s,r*s-i*o],2),c=l[0],u=l[1];return Math.atan2(u,c)}function a9(n){var e=(n+360)%180;return tr(e,-90,90)||(e+=180),e}function o9(n,e,t){var r,i=t.labelAlign,a=(r=e.style.transform)===null||r===void 0?void 0:r.includes("rotate");if(a)return e.getLocalEulerAngles();var o=0,s=Pc(n.value,t),l=If(n.value,t);return i==="horizontal"?0:(i==="perpendicular"?o=rg([1,0],s):o=rg([l[0]<0?-1:1,0],l),a9(nw(o)))}function xw(n,e,t){var r=t.type,i=t.labelAlign,a=Pc(n,t),o=yw(e),s=yw(nw(rg([1,0],a))),l="center",c="middle";return r==="linear"?[90,270].includes(s)&&o===0?(l="center",c=a[1]===1?"top":"bottom"):!(s%180)&&[90,270].includes(o)?l="center":s===0?(tr(o,0,90,!1,!0)||tr(o,0,90)||tr(o,270,360))&&(l="start"):s===90?tr(o,0,90,!1,!0)?l="start":(tr(o,90,180)||tr(o,270,360))&&(l="end"):s===270?tr(o,0,90,!1,!0)?l="end":(tr(o,90,180)||tr(o,270,360))&&(l="start"):s===180&&(o===90?l="start":(tr(o,0,90)||tr(o,270,360))&&(l="end")):i==="parallel"?tr(s,0,180,!0)?c="top":c="bottom":i==="horizontal"?tr(s,90,270,!1)?l="end":(tr(s,270,360,!1)||tr(s,0,90))&&(l="start"):i==="perpendicular"&&(tr(s,90,270)?l="end":l="start"),{textAlign:l,textBaseline:c}}function s9(n,e,t){e.setLocalEulerAngles(n);var r=e.__data__.value,i=xw(r,n,t),a=e.querySelector(Be.labelItem.class);a&&Ew(a,i)}function bw(n,e,t){var r=t.showTick,i=t.tickLength,a=t.tickDirection,o=t.labelDirection,s=t.labelSpacing,l=e.indexOf(n),c=Di(s,[n,l,e]),u=C([Pc(n.value,t),i9(o,a)],2),h=u[0],f=u[1],d=f===1?Di(r?i:0,[n,l,e]):0,p=C(Sc(Ba(h,c+d),Df(n.value,t)),2),v=p[0],g=p[1];return{x:v,y:g}}function l9(n,e,t,r){var i=r.labelFormatter,a=jt(i)?function(){return La(Di(i,[n,e,t,Pc(n.value,r)]))}:function(){return La(n.label||"")};return a}function Ew(n,e){n.nodeName==="text"&&n.attr(e)}function ww(n){r9(this.node().childNodes,n,{hide:$i,show:fc,rotate:function(e,t){s9(+t,e,n)},ellipsis:function(e,t,r){e&&i0(e,t||1/0,r)},wrap:function(e,t,r){e&&zG(e,t,r)},getTextShape:function(e){return e.querySelector("text")}})}function _w(n,e,t,r,i){var a=t.indexOf(e),o=Lt(n).append(l9(e,a,t,i)).attr("className",Be.labelItem.name).node(),s=C(ka(ow(r,[e,a,t])),2),l=s[0],c=s[1],u=c.transform,h=V(c,["transform"]);pw(o,u);var f=o9(e,o,i);return o.getLocalEulerAngles()||o.setLocalEulerAngles(f),Ew(o,N(N({},xw(e.value,f,i)),l)),n.attr(h),o}function c9(n,e,t,r){var i=Q0(e,t.labelFilter),a=Qt(t,"label");return n.selectAll(Be.label.class).data(i,function(o,s){return s}).join(function(o){return o.append("g").attr("className",Be.label.name).transition(function(s){_w(this,s,e,a,t);var l=bw(s,e,t),c=l.x,u=l.y;return this.style.transform="translate(".concat(c,", ").concat(u,")"),null}).call(function(){ww.call(n,t)})},function(o){return o.transition(function(s){var l=this.querySelector(Be.labelItem.class),c=_w(this,s,e,a,t),u=MD(l,c,r.update),h=bw(s,e,t),f=h.x,d=h.y,p=Zi(this,{transform:"translate(".concat(f,", ").concat(d,")")},r.update);return K(K([],C(u),!1),[p],!1)}).call(function(s){var l=wr(s,"_transitions").flat().filter(vw);TD(l,function(){ww.call(n,t)})})},function(o){return o.transition(function(){var s=this,l=Lf(this.childNodes[0],r.exit);return nl(l,function(){return Lt(s).remove()}),l})}).transitions()}function Sw(n,e){return tg(n,e.tickDirection,e)}function u9(n,e){var t=C(n,2),r=t[0],i=t[1];return[[0,0],[r*e,i*e]]}function h9(n,e,t,r,i){var a=i.tickLength,o=C(u9(r,Di(a,[n,e,t])),2),s=C(o[0],2),l=s[0],c=s[1],u=C(o[1],2),h=u[0],f=u[1];return{x1:l,x2:h,y1:c,y2:f}}function f9(n,e,t,r,i){var a=i.tickFormatter,o=Sw(e.value,i),s="line";return jt(a)&&(s=function(){return Di(a,[e,t,r,o])}),n.append(s).attr("className",Be.tickItem.name)}function d9(n,e,t,r,i,a,o){var s=Sw(n.value,a),l=h9(n,e,t,s,a),c=l.x1,u=l.x2,h=l.y1,f=l.y2,d=C(ka(ow(o,[n,e,t,s])),2),p=d[0],v=d[1];r.node().nodeName==="line"&&r.styles(N({x1:c,x2:u,y1:h,y2:f},p)),i.attr(v),r.styles(p)}function Tw(n,e,t,r,i,a){var o=f9(Lt(this),n,e,t,r);d9(n,e,t,o,this,r,i);var s=C(Df(n.value,r),2),l=s[0],c=s[1];return Zi(this,{transform:"translate(".concat(l,", ").concat(c,")")},a)}function p9(n,e,t,r){var i=Q0(e,t.tickFilter),a=Qt(t,"tick");return n.selectAll(Be.tick.class).data(i,function(o){return o.id||o.label}).join(function(o){return o.append("g").attr("className",Be.tick.name).transition(function(s,l){return Tw.call(this,s,l,i,t,a,!1)})},function(o){return o.transition(function(s,l){return this.removeChildren(),Tw.call(this,s,l,i,t,a,r.update)})},function(o){return o.transition(function(){var s=this,l=Lf(this.childNodes[0],r.exit);return nl(l,function(){return s.remove()}),l})}).transitions()}function v9(n,e,t){var r=t.titlePosition,i=r===void 0?"lb":r,a=t.titleSpacing,o=of(i),s=n.node().getLocalBounds(),l=C(s.min,2),c=l[0],u=l[1],h=C(s.halfExtents,2),f=h[0],d=h[1],p=C(e.node().getLocalBounds().halfExtents,2),v=p[0],g=p[1],m=C([c+f,u+d],2),x=m[0],_=m[1],S=C(Rn(a),4),b=S[0],y=S[1],E=S[2],w=S[3];if(["start","end"].includes(i)&&t.type==="linear"){var M=t.startPos,P=t.endPos,A=C(i==="start"?[M,P]:[P,M],2),O=A[0],R=A[1],L=ew([-R[0]+O[0],-R[1]+O[1]]),z=C(Ba(L,b),2),Y=z[0],I=z[1];return{x:O[0]+Y,y:O[1]+I}}return o.includes("t")&&(_-=d+g+b),o.includes("r")&&(x+=f+v+y),o.includes("l")&&(x-=f+v+w),o.includes("b")&&(_+=d+g+E),{x,y:_}}function g9(n,e,t){var r=n.getGeometryBounds().halfExtents,i=r[1]*2;if(e==="vertical"){if(t==="left")return"rotate(-90) translate(0, ".concat(i/2,")");if(t==="right")return"rotate(-90) translate(0, -".concat(i/2,")")}return""}function Pw(n,e,t,r,i){var a=Qt(r,"title"),o=C(ka(a),2),s=o[0],l=o[1],c=l.transform,u=l.transformOrigin,h=V(l,["transform","transformOrigin"]);e.styles(h);var f=c||g9(n.node(),s.direction,s.position);n.styles(N(N({},s),{transformOrigin:u})),pw(n.node(),f);var d=v9(Lt(t._offscreen||t.querySelector(Be.mainGroup.class)),e,r),p=d.x,v=d.y,g=Zi(e.node(),{transform:"translate(".concat(p,", ").concat(v,")")},i);return g}function m9(n,e,t,r){var i=t.titleText;return n.selectAll(Be.title.class).data([{title:i}].filter(function(a){return!!a.title}),function(a,o){return a.title}).join(function(a){return a.append(function(){return La(i)}).attr("className",Be.title.name).transition(function(){return Pw(Lt(this),n,e,t,r.enter)})},function(a){return a.transition(function(){return Pw(Lt(this),n,e,t,r.update)})},function(a){return a.remove()}).transitions()}function Mw(n,e,t,r){var i=n.showLine,a=n.showTick,o=n.showLabel,s=e.maybeAppendByClassName(Be.lineGroup,"g"),l=hi(i,s,function(d){return IG(d,n,r)})||[],c=e.maybeAppendByClassName(Be.tickGroup,"g"),u=hi(a,c,function(d){return p9(d,t,n,r)})||[],h=e.maybeAppendByClassName(Be.labelGroup,"g"),f=hi(o,h,function(d){return c9(d,t,n,r)})||[];return K(K(K([],C(l),!1),C(u),!1),C(f),!1).filter(function(d){return!!d})}var y9=function(n){B(e,n);function e(t){return n.call(this,t,K0)||this}return e.prototype.render=function(t,r,i){var a=this,o=t.titleText,s=t.data,l=t.animate,c=t.showTitle,u=t.showGrid,h=t.dataThreshold,f=t.truncRange,d=dG(s,h).filter(function(b){var y=b.value;return!(f&&y>f[0]&&y<f[1])}),p=fE(i===void 0?l:i),v=Lt(r).maybeAppendByClassName(Be.gridGroup,"g"),g=hi(u,v,function(b){return GG(b,d,t,p)})||[],m=Lt(r).maybeAppendByClassName(Be.mainGroup,"g");o&&(!this.initialized&&p.enter||this.initialized&&p.update)&&Mw(t,Lt(this.offscreenGroup),d,fE(!1));var x=Mw(t,Lt(m.node()),d,p),_=Lt(r).maybeAppendByClassName(Be.titleGroup,"g"),S=hi(c,_,function(b){return m9(b,a,t,p)})||[];return K(K(K([],C(g),!1),C(x),!1),C(S),!1).flat().filter(function(b){return!!b})},e}(Tn);function Cw(n){var e=n.canvas,t=n.touches,r=n.offsetX,i=n.offsetY;if(e){var a=e.x,o=e.y;return[a,o]}if(t){var s=t[0],l=s.clientX,c=s.clientY;return[l,c]}return r&&i?[r,i]:[0,0]}function ig(n,e){return+n.toPrecision(e)}function DV(n){return n.toLocaleString()}function BV(n){return n.toExponential()}function FV(n,e){return e===void 0&&(e=0),Math.abs(n)<1e3?String(n):"".concat(ig(n/1e3,e).toLocaleString(),"K")}var GV=function(n,e,t){return n<0&&Number.isFinite(n)?e:t},zV=function(n,e,t){return n>0&&Number.isFinite(n)?e:t},WV=function(n,e){return n*e},UV=function(n,e){return n/2+(e||0)/2},ag=function(n){return n};class Aw{constructor(e){this.options=Ci({},this.getDefaultOptions()),this.update(e)}getOptions(){return this.options}update(e={}){this.options=Ci({},this.options,e),this.rescale(e)}rescale(e){}}function og(n,e){return e-n?t=>(t-n)/(e-n):t=>.5}function Gf(n,...e){return e.reduce((t,r)=>i=>t(r(i)),n)}function x9(n,e,t,r,i){let a=t||0,o=r||n.length;const s=i||(l=>l);for(;a<o;){const l=Math.floor((a+o)/2);s(n[l])>e?o=l:a=l+1}return a}var b9=D(19818),E9=D.n(b9);function sg(n,e,t){let r=t;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?n+(e-n)*6*r:r<1/2?e:r<2/3?n+(e-n)*(2/3-r)*6:n}function w9(n){const e=n[0]/360,t=n[1]/100,r=n[2]/100,i=n[3];if(t===0)return[r*255,r*255,r*255,i];const a=r<.5?r*(1+t):r+t-r*t,o=2*r-a,s=sg(o,a,e+1/3),l=sg(o,a,e),c=sg(o,a,e-1/3);return[s*255,l*255,c*255,i]}function Ow(n){const e=E9().get(n);if(!e)return null;const{model:t,value:r}=e;return t==="rgb"?r:t==="hsl"?w9(r):null}const zf=(n,e)=>t=>n*(1-t)+e*t,_9=(n,e)=>{const t=Ow(n),r=Ow(e);return t===null||r===null?t?()=>n:()=>e:i=>{const a=new Array(4);for(let u=0;u<4;u+=1){const h=t[u],f=r[u];a[u]=h*(1-i)+f*i}const[o,s,l,c]=a;return`rgba(${Math.round(o)}, ${Math.round(s)}, ${Math.round(l)}, ${c})`}},S9=(n,e)=>typeof n=="number"&&typeof e=="number"?zf(n,e):typeof n=="string"&&typeof e=="string"?_9(n,e):()=>n,T9=(n,e)=>{const t=zf(n,e);return r=>Math.round(t(r))};var P9=function(n){return n===null},M9=P9;function Nw(n){return!Nt(n)&&!M9(n)&&!Number.isNaN(n)}const lg=Math.sqrt(50),cg=Math.sqrt(10),ug=Math.sqrt(2);function Wf(n,e,t){const r=(e-n)/Math.max(0,t),i=Math.floor(Math.log(r)/Math.LN10),a=r/gi(10,i);return i>=0?(a>=lg?10:a>=cg?5:a>=ug?2:1)*gi(10,i):-gi(10,-i)/(a>=lg?10:a>=cg?5:a>=ug?2:1)}function VV(n,e,t){const r=Math.abs(e-n)/Math.max(0,t);let i=gi(10,Math.floor(Math.log(r)/Math.LN10));const a=r/i;return a>=lg?i*=10:a>=cg?i*=5:a>=ug&&(i*=2),e<n?-i:i}const C9=(n,e,t=5)=>{const r=[n,e];let i=0,a=r.length-1,o=r[i],s=r[a],l;return s<o&&([o,s]=[s,o],[i,a]=[a,i]),l=Wf(o,s,t),l>0?(o=Math.floor(o/l)*l,s=Math.ceil(s/l)*l,l=Wf(o,s,t)):l<0&&(o=Math.ceil(o*l)/l,s=Math.floor(s*l)/l,l=Wf(o,s,t)),l>0?(r[i]=Math.floor(o/l)*l,r[a]=Math.ceil(s/l)*l):l<0&&(r[i]=Math.ceil(o*l)/l,r[a]=Math.floor(s*l)/l),r};function A9(n,e){const t=e<n?e:n,r=n>e?n:e;return i=>Math.min(Math.max(t,i),r)}const O9=(n,e,t)=>{const[r,i]=n,[a,o]=e;let s,l;return r<i?(s=og(r,i),l=t(a,o)):(s=og(i,r),l=t(o,a)),Gf(l,s)},N9=(n,e,t)=>{const r=Math.min(n.length,e.length)-1,i=new Array(r),a=new Array(r),o=n[0]>n[r],s=o?[...n].reverse():n,l=o?[...e].reverse():e;for(let c=0;c<r;c+=1)i[c]=og(s[c],s[c+1]),a[c]=t(l[c],l[c+1]);return c=>{const u=x9(n,c,1,r)-1,h=i[u],f=a[u];return Gf(f,h)(c)}},Rw=(n,e,t,r)=>(Math.min(n.length,e.length)>2?N9:O9)(n,e,r?T9:t);class R9 extends Aw{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:zf,tickCount:5}}map(e){return Nw(e)?this.output(e):this.options.unknown}invert(e){return Nw(e)?this.input(e):this.options.unknown}nice(){if(!this.options.nice)return;const[e,t,r,...i]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(e,t,r,...i)}getTicks(){const{tickMethod:e}=this.options,[t,r,i,...a]=this.getTickMethodOptions();return e(t,r,i,...a)}getTickMethodOptions(){const{domain:e,tickCount:t}=this.options,r=e[0],i=e[e.length-1];return[r,i,t]}chooseNice(){return C9}rescale(){this.nice();const[e,t]=this.chooseTransforms();this.composeOutput(e,this.chooseClamp(e)),this.composeInput(e,t,this.chooseClamp(t))}chooseClamp(e){const{clamp:t,range:r}=this.options,i=this.options.domain.map(e),a=Math.min(i.length,r.length);return t?A9(i[0],i[a-1]):ag}composeOutput(e,t){const{domain:r,range:i,round:a,interpolate:o}=this.options,s=Rw(r.map(e),i,o,a);this.output=Gf(s,t,e)}composeInput(e,t,r){const{domain:i,range:a}=this.options,o=Rw(a,i.map(e),zf);this.input=Gf(t,r,o)}}const k9=(n,e,t)=>{let r,i,a=n,o=e;if(a===o&&t>0)return[a];let s=Wf(a,o,t);if(s===0||!Number.isFinite(s))return[];if(s>0){a=Math.ceil(a/s),o=Math.floor(o/s),i=new Array(r=Math.ceil(o-a+1));for(let l=0;l<r;l+=1)i[l]=(a+l)*s}else{s=-s,a=Math.ceil(a*s),o=Math.floor(o*s),i=new Array(r=Math.ceil(o-a+1));for(let l=0;l<r;l+=1)i[l]=(a+l)/s}return i};class Ac extends R9{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:S9,tickMethod:k9,tickCount:5}}chooseTransforms(){return[ag,ag]}clone(){return new Ac(this.options)}}function kw({map:n,initKey:e},t){const r=e(t);return n.has(r)?n.get(r):t}function L9({map:n,initKey:e},t){const r=e(t);return n.has(r)?n.get(r):(n.set(r,t),t)}function I9({map:n,initKey:e},t){const r=e(t);return n.has(r)&&(t=n.get(r),n.delete(r)),t}function D9(n){return typeof n=="object"?n.valueOf():n}class Lw extends Map{constructor(e){if(super(),this.map=new Map,this.initKey=D9,e!==null)for(const[t,r]of e)this.set(t,r)}get(e){return super.get(kw({map:this.map,initKey:this.initKey},e))}has(e){return super.has(kw({map:this.map,initKey:this.initKey},e))}set(e,t){return super.set(L9({map:this.map,initKey:this.initKey},e),t)}delete(e){return super.delete(I9({map:this.map,initKey:this.initKey},e))}}const hg=Symbol("defaultUnknown");function Iw(n,e,t){for(let r=0;r<e.length;r+=1)n.has(e[r])||n.set(t(e[r]),r)}function Dw(n){const{value:e,from:t,to:r,mapper:i,notFoundReturn:a}=n;let o=i.get(e);if(o===void 0){if(a!==hg)return a;o=t.push(e)-1,i.set(e,o)}return r[o%r.length]}function Bw(n){return n instanceof Date?e=>`${e}`:typeof n=="object"?e=>JSON.stringify(e):e=>e}class fg extends Aw{getDefaultOptions(){return{domain:[],range:[],unknown:hg}}constructor(e){super(e)}map(e){return this.domainIndexMap.size===0&&Iw(this.domainIndexMap,this.getDomain(),this.domainKey),Dw({value:this.domainKey(e),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(e){return this.rangeIndexMap.size===0&&Iw(this.rangeIndexMap,this.getRange(),this.rangeKey),Dw({value:this.rangeKey(e),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(e){const[t]=this.options.domain,[r]=this.options.range;if(this.domainKey=Bw(t),this.rangeKey=Bw(r),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!e||e.range)&&this.rangeIndexMap.clear(),(!e||e.domain||e.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new fg(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:e,compare:t}=this.options;return this.sortedDomain=t?[...e].sort(t):e,this.sortedDomain}}function B9(n){const e=Math.min(...n);return n.map(t=>t/e)}function F9(n,e){const t=n.length,r=e-t;return r>0?[...n,...new Array(r).fill(1)]:r<0?n.slice(0,e):n}function G9(n){return Math.round(n*1e12)/1e12}function z9(n){const{domain:e,range:t,paddingOuter:r,paddingInner:i,flex:a,round:o,align:s}=n,l=e.length,c=F9(a,l),[u,h]=t,f=h-u,d=2/l*r+1-1/l*i,p=f/d,v=p*i/l,g=p-l*v,m=B9(c),x=m.reduce((O,R)=>O+R),_=g/x,S=new Lw(e.map((O,R)=>{const L=m[R]*_;return[O,o?Math.floor(L):L]})),b=new Lw(e.map((O,R)=>{const z=m[R]*_+v;return[O,o?Math.floor(z):z]})),y=Array.from(b.values()).reduce((O,R)=>O+R),w=(f-(y-y/l*i))*s,M=u+w;let P=o?Math.round(M):M;const A=new Array(l);for(let O=0;O<l;O+=1){A[O]=G9(P);const R=e[O];P+=b.get(R)}return{valueBandWidth:S,valueStep:b,adjustedRange:A}}function W9(n){var e;const{domain:t}=n,r=t.length;if(r===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(!!(!((e=n.flex)===null||e===void 0)&&e.length))return z9(n);const{range:a,paddingOuter:o,paddingInner:s,round:l,align:c}=n;let u,h,f=a[0];const p=a[1]-f,v=o*2,g=r-s;u=p/Math.max(1,v+g),l&&(u=Math.floor(u)),f+=(p-u*(r-s))*c,h=u*(1-s),l&&(f=Math.round(f),h=Math.round(h));const m=new Array(r).fill(0).map((x,_)=>f+_*u);return{valueStep:u,valueBandWidth:h,adjustedRange:m}}class dg extends fg{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:hg,flex:[]}}constructor(e){super(e)}clone(){return new dg(this.options)}getStep(e){return this.valueStep===void 0?1:typeof this.valueStep=="number"?this.valueStep:e===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(e)}getBandWidth(e){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth=="number"?this.valueBandWidth:e===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(e)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:e,paddingInner:t}=this.options;return e>0?e:t}getPaddingOuter(){const{padding:e,paddingOuter:t}=this.options;return e>0?e:t}rescale(){super.rescale();const{align:e,domain:t,range:r,round:i,flex:a}=this.options,{adjustedRange:o,valueBandWidth:s,valueStep:l}=W9({align:e,range:r,round:i,flex:a,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:t});this.valueStep=l,this.valueBandWidth=s,this.adjustedRange=o}}var U9=function(n){B(e,n);function e(t){var r=this,i=t.style,a=V(t,["style"]);return r=n.call(this,Ci({},{type:"column"},N({style:i},a)))||this,r.columnsGroup=new qn({name:"columns"}),r.appendChild(r.columnsGroup),r.render(),r}return e.prototype.render=function(){var t=this.attributes,r=t.columns,i=t.x,a=t.y;this.columnsGroup.style.transform="translate(".concat(i,", ").concat(a,")"),Lt(this.columnsGroup).selectAll(".column").data(r.flat()).join(function(o){return o.append("rect").attr("className","column").each(function(s){this.attr(s)})},function(o){return o.each(function(s){this.attr(s)})},function(o){return o.remove()})},e.prototype.update=function(t){this.attr(Un({},this.attributes,t)),this.render()},e.prototype.clear=function(){this.removeChildren()},e}(Xr),V9=function(n){B(e,n);function e(t){var r=this,i=t.style,a=V(t,["style"]);return r=n.call(this,Ci({},{type:"lines"},N({style:i},a)))||this,r.linesGroup=r.appendChild(new qn),r.areasGroup=r.appendChild(new qn),r.render(),r}return e.prototype.render=function(){var t=this.attributes,r=t.lines,i=t.areas,a=t.x,o=t.y;this.style.transform="translate(".concat(a,", ").concat(o,")"),r&&this.renderLines(r),i&&this.renderAreas(i)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(t){this.attr(Un({},this.attributes,t)),this.render()},e.prototype.renderLines=function(t){Lt(this.linesGroup).selectAll(".line").data(t).join(function(r){return r.append("path").attr("className","line").each(function(i){this.attr(i)})},function(r){return r.each(function(i){this.attr(i)})},function(r){return r.remove()})},e.prototype.renderAreas=function(t){Lt(this.linesGroup).selectAll(".area").data(t).join(function(r){return r.append("path").attr("className","area").each(function(i){this.attr(i)})},function(r){return r.each(function(i){this.style(i)})},function(r){return r.remove()})},e}(Xr);function H9(n,e,t,r){var i,a=[],o=!!r,s,l,c=[1/0,1/0],u=[-1/0,-1/0],h,f,d;if(o){i=C(r,2),c=i[0],u=i[1];for(var p=0,v=n.length;p<v;p+=1){var g=n[p];c=rs(c,g),u=is(u,g)}}for(var p=0,m=n.length;p<m;p+=1){var g=n[p];if(p===0&&!t)d=g;else if(p===m-1&&!t)f=g,a.push(d),a.push(f);else{var x=[p?p-1:m-1,p-1][t?0:1];s=n[x],l=n[t?(p+1)%m:p+1];var _=[0,0];_=Z0(l,s),_=Ba(_,e);var S=Tc(g,s),b=Tc(g,l),y=S+b;y!==0&&(S/=y,b/=y);var E=Ba(_,-S),w=Ba(_,b);f=Sc(g,E),h=Sc(g,w),h=rs(h,is(l,g)),h=is(h,rs(l,g)),E=Z0(h,g),E=Ba(E,-S/b),f=Sc(g,E),f=rs(f,is(s,g)),f=is(f,rs(s,g)),w=Z0(g,f),w=Ba(w,b/S),h=Sc(g,w),o&&(f=is(f,c),f=rs(f,u),h=is(h,c),h=rs(h,u)),a.push(d),a.push(f),d=h}}return t&&a.push(a.shift()),a}function Y9(n,e,t){var r;e===void 0&&(e=!1),t===void 0&&(t=[[0,0],[1,1]]);for(var i=!!e,a=[],o=0,s=n.length;o<s;o+=2)a.push([n[o],n[o+1]]);for(var l=H9(a,.4,i,t),c=a.length,u=[],h,f,d,o=0;o<c-1;o+=1)h=l[o*2],f=l[o*2+1],d=a[o+1],u.push(["C",h[0],h[1],f[0],f[1],d[0],d[1]]);return i&&(h=l[c],f=l[c+1],r=C(a,1),d=r[0],u.push(["C",h[0],h[1],f[0],f[1],d[0],d[1]])),u}function X9(n,e){var t,r=e.x,i=e.y,a=C(i.getOptions().range||[0,0],2),o=a[0],s=a[1];return s>o&&(t=C([o,s],2),s=t[0],o=t[1]),n.map(function(l){var c=l.map(function(u,h){return[r.map(h),me(i.map(u),s,o)]});return c})}function Oc(n,e){e===void 0&&(e=!1);var t=e?n.length-1:0,r=n.map(function(i,a){return K([a===t?"M":"L"],C(i),!1)});return e?r.reverse():r}function Uf(n,e){if(e===void 0&&(e=!1),n.length<=2)return Oc(n);for(var t=[],r=n.length,i=0;i<r;i+=1){var a=e?n[r-i-1]:n[i];vn(a,t.slice(-2))||t.push.apply(t,K([],C(a),!1))}var o=Y9(t,!1);return e?o.unshift(K(["M"],C(n[r-1]),!1)):o.unshift(K(["M"],C(n[0]),!1)),o}function pg(n,e,t){var r=Nu(n);return r.push(["L",e,t],["L",0,t],["Z"]),r}function j9(n,e,t,r){return n.map(function(i){return pg(e?Uf(i):Oc(i),t,r)})}function $9(n,e,t){for(var r=[],i=n.length-1;i>=0;i-=1){var a=n[i],o=Oc(a),s=void 0;if(i===0)s=pg(o,e,t);else{var l=n[i-1],c=Oc(l,!0);c[0][0]="L",s=K(K(K([],C(o),!1),C(c),!1),[["Z"]],!1)}r.push(s)}return r}function K9(n,e,t){for(var r=[],i=n.length-1;i>=0;i-=1){var a=n[i],o=Uf(a),s=void 0;if(i===0)s=pg(o,e,t);else{var l=n[i-1],c=Uf(l,!0),u=a[0];c[0][0]="L",s=K(K(K([],C(o),!1),C(c),!1),[K(["M"],C(u),!1),["Z"]],!1)}r.push(s)}return r}var Z9=function(n,e){if(xr(n)){for(var t,r=1/0,i=0;i<n.length;i++){var a=n[i],o=jt(e)?e(a):a[e];o<r&&(t=a,r=o)}return t}},q9=function(n,e){if(xr(n)){for(var t,r=-1/0,i=0;i<n.length;i++){var a=n[i],o=jt(e)?e(a):a[e];o>r&&(t=a,r=o)}return t}};function Fw(n){return n.length===0?[0,0]:[us(Z9(n,function(e){return us(e)||0})),hs(q9(n,function(e){return hs(e)||0}))]}function Gw(n){for(var e=Nu(n),t=e[0].length,r=C([Array(t).fill(0),Array(t).fill(0)],2),i=r[0],a=r[1],o=0;o<e.length;o+=1)for(var s=e[o],l=0;l<t;l+=1)s[l]>=0?(s[l]+=i[l],i[l]=s[l]):(s[l]+=a[l],a[l]=s[l]);return e}var J9=function(n){B(e,n);function e(t){return n.call(this,t,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Object.defineProperty(e.prototype,"rawData",{get:function(){var t=this.attributes.data;if(!t||(t==null?void 0:t.length)===0)return[[]];var r=Nu(t);return fe(r[0])?[r]:r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?Gw(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var t=this.scales.y,r=C(t.getOptions().domain||[0,0],2),i=r[0],a=r[1];return a<0?t.map(a):t.map(i<0?0:i)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerShape",{get:function(){var t=this.attributes,r=t.width,i=t.height;return{width:r,height:i}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesStyle",{get:function(){var t=this,r=this.attributes,i=r.type,a=r.isStack,o=r.smooth;if(i!=="line")throw new Error("linesStyle can only be used in line type");var s=Qt(this.attributes,"area"),l=Qt(this.attributes,"line"),c=this.containerShape.width,u=this.data;if(u[0].length===0)return{lines:[],areas:[]};var h=this.scales,f=h.x,d=h.y,p=X9(u,{type:"line",x:f,y:d}),v=[];if(s){var g=this.baseline;a?v=o?K9(p,c,g):$9(p,c,g):v=j9(p,o,c,g)}return{lines:p.map(function(m,x){return N({stroke:t.getColor(x),d:o?Uf(m):Oc(m)},l)}),areas:v.map(function(m,x){return N({d:m,fill:t.getColor(x)},s)})}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsStyle",{get:function(){var t=this,r=Qt(this.attributes,"column"),i=this.attributes,a=i.isStack,o=i.type,s=i.scale;if(o!=="column")throw new Error("columnsStyle can only be used in column type");var l=this.containerShape.height,c=this.rawData;if(!c)return{columns:[]};a&&(c=Gw(c));var u=this.createScales(c),h=u.x,f=u.y,d=C(Fw(c),2),p=d[0],v=d[1],g=new Ac({domain:[0,v-(p>0?0:p)],range:[0,l*s]}),m=h.getBandWidth(),x=this.rawData;return{columns:c.map(function(_,S){return _.map(function(b,y){var E=m/c.length,w=function(){return{x:h.map(y)+E*S,y:b>=0?f.map(b):f.map(0),width:E,height:g.map(Math.abs(b))}},M=function(){return{x:h.map(y),y:f.map(b),width:m,height:g.map(x[S][y])}};return N(N({fill:t.getColor(S)},r),a?M():w())})})}},enumerable:!1,configurable:!0}),e.prototype.render=function(t,r){yD(r,".container","rect").attr("className","container").node();var i=t.type,a=t.x,o=t.y,s="spark".concat(i),l=N({x:a,y:o},i==="line"?this.linesStyle:this.columnsStyle);Lt(r).selectAll(".spark").data([i]).join(function(c){return c.append(function(u){return u==="line"?new V9({className:s,style:l}):new U9({className:s,style:l})}).attr("className","spark ".concat(s))},function(c){return c.update(l)},function(c){return c.remove()})},e.prototype.getColor=function(t){var r=this.attributes.color;return xr(r)?r[t%r.length]:jt(r)?r.call(null,t):r},e.prototype.createScales=function(t){var r,i,a=this.attributes,o=a.type,s=a.scale,l=a.range,c=l===void 0?[]:l,u=a.spacing,h=this.containerShape,f=h.width,d=h.height,p=C(Fw(t),2),v=p[0],g=p[1],m=new Ac({domain:[(r=c[0])!==null&&r!==void 0?r:v,(i=c[1])!==null&&i!==void 0?i:g],range:[d,d*(1-s)]});return o==="line"?{type:o,x:new Ac({domain:[0,t[0].length-1],range:[0,f]}),y:m}:{type:o,x:new dg({domain:t[0].map(function(x,_){return _}),range:[0,f],paddingInner:u,paddingOuter:u/2,align:.5}),y:m}},e.tag="sparkline",e}(Tn),zw={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},Ww={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},Uw={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},da=Ki({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),mo=Ki({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),Q9=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r){var i=t.x,a=t.y,o=t.size,s=o===void 0?10:o,l=t.radius,c=l===void 0?s/4:l,u=t.orientation,h=V(t,["x","y","size","radius","orientation"]),f=s,d=f*2.4,p=Lt(r).maybeAppendByClassName(mo.iconRect,"rect").styles(N(N({},h),{width:f,height:d,radius:c,x:i-f/2,y:a-d/2,transformOrigin:"center"})),v=i+1/3*f-f/2,g=i+2/3*f-f/2,m=a+1/4*d-d/2,x=a+3/4*d-d/2;p.maybeAppendByClassName("".concat(mo.iconLine,"-1"),"line").styles(N({x1:v,x2:v,y1:m,y2:x},h)),p.maybeAppendByClassName("".concat(mo.iconLine,"-2"),"line").styles(N({x1:g,x2:g,y1:m,y2:x},h)),u==="vertical"&&(p.node().style.transform="rotate(90)")},e}(Tn),t8=function(n){B(e,n);function e(t){return n.call(this,t,Uw)||this}return e.prototype.renderLabel=function(t){var r=this,i=this.attributes,a=i.x,o=i.y,s=i.showLabel,l=Qt(this.attributes,"label"),c=l.x,u=c===void 0?0:c,h=l.y,f=h===void 0?0:h,d=l.transform,p=l.transformOrigin,v=V(l,["x","y","transform","transformOrigin"]),g=C(ka(v,[]),2),m=g[0],x=g[1],_=Lt(t).maybeAppendByClassName(mo.labelGroup,"g").styles(x),S=N(N({},Ww),m),b=S.text,y=V(S,["text"]);hi(!!s,_,function(E){r.label=E.maybeAppendByClassName(mo.label,"text").styles(N(N({},y),{x:a+u,y:o+f,transform:d,transformOrigin:p,text:"".concat(b)})),r.label.on("mousedown",function(w){w.stopPropagation()}),r.label.on("touchstart",function(w){w.stopPropagation()})})},e.prototype.renderIcon=function(t){var r=this.attributes,i=r.x,a=r.y,o=r.orientation,s=r.type,l=N(N({x:i,y:a,orientation:o},zw),Qt(this.attributes,"icon")),c=this.attributes.iconShape,u=c===void 0?function(){return new Q9({style:l})}:c,h=Lt(t).maybeAppendByClassName(mo.iconGroup,"g");h.selectAll(mo.icon.class).data([u]).join(function(f){return f.append(typeof u=="string"?u:function(){return u(s)}).attr("className",mo.icon.name)},function(f){return f.update(l)},function(f){return f.remove()})},e.prototype.render=function(t,r){this.renderIcon(r),this.renderLabel(r)},e}(Tn),e8=function(n){B(e,n);function e(t){var r=n.call(this,t,N(N(N({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(i){return i.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},el(Uw,"handle")),el(zw,"handleIcon")),el(Ww,"handleLabel")))||this;return r.range=[0,1],r.onDragStart=function(i){return function(a){a.stopPropagation(),r.target=i,r.prevPos=r.getOrientVal(Cw(a));var o=r.availableSpace,s=o.x,l=o.y,c=r.getBBox(),u=c.x,h=c.y;r.selectionStartPos=r.getRatio(r.prevPos-r.getOrientVal([s,l])-r.getOrientVal([+u,+h])),r.selectionWidth=0,document.addEventListener("pointermove",r.onDragging),document.addEventListener("pointerup",r.onDragEnd)}},r.onDragging=function(i){var a=r.attributes,o=a.slidable,s=a.brushable,l=a.type;i.stopPropagation();var c=r.getOrientVal(Cw(i)),u=c-r.prevPos;if(u){var h=r.getRatio(u);switch(r.target){case"start":o&&r.setValuesOffset(h);break;case"end":o&&r.setValuesOffset(0,h);break;case"selection":o&&r.setValuesOffset(h,h);break;case"track":if(!s)return;r.selectionWidth+=h,l==="range"?r.innerSetValues([r.selectionStartPos,r.selectionStartPos+r.selectionWidth].sort(),!0):r.innerSetValues([0,r.selectionStartPos+r.selectionWidth],!0);break;default:break}r.prevPos=c}},r.onDragEnd=function(){document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointermove",r.onDragging),document.removeEventListener("pointerup",r.onDragEnd),r.target="",r.updateHandlesPosition(!1)},r.onValueChange=function(i){var a=r.attributes,o=a.onChange,s=a.type,l=s==="range"?i:i[1],c=s==="range"?r.getValues():r.getValues()[1],u=new Fn("valuechange",{detail:{oldValue:l,value:c}});r.dispatchEvent(u),o==null||o(c)},r.selectionStartPos=0,r.selectionWidth=0,r.prevPos=0,r.target="",r}return Object.defineProperty(e.prototype,"values",{get:function(){return this.attributes.values},set:function(t){this.attributes.values=this.clampValues(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineStyle",{get:function(){var t=this.attributes.orientation;if(t!=="horizontal")return null;var r=Qt(this.attributes,"sparkline");return N(N({zIndex:0},this.availableSpace),r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t=this.attributes,r=t.trackLength,i=t.trackSize,a=C(this.getOrientVal([[r,i],[i,r]]),2),o=a[0],s=a[1];return{width:o,height:s}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,r=t.x,i=t.y,a=t.padding,o=C(Rn(a),4),s=o[0],l=o[1],c=o[2],u=o[3],h=this.shape,f=h.width,d=h.height;return{x:u,y:s,width:f-(u+l),height:d-(s+c)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(t,r){t===void 0&&(t=[0,0]),r===void 0&&(r=!1),this.attributes.values=t;var i=r===!1?!1:this.attributes.animate;this.updateSelectionArea(i),this.updateHandlesPosition(i)},e.prototype.updateSelectionArea=function(t){var r=this.calcSelectionArea();this.foregroundGroup.selectAll(da.selection.class).each(function(i,a){Zi(this,r[a],t)})},e.prototype.updateHandlesPosition=function(t){this.attributes.showHandle&&(this.startHandle&&Zi(this.startHandle,this.getHandleStyle("start"),t),this.endHandle&&Zi(this.endHandle,this.getHandleStyle("end"),t))},e.prototype.innerSetValues=function(t,r){t===void 0&&(t=[0,0]),r===void 0&&(r=!1);var i=this.values,a=this.clampValues(t);this.attributes.values=a,this.setValues(a),r&&this.onValueChange(i)},e.prototype.renderTrack=function(t){var r=this.attributes,i=r.x,a=r.y,o=Qt(this.attributes,"track");this.trackShape=Lt(t).maybeAppendByClassName(da.track,"rect").styles(N(N({x:i,y:a},this.shape),o))},e.prototype.renderBrushArea=function(t){var r=this.attributes,i=r.x,a=r.y,o=r.brushable;this.brushArea=Lt(t).maybeAppendByClassName(da.brushArea,"rect").styles(N({x:i,y:a,fill:"transparent",cursor:o?"crosshair":"default"},this.shape))},e.prototype.renderSparkline=function(t){var r=this,i=this.attributes,a=i.x,o=i.y,s=i.orientation,l=Lt(t).maybeAppendByClassName(da.sparklineGroup,"g");hi(s==="horizontal",l,function(c){var u=N(N({},r.sparklineStyle),{x:a,y:o});c.maybeAppendByClassName(da.sparkline,function(){return new J9({style:u})}).update(u)})},e.prototype.renderHandles=function(){var t=this,r,i=this.attributes,a=i.showHandle,o=i.type,s=o==="range"?["start","end"]:["end"],l=a?s:[],c=this;(r=this.foregroundGroup)===null||r===void 0||r.selectAll(da.handle.class).data(l.map(function(u){return{type:u}}),function(u){return u.type}).join(function(u){return u.append(function(h){var f=h.type;return new t8({style:t.getHandleStyle(f)})}).each(function(h){var f=h.type;this.attr("class","".concat(da.handle.name," ").concat(f,"-handle"));var d="".concat(f,"Handle");c[d]=this,this.addEventListener("pointerdown",c.onDragStart(f))})},function(u){return u.each(function(h){var f=h.type;this.update(c.getHandleStyle(f))})},function(u){return u.each(function(h){var f=h.type,d="".concat(f,"Handle");c[d]=void 0}).remove()})},e.prototype.renderSelection=function(t){var r=this.attributes,i=r.x,a=r.y,o=r.type,s=r.selectionType;this.foregroundGroup=Lt(t).maybeAppendByClassName(da.foreground,"g");var l=Qt(this.attributes,"selection"),c=function(h){return h.style("visibility",function(f){return f.show?"visible":"hidden"}).style("cursor",function(f){return s==="select"?"grab":s==="invert"?"crosshair":"default"}).styles(N(N({},l),{transform:"translate(".concat(i,", ").concat(a,")")}))},u=this;this.foregroundGroup.selectAll(da.selection.class).data(o==="value"?[]:this.calcSelectionArea().map(function(h,f){return{style:N({},h),index:f,show:s==="select"?f===1:f!==1}}),function(h){return h.index}).join(function(h){return h.append("rect").attr("className",da.selection.name).call(c).each(function(f,d){var p=this;d===1?(u.selectionShape=Lt(this),this.on("pointerdown",function(v){p.attr("cursor","grabbing"),u.onDragStart("selection")(v)}),u.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),u.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),u.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){p.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){p.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){p.attr("cursor","pointer")})):this.on("pointerdown",u.onDragStart("track"))})},function(h){return h.call(c)},function(h){return h.remove()}),this.updateSelectionArea(!1),this.renderHandles()},e.prototype.render=function(t,r){this.renderTrack(r),this.renderSparkline(r),this.renderBrushArea(r),this.renderSelection(r)},e.prototype.clampValues=function(t,r){var i;r===void 0&&(r=4);var a=C(this.range,2),o=a[0],s=a[1],l=C(this.getValues().map(function(g){return ig(g,r)}),2),c=l[0],u=l[1],h=Array.isArray(t)?t:[c,t!=null?t:u],f=C((h||[c,u]).map(function(g){return ig(g,r)}),2),d=f[0],p=f[1];if(this.attributes.type==="value")return[0,me(p,o,s)];d>p&&(i=C([p,d],2),d=i[0],p=i[1]);var v=p-d;return v>s-o?[o,s]:d<o?c===o&&u===p?[o,p]:[o,v+o]:p>s?u===s&&c===d?[d,s]:[s-v,s]:[d,p]},e.prototype.calcSelectionArea=function(t){var r=C(this.clampValues(t),2),i=r[0],a=r[1],o=this.availableSpace,s=o.x,l=o.y,c=o.width,u=o.height;return this.getOrientVal([[{y:l,height:u,x:s,width:i*c},{y:l,height:u,x:i*c+s,width:(a-i)*c},{y:l,height:u,x:a*c,width:(1-a)*c}],[{x:s,width:c,y:l,height:i*u},{x:s,width:c,y:i*u+l,height:(a-i)*u},{x:s,width:c,y:a*u,height:(1-a)*u}]])},e.prototype.calcHandlePosition=function(t){var r=this.attributes.handleIconOffset,i=this.availableSpace,a=i.x,o=i.y,s=i.width,l=i.height,c=C(this.clampValues(),2),u=c[0],h=c[1],f=t==="start"?-r:r,d=(t==="start"?u:h)*this.getOrientVal([s,l])+f;return{x:a+this.getOrientVal([d,s/2]),y:o+this.getOrientVal([l/2,d])}},e.prototype.inferTextStyle=function(t){var r=this.attributes.orientation;return r==="horizontal"?{}:t==="start"?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:t==="end"?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},e.prototype.calcHandleText=function(t){var r,i=this.attributes,a=i.type,o=i.orientation,s=i.formatter,l=i.autoFitLabel,c=Qt(this.attributes,"handle"),u=Qt(c,"label"),h=c.spacing,f=this.getHandleSize(),d=this.clampValues(),p=t==="start"?d[0]:d[1],v=s(p),g=new Qv({style:N(N(N({},u),this.inferTextStyle(t)),{text:v})}),m=g.getBBox(),x=m.width,_=m.height;if(g.destroy(),!l){if(a==="value")return{text:v,x:0,y:-_-h};var S=h+f+(o==="horizontal"?x/2:0);return r={text:v},r[o==="horizontal"?"x":"y"]=t==="start"?-S:S,r}var b=0,y=0,E=this.availableSpace,w=E.width,M=E.height,P=this.calcSelectionArea()[1],A=P.x,O=P.y,R=P.width,L=P.height,z=h+f;if(o==="horizontal"){var Y=z+x/2;if(t==="start"){var I=A-z-x;b=I>0?-Y:Y}else{var Z=w-A-R-z>x;b=Z?Y:-Y}}else{var J=z,mt=_+z;t==="start"?y=O-f>_?-mt:J:y=M-(O+L)-f>_?mt:-J}return{x:b,y,text:v}},e.prototype.getHandleLabelStyle=function(t){var r=Qt(this.attributes,"handleLabel");return N(N(N({},r),this.calcHandleText(t)),this.inferTextStyle(t))},e.prototype.getHandleIconStyle=function(){var t=this.attributes.handleIconShape,r=Qt(this.attributes,"handleIcon"),i=this.getOrientVal(["ew-resize","ns-resize"]),a=this.getHandleSize();return N({cursor:i,shape:t,size:a},r)},e.prototype.getHandleStyle=function(t){var r=this.attributes,i=r.x,a=r.y,o=r.showLabel,s=r.showLabelOnInteraction,l=r.orientation,c=this.calcHandlePosition(t),u=c.x,h=c.y,f=this.calcHandleText(t),d=o;return!o&&s&&(this.target?d=!0:d=!1),N(N(N({},el(this.getHandleIconStyle(),"icon")),el(N(N({},this.getHandleLabelStyle(t)),f),"label")),{transform:"translate(".concat(u+i,", ").concat(h+a,")"),orientation:l,showLabel:d,type:t,zIndex:3})},e.prototype.getHandleSize=function(){var t=this.attributes,r=t.handleIconSize,i=t.width,a=t.height;return r||Math.floor((this.getOrientVal([+a,+i])+4)/2.4)},e.prototype.getOrientVal=function(t){var r=C(t,2),i=r[0],a=r[1],o=this.attributes.orientation;return o==="horizontal"?i:a},e.prototype.setValuesOffset=function(t,r,i){r===void 0&&(r=0),i===void 0&&(i=!1);var a=this.attributes.type,o=C(this.getValues(),2),s=o[0],l=o[1],c=a==="range"?t:0,u=[s+c,l+r].sort();i?this.setValues(u):this.innerSetValues(u,!0)},e.prototype.getRatio=function(t){var r=this.availableSpace,i=r.width,a=r.height;return t/this.getOrientVal([i,a])},e.prototype.dispatchCustomEvent=function(t,r,i){var a=this;t.on(r,function(o){o.stopPropagation(),a.dispatchEvent(new Fn(i,{detail:o}))})},e.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var t=this.brushArea;this.dispatchCustomEvent(t,"click","trackClick"),this.dispatchCustomEvent(t,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(t,"pointerleave","trackMouseleave"),t.on("pointerdown",this.onDragStart("track"))},e.prototype.onScroll=function(t){var r=this.attributes.scrollable;if(r){var i=t.deltaX,a=t.deltaY,o=a||i,s=this.getRatio(o);this.setValuesOffset(s,s,!0)}},e.tag="slider",e}(Tn),n8={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(n){return n.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},vg=Ki({background:"background",labelGroup:"label-group",label:"label"},"indicator"),r8=function(n){B(e,n);function e(t){var r=n.call(this,t,n8)||this;return r.point=[0,0],r.group=r.appendChild(new qn({})),r.isMutationObserved=!0,r}return e.prototype.renderBackground=function(){if(this.label){var t=this.attributes,r=t.position,i=t.padding,a=C(Rn(i),4),o=a[0],s=a[1],l=a[2],c=a[3],u=this.label.node().getLocalBounds(),h=u.min,f=u.max,d=new mn(h[0]-c,h[1]-o,f[0]+s-h[0]+c,f[1]+l-h[1]+o),p=this.getPath(r,d),v=Qt(this.attributes,"background");this.background=Lt(this.group).maybeAppendByClassName(vg.background,"path").styles(N(N({},v),{d:p})),this.group.appendChild(this.label.node())}},e.prototype.renderLabel=function(){var t=this.attributes,r=t.formatter,i=t.labelText,a=Qt(this.attributes,"label"),o=C(ka(a),2),s=o[0],l=o[1],c=s.text,u=V(s,["text"]);if(this.label=Lt(this.group).maybeAppendByClassName(vg.labelGroup,"g").styles(l),!!i){var h=this.label.maybeAppendByClassName(vg.label,function(){return La(r(i))}).style("text",r(i).toString());h.selectAll("text").styles(u)}},e.prototype.adjustLayout=function(){var t=C(this.point,2),r=t[0],i=t[1],a=this.attributes,o=a.x,s=a.y;this.group.attr("transform","translate(".concat(o-r,", ").concat(s-i,")"))},e.prototype.getPath=function(t,r){var i=this.attributes.radius,a=r.x,o=r.y,s=r.width,l=r.height,c=[["M",a+i,o],["L",a+s-i,o],["A",i,i,0,0,1,a+s,o+i],["L",a+s,o+l-i],["A",i,i,0,0,1,a+s-i,o+l],["L",a+i,o+l],["A",i,i,0,0,1,a,o+l-i],["L",a,o+i],["A",i,i,0,0,1,a+i,o],["Z"]],u={top:4,right:6,bottom:0,left:2},h=u[t],f=this.createCorner([c[h].slice(-2),c[h+1].slice(-2)]);return c.splice.apply(c,K([h+1,1],C(f),!1)),c[0][0]="M",c},e.prototype.createCorner=function(t,r){r===void 0&&(r=10);var i=.8,a=QD.apply(void 0,K([],C(t),!1)),o=C(t,2),s=C(o[0],2),l=s[0],c=s[1],u=C(o[1],2),h=u[0],f=u[1],d=C(a?[h-l,[l,h]]:[f-c,[c,f]],2),p=d[0],v=C(d[1],2),g=v[0],m=v[1],x=p/2,_=p/Math.abs(p),S=r*_,b=S/2,y=S*Math.sqrt(3)/2*i,E=C([g,g+x-b,g+x,g+x+b,m],5),w=E[0],M=E[1],P=E[2],A=E[3],O=E[4];return a?(this.point=[P,c-y],[["L",w,c],["L",M,c],["L",P,c-y],["L",A,c],["L",O,c]]):(this.point=[l+y,P],[["L",l,w],["L",l,M],["L",l+y,P],["L",l,A],["L",l,O]])},e.prototype.applyVisibility=function(){var t=this.attributes.visibility;t==="hidden"?$i(this):fc(this)},e.prototype.bindEvents=function(){this.label.on(de.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},e}(Tn),i8=function(n){B(e,n);function e(t){var r=n.call(this,Un({},e.defaultOptions,t))||this;return r.hoverColor="#f5f5f5",r.selectedColor="#e6f7ff",r.background=r.appendChild(new $o({})),r.label=r.background.appendChild(new qn({})),r}return Object.defineProperty(e.prototype,"padding",{get:function(){return Rn(this.style.padding)},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(){var t=this.style,r=t.label,i=t.value,a=Qt(this.attributes,"label");Lt(this.label).maybeAppend(".label",function(){return La(r)}).attr("className","label").styles(a),this.label.attr("__data__",i)},e.prototype.renderBackground=function(){var t=this.label.getBBox(),r=C(this.padding,4),i=r[0],a=r[1],o=r[2],s=r[3],l=t.width,c=t.height,u=l+s+a,h=c+i+o,f=Qt(this.attributes,"background"),d=this.style,p=d.width,v=p===void 0?0:p,g=d.height,m=g===void 0?0:g,x=d.selected;this.background.attr(N(N({},f),{width:Math.max(u,v),height:Math.max(h,m),fill:x?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(s,", ").concat((h-c)/2,")")})},e.prototype.render=function(){this.renderLabel(),this.renderBackground()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("pointerenter",function(){t.style.selected||t.background.attr("fill",t.hoverColor)}),this.addEventListener("pointerleave",function(){t.style.selected||t.background.attr("fill",t.style.backgroundFill)});var r=this;this.addEventListener("click",function(){var i=t.style,a=i.label,o=i.value,s=i.onClick;s==null||s(o,{label:a,value:o},r)})},e.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},e}(Tn),a8=function(n){B(e,n);function e(t){var r,i,a=n.call(this,Un({},e.defaultOptions,t))||this;a.currentValue=(r=e.defaultOptions.style)===null||r===void 0?void 0:r.defaultValue,a.isPointerInSelect=!1,a.select=a.appendChild(new $o({className:"select",style:{cursor:"pointer",width:0,height:0}})),a.dropdown=a.appendChild(new $o({className:"dropdown"}));var o=a.style.defaultValue;return o&&(!((i=a.style.options)===null||i===void 0)&&i.some(function(s){return s.value===o}))&&(a.currentValue=o),a}return e.prototype.setValue=function(t){this.currentValue=t,this.render()},e.prototype.getValue=function(){return this.currentValue},Object.defineProperty(e.prototype,"dropdownPadding",{get:function(){return Rn(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),e.prototype.renderSelect=function(){var t=this,r,i=this.style,a=i.x,o=i.y,s=i.width,l=i.height,c=i.bordered,u=i.showDropdownIcon,h=Qt(this.attributes,"select"),f=Qt(this.attributes,"placeholder");this.select.attr(N(N({x:a,y:o,width:s,height:l},h),{fill:"#fff",strokeWidth:c?1:0}));var d=this.dropdownPadding,p=10;u&&Lt(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(a+s-p-d[1]-d[3],", ").concat(o+l/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var v=(r=this.style.options)===null||r===void 0?void 0:r.find(function(_){return _.value===t.currentValue}),g=N({x:a+d[3]},f);Lt(this.select).selectAll(".placeholder").data(v?[]:[1]).join(function(_){return _.append("text").attr("className","placeholder").styles(g).style("y",function(){var S=this.getBBox();return o+(l-S.height)/2})},function(_){return _.styles(g)},function(_){return _.remove()});var m=Qt(this.attributes,"optionLabel"),x=N({x:a+d[3]},m);Lt(this.select).selectAll(".value").data(v?[v]:[]).join(function(_){return _.append(function(S){return La(S.label)}).attr("className","value").styles(x).style("y",function(){var S=this.getBBox();return o+(l-S.height)/2})},function(_){return _.styles(x)},function(_){return _.remove()})},e.prototype.renderDropdown=function(){var t=this,r,i,a=this.style,o=a.x,s=a.y,l=a.width,c=a.height,u=a.options,h=a.onSelect,f=a.open,d=Qt(this.attributes,"dropdown"),p=Qt(this.attributes,"option"),v=this.dropdownPadding;Lt(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(u,function(x){return x.value}).join(function(x){return x.append(function(_){return new i8({className:"dropdown-item",style:N(N(N({},_),p),{width:l-v[1]-v[3],selected:_.value===t.currentValue,onClick:function(S,b,y){t.setValue(S),h==null||h(S,b,y),t.dispatchEvent(new Fn("change",{detail:{value:S,option:b,item:y}})),$i(t.dropdown)}})})}).each(function(_,S){var b,y=(b=this.parentNode)===null||b===void 0?void 0:b.children,E=y.reduce(function(w,M,P){return P<S&&(w+=M.getBBox().height),w},0);this.attr("transform","translate(".concat(v[3],", ").concat(v[0]+E,")"))})},function(x){return x.update(function(_){return{selected:_.value===t.currentValue}})},function(x){return x.remove()});var g=(i=(r=this.dropdown.getElementsByClassName("dropdown-container"))===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.getBBox(),m=d.spacing;this.dropdown.attr(N({transform:"translate(".concat(o,", ").concat(s+c+m,")"),width:g.width+v[1]+v[3],height:g.height+v[0]+v[2]},d)),!f&&$i(this.dropdown)},e.prototype.render=function(){this.renderSelect(),this.renderDropdown()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("click",function(r){r.stopPropagation()}),this.select.addEventListener("click",function(){t.dropdown.style.visibility==="visible"?$i(t.dropdown):fc(t.dropdown)}),this.addEventListener("pointerenter",function(){t.isPointerInSelect=!0}),this.addEventListener("pointerleave",function(){t.isPointerInSelect=!1}),document==null||document.addEventListener("click",function(){t.isPointerInSelect||$i(t.dropdown)})},e.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"\u8BF7\u9009\u62E9",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},e}(Tn),Ji=function(n){B(e,n);function e(t){var r=n.call(this,Un({},{style:{backgroundOpacity:e.backgroundOpacities.default}},e.defaultOptions,t))||this;return r.showBackground=!0,r.background=r.appendChild(new $o({})),r.icon=r.appendChild(new qn({})),r}return Object.defineProperty(e.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return Rn(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconSize",{get:function(){var t=this.attributes.size,r=C(this.padding,4),i=r[0],a=r[1],o=r[2],s=r[3];return Math.max(t-Math.max(s+a,i+o),this.lineWidth*2+1)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.attributes,r=t.x,i=t.y,a=t.size,o=a/2,s=Qt(this.attributes,"background");this.background.attr(N({x:r-o,y:i-o,width:a,height:a},s))},e.prototype.showIndicator=function(){if(this.label){var t=this.attributes.size,r=this.background.getBBox(),i=r.x,a=r.y;this.indicator.update({x:i+t/2,y:a-5,labelText:this.label,visibility:"visible"})}},e.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},e.prototype.connectedCallback=function(){var t;n.prototype.connectedCallback.call(this);var r=this.attributes.size,i=this.background.getBBox(),a=i.x,o=i.y,s=(t=this.ownerDocument)===null||t===void 0?void 0:t.defaultView;s&&(this.indicator=s.appendChild(new r8({style:{x:a+r/2,y:o-r/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},e.prototype.disconnectedCallback=function(){this.indicator.destroy()},e.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},e.prototype.bindEvents=function(){var t=this,r=this.attributes.onClick;if(this.addEventListener("click",function(){r==null||r(t)}),this.showBackground){var i=function(){return t.background.attr({opacity:e.backgroundOpacities.default})},a=function(){return t.background.attr({opacity:e.backgroundOpacities.hover})},o=function(){return t.background.attr({opacity:e.backgroundOpacities.active})};this.addEventListener("pointerenter",function(){a(),t.showIndicator()}),this.addEventListener("pointerleave",function(){i(),t.hideIndicator()}),this.addEventListener("pointerdown",function(){o()}),this.addEventListener("pointerup",function(){i()})}},e.tag="IconBase",e.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},e.backgroundOpacities={default:0,hover:.8,active:1},e}(Tn),Nc=function(n,e){return e===void 0&&(e="#565758"),new zh({style:{fill:e,d:"M ".concat(n,",").concat(n," L -").concat(n,",0 L ").concat(n,",-").concat(n," Z"),transformOrigin:"center"}})},o8=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.arcPath=function(t,r,i){var a=C([i,i],2),o=a[0],s=a[1],l=function(v){return[t+i*Math.cos(v),r+i*Math.sin(v)]},c=C(l(-5/4*Math.PI),2),u=c[0],h=c[1],f=C(l(1/4*Math.PI),2),d=f[0],p=f[1];return"M".concat(u,",").concat(h,",A").concat(o,",").concat(s,",0,1,1,").concat(d,",").concat(p)},Object.defineProperty(e.prototype,"label",{get:function(){return"\u91CD\u7F6E"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this.iconSize,s=this.lineWidth,l=s+.5;Lt(this.icon).maybeAppend(".reset","path").styles({stroke:a,lineWidth:s,d:this.arcPath(r,i,o/2-s),markerStart:Nc(l,a)})},e}(Ji),s8=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u5FEB\u9000"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this.iconSize,s=o/2,l=o/2/Math.pow(3,.5),c=[[r,i],[r,i-l],[r-s,i],[r,i+l],[r,i],[r+s,i-l],[r+s,i+l],[r,i]];Lt(this.icon).maybeAppend(".backward","polygon").styles({points:c,fill:a})},e}(Ji),l8=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u5FEB\u8FDB"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this.iconSize,s=o/2,l=o/2/Math.pow(3,.5),c=[[r,i],[r,i-l],[r+s,i],[r,i+l],[r,i],[r-s,i-l],[r-s,i+l],[r,i]];Lt(this.icon).maybeAppend(".forward","polygon").styles({points:c,fill:a})},e}(Ji),c8=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u64AD\u653E"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this.iconSize,s=o/3*Math.pow(3,.5)*.8,l=[[r+s,i],[r-s/2,i-o/2*.8],[r-s/2,i+o/2*.8],[r+s,i]];Lt(this.icon).maybeAppend(".play","polygon").styles({points:l,fill:a})},e}(Ji),u8=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u6682\u505C"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this.iconSize,s=o/3,l=[[r-s,i-o/2],[r-s,i+o/2],[r-s/2,i+o/2],[r-s/2,i-o/2],[r-s,i-o/2],[r+s/2,i-o/2],[r+s/2,i+o/2],[r+s,i+o/2],[r+s,i-o/2]];Lt(this.icon).maybeAppend(".pause","polygon").styles({points:l,fill:a})},e}(Ji),h8=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u8303\u56F4\u65F6\u95F4"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this,s=o.iconSize,l=o.lineWidth,c=l;Lt(this.icon).maybeAppend(".left-line","line").styles({x1:r-s/2,y1:i-s/2,x2:r-s/2,y2:i+s/2,stroke:a,lineWidth:l}),Lt(this.icon).maybeAppend(".right-line","line").styles({x1:r+s/2,y1:i-s/2,x2:r+s/2,y2:i+s/2,stroke:a,lineWidth:l}),Lt(this.icon).maybeAppend(".left-arrow","line").styles({x1:r,y1:i,x2:r-s/2+c*2,y2:i,stroke:a,lineWidth:l,markerEnd:Nc(l*2,a)}),Lt(this.icon).maybeAppend(".right-arrow","line").styles({x1:r,y1:i,x2:r+s/2-c*2,y2:i,stroke:a,lineWidth:l,markerEnd:Nc(l*2,a)})},e}(Ji),f8=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u5355\u4E00\u65F6\u95F4"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this,s=o.iconSize,l=o.lineWidth;Lt(this.icon).maybeAppend(".line","line").styles({x1:r,y1:i-s/2,x2:r,y2:i+s/2,stroke:a,lineWidth:l});var c=l;Lt(this.icon).maybeAppend(".left-arrow","line").styles({x1:r-s/2-c*2,y1:i,x2:r-c*2,y2:i,stroke:a,lineWidth:l,markerEnd:Nc(l*2,a)}),Lt(this.icon).maybeAppend(".right-arrow","line").styles({x1:r+s/2+c*2,y1:i,x2:r+c*2,y2:i,stroke:a,lineWidth:l,markerEnd:Nc(l*2,a)})},e}(Ji),Vw=function(n){return[[-n/2,-n/2],[-n/2,n/2],[n/2,n/2]]},d8=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u6298\u7EBF\u56FE"},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this,s=o.iconSize,l=o.lineWidth,c=l,u=(s-c*2-l)/4,h=(s-c*2-l)/2,f=C([r-s/2+c,i+s/2-c*2],2),d=f[0],p=f[1];Lt(this.icon).maybeAppend(".coordinate","polyline").styles({points:Vw(s).map(function(v){var g=C(v,2),m=g[0],x=g[1];return[m+r,x+i]}),stroke:a,lineWidth:l}),Lt(this.icon).maybeAppend(".line","polyline").styles({points:[[d,p],[d+u,p-h],[d+u*2,p],[d+u*4,p-h*2]],stroke:a,lineWidth:l})},e}(Ji),p8=function(n){B(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"label",{get:function(){return"\u6761\u5F62\u56FE"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.data,r=this.attributes,i=r.x,a=r.y,o=r.color,s=this,l=s.iconSize,c=s.lineWidth,u=c,h=(l-u)/t.length,f=(l-u*2)/4,d=C([i-l/2+u*2,a+l/2-u],2),p=d[0],v=d[1];Lt(this.icon).maybeAppend(".coordinate","polyline").styles({points:Vw(l).map(function(g){var m=C(g,2),x=m[0],_=m[1];return[x+i,_+a]}),stroke:o,lineWidth:c}),Lt(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map(function(g,m){return{value:g,index:m}})).join(function(g){return g.append("line").attr("className","column").style("x1",function(m){var x=m.index;return p+h*x}).style("y1",v).style("x2",function(m){var x=m.index;return p+h*x}).style("y2",function(m){var x=m.value;return v-f*x}).styles({y1:v,stroke:o,lineWidth:c})})},e}(Ji),v8=function(n){B(e,n);function e(t){var r=n.call(this,Un({},{style:{color:"#d8d9d9"}},t))||this;return r.showBackground=!1,r}return e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.color,o=this,s=o.iconSize,l=o.lineWidth;Lt(this.icon).maybeAppend(".split","line").styles({x1:r,y1:i-s/2,x2:r,y2:i+s/2,stroke:a,lineWidth:l})},e}(Ji),gg=function(n){B(e,n);function e(){var t=n.apply(this,K([],C(arguments),!1))||this;return t.showBackground=!1,t}return Object.defineProperty(e.prototype,"padding",{get:function(){return Rn(0)},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.iconSize,r=this.attributes,i=r.x,a=r.y,o=r.speed,s=o===void 0?1:o,l=ev(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),c=me(t,20,1/0),u=20,h=N(N({},l),{x:i-c/2,y:a-u/2,width:c,height:u,defaultValue:s,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:t/5,placeholderFontSize:t/2,optionPadding:0,optionLabelFontSize:t/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});Lt(this.icon).maybeAppend(".speed",function(){return new a8({style:h})}).attr("className","speed").each(function(){this.update(h)})},e.tag="SpeedSelect",e}(Ji),mg=function(n){B(e,n);function e(t){var r=n.call(this,t)||this;return r.icon=r.appendChild(new qn({})),r.currentType=r.attributes.type,r}return e.prototype.getType=function(){return this.currentType},e.prototype.render=function(){var t=this,r=this.attributes,i=r.onChange,a=V(r,["onChange"]);Lt(this.icon).selectAll(".icon").data([this.currentType]).join(function(o){return o.append(function(s){var l,c=(l=t.toggles.find(function(u){var h=C(u,1),f=h[0];return f===s}))===null||l===void 0?void 0:l[1];if(!c)throw new Error("Invalid type: ".concat(s));return new c({})}).attr("className","icon").styles(a,!1).update({})},function(o){return o.styles({restStyles:a}).update({})},function(o){return o.remove()})},e.prototype.bindEvents=function(){var t=this,r=this.attributes.onChange;this.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation();var a=(t.toggles.findIndex(function(s){var l=C(s,1),c=l[0];return c===t.currentType})+1)%t.toggles.length,o=t.toggles[a][0];r==null||r(t.currentType),t.currentType=o,t.render()})},e.tag="ToggleIcon",e}(Tn),yg=function(n){B(e,n);function e(t){var r=n.call(this,Un({},{style:{type:"play"}},t))||this;return r.toggles=[["play",c8],["pause",u8]],r}return e}(mg),xg=function(n){B(e,n);function e(t){var r=n.call(this,Un({},{style:{type:"range"}},t))||this;return r.toggles=[["range",h8],["value",f8]],r}return e}(mg),bg=function(n){B(e,n);function e(t){var r=n.call(this,Un({},{style:{type:"column"}},t))||this;return r.toggles=[["line",d8],["column",p8]],r}return e}(mg),g8={reset:o8,speed:gg,backward:s8,playPause:yg,forward:l8,selectionType:xg,chartType:bg,split:v8},m8=function(n){B(e,n);function e(t){var r=n.call(this,Un({},e.defaultOptions,t))||this;return r.background=r.appendChild(new $o({})),r.functions=r.appendChild(new qn({})),r}return Object.defineProperty(e.prototype,"padding",{get:function(){return Rn(this.attributes.padding)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.style,r=t.x,i=t.y,a=t.width,o=t.height,s=Qt(this.attributes,"background");this.background.attr(N({x:r,y:i,width:a,height:o},s))},e.prototype.renderFunctions=function(){var t=this,r,i=this.attributes,a=i.functions,o=i.iconSize,s=i.iconSpacing,l=i.x,c=i.y,u=i.width,h=i.height,f=i.align,d=C(this.padding,4),p=d[1],v=d[3],g=a.reduce(function(_,S){return _.length&&S.length?_.concat.apply(_,K(["split"],C(S),!1)):_.concat.apply(_,K([],C(S),!1))},[]),m=g.length*(o+s)-s,x={left:v+o/2,center:(u-m)/2+o/2,right:u-m-v-p+o/2}[f]||0;(r=this.speedSelect)===null||r===void 0||r.destroy(),this.functions.removeChildren(),g.forEach(function(_,S){var b,y=g8[_],E={x:l+S*(o+s)+x,y:c+h/2,size:o};if(y===gg?(E.speed=t.attributes.speed,E.onSelect=function(M){return t.handleFunctionChange(_,{value:M})}):[yg,xg,bg].includes(y)?(E.onChange=function(M){return t.handleFunctionChange(_,{value:M})},y===yg&&(E.type=t.attributes.state==="play"?"pause":"play"),y===xg&&(E.type=t.attributes.selectionType==="range"?"value":"range"),y===bg&&(E.type=t.attributes.chartType==="line"?"column":"line")):E.onClick=function(){return t.handleFunctionChange(_,{value:_})},y===gg){var w=(b=t.ownerDocument)===null||b===void 0?void 0:b.defaultView;w&&(t.speedSelect=new y({style:N(N({},E),{zIndex:100})}),w.appendChild(t.speedSelect))}else t.functions.appendChild(new y({style:E}))})},e.prototype.disconnectedCallback=function(){var t;n.prototype.disconnectedCallback.call(this),(t=this.speedSelect)===null||t===void 0||t.destroy()},e.prototype.render=function(){this.renderBackground(),this.renderFunctions()},e.prototype.handleFunctionChange=function(t,r){var i=this.attributes.onChange;i==null||i(t,r)},e.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},e}(Tn),y8=function(n){B(e,n);function e(t){var r=n.call(this,Un({},e.defaultOptions,t))||this;return r.bindEvents(),r}return e.prototype.bindEvents=function(){var t=this;this.addEventListener("mouseenter",function(){t.attr("lineWidth",Math.ceil(+(t.style.r||0)/2))}),this.addEventListener("mouseleave",function(){t.attr("lineWidth",0)})},e.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},e}(Gh),x8=function(n){B(e,n);function e(t){return n.call(this,Un({},e.defaultOptions,t))||this}return e.prototype.renderBackground=function(){var t=this.attributes,r=t.x,i=t.y,a=t.width,o=t.height,s=Qt(this.attributes,"background");Lt(this).maybeAppend("background","rect").attr("className","background").styles(N({x:r-a/2,y:i-o/2,width:a,height:o},s))},e.prototype.renderIcon=function(){var t=this.attributes,r=t.x,i=t.y,a=t.iconSize,o=Qt(this.attributes,"icon"),s=1,l=a/2;Lt(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles(N({x1:r-s,y1:i-l,x2:r-s,y2:i+l},o)),Lt(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles(N({x1:r+s,y1:i-l,x2:r+s,y2:i+l},o))},e.prototype.renderBorder=function(){var t=this.attributes,r=t.x,i=t.y,a=t.width,o=t.height,s=t.type,l=Qt(this.attributes,"border"),c=s==="start"?+a/2:-a/2;Lt(this).maybeAppend("border","line").attr("className","border").styles(N({x1:c+r,y1:i-o/2,x2:c+r,y2:i+o/2},l))},e.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},e.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},e}(Tn);function b8(n,e){return typeof n=="number"?Hw(n):E8(n,e)}function E8(n,e){var t=new Date(n);switch(e){case"half-hour":case"hour":case"four-hour":return[0,6,12,18].includes(t.getHours())&&t.getMinutes()===0?Cr(t,`HH:mm
YYYY-MM-DD`):Cr(t,"HH:mm");case"half-day":return t.getHours()<12?`AM
`.concat(Cr(t,"YYYY-MM-DD")):"PM";case"day":return[1,10,20].includes(t.getDate())?Cr(t,`DD
YYYY-MM`):Cr(t,"DD");case"week":return t.getDate()<=7?Cr(t,`DD
YYYY-MM`):Cr(t,"DD");case"month":return[0,6].includes(t.getMonth())?Cr(t,`MM\u6708
YYYY`):Cr(t,"MM\u6708");case"season":return[0].includes(t.getMonth())?Cr(t,`MM\u6708
YYYY`):Cr(t,"MM\u6708");case"year":return Cr(t,"YYYY");default:return Cr(t,"YYYY-MM-DD HH:mm")}}function Hw(n){var e=String(Math.floor(n/3600)).padStart(2,"0"),t=String(Math.floor(n%3600/60)).padStart(2,"0"),r=String(Math.floor(n%60)).padStart(2,"0");return n<3600?"".concat(t,":").concat(r):"".concat(e,":").concat(t,":").concat(r)}var w8=function(n){B(e,n);function e(t){var r=n.call(this,Un({},e.defaultOptions,t))||this;r.axis=r.appendChild(new y9({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),r.timeline=r.appendChild(new e8({style:{onChange:function(h){r.handleSliderChange(h)}}})),r.controller=r.appendChild(new m8({})),r.states={},r.handleSliderChange=function(h){var f=function(){var d=r.states.values;return Array.isArray(d)?K([],C(d),!1):d}();r.setBySliderValues(h),r.dispatchOnChange(f)};var i=r.attributes,a=i.selectionType,o=i.chartType,s=i.speed,l=i.state,c=i.playMode,u=i.values;return r.states={chartType:o,playMode:c,selectionType:a,speed:s,state:l},r.setByTimebarValues(u),r}return Object.defineProperty(e.prototype,"data",{get:function(){var t=this.attributes.data,r=function(i,a){return i.time<a.time?-1:i.time>a.time?1:0};return t.sort(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){var t=this.attributes,r=t.x,i=t.y,a=t.width,o=t.height,s=t.type,l=t.controllerHeight,c=me(+o-l,0,+o),u=new mn(r,i+ +o-l,+a,l),h,f=0;s==="chart"?(f=35,h=new mn(r,i+c-f,+a,f)):h=new mn;var d=s==="time"?10:c,p=new mn(r,i+(s==="time"?c:c-d),+a,d-f);return{axisBBox:h,controllerBBox:u,timelineBBox:p}},enumerable:!1,configurable:!0}),e.prototype.setBySliderValues=function(t){var r,i,a=this.data,o=C(Array.isArray(t)?t:[0,t],2),s=o[0],l=o[1],c=a.length,u=a[Math.floor(s*c)],h=a[Math.ceil(l*c)-(Array.isArray(t)?0:1)];this.states.values=[(r=u==null?void 0:u.time)!==null&&r!==void 0?r:a[0].time,(i=h==null?void 0:h.time)!==null&&i!==void 0?i:1/0]},e.prototype.setByTimebarValues=function(t){var r,i,a,o=this.data,s=C(Array.isArray(t)?t:[void 0,t],2),l=s[0],c=s[1],u=o.find(function(f){var d=f.time;return d===l}),h=o.find(function(f){var d=f.time;return d===c});this.states.values=[(r=u==null?void 0:u.time)!==null&&r!==void 0?r:(i=o[0])===null||i===void 0?void 0:i.time,(a=h==null?void 0:h.time)!==null&&a!==void 0?a:1/0]},e.prototype.setByIndex=function(t){var r,i,a,o,s=this.data,l=C(t,2),c=l[0],u=l[1];this.states.values=[(i=(r=s[c])===null||r===void 0?void 0:r.time)!==null&&i!==void 0?i:s[0].time,(o=(a=this.data[u])===null||a===void 0?void 0:a.time)!==null&&o!==void 0?o:1/0]},Object.defineProperty(e.prototype,"sliderValues",{get:function(){var t=this.states,r=t.values,i=t.selectionType,a=C(Array.isArray(r)?r:[void 0,r],2),o=a[0],s=a[1],l=this.data,c=l.length,u=i==="value",h=function(){var d=l.findIndex(function(p){var v=p.time;return v===o});return u?0:d>-1?d/c:0},f=function(){if(s===1/0)return 1;var d=l.findIndex(function(p){var v=p.time;return v===s});return d>-1?d/c:u?.5:1};return[h(),f()]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this.states,r=t.values,i=t.selectionType,a=C(Array.isArray(r)?r:[this.data[0].time,r],2),o=a[0],s=a[1];return i==="value"?s:[o,s]},enumerable:!1,configurable:!0}),e.prototype.getDatumByRatio=function(t){var r=this.data,i=r.length,a=Math.floor(t*(i-1));return r[a]},Object.defineProperty(e.prototype,"chartHandleIconShape",{get:function(){var t=this.states.selectionType,r=this.space.timelineBBox.height;return t==="range"?function(i){return new x8({style:{type:i,height:r,iconSize:r/6}})}:function(){return new Gv({style:{x1:0,y1:-r/2,x2:0,y2:r/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),e.prototype.getChartStyle=function(t){var r=this,i=t.x,a=t.y,o=t.width,s=t.height,l=this.states,c=l.selectionType,u=l.chartType,h=this.data,f=this.attributes,d=f.type,p=f.labelFormatter,v=Qt(this.attributes,"chart"),g=v.type,m=V(v,["type"]),x=c==="range";if(d==="time")return N({handleIconShape:function(){return new y8({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:x?-15:0,autoFitLabel:x,handleSpacing:x?-15:0,trackFill:"#edeeef",trackLength:o,trackOpacity:.5,trackRadius:s/2,trackSize:s/2,type:c,values:this.sliderValues,formatter:function(b){if(p)return p(b);var y=r.getDatumByRatio(b).time;return typeof y=="number"?Hw(y):Cr(y,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(i,", ").concat(a,")"),zIndex:1},m);var _=c==="range"?5:0,S=h.map(function(b){var y=b.value;return y});return N({handleIconOffset:_,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:S,sparklineType:u,sparklineScale:.8,trackLength:o,trackSize:s,type:c,values:this.sliderValues,transform:"translate(".concat(i,", ").concat(a,")"),zIndex:1},m)},e.prototype.renderChart=function(t){t===void 0&&(t=this.space.timelineBBox),this.timeline.update(this.getChartStyle(t))},e.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},e.prototype.getAxisStyle=function(t){var r=this.data,i=this.attributes,a=i.interval,o=i.labelFormatter,s=Qt(this.attributes,"axis"),l=t.x,c=t.y,u=t.width,h=K(K([],C(r),!1),[{time:0}],!1).map(function(d,p,v){var g=d.time;return{label:"".concat(g),value:p/(v.length-1),time:g}}),f=N({startPos:[l,c],endPos:[l+u,c],data:h,labelFilter:function(d,p){return p<h.length-1},labelFormatter:function(d){var p=d.time;return o?o(p):b8(p,a)}},s);return f},e.prototype.renderAxis=function(t){t===void 0&&(t=this.space.axisBBox);var r=this.attributes.type;r==="chart"&&this.axis.update(this.getAxisStyle(t))},e.prototype.renderController=function(t){t===void 0&&(t=this.space.controllerBBox);var r=this.attributes.type,i=this.states,a=i.state,o=i.speed,s=i.selectionType,l=i.chartType,c=Qt(this.attributes,"controller"),u=this,h=N(N(N({},t),{iconSize:20,speed:o,state:a,selectionType:s,chartType:l,onChange:function(f,d){var p=d.value;switch(f){case"reset":u.internalReset();break;case"speed":u.handleSpeedChange(p);break;case"backward":u.internalBackward();break;case"playPause":p==="play"?u.internalPlay():u.internalPause();break;case"forward":u.internalForward();break;case"selectionType":u.handleSelectionTypeChange(p);break;case"chartType":u.handleChartTypeChange(p);break;default:break}}}),c);r==="time"&&(h.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(h)},e.prototype.dispatchOnChange=function(t){var r=this.data,i=this.attributes.onChange,a=this.states,o=a.values,s=a.selectionType,l=C(o,2),c=l[0],u=l[1],h=u===1/0?r.at(-1).time:u,f=s==="range"?[c,h]:h,d=function(p,v){return Array.isArray(p)?Array.isArray(v)?p[0]===v[0]&&(p[1]===v[1]||p[1]===1/0||v[1]===1/0):!1:Array.isArray(v)?!1:p===v};(!t||!d(t,f))&&(i==null||i(s==="range"?[c,h]:h))},e.prototype.internalReset=function(t){var r,i,a=this.states.selectionType;this.internalPause(),this.setBySliderValues(a==="range"?[0,1]:[0,0]),this.renderController(),this.updateSelection(),t||((i=(r=this.attributes)===null||r===void 0?void 0:r.onReset)===null||i===void 0||i.call(r),this.dispatchOnChange())},e.prototype.reset=function(){this.internalReset()},e.prototype.moveSelection=function(t,r){var i=this.data,a=i.length,o=this.states,s=o.values,l=o.selectionType,c=o.playMode,u=C(s,2),h=u[0],f=u[1],d=i.findIndex(function(_){var S=_.time;return S===h}),p=i.findIndex(function(_){var S=_.time;return S===f});p===-1&&(p=a);var v=t==="backward"?-1:1,g;l==="range"?c==="acc"?(g=[d,p+v],v===-1&&d===p&&(g=[d,a])):g=[d+v,p+v]:g=[d,p+v];var m=function(_){var S=C(_.sort(function(w,M){return w-M}),2),b=S[0],y=S[1],E=function(w){return me(w,0,a)};return y>a?l==="value"?[0,0]:c==="acc"?[E(b),E(b)]:[0,E(y-b)]:b<0?c==="acc"?[0,E(y)]:[E(b+a-y),a]:[E(b),E(y)]},x=m(g);return this.setByIndex(x),this.updateSelection(),x},e.prototype.internalBackward=function(t){var r,i,a=this.moveSelection("backward",t);return t||((i=(r=this.attributes)===null||r===void 0?void 0:r.onBackward)===null||i===void 0||i.call(r),this.dispatchOnChange()),a},e.prototype.backward=function(){this.internalBackward()},e.prototype.internalPlay=function(t){var r=this,i,a,o=this.data,s=this.attributes.loop,l=this.states.speed,c=l===void 0?1:l;this.playInterval=window.setInterval(function(){var u=r.internalForward();u[1]===o.length&&!s&&(r.internalPause(),r.renderController())},1e3/c),this.states.state="play",!t&&((a=(i=this.attributes)===null||i===void 0?void 0:i.onPlay)===null||a===void 0||a.call(i))},e.prototype.play=function(){this.internalPlay()},e.prototype.internalPause=function(t){var r,i;clearInterval(this.playInterval),this.states.state="pause",!t&&((i=(r=this.attributes)===null||r===void 0?void 0:r.onPause)===null||i===void 0||i.call(r))},e.prototype.pause=function(){this.internalPause()},e.prototype.internalForward=function(t){var r,i,a=this.moveSelection("forward",t);return t||((i=(r=this.attributes)===null||r===void 0?void 0:r.onForward)===null||i===void 0||i.call(r),this.dispatchOnChange()),a},e.prototype.forward=function(){this.internalForward()},e.prototype.handleSpeedChange=function(t){var r,i;this.states.speed=t;var a=this.states.state;a==="play"&&(this.internalPause(!0),this.internalPlay(!0)),(i=(r=this.attributes)===null||r===void 0?void 0:r.onSpeedChange)===null||i===void 0||i.call(r,t)},e.prototype.handleSelectionTypeChange=function(t){var r,i;this.states.selectionType=t,this.renderChart(),(i=(r=this.attributes)===null||r===void 0?void 0:r.onSelectionTypeChange)===null||i===void 0||i.call(r,t)},e.prototype.handleChartTypeChange=function(t){var r,i;this.states.chartType=t,this.renderChart(),(i=(r=this.attributes)===null||r===void 0?void 0:r.onChartTypeChange)===null||i===void 0||i.call(r,t)},e.prototype.render=function(){var t=this.space,r=t.axisBBox,i=t.controllerBBox,a=t.timelineBBox;this.renderController(i),this.renderAxis(r),this.renderChart(a),this.states.state==="play"&&this.internalPlay()},e.prototype.destroy=function(){n.prototype.destroy.call(this),this.internalPause(!0)},e.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},e}(Tn),_8=function(n){return ss(n,"Date")},S8=_8;const T8=["timestamp","time","date","datetime"],pm=class extends _r{constructor(t,r){super(t,Object.assign({},pm.defaultOptions,r));k(this,"timebar");k(this,"canvas");k(this,"wrapper");k(this,"originalData");this.backup(),this.upsertTimebar()}get padding(){return Ns(this.options.padding)}play(){var t;(t=this.timebar)==null||t.play()}pause(){var t;(t=this.timebar)==null||t.pause()}forward(){var t;(t=this.timebar)==null||t.forward()}backward(){var t;(t=this.timebar)==null||t.backward()}reset(){var t;(t=this.timebar)==null||t.reset()}update(t){super.update(t),this.backup(),Object.keys(t).forEach(r=>{switch(r){case"position":this.upsertWrapper();break;default:this.upsertTimebar();break}})}backup(){this.originalData=Yw(this.context.graph.getData())}upsertTimebar(){const{canvas:t}=this.context,p=this.options,{onChange:r,timebarType:i,data:a,x:o,y:s,width:l,height:c,mode:u}=p,h=Ce(p,["onChange","timebarType","data","x","y","width","height","mode"]),f=t.getSize(),[d]=this.padding;this.upsertCanvas().ready.then(()=>{var g;const v=Se(at({x:f[0]/2-l/2,y:d,onChange:m=>{const x=(xr(m)?m:[m,m]).map(_=>S8(_)?_.getTime():_);this.options.mode==="modify"?this.filterElements(x):this.hiddenElements(x),r==null||r(x)}},h),{data:a.map(m=>fe(m)?{time:m,value:0}:m),width:l,height:c,type:i});this.timebar?this.timebar.update(v):(this.timebar=new w8({style:v}),(g=this.canvas)==null||g.appendChild(this.timebar))})}upsertWrapper(){var o;if(!this.wrapper){const s=document.createElement("div");s.style.position="absolute",this.wrapper=s}const{x:t,y:r,className:i,position:a}=this.options;return i&&(this.wrapper.className=i),fe(t)||fe(r)?Object.assign(this.wrapper.style,{left:`${t!=null?t:0}px`,top:`${r!=null?r:0}px`}):Object.assign(this.wrapper.style,{[a==="top"?"bottom":"top"]:"unset",[a==="top"?"top":"bottom"]:"0px"}),(o=this.context.canvas.getContainer())==null||o.appendChild(this.wrapper),this.wrapper}upsertCanvas(){var s,l;const t=this.upsertWrapper();if(this.canvas)return this.canvas;const{height:r}=this.options,[i]=this.context.canvas.getSize(),[a,,o]=this.padding;return this.canvas=new hu({container:t,width:i,height:r+a+o,renderer:((l=(s=this.context.options).renderer)==null?void 0:l.call(s,"main"))||new Of,supportsMutipleCanvasesInOneContainer:!0}),this.canvas}filterElements(t){return Pt(this,null,function*(){var c;if(!this.originalData)return;const{elementTypes:r,getTime:i}=this.options,{graph:a,element:o}=this.context,s=Yw(this.originalData);r.forEach(u=>{const h=`${u}s`;s[h]=(this.originalData[h]||[]).filter(f=>{const d=i(f);return!!Xw(d,t)})});const l=[...s.nodes,...s.combos].map(u=>it(u));s.edges=s.edges.filter(u=>{const h=u.source,f=u.target;return l.includes(h)&&l.includes(f)}),a.setData(s),yield(c=o.draw({animation:!1,silence:!0}))==null?void 0:c.finished})}hiddenElements(t){const{graph:r}=this.context,{elementTypes:i,getTime:a}=this.options,o=[],s=[];i.forEach(l=>{var h;const c=`${l}s`;(((h=this.originalData)==null?void 0:h[c])||[]).forEach(f=>{const d=it(f),p=a(f);Xw(p,t)?s.push(d):o.push(d)})}),r.hideElement(o,!1),r.showElement(s,!1)}destroy(){var r,i,a;const{graph:t}=this.context;this.originalData&&t.setData(at({},this.originalData)),(r=this.timebar)==null||r.destroy(),(i=this.canvas)==null||i.destroy(),(a=this.wrapper)==null||a.remove(),this.originalData=void 0,this.wrapper=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}};let Vf=pm;k(Vf,"defaultOptions",{position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:t=>P8(t,T8,void 0),loop:!1});const Yw=n=>{const{nodes:e=[],edges:t=[],combos:r=[]}=n;return{nodes:[...e],edges:[...t],combos:[...r]}},Xw=(n,e)=>{if(fe(e))return n===e;const[t,r]=e;return n>=t&&n<=r},P8=(n,e,t)=>{var r;for(let i=0;i<e.length;i++){const a=e[i],o=(r=n.data)==null?void 0:r[a];if(o)return o}return t};function M8(n){const e={top:"unset",right:"unset",bottom:"unset",left:"unset"};return n.split("-").forEach(r=>{e[r]="8px"}),e.flexDirection=n.startsWith("top")||n.startsWith("bottom")?"row":"column",e}const C8=`
  .g6-toolbar {
    position: absolute;
    z-index: 100;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    opacity: 0.65;
  }
  .g6-toolbar .g6-toolbar-item {
    display: inline-block;
    width: 16px;
    height: 16px;
    padding: 4px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .g6-toolbar .g6-toolbar-item:hover {
    background-color: #f0f0f0;
  }

  .g6-toolbar .g6-toolbar-item svg {
    display: inline-block;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
`,A8=`
  <svg>
    <symbol id="zoom-in" viewBox="64 64 896 896">
      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="zoom-out" viewBox="64 64 896 896">
      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="edit" viewBox="64 64 896 896">
      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>
    </symbol>
    <symbol id="delete" viewBox="64 64 896 896">
      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>
    </symbol>
    <symbol id="redo" viewBox="64 64 896 896">
      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>
    </symbol>
    <symbol id="undo" viewBox="64 64 896 896">
      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>
    </symbol>
    <symbol id="export" viewBox="64 64 896 896">
      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>
    </symbol>
    <symbol id="auto-fit" viewBox="64 64 896 896">
      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>
      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>
    </symbol>
    <symbol id="reset" viewBox="64 64 896 896">
      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>
    </symbol>
    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">
      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>
    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">
      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>
  </svg>
`,id=class extends _r{constructor(t,r){super(t,Object.assign({},id.defaultOptions,r));k(this,"$element",ec("toolbar",!1));k(this,"onToolbarItemClick",t=>{const{onClick:r}=this.options;if(t.target instanceof Element&&t.target.className.includes("g6-toolbar-item")){const i=t.target.getAttribute("value");r==null||r(i,t.target)}});const i=this.context.canvas.getContainer();this.$element.style.display="flex",i.appendChild(this.$element),nv("g6-toolbar-css","style",{},C8,document.head),nv("g6-toolbar-svgicon","div",{display:"none"},A8),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(r)}update(t){return Pt(this,null,function*(){sd(id.prototype,this,"update").call(this,t);const{className:r,position:i,style:a}=this.options;this.$element.className=`g6-toolbar ${r||""}`,Object.assign(this.$element.style,a,M8(i)),this.$element.innerHTML=yield this.getDOMContent()})}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return Pt(this,null,function*(){return(yield this.options.getItems()).map(r=>`
          <div class="g6-toolbar-item" value="${r.value}">
            <svg aria-hidden="true" focusable="false">
              <use xlink:href="#${r.id}"></use>
            </svg>
          </div>`).join("")})}};let Hf=id;k(Hf,"defaultOptions",{position:"top-left"});function Eg(n){var e=document.createElement("div");e.innerHTML=n;var t=e.childNodes[0];return t&&e.contains(t)&&e.removeChild(t),t}function O8(n,e){return!n||!e?n:n.replace(/\\?\{([^{}]+)\}/g,function(t,r){return t.charAt(0)==="\\"?t.slice(1):e[r]===void 0?"":e[r]})}var N8=O8,jw=function(n,e){if(e==null){n.innerHTML="";return}n.replaceChildren?Array.isArray(e)?n.replaceChildren.apply(n,K([],C(e),!1)):n.replaceChildren(e):(n.innerHTML="",Array.isArray(e)?e.forEach(function(t){return n.appendChild(t)}):n.appendChild(e))};function wg(n){return n===void 0&&(n=""),{CONTAINER:"".concat(n,"tooltip"),TITLE:"".concat(n,"tooltip-title"),LIST:"".concat(n,"tooltip-list"),LIST_ITEM:"".concat(n,"tooltip-list-item"),NAME:"".concat(n,"tooltip-list-item-name"),MARKER:"".concat(n,"tooltip-list-item-marker"),NAME_LABEL:"".concat(n,"tooltip-list-item-name-label"),VALUE:"".concat(n,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(n,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(n,"tooltip-crosshair-y")}}var $w={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function R8(n){var e;n===void 0&&(n="");var t=wg(n);return e={},e[".".concat(t.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},e[".".concat(t.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},e[".".concat(t.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},e[".".concat(t.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},e[".".concat(t.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},e[".".concat(t.NAME)]={display:"flex","align-items":"center","max-width":"216px"},e[".".concat(t.NAME_LABEL)]=N({flex:1},$w),e[".".concat(t.VALUE)]=N({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},$w),e[".".concat(t.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e[".".concat(t.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e}var k8=function(n){B(e,n);function e(t){var r=this,i,a,o=(a=(i=t.style)===null||i===void 0?void 0:i.template)===null||a===void 0?void 0:a.prefixCls,s=wg(o);return r=n.call(this,t,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(s.CONTAINER,'"></div>'),title:'<div class="'.concat(s.TITLE,'"></div>'),item:'<li class="'.concat(s.LIST_ITEM,`" data-index={index}>
        <span class="`).concat(s.NAME,`">
          <span class="`).concat(s.MARKER,`" style="background:{color}"></span>
          <span class="`).concat(s.NAME_LABEL,`" title="{name}">{name}</span>
        </span>
        <span class="`).concat(s.VALUE,`" title="{value}">{value}</span>
      </li>`)},style:R8(o)})||this,r.timestamp=-1,r.prevCustomContentKey=r.attributes.contentKey,r.initShape(),r.render(r.attributes,r),r}return Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"elementSize",{get:function(){var t=this.element.offsetWidth,r=this.element.offsetHeight;return{width:t,height:r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var t=this.attributes,r=t.data,i=t.template;return r.map(function(a,o){var s=a.name,l=s===void 0?"":s,c=a.color,u=c===void 0?"black":c,h=a.index,f=V(a,["name","color","index"]),d=N({name:l,color:u,index:h!=null?h:o},f);return Eg(N8(i.item,d))})},enumerable:!1,configurable:!0}),e.prototype.render=function(t,r){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.destroy=function(){var t;(t=this.element)===null||t===void 0||t.remove(),n.prototype.destroy.call(this)},e.prototype.show=function(t,r){var i=this;if(t!==void 0&&r!==void 0){var a=this.element.style.visibility==="hidden",o=function(){i.attributes.x=t!=null?t:i.attributes.x,i.attributes.y=r!=null?r:i.attributes.y,i.updatePosition()};a?this.closeTransition(o):o()}this.element.style.visibility="visible"},e.prototype.hide=function(t,r){t===void 0&&(t=0),r===void 0&&(r=0);var i=this.attributes.enterable;i&&this.isCursorEntered(t,r)||(this.element.style.visibility="hidden")},e.prototype.initShape=function(){var t=this.attributes.template;this.element=Eg(t.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var t=this.attributes.content;t&&(typeof t=="string"?this.element.innerHTML=t:jw(this.element,t))}},e.prototype.renderHTMLTooltipElement=function(){var t,r,i=this.attributes,a=i.template,o=i.title,s=i.enterable,l=i.style,c=i.content,u=wg(a.prefixCls),h=this.element;if(this.element.style.pointerEvents=s?"auto":"none",c)this.renderCustomContent();else{o?(h.innerHTML=a.title,h.getElementsByClassName(u.TITLE)[0].innerHTML=o):(r=(t=h.getElementsByClassName(u.TITLE))===null||t===void 0?void 0:t[0])===null||r===void 0||r.remove();var f=this.HTMLTooltipItemsElements,d=document.createElement("ul");d.className=u.LIST,jw(d,f);var p=this.element.querySelector(".".concat(u.LIST));p?p.replaceWith(d):h.appendChild(d)}pD(h,l)},e.prototype.getRelativeOffsetFromCursor=function(t){var r=this.attributes,i=r.position,a=r.offset,o=t||i,s=o.split("-"),l={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},c=this.elementSize,u=c.width,h=c.height,f=[-u/2,-h/2];return s.forEach(function(d){var p=C(f,2),v=p[0],g=p[1],m=C(l[d],2),x=m[0],_=m[1];f=[v+(u/2+a[0])*x,g+(h/2+a[1])*_]}),f},e.prototype.setOffsetPosition=function(t){var r=C(t,2),i=r[0],a=r[1],o=this.attributes,s=o.x,l=s===void 0?0:s,c=o.y,u=c===void 0?0:c,h=o.container,f=h.x,d=h.y;this.element.style.left="".concat(+l+f+i,"px"),this.element.style.top="".concat(+u+d+a,"px")},e.prototype.updatePosition=function(){var t=this.attributes.showDelay,r=t===void 0?60:t,i=Date.now();this.timestamp>0&&i-this.timestamp<r||(this.timestamp=i,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},e.prototype.autoPosition=function(t){var r=C(t,2),i=r[0],a=r[1],o=this.attributes,s=o.x,l=o.y,c=o.bounding,u=o.position;if(!c)return[i,a];var h=this.element,f=h.offsetWidth,d=h.offsetHeight,p=C([+s+i,+l+a],2),v=p[0],g=p[1],m={left:"right",right:"left",top:"bottom",bottom:"top"},x=c.x,_=c.y,S=c.width,b=c.height,y={left:v<x,right:v+f>x+S,top:g<_,bottom:g+d>_+b},E=[];u.split("-").forEach(function(M){y[M]?E.push(m[M]):E.push(M)});var w=E.join("-");return this.getRelativeOffsetFromCursor(w)},e.prototype.isCursorEntered=function(t,r){if(this.element){var i=this.element.getBoundingClientRect(),a=i.x,o=i.y,s=i.width,l=i.height;return new mn(a,o,s,l).isPointIn(t,r)}return!1},e.prototype.closeTransition=function(t){var r=this,i=this.element.style.transition;this.element.style.transition="none",t(),setTimeout(function(){r.element.style.transition=i},10)},e.tag="tooltip",e}(Tn);const vm=class extends _r{constructor(t,r){super(t,Object.assign({},vm.defaultOptions,r));k(this,"currentTarget",null);k(this,"tooltipElement",null);k(this,"container",null);k(this,"isEnable",t=>{const{enable:r}=this.options;return typeof r=="function"?r(t):r});k(this,"onClick",t=>{const{target:{id:r}}=t;this.currentTarget===r?(this.currentTarget=null,this.hide(t)):(this.currentTarget=r,this.show(t))});k(this,"onPointerMove",t=>{const{target:r}=t;!this.currentTarget||r.id===this.currentTarget||this.show(t)});k(this,"onPointerLeave",t=>{this.hide(t),this.currentTarget=null});k(this,"onCanvasMove",t=>{this.hide(t),this.currentTarget=null});k(this,"onPointerEnter",t=>{this.show(t)});k(this,"showById",t=>{const r={target:{id:t}};this.show(r)});k(this,"getElementData",(t,r)=>{const{model:i}=this.context;switch(r){case"node":return i.getNodeData([t]);case"edge":return i.getEdgeData([t]);case"combo":return i.getComboData([t]);default:return[]}});k(this,"show",t=>{const{client:r,target:{id:i}}=t;if(Jp(t.target)||!this.tooltipElement||!this.isEnable(t))return;const a=this.context.graph.getElementType(i),{getContent:o,title:s}=this.options;this.currentTarget=i;const l=this.getElementData(i,a);let c,u;if(r)c=r.x,u=r.y;else{const f=wr(l,"0.style",{x:0,y:0});c=f.x,u=f.y}let h={};if(o)h.content=o(t,l);else{const f=this.context.graph.getElementRenderStyle(i),d=a==="node"?f.fill:f.stroke;h={title:s||a,data:l.map(p=>({name:"ID",value:p.id||`${p.source} -> ${p.target}`,color:d}))}}this.tooltipElement.update(at({x:c,y:u,style:{".tooltip":{visibility:"visible"}}},h))});k(this,"hide",t=>{var a;if(!t){(a=this.tooltipElement)==null||a.hide();return}if(!this.tooltipElement||!this.isEnable(t))return;const{client:{x:r,y:i}}=t;this.tooltipElement.hide(r,i)});k(this,"initTooltip",()=>{var x;const{canvas:t}=this.context,{center:r}=t.getBounds(),i=t.getContainer(),{top:a,left:o}=i.getBoundingClientRect(),{style:s,position:l,enterable:c,container:u={x:-o,y:-a},title:h,offset:f}=this.options,[d,p]=r,[v,g]=t.getSize(),m=new k8({className:"tooltip",style:{x:d,y:p,container:u,title:h,bounding:{x:0,y:0,width:v,height:g},position:l,enterable:c,offset:f,style:s}});return(x=this.container)==null||x.appendChild(m.HTMLTooltipElement),m});this.render(),this.bindEvents()}getEvents(){return this.options.trigger==="click"?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerenter":this.onPointerEnter,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerenter":this.onPointerEnter,"edge:pointermove":this.onPointerMove,"combo:pointerenter":this.onPointerEnter,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(t){var r;this.unbindEvents(),super.update(t),this.tooltipElement&&((r=this.container)==null||r.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){const{canvas:t}=this.context,r=t.getContainer();r&&(this.container=r,this.tooltipElement=this.initTooltip())}unbindEvents(){const{graph:t}=this.context,r=this.getEvents();Object.keys(r).forEach(i=>{t.off(i,r[i])})}bindEvents(){const{graph:t}=this.context,r=this.getEvents();Object.keys(r).forEach(i=>{t.on(i,r[i])})}destroy(){var t;this.unbindEvents(),this.tooltipElement&&((t=this.container)==null||t.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}};let Yf=vm;k(Yf,"defaultOptions",{trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}});let gl;function Kw(n,e){return gl||(gl=document.createElement("canvas")),gl.width=n,gl.height=e,gl.getContext("2d").clearRect(0,0,n,e),gl}function L8(n,e,t,r){return Pt(this,null,function*(){const i=Kw(n,e),a=i.getContext("2d"),{rotate:o,opacity:s,textFill:l,textFontSize:c,textFontFamily:u,textFontVariant:h,textFontWeight:f,textAlign:d,textBaseline:p}=r;return a.textAlign=d,a.textBaseline=p,a.translate(n/2,e/2),a.font=`${c}px ${u} ${h} ${f}`,o&&a.rotate(o),s&&(a.globalAlpha=s),l&&(a.fillStyle=l,a.fillText(`${t}`,0,0)),i.toDataURL()})}function I8(n,e,t,r){return Pt(this,null,function*(){const i=Kw(n,e),a=i.getContext("2d"),{rotate:o,opacity:s}=r;o&&a.rotate(o),s&&(a.globalAlpha=s);const l=new Image;return l.crossOrigin="anonymous",l.src=t,new Promise(c=>{l.onload=function(){const u=n>l.width?(n-l.width)/2:0,h=e>l.height?(e-l.height)/2:0;a.drawImage(l,0,0,l.width,l.height,u,h,n-u*2,e-h*2),c(i.toDataURL())}})})}const ad=class extends _r{constructor(t,r){super(t,Object.assign({},ad.defaultOptions,r));k(this,"$element",ec("watermark"));this.context.canvas.getContainer().appendChild(this.$element),this.update(r)}update(t){return Pt(this,null,function*(){sd(ad.prototype,this,"update").call(this,t);const c=this.options,{width:r,height:i,text:a,imageURL:o}=c,s=Ce(c,["width","height","text","imageURL"]);Object.keys(s).forEach(u=>{u.startsWith("background")&&(this.$element.style[u]=t[u])});const l=o?yield I8(r,i,o,s):yield L8(r,i,a,s);this.$element.style.backgroundImage=`url(${l})`})}destroy(){super.destroy(),this.$element.remove()}};let Xf=ad;k(Xf,"defaultOptions",{width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"});const D8=["#7E92B5","#F4664A","#FFBE3A"],B8={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},F8={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function Zw(n){const{bgColor:e,textColor:t,nodeColor:r,nodeColorDisabled:i,nodeStroke:a,nodeHaloStrokeOpacityActive:o=.15,nodeHaloStrokeOpacitySelected:s=.25,nodeOpacityDisabled:l=.06,nodeIconOpacityInactive:c=.85,nodeOpacityInactive:u=.25,nodeBadgePalette:h=D8,nodePaletteOptions:f=B8,edgeColor:d,edgeColorDisabled:p,edgePaletteOptions:v=F8,comboColor:g,comboColorDisabled:m,comboStroke:x,comboStrokeDisabled:_,edgeColorInactive:S}=n;return{background:e,node:{palette:f,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:h,fill:r,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:t,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:r,portLineWidth:1,portStroke:a,portStrokeOpacity:.65,size:32,stroke:a,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:s,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:a},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:o},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:a,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:u,donutOpacity:u,fillOpacity:u,iconOpacity:c,labelFill:t,labelFillOpacity:u,strokeOpacity:u},disabled:{badgeBackgroundOpacity:.25,donutOpacity:l,fill:i,fillOpacity:l,iconFill:i,iconOpacity:.25,labelFill:t,labelFillOpacity:.25,strokeOpacity:l}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:v,style:{badgeBackgroundFill:d,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:t,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:d,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:S,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:p,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:g,halo:!1,haloLineWidth:12,haloStroke:x,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:t,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:x},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:m,fillOpacity:.25,labelOpacity:.25,stroke:_,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}const G8=Zw({bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:{type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"}),z8=Zw({bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"});class ml extends Pp{beforeDraw(e,t){return e}}class W8 extends ml{beforeDraw(e){const{model:t}=this.context,r=e.add.combos,i=a=>{const o=[];return a.forEach((s,l)=>{const u=t.getAncestorsData(l,"combo").map(h=>it(h)).reverse();o.push([l,s,u.length])}),new Map(o.sort(([,,s],[,,l])=>l-s).map(([s,l])=>[s,l]))};return e.add.combos=i(r),e.update.combos=i(e.update.combos),e}}function yo(n,e,t,r,i){const a=it(r),o=`${t}s`,s=i?r:n.add[o].get(a)||n.update[o].get(a)||n.remove[o].get(a)||r;Object.entries(n).forEach(([l,c])=>{e===l?c[o].set(a,s):c[o].delete(a)})}class U8 extends ml{beforeDraw(e,t){if(t.stage==="visibility")return e;const{model:r}=this.context,{add:i,update:a}=e,o=[...e.update.combos.entries(),...e.add.combos.entries()];for(;o.length;){const[s,l]=o.pop();if(oi(l)){const c=r.getDescendantsData(s),u=c.map(it),{internal:h,external:f}=cx(u,d=>r.getRelatedEdgesData(d));c.forEach(d=>{const p=it(d),v=o.findIndex(([m])=>m===p);v!==-1&&o.splice(v,1);const g=r.getElementType(p);yo(e,"remove",g,d)}),h.forEach(d=>yo(e,"remove","edge",d)),f.forEach(d=>{var g;const p=it(d);((g=this.context.element)==null?void 0:g.getElement(p))?a.edges.set(p,d):i.edges.set(p,d)})}else{const c=r.getChildrenData(s),u=c.map(it),{edges:h}=cx(u,f=>r.getRelatedEdgesData(f));[...c,...h].forEach(f=>{var g;const d=it(f),p=r.getElementType(d);((g=this.context.element)==null?void 0:g.getElement(d))?yo(e,"update",p,f):yo(e,"add",p,f),p==="combo"&&o.push([d,f])})}}return e}}const qw=(n,e,t,r)=>{const i=`${t}s`,a=it(r);!n.add[i].has(a)&&!n.update[i].has(a)&&n[e][i].set(it(r),r)};class V8 extends ml{getElement(e){return this.context.element.getElement(e)}handleExpand(e,t){if(qw(t,"add","node",e),oi(e))return;const r=it(e);qw(t,"add","node",e),this.context.model.getRelatedEdgesData(r,"out").forEach(o=>{yo(t,"add","edge",o)}),this.context.model.getChildrenData(r).forEach(o=>{this.handleExpand(o,t)})}beforeDraw(e){const{graph:t,model:r}=this.context,{add:{nodes:i,edges:a},update:{nodes:o}}=e,s=new Map,l=new Map;i.forEach((u,h)=>{oi(u)&&s.set(h,u)}),a.forEach(u=>{if(t.getElementType(u.source)!=="node")return;const h=t.getNodeData(u.source);oi(h)&&s.set(u.source,h)}),o.forEach((u,h)=>{const f=this.getElement(h);if(!f)return;const d=f.attributes.collapsed;oi(u)?d||s.set(h,u):d&&l.set(h,u)});const c=new Set;return s.forEach((u,h)=>{r.getDescendantsData(h).forEach(d=>{const p=it(d);if(c.has(p))return;yo(e,"remove","node",d),r.getRelatedEdgesData(p).forEach(g=>{yo(e,"remove","edge",g)}),c.add(p)})}),l.forEach((u,h)=>{if(r.getAncestorsData(h,$a).some(oi)){yo(e,"remove","node",u);return}this.handleExpand(u,e)}),e}}function Jw(n,e,t,r=!1){const i=bp[n][e];!r&&i?i!==t&&Gr.warn(`The extension ${e} of ${n} has been registered before.`):Object.assign(bp[n],{[e]:t})}class jf{constructor(e){k(this,"type");this.type=e}}class Vn extends jf{constructor(t,r){super(t);k(this,"data");this.data=r}}class Wi extends jf{constructor(t,r,i,a){super(t);k(this,"animationType");k(this,"animation");k(this,"data");this.animationType=r,this.animation=i,this.data=a}}class yl extends jf{constructor(t,r,i){super(t);k(this,"elementType");k(this,"data");this.elementType=r,this.data=i}}class $f extends jf{constructor(t,r){super(t);k(this,"data");this.data=r}}function er(n,e){n.emit(e.type,e)}function H8(n){if(!n)return null;if(n instanceof qy)return{type:"canvas",element:n};let e=n;for(;e;){if(Jl(e))return{type:"node",element:e};if(gx(e))return{type:"edge",element:e};if(jp(e))return{type:"combo",element:e};e=e.parentElement}return null}class Y8{constructor(e){k(this,"context");k(this,"tasks",[]);k(this,"animations",new Set);this.context=e}getTasks(){const e=[...this.tasks];return this.tasks=[],e}add(e,t){this.tasks.push([e,t])}animate(e,t,r){var o,s,l;(o=t==null?void 0:t.before)==null||o.call(t);const i=this.getTasks().map(([c,u])=>{var g,m,x;const{element:h,elementType:f,stage:d}=c,p=WA(this.context.options,f,d,e);(g=u==null?void 0:u.before)==null||g.call(u);const v=XA(h,this.inferStyle(c,r),p);return v?((m=u==null?void 0:u.beforeAnimate)==null||m.call(u,v),v.finished.then(()=>{var _,S;(_=u==null?void 0:u.afterAnimate)==null||_.call(u,v),(S=u==null?void 0:u.after)==null||S.call(u),this.animations.delete(v)})):(x=u==null?void 0:u.after)==null||x.call(u),v}).filter(Boolean);i.forEach(c=>this.animations.add(c));const a=Ep(i);return a?((s=t==null?void 0:t.beforeAnimate)==null||s.call(t,a),a.finished.then(()=>{var c,u;(c=t==null?void 0:t.afterAnimate)==null||c.call(t,a),(u=t==null?void 0:t.after)==null||u.call(t),this.release()})):(l=t==null?void 0:t.after)==null||l.call(t),a}inferStyle(e,t){const{element:r,elementType:i,stage:a,originalStyle:o,modifiedStyle:s}=e,l=at({},o),c=at({},s),u=()=>{var h;return(h=zu(r,"opacity"))!=null?h:Ou("opacity")};if(a==="enter")Object.assign(l,{opacity:0});else if(a==="exit")Object.assign(c,{opacity:0});else if(a==="show")Object.assign(l,{opacity:0}),Object.assign(c,{opacity:u()});else if(a==="hide")Object.assign(l,{opacity:u()}),Object.assign(c,{opacity:0});else if(a==="collapse"){const{collapse:h}=t||{},{target:f,descendants:d,position:p}=h;if(i==="node"){if(d.includes(r.id)){const[v,g,m]=p;Object.assign(c,{x:v,y:g,z:m})}}else if(i==="combo"){if(r.id===f||d.includes(r.id)){const[v,g]=p;Object.assign(c,{x:v,y:g,childrenNode:l.childrenNode})}}else i==="edge"&&Object.assign(c,{sourceNode:l.sourceNode,targetNode:l.targetNode})}else if(a==="expand"){const{expand:h}=t||{},{target:f,descendants:d,position:p}=h;if(i==="node"){if(r.id===f||d.includes(r.id)){const[v,g,m]=p;Object.assign(l,{x:v,y:g,z:m})}}else if(i==="combo"){if(r.id===f||d.includes(r.id)){const[v,g,m]=p;Object.assign(l,{x:v,y:g,z:m,childrenNode:c.childrenNode})}}else i==="edge"&&Object.assign(l,{sourceNode:c.sourceNode,targetNode:c.targetNode})}return[l,c]}stop(){this.animations.forEach(e=>e.cancel())}clear(){this.tasks=[]}release(){var r,i;const{canvas:e}=this.context,t=(i=(r=e.document)==null?void 0:r.timeline)==null?void 0:i.animationsWithPromises;t&&(e.document.timeline.animationsWithPromises=t.filter(a=>a.playState!=="finished"))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class X8{constructor(e){k(this,"context");k(this,"batchCount",0);this.context=e}emit(e){const{graph:t}=this.context;t.emit(e.type,e)}startBatch(e=!0){this.batchCount++,this.batchCount===1&&this.emit(new Vn(Tt.BATCH_START,{initiate:e}))}endBatch(){this.batchCount--,this.batchCount===0&&this.emit(new Vn(Tt.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class j8 extends Tp{constructor(t){super(t);k(this,"currentTarget",null);k(this,"currentTargetType",null);k(this,"category","behavior");k(this,"forwardCanvasEvents",t=>{const{target:r}=t,i=H8(r);if(!i)return;const{graph:a,canvas:o}=this.context,{type:s,element:l}=i;if("destroyed"in l&&(Jp(l)||l.destroyed))return;const{type:c,detail:u,button:h}=t,f=Se(at({},t),{target:l,targetType:s,originalTarget:r});c===ht.POINTER_MOVE&&(this.currentTarget!==l&&(this.currentTarget&&a.emit(`${this.currentTargetType}:${ht.POINTER_LEAVE}`,Se(at({},f),{type:ht.POINTER_LEAVE,target:this.currentTarget})),l&&(Object.assign(f,{type:ht.POINTER_ENTER}),a.emit(`${s}:${ht.POINTER_ENTER}`,f))),this.currentTarget=l,this.currentTargetType=s),c===ht.CLICK&&h===2||(a.emit(`${s}:${c}`,f),a.emit(c,f)),c===ht.CLICK&&u===2&&(Object.assign(f,{type:ht.DBLCLICK}),a.emit(`${s}:${ht.DBLCLICK}`,f),a.emit(ht.DBLCLICK,f)),c===ht.POINTER_DOWN&&h===2&&(Object.assign(f,{type:ht.CONTEXT_MENU,preventDefault:()=>{var d;(d=o.getContainer())==null||d.addEventListener(ht.CONTEXT_MENU,p=>p.preventDefault(),{once:!0})}}),a.emit(`${s}:${ht.CONTEXT_MENU}`,f),a.emit(ht.CONTEXT_MENU,f))});k(this,"forwardContainerEvents",t=>{this.context.graph.emit(t.type,t)});this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(t){this.setExtensions(t)}forwardEvents(){const t=this.context.canvas.getContainer();t&&[Ps.KEY_DOWN,Ps.KEY_UP].forEach(i=>{t.addEventListener(i,this.forwardContainerEvents)});const r=this.context.canvas.document;r&&[ht.CLICK,ht.DBLCLICK,ht.POINTER_OVER,ht.POINTER_LEAVE,ht.POINTER_ENTER,ht.POINTER_MOVE,ht.POINTER_OUT,ht.POINTER_DOWN,ht.POINTER_UP,ht.CONTEXT_MENU,ht.DRAG_START,ht.DRAG,ht.DRAG_END,ht.DRAG_ENTER,ht.DRAG_OVER,ht.DRAG_LEAVE,ht.DROP,ht.WHEEL].forEach(i=>{r.addEventListener(i,this.forwardCanvasEvents)})}destroy(){const t=this.context.canvas.getContainer();t&&[Ps.KEY_DOWN,Ps.KEY_UP].forEach(r=>{t.removeEventListener(r,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}var $8=function(){function n(e){this.dragndropPluginOptions=e}return n.prototype.apply=function(e){var t=this,r=e.renderingService,i=e.renderingContext,a=i.root.ownerDocument,o=a.defaultView,s=function(l){var c=l.target,u=c===a,h=u&&t.dragndropPluginOptions.isDocumentDraggable?a:c.closest&&c.closest("[draggable=true]");if(h){var f=!1,d=l.timeStamp,p=[l.clientX,l.clientY],v=null,g=[l.clientX,l.clientY],m=function(_){return j(t,void 0,void 0,function(){var S,b,y,E,w,M;return gt(this,function(P){switch(P.label){case 0:if(!f){if(S=_.timeStamp-d,b=Nr([_.clientX,_.clientY],p),S<=this.dragndropPluginOptions.dragstartTimeThreshold||b<=this.dragndropPluginOptions.dragstartDistanceThreshold)return[2];_.type="dragstart",h.dispatchEvent(_),f=!0}return _.type="drag",_.dx=_.clientX-g[0],_.dy=_.clientY-g[1],h.dispatchEvent(_),g=[_.clientX,_.clientY],u?[3,2]:(y=this.dragndropPluginOptions.overlap==="pointer"?[_.canvasX,_.canvasY]:c.getBounds().center,[4,a.elementsFromPoint(y[0],y[1])]);case 1:E=P.sent(),w=E[E.indexOf(c)+1],M=(w==null?void 0:w.closest("[droppable=true]"))||(this.dragndropPluginOptions.isDocumentDroppable?a:null),v!==M&&(v&&(_.type="dragleave",_.target=v,v.dispatchEvent(_)),M&&(_.type="dragenter",_.target=M,M.dispatchEvent(_)),v=M,v&&(_.type="dragover",_.target=v,v.dispatchEvent(_))),P.label=2;case 2:return[2]}})})};o.addEventListener("pointermove",m);var x=function(_){if(f){_.detail={preventClick:!0};var S=_.clone();v&&(S.type="drop",S.target=v,v.dispatchEvent(S)),S.type="dragend",h.dispatchEvent(S),f=!1}o.removeEventListener("pointermove",m)};c.addEventListener("pointerup",x,{once:!0}),c.addEventListener("pointerupoutside",x,{once:!0})}};r.hooks.init.tap(n.tag,function(){o.addEventListener("pointerdown",s)}),r.hooks.destroy.tap(n.tag,function(){o.removeEventListener("pointerdown",s)})},n.tag="Dragndrop",n}(),K8=function(n){B(e,n);function e(t){t===void 0&&(t={});var r=n.call(this)||this;return r.options=t,r.name="dragndrop",r}return e.prototype.init=function(){this.addRenderingPlugin(new $8(N({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e.prototype.setOptions=function(t){Object.assign(this.plugins[0].dragndropPluginOptions,t)},e}(Oo);const Qw=["background","main","label","transient"];class t_{constructor(e){k(this,"extends");k(this,"config");this.config=e;const l=e,{renderer:t,background:r,cursor:i}=l,a=Ce(l,["renderer","background","cursor"]),o=e_(t),s=Object.fromEntries(Qw.map(c=>{const u=new hu(Se(at({},a),{supportsMutipleCanvasesInOneContainer:!0,renderer:o[c],background:c==="background"?r:void 0}));return[c,u]}));n_(s),this.extends={config:e,renderer:t,renderers:o,layers:s}}getConfig(){return this.config}getLayer(e="main"){return this.extends.layers[e]}getLayers(){return this.extends.layers}getRenderer(e){return this.extends.renderers[e]}getCamera(e="main"){return this.getLayer(e).getCamera()}getRoot(e="main"){return this.getLayer(e).getRoot()}getContextService(e="main"){return this.getLayer(e).getContextService()}setCursor(e){this.config.cursor=e,this.getLayer().setCursor(e)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,e])=>e.ready))}resize(e,t){Object.assign(this.extends.config,{width:e,height:t}),Object.values(this.getLayers()).forEach(r=>{const i=r.getCamera(),a=i.getPosition(),o=i.getFocalPoint();r.resize(e,t),i.setPosition(a),i.setFocalPoint(o)})}getBounds(e){return Gl(Object.values(this.getLayers()).map(t=>e?t.getRoot().childNodes.find(i=>i.classList.includes(e)):t.getRoot()).filter(t=>(t==null?void 0:t.childNodes.length)>0).map(t=>t.getBounds()))}getContainer(){const e=this.extends.config.container;return typeof e=="string"?document.getElementById(e):e}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(e,t){var i;const r=((i=e.style)==null?void 0:i.$layer)||"main";return this.getLayer(r).appendChild(e,t)}setRenderer(e){if(e===this.extends.renderer)return;const t=e_(e);this.extends.renderers=t,Object.entries(t).forEach(([r,i])=>this.getLayer(r).setRenderer(i)),n_(this.getLayers())}getCanvasByViewport(e){return zr(this.getLayer().viewport2Canvas(Bo(e)))}getViewportByCanvas(e){return zr(this.getLayer().canvas2Viewport(Bo(e)))}getViewportByClient(e){return zr(this.getLayer().client2Viewport(Bo(e)))}getClientByViewport(e){return zr(this.getLayer().viewport2Client(Bo(e)))}getClientByCanvas(e){return this.getClientByViewport(this.getViewportByCanvas(e))}getCanvasByClient(e){const t=this.getLayer(),r=t.client2Viewport(Bo(e));return zr(t.viewport2Canvas(r))}toDataURL(){return Pt(this,arguments,function*(e={}){const t=window.devicePixelRatio||1,m=e,{mode:r="viewport"}=m,i=Ce(m,["mode"]);let[a,o,s,l]=[0,0,0,0];if(r==="viewport")[s,l]=this.getSize();else if(r==="overall"){const x=this.getBounds(),_=Ka(x);[a,o]=x.min,[s,l]=_}const c=Eg('<div id="virtual-image"></div>'),u=new hu({width:s,height:l,renderer:new Of,devicePixelRatio:t,container:c,background:this.extends.config.background});yield u.ready,u.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),u.appendChild(this.getRoot().cloneNode(!0));const h=this.getLayer("label").getRoot().cloneNode(!0),f=u.viewport2Canvas({x:0,y:0}),d=this.getCanvasByViewport([0,0]);h.translate([d[0]-f.x,d[1]-f.y]),h.scale(1/this.getCamera().getZoom()),u.appendChild(h),u.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));const p=this.getCamera(),v=u.getCamera();if(r==="viewport")v.setZoom(p.getZoom()),v.setPosition(p.getPosition()),v.setFocalPoint(p.getFocalPoint());else if(r==="overall"){const[x,_,S]=v.getPosition(),[b,y,E]=v.getFocalPoint();v.setPosition([x+a,_+o,S]),v.setFocalPoint([b+a,y+o,E])}const g=u.getContextService();return new Promise(x=>{u.addEventListener(ai.RERENDER,()=>Pt(this,null,function*(){yield new Promise(S=>setTimeout(S,300));const _=yield g.toDataURL(i);x(_)}))})})}destroy(){Object.values(this.getLayers()).forEach(e=>{e.getCamera().cancelLandmarkAnimation(),e.destroy()})}}function e_(n){return Object.fromEntries(Qw.map(e=>{const t=(n==null?void 0:n(e))||new Of;return e==="main"?t.registerPlugin(new K8({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):t.unregisterPlugin(t.getPlugin("dom-interaction")),[e,t]}))}function n_(n){Object.entries(n).forEach(([e,t])=>{const r=t.getContextService().getDomElement();r.style.position="absolute",r.style.outline="none",r.tabIndex=1,e!=="main"&&(r.style.pointerEvents="none")})}function Z8(n,e){e===void 0&&(e=new Map);var t=[];if(Array.isArray(n))for(var r=0,i=n.length;r<i;r++){var a=n[r];e.has(a)||(t.push(a),e.set(a,!0))}return t}function xo(n,e){const c=n,{data:t,style:r}=c,i=Ce(c,["data","style"]),u=e,{data:a,style:o}=u,s=Ce(u,["data","style"]),l=at(at({},i),s);return(t||a)&&Object.assign(l,{data:at(at({},t),a)}),(r||o)&&Object.assign(l,{style:at(at({},r),o)}),l}function _g(n){const a=n,{data:e,style:t}=a,i=Ce(a,["data","style"]);return e&&(i.data=at({},e)),t&&(i.style=at({},t)),i}function jV(n){return!get(n,["nodes","length"])&&!get(n,["edges","length"])&&!get(n,["combos","length"])}function Sg(n){const o=n,{id:e=it(n),style:t,data:r}=o,i=Ce(o,["id","style","data"]),a=Se(at({},n),{style:at({},t),data:at({},r)});return QA(n)?at({id:e,data:a},i):{id:e,data:a}}function nr(n){return n.data}function q8(n){if(n.hasTreeStructure($a))return;n.attachTreeStructure($a);const e=n.getAllEdges();for(const t of e){const{source:r,target:i}=t;n.setParent(i,r,$a)}}class J8{constructor(){k(this,"model");k(this,"latestRemovedComboIds",new Set);k(this,"comboIds",new Set);k(this,"changes",[]);k(this,"batchCount",0);k(this,"isTraceless",!1);k(this,"enableUpdateNodeLikeHierarchy",!0);this.model=new Qp.k}pushChange(e){if(this.isTraceless)return;const{type:t}=e;if(t===tn.NodeUpdated||t===tn.EdgeUpdated||t===tn.ComboUpdated){const{value:r,original:i}=e;this.changes.push({value:_g(r),original:_g(i),type:t})}else this.changes.push({value:_g(e.value),type:t})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(e){this.batchCount++,this.model.batch(e),this.batchCount--}silence(e){this.isTraceless=!0,e(),this.isTraceless=!1}isCombo(e){return this.comboIds.has(e)||this.latestRemovedComboIds.has(e)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(e){return this.model.getAllNodes().reduce((t,r)=>{const i=nr(r);return this.isCombo(it(i))||(e===void 0||e.includes(it(i)))&&t.push(i),t},[])}getEdgeDatum(e){return nr(this.model.getEdge(e))}getEdgeData(e){return this.model.getAllEdges().reduce((t,r)=>{const i=nr(r);return(e===void 0||e.includes(it(i)))&&t.push(i),t},[])}getComboData(e){return this.model.getAllNodes().reduce((t,r)=>{const i=nr(r);return this.isCombo(it(i))&&(e===void 0||e.includes(it(i)))&&t.push(i),t},[])}getAncestorsData(e,t){const{model:r}=this;return!r.hasNode(e)||!r.hasTreeStructure(t)?[]:r.getAncestors(e,t).map(nr)}getDescendantsData(e){const t=this.getElementDataById(e),r=[];return Ls(t,i=>{i!==t&&r.push(i)},i=>this.getChildrenData(it(i)),"TB"),r}getParentData(e,t){const{model:r}=this;if(!t){Gr.warn("The hierarchy structure key is not specified");return}if(!r.hasNode(e)||!r.hasTreeStructure(t))return;const i=r.getParent(e,t);return i?nr(i):void 0}getChildrenData(e){const t=this.getElementType(e)==="node"?$a:en,{model:r}=this;return!r.hasNode(e)||!r.hasTreeStructure(t)?[]:r.getChildren(e,t).map(nr)}getElementsDataByType(e){return e==="node"?this.getNodeData():e==="edge"?this.getEdgeData():e==="combo"?this.getComboData():[]}getElementDataById(e){return this.getElementType(e)==="edge"?this.getEdgeDatum(e):this.getNodeLikeDatum(e)}getNodeLikeDatum(e){const t=this.model.getNode(e);return nr(t)}getNodeLikeData(e){return this.model.getAllNodes().reduce((t,r)=>{const i=nr(r);return e?e.includes(it(i))&&t.push(i):t.push(i),t},[])}getElementDataByState(e,t){return this.getElementsDataByType(e).filter(i=>{var a;return(a=i.states)==null?void 0:a.includes(t)})}getElementState(e){var t;return((t=this.getElementDataById(e))==null?void 0:t.states)||[]}hasNode(e){return this.model.hasNode(e)&&!this.isCombo(e)}hasEdge(e){return this.model.hasEdge(e)}hasCombo(e){return this.model.hasNode(e)&&this.isCombo(e)}getRelatedEdgesData(e,t="both"){return this.model.getRelatedEdges(e,t).map(nr)}getNeighborNodesData(e){return this.model.getNeighbors(e).map(nr)}setData(e){const{nodes:t=[],edges:r=[],combos:i=[]}=e,{nodes:a,edges:o,combos:s}=this.getData(),l=As(a,t,h=>it(h)),c=As(o,r,h=>it(h)),u=As(s,i,h=>it(h));this.batch(()=>{this.addData({nodes:l.enter,edges:c.enter,combos:u.enter}),this.updateData({nodes:l.update,edges:c.update,combos:u.update}),this.removeData({nodes:l.exit.map(it),edges:c.exit.map(it),combos:u.exit.map(it)})})}addData(e){const{nodes:t,edges:r,combos:i}=e;this.batch(()=>{this.addComboData(i),this.addNodeData(t),this.addEdgeData(r)})}addNodeData(e=[]){e.length&&(this.model.addNodes(e.map(t=>(this.pushChange({value:t,type:tn.NodeAdded}),Sg(t)))),this.updateNodeLikeHierarchy(e))}addEdgeData(e=[]){e.length&&this.model.addEdges(e.map(t=>(this.pushChange({value:t,type:tn.EdgeAdded}),Sg(t))))}addComboData(e=[]){if(!e.length)return;const{model:t}=this;t.hasTreeStructure(en)||t.attachTreeStructure(en),t.addNodes(e.map(r=>(this.comboIds.add(it(r)),this.pushChange({value:r,type:tn.ComboAdded}),Sg(r)))),this.updateNodeLikeHierarchy(e)}addChildrenData(e,t){const r=this.getNodeLikeDatum(e),i=t.map(it);this.addNodeData(t),this.updateNodeData([{id:e,children:[...r.children||[],...i]}]),this.addEdgeData(i.map(a=>({source:e,target:a})))}updateNodeLikeHierarchy(e){if(!this.enableUpdateNodeLikeHierarchy)return;const{model:t}=this;e.forEach(r=>{const i=it(r);t.attachTreeStructure(en),this.setParent(i,_p(r),en);const a=r.children;if(a!==void 0){t.attachTreeStructure($a);const o=a.filter(s=>t.hasNode(s));o.forEach(s=>this.setParent(s,i,$a)),o.length!==a.length&&this.updateNodeData([{id:i,children:o}])}})}preventUpdateNodeLikeHierarchy(e){this.enableUpdateNodeLikeHierarchy=!1,e(),this.enableUpdateNodeLikeHierarchy=!0}updateData(e){const{nodes:t,edges:r,combos:i}=e;this.batch(()=>{this.updateNodeData(t),this.updateComboData(i),this.updateEdgeData(r)})}updateNodeData(e=[]){if(!e.length)return;const{model:t}=this;this.batch(()=>{const r=[];e.forEach(i=>{const a=it(i),o=nr(t.getNode(a));if(vn(o,i))return;const s=xo(o,i);this.pushChange({value:s,original:o,type:tn.NodeUpdated}),t.mergeNodeData(a,s),r.push(s)}),this.updateNodeLikeHierarchy(r)})}refreshData(){const{nodes:e,edges:t,combos:r}=this.getData();e.forEach(i=>{this.pushChange({value:i,original:i,type:tn.NodeUpdated})}),t.forEach(i=>{this.pushChange({value:i,original:i,type:tn.EdgeUpdated})}),r.forEach(i=>{this.pushChange({value:i,original:i,type:tn.ComboUpdated})})}syncNodeDatum(e){const{model:t}=this,r=it(e),i=nr(t.getNode(r)),a=xo(i,e);t.mergeNodeData(r,a)}updateEdgeData(e=[]){if(!e.length)return;const{model:t}=this;this.batch(()=>{e.forEach(r=>{const i=it(r),a=nr(t.getEdge(i));if(vn(a,r))return;r.source&&a.source!==r.source&&t.updateEdgeSource(i,r.source),r.target&&a.target!==r.target&&t.updateEdgeTarget(i,r.target);const o=xo(a,r);this.pushChange({value:o,original:a,type:tn.EdgeUpdated}),t.mergeEdgeData(i,o)})})}updateComboData(e=[]){if(!e.length)return;const{model:t}=this;t.batch(()=>{const r=[];e.forEach(i=>{const a=it(i),o=nr(t.getNode(a));if(vn(o,i))return;const s=xo(o,i);this.pushChange({value:s,original:o,type:tn.ComboUpdated}),t.mergeNodeData(a,s),r.push(s)}),this.updateNodeLikeHierarchy(r)})}setParent(e,t,r,i=!0){if(e===t)return;const a=_p(this.getNodeLikeDatum(e));if(a!==t&&r===en){const o={id:e,combo:t};this.isCombo(e)?this.syncComboDatum(o):this.syncNodeDatum(o)}this.model.setParent(e,t,r),i&&r===en&&Z8([a,t]).forEach(o=>{o!==void 0&&this.refreshComboData(o)})}refreshComboData(e){const t=this.getComboData([e])[0],r=this.getAncestorsData(e,en);t&&this.pushChange({value:t,original:t,type:tn.ComboUpdated}),r.forEach(i=>{this.pushChange({value:i,original:i,type:tn.ComboUpdated})})}syncComboDatum(e){const{model:t}=this,r=it(e);if(!t.hasNode(r))return;const i=nr(t.getNode(r)),a=xo(i,e);t.mergeNodeData(r,a)}getElementPosition(e){const t=this.getElementDataById(e);return Hi(t)}translateNodeLikeBy(e,t){this.isCombo(e)?this.translateComboBy(e,t):this.translateNodeBy(e,t)}translateNodeLikeTo(e,t){this.isCombo(e)?this.translateComboTo(e,t):this.translateNodeTo(e,t)}translateNodeBy(e,t){const r=this.getElementPosition(e),i=ge(r,[...t,0].slice(0,3));this.translateNodeTo(e,i)}translateNodeTo(e,t){const[r=0,i=0,a=0]=t;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:e,style:{x:r,y:i,z:a}}])})}translateComboBy(e,t){const[r=0,i=0,a=0]=t;if([r,i,a].some(isNaN)||[r,i,a].every(s=>s===0))return;const o=this.getComboData([e])[0];o&&Ls(o,s=>{const l=it(s),[c,u,h]=Hi(s),f=xo(s,{style:{x:c+r,y:u+i,z:h+a}});this.pushChange({value:f,original:s,type:this.isCombo(l)?tn.ComboUpdated:tn.NodeUpdated}),this.model.mergeNodeData(l,f)},s=>this.getChildrenData(it(s)),"BT")}translateComboTo(e,t){var d;if(t.some(isNaN))return;const[r=0,i=0,a=0]=t,o=(d=this.getComboData([e]))==null?void 0:d[0];if(!o)return;const[s,l,c]=Hi(o),u=r-s,h=i-l,f=a-c;Ls(o,p=>{const v=it(p),[g,m,x]=Hi(p),_=xo(p,{style:{x:g+u,y:m+h,z:x+f}});this.pushChange({value:_,original:p,type:this.isCombo(v)?tn.ComboUpdated:tn.NodeUpdated}),this.model.mergeNodeData(v,_)},p=>this.getChildrenData(it(p)),"BT")}removeData(e){const{nodes:t,edges:r,combos:i}=e;this.batch(()=>{this.removeEdgeData(r),this.removeNodeData(t),this.removeComboData(i),this.latestRemovedComboIds=new Set(i)})}removeNodeData(e=[]){e.length&&this.batch(()=>{e.forEach(t=>{this.removeEdgeData(this.getRelatedEdgesData(t).map(it)),this.pushChange({value:this.getNodeData([t])[0],type:tn.NodeRemoved}),this.removeNodeLikeHierarchy(t)}),this.model.removeNodes(e)})}removeEdgeData(e=[]){e.length&&(e.forEach(t=>this.pushChange({value:this.getEdgeData([t])[0],type:tn.EdgeRemoved})),this.model.removeEdges(e))}removeComboData(e=[]){e.length&&this.batch(()=>{e.forEach(t=>{this.pushChange({value:this.getComboData([t])[0],type:tn.ComboRemoved}),this.removeNodeLikeHierarchy(t),this.comboIds.delete(t)}),this.model.removeNodes(e)})}removeNodeLikeHierarchy(e){if(this.model.hasTreeStructure(en)){const t=_p(this.getNodeLikeDatum(e));this.setParent(e,void 0,en,!1),this.model.getChildren(e,en).forEach(r=>{const i=nr(r),a=it(i);this.setParent(it(i),t,en,!1);const o=xo(i,{id:it(i),combo:t});this.pushChange({value:o,original:i,type:this.isCombo(a)?tn.ComboUpdated:tn.NodeUpdated}),this.model.mergeNodeData(it(i),o)}),Nt(t)||this.refreshComboData(t)}}getElementType(e){if(this.model.hasNode(e))return this.isCombo(e)?"combo":"node";if(this.model.hasEdge(e))return"edge";throw new Error(Sa(`Unknown element type of id: ${e}`))}destroy(){const{model:e}=this,t=e.getAllNodes(),r=e.getAllEdges();e.removeEdges(r.map(i=>i.id)),e.removeNodes(t.map(i=>i.id)),this.context={}}}class Q8{constructor(e){k(this,"context");k(this,"container");k(this,"elementMap",{});k(this,"shapeTypeMap",{});k(this,"paletteStyle",{});k(this,"defaultStyle",{});k(this,"stateStyle",{});k(this,"visibilityCache",new WeakMap);this.context=e}init(){if(!this.container){const{canvas:e}=this.context;this.container=e.appendChild(new kl({className:"elements"}))}}emit(e,t){t.silence||er(this.context.graph,e)}forEachElementData(e){Fo.forEach(t=>{const r=this.context.model.getElementsDataByType(t);e(t,r)})}getElementType(e,t){var o;const{options:r,graph:i}=this.context,a=((o=r[e])==null?void 0:o.type)||t.type;return a?typeof a=="string"?a:a.call(i,t):e==="edge"?"line":"circle"}getTheme(e){return b1(this.context.options)[e]||{}}getThemeStyle(e){return this.getTheme(e).style||{}}getThemeStateStyle(e,t){const{state:r={}}=this.getTheme(e);return Object.assign({},...t.map(i=>r[i]||{}))}computePaletteStyle(){const{options:e}=this.context;this.paletteStyle={},this.forEachElementData((t,r)=>{var a,o;const i=Object.assign({},X1((a=this.getTheme(t))==null?void 0:a.palette),X1((o=e[t])==null?void 0:o.palette));i!=null&&i.field&&Object.assign(this.paletteStyle,SO(r,i))})}getPaletteStyle(e,t){const r=this.paletteStyle[t];return r?e==="edge"?{stroke:r}:{fill:r}:{}}computeElementDefaultStyle(e,t){var a;const{options:r}=this.context,i=((a=r[e])==null?void 0:a.style)||{};this.defaultStyle[it(t.datum)]=W1(i,t)}computeElementsDefaultStyle(e){const{graph:t}=this.context;this.forEachElementData((r,i)=>{const a=i.length;for(let o=0;o<a;o++){const s=i[o];(e===void 0||e.includes(it(s)))&&this.computeElementDefaultStyle(r,{datum:s,graph:t})}})}getDefaultStyle(e){return this.defaultStyle[e]||{}}getElementState(e){try{const{model:t}=this.context;return t.getElementState(e)}catch(t){return[]}}getElementStateStyle(e,t,r){var o,s;const{options:i}=this.context,a=((s=(o=i[e])==null?void 0:o.state)==null?void 0:s[t])||{};return W1(a,r)}computeElementStatesStyle(e,t,r){this.stateStyle[it(r.datum)]=Object.assign({},...t.map(i=>this.getElementStateStyle(e,i,r)))}computeElementsStatesStyle(e){const{graph:t}=this.context;this.forEachElementData((r,i)=>{const a=i.length;for(let o=0;o<a;o++){const s=i[o];if(e===void 0||e.includes(it(s))){const l=this.getElementState(it(s));this.computeElementStatesStyle(r,l,{datum:s,graph:t})}}})}getStateStyle(e){return this.stateStyle[e]||{}}computeStyle(e,t){e&&["translate","zIndex"].includes(e)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(t),this.computeElementsStatesStyle(t))}getElement(e){return this.elementMap[e]}getElementZIndex(e){var r;const t=this.getElement(e);return t&&(r=t.style.zIndex)!=null?r:0}getNodes(){return this.context.model.getNodeData().map(({id:e})=>this.elementMap[e])}getEdges(){return this.context.model.getEdgeData().map(e=>this.elementMap[it(e)])}getCombos(){return this.context.model.getComboData().map(({id:e})=>this.elementMap[e])}getElementComputedStyle(e,t){const r=it(t),i=this.getThemeStyle(e),a=this.getPaletteStyle(e,r),o=t.style||{},s=this.getDefaultStyle(r),l=this.getThemeStateStyle(e,this.getElementState(r)),c=this.getStateStyle(r),u=Object.assign({},i,a,o,s,l,c);if(e==="combo"){const h=this.context.model.getChildrenData(r),d=!!u.collapsed?[]:h.map(it).filter(p=>this.getElement(p));Object.assign(u,{childrenNode:d,childrenData:h})}return u}draw(e={animation:!0}){this.init();const t=this.computeChangesAndDrawData(e);if(!t)return null;const{dataChanges:r,drawData:i}=t;this.markDestroyElement(i),this.computeStyle(e.stage);const{add:a,update:o,remove:s}=i;this.destroyElements(s,e),this.createElements(a,e),this.updateElements(o,e);const{animation:l,silence:c}=e,{type:u="draw"}=e,h=u==="render";return this.context.animation.animate(l,c?{}:{before:()=>this.emit(new Vn(Tt.BEFORE_DRAW,{dataChanges:r,animation:l,render:h}),e),beforeAnimate:f=>this.emit(new Wi(Tt.BEFORE_ANIMATE,Fr.DRAW,f,i),e),afterAnimate:f=>this.emit(new Wi(Tt.AFTER_ANIMATE,Fr.DRAW,f,i),e),after:()=>this.emit(new Vn(Tt.AFTER_DRAW,{dataChanges:r,animation:l,render:h}),e)})}computeChangesAndDrawData(e){const{model:t}=this.context,r=t.getChanges(),i=lv(r);if(i.length===0)return null;const{NodeAdded:a=[],NodeUpdated:o=[],NodeRemoved:s=[],EdgeAdded:l=[],EdgeUpdated:c=[],EdgeRemoved:u=[],ComboAdded:h=[],ComboUpdated:f=[],ComboRemoved:d=[]}=Dp(i,m=>m.type),p=m=>new Map(m.map(x=>{const _=x.value;return[it(_),_]})),v={add:{nodes:p(a),edges:p(l),combos:p(h)},update:{nodes:p(o),edges:p(c),combos:p(f)},remove:{nodes:p(s),edges:p(u),combos:p(d)}},g=this.transformData(v,e);return t.clearChanges(),{dataChanges:r,drawData:g}}transformData(e,t){const r=this.context.transform.getTransformInstance();return Object.values(r).reduce((i,a)=>a.beforeDraw(i,t),e)}createElement(e,t,r){var h;const i=it(t);if(this.getElement(i))return;const o=this.getElementType(e,t),s=this.getElementComputedStyle(e,t),l=_a(e,o);if(!l)return Gr.warn(`The element ${o} of ${e} is not registered.`);this.emit(new yl(Tt.BEFORE_ELEMENT_CREATE,e,t),r);const c=this.container.appendChild(new l({id:i,style:at({context:this.context},s)}));this.shapeTypeMap[i]=o,this.elementMap[i]=c;const{stage:u="enter"}=r;(h=this.context.animation)==null||h.add({element:c,elementType:e,stage:u,originalStyle:at({},c.attributes),modifiedStyle:at(at({},c.attributes),s)},{after:()=>{var f;this.emit(new yl(Tt.AFTER_ELEMENT_CREATE,e,t),r),(f=c.onCreate)==null||f.call(c)}})}createElements(e,t){const{nodes:r,edges:i,combos:a}=e;[["node",r],["combo",a],["edge",i]].forEach(([s,l])=>{l.forEach(c=>this.createElement(s,c,t))})}updateElement(e,t,r){var u;const i=it(t),a=this.getElement(i);if(!a)return()=>null;this.emit(new yl(Tt.BEFORE_ELEMENT_UPDATE,e,t),r);const o=this.getElementType(e,t),s=this.getElementComputedStyle(e,t);this.shapeTypeMap[i]!==o&&(a.destroy(),delete this.shapeTypeMap[i],delete this.elementMap[i],this.createElement(e,t,{animation:!1,silence:!0}));const{stage:l="update"}=r,c=l!=="visibility"?l:s.visibility==="hidden"?"hide":"show";c==="hide"&&delete s.visibility,(u=this.context.animation)==null||u.add({element:a,elementType:e,stage:c,originalStyle:at({},a.attributes),modifiedStyle:at(at({},a.attributes),s)},{before:()=>{const h=this.elementMap[i];l!=="collapse"&&qp(h,s),l==="visibility"&&(V1(h,"opacity")||U1(h,"opacity"),this.visibilityCache.set(h,c==="show"?"visible":"hidden"),c==="show"&&jl(h,"visible"))},after:()=>{var f;const h=this.elementMap[i];l==="collapse"&&qp(h,s),c==="hide"&&jl(h,this.visibilityCache.get(h)),this.emit(new yl(Tt.AFTER_ELEMENT_UPDATE,e,t),r),(f=h.onUpdate)==null||f.call(h)}})}updateElements(e,t){const{nodes:r,edges:i,combos:a}=e;[["node",r],["combo",a],["edge",i]].forEach(([s,l])=>{l.forEach(c=>this.updateElement(s,c,t))})}markDestroyElement(e){Object.values(e.remove).forEach(t=>{t.forEach(r=>{const i=it(r),a=this.getElement(i);a&&XN(a)})})}destroyElement(e,t,r){var s;const{stage:i="exit"}=r,a=it(t),o=this.elementMap[a];if(!o)return()=>null;this.emit(new yl(Tt.BEFORE_ELEMENT_DESTROY,e,t),r),(s=this.context.animation)==null||s.add({element:o,elementType:e,stage:i,originalStyle:at({},o.attributes),modifiedStyle:at({},o.attributes)},{after:()=>{var l;this.clearElement(a),o.destroy(),(l=o.onDestroy)==null||l.call(o),this.emit(new yl(Tt.AFTER_ELEMENT_DESTROY,e,t),r)}})}destroyElements(e,t){const{nodes:r,edges:i,combos:a}=e;[["combo",a],["edge",i],["node",r]].forEach(([s,l])=>{l.forEach(c=>this.destroyElement(s,c,t))})}clearElement(e){delete this.paletteStyle[e],delete this.defaultStyle[e],delete this.stateStyle[e],delete this.elementMap[e],delete this.shapeTypeMap[e]}collapseNode(e,t){return Pt(this,null,function*(){var f;const{model:r,layout:i}=this.context,a=this.computeChangesAndDrawData({stage:"collapse",animation:t});this.markDestroyElement(a.drawData);const o=yield i.simulate();r.updateData(o);const{drawData:s}=this.computeChangesAndDrawData({stage:"collapse",animation:t}),{add:l,remove:c,update:u}=s;this.markDestroyElement(s);const h={animation:t,stage:"collapse",data:s};this.destroyElements(c,h),this.createElements(l,h),this.updateElements(u,h),yield(f=this.context.animation.animate(t,{beforeAnimate:d=>this.emit(new Wi(Tt.BEFORE_ANIMATE,Fr.COLLAPSE,d,s),h),afterAnimate:d=>this.emit(new Wi(Tt.AFTER_ANIMATE,Fr.COLLAPSE,d,s),h)},{collapse:{target:e,descendants:Array.from(c.nodes).map(([,d])=>it(d)),position:Hi(u.nodes.get(e))}}))==null?void 0:f.finished})}expandNode(e,t){return Pt(this,null,function*(){var h;const{model:r,layout:i}=this.context;if(!r.getAncestorsData(e,en).every(f=>oi(f)))return;const a=Hi(r.getNodeData([e])[0]),{drawData:{add:o}}=this.computeChangesAndDrawData({stage:"collapse",animation:t});this.createElements(o,{animation:!1,stage:"expand"}),this.context.animation.clear();const s=yield i.simulate();r.updateData(s),this.computeStyle("expand");const{drawData:l}=this.computeChangesAndDrawData({stage:"collapse",animation:t}),{update:c}=l,u={animation:t,stage:"expand",data:l};o.edges.forEach(f=>{const d=it(f);c.edges.has(d)||c.edges.set(d,f)}),this.updateElements(c,u),yield(h=this.context.animation.animate(t,{beforeAnimate:f=>this.emit(new Wi(Tt.BEFORE_ANIMATE,Fr.EXPAND,f,l),u),afterAnimate:f=>this.emit(new Wi(Tt.AFTER_ANIMATE,Fr.EXPAND,f,l),u)},{expand:{target:e,descendants:Array.from(o.nodes).map(([,f])=>it(f)),position:a}}))==null?void 0:h.finished})}collapseCombo(e,t){return Pt(this,null,function*(){var d;const{model:r,element:i}=this.context;if(r.getAncestorsData(e,en).some(p=>oi(p)))return;const a=i.getElement(e),o=a.getComboPosition(Se(at({},a.attributes),{collapsed:!0})),{dataChanges:s,drawData:l}=this.computeChangesAndDrawData({stage:"collapse",animation:t});this.markDestroyElement(l);const{update:c,remove:u}=l,h={animation:t,stage:"collapse",data:l};this.destroyElements(u,h),this.updateElements(c,h);const f=p=>Array.from(p).map(([,v])=>it(v));yield(d=this.context.animation.animate(t,{before:()=>this.emit(new Vn(Tt.BEFORE_DRAW,{dataChanges:s,animation:t}),h),beforeAnimate:p=>this.emit(new Wi(Tt.BEFORE_ANIMATE,Fr.COLLAPSE,p,l),h),afterAnimate:p=>this.emit(new Wi(Tt.AFTER_ANIMATE,Fr.COLLAPSE,p,l),h),after:()=>this.emit(new Vn(Tt.AFTER_DRAW,{dataChanges:s,animation:t}),h)},{collapse:{target:e,descendants:[...f(u.nodes),...f(u.combos)],position:o}}))==null?void 0:d.finished})}expandCombo(e,t){return Pt(this,null,function*(){var h;const{model:r}=this.context,i=Hi(r.getComboData([e])[0]);this.computeStyle("expand");const{dataChanges:a,drawData:o}=this.computeChangesAndDrawData({stage:"expand",animation:t}),{add:s,update:l}=o,c={animation:t,stage:"expand",data:o};this.createElements(s,c),this.updateElements(l,c);const u=f=>Array.from(f).map(([,d])=>it(d));yield(h=this.context.animation.animate(t,{before:()=>this.emit(new Vn(Tt.BEFORE_DRAW,{dataChanges:a,animation:t}),c),beforeAnimate:f=>this.emit(new Wi(Tt.BEFORE_ANIMATE,Fr.EXPAND,f,o),c),afterAnimate:f=>this.emit(new Wi(Tt.AFTER_ANIMATE,Fr.EXPAND,f,o),c),after:()=>this.emit(new Vn(Tt.AFTER_DRAW,{dataChanges:a,animation:t}),c)},{expand:{target:e,descendants:[...u(s.nodes),...u(s.combos)],position:i}}))==null?void 0:h.finished})}getFrontZIndex(e){const{model:t}=this.context,r=t.getElementType(e),i=t.getElementDataById(e),a=t.getData();if(Object.assign(a,{[`${r}s`]:a[`${r}s`].filter(o=>it(o)!==e)}),r==="combo"&&!oi(i)){const o=t.getAncestorsData(e,en).map(it);a.nodes=a.nodes.filter(s=>!o.includes(it(s))),a.combos=a.combos.filter(s=>!o.includes(it(s))),a.edges=a.edges.filter(({source:s,target:l})=>o.includes(s)&&o.includes(l))}return Math.max(0,...Object.values(a).flat().map(o=>{const s=it(o);return this.getElementZIndex(s)}))+1}destroy(){this.container.destroy(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={},this.context={}}}var r_=D(97582),tz=D(38027);const i_=Symbol("Comlink.proxy"),ez=Symbol("Comlink.endpoint"),a_=Symbol("Comlink.releaseProxy"),Tg=Symbol("Comlink.finalizer"),Kf=Symbol("Comlink.thrown"),o_=n=>typeof n=="object"&&n!==null||typeof n=="function",nz={canHandle:n=>o_(n)&&n[i_],serialize(n){const{port1:e,port2:t}=new MessageChannel;return l_(n,e),[t,[t]]},deserialize(n){return n.start(),u_(n)}},rz={canHandle:n=>o_(n)&&Kf in n,serialize({value:n}){let e;return n instanceof Error?e={isError:!0,value:{message:n.message,name:n.name,stack:n.stack}}:e={isError:!1,value:n},[e,[]]},deserialize(n){throw n.isError?Object.assign(new Error(n.value.message),n.value):n.value}},s_=new Map([["proxy",nz],["throw",rz]]);function iz(n,e){for(const t of n)if(e===t||t==="*"||t instanceof RegExp&&t.test(e))return!0;return!1}function l_(n,e=globalThis,t=["*"]){e.addEventListener("message",function r(i){if(!i||!i.data)return;if(!iz(t,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}const{id:a,type:o,path:s}=Object.assign({path:[]},i.data),l=(i.data.argumentList||[]).map(as);let c;try{const u=s.slice(0,-1).reduce((f,d)=>f[d],n),h=s.reduce((f,d)=>f[d],n);switch(o){case"GET":c=h;break;case"SET":u[s.slice(-1)[0]]=as(i.data.value),c=!0;break;case"APPLY":c=h.apply(u,l);break;case"CONSTRUCT":{const f=new h(...l);c=uz(f)}break;case"ENDPOINT":{const{port1:f,port2:d}=new MessageChannel;l_(n,d),c=cz(f,[f])}break;case"RELEASE":c=void 0;break;default:return}}catch(u){c={value:u,[Kf]:0}}Promise.resolve(c).catch(u=>({value:u,[Kf]:0})).then(u=>{const[h,f]=Qf(u);e.postMessage(Object.assign(Object.assign({},h),{id:a}),f),o==="RELEASE"&&(e.removeEventListener("message",r),c_(e),Tg in n&&typeof n[Tg]=="function"&&n[Tg]())}).catch(u=>{const[h,f]=Qf({value:new TypeError("Unserializable return value"),[Kf]:0});e.postMessage(Object.assign(Object.assign({},h),{id:a}),f)})}),e.start&&e.start()}function az(n){return n.constructor.name==="MessagePort"}function c_(n){az(n)&&n.close()}function u_(n,e){return Pg(n,[],e)}function Zf(n){if(n)throw new Error("Proxy has been released and is not useable")}function h_(n){return xl(n,{type:"RELEASE"}).then(()=>{c_(n)})}const qf=new WeakMap,Jf="FinalizationRegistry"in globalThis&&new FinalizationRegistry(n=>{const e=(qf.get(n)||0)-1;qf.set(n,e),e===0&&h_(n)});function oz(n,e){const t=(qf.get(e)||0)+1;qf.set(e,t),Jf&&Jf.register(n,e,n)}function sz(n){Jf&&Jf.unregister(n)}function Pg(n,e=[],t=function(){}){let r=!1;const i=new Proxy(t,{get(a,o){if(Zf(r),o===a_)return()=>{sz(i),h_(n),r=!0};if(o==="then"){if(e.length===0)return{then:()=>i};const s=xl(n,{type:"GET",path:e.map(l=>l.toString())}).then(as);return s.then.bind(s)}return Pg(n,[...e,o])},set(a,o,s){Zf(r);const[l,c]=Qf(s);return xl(n,{type:"SET",path:[...e,o].map(u=>u.toString()),value:l},c).then(as)},apply(a,o,s){Zf(r);const l=e[e.length-1];if(l===ez)return xl(n,{type:"ENDPOINT"}).then(as);if(l==="bind")return Pg(n,e.slice(0,-1));const[c,u]=f_(s);return xl(n,{type:"APPLY",path:e.map(h=>h.toString()),argumentList:c},u).then(as)},construct(a,o){Zf(r);const[s,l]=f_(o);return xl(n,{type:"CONSTRUCT",path:e.map(c=>c.toString()),argumentList:s},l).then(as)}});return oz(i,n),i}function lz(n){return Array.prototype.concat.apply([],n)}function f_(n){const e=n.map(Qf);return[e.map(t=>t[0]),lz(e.map(t=>t[1]))]}const d_=new WeakMap;function cz(n,e){return d_.set(n,e),n}function uz(n){return Object.assign(n,{[i_]:!0})}function $V(n,e=globalThis,t="*"){return{postMessage:(r,i)=>n.postMessage(r,t,i),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e)}}function Qf(n){for(const[e,t]of s_)if(t.canHandle(n)){const[r,i]=t.serialize(n);return[{type:"HANDLER",name:e,value:r},i]}return[{type:"RAW",value:n},d_.get(n)||[]]}function as(n){switch(n.type){case"HANDLER":return s_.get(n.name).deserialize(n.value);case"RAW":return n.value}}function xl(n,e,t){return new Promise(r=>{const i=hz();n.addEventListener("message",function a(o){!o.data||!o.data.id||o.data.id!==i||(n.removeEventListener("message",a),r(o.data))}),n.start&&n.start(),n.postMessage(Object.assign({id:i},e),t)})}function hz(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}class fz extends sv.Z{constructor(e,t,r){super(),this.graph=e,this.layout=t,this.options=r,this.spawnWorker()}spawnWorker(){this.proxy=u_(new Worker(new URL(D.p+D.u(1239),D.b),{type:void 0})),this.running&&(this.running=!1,this.execute())}execute(){var e;return(0,r_.mG)(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;const t=this.layout.options,{onTick:r}=t,i=(0,r_._T)(t,["onTick"]),a={};Object.keys(i).forEach(c=>{(0,tz.Z)(i[c])||(a[c]=i[c])});const o={layout:{id:this.layout.id,options:a,iterations:(e=this.options)===null||e===void 0?void 0:e.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},s=new Float32Array([0]),[l]=yield this.proxy.calculateLayout(o,[s]);return l})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[a_]()}isRunning(){return this.running}}var p_=D(10779);class dz{constructor(e){k(this,"context");k(this,"supervisor");k(this,"instance");k(this,"instances",[]);k(this,"animationResult");this.context=e}get presetOptions(){return{animation:!!E1(this.context.options,!0)}}get options(){const{options:e}=this.context;return e.layout}getLayoutInstance(){return this.instances}layout(){return Pt(this,null,function*(){if(!this.options)return;const e=Array.isArray(this.options)?this.options:[this.options],{graph:t}=this.context;er(t,new Vn(Tt.BEFORE_LAYOUT));for(const r of e){const i=e.indexOf(r),a=this.getLayoutData(r),o=at(at({},this.presetOptions),r);er(t,new Vn(Tt.BEFORE_STAGE_LAYOUT,{options:o,index:i}));const s=yield this.stepLayout(a,o,i);er(t,new Vn(Tt.AFTER_STAGE_LAYOUT,{options:o,index:i})),r.animation||this.updateElementPosition(s,!1)}er(t,new Vn(Tt.AFTER_LAYOUT))})}simulate(){return Pt(this,null,function*(){if(!this.options)return{};const e=Array.isArray(this.options)?this.options:[this.options];let t={};for(const r of e){const i=e.indexOf(r),a=this.getLayoutData(r);t=yield this.stepLayout(a,Se(at(at({},this.presetOptions),r),{animation:!1}),i)}return t})}stepLayout(e,t,r){return Pt(this,null,function*(){return ZN(t)?yield this.treeLayout(e,t,r):yield this.graphLayout(e,t,r)})}graphLayout(e,t,r){return Pt(this,null,function*(){const{animation:i,enableWorker:a,iterations:o=300}=t,s=this.initGraphLayout(t);if(!s)return{};if(this.instances[r]=s,this.instance=s,a){const c=s;return this.supervisor=new fz(c.graphData2LayoutModel(e),c.instance,{iterations:o}),ah(yield this.supervisor.execute())}if((0,p_.h)(s))return i?yield s.execute(e,{onTick:c=>{this.updateElementPosition(c,!1)}}):(s.execute(e),s.stop(),s.tick(o));const l=yield s.execute(e);return i&&this.updateElementPosition(l,i),l})}treeLayout(e,t,r){return Pt(this,null,function*(){const{type:i,animation:a}=t,o=_a("layout",i);if(!o)return{};const{nodes:s=[],edges:l=[]}=e,c=new Qp.k({nodes:s.map(p=>({id:it(p),data:p.data||{}})),edges:l.map(p=>({id:it(p),source:p.source,target:p.target,data:p.data||{}}))});q8(c);const u={nodes:[],edges:[]},h={nodes:[],edges:[]};c.getRoots($a).forEach(p=>{Ls(p,_=>{_.children=c.getSuccessors(_.id)},_=>c.getSuccessors(_.id),"TB");const v=o(p,t),{x:g,y:m,z:x=0}=v;Ls(v,_=>{const{id:S,x:b,y,z:E=0}=_;u.nodes.push({id:S,style:{x:g,y:m,z:x}}),h.nodes.push({id:S,style:{x:b,y,z:E}})},_=>_.children,"TB")});const d=this.inferTreeLayoutOffset(h);return v_(h,d),a&&(v_(u,d),this.updateElementPosition(u,!1),this.updateElementPosition(h,a)),h})}inferTreeLayoutOffset(e){var p;let[t,r]=[1/0,-1/0],[i,a]=[1/0,-1/0];(p=e.nodes)==null||p.forEach(v=>{const{x:g=0,y:m=0}=v.style||{};t=Math.min(t,g),r=Math.max(r,g),i=Math.min(i,m),a=Math.max(a,m)});const{canvas:o}=this.context,s=o.getSize(),[l,c]=o.getCanvasByViewport([0,0]),[u,h]=o.getCanvasByViewport(s);if(t>=l&&r<=u&&i>=c&&a<=h)return[0,0];const f=(l+u)/2,d=(c+h)/2;return[f-(t+r)/2,d-(i+a)/2]}stopLayout(){this.instance&&(0,p_.h)(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(e){const{nodeFilter:t=()=>!0}=e,{nodes:r,edges:i,combos:a}=this.context.model.getData(),o=u=>this.context.element.getElement(u),s=r.filter(u=>{const h=it(u),f=o(h);return!f||Jp(f)?!1:t(u)}),l=new Map(s.map(u=>[it(u),u])),c=i.filter(u=>{const{source:h,target:f}=u;return!(!l.has(h)||!l.has(f))});return{nodes:s,edges:c,combos:a}}initGraphLayout(e){var x;const{element:t,viewport:r}=this.context,m=e,{type:i,enableWorker:a,animation:o,iterations:s}=m,l=Ce(m,["type","enableWorker","animation","iterations"]),[c,u]=r.getCanvasSize(),h=[c/2,u/2],f=(x=e==null?void 0:e.nodeSize)!=null?x:_=>{const S=t==null?void 0:t.getElement(_.id),{size:b}=(S==null?void 0:S.attributes)||{};return Math.max(...Aa(b))},d=_a("layout",i);if(!d)return Gr.warn(`The layout of ${i} is not registered.`);const p=Object.getPrototypeOf(d.prototype)===Ex.prototype?d:qN(d,this.context),v=new p(this.context),g={nodeSize:f,width:c,height:u,center:h};switch(v.id){case"d3-force":case"d3-force-3d":Object.assign(g,{center:{x:c/2,y:u/2,z:0}});break;default:break}return Ci(v.options,g,l),v}updateElementPosition(e,t){const{model:r,element:i}=this.context;return i?(r.updateData(e),i.draw({animation:t,silence:!0})):null}destroy(){var e;this.stopLayout(),this.context={},(e=this.supervisor)==null||e.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}const v_=(n,e)=>{var i;const[t,r]=e;(i=n.nodes)==null||i.forEach(a=>{if(a.style){const{x:o=0,y:s=0}=a.style;a.style.x=o+t,a.style.y=s+r}else a.style={x:t,y:r}})};class pz extends Tp{constructor(t){super(t);k(this,"category","plugin");this.setPlugins(this.context.options.plugins||[])}setPlugins(t){this.setExtensions(t)}getPluginInstance(t){const r=this.extensionMap[t];if(r)return r;Gr.warn(`Cannot find the plugin ${t}, will try to find it by type.`);const i=this.extensions.find(a=>a.type===t);if(i)return this.extensionMap[i.key]}}const td=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class vz extends Tp{constructor(t){super(t);k(this,"category","transform");this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(t){this.setExtensions([...td.slice(0,td.length-1),...t,td[td.length-1]])}getTransformInstance(t){return t?this.extensionMap[t]:this.extensionMap}}class gz{constructor(e){k(this,"context");k(this,"landmarkCounter",0);k(this,"transformResolver");this.context=e;const[t,r]=this.paddingOffset,{zoom:i,rotation:a,x:o=t,y:s=r}=e.options;this.transform({mode:"absolute",scale:i,translate:[o,s],rotate:a},!1)}get padding(){return Ns(this.context.options.padding)}get paddingOffset(){const[e,t,r,i]=this.padding,[a,o,s]=[(i-t)/2,(e-r)/2,0];return[a,o,s]}get camera(){const{canvas:e}=this.context;return new Proxy(e.getCamera(),{get:(t,r)=>{const a=Object.entries(e.getLayers()).filter(([s])=>!["main"].includes(s)).map(([,s])=>s.getCamera()),o=t[r];if(typeof o=="function")return(...s)=>{const l=o.apply(t,s);return a.forEach(c=>{c[r].apply(c,s)}),l}}})}createLandmark(e){return this.camera.createLandmark(`landmark-${this.landmarkCounter++}`,e)}getAnimation(e){const t=E1(this.context.options,e);return t?Vp(at({},t),["easing","duration"]):!1}getCanvasSize(){const{canvas:e}=this.context,{width:t=0,height:r=0}=e.getConfig();return[t,r]}getCanvasCenter(){const{canvas:e}=this.context,{width:t=0,height:r=0}=e.getConfig();return[t/2,r/2,0]}getViewportCenter(){const[e,t]=this.camera.getPosition();return[e,t,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(e){const{camera:t}=this,{mode:r,translate:i=[]}=e,a=this.getZoom(),o=t.getPosition(),s=t.getFocalPoint(),[l,c]=this.getCanvasCenter(),[u=0,h=0,f=0]=i,d=Rs([-u,-h,-f],a);return r==="relative"?{position:ge(o,d),focalPoint:ge(s,d)}:{position:ge([l,c,o[2]],d),focalPoint:ge([l,c,s[2]],d)}}getRotateOptions(e){const{mode:t,rotate:r=0}=e;return{roll:t==="relative"?this.camera.getRoll()+r:r}}getZoomOptions(e){const{zoomRange:t}=this.context.options,r=this.camera.getZoom(),{mode:i,scale:a=1}=e;return me(i==="relative"?r*a:a,...t)}transform(e,t){return Pt(this,null,function*(){const{graph:r}=this.context,{translate:i,rotate:a,scale:o,origin:s}=e;this.cancelAnimation();const l=this.getAnimation(t);if(er(r,new $f(Tt.BEFORE_TRANSFORM,e)),!a&&o&&!i&&s&&!l){this.camera.setZoomByViewportPoint(this.getZoomOptions(e),s),er(r,new $f(Tt.AFTER_TRANSFORM,e));return}const c={};if(i&&Object.assign(c,this.getTranslateOptions(e)),fe(a)&&Object.assign(c,this.getRotateOptions(e)),fe(o)&&Object.assign(c,{zoom:this.getZoomOptions(e)}),l)return er(r,new Wi(Tt.BEFORE_ANIMATE,Fr.TRANSFORM,null,e)),new Promise(u=>{this.transformResolver=u,this.camera.gotoLandmark(this.createLandmark(c),Se(at({},l),{onfinish:()=>{er(r,new Wi(Tt.AFTER_ANIMATE,Fr.TRANSFORM,null,e)),er(r,new $f(Tt.AFTER_TRANSFORM,e)),this.transformResolver=void 0,u()}}))});this.camera.gotoLandmark(this.createLandmark(c),{duration:0}),er(r,new $f(Tt.AFTER_TRANSFORM,e))})}fitView(e,t){return Pt(this,null,function*(){const[r,i,a,o]=this.padding,{when:s="always",direction:l="both"}=e||{},[c,u]=this.context.canvas.getSize(),h=c-o-i,f=u-r-a,d=this.context.canvas.getBounds(),p=this.getBBoxInViewport(d),[v,g]=Ka(p),m=l==="x"&&v>=h||l==="y"&&g>=f||l==="both"&&v>=h&&g>=f;if(s==="overflow"&&!m)return yield this.fitCenter(t);const x=h/v,_=f/g,S=l==="x"?x:l==="y"?_:Math.min(x,_),b=this.getAnimation(t);yield this.transform({mode:"relative",scale:S,translate:ge(In(this.getCanvasCenter(),this.getBBoxInViewport(d).center),Rs(this.paddingOffset,S))},b)})}fitCenter(e){return Pt(this,null,function*(){const t=this.context.canvas.getBounds();yield this.focus(t,e)})}focusElements(e,t){return Pt(this,null,function*(){const{element:r}=this.context;if(!r)return;const i=Gl(e.map(a=>r.getElement(a).getRenderBounds()));yield this.focus(i,t)})}focus(e,t){return Pt(this,null,function*(){const r=this.context.graph.getViewportByCanvas(e.center),i=this.getCanvasCenter(),a=In(i,r);yield this.transform({mode:"relative",translate:ge(a,this.paddingOffset)},t)})}getBBoxInViewport(e){const{min:t,max:r}=e,{graph:i}=this.context,[a,o]=i.getViewportByCanvas(t),[s,l]=i.getViewportByCanvas(r),c=new Fe;return c.setMinMax([a,o,0],[s,l,0]),c}isInViewport(e){const{graph:t}=this.context,r=this.getCanvasSize(),[i,a]=t.getCanvasByViewport([0,0]),[o,s]=t.getCanvasByViewport(r),l=new Fe;return l.setMinMax([i,a,0],[o,s,0]),Os(e)?Ta(e,l):l.intersects(e)}cancelAnimation(){var e,t;(e=this.camera.landmarks)!=null&&e.length&&this.camera.cancelLandmarkAnimation(),(t=this.transformResolver)==null||t.call(this)}}const gm=class extends sv.Z{constructor(t){super();k(this,"options");k(this,"destroyed",!1);k(this,"context",{model:new J8});k(this,"isCollapsingExpanding",!1);k(this,"onResize",rh(()=>{this.resize()},300));this.options=Object.assign({},gm.defaultOptions,t),this.setOptions(this.options),this.context.graph=this,this.options.autoResize&&window.addEventListener("resize",this.onResize)}getOptions(){return this.options}setOptions(t){var g,m,x;const{behaviors:r,combo:i,data:a,edge:o,height:s,layout:l,node:c,plugins:u,theme:h,transforms:f,width:d,cursor:p,renderer:v}=t;if(v){const _=this.context.canvas;_&&(this.emit(Tt.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),_.setRenderer(v),this.emit(Tt.AFTER_RENDERER_CHANGE,{renderer:v}))}Object.assign(this.options,t),p&&((g=this.context.canvas)==null||g.setCursor(p)),r&&this.setBehaviors(r),i&&this.setCombo(i),a&&this.setData(a),o&&this.setEdge(o),l&&this.setLayout(l),c&&this.setNode(c),h&&this.setTheme(h),u&&this.setPlugins(u),f&&this.setTransforms(f),(fe(d)||fe(s))&&this.setSize((m=d!=null?d:this.options.width)!=null?m:0,(x=s!=null?s:this.options.height)!=null?x:0)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(t,r){var i;Object.assign(this.options,{width:t,height:r}),(i=this.context.canvas)==null||i.resize(t,r)}setZoomRange(t){this.options.zoomRange=t}getZoomRange(){return this.options.zoomRange}setNode(t){this.options.node=t,this.context.model.refreshData()}setEdge(t){this.options.edge=t,this.context.model.refreshData()}setCombo(t){this.options.combo=t,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(t){this.options.theme=jt(t)?t(this.getTheme()):t}setLayout(t){this.options.layout=jt(t)?t(this.getLayout()):t}getLayout(){return this.options.layout}setBehaviors(t){var r;this.options.behaviors=jt(t)?t(this.getBehaviors()):t,(r=this.context.behavior)==null||r.setBehaviors(this.options.behaviors)}updateBehavior(t){this.setBehaviors(r=>r.map(i=>typeof i=="object"&&i.key===t.key?at(at({},i),t):i))}getBehaviors(){return this.options.behaviors||[]}setPlugins(t){var r;this.options.plugins=jt(t)?t(this.getPlugins()):t,(r=this.context.plugin)==null||r.setPlugins(this.options.plugins)}updatePlugin(t){this.setPlugins(r=>r.map(i=>typeof i=="object"&&i.key===t.key?at(at({},i),t):i))}getPlugins(){return this.options.plugins||[]}getPluginInstance(t){return this.context.plugin.getPluginInstance(t)}setTransforms(t){var r;this.options.transforms=jt(t)?t(this.getTransforms()):t,(r=this.context.transform)==null||r.setTransforms(this.options.transforms)}updateTransform(t){this.setTransforms(r=>r.map(i=>typeof i=="object"&&i.key===t.key?at(at({},i),t):i)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(t){return Array.isArray(t)?t.map(r=>this.context.model.getElementDataById(r)):this.context.model.getElementDataById(t)}getNodeData(t){var r;return t===void 0?this.context.model.getNodeData():Array.isArray(t)?this.context.model.getNodeData(t):(r=this.context.model.getNodeData([t]))==null?void 0:r[0]}getEdgeData(t){var r;return t===void 0?this.context.model.getEdgeData():Array.isArray(t)?this.context.model.getEdgeData(t):(r=this.context.model.getEdgeData([t]))==null?void 0:r[0]}getComboData(t){var r;return t===void 0?this.context.model.getComboData():Array.isArray(t)?this.context.model.getComboData(t):(r=this.context.model.getComboData([t]))==null?void 0:r[0]}setData(t){this.context.model.setData(jt(t)?t(this.getData()):t)}addData(t){this.context.model.addData(jt(t)?t(this.getData()):t)}addNodeData(t){this.context.model.addNodeData(jt(t)?t(this.getNodeData()):t)}addEdgeData(t){this.context.model.addEdgeData(jt(t)?t(this.getEdgeData()):t)}addComboData(t){this.context.model.addComboData(jt(t)?t(this.getComboData()):t)}addChildrenData(t,r){this.context.model.addChildrenData(t,r)}updateData(t){this.context.model.updateData(jt(t)?t(this.getData()):t)}updateNodeData(t){this.context.model.updateNodeData(jt(t)?t(this.getNodeData()):t)}updateEdgeData(t){this.context.model.updateEdgeData(jt(t)?t(this.getEdgeData()):t)}updateComboData(t){this.context.model.updateComboData(jt(t)?t(this.getComboData()):t)}removeData(t){this.context.model.removeData(jt(t)?t(this.getData()):t)}removeNodeData(t){this.context.model.removeNodeData(jt(t)?t(this.getNodeData()):t)}removeEdgeData(t){this.context.model.removeEdgeData(jt(t)?t(this.getEdgeData()):t)}removeComboData(t){this.context.model.removeComboData(jt(t)?t(this.getComboData()):t)}getElementType(t){return this.context.model.getElementType(t)}getRelatedEdgesData(t,r="both"){return this.context.model.getRelatedEdgesData(t,r)}getNeighborNodesData(t){return this.context.model.getNeighborNodesData(t)}getAncestorsData(t,r){return this.context.model.getAncestorsData(t,r)}getParentData(t,r){return this.context.model.getParentData(t,r)}getChildrenData(t){return this.context.model.getChildrenData(t)}getElementDataByState(t,r){return this.context.model.getElementDataByState(t,r)}initCanvas(){return Pt(this,null,function*(){if(this.context.canvas)return yield this.context.canvas.ready;const{container:t="container",width:r,height:i,renderer:a,cursor:o,background:s}=this.options;if(t instanceof t_)this.context.canvas=t,o&&t.setCursor(o),yield t.ready;else{const l=ue(t)?document.getElementById(t):t,c=_x(l);this.emit(Tt.BEFORE_CANVAS_INIT,{container:l,width:r,height:i});const u=new t_({container:l,width:r||c[0],height:i||c[1],background:s,renderer:a,cursor:o});this.context.canvas=u,yield u.ready,this.emit(Tt.AFTER_CANVAS_INIT,{canvas:u})}})}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new X8(this.context)),this.context.plugin||(this.context.plugin=new pz(this.context)),this.context.viewport||(this.context.viewport=new gz(this.context)),this.context.transform||(this.context.transform=new vz(this.context)),this.context.element||(this.context.element=new Q8(this.context)),this.context.animation||(this.context.animation=new Y8(this.context)),this.context.layout||(this.context.layout=new dz(this.context)),this.context.behavior||(this.context.behavior=new j8(this.context))}prepare(){return Pt(this,null,function*(){if(yield Promise.resolve(),this.destroyed)throw new Error(Sa("The graph instance has been destroyed"));yield this.initCanvas(),this.initRuntime()})}render(){return Pt(this,null,function*(){yield this.prepare(),er(this,new Vn(Tt.BEFORE_RENDER));const t=this.context.element.draw({type:"render"});yield Promise.all([t==null?void 0:t.finished,this.context.layout.layout()]),yield this.autoFit(),er(this,new Vn(Tt.AFTER_RENDER))})}draw(){return Pt(this,null,function*(){var t;yield this.prepare(),yield(t=this.context.element.draw())==null?void 0:t.finished})}layout(){return Pt(this,null,function*(){yield this.context.layout.layout()})}stopLayout(){this.context.layout.stopLayout()}clear(){return Pt(this,null,function*(){this.context.model.setData({}),yield this.draw()})}destroy(){er(this,new Vn(Tt.BEFORE_DESTROY));const{layout:t,animation:r,element:i,model:a,canvas:o,behavior:s,plugin:l}=this.context;l==null||l.destroy(),s==null||s.destroy(),t==null||t.destroy(),r==null||r.destroy(),i==null||i.destroy(),a.destroy(),o==null||o.destroy(),this.options={},this.context={},this.off(),window.removeEventListener("resize",this.onResize),this.destroyed=!0,er(this,new Vn(Tt.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(t,r){const i=!t||!r?_x(this.context.canvas.getContainer()):[t,r];vn(i,this.getSize())||(er(this,new Vn(Tt.BEFORE_SIZE_CHANGE,{size:i})),this.context.canvas.resize(...i),er(this,new Vn(Tt.AFTER_SIZE_CHANGE,{size:i})))}fitView(t,r){return Pt(this,null,function*(){var i;yield(i=this.context.viewport)==null?void 0:i.fitView(t,r)})}fitCenter(t){return Pt(this,null,function*(){var r;yield(r=this.context.viewport)==null?void 0:r.fitCenter(t)})}autoFit(){return Pt(this,null,function*(){const{autoFit:t}=this.context.options;if(t)if(ue(t))t==="view"?yield this.fitView():t==="center"&&(yield this.fitCenter());else{const{type:r,animation:i}=t;r==="view"?yield this.fitView(t.options,i):r==="center"&&(yield this.fitCenter(i))}})}focusElement(t,r){return Pt(this,null,function*(){var i;yield(i=this.context.viewport)==null?void 0:i.focusElements(Array.isArray(t)?t:[t],r)})}zoomBy(t,r,i){return Pt(this,null,function*(){yield this.context.viewport.transform({mode:"relative",scale:t,origin:i},r)})}zoomTo(t,r,i){return Pt(this,null,function*(){this.context.viewport.transform({mode:"absolute",scale:t,origin:i},r)})}getZoom(){return this.context.viewport.getZoom()}rotateBy(t,r,i){return Pt(this,null,function*(){yield this.context.viewport.transform({mode:"relative",rotate:t,origin:i},r)})}rotateTo(t,r,i){return Pt(this,null,function*(){yield this.context.viewport.transform({mode:"absolute",rotate:t,origin:i},r)})}getRotation(){return this.context.viewport.getRotation()}translateBy(t,r){return Pt(this,null,function*(){yield this.context.viewport.transform({mode:"relative",translate:t},r)})}translateTo(t,r){return Pt(this,null,function*(){yield this.context.viewport.transform({mode:"absolute",translate:t},r)})}getPosition(){return In([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(t,r,i=!0){return Pt(this,null,function*(){var s;const[a,o]=dn(t)?[t,r!=null?r:!0]:[{[t]:r},i];Object.entries(a).forEach(([l,c])=>this.context.model.translateNodeLikeBy(l,c)),yield(s=this.context.element.draw({animation:o,stage:"translate"}))==null?void 0:s.finished})}translateElementTo(t,r,i=!0){return Pt(this,null,function*(){var s;const[a,o]=dn(t)?[t,r!=null?r:!0]:[{[t]:r},i];Object.entries(a).forEach(([l,c])=>this.context.model.translateNodeLikeTo(l,c)),yield(s=this.context.element.draw({animation:o,stage:"translate"}))==null?void 0:s.finished})}getElementPosition(t){return this.context.model.getElementPosition(t)}getElementRenderStyle(t){return ev(this.context.element.getElement(t).attributes,["context"])}setElementVisibility(t,r,i=!0){return Pt(this,null,function*(){var u;const[a,o]=dn(t)?[t,r!=null?r:!0]:[{[t]:r},i],s={nodes:[],edges:[],combos:[]};Object.entries(a).forEach(([h,f])=>{const d=this.getElementType(h);s[`${d}s`].push({id:h,style:{visibility:f}})});const{model:l,element:c}=this.context;l.preventUpdateNodeLikeHierarchy(()=>{l.updateData(s)}),yield(u=c.draw({animation:o,stage:"visibility"}))==null?void 0:u.finished})}showElement(t,r){return Pt(this,null,function*(){const i=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(i.map(a=>[a,"visible"])),r)})}hideElement(t,r){return Pt(this,null,function*(){const i=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(i.map(a=>[a,"hidden"])),r)})}getElementVisibility(t){var i,a;const r=this.context.element.getElement(t);return(a=(i=r==null?void 0:r.style)==null?void 0:i.visibility)!=null?a:"visible"}setElementZIndex(t,r){return Pt(this,null,function*(){var l;const i={nodes:[],edges:[],combos:[]},a=dn(t)?t:{[t]:r};Object.entries(a).forEach(([c,u])=>{const h=this.getElementType(c);i[`${h}s`].push({id:c,style:{zIndex:u}})});const{model:o,element:s}=this.context;o.preventUpdateNodeLikeHierarchy(()=>o.updateData(i)),yield(l=s.draw({animation:!1,stage:"zIndex"}))==null?void 0:l.finished})}frontElement(t){return Pt(this,null,function*(){const r=Array.isArray(t)?t:[t],{model:i,element:a}=this.context,o={};r.map(s=>{const l=a.getFrontZIndex(s);if(i.getElementType(s)==="combo"){const u=i.getAncestorsData(s,en).at(-1)||this.getComboData(s),h=[u,...i.getDescendantsData(it(u))],f=l-a.getElementZIndex(s);h.forEach(d=>{o[it(d)]=this.getElementZIndex(it(d))+f})}else o[s]=l}),yield this.setElementZIndex(o)})}getElementZIndex(t){var a,o,s;const{model:r,element:i}=this.context;return(s=(o=(a=r.getElementDataById(t))==null?void 0:a.style)==null?void 0:o.zIndex)!=null?s:i.getElementZIndex(t)}setElementState(t,r,i=!0){return Pt(this,null,function*(){var c;const[a,o]=dn(t)?[t,r!=null?r:!0]:[{[t]:r},i],s=u=>u?Array.isArray(u)?u:[u]:[],l={nodes:[],edges:[],combos:[]};Object.entries(a).forEach(([u,h])=>{const f=this.getElementType(u);l[`${f}s`].push({id:u,states:s(h)})}),this.updateData(l),yield(c=this.context.element.draw({animation:o}))==null?void 0:c.finished})}getElementState(t){return this.context.model.getElementState(t)}getElementRenderBounds(t){return this.context.element.getElement(t).getRenderBounds()}collapseElement(t,r=!0){return Pt(this,null,function*(){const{model:i,element:a}=this.context;if(oi(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;const o=i.getElementType(t);yield this.frontElement(t),this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!0),o==="node"?yield a.collapseNode(t,r):o==="combo"&&(yield a.collapseCombo(t,r)),this.isCollapsingExpanding=!1})}expandElement(t,r=!0){return Pt(this,null,function*(){const{model:i,element:a}=this.context;if(!oi(i.getNodeLikeData([t])[0])||this.isCollapsingExpanding)return;const o=i.getElementType(t);this.isCollapsingExpanding=!0,this.setElementCollapsibility(t,!1),o==="node"?yield a.expandNode(t,r):o==="combo"&&(yield a.expandCombo(t,r)),this.isCollapsingExpanding=!1})}setElementCollapsibility(t,r){const i=this.getElementType(t);i==="node"?this.updateNodeData([{id:t,style:{collapsed:r}}]):i==="combo"&&this.updateComboData([{id:t,style:{collapsed:r}}])}toDataURL(){return Pt(this,arguments,function*(t={}){return this.context.canvas.toDataURL(t)})}getCanvasByViewport(t){return this.context.canvas.getCanvasByViewport(t)}getViewportByCanvas(t){return this.context.canvas.getViewportByCanvas(t)}getClientByCanvas(t){return this.context.canvas.getClientByCanvas(t)}getCanvasByClient(t){return this.context.canvas.getCanvasByClient(t)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(t,r,i){return super.on(t,r,i)}once(t,r){return super.once(t,r)}off(t,r){return super.off(t,r)}};let ed=gm;k(ed,"defaultOptions",{autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]});class mz extends ml{beforeDraw(e){const{add:t,update:r}=e,{model:i}=this.context;return[...t.edges.entries(),...r.edges.entries()].forEach(([,a])=>{g_(i,a)}),e}}const g_=(n,e)=>{const{source:t,target:r}=e,i=n.getElementDataById(t),a=n.getElementDataById(r),o=ux(i,h=>n.getParentData(h,en)),s=ux(a,h=>n.getParentData(h,en)),l=it(o),c=it(s),u={sourceNode:l,targetNode:c};return e.style?Object.assign(e.style,u):e.style=u,e},yz="quadratic",m_=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"],mm=class extends ml{constructor(t,r){super(t,Object.assign({},mm.defaultOptions,r));k(this,"cacheMergeStyle",new Map);k(this,"getAffectedParallelEdges",t=>{const{add:{edges:r},update:{nodes:i,edges:a,combos:o},remove:{edges:s}}=t,{model:l}=this.context,c=new Map,u=(d,p)=>{l.getRelatedEdgesData(p).forEach(g=>!c.has(it(g))&&c.set(it(g),g))};i.forEach(u),o.forEach(u);const h=d=>{const p=l.getEdgeData().map(g=>g_(l,g));xz(d,p,!0).forEach(g=>!c.has(it(g))&&c.set(it(g),g))};if(s.size&&s.forEach(h),r.size&&r.forEach(h),a.size){const d=Lx(lv(l.getChanges())).update.edges;a.forEach(p=>{var g;h(p);const v=(g=d.find(m=>it(m.value)===it(p)))==null?void 0:g.original;v&&!Mg(p,v)&&h(v)})}Bp(this.options.edges)||c.forEach((d,p)=>!this.options.edges.includes(p)&&c.delete(p));const f=l.getEdgeData().map(it);return new Map([...c].sort((d,p)=>f.indexOf(d[0])-f.indexOf(p[0])))});k(this,"applyBundlingStyle",(t,r,i)=>{const{edgeMap:a,reverses:o}=y_(r);a.forEach(s=>{s.forEach((l,c,u)=>{var p;const f=Object.assign(l,{type:yz,style:(()=>{const v=u.length,g={};if(l.source===l.target){const m=m_.length;g.loopPlacement=m_[c%m],g.loopDist=Math.floor(c/m)*i+50}else if(v===1)g.curveOffset=0;else{const m=(c%2===0?1:-1)*(o[`${l.source}|${l.target}|${c}`]?-1:1);g.curveOffset=v%2===1?m*Math.ceil(c/2)*i*2:m*(Math.floor(c/2)*i*2+i)}return Object.assign({},l.style,g)})()});((p=this.context.element)==null?void 0:p.getElement(it(l)))?Fl(t,"update","edge",f,!0):Fl(t,"add","edge",f,!0)})})});k(this,"resetEdgeStyle",t=>{const r=t.style||{},i=this.cacheMergeStyle.get(it(t))||{};return Object.keys(i).forEach(a=>{vn(r[a],i[a])&&(t[a]?r[a]=t[a]:delete r[a])}),Object.assign(t,{style:r})});k(this,"applyMergingStyle",(t,r)=>{const{edgeMap:i,reverses:a}=y_(r);i.forEach(o=>{var l;if(o.length===1){const c=o[0],u=(l=this.context.element)==null?void 0:l.getElement(it(c));Fl(t,u?"update":"add","edge",this.resetEdgeStyle(c),!0);return}const s=o.map(({source:c,target:u,style:h={}},f)=>{const{startArrow:d,endArrow:p}=h,v={},[g,m]=a[`${c}|${u}|${f}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return ds(d)&&(v[g]=d),ds(p)&&(v[m]=p),v}).reduce((c,u)=>at(at({},c),u),{});o.forEach((c,u,h)=>{var f;if(u===0){const d=Object.assign({},jt(this.options.style)?this.options.style(h):this.options.style,{childrenData:h});this.cacheMergeStyle.set(it(c),d);const p=Se(at({},c),{type:"line",style:at(at({},s),d)}),v=(f=this.context.element)==null?void 0:f.getElement(it(c));Fl(t,v?"update":"add","edge",p,!0)}else Fl(t,"remove","edge",c)})})})}beforeDraw(t){const r=this.getAffectedParallelEdges(t);return r.size===0||(this.options.mode==="bundle"?this.applyBundlingStyle(t,r,this.options.distance):this.applyMergingStyle(t,r)),t}};let nd=mm;k(nd,"defaultOptions",{mode:"bundle",edges:void 0,distance:15});const y_=n=>{const e=new Map,t=new Set,r={};for(const[i,a]of n){if(t.has(i))continue;const{source:o,target:s}=a,l=`${o}-${s}`;e.has(l)||e.set(l,[]),e.get(l).push(a),t.add(i);for(const[c,u]of n)t.has(c)||Mg(a,u)&&(e.get(l).push(u),t.add(c),o===u.target&&s===u.source&&(r[`${u.source}|${u.target}|${e.get(l).length-1}`]=!0))}return{edgeMap:e,reverses:r}},xz=(n,e,t)=>e.filter(r=>(t||it(r)!==it(n))&&Mg(r,n)),Mg=(n,e)=>{const{sourceNode:t,targetNode:r}=n.style||{},{sourceNode:i,targetNode:a}=e.style||{};return t===i&&r===a||t===a&&r===i};class bz extends ml{beforeDraw(e,t){const{stage:r}=t;if(r==="visibility")return e;const{model:i}=this.context,{update:{nodes:a,edges:o,combos:s}}=e,l=(c,u)=>{i.getRelatedEdgesData(u).forEach(f=>!o.has(it(f))&&o.set(it(f),f))};return a.forEach(l),s.forEach(l),e}}const Ez={animation:{"combo-collapse":P1,"combo-expand":qA,"node-collapse":S1,"node-expand":KA,"path-in":T1,"path-out":ZA,fade:jA,translate:$A},behavior:{"brush-select":Vl,"click-select":Fu,"collapse-expand":Qu,"create-edge":nh,"drag-canvas":ih,"drag-element-force":JN,"drag-element":tc,"fix-element-size":oh,"focus-element":sh,"hover-activate":lh,"lasso-select":QN,"optimize-viewport-transform":ch,"scroll-canvas":uh,"zoom-canvas":hh},combo:{circle:JO,rect:QO},edge:{cubic:zo,line:ql,polyline:qu,quadratic:Ju,"cubic-horizontal":Ku,"cubic-vertical":Zu},layout:{"antv-dagre":tR.b,"combo-combined":nR.u,"compact-box":fh.compactBox,"force-atlas2":oR.E,circular:eR.S,concentric:rR.W,"d3-force":iR.j,dagre:aR.V,dendrogram:fh.dendrogram,force:sR.y,fruchterman:lR.O,grid:cR.M,indented:fh.indented,mds:uR.A,mindmap:fh.mindmap,radial:hR.D,random:fR._},node:{circle:Gs,diamond:UO,ellipse:Hu,hexagon:XO,html:Yu,image:Xu,rect:KO,star:ZO,donut:Uu,triangle:ju},palette:{spectral:dR,tableau:pR,oranges:vR,greens:gR,blues:mR},theme:{dark:G8,light:z8},plugin:{"bubble-sets":wh,"edge-filter-lens":Sh,"grid-line":Ph,background:dh,contextmenu:_h,fullscreen:Th,history:Mh,hull:Ch,legend:lf,minimap:Nf,snapline:Rf,timebar:Vf,toolbar:Hf,tooltip:Yf,watermark:Xf},transform:{"update-related-edges":bz,"arrange-draw-order":W8,"collapse-expand-combo":U8,"collapse-expand-node":V8,"process-parallel-edges":nd,"get-edge-actual-ends":mz},shape:{circle:Rl,ellipse:ap,group:kl,html:op,image:Gp,line:cu,path:Xa,polygon:uu,polyline:Zy,rect:ra,text:Ll,label:Qa,badge:Ds}};function wz(){Object.entries(Ez).forEach(([n,e])=>{Object.entries(e).forEach(([t,r])=>{Jw(n,t,r)})})}nt.enableCSSParsing=!1,wz();const KV={css:"//at.alicdn.com/t/a/font_470089_8hnbbf8n4u8.css",js:"//at.alicdn.com/t/a/font_470089_8hnbbf8n4u8.js"}},81746:function(Ct){(function(D,G){Ct.exports=G()})(typeof self!="undefined"?self:this,function(){return function(ft){var D={};function G(lt){if(D[lt])return D[lt].exports;var q=D[lt]={i:lt,l:!1,exports:{}};return ft[lt].call(q.exports,q,q.exports,G),q.l=!0,q.exports}return G.m=ft,G.c=D,G.d=function(lt,q,B){G.o(lt,q)||Object.defineProperty(lt,q,{configurable:!1,enumerable:!0,get:B})},G.n=function(lt){var q=lt&&lt.__esModule?function(){return lt.default}:function(){return lt};return G.d(q,"a",q),q},G.o=function(lt,q){return Object.prototype.hasOwnProperty.call(lt,q)},G.p="",G(G.s=5)}([function(ft,D){function G(lt,q,B,N){return N===void 0&&(N="height"),B==="center"?(lt[N]+q[N])/2:lt.height}ft.exports={assign:Object.assign,getHeight:G}},function(ft,D,G){var lt=G(3),q=function(){function B(V,W){W===void 0&&(W={});var X=this;X.options=W,X.rootNode=lt(V,W)}var N=B.prototype;return N.execute=function(){throw new Error("please override this method")},B}();ft.exports=q},function(ft,D,G){var lt=G(4),q=["LR","RL","TB","BT","H","V"],B=["LR","RL","H"],N=function(X){return B.indexOf(X)>-1},V=q[0];ft.exports=function(W,X,F){var H=X.direction||V;if(X.isHorizontal=N(H),H&&q.indexOf(H)===-1)throw new TypeError("Invalid direction: "+H);if(H===q[0])F(W,X);else if(H===q[1])F(W,X),W.right2left();else if(H===q[2])F(W,X);else if(H===q[3])F(W,X),W.bottom2top();else if(H===q[4]||H===q[5]){var U=lt(W,X),$=U.left,dt=U.right;F($,X),F(dt,X),X.isHorizontal?$.right2left():$.bottom2top(),dt.translate($.x-dt.x,$.y-dt.y),W.x=$.x,W.y=dt.y;var j=W.getBoundingBox();X.isHorizontal?j.top<0&&W.translate(0,-j.top):j.left<0&&W.translate(-j.left,0)}var gt=X.fixedRoot;return gt===void 0&&(gt=!0),gt&&W.translate(-(W.x+W.width/2+W.hgap),-(W.y+W.height/2+W.vgap)),W}},function(ft,D,G){var lt=G(0),q=18,B=q*2,N=q,V={getId:function(H){return H.id||H.name},getPreH:function(H){return H.preH||0},getPreV:function(H){return H.preV||0},getHGap:function(H){return H.hgap||N},getVGap:function(H){return H.vgap||N},getChildren:function(H){return H.children},getHeight:function(H){return H.height||B},getWidth:function(H){var U=H.label||" ";return H.width||U.split("").length*q}};function W(F,H){var U=this;if(U.vgap=U.hgap=0,F instanceof W)return F;U.data=F;var $=H.getHGap(F),dt=H.getVGap(F);return U.preH=H.getPreH(F),U.preV=H.getPreV(F),U.width=H.getWidth(F),U.height=H.getHeight(F),U.width+=U.preH,U.height+=U.preV,U.id=H.getId(F),U.x=U.y=0,U.depth=0,U.children||(U.children=[]),U.addGap($,dt),U}lt.assign(W.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(H,U){var $=this;$.hgap+=H,$.vgap+=U,$.width+=2*H,$.height+=2*U},eachNode:function(H){for(var U=this,$=[U],dt;dt=$.shift();)H(dt),$=dt.children.concat($)},DFTraverse:function(H){this.eachNode(H)},BFTraverse:function(H){for(var U=this,$=[U],dt;dt=$.shift();)H(dt),$=$.concat(dt.children)},getBoundingBox:function(){var H={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(U){H.left=Math.min(H.left,U.x),H.top=Math.min(H.top,U.y),H.width=Math.max(H.width,U.x+U.width),H.height=Math.max(H.height,U.y+U.height)}),H},translate:function(H,U){H===void 0&&(H=0),U===void 0&&(U=0),this.eachNode(function($){$.x+=H,$.y+=U,$.x+=$.preH,$.y+=$.preV})},right2left:function(){var H=this,U=H.getBoundingBox();H.eachNode(function($){$.x=$.x-($.x-U.left)*2-$.width}),H.translate(U.width,0)},bottom2top:function(){var H=this,U=H.getBoundingBox();H.eachNode(function($){$.y=$.y-($.y-U.top)*2-$.height}),H.translate(0,U.height)}});function X(F,H,U){H===void 0&&(H={}),H=lt.assign({},V,H);var $=new W(F,H),dt=[$],j;if(!U&&!F.collapsed){for(;j=dt.shift();)if(!j.data.collapsed){var gt=H.getChildren(j.data),St=gt?gt.length:0;if(j.children=new Array(St),gt&&St)for(var tt=0;tt<St;tt++){var pt=new W(gt[tt],H);j.children[tt]=pt,dt.push(pt),pt.parent=j,pt.depth=j.depth+1}}}return $}ft.exports=X},function(ft,D,G){var lt=G(3);ft.exports=function(q,B){for(var N=lt(q.data,B,!0),V=lt(q.data,B,!0),W=q.children.length,X=Math.round(W/2),F=B.getSide||function(dt,j){return j<X?"right":"left"},H=0;H<W;H++){var U=q.children[H],$=F(U,H);$==="right"?V.children.push(U):N.children.push(U)}return N.eachNode(function(dt){dt.isRoot()||(dt.side="left")}),V.eachNode(function(dt){dt.isRoot()||(dt.side="right")}),{left:N,right:V}}},function(ft,D,G){var lt={compactBox:G(6),dendrogram:G(8),indented:G(10),mindmap:G(12)};ft.exports=lt},function(ft,D,G){function lt(U,$){U.prototype=Object.create($.prototype),U.prototype.constructor=U,q(U,$)}function q(U,$){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(j,gt){return j.__proto__=gt,j},q(U,$)}var B=G(1),N=G(7),V=G(2),W=G(0),X=function(U){function $(){return U.apply(this,arguments)||this}lt($,U);var dt=$.prototype;return dt.execute=function(){var gt=this;return V(gt.rootNode,gt.options,N)},$}(B),F={};function H(U,$){return $=W.assign({},F,$),new X(U,$).execute()}ft.exports=H},function(ft,D){function G(W,X,F,H){H===void 0&&(H=[]);var U=this;U.w=W||0,U.h=X||0,U.y=F||0,U.x=0,U.c=H||[],U.cs=H.length,U.prelim=0,U.mod=0,U.shift=0,U.change=0,U.tl=null,U.tr=null,U.el=null,U.er=null,U.msel=0,U.mser=0}G.fromNode=function(W,X){if(!W)return null;var F=[];return W.children.forEach(function(H){F.push(G.fromNode(H,X))}),X?new G(W.height,W.width,W.x,F):new G(W.width,W.height,W.y,F)};function lt(W,X,F){F?W.y+=X:W.x+=X,W.children.forEach(function(H){lt(H,X,F)})}function q(W,X){var F=X?W.y:W.x;return W.children.forEach(function(H){F=Math.min(q(H,X),F)}),F}function B(W,X){var F=q(W,X);lt(W,-F,X)}function N(W,X,F){F?X.y=W.x:X.x=W.x,W.c.forEach(function(H,U){N(H,X.children[U],F)})}function V(W,X,F){F===void 0&&(F=0),X?(W.x=F,F+=W.width):(W.y=F,F+=W.height),W.children.forEach(function(H){V(H,X,F)})}ft.exports=function(W,X){X===void 0&&(X={});var F=X.isHorizontal;function H(ot){if(ot.cs===0){U(ot);return}H(ot.c[0]);for(var Gt=pe(St(ot.c[0].el),0,null),zt=1;zt<ot.cs;++zt){H(ot.c[zt]);var Ot=St(ot.c[zt].er);$(ot,zt,Gt),Gt=pe(Ot,zt,Gt)}C(ot),U(ot)}function U(ot){ot.cs===0?(ot.el=ot,ot.er=ot,ot.msel=ot.mser=0):(ot.el=ot.c[0].el,ot.msel=ot.c[0].msel,ot.er=ot.c[ot.cs-1].er,ot.mser=ot.c[ot.cs-1].mser)}function $(ot,Gt,zt){for(var Ot=ot.c[Gt-1],xe=Ot.mod,se=ot.c[Gt],Gn=se.mod;Ot!==null&&se!==null;){St(Ot)>zt.low&&(zt=zt.nxt);var vt=xe+Ot.prelim+Ot.w-(Gn+se.prelim);vt>0&&(Gn+=vt,dt(ot,Gt,zt.index,vt));var he=St(Ot),be=St(se);he<=be&&(Ot=gt(Ot),Ot!==null&&(xe+=Ot.mod)),he>=be&&(se=j(se),se!==null&&(Gn+=se.mod))}!Ot&&se?tt(ot,Gt,se,Gn):Ot&&!se&&pt(ot,Gt,Ot,xe)}function dt(ot,Gt,zt,Ot){ot.c[Gt].mod+=Ot,ot.c[Gt].msel+=Ot,ot.c[Gt].mser+=Ot,ee(ot,Gt,zt,Ot)}function j(ot){return ot.cs===0?ot.tl:ot.c[0]}function gt(ot){return ot.cs===0?ot.tr:ot.c[ot.cs-1]}function St(ot){return ot.y+ot.h}function tt(ot,Gt,zt,Ot){var xe=ot.c[0].el;xe.tl=zt;var se=Ot-zt.mod-ot.c[0].msel;xe.mod+=se,xe.prelim-=se,ot.c[0].el=ot.c[Gt].el,ot.c[0].msel=ot.c[Gt].msel}function pt(ot,Gt,zt,Ot){var xe=ot.c[Gt].er;xe.tr=zt;var se=Ot-zt.mod-ot.c[Gt].mser;xe.mod+=se,xe.prelim-=se,ot.c[Gt].er=ot.c[Gt-1].er,ot.c[Gt].mser=ot.c[Gt-1].mser}function C(ot){ot.prelim=(ot.c[0].prelim+ot.c[0].mod+ot.c[ot.cs-1].mod+ot.c[ot.cs-1].prelim+ot.c[ot.cs-1].w)/2-ot.w/2}function qt(ot,Gt){Gt+=ot.mod,ot.x=ot.prelim+Gt,K(ot);for(var zt=0;zt<ot.cs;zt++)qt(ot.c[zt],Gt)}function ee(ot,Gt,zt,Ot){if(zt!==Gt-1){var xe=Gt-zt;ot.c[zt+1].shift+=Ot/xe,ot.c[Gt].shift-=Ot/xe,ot.c[Gt].change-=Ot-Ot/xe}}function K(ot){for(var Gt=0,zt=0,Ot=0;Ot<ot.cs;Ot++)Gt+=ot.c[Ot].shift,zt+=Gt+ot.c[Ot].change,ot.c[Ot].mod+=zt}function pe(ot,Gt,zt){for(;zt!==null&&ot>=zt.low;)zt=zt.nxt;return{low:ot,index:Gt,nxt:zt}}V(W,F);var le=G.fromNode(W,F);return H(le),qt(le,0),N(le,W,F),B(W,F),W}},function(ft,D,G){function lt(U,$){U.prototype=Object.create($.prototype),U.prototype.constructor=U,q(U,$)}function q(U,$){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(j,gt){return j.__proto__=gt,j},q(U,$)}var B=G(1),N=G(9),V=G(2),W=G(0),X=function(U){function $(){return U.apply(this,arguments)||this}lt($,U);var dt=$.prototype;return dt.execute=function(){var gt=this;return gt.rootNode.width=0,V(gt.rootNode,gt.options,N)},$}(B),F={};function H(U,$){return $=W.assign({},F,$),new X(U,$).execute()}ft.exports=H},function(ft,D,G){var lt=G(0);function q(V,W){V===void 0&&(V=0),W===void 0&&(W=[]);var X=this;X.x=X.y=0,X.leftChild=X.rightChild=null,X.height=0,X.children=W}var B={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function N(V,W,X){X?(W.x=V.x,W.y=V.y):(W.x=V.y,W.y=V.x),V.children.forEach(function(F,H){N(F,W.children[H],X)})}ft.exports=function(V,W){W===void 0&&(W={}),W=lt.assign({},B,W);var X=0;function F(j){if(!j)return null;j.width=0,j.depth&&j.depth>X&&(X=j.depth);var gt=j.children,St=gt.length,tt=new q(j.height,[]);return gt.forEach(function(pt,C){var qt=F(pt);tt.children.push(qt),C===0&&(tt.leftChild=qt),C===St-1&&(tt.rightChild=qt)}),tt.originNode=j,tt.isLeaf=j.isLeaf(),tt}function H(j){if(j.isLeaf||j.children.length===0)j.drawingDepth=X;else{var gt=j.children.map(function(tt){return H(tt)}),St=Math.min.apply(null,gt);j.drawingDepth=St-1}return j.drawingDepth}var U;function $(j){j.x=j.drawingDepth*W.rankSep,j.isLeaf?(j.y=0,U&&(j.y=U.y+U.height+W.nodeSep,j.originNode.parent!==U.originNode.parent&&(j.y+=W.subTreeSep)),U=j):(j.children.forEach(function(gt){$(gt)}),j.y=(j.leftChild.y+j.rightChild.y)/2)}var dt=F(V);return H(dt),$(dt),N(dt,V,W.isHorizontal),V}},function(ft,D,G){function lt(dt,j){dt.prototype=Object.create(j.prototype),dt.prototype.constructor=dt,q(dt,j)}function q(dt,j){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(St,tt){return St.__proto__=tt,St},q(dt,j)}var B=G(1),N=G(11),V=G(4),W=G(0),X=["LR","RL","H"],F=X[0],H=function(dt){function j(){return dt.apply(this,arguments)||this}lt(j,dt);var gt=j.prototype;return gt.execute=function(){var tt=this,pt=tt.options,C=tt.rootNode;pt.isHorizontal=!0;var qt=pt.indent,ee=qt===void 0?20:qt,K=pt.dropCap,pe=K===void 0?!0:K,le=pt.direction,ot=le===void 0?F:le,Gt=pt.align;if(ot&&X.indexOf(ot)===-1)throw new TypeError("Invalid direction: "+ot);if(ot===X[0])N(C,ee,pe,Gt);else if(ot===X[1])N(C,ee,pe,Gt),C.right2left();else if(ot===X[2]){var zt=V(C,pt),Ot=zt.left,xe=zt.right;N(Ot,ee,pe,Gt),Ot.right2left(),N(xe,ee,pe,Gt);var se=Ot.getBoundingBox();xe.translate(se.width,0),C.x=xe.x-C.width/2}return C},j}(B),U={};function $(dt,j){return j=W.assign({},U,j),new H(dt,j).execute()}ft.exports=$},function(ft,D,G){var lt=G(0);function q(B,N,V,W,X){var F=typeof V=="function"?V(B):V*B.depth;if(!W)try{if(B.id===B.parent.children[0].id){B.x+=F,B.y=N?N.y:0;return}}catch($){}if(B.x+=F,N){if(B.y=N.y+lt.getHeight(N,B,X),N.parent&&B.parent.id!==N.parent.id){var H=N.parent,U=H.y+lt.getHeight(H,B,X);B.y=U>B.y?U:B.y}}else B.y=0}ft.exports=function(B,N,V,W){var X=null;B.eachNode(function(F){q(F,X,N,V,W),X=F})}},function(ft,D,G){function lt(U,$){U.prototype=Object.create($.prototype),U.prototype.constructor=U,q(U,$)}function q(U,$){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(j,gt){return j.__proto__=gt,j},q(U,$)}var B=G(1),N=G(13),V=G(2),W=G(0),X=function(U){function $(){return U.apply(this,arguments)||this}lt($,U);var dt=$.prototype;return dt.execute=function(){var gt=this;return V(gt.rootNode,gt.options,N)},$}(B),F={};function H(U,$){return $=W.assign({},F,$),new X(U,$).execute()}ft.exports=H},function(ft,D,G){var lt=G(0);function q(V,W){var X=0;return V.children.length?V.children.forEach(function(F){X+=q(F,W)}):X=V.height,V._subTreeSep=W.getSubTreeSep(V.data),V.totalHeight=Math.max(V.height,X)+2*V._subTreeSep,V.totalHeight}function B(V){var W=V.children,X=W.length;if(X){W.forEach(function(j){B(j)});var F=W[0],H=W[X-1],U=H.y-F.y+H.height,$=0;if(W.forEach(function(j){$+=j.totalHeight}),U>V.height)V.y=F.y+U/2-V.height/2;else if(W.length!==1||V.height>$){var dt=V.y+(V.height-U)/2-F.y;W.forEach(function(j){j.translate(0,dt)})}else V.y=(F.y+F.height/2+H.y+H.height/2)/2-V.height/2}}var N={getSubTreeSep:function(){return 0}};ft.exports=function(V,W){W===void 0&&(W={}),W=lt.assign({},N,W),V.parent={x:0,width:0,height:0,y:0},V.BFTraverse(function(X){X.x=X.parent.x+X.parent.width}),V.parent=null,q(V,W),V.startY=0,V.y=V.totalHeight/2-V.height/2,V.eachNode(function(X){var F=X.children,H=F.length;if(H){var U=F[0];if(U.startY=X.startY+X._subTreeSep,H===1)U.y=X.y+X.height/2-U.height/2;else{U.y=U.startY+U.totalHeight/2-U.height/2;for(var $=1;$<H;$++){var dt=F[$];dt.startY=F[$-1].startY+F[$-1].totalHeight,dt.y=dt.startY+dt.totalHeight/2-dt.height/2}}}}),B(V)}}])})},69760:function(Ct,ft,D){"use strict";D.d(ft,{Z:function(){return X},w:function(){return B}});var G=D(67294),lt=D(97937),q=D(64217);function B(F){if(F)return{closable:F.closable,closeIcon:F.closeIcon}}function N(F){const{closable:H,closeIcon:U}=F||{};return G.useMemo(()=>{if(!H&&(H===!1||U===!1||U===null))return!1;if(H===void 0&&U===void 0)return null;let $={closeIcon:typeof U!="boolean"&&U!==null?U:void 0};return H&&typeof H=="object"&&($=Object.assign(Object.assign({},$),H)),$},[H,U])}function V(){const F={};for(var H=arguments.length,U=new Array(H),$=0;$<H;$++)U[$]=arguments[$];return U.forEach(dt=>{dt&&Object.keys(dt).forEach(j=>{dt[j]!==void 0&&(F[j]=dt[j])})}),F}const W={};function X(F,H){let U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:W;const $=N(F),dt=N(H),j=G.useMemo(()=>Object.assign({closeIcon:G.createElement(lt.Z,null)},U),[U]),gt=G.useMemo(()=>$===!1?!1:$?V(j,dt,$):dt===!1?!1:dt?V(j,dt):j.closable?j:!1,[$,dt,j]);return G.useMemo(()=>{if(gt===!1)return[!1,null];const{closeIconRender:St}=j,{closeIcon:tt}=gt;let pt=tt;if(pt!=null){St&&(pt=St(tt));const C=(0,q.Z)(gt,!0);Object.keys(C).length&&(pt=G.isValidElement(pt)?G.cloneElement(pt,C):G.createElement("span",Object.assign({},C),pt))}return[!0,pt]},[gt,j])}},38925:function(Ct,ft,D){"use strict";D.d(ft,{Z:function(){return ie}});var G=D(67294),lt=D(89739),q=D(4340),B=D(97937),N=D(21640),V=D(78860),W=D(93967),X=D.n(W),F=D(82225),H=D(42550),U=D(64217),$=D(96159),dt=D(53124),j=D(54548),gt=D(14747),St=D(91945);const tt=(Dt,Bt,et,T,ut)=>({background:Dt,border:`${(0,j.bf)(T.lineWidth)} ${T.lineType} ${Bt}`,[`${ut}-icon`]:{color:et}}),pt=Dt=>{const{componentCls:Bt,motionDurationSlow:et,marginXS:T,marginSM:ut,fontSize:Q,fontSizeLG:Ft,lineHeight:kt,borderRadiusLG:Jt,motionEaseInOutCirc:ne,withDescriptionIconSize:Xt,colorText:Te,colorTextHeading:Wt,withDescriptionPadding:Mn,defaultPadding:Pe}=Dt;return{[Bt]:Object.assign(Object.assign({},(0,gt.Wf)(Dt)),{position:"relative",display:"flex",alignItems:"center",padding:Pe,wordWrap:"break-word",borderRadius:Jt,[`&${Bt}-rtl`]:{direction:"rtl"},[`${Bt}-content`]:{flex:1,minWidth:0},[`${Bt}-icon`]:{marginInlineEnd:T,lineHeight:0},["&-description"]:{display:"none",fontSize:Q,lineHeight:kt},"&-message":{color:Wt},[`&${Bt}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${et} ${ne}, opacity ${et} ${ne},
        padding-top ${et} ${ne}, padding-bottom ${et} ${ne},
        margin-bottom ${et} ${ne}`},[`&${Bt}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${Bt}-with-description`]:{alignItems:"flex-start",padding:Mn,[`${Bt}-icon`]:{marginInlineEnd:ut,fontSize:Xt,lineHeight:0},[`${Bt}-message`]:{display:"block",marginBottom:T,color:Wt,fontSize:Ft},[`${Bt}-description`]:{display:"block",color:Te}},[`${Bt}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},C=Dt=>{const{componentCls:Bt,colorSuccess:et,colorSuccessBorder:T,colorSuccessBg:ut,colorWarning:Q,colorWarningBorder:Ft,colorWarningBg:kt,colorError:Jt,colorErrorBorder:ne,colorErrorBg:Xt,colorInfo:Te,colorInfoBorder:Wt,colorInfoBg:Mn}=Dt;return{[Bt]:{"&-success":tt(ut,T,et,Dt,Bt),"&-info":tt(Mn,Wt,Te,Dt,Bt),"&-warning":tt(kt,Ft,Q,Dt,Bt),"&-error":Object.assign(Object.assign({},tt(Xt,ne,Jt,Dt,Bt)),{[`${Bt}-description > pre`]:{margin:0,padding:0}})}}},qt=Dt=>{const{componentCls:Bt,iconCls:et,motionDurationMid:T,marginXS:ut,fontSizeIcon:Q,colorIcon:Ft,colorIconHover:kt}=Dt;return{[Bt]:{["&-action"]:{marginInlineStart:ut},[`${Bt}-close-icon`]:{marginInlineStart:ut,padding:0,overflow:"hidden",fontSize:Q,lineHeight:(0,j.bf)(Q),backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${et}-close`]:{color:Ft,transition:`color ${T}`,"&:hover":{color:kt}}},"&-close-text":{color:Ft,transition:`color ${T}`,"&:hover":{color:kt}}}}},ee=Dt=>({withDescriptionIconSize:Dt.fontSizeHeading3,defaultPadding:`${Dt.paddingContentVerticalSM}px 12px`,withDescriptionPadding:`${Dt.paddingMD}px ${Dt.paddingContentHorizontalLG}px`});var K=(0,St.I$)("Alert",Dt=>[pt(Dt),C(Dt),qt(Dt)],ee),pe=function(Dt,Bt){var et={};for(var T in Dt)Object.prototype.hasOwnProperty.call(Dt,T)&&Bt.indexOf(T)<0&&(et[T]=Dt[T]);if(Dt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ut=0,T=Object.getOwnPropertySymbols(Dt);ut<T.length;ut++)Bt.indexOf(T[ut])<0&&Object.prototype.propertyIsEnumerable.call(Dt,T[ut])&&(et[T[ut]]=Dt[T[ut]]);return et};const le={success:lt.Z,info:V.Z,error:q.Z,warning:N.Z},ot=Dt=>{const{icon:Bt,prefixCls:et,type:T}=Dt,ut=le[T]||null;return Bt?(0,$.wm)(Bt,G.createElement("span",{className:`${et}-icon`},Bt),()=>({className:X()(`${et}-icon`,{[Bt.props.className]:Bt.props.className})})):G.createElement(ut,{className:`${et}-icon`})},Gt=Dt=>{const{isClosable:Bt,prefixCls:et,closeIcon:T,handleClose:ut,ariaProps:Q}=Dt,Ft=T===!0||T===void 0?G.createElement(B.Z,null):T;return Bt?G.createElement("button",Object.assign({type:"button",onClick:ut,className:`${et}-close-icon`,tabIndex:0},Q),Ft):null};var Ot=G.forwardRef((Dt,Bt)=>{const{description:et,prefixCls:T,message:ut,banner:Q,className:Ft,rootClassName:kt,style:Jt,onMouseEnter:ne,onMouseLeave:Xt,onClick:Te,afterClose:Wt,showIcon:Mn,closable:Pe,closeText:Ut,closeIcon:Ee,action:mi,id:Cn}=Dt,Ar=pe(Dt,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action","id"]),[vr,gr]=G.useState(!1),ce=G.useRef(null);G.useImperativeHandle(Bt,()=>({nativeElement:ce.current}));const{getPrefixCls:Ae,direction:Or,alert:re}=G.useContext(dt.E_),je=Ae("alert",T),[ti,pa,yi]=K(je),ir=yr=>{var xi;gr(!0),(xi=Dt.onClose)===null||xi===void 0||xi.call(Dt,yr)},Ye=G.useMemo(()=>Dt.type!==void 0?Dt.type:Q?"warning":"info",[Dt.type,Q]),An=G.useMemo(()=>typeof Pe=="object"&&Pe.closeIcon||Ut?!0:typeof Pe=="boolean"?Pe:Ee!==!1&&Ee!==null&&Ee!==void 0?!0:!!(re!=null&&re.closable),[Ut,Ee,Pe,re==null?void 0:re.closable]),Ui=Q&&Mn===void 0?!0:Mn,mr=X()(je,`${je}-${Ye}`,{[`${je}-with-description`]:!!et,[`${je}-no-icon`]:!Ui,[`${je}-banner`]:!!Q,[`${je}-rtl`]:Or==="rtl"},re==null?void 0:re.className,Ft,kt,yi,pa),Fa=(0,U.Z)(Ar,{aria:!0,data:!0}),ld=G.useMemo(()=>{var yr,xi;return typeof Pe=="object"&&Pe.closeIcon?Pe.closeIcon:Ut||(Ee!==void 0?Ee:typeof(re==null?void 0:re.closable)=="object"&&(!((yr=re==null?void 0:re.closable)===null||yr===void 0)&&yr.closeIcon)?(xi=re==null?void 0:re.closable)===null||xi===void 0?void 0:xi.closeIcon:re==null?void 0:re.closeIcon)},[Ee,Pe,Ut,re==null?void 0:re.closeIcon]),Gc=G.useMemo(()=>{const yr=Pe!=null?Pe:re==null?void 0:re.closable;if(typeof yr=="object"){const{closeIcon:xi}=yr;return pe(yr,["closeIcon"])}return{}},[Pe,re==null?void 0:re.closable]);return ti(G.createElement(F.ZP,{visible:!vr,motionName:`${je}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:yr=>({maxHeight:yr.offsetHeight}),onLeaveEnd:Wt},(yr,xi)=>{let{className:zc,style:Wc}=yr;return G.createElement("div",Object.assign({id:Cn,ref:(0,H.sQ)(ce,xi),"data-show":!vr,className:X()(mr,zc),style:Object.assign(Object.assign(Object.assign({},re==null?void 0:re.style),Jt),Wc),onMouseEnter:ne,onMouseLeave:Xt,onClick:Te,role:"alert"},Fa),Ui?G.createElement(ot,{description:et,icon:Dt.icon,prefixCls:je,type:Ye}):null,G.createElement("div",{className:`${je}-content`},ut?G.createElement("div",{className:`${je}-message`},ut):null,et?G.createElement("div",{className:`${je}-description`},et):null),mi?G.createElement("div",{className:`${je}-action`},mi):null,G.createElement(Gt,{isClosable:An,prefixCls:je,closeIcon:ld,handleClose:ir,ariaProps:Gc}))}))}),xe=D(15671),se=D(43144),Gn=D(53640),vt=D(60136),be=function(Dt){function Bt(){var et;return(0,xe.Z)(this,Bt),et=(0,Gn.Z)(this,Bt,arguments),et.state={error:void 0,info:{componentStack:""}},et}return(0,vt.Z)(Bt,Dt),(0,se.Z)(Bt,[{key:"componentDidCatch",value:function(T,ut){this.setState({error:T,info:ut})}},{key:"render",value:function(){const{message:T,description:ut,id:Q,children:Ft}=this.props,{error:kt,info:Jt}=this.state,ne=Jt&&Jt.componentStack?Jt.componentStack:null,Xt=typeof T=="undefined"?(kt||"").toString():T,Te=typeof ut=="undefined"?ne:ut;return kt?G.createElement(Ot,{id:Q,type:"error",message:Xt,description:G.createElement("pre",{style:{fontSize:"0.9em",overflowX:"auto"}},Te)}):Ft}}])}(G.Component);const Yt=Ot;Yt.ErrorBoundary=be;var ie=Yt},26412:function(Ct,ft,D){"use strict";D.d(ft,{Z:function(){return Bt}});var G=D(67294),lt=D(93967),q=D.n(lt),B=D(74443),N=D(53124),V=D(98675),W=D(25378),F={xxl:3,xl:3,lg:3,md:3,sm:2,xs:1},U=G.createContext({}),$=D(50344),dt=function(et,T){var ut={};for(var Q in et)Object.prototype.hasOwnProperty.call(et,Q)&&T.indexOf(Q)<0&&(ut[Q]=et[Q]);if(et!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ft=0,Q=Object.getOwnPropertySymbols(et);Ft<Q.length;Ft++)T.indexOf(Q[Ft])<0&&Object.prototype.propertyIsEnumerable.call(et,Q[Ft])&&(ut[Q[Ft]]=et[Q[Ft]]);return ut};const j=et=>(0,$.Z)(et).map(T=>Object.assign(Object.assign({},T==null?void 0:T.props),{key:T.key}));function gt(et,T,ut){const Q=G.useMemo(()=>T||j(ut),[T,ut]);return G.useMemo(()=>Q.map(kt=>{var{span:Jt}=kt,ne=dt(kt,["span"]);return Object.assign(Object.assign({},ne),{span:typeof Jt=="number"?Jt:(0,B.m9)(et,Jt)})}),[Q,et])}function St(et,T,ut){let Q=et,Ft=!1;return(ut===void 0||ut>T)&&(Q=Object.assign(Object.assign({},et),{span:T}),Ft=ut!==void 0),[Q,Ft]}function tt(et,T){const ut=[];let Q=[],Ft=T,kt=!1;return et.filter(Jt=>Jt).forEach((Jt,ne)=>{const Xt=Jt==null?void 0:Jt.span,Te=Xt||1;if(ne===et.length-1){const[Wt,Mn]=St(Jt,Ft,Xt);kt=kt||Mn,Q.push(Wt),ut.push(Q);return}if(Te<Ft)Ft-=Te,Q.push(Jt);else{const[Wt,Mn]=St(Jt,Ft,Te);kt=kt||Mn,Q.push(Wt),ut.push(Q),Ft=T,Q=[]}}),[ut,kt]}var C=(et,T)=>{const[ut,Q]=(0,G.useMemo)(()=>tt(T,et),[T,et]);return ut},ee=et=>{let{children:T}=et;return T};function K(et){return et!=null}var le=et=>{const{itemPrefixCls:T,component:ut,span:Q,className:Ft,style:kt,labelStyle:Jt,contentStyle:ne,bordered:Xt,label:Te,content:Wt,colon:Mn,type:Pe}=et,Ut=ut;return Xt?G.createElement(Ut,{className:q()({[`${T}-item-label`]:Pe==="label",[`${T}-item-content`]:Pe==="content"},Ft),style:kt,colSpan:Q},K(Te)&&G.createElement("span",{style:Jt},Te),K(Wt)&&G.createElement("span",{style:ne},Wt)):G.createElement(Ut,{className:q()(`${T}-item`,Ft),style:kt,colSpan:Q},G.createElement("div",{className:`${T}-item-container`},(Te||Te===0)&&G.createElement("span",{className:q()(`${T}-item-label`,{[`${T}-item-no-colon`]:!Mn}),style:Jt},Te),(Wt||Wt===0)&&G.createElement("span",{className:q()(`${T}-item-content`),style:ne},Wt)))};function ot(et,T,ut){let{colon:Q,prefixCls:Ft,bordered:kt}=T,{component:Jt,type:ne,showLabel:Xt,showContent:Te,labelStyle:Wt,contentStyle:Mn}=ut;return et.map((Pe,Ut)=>{let{label:Ee,children:mi,prefixCls:Cn=Ft,className:Ar,style:vr,labelStyle:gr,contentStyle:ce,span:Ae=1,key:Or}=Pe;return typeof Jt=="string"?G.createElement(le,{key:`${ne}-${Or||Ut}`,className:Ar,style:vr,labelStyle:Object.assign(Object.assign({},Wt),gr),contentStyle:Object.assign(Object.assign({},Mn),ce),span:Ae,colon:Q,component:Jt,itemPrefixCls:Cn,bordered:kt,label:Xt?Ee:null,content:Te?mi:null,type:ne}):[G.createElement(le,{key:`label-${Or||Ut}`,className:Ar,style:Object.assign(Object.assign(Object.assign({},Wt),vr),gr),span:1,colon:Q,component:Jt[0],itemPrefixCls:Cn,bordered:kt,label:Ee,type:"label"}),G.createElement(le,{key:`content-${Or||Ut}`,className:Ar,style:Object.assign(Object.assign(Object.assign({},Mn),vr),ce),span:Ae*2-1,component:Jt[1],itemPrefixCls:Cn,bordered:kt,content:mi,type:"content"})]})}var zt=et=>{const T=G.useContext(U),{prefixCls:ut,vertical:Q,row:Ft,index:kt,bordered:Jt}=et;return Q?G.createElement(G.Fragment,null,G.createElement("tr",{key:`label-${kt}`,className:`${ut}-row`},ot(Ft,et,Object.assign({component:"th",type:"label",showLabel:!0},T))),G.createElement("tr",{key:`content-${kt}`,className:`${ut}-row`},ot(Ft,et,Object.assign({component:"td",type:"content",showContent:!0},T)))):G.createElement("tr",{key:kt,className:`${ut}-row`},ot(Ft,et,Object.assign({component:Jt?["th","td"]:"td",type:"item",showLabel:!0,showContent:!0},T)))},Ot=D(54548),xe=D(14747),se=D(91945),Gn=D(45503);const vt=et=>{const{componentCls:T,labelBg:ut}=et;return{[`&${T}-bordered`]:{[`> ${T}-view`]:{border:`${(0,Ot.bf)(et.lineWidth)} ${et.lineType} ${et.colorSplit}`,"> table":{tableLayout:"auto"},[`${T}-row`]:{borderBottom:`${(0,Ot.bf)(et.lineWidth)} ${et.lineType} ${et.colorSplit}`,"&:last-child":{borderBottom:"none"},[`> ${T}-item-label, > ${T}-item-content`]:{padding:`${(0,Ot.bf)(et.padding)} ${(0,Ot.bf)(et.paddingLG)}`,borderInlineEnd:`${(0,Ot.bf)(et.lineWidth)} ${et.lineType} ${et.colorSplit}`,"&:last-child":{borderInlineEnd:"none"}},[`> ${T}-item-label`]:{color:et.colorTextSecondary,backgroundColor:ut,"&::after":{display:"none"}}}},[`&${T}-middle`]:{[`${T}-row`]:{[`> ${T}-item-label, > ${T}-item-content`]:{padding:`${(0,Ot.bf)(et.paddingSM)} ${(0,Ot.bf)(et.paddingLG)}`}}},[`&${T}-small`]:{[`${T}-row`]:{[`> ${T}-item-label, > ${T}-item-content`]:{padding:`${(0,Ot.bf)(et.paddingXS)} ${(0,Ot.bf)(et.padding)}`}}}}}},he=et=>{const{componentCls:T,extraColor:ut,itemPaddingBottom:Q,colonMarginRight:Ft,colonMarginLeft:kt,titleMarginBottom:Jt}=et;return{[T]:Object.assign(Object.assign(Object.assign({},(0,xe.Wf)(et)),vt(et)),{["&-rtl"]:{direction:"rtl"},[`${T}-header`]:{display:"flex",alignItems:"center",marginBottom:Jt},[`${T}-title`]:Object.assign(Object.assign({},xe.vS),{flex:"auto",color:et.titleColor,fontWeight:et.fontWeightStrong,fontSize:et.fontSizeLG,lineHeight:et.lineHeightLG}),[`${T}-extra`]:{marginInlineStart:"auto",color:ut,fontSize:et.fontSize},[`${T}-view`]:{width:"100%",borderRadius:et.borderRadiusLG,table:{width:"100%",tableLayout:"fixed",borderCollapse:"collapse"}},[`${T}-row`]:{"> th, > td":{paddingBottom:Q},"&:last-child":{borderBottom:"none"}},[`${T}-item-label`]:{color:et.colorTextTertiary,fontWeight:"normal",fontSize:et.fontSize,lineHeight:et.lineHeight,textAlign:"start","&::after":{content:'":"',position:"relative",top:-.5,marginInline:`${(0,Ot.bf)(kt)} ${(0,Ot.bf)(Ft)}`},[`&${T}-item-no-colon::after`]:{content:'""'}},[`${T}-item-no-label`]:{"&::after":{margin:0,content:'""'}},[`${T}-item-content`]:{display:"table-cell",flex:1,color:et.contentColor,fontSize:et.fontSize,lineHeight:et.lineHeight,wordBreak:"break-word",overflowWrap:"break-word"},[`${T}-item`]:{paddingBottom:0,verticalAlign:"top","&-container":{display:"flex",[`${T}-item-label`]:{display:"inline-flex",alignItems:"baseline"},[`${T}-item-content`]:{display:"inline-flex",alignItems:"baseline"}}},"&-middle":{[`${T}-row`]:{"> th, > td":{paddingBottom:et.paddingSM}}},"&-small":{[`${T}-row`]:{"> th, > td":{paddingBottom:et.paddingXS}}}})}},be=et=>({labelBg:et.colorFillAlter,titleColor:et.colorText,titleMarginBottom:et.fontSizeSM*et.lineHeightSM,itemPaddingBottom:et.padding,colonMarginRight:et.marginXS,colonMarginLeft:et.marginXXS/2,contentColor:et.colorText,extraColor:et.colorText});var Yt=(0,se.I$)("Descriptions",et=>{const T=(0,Gn.TS)(et,{});return he(T)},be),ie=function(et,T){var ut={};for(var Q in et)Object.prototype.hasOwnProperty.call(et,Q)&&T.indexOf(Q)<0&&(ut[Q]=et[Q]);if(et!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Ft=0,Q=Object.getOwnPropertySymbols(et);Ft<Q.length;Ft++)T.indexOf(Q[Ft])<0&&Object.prototype.propertyIsEnumerable.call(et,Q[Ft])&&(ut[Q[Ft]]=et[Q[Ft]]);return ut};const Dt=et=>{const{prefixCls:T,title:ut,extra:Q,column:Ft,colon:kt=!0,bordered:Jt,layout:ne,children:Xt,className:Te,rootClassName:Wt,style:Mn,size:Pe,labelStyle:Ut,contentStyle:Ee,items:mi}=et,Cn=ie(et,["prefixCls","title","extra","column","colon","bordered","layout","children","className","rootClassName","style","size","labelStyle","contentStyle","items"]),{getPrefixCls:Ar,direction:vr,descriptions:gr}=G.useContext(N.E_),ce=Ar("descriptions",T),Ae=(0,W.Z)(),Or=G.useMemo(()=>{var An;return typeof Ft=="number"?Ft:(An=(0,B.m9)(Ae,Object.assign(Object.assign({},F),Ft)))!==null&&An!==void 0?An:3},[Ae,Ft]),re=gt(Ae,mi,Xt),je=(0,V.Z)(Pe),ti=C(Or,re),[pa,yi,ir]=Yt(ce),Ye=G.useMemo(()=>({labelStyle:Ut,contentStyle:Ee}),[Ut,Ee]);return pa(G.createElement(U.Provider,{value:Ye},G.createElement("div",Object.assign({className:q()(ce,gr==null?void 0:gr.className,{[`${ce}-${je}`]:je&&je!=="default",[`${ce}-bordered`]:!!Jt,[`${ce}-rtl`]:vr==="rtl"},Te,Wt,yi,ir),style:Object.assign(Object.assign({},gr==null?void 0:gr.style),Mn)},Cn),(ut||Q)&&G.createElement("div",{className:`${ce}-header`},ut&&G.createElement("div",{className:`${ce}-title`},ut),Q&&G.createElement("div",{className:`${ce}-extra`},Q)),G.createElement("div",{className:`${ce}-view`},G.createElement("table",null,G.createElement("tbody",null,ti.map((An,Ui)=>G.createElement(zt,{key:Ui,index:Ui,colon:kt,prefixCls:ce,vertical:ne==="vertical",bordered:Jt,row:An}))))))))};Dt.Item=ee;var Bt=Dt},66309:function(Ct,ft,D){"use strict";D.d(ft,{Z:function(){return Gn}});var G=D(67294),lt=D(93967),q=D.n(lt),B=D(98423),N=D(98787),V=D(69760),W=D(96159),X=D(45353),F=D(53124),H=D(54548),U=D(10274),$=D(14747),dt=D(45503),j=D(91945);const gt=vt=>{const{paddingXXS:he,lineWidth:be,tagPaddingHorizontal:Yt,componentCls:ie,calc:Dt}=vt,Bt=Dt(Yt).sub(be).equal(),et=Dt(he).sub(be).equal();return{[ie]:Object.assign(Object.assign({},(0,$.Wf)(vt)),{display:"inline-block",height:"auto",marginInlineEnd:vt.marginXS,paddingInline:Bt,fontSize:vt.tagFontSize,lineHeight:vt.tagLineHeight,whiteSpace:"nowrap",background:vt.defaultBg,border:`${(0,H.bf)(vt.lineWidth)} ${vt.lineType} ${vt.colorBorder}`,borderRadius:vt.borderRadiusSM,opacity:1,transition:`all ${vt.motionDurationMid}`,textAlign:"start",position:"relative",[`&${ie}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:vt.defaultColor},[`${ie}-close-icon`]:{marginInlineStart:et,fontSize:vt.tagIconSize,color:vt.colorTextDescription,cursor:"pointer",transition:`all ${vt.motionDurationMid}`,"&:hover":{color:vt.colorTextHeading}},[`&${ie}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${vt.iconCls}-close, ${vt.iconCls}-close:hover`]:{color:vt.colorTextLightSolid}},["&-checkable"]:{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${ie}-checkable-checked):hover`]:{color:vt.colorPrimary,backgroundColor:vt.colorFillSecondary},"&:active, &-checked":{color:vt.colorTextLightSolid},"&-checked":{backgroundColor:vt.colorPrimary,"&:hover":{backgroundColor:vt.colorPrimaryHover}},"&:active":{backgroundColor:vt.colorPrimaryActive}},["&-hidden"]:{display:"none"},[`> ${vt.iconCls} + span, > span + ${vt.iconCls}`]:{marginInlineStart:Bt}}),[`${ie}-borderless`]:{borderColor:"transparent",background:vt.tagBorderlessBg}}},St=vt=>{const{lineWidth:he,fontSizeIcon:be,calc:Yt}=vt,ie=vt.fontSizeSM;return(0,dt.TS)(vt,{tagFontSize:ie,tagLineHeight:(0,H.bf)(Yt(vt.lineHeightSM).mul(ie).equal()),tagIconSize:Yt(be).sub(Yt(he).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:vt.defaultBg})},tt=vt=>({defaultBg:new U.C(vt.colorFillQuaternary).onBackground(vt.colorBgContainer).toHexString(),defaultColor:vt.colorText});var pt=(0,j.I$)("Tag",vt=>{const he=St(vt);return gt(he)},tt),C=function(vt,he){var be={};for(var Yt in vt)Object.prototype.hasOwnProperty.call(vt,Yt)&&he.indexOf(Yt)<0&&(be[Yt]=vt[Yt]);if(vt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ie=0,Yt=Object.getOwnPropertySymbols(vt);ie<Yt.length;ie++)he.indexOf(Yt[ie])<0&&Object.prototype.propertyIsEnumerable.call(vt,Yt[ie])&&(be[Yt[ie]]=vt[Yt[ie]]);return be},ee=G.forwardRef((vt,he)=>{const{prefixCls:be,style:Yt,className:ie,checked:Dt,onChange:Bt,onClick:et}=vt,T=C(vt,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:ut,tag:Q}=G.useContext(F.E_),Ft=Wt=>{Bt==null||Bt(!Dt),et==null||et(Wt)},kt=ut("tag",be),[Jt,ne,Xt]=pt(kt),Te=q()(kt,`${kt}-checkable`,{[`${kt}-checkable-checked`]:Dt},Q==null?void 0:Q.className,ie,ne,Xt);return Jt(G.createElement("span",Object.assign({},T,{ref:he,style:Object.assign(Object.assign({},Yt),Q==null?void 0:Q.style),className:Te,onClick:Ft})))}),K=D(98719);const pe=vt=>(0,K.Z)(vt,(he,be)=>{let{textColor:Yt,lightBorderColor:ie,lightColor:Dt,darkColor:Bt}=be;return{[`${vt.componentCls}${vt.componentCls}-${he}`]:{color:Yt,background:Dt,borderColor:ie,"&-inverse":{color:vt.colorTextLightSolid,background:Bt,borderColor:Bt},[`&${vt.componentCls}-borderless`]:{borderColor:"transparent"}}}});var le=(0,j.bk)(["Tag","preset"],vt=>{const he=St(vt);return pe(he)},tt);function ot(vt){return typeof vt!="string"?vt:vt.charAt(0).toUpperCase()+vt.slice(1)}const Gt=(vt,he,be)=>{const Yt=ot(be);return{[`${vt.componentCls}${vt.componentCls}-${he}`]:{color:vt[`color${be}`],background:vt[`color${Yt}Bg`],borderColor:vt[`color${Yt}Border`],[`&${vt.componentCls}-borderless`]:{borderColor:"transparent"}}}};var zt=(0,j.bk)(["Tag","status"],vt=>{const he=St(vt);return[Gt(he,"success","Success"),Gt(he,"processing","Info"),Gt(he,"error","Error"),Gt(he,"warning","Warning")]},tt),Ot=function(vt,he){var be={};for(var Yt in vt)Object.prototype.hasOwnProperty.call(vt,Yt)&&he.indexOf(Yt)<0&&(be[Yt]=vt[Yt]);if(vt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ie=0,Yt=Object.getOwnPropertySymbols(vt);ie<Yt.length;ie++)he.indexOf(Yt[ie])<0&&Object.prototype.propertyIsEnumerable.call(vt,Yt[ie])&&(be[Yt[ie]]=vt[Yt[ie]]);return be};const se=G.forwardRef((vt,he)=>{const{prefixCls:be,className:Yt,rootClassName:ie,style:Dt,children:Bt,icon:et,color:T,onClose:ut,bordered:Q=!0,visible:Ft}=vt,kt=Ot(vt,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:Jt,direction:ne,tag:Xt}=G.useContext(F.E_),[Te,Wt]=G.useState(!0),Mn=(0,B.Z)(kt,["closeIcon","closable"]);G.useEffect(()=>{Ft!==void 0&&Wt(Ft)},[Ft]);const Pe=(0,N.o2)(T),Ut=(0,N.yT)(T),Ee=Pe||Ut,mi=Object.assign(Object.assign({backgroundColor:T&&!Ee?T:void 0},Xt==null?void 0:Xt.style),Dt),Cn=Jt("tag",be),[Ar,vr,gr]=pt(Cn),ce=q()(Cn,Xt==null?void 0:Xt.className,{[`${Cn}-${T}`]:Ee,[`${Cn}-has-color`]:T&&!Ee,[`${Cn}-hidden`]:!Te,[`${Cn}-rtl`]:ne==="rtl",[`${Cn}-borderless`]:!Q},Yt,ie,vr,gr),Ae=yi=>{yi.stopPropagation(),ut==null||ut(yi),!yi.defaultPrevented&&Wt(!1)},[,Or]=(0,V.Z)((0,V.w)(vt),(0,V.w)(Xt),{closable:!1,closeIconRender:yi=>{const ir=G.createElement("span",{className:`${Cn}-close-icon`,onClick:Ae},yi);return(0,W.wm)(yi,ir,Ye=>({onClick:An=>{var Ui;(Ui=Ye==null?void 0:Ye.onClick)===null||Ui===void 0||Ui.call(Ye,An),Ae(An)},className:q()(Ye==null?void 0:Ye.className,`${Cn}-close-icon`)}))}}),re=typeof kt.onClick=="function"||Bt&&Bt.type==="a",je=et||null,ti=je?G.createElement(G.Fragment,null,je,Bt&&G.createElement("span",null,Bt)):Bt,pa=G.createElement("span",Object.assign({},Mn,{ref:he,className:ce,style:mi}),ti,Or,Pe&&G.createElement(le,{key:"preset",prefixCls:Cn}),Ut&&G.createElement(zt,{key:"status",prefixCls:Cn}));return Ar(re?G.createElement(X.Z,{component:"Tag"},pa):pa)});se.CheckableTag=ee;var Gn=se},8874:function(Ct){"use strict";Ct.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},19818:function(Ct,ft,D){var G=D(8874),lt=D(86851),q=Object.hasOwnProperty,B=Object.create(null);for(var N in G)q.call(G,N)&&(B[G[N]]=N);var V=Ct.exports={to:{},get:{}};V.get=function(F){var H=F.substring(0,3).toLowerCase(),U,$;switch(H){case"hsl":U=V.get.hsl(F),$="hsl";break;case"hwb":U=V.get.hwb(F),$="hwb";break;default:U=V.get.rgb(F),$="rgb";break}return U?{model:$,value:U}:null},V.get.rgb=function(F){if(!F)return null;var H=/^#([a-f0-9]{3,4})$/i,U=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,$=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,dt=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,j=/^(\w+)$/,gt=[0,0,0,1],St,tt,pt;if(St=F.match(U)){for(pt=St[2],St=St[1],tt=0;tt<3;tt++){var C=tt*2;gt[tt]=parseInt(St.slice(C,C+2),16)}pt&&(gt[3]=parseInt(pt,16)/255)}else if(St=F.match(H)){for(St=St[1],pt=St[3],tt=0;tt<3;tt++)gt[tt]=parseInt(St[tt]+St[tt],16);pt&&(gt[3]=parseInt(pt+pt,16)/255)}else if(St=F.match($)){for(tt=0;tt<3;tt++)gt[tt]=parseInt(St[tt+1],0);St[4]&&(St[5]?gt[3]=parseFloat(St[4])*.01:gt[3]=parseFloat(St[4]))}else if(St=F.match(dt)){for(tt=0;tt<3;tt++)gt[tt]=Math.round(parseFloat(St[tt+1])*2.55);St[4]&&(St[5]?gt[3]=parseFloat(St[4])*.01:gt[3]=parseFloat(St[4]))}else return(St=F.match(j))?St[1]==="transparent"?[0,0,0,0]:q.call(G,St[1])?(gt=G[St[1]],gt[3]=1,gt):null:null;for(tt=0;tt<3;tt++)gt[tt]=W(gt[tt],0,255);return gt[3]=W(gt[3],0,1),gt},V.get.hsl=function(F){if(!F)return null;var H=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,U=F.match(H);if(U){var $=parseFloat(U[4]),dt=(parseFloat(U[1])%360+360)%360,j=W(parseFloat(U[2]),0,100),gt=W(parseFloat(U[3]),0,100),St=W(isNaN($)?1:$,0,1);return[dt,j,gt,St]}return null},V.get.hwb=function(F){if(!F)return null;var H=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,U=F.match(H);if(U){var $=parseFloat(U[4]),dt=(parseFloat(U[1])%360+360)%360,j=W(parseFloat(U[2]),0,100),gt=W(parseFloat(U[3]),0,100),St=W(isNaN($)?1:$,0,1);return[dt,j,gt,St]}return null},V.to.hex=function(){var F=lt(arguments);return"#"+X(F[0])+X(F[1])+X(F[2])+(F[3]<1?X(Math.round(F[3]*255)):"")},V.to.rgb=function(){var F=lt(arguments);return F.length<4||F[3]===1?"rgb("+Math.round(F[0])+", "+Math.round(F[1])+", "+Math.round(F[2])+")":"rgba("+Math.round(F[0])+", "+Math.round(F[1])+", "+Math.round(F[2])+", "+F[3]+")"},V.to.rgb.percent=function(){var F=lt(arguments),H=Math.round(F[0]/255*100),U=Math.round(F[1]/255*100),$=Math.round(F[2]/255*100);return F.length<4||F[3]===1?"rgb("+H+"%, "+U+"%, "+$+"%)":"rgba("+H+"%, "+U+"%, "+$+"%, "+F[3]+")"},V.to.hsl=function(){var F=lt(arguments);return F.length<4||F[3]===1?"hsl("+F[0]+", "+F[1]+"%, "+F[2]+"%)":"hsla("+F[0]+", "+F[1]+"%, "+F[2]+"%, "+F[3]+")"},V.to.hwb=function(){var F=lt(arguments),H="";return F.length>=4&&F[3]!==1&&(H=", "+F[3]),"hwb("+F[0]+", "+F[1]+"%, "+F[2]+"%"+H+")"},V.to.keyword=function(F){return B[F.slice(0,3)]};function W(F,H,U){return Math.min(Math.max(H,F),U)}function X(F){var H=Math.round(F).toString(16).toUpperCase();return H.length<2?"0"+H:H}},26729:function(Ct){"use strict";var ft=Object.prototype.hasOwnProperty,D="~";function G(){}Object.create&&(G.prototype=Object.create(null),new G().__proto__||(D=!1));function lt(V,W,X){this.fn=V,this.context=W,this.once=X||!1}function q(V,W,X,F,H){if(typeof X!="function")throw new TypeError("The listener must be a function");var U=new lt(X,F||V,H),$=D?D+W:W;return V._events[$]?V._events[$].fn?V._events[$]=[V._events[$],U]:V._events[$].push(U):(V._events[$]=U,V._eventsCount++),V}function B(V,W){--V._eventsCount===0?V._events=new G:delete V._events[W]}function N(){this._events=new G,this._eventsCount=0}N.prototype.eventNames=function(){var W=[],X,F;if(this._eventsCount===0)return W;for(F in X=this._events)ft.call(X,F)&&W.push(D?F.slice(1):F);return Object.getOwnPropertySymbols?W.concat(Object.getOwnPropertySymbols(X)):W},N.prototype.listeners=function(W){var X=D?D+W:W,F=this._events[X];if(!F)return[];if(F.fn)return[F.fn];for(var H=0,U=F.length,$=new Array(U);H<U;H++)$[H]=F[H].fn;return $},N.prototype.listenerCount=function(W){var X=D?D+W:W,F=this._events[X];return F?F.fn?1:F.length:0},N.prototype.emit=function(W,X,F,H,U,$){var dt=D?D+W:W;if(!this._events[dt])return!1;var j=this._events[dt],gt=arguments.length,St,tt;if(j.fn){switch(j.once&&this.removeListener(W,j.fn,void 0,!0),gt){case 1:return j.fn.call(j.context),!0;case 2:return j.fn.call(j.context,X),!0;case 3:return j.fn.call(j.context,X,F),!0;case 4:return j.fn.call(j.context,X,F,H),!0;case 5:return j.fn.call(j.context,X,F,H,U),!0;case 6:return j.fn.call(j.context,X,F,H,U,$),!0}for(tt=1,St=new Array(gt-1);tt<gt;tt++)St[tt-1]=arguments[tt];j.fn.apply(j.context,St)}else{var pt=j.length,C;for(tt=0;tt<pt;tt++)switch(j[tt].once&&this.removeListener(W,j[tt].fn,void 0,!0),gt){case 1:j[tt].fn.call(j[tt].context);break;case 2:j[tt].fn.call(j[tt].context,X);break;case 3:j[tt].fn.call(j[tt].context,X,F);break;case 4:j[tt].fn.call(j[tt].context,X,F,H);break;default:if(!St)for(C=1,St=new Array(gt-1);C<gt;C++)St[C-1]=arguments[C];j[tt].fn.apply(j[tt].context,St)}}return!0},N.prototype.on=function(W,X,F){return q(this,W,X,F,!1)},N.prototype.once=function(W,X,F){return q(this,W,X,F,!0)},N.prototype.removeListener=function(W,X,F,H){var U=D?D+W:W;if(!this._events[U])return this;if(!X)return B(this,U),this;var $=this._events[U];if($.fn)$.fn===X&&(!H||$.once)&&(!F||$.context===F)&&B(this,U);else{for(var dt=0,j=[],gt=$.length;dt<gt;dt++)($[dt].fn!==X||H&&!$[dt].once||F&&$[dt].context!==F)&&j.push($[dt]);j.length?this._events[U]=j.length===1?j[0]:j:B(this,U)}return this},N.prototype.removeAllListeners=function(W){var X;return W?(X=D?D+W:W,this._events[X]&&B(this,X)):(this._events=new G,this._eventsCount=0),this},N.prototype.off=N.prototype.removeListener,N.prototype.addListener=N.prototype.on,N.prefixed=D,N.EventEmitter=N,Ct.exports=N},80817:function(Ct){function ft(q,B,N){return(B[0]-q[0])*(N[1]-q[1])-(B[1]-q[1])*(N[0]-q[0])}function D(q){const B=[];for(let N=0;N<q.length;N++){for(;B.length>=2&&ft(B[B.length-2],B[B.length-1],q[N])<=0;)B.pop();B.push(q[N])}return B.pop(),B}function G(q){const B=q.reverse(),N=[];for(let V=0;V<B.length;V++){for(;N.length>=2&&ft(N[N.length-2],N[N.length-1],B[V])<=0;)N.pop();N.push(B[V])}return N.pop(),N}function lt(q){const B=D(q),V=G(q).concat(B);return V.push(q[0]),V}Ct.exports=lt},63652:function(Ct){Ct.exports={toXy:function(ft,D){return D===void 0?ft.slice():ft.map(function(G){return new Function("pt","return [pt"+D[0]+",pt"+D[1]+"];")(G)})},fromXy:function(ft,D){return D===void 0?ft.slice():ft.map(function(G){return new Function("pt","const o = {}; o"+D[0]+"= pt[0]; o"+D[1]+"= pt[1]; return o;")(G)})}}},58867:function(Ct){function ft(G,lt){this._cells=[],this._cellSize=lt,this._reverseCellSize=1/lt;for(let q=0;q<G.length;q++){const B=G[q],N=this.coordToCellNum(B[0]),V=this.coordToCellNum(B[1]);if(this._cells[N])this._cells[N][V]?this._cells[N][V].push(B):this._cells[N][V]=[B];else{const W=[];W[V]=[B],this._cells[N]=W}}}ft.prototype={cellPoints:function(G,lt){return this._cells[G]!==void 0&&this._cells[G][lt]!==void 0?this._cells[G][lt]:[]},rangePoints:function(G){const lt=this.coordToCellNum(G[0]),q=this.coordToCellNum(G[1]),B=this.coordToCellNum(G[2]),N=this.coordToCellNum(G[3]),V=[];for(let W=lt;W<=B;W++)for(let X=q;X<=N;X++)for(let F=0;F<this.cellPoints(W,X).length;F++)V.push(this.cellPoints(W,X)[F]);return V},removePoint:function(G){const lt=this.coordToCellNum(G[0]),q=this.coordToCellNum(G[1]),B=this._cells[lt][q];let N;for(let V=0;V<B.length;V++)if(B[V][0]===G[0]&&B[V][1]===G[1]){N=V;break}return B.splice(N,1),B},trunc:Math.trunc||function(G){return G-G%1},coordToCellNum:function(G){return this.trunc(G*this._reverseCellSize)},extendBbox:function(G,lt){return[G[0]-lt*this._cellSize,G[1]-lt*this._cellSize,G[2]+lt*this._cellSize,G[3]+lt*this._cellSize]}};function D(G,lt){return new ft(G,lt)}Ct.exports=D},1344:function(Ct,ft,D){"use strict";const G=D(77444),lt=D(58867),q=D(63652),B=D(80817);function N(tt){const pt=[tt[0]];let C=tt[0];for(let qt=1;qt<tt.length;qt++){const ee=tt[qt];(C[0]!==ee[0]||C[1]!==ee[1])&&pt.push(ee),C=ee}return pt}function V(tt){return tt.sort(function(pt,C){return pt[0]-C[0]||pt[1]-C[1]})}function W(tt,pt){return Math.pow(pt[0]-tt[0],2)+Math.pow(pt[1]-tt[1],2)}function X(tt,pt,C){const qt=[pt[0]-tt[0],pt[1]-tt[1]],ee=[C[0]-tt[0],C[1]-tt[1]],K=W(tt,pt),pe=W(tt,C);return(qt[0]*ee[0]+qt[1]*ee[1])/Math.sqrt(K*pe)}function F(tt,pt){for(let C=0;C<pt.length-1;C++){const qt=[pt[C],pt[C+1]];if(!(tt[0][0]===qt[0][0]&&tt[0][1]===qt[0][1]||tt[0][0]===qt[1][0]&&tt[0][1]===qt[1][1])&&G(tt,qt))return!0}return!1}function H(tt){let pt=1/0,C=1/0,qt=-1/0,ee=-1/0;for(let K=tt.length-1;K>=0;K--)tt[K][0]<pt&&(pt=tt[K][0]),tt[K][1]<C&&(C=tt[K][1]),tt[K][0]>qt&&(qt=tt[K][0]),tt[K][1]>ee&&(ee=tt[K][1]);return[qt-pt,ee-C]}function U(tt){return[Math.min(tt[0][0],tt[1][0]),Math.min(tt[0][1],tt[1][1]),Math.max(tt[0][0],tt[1][0]),Math.max(tt[0][1],tt[1][1])]}function $(tt,pt,C){let qt=null,ee=gt,K=gt,pe,le;for(let ot=0;ot<pt.length;ot++)pe=X(tt[0],tt[1],pt[ot]),le=X(tt[1],tt[0],pt[ot]),pe>ee&&le>K&&!F([tt[0],pt[ot]],C)&&!F([tt[1],pt[ot]],C)&&(ee=pe,K=le,qt=pt[ot]);return qt}function dt(tt,pt,C,qt,ee){let K=!1;for(let pe=0;pe<tt.length-1;pe++){const le=[tt[pe],tt[pe+1]],ot=le[0][0]+","+le[0][1]+","+le[1][0]+","+le[1][1];if(W(le[0],le[1])<pt||ee.has(ot))continue;let Gt=0,zt=U(le),Ot,xe,se;do zt=qt.extendBbox(zt,Gt),Ot=zt[2]-zt[0],xe=zt[3]-zt[1],se=$(le,qt.rangePoints(zt),tt),Gt++;while(se===null&&(C[0]>Ot||C[1]>xe));Ot>=C[0]&&xe>=C[1]&&ee.add(ot),se!==null&&(tt.splice(pe+1,0,se),qt.removePoint(se),K=!0)}return K?dt(tt,pt,C,qt,ee):tt}function j(tt,pt,C){let qt=pt||20;const ee=N(V(q.toXy(tt,C)));if(ee.length<4){const Ot=ee.concat([ee[0]]);return C?q.fromXy(Ot,C):Ot}const K=H(ee),pe=[K[0]*St,K[1]*St],le=B(ee),ot=ee.filter(function(Ot){return le.indexOf(Ot)<0}),Gt=Math.ceil(1/(ee.length/(K[0]*K[1]))),zt=dt(le,Math.pow(qt,2),pe,lt(ot,Gt),new Set);return C?q.fromXy(zt,C):zt}const gt=Math.cos(90/(180/Math.PI)),St=.6;Ct.exports=j},77444:function(Ct){function ft(G,lt,q,B,N,V){const W=(V-lt)*(q-G)-(B-lt)*(N-G);return W>0?!0:!(W<0)}function D(G,lt){const q=G[0][0],B=G[0][1],N=G[1][0],V=G[1][1],W=lt[0][0],X=lt[0][1],F=lt[1][0],H=lt[1][1];return ft(q,B,W,X,F,H)!==ft(N,V,W,X,F,H)&&ft(q,B,N,V,W,X)!==ft(q,B,N,V,F,H)}Ct.exports=D},35171:function(Ct){Ct.exports=function(D){return!D||typeof D=="string"?!1:D instanceof Array||Array.isArray(D)||D.length>=0&&(D.splice instanceof Function||Object.getOwnPropertyDescriptor(D,D.length-1)&&D.constructor.name!=="String")}},97005:function(Ct,ft,D){var G;function lt(W){if(!W||typeof window=="undefined")return;const X=document.createElement("style");return X.setAttribute("type","text/css"),X.innerHTML=W,document.head.appendChild(X),W}G={value:!0};var q=D(67294);function B(W){return W&&typeof W=="object"&&"default"in W?W:{default:W}}var N=B(q);lt(`.rfm-marquee-container {
  overflow-x: hidden;
  display: flex;
  flex-direction: row;
  position: relative;
  width: var(--width);
  transform: var(--transform);
}
.rfm-marquee-container:hover div {
  animation-play-state: var(--pause-on-hover);
}
.rfm-marquee-container:active div {
  animation-play-state: var(--pause-on-click);
}

.rfm-overlay {
  position: absolute;
  width: 100%;
  height: 100%;
}
.rfm-overlay::before, .rfm-overlay::after {
  background: linear-gradient(to right, var(--gradient-color), rgba(255, 255, 255, 0));
  content: "";
  height: 100%;
  position: absolute;
  width: var(--gradient-width);
  z-index: 2;
  pointer-events: none;
  touch-action: none;
}
.rfm-overlay::after {
  right: 0;
  top: 0;
  transform: rotateZ(180deg);
}
.rfm-overlay::before {
  left: 0;
  top: 0;
}

.rfm-marquee {
  flex: 0 0 auto;
  min-width: var(--min-width);
  z-index: 1;
  display: flex;
  flex-direction: row;
  align-items: center;
  animation: scroll var(--duration) linear var(--delay) var(--iteration-count);
  animation-play-state: var(--play);
  animation-delay: var(--delay);
  animation-direction: var(--direction);
}
@keyframes scroll {
  0% {
    transform: translateX(0%);
  }
  100% {
    transform: translateX(-100%);
  }
}

.rfm-initial-child-container {
  flex: 0 0 auto;
  display: flex;
  min-width: auto;
  flex-direction: row;
  align-items: center;
}

.rfm-child {
  transform: var(--transform);
}`);const V=q.forwardRef(function({style:X={},className:F="",autoFill:H=!1,play:U=!0,pauseOnHover:$=!1,pauseOnClick:dt=!1,direction:j="left",speed:gt=50,delay:St=0,loop:tt=0,gradient:pt=!1,gradientColor:C="white",gradientWidth:qt=200,onFinish:ee,onCycleComplete:K,onMount:pe,children:le},ot){const[Gt,zt]=q.useState(0),[Ot,xe]=q.useState(0),[se,Gn]=q.useState(1),[vt,he]=q.useState(!1),be=q.useRef(null),Yt=ot||be,ie=q.useRef(null),Dt=q.useCallback(()=>{if(ie.current&&Yt.current){const kt=Yt.current.getBoundingClientRect(),Jt=ie.current.getBoundingClientRect();let ne=kt.width,Xt=Jt.width;(j==="up"||j==="down")&&(ne=kt.height,Xt=Jt.height),Gn(H&&ne&&Xt&&Xt<ne?Math.ceil(ne/Xt):1),zt(ne),xe(Xt)}},[H,Yt,j]);q.useEffect(()=>{if(vt&&(Dt(),ie.current&&Yt.current)){const kt=new ResizeObserver(()=>Dt());return kt.observe(Yt.current),kt.observe(ie.current),()=>{kt&&kt.disconnect()}}},[Dt,Yt,vt]),q.useEffect(()=>{Dt()},[Dt,le]),q.useEffect(()=>{he(!0)},[]),q.useEffect(()=>{typeof pe=="function"&&pe()},[]);const Bt=q.useMemo(()=>H?Ot*se/gt:Ot<Gt?Gt/gt:Ot/gt,[H,Gt,Ot,se,gt]),et=q.useMemo(()=>Object.assign(Object.assign({},X),{["--pause-on-hover"]:!U||$?"paused":"running",["--pause-on-click"]:!U||$&&!dt||dt?"paused":"running",["--width"]:j==="up"||j==="down"?"100vh":"100%",["--transform"]:j==="up"?"rotate(-90deg)":j==="down"?"rotate(90deg)":"none"}),[X,U,$,dt,j]),T=q.useMemo(()=>({["--gradient-color"]:C,["--gradient-width"]:typeof qt=="number"?`${qt}px`:qt}),[C,qt]),ut=q.useMemo(()=>({["--play"]:U?"running":"paused",["--direction"]:j==="left"?"normal":"reverse",["--duration"]:`${Bt}s`,["--delay"]:`${St}s`,["--iteration-count"]:tt?`${tt}`:"infinite",["--min-width"]:H?"auto":"100%"}),[U,j,Bt,St,tt,H]),Q=q.useMemo(()=>({["--transform"]:j==="up"?"rotate(90deg)":j==="down"?"rotate(-90deg)":"none"}),[j]),Ft=q.useCallback(kt=>[...Array(Number.isFinite(kt)&&kt>=0?kt:0)].map((Jt,ne)=>N.default.createElement(q.Fragment,{key:ne},q.Children.map(le,Xt=>N.default.createElement("div",{style:Q,className:"rfm-child"},Xt)))),[Q,le]);return vt?N.default.createElement("div",{ref:Yt,style:et,className:"rfm-marquee-container "+F},pt&&N.default.createElement("div",{style:T,className:"rfm-overlay"}),N.default.createElement("div",{className:"rfm-marquee",style:ut,onAnimationIteration:K,onAnimationEnd:ee},N.default.createElement("div",{className:"rfm-initial-child-container",ref:ie},q.Children.map(le,kt=>N.default.createElement("div",{style:Q,className:"rfm-child"},kt))),Ft(se-1)),N.default.createElement("div",{className:"rfm-marquee",style:ut},Ft(se))):null});ft.Z=V},86851:function(Ct,ft,D){"use strict";var G=D(35171),lt=Array.prototype.concat,q=Array.prototype.slice,B=Ct.exports=function(V){for(var W=[],X=0,F=V.length;X<F;X++){var H=V[X];G(H)?W=lt.call(W,q.call(H)):W.push(H)}return W};B.wrap=function(N){return function(){return N(B(arguments))}}},96446:function(Ct,ft,D){var G=D(37923);function lt(q){if(Array.isArray(q))return G(q)}Ct.exports=lt,Ct.exports.__esModule=!0,Ct.exports.default=Ct.exports},96936:function(Ct){function ft(D){if(typeof Symbol!="undefined"&&D[Symbol.iterator]!=null||D["@@iterator"]!=null)return Array.from(D)}Ct.exports=ft,Ct.exports.__esModule=!0,Ct.exports.default=Ct.exports},88619:function(Ct){function ft(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}Ct.exports=ft,Ct.exports.__esModule=!0,Ct.exports.default=Ct.exports},19632:function(Ct,ft,D){var G=D(96446),lt=D(96936),q=D(96263),B=D(88619);function N(V){return G(V)||lt(V)||q(V)||B()}Ct.exports=N,Ct.exports.__esModule=!0,Ct.exports.default=Ct.exports}}]);
}());